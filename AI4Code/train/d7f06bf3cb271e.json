{"cell_type":{"531c8e33":"code","ea5a84ec":"code","1bc8a486":"code","f5831928":"code","d6b86aff":"code","d5f6acc0":"code","6ffcdca4":"markdown","2d4d85ab":"markdown","e3260d23":"markdown","bbb97e46":"markdown","feaa1bb0":"markdown"},"source":{"531c8e33":"!pip install imutils","ea5a84ec":"import imutils\nfrom imutils import face_utils\nimport numpy as np\nimport dlib\nimport cv2\nimport matplotlib.pyplot as plt","1bc8a486":"image_path = '..\/input\/face-dataset\/Datasets\/without_mask\/100.jpg'\nimage = cv2.imread(image_path)\nimage = imutils.resize(image, width=500)\nimg_RGB = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)\nplt.figure(figsize=(10,10))\nplt.imshow(img_RGB)\nplt.show()","f5831928":"model_path = '..\/input\/landmarks\/shape_predictor_81_face_landmarks.dat'\n#81 facial landmark comes from: https:\/\/github.com\/codeniko\/shape_predictor_81_face_landmarks\noverlay = image.copy()\ngray = cv2.cvtColor(overlay, cv2.COLOR_BGR2GRAY)\ndetector = dlib.get_frontal_face_detector()\npredictor = dlib.shape_predictor(model_path)\nrects = detector(gray, 1) ","d6b86aff":"shape = predictor(gray, rects[0])\nshape = imutils.face_utils.shape_to_np(shape)\n\nfor (x,y) in shape: \n    cv2.circle(overlay, (x,y), 5, (0,0,255), -1)\n\nface_landmarks = cv2.cvtColor(overlay, cv2.COLOR_BGR2RGB)\nplt.figure(figsize=(10,10))\nplt.imshow(face_landmarks)\nplt.show()","d5f6acc0":"shape = ''\ndef at(point, modx=0, mody=0):\n    return (shape[point][0]+modx, shape[point][1]+mody)\n\nfor (i, rect) in enumerate(rects):\n    shape = predictor(gray, rect)\n    shape = face_utils.shape_to_np(shape)\n    (x, y, w, h) = face_utils.rect_to_bb(rect)\n    \noutline=[at(48),at(49), at(50), at(51), at(52), at(53), at(54),\n        at(55), at(56), at(57), at(58), at(59), at(60)]\nmouth_mask = np.array(outline, np.int32)\n\ncv2.fillConvexPoly(overlay, mouth_mask, (255,153,51))\nmouth_mask = cv2.cvtColor(overlay, cv2.COLOR_BGR2RGB)\nplt.figure(figsize=(10,10))\nplt.imshow(mouth_mask)\nplt.show()","6ffcdca4":"### Detection","2d4d85ab":"### Get a Mask","e3260d23":"# Starting code for face recognition","bbb97e46":"### pip install and imports","feaa1bb0":"### View image"}}