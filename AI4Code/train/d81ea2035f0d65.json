{"cell_type":{"bcd74a7f":"code","cedf9be4":"code","70c291a0":"code","3a77e929":"code","9f8b4dcd":"code","676bb1b8":"code","ef2f9d20":"code","7e6b41ea":"code","38eb5849":"code","b4a97a33":"code","c5cd1e60":"code","bc3ce015":"code","929999fb":"code","d3aca593":"markdown","012c5763":"markdown","358339e6":"markdown","4322b8a7":"markdown","3ec19bca":"markdown","270c39ac":"markdown","2c545378":"markdown"},"source":{"bcd74a7f":"import pandas as pd\nimport numpy as np\n\nimport seaborn as sns\nimport matplotlib.pylab as plt\n%matplotlib inline\nfrom matplotlib import style\nstyle.use('ggplot')\n\nimport sklearn\nfrom sklearn.model_selection  import train_test_split\nfrom sklearn import cluster\n\nfrom scipy.stats import zscore","cedf9be4":"import pandas as pd\ndata_df = pd.read_csv(\"..\/input\/technical-customer-support-data\/technical_support_data.csv\")","70c291a0":"data_df.head(10)","3a77e929":"data_df=data_df.iloc[:,1:]\ndata_df","9f8b4dcd":"from scipy.spatial.distance import cdist","676bb1b8":"no_of_clusters = range(1,10)\n\nmeanDistortions = []\n\nfor k in no_of_clusters:\n    clsfmodel = cluster.KMeans(n_clusters=k)\n    clsfmodel.fit(data_df)\n    predict = clsfmodel.predict(data_df)\n    meanDistortions.append(sum(np.min(cdist(data_df,clsfmodel.cluster_centers_,'euclidean'),axis=1)) \/ data_df.shape[0])\n    print(clsfmodel.labels_)\n    \n#print(meanDistortions)\n    ","ef2f9d20":"plt.plot(no_of_clusters, meanDistortions, 'bx-')\nplt.xlabel('k')\nplt.ylabel('Average distortion')\nplt.title('Selecting k with the Elbow Method')","7e6b41ea":"# Let us first start with K = 3\nmodel_cluster = cluster.KMeans(3)\nmodel_cluster.fit(data_df)\npredict = model_cluster.predict(data_df)\n\n#Append the prediction \ndata_df[\"Group\"] = predict\ndata_df.mean()","38eb5849":"inertia = []\n\nfor n in range(1,10):\n    model = cluster.KMeans(n_clusters=n,init='k-means++',n_init = 10, max_iter=300,tol=0.001,random_state=2,algorithm='elkan')\n    model.fit(data_df)\n    inertia .append(model.inertia_)","b4a97a33":"plt.figure(1,figsize=(8,5))\nplt.plot(np.arange(1,10),inertia,'o')\nplt.plot(np.arange(1,10),inertia,'-')\nplt.xlabel('Number of Clusters') ,\nplt.ylabel('Inertia')\nplt.show()","c5cd1e60":"silhouette_score  = list()\nno_of_cluster = range(2,20)\n\nfor i in no_of_cluster:\n    model = cluster.KMeans(i,init='k-means++',n_init=10,max_iter=100,tol=0.0001, verbose=0, random_state=None, copy_x=True)\n    model.fit(data_df)\n    predict = model.predict(data_df)\n    sklearn.metrics.silhouette_score(data_df,predict,metric='euclidean')\n    silhouette_score.append(sklearn.metrics.silhouette_score(data_df,predict,metric='euclidean'))\n    ","bc3ce015":"plt.plot(no_of_cluster,silhouette_score)\nplt.title(\"Silhouette score vs Numbers of Clusters \")\nplt.xlabel('Number of Cluster')\nplt.ylabel('Silhouette Score')\nplt.show()","929999fb":"Optimal_Number=no_of_cluster[silhouette_score.index(max(silhouette_score))]\nprint( \"Optimal number :\")\nprint(Optimal_Number)","d3aca593":"**UnSepervised Learning have many types of algorithms and one of the popular methods is Clustering Algorithms and Clustering have many types **\n![Clustering_Types (2).png](attachment:b3194067-92fd-46e6-963d-d14e758261c5.png)","012c5763":"* This notebook covered a popular technique called clustering which is coming under unsupervised learning. \n* The basic idea is the try to collect and group the data based on similarity \n* for example in the email we are grouping the emails based on the similarity like Spam, Promotion, Social, and so on...","358339e6":"#eleiminate the catagorical feature","4322b8a7":"# <span style=\"font-family: Arial; font-weight:bold;font-size:1.5em;color:#8a3ebe;\"> Silhouette coefficient: find optimal number","3ec19bca":"![](https:\/\/cdn.pixabay.com\/photo\/2016\/03\/28\/09\/39\/shelf-1285186_960_720.jpg)","270c39ac":"![process of extrapolating information](https:\/\/cdn.pixabay.com\/photo\/2016\/09\/11\/08\/33\/man-1660853__340.jpg)","2c545378":" # <span style=\"font-family: Arial; font-weight:bold;font-size:1.5em;color:#ba2323;\"> Centroid Clustering: K-Means"}}