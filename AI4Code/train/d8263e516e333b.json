{"cell_type":{"05db731f":"code","0efe3588":"code","1f4cc8c5":"code","bca00398":"code","5e212ef2":"code","56d79881":"code","8cd4715a":"code","c0a540b2":"code","a7684ab4":"code","f3b9973b":"code","37fe73fe":"code","85101582":"code","ad98ba0b":"code","f5fed0f9":"code","057815e8":"code","08633e5c":"code","092f3c04":"code","b312a4cd":"code","bb92bb9e":"code","3c084461":"code","392ac9fa":"code","f1c483bb":"code","20434c15":"code","8e4d83ce":"code","ba432f87":"markdown","4b967179":"markdown","b9443f24":"markdown","7ee611c8":"markdown","c3d9df52":"markdown","5300a772":"markdown","e6040392":"markdown","c21033a3":"markdown","f487fbc8":"markdown","da162bbc":"markdown","e3bca60a":"markdown","3ac256e9":"markdown","8e3a73c0":"markdown","80042c45":"markdown","f7f03695":"markdown","9a17268a":"markdown","20f89a39":"markdown","37683c2f":"markdown","fc09538a":"markdown","56e0bb31":"markdown","9ea1e052":"markdown","a09f4ec6":"markdown"},"source":{"05db731f":"import numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt \nimport seaborn as sns\n%matplotlib inline","0efe3588":"data = pd.read_csv('..\/input\/diabetes-data-set\/diabetes.csv')\ndf = data.copy()","1f4cc8c5":"df.head()","bca00398":"df.tail() # as you can see in column Insulin some values are 0. So, we need to feel them with that columns means","5e212ef2":"df.info()","56d79881":"df.shape","8cd4715a":"df.isnull().sum() ","c0a540b2":"df['Insulin'].value_counts() # 374 rows have 0 values so these need to be replaced with its meand\/median","a7684ab4":"in_mean = round(df['Insulin'].mean(),1) # getting mean value of insulin\ndf.Insulin = df.Insulin.replace({0:in_mean})  # replacing zero values to column mean \ndf['Insulin'].value_counts() ","f3b9973b":"df['Insulin'] = df['Insulin'].astype('int64')\ndf['Insulin']","37fe73fe":"sns.pairplot(df, hue='Outcome')","85101582":"corr_matrix = df.corr()\ncorr_matrix.style.background_gradient(cmap='coolwarm')\n\n# Here we can see that some of the colums have very close correlations to the target columns such as \n# Pregnancies,Glucose,SkinThickness,Insulin,BMI and Age","ad98ba0b":"df.drop_duplicates(keep = False, inplace = True)","f5fed0f9":"g = sns.countplot(x = df['Outcome'])\nplt.show()\n\n# Target data is quite normal for now but if the result of \n#the model need to be upgraded so we gonna balance target","057815e8":"from imblearn.over_sampling import RandomOverSampler\nfrom imblearn.under_sampling import RandomUnderSampler \nfrom collections import Counter \n\n\ny = df['Outcome']\nX = df.drop(['Outcome'],axis=1)\n\n# instantiating the random over sampLer \nros = RandomOverSampler()\n # resampLing X, y x_ros, y_\nX_ros, y_ros = ros.fit_resample(X, y) \n# new class distribution\nprint(Counter(y_ros))","08633e5c":"from sklearn.model_selection import train_test_split\n\n\nX_train, X_test, y_train, y_test = train_test_split(X_ros,y_ros, test_size = 0.20, random_state = 101)\n\n# shapes must be the same \nprint(X_train.shape, X_test.shape)\nprint(y_train.shape, y_test.shape)","092f3c04":"# Scaling the data and target for KNN to get better result. Using MinMax scaling method for this.\n\nfrom sklearn.preprocessing import MinMaxScaler\n\nscaling = MinMaxScaler()\nX_train_minmax = scaling.fit_transform(X_train)\nX_test_minmax = scaling.fit_transform(X_test)","b312a4cd":"# Training scaled test and train dataset\n\nfrom sklearn.neighbors import KNeighborsClassifier\n# importing needed libraries for evaluating models \nfrom sklearn.metrics import classification_report,confusion_matrix \nfrom sklearn.metrics import accuracy_score\n\nknn = KNeighborsClassifier(n_neighbors=1)\nknn.fit(X_train_minmax, y_train)\nknn_pred = knn.predict(X_test_minmax)\n\n# Evaluating Model\nprint(accuracy_score(y_test, knn_pred))\nprint(confusion_matrix(y_test, knn_pred))\nprint(classification_report(y_test, knn_pred))\n","bb92bb9e":"from sklearn.tree import DecisionTreeClassifier\n\ndt = DecisionTreeClassifier()\ndt.fit(X_train, y_train)\nDtree_pred = dt.predict(X_test)\n\n\n\n\nprint(accuracy_score(y_test, Dtree_pred))\nprint(confusion_matrix(y_test, Dtree_pred))\nprint(classification_report(y_test, Dtree_pred))\n","3c084461":"from sklearn.svm import SVC\nfrom sklearn.metrics import accuracy_score\n\nmodel = SVC()\nmodel.fit(X_train,y_train)\nsvm_pred = model.predict(X_test)\n\n# Evaluating Model\nprint(accuracy_score(y_test, svm_pred).round(3))\nprint(confusion_matrix(y_test, svm_pred))\nprint(classification_report(y_test, svm_pred))","392ac9fa":"from sklearn.ensemble import RandomForestClassifier\nclf = RandomForestClassifier(max_depth=14, random_state=101)\nclf.fit(X_train, y_train)\nrf = clf.predict(X_test)\n\n# Evaluating Model\nprint(accuracy_score(y_test, rf))\nprint(confusion_matrix(y_test, rf))\nprint(classification_report(y_test, rf))","f1c483bb":"# trying with cross validation\nfrom sklearn.model_selection import cross_val_score\n\nscore = cross_val_score(clf, X_train, y_train, cv=100)\nscore.mean()\n","20434c15":"## GradientBoostingRegressor \nfrom sklearn.ensemble import GradientBoostingClassifier\n\ngb = GradientBoostingClassifier()\ngb.fit(X_train, y_train)\ngb_pred = gb.predict(X_test)\n\n# Evaluating Model\nprint(accuracy_score(y_test, gb_pred))\nprint(confusion_matrix(y_test, gb_pred))\nprint(classification_report(y_test, gb_pred))","8e4d83ce":"from sklearn.ensemble import ExtraTreesClassifier\next = ExtraTreesClassifier()\next.fit(X_train, y_train)\nET_pred = ext.predict(X_test)\n\n# Evaluating Model\nprint(accuracy_score(y_test, ET_pred))\nprint(confusion_matrix(y_test, ET_pred))\nprint(classification_report(y_test, ET_pred))","ba432f87":"# Part - 2 Training dataset to different Classification Models","4b967179":"## Importing libraries ","b9443f24":"## 2.7 - Extra Tree","7ee611c8":"## 1.5 - Checking the data distribution of the columns ","c3d9df52":"# Diabetes Classification \nThis project and its Classification Model aims to identify whether patients have <b>DIABETES<\/b> or not by analyzing results of their other medical analyses and features.\n\n## What is Diabetes \n\nDiabetes is a condition in which the body cannot use the sugars and starches (carbohydrates) it takes in as food to make energy. The body either makes no insulin or too little insulin or cannot use the insulin it makes to change those sugars and starches into energy. As a result, extra sugar builds up in the blood.(2020, U.S. Department of Health & Human Services)\n\nThe three most common types of diabetes are:\n\n<b>Type 1 :<\/b> In type 1 diabetes, your immune system mistakenly treats the beta cells in your pancreas that make insulin as foreign invaders and destroys them. This can happen over a few weeks, months, or years.(2022, American Diabetes Association)\n\n<b>Type 2 :<\/b> In type 2 diabetes, your body does not use insulin properly. This is called insulin resistance. At first, the beta cells make extra insulin to make up for it. But, over time your pancreas can't make enough insulin to keep your blood sugar at normal levels. Type 2 diabetes develops most often in middle-aged and older adults but can appear in young people.(2022, American Diabetes Association)\n\n<b>Gestational :<\/b> Gestational diabetes is diabetes that develops during pregnancy. For most women, blood sugar levels will return to normal after giving birth. (2022, American Diabetes Association)\n    \n    \n### Pregnancies \nNormally, various hormones work to keep your blood sugar levels in check. But during pregnancy, hormone levels change, making it harder for your body to process blood sugar efficiently. This makes your blood sugar rise.(2022, Mayo Foundation for Medical Education and Research (MFMER))\n\n### Glucose  \nDiabetes is a problem with your body that causes blood sugar (also called blood glucose) levels to rise higher than normal. This is also called hyperglycemia.(2022, American Diabetes Association)\n\nWhen you eat, your body breaks food down into sugar and sends it into the blood. Insulin then helps move the sugar from the blood into your cells. When sugar enters your cells, it is either used as fuel for energy right away or stored for later use. In a person with diabetes, there is a problem with insulin.(2022, American Diabetes Association)\n\n<b>Fasting Blood Sugar Test<\/b>\nThis measures your blood sugar after an overnight fast (not eating). A fasting blood sugar level of 99 mg\/dL or lower is normal, 100 to 125 mg\/dL indicates you have prediabetes, and 126 mg\/dL or higher indicates you have diabetes.(2022, Centers for Disease Control and Prevention)\n\n### Blood Pressure\nBlood pressure is the pressure your heart uses to push blood through your blood vessels and around your body. \n\nThere are two numbers used to describe blood pressure and it\u2019s measured in millimetres of mercury (mmHg). It\u2019s written like this: 130\/80mmHg. And you\u2019ll hear your doctor say '130 over 80'. \n\nThe first number is the systolic pressure. This is the most amount of pressure your heart uses when beating to push the blood around your body. \nThe second number is the diastolic pressure. This is the least amount of pressure your heart uses when it is relaxed between beats.\n\n**Blood pressure should be below 140\/80mmHg for people with diabetes or below 130\/80mmHg if you have kidney or eye disease or any condition that affects blood vessels and blood supply to the brain** (2022, The British Diabetic)\n\n### Skin Thickness\n**In fact, skin problems are sometimes the first sign that a person has diabetes.**\nThe average Skin Thicknes for patience who has diabetes is 29.15 +-\n\n### Insulin\nInsulin helps control blood glucose levels by signaling the liver and muscle and fat cells to take in glucose from the blood. Insulin therefore helps cells to take in glucose to be used for energy.(2022, The British Diabetic)\n\n\n### BMI\n\nBMI (Body Mass Index) is a number calculated by dividing a person's weight in kilograms by his or her height in meters squared. BMI is a useful tool used in determining the degree of an individual's excess weight.\n\nBeing overweight **(BMI of 25-29.9)**, or affected by obesity **(BMI of 30-39.9)** or morbid obesity **(BMI of 40 or greater)**, greatly increases your risk of developing type 2 diabetes. The more excess weight you have, the more resistant your muscle and tissue cells become to your own insulin hormone. More than 90 percent of people with type 2 diabetes are overweight or affected by a degree of obesity. (2011, Obesity Action Coalition (OAC))\n\n### Diabetes Pedugree Function\nDiabetes pedigree function (a function which scores likelihood of diabetes based on family history)\n\n### Age\nAge is a big risk factor for type 2. The older you are, the more likely you are to have it. That also holds true for preteens and teenagers, whose diabetes rates have climbed sharply in recent years.(2020, WebMD, LLC)","5300a772":"## 1.8 -  Visualizing the target variable to check its balance","e6040392":"## 1.2 - Checkin for how many 0 values Insulin column has","c21033a3":"## 2.1 - Splitting data to train and test ","f487fbc8":"## 2.5 - Random forest ","da162bbc":"## 1.6 - Checking the correlation of the colums to each other ","e3bca60a":"## Part 1 : Understanding the dataset","3ac256e9":"## 2.3 - DecisionTreeClassifier","8e3a73c0":"## 2.4 - Support Vector Machine","80042c45":"## 1.7 - Dropping ALL duplicate values in case ","f7f03695":"## Reading the Dataset","9a17268a":"## 1.3 - Replacing 0 values the colums mean","20f89a39":"## 2.2 - KNeighborsClassifier","37683c2f":"## 1.4 - Changing data type of the insulin to as before to integer ","fc09538a":"## 2.6 - GradientBoostingRegressor","56e0bb31":"## 1.9 - Balancing the target data \nTried train the model without balancing the target but the results were not satisfying ","9ea1e052":"## Conclusion \nAs you can see we have tried various models and from my point of view Random forest and Extra Classifier model has the best prediction for diabetes for now. But I am going to improve and update these models later on. I also have tried these models with new test data and got 1.0 accuracy for both models. You can check that on my GitHub here (https:\/\/github.com\/IscoDav\/Diabetes-analysis) ","a09f4ec6":"## 1.1 -  Checking for null values"}}