{"cell_type":{"a22ef90a":"code","b1ca4487":"code","8e4a4a2d":"code","da1c1c80":"code","d0187f7a":"code","38f68f1a":"code","5c545203":"code","a3910e83":"code","a52ce48f":"code","b35a56c6":"code","8a584af2":"code","0e2b0027":"code","f7c67aed":"code","2c618d94":"code","00790275":"code","5b99f8b4":"code","5c4b82ad":"code","67e4d321":"code","f0c3a33c":"markdown","cad101e8":"markdown","0cc08024":"markdown","a3011664":"markdown","c29f4515":"markdown","19d15de1":"markdown","aa927bf2":"markdown","b817b084":"markdown","e4ff1ae3":"markdown","c42fcd1c":"markdown","1fdf7ac6":"markdown","7e2eef79":"markdown","ac4bfaba":"markdown","0e7b442e":"markdown","b9df7869":"markdown","0bda69c2":"markdown"},"source":{"a22ef90a":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","b1ca4487":"sv = pd.read_csv('..\/input\/usa-covid19-vaccinations\/us_state_vaccinations.csv')\ncc = pd.read_csv('..\/input\/covid19-us-county-jhu-data-demographics\/covid_us_county.csv')\nci = pd.read_csv('..\/input\/covid19-us-county-jhu-data-demographics\/us_county.csv')\nvote = pd.read_csv(\"..\/input\/2020-us-presidential-election-results-by-state\/voting.csv\")","8e4a4a2d":"sv = sv[sv.date == \"2021-03-01\"]","da1c1c80":"sv #State vaccine distribution data","d0187f7a":"cc # County covid case data","38f68f1a":"ci #County Information (to get county population)","5c545203":"vote #Vote counts and percentages for Trump and Biden in the 2020 election","a3910e83":"county_merged = pd.merge(cc, ci, how='left', on='fips' )\ncounty_merged2 = county_merged.groupby(\"county_x\").agg({\"state_x\": \"min\", \"cases\": \"max\", \"deaths\": \"max\", \"population\": \"mean\"})","a52ce48f":"state_merged = county_merged2.groupby(\"state_x\").sum()\nstate_merged[\"cases_per_hundred\"] = (state_merged[\"cases\"] \/ state_merged[\"population\"]) * 100\nstate_merged[\"deaths_per_hundred\"] = (state_merged[\"deaths\"] \/ state_merged[\"population\"]) * 100","b35a56c6":"data = pd.merge(state_merged, sv, left_on= \"state_x\", right_on= \"location\")","8a584af2":"data = pd.merge(data, vote, left_on = \"location\", right_on = \"state\")\ndata = data[[\"location\", \"cases_per_hundred\", \"deaths_per_hundred\", \"people_vaccinated_per_hundred\", \"population\", \"biden_pct\", \"biden_win\"]]\ndata","0e2b0027":"import matplotlib.colors as mcol\nimport matplotlib.cm as cm\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pylab as plt\nimport seaborn as sns\nplt.style.use('fivethirtyeight')\n","f7c67aed":"x = data.biden_pct\ny = data.cases_per_hundred\nz = data.population\/50000\n \ncm1 = mcol.LinearSegmentedColormap.from_list(\"MyCmapName\",[\"r\",\"b\"])\nplt.scatter(x, y, s=z, c=x, cmap=cm1, alpha=.8, edgecolors=\"grey\", linewidth=2)\nplt.plot(x, np.poly1d(np.polyfit(x, y, 1))(x), alpha = .5)\n\nplt.xlabel(\"Biden Vote Percentage\")\nplt.ylabel(\"Covid Cases per 100\")\nplt.title(\"Progressive states have had better virus prevention...\")\n \nplt.show()\n","2c618d94":"x = data.biden_pct\ny = data.people_vaccinated_per_hundred\nz = data.population\/50000\n \ncm1 = mcol.LinearSegmentedColormap.from_list(\"MyCmapName\",[\"r\",\"b\"])\nplt.scatter(x, y, s=z, c=x, cmap=cm1, alpha=.8, edgecolors=\"grey\", linewidth=2)\nplt.plot(x, np.poly1d(np.polyfit(x, y, 1))(x), alpha = .5) \n\nplt.xlabel(\"Biden Vote Percentage\")\nplt.ylabel(\"Vaccinations per 100\")\nplt.title(\"...and slightly better vaccine distribution\")\n \nplt.show()","00790275":"from mpl_toolkits import mplot3d","5b99f8b4":"z = data.people_vaccinated_per_hundred\nx = data.biden_pct\ny = data.cases_per_hundred\n \n# Creating figure\nfig = plt.figure(figsize = (10, 7))\nax = plt.axes(projection =\"3d\")\nax.scatter3D(x, y, z, c = x, cmap = cm1)\nplt.title(\"Partisan lean vs Covid cases per 100 vs Vaccines given per 100\")\nxLabel = ax.set_xlabel(\"Biden Vote Percentage\", linespacing=3.2)\nyLabel = ax.set_ylabel(\"Covid Cases Per 100\", linespacing=3.1)\nzLabel = ax.set_zlabel(\"Vaccinations Per 100\", linespacing=3.4)\n \n# show plot\nplt.show()","5c4b82ad":"!pip install vega_datasets","67e4d321":"import altair as alt\nfrom vega_datasets import data\npop = data.population_engineers_hurricanes()\nvote = pd.merge(vote, pop)\ncovid = county_merged[county_merged.date == \"2021-02-05\"]\nstates = alt.topo_feature(data.us_10m.url, 'states')\n\nvariable_list = ['biden_pct', 'biden_vote', 'biden_win']\n\nbackground = alt.Chart(states).mark_geoshape().encode(\n    color=alt.Color('biden_pct:Q', scale=alt.Scale(scheme='redblue')),\n).transform_lookup(\n    lookup='id',\n    from_=alt.LookupData(vote, 'id', list(vote.columns))\n).properties(\n    width=1000,\n    height=600\n).project(\n    type='albersUsa'\n)\n\npoints = alt.Chart(covid).mark_circle().encode(\n    longitude='long_x',\n    latitude='lat_x',\n    size=alt.Size('cases', scale=alt.Scale(range=[10, 500])),\n    tooltip='county_x'\n)\n\nbackground + points","f0c3a33c":"# Create 3d plot of Vote count (x), Case count (y), and Vaccine distribution (z)","cad101e8":"Aggregate county case count totals by state to get totals for each state, and create column for cases per 100 people and deaths per 100 people","0cc08024":"Merge state case count totals with vaccination totals ","a3011664":"# Merge data","c29f4515":"Reduce data to get only the columns we need for this analysis","19d15de1":"# Get most recent vaccination data ","aa927bf2":"# Mapping cases counts and vote share","b817b084":"# Create scatter plot - Vaccine distribution vs Biden vote count by state","e4ff1ae3":"# Next steps\n\n1. Visualize relationship between Case count\/vaccine distribution and Political lean by **country**. This will entail using a different proxy for partisan lean (Government structure? Social progress index? Other Ideas?)\n2. Visualize relationships by state for death counts, as well as hospitalizations and mask wearing","c42fcd1c":"Aggregate by county to get totals for each county","1fdf7ac6":"# Visualizing the rekationships with scatter plots","7e2eef79":"# What can we learn from this\n\nThe data shows some accuracy on a US State level to the claims of the author of the NYT article, as more liberal states have had fewer Covid Cases per capita, but fewer vaccines distrivuted per capita as well. Of course, no causal relationship can be proven, as many confounding variables (population density for one) are at play. ","ac4bfaba":"# A recent [New York Times article](https:\/\/www.nytimes.com\/2021\/02\/05\/briefing\/marjorie-taylor-greene-uk-vaccine-biden-stimulus.html) asked why left leaning states\/countries have had better Covid prevention, but worse vaccine distribution. This notebook seeks to visualize that pattern at the US State level. I will examine and visualize the relationship between Covid cases per capita and political lean of a state, as well as vaccine distribution per capita and political lean by state. I will use Biden's vote percentage for each state as a proxy for the partisan lean of a state.\n\n# Please leave a comment with any feedback or suggestions!","0e7b442e":"# Import data\n* sv - Vaccination distribution data by state per day\n* cc - Covid cases by county per day\n* ci - Information on each county\n* vote - Each states vote shares for Trump and Biden in the 2020 election","b9df7869":"# Preview the data","0bda69c2":"# Create scatter plot - Covid Cases vs Biden vote count by state"}}