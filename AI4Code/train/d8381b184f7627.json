{"cell_type":{"bd3f36d0":"code","cce87849":"code","c8c1d211":"code","be0ca29e":"code","d430ccec":"code","604f0645":"code","4910048b":"code","e4e8b321":"code","5609be79":"code","d5bd7553":"code","c7d9fd1e":"code","78bcad08":"code","d4efd5cb":"code","7b074bfb":"code","d7a975ea":"code","76942a1e":"code","8e1cf30c":"code","c98afec9":"code","127070c4":"code","0bb91b6a":"code","8558ca2e":"code","e9799221":"code","d15b9900":"code","374b924d":"code","7399ebd1":"markdown","580f9331":"markdown"},"source":{"bd3f36d0":"#loading the packages\nimport numpy as np\nimport pandas as pd\nimport os\nimport seaborn as sns\nimport matplotlib.pyplot as plt","cce87849":"os.listdir('..\/input\/')","c8c1d211":"df1 = pd.read_csv('..\/input\/netflix-prize-data\/combined_data_1.txt',header=None ,\n                  names = ['CusId','Rating'], usecols = [0,1])","be0ca29e":"df1","d430ccec":"df1['Rating'].dtype","604f0645":"print(f\"Total samples are { int(df1.shape[0]\/1000000)}M\")","4910048b":"print(\"reloading all the other files as well\")\ndf2 = pd.read_csv('\/content\/combined_data_2.txt',header=None ,\n                  names = ['CusId','Rating'], usecols = [0,1])\ndf3 = pd.read_csv('\/content\/combined_data_3.txt',header=None ,\n                  names = ['CusId','Rating'], usecols = [0,1])\ndf4 = pd.read_csv('\/content\/combined_data_4.txt',header=None ,\n                  names = ['CusId','Rating'], usecols = [0,1])\n\nprint(f\"Total samples in the 2nd file are { int(df2.shape[0]\/1000000)}M\")\nprint(f\"Total samples in the 3nd file are { int(df3.shape[0]\/1000000)}M\")\nprint(f\"Total samples in the 4nd file are { int(df4.shape[0]\/1000000)}M\")","e4e8b321":"df = df1\ndf = df1.append(df2)\ndf = df.append(df3)\ndf = df.append(df4)","5609be79":"df","d5bd7553":"df.index = np.arange(0,len(df))","c7d9fd1e":"\ndf.index = np.arange(0,len(df))\nprint('Full dataset shape: {}'.format(df.shape))\nprint('-Dataset examples-')\nprint(df.iloc[::5000000, :])","78bcad08":"#plotting the data\n#p = df.groupby('Rating')['Rating'].agg(['count'])\n\n#getting movie count\nmovie_count = df.isnull().sum()\nmovie_count","d4efd5cb":"df.groupby('Rating')['Rating'].sum()","7b074bfb":"count_nan =  df.groupby('Rating')['Rating'].agg(['count'])\ncount_nan","d7a975ea":"plt.title(\"No of null Ratings per rank\")\nsns.barplot(x = count_nan.index , y = count_nan['count'])","76942a1e":"#removing missing values\ndf.dropna()","8e1cf30c":"movies = pd.read_csv('movie_titles.csv',encoding='ISO-8859-1',names = ['YEAR','MOVIE'])\nmovies","c98afec9":"#finding nan colums\nmovies.isnull()","127070c4":"movies.isnull().sum()","0bb91b6a":"print(\"listing no of movies without years\")\nmovies[pd.isnull(movies).any(axis =1 )]","8558ca2e":"movies.at[4388,'YEAR'] = 2001\nmovies.at[4794,'YEAR'] = 2001\nmovies.at[7241,'YEAR'] = 2001\nmovies.at[10782,'YEAR'] = 1974\nmovies.at[15918,'YEAR'] = 1999\nmovies.at[16678,'YEAR'] = 1994\nmovies.at[17667,'YEAR'] = 1999","e9799221":"movies.isnull().sum()","d15b9900":"movies['YEAR'].dtype","374b924d":"#converting into Integer\nmovies['YEAR'].astype(np.int32)","7399ebd1":"### adding the missing year of movies manually","580f9331":"### 7 movies doesnot have year values"}}