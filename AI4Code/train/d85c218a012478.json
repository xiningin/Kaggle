{"cell_type":{"3e6a0764":"code","8bd31f67":"code","3ca60c74":"code","ff498b36":"code","cea439e1":"code","c5b75d32":"code","1da30b28":"code","3fbef3ff":"code","4d7c11e8":"code","27836dd7":"code","435098b2":"code","d9791f92":"code","0e78feac":"code","2e849962":"markdown","26167e03":"markdown","612050be":"markdown","a0872604":"markdown","fb065d81":"markdown","73dfd2c5":"markdown","43fbee16":"markdown","997b9345":"markdown","5f086446":"markdown","9daea26d":"markdown"},"source":{"3e6a0764":"import pandas as pd\nimport numpy as np\nimport nltk\nimport string\nimport re\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.ensemble import RandomForestClassifier, AdaBoostClassifier\nfrom sklearn.svm import LinearSVC\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.naive_bayes import MultinomialNB\nfrom nltk.stem import WordNetLemmatizer\nfrom nltk.corpus import stopwords\n\nfrom sklearn.metrics import f1_score\n\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline","8bd31f67":"train = pd.read_csv('..\/input\/climate-change-edsa2020-21\/train.csv')\ntest = pd.read_csv('..\/input\/climate-change-edsa2020-21\/test.csv')","3ca60c74":"train.sentiment.value_counts()","ff498b36":"y = train['sentiment']\nX = train['message']","cea439e1":"vectorizer = TfidfVectorizer(ngram_range=(1,2), min_df=2, stop_words=\"english\")\nX_vectorized = vectorizer.fit_transform(X)","c5b75d32":"X_train,X_val,y_train,y_val = train_test_split(X_vectorized,y,test_size=.3,shuffle=True, stratify=y, random_state=11)","1da30b28":"rfc = RandomForestClassifier()\nrfc.fit(X_train, y_train)\nrfc_pred = rfc.predict(X_val)","3fbef3ff":"f1_score(y_val, rfc_pred, average=\"macro\")","4d7c11e8":"testx = test['message']\ntest_vect = vectorizer.transform(testx)","27836dd7":"y_pred = rfc.predict(test_vect)","435098b2":"test['sentiment'] = y_pred","d9791f92":"test.head()","0e78feac":"test[['tweetid','sentiment']].to_csv('testsubmission.csv', index=False)","2e849962":"## Checking the performance of our model on the validation set","26167e03":"## Making predictions on the test set and adding a sentiment column to our original test df","612050be":"## Load in your data from kaggle.  \nBy working in a kaggle kernel, you can access the data directly from the competition, as well as make your submission without downloading your output file","a0872604":"## Creating an output csv for submission","fb065d81":"## Training the model and evaluating using the validation set ","73dfd2c5":"## Import the necessary libraries","43fbee16":"## Splitting out the X variable from the target","997b9345":"## Turning text into something your model can read","5f086446":"## Splitting the training data into a training and validation set","9daea26d":"## Getting our test set ready "}}