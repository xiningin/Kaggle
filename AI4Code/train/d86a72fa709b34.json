{"cell_type":{"ef30bb69":"code","9a575cea":"code","dd46b3da":"code","2563cca3":"code","7a19fa05":"code","cbd13d50":"code","05cf92de":"code","532edec7":"code","36120c37":"code","a7b287fe":"code","29c50137":"code","e6c59f3f":"code","2b4185af":"code","981c615e":"code","4749f9dc":"code","58d32da6":"code","19c41a18":"markdown","6ba22d4c":"markdown"},"source":{"ef30bb69":"import numpy as np \nimport pandas as pd\nfrom sklearn.tree import DecisionTreeClassifier","9a575cea":"path='..\/input\/drug-data\/drug200.csv'\ndf = pd.read_csv(path)\ndf.head()","dd46b3da":"df.shape\n# size of data","2563cca3":"#X as the Feature Matrix (data of my_data)\nX = df[['Age', 'Sex', 'BP', 'Cholesterol', 'Na_to_K']].values\nX[0:5]\n","7a19fa05":"# convert categorical variables into numerical values\nfrom sklearn import preprocessing\nle_Sex = preprocessing.LabelEncoder()\nle_Sex.fit(['F','M'])\nX[:,1] = le_Sex.transform(X[:,1]) \n\n\nle_BP = preprocessing.LabelEncoder()\nle_BP.fit([ 'LOW', 'NORMAL', 'HIGH'])\nX[:,2] = le_BP.transform(X[:,2])\n\n\nle_Cholesterol = preprocessing.LabelEncoder()\nle_Cholesterol.fit([ 'NORMAL', 'HIGH'])\nX[:,3] = le_Cholesterol.transform(X[:,3]) \n\nX[0:5]\n","cbd13d50":"y = df[\"Drug\"]\ny[0:5]","05cf92de":"#Setting up the Decision Tree\n#  importing train_test_split from sklearn.cross_validation\nfrom sklearn.model_selection import train_test_split","532edec7":"X_trainset, X_testset, y_trainset, y_testset = train_test_split(X, y, test_size=0.3, random_state=3)","36120c37":"#Printing the shape of X_trainset and y_trainset\nprint('Shape of X training set {}'.format(X_trainset.shape),'&',' Size of Y training set {}'.format(y_trainset.shape))\n\nprint('Shape of X testing set {}'.format(X_testset.shape),'&',' Size of Y testing set {}'.format(y_testset.shape))","a7b287fe":"#Modeling\n# Creating DecisionTreeClassifier called drugTree\ndrugTree = DecisionTreeClassifier(criterion=\"entropy\", max_depth = 4)\ndrugTree # it shows the default parameters","29c50137":"#fit the data with the training feature matrix X_trainset and training response vector y_trainset\ndrugTree.fit(X_trainset,y_trainset)","e6c59f3f":"#Prediction\n#predictions on the testing dataset and store it into a variable called predTree\npredTree = drugTree.predict(X_testset)","2b4185af":"print (predTree [0:5])\nprint (y_testset [0:5])","981c615e":"#Evaluation\n#importing metrics from sklearn and check the accuracy of our model\nfrom sklearn import metrics\nimport matplotlib.pyplot as plt\nprint(\"DecisionTrees's Accuracy: \", metrics.accuracy_score(y_testset, predTree))","4749f9dc":"#Visualization\n!conda install -c conda-forge pydotplus -y\n!conda install -c conda-forge python-graphviz -y\nfrom  io import StringIO\nimport pydotplus\nimport matplotlib.image as mpimg\nfrom sklearn import tree\n%matplotlib inline ","58d32da6":"dot_data = StringIO()\nfilename = \"drugtree.png\"\nfeatureNames = df.columns[0:5]\nout=tree.export_graphviz(drugTree,feature_names=featureNames, out_file=dot_data, class_names= np.unique(y_trainset), filled=True,  special_characters=True,rotate=False)  \ngraph = pydotplus.graph_from_dot_data(dot_data.getvalue())  \ngraph.write_png(filename)\nimg = mpimg.imread(filename)\nplt.figure(figsize=(100, 200))\nplt.imshow(img,interpolation='nearest')","19c41a18":"Imagine that you are a medical researcher compiling data for a study. You have collected data about a set of patients, all of whom suffered from the same illness. During their course of treatment, each patient responded to one of 5 medications, Drug A, Drug B, Drug c, Drug x and y.\n\nPart of your job is to build a model to find out which drug might be appropriate for a future patient with the same illness. The features of this dataset are Age, Sex, Blood Pressure, and the Cholesterol of the patients, and the target is the drug that each patient responded to.\n\nIt is a sample of multiclass classifier, and you can use the training part of the dataset to build a decision tree, and then use it to predict the class of an unknown patient, or to prescribe a drug to a new patient.","6ba22d4c":"Table of contents\n1. About the dataset\n2. Downloading the Data\n3. Pre-processing\n4. Setting up the Decision Tree\n5. Modeling\n6. Prediction\n7. Evaluation\n8. Visualization"}}