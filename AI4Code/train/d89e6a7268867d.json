{"cell_type":{"01e41f6d":"code","513d525f":"code","6dc42f07":"code","c62579e0":"code","aa9469d0":"code","ef4543a1":"code","228384bb":"code","3f7bbaea":"code","982790a1":"code","750bc5c0":"code","84f15853":"code","575fffff":"code","4319d552":"code","ad2b42e9":"code","651e6143":"code","f8697ab1":"markdown"},"source":{"01e41f6d":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","513d525f":"from fastai import *\nfrom fastai.vision import *\nfrom fastai.metrics import error_rate\nimport os\nimport pandas as pd\nimport numpy as np","6dc42f07":"x  = '\/kaggle\/input\/blood-cells\/dataset2-master\/dataset2-master\/images\/TRAIN'\npath = Path(x)\npath.ls()","c62579e0":"np.random.seed(40)\ndata = ImageDataBunch.from_folder(path, train = '.', valid_pct=0.2,\n                                  ds_tfms=get_transforms(), size=224,\n                                  num_workers=4).normalize(imagenet_stats)","aa9469d0":"data.show_batch(rows=3, figsize=(7,6),recompute_scale_factor=True)","ef4543a1":"data","228384bb":"print(data.classes)\nlen(data.classes),data.c","3f7bbaea":"learn = cnn_learner(data, models.resnet18, metrics=[accuracy], model_dir = Path('..\/kaggle\/working'),path = Path(\".\"))","982790a1":"learn","750bc5c0":"learn.lr_find()\nlearn.recorder.plot(suggestions=True)","84f15853":"lr1 = 1e-4\nlr2 = 1e-1\nlearn.fit_one_cycle(5,slice(lr1,lr2))","575fffff":"img = open_image('\/kaggle\/input\/blood-cells\/dataset2-master\/dataset2-master\/images\/TRAIN\/LYMPHOCYTE\/_26_106.jpeg')\nprint(learn.predict(img)[0])\nimg","4319d552":"print(learn.predict(img)[0])","ad2b42e9":"learn.export(file = Path(\"\/kaggle\/working\/export.pkl\"))\n","651e6143":"learn.model_dir = \"\/kaggle\/working\"\nlearn.save(\"stage-1\",return_path=True)","f8697ab1":"**Ketaki Keluskar\nTEIT-A\n191258**"}}