{"cell_type":{"e33b6ce4":"code","2fad16f6":"code","5a34d1de":"code","66111926":"code","02145e38":"code","7f9081e4":"code","f0d09d60":"code","eb6062ec":"code","56a6e80a":"code","0cd4ee45":"code","940b14cf":"code","00fbb6bc":"code","a8d34b63":"markdown","107c0cc1":"markdown","35b4db53":"markdown"},"source":{"e33b6ce4":"import pandas as pd\nfrom google.cloud import bigquery\nfrom bq_helper import BigQueryHelper","2fad16f6":"QUERY = \"\"\"SELECT\n  state_name,\n  COUNT(consecutive_number) AS accidents,\n  SUM(number_of_fatalities) AS fatalities,\n  SUM(number_of_fatalities) \/ COUNT(consecutive_number) AS fatalities_per_accident\nFROM\n  `bigquery-public-data.nhtsa_traffic_fatalities.accident_{0}`\nGROUP BY\n  state_name\nORDER BY\n  fatalities_per_accident DESC\"\"\"","5a34d1de":"bq_assistant = BigQueryHelper(\"bigquery-public-data\", \"nhtsa_traffic_fatalities\")","66111926":"bq_assistant.estimate_query_size(QUERY.format(2015))","02145e38":"df_2015 = bq_assistant.query_to_pandas(QUERY.format(2015))","7f9081e4":"df_2015.head()","f0d09d60":"df_2016 = bq_assistant.query_to_pandas(QUERY.format(2016))","eb6062ec":"df_2016.head()","56a6e80a":"type(df_2016)","0cd4ee45":"df_2016.describe()","940b14cf":"df_2016.shape","00fbb6bc":"!ls","a8d34b63":"That's less than one MB, we should be able to run as many variations of it as we want.","107c0cc1":"Looks like the Midwest has the most fatalities per accident. My best guess is that families tend to carpool more since they're driving longer distances than the more densely populated parts of the country, but we'd have to dig deeper into the data to get an informed answer.","35b4db53":"Let's check the size of the query before we run anything."}}