{"cell_type":{"99bfc298":"code","4243a7ce":"code","c855ee8b":"code","612d7add":"code","6ea615c9":"code","df24bd71":"code","82117da0":"code","d147cd5c":"code","bddb92eb":"code","c35f7a09":"code","ad8df1a8":"code","d4102811":"code","6cef8dfe":"code","29ee9ed7":"code","265fe1e6":"code","0805d149":"code","c331202c":"code","557a6d62":"code","9c835eb3":"code","db9b365e":"code","7839313e":"code","323b53d0":"code","8551f437":"code","912f4114":"markdown","70b548e2":"markdown","9b99e1a4":"markdown","93956a2d":"markdown","8f638a02":"markdown","3342b3e2":"markdown","4519fa81":"markdown","cc41fa02":"markdown"},"source":{"99bfc298":"import numpy as np\nimport pandas as pd\nimport seaborn as sb\nimport matplotlib.pyplot as plt\n%matplotlib inline\npd.set_option(\"display.max_columns\", None)","4243a7ce":"data_df = pd.read_csv('..\/input\/telco-customer-churn\/WA_Fn-UseC_-Telco-Customer-Churn.csv')","c855ee8b":"data_df.head(5)","612d7add":"data_df.info()","6ea615c9":"data_df.nunique()","df24bd71":"sb.catplot(data=data_df, kind='count', x='Churn', order=['Yes','No'], col='gender')","82117da0":"sb.catplot(data=data_df, kind='count', x='Churn', order=['Yes','No'], col='InternetService')\nsb.catplot(data=data_df, kind='count', x='Churn', order=['Yes','No'], col='OnlineSecurity')\nsb.catplot(data=data_df, kind='count', x='Churn', order=['Yes','No'], col='TechSupport')\nsb.catplot(data=data_df, kind='count', x='Churn', order=['Yes','No'], col='Contract')","d147cd5c":"sb.catplot(data=data_df, kind='count', x='Churn', order=['Yes','No'], col='PaymentMethod')","bddb92eb":"dum_columns = data_df.columns[data_df.nunique().values<5]","c35f7a09":"dum_data = pd.get_dummies(data_df, columns=dum_columns)\ndum_data.head()","ad8df1a8":"plt.figure(figsize=(18,14))\nsb.heatmap(dum_data.corr())\nplt.tight_layout\n# It seems we have many columns to deal with","d4102811":"def find_corr_with (Data,column,num_of_corr_cols) :\n\n    corr = Data.corr()[column].reindex(Data.corr().drop(column,axis=1).columns)\n    corr = corr.sort_values()\n    corr = corr[::-1]\n    \n    return corr.head(num_of_corr_cols)","6cef8dfe":"corr_cols = find_corr_with(dum_data, 'Churn_Yes', 10)\ncorr_cols","29ee9ed7":"corr_data = dum_data[corr_cols.index]\ncorr_data","265fe1e6":"from sklearn.model_selection import train_test_split","0805d149":"X = corr_data\ny = dum_data['Churn_Yes']","c331202c":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)","557a6d62":"from sklearn.linear_model import LogisticRegression","9c835eb3":"model = LogisticRegression()","db9b365e":"model.fit(X_train,y_train)","7839313e":"predictions = model.predict(X_test)","323b53d0":"from sklearn.metrics import mean_squared_error","8551f437":"print('Training Score : ', model.score(X_train,y_train))\nprint('Test Score : ', model.score(X_test,y_test))\nprint('Error :', np.sqrt(mean_squared_error(predictions,y_test)))","912f4114":"## Getting dummies of non numirical columns :","70b548e2":"## Let's see which columns correlated churn :","9b99e1a4":"## Machine Learning Model :","93956a2d":"## Importing Libraries :","8f638a02":"## Reading Data :","3342b3e2":"### We thought that gender would make any difference but it seems to be not as we thought.\n### And as we see there are some reasons for churn :\n1. Internet Service = Fiber optic ---- (which means FI-OP service need some care)\n2. Online Security = No ---- (Online Security needs to be activated users)\n3. Tech Support = No ---- (Tech Support service need some care)\n4. Contract = Month to month ---- (We need to extend contract per 6 months for example)\n5. Payment Method = Electronic Check ---- (Maybe because it's an easy way!)","4519fa81":"## See some insights :","cc41fa02":"## Split Data to enter the Machine Learning model :"}}