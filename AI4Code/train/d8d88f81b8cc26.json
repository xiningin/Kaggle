{"cell_type":{"419f7cb0":"code","0979cfaf":"code","5bb6b952":"code","b7bd5cb3":"code","ab50d73f":"code","c2de704d":"code","b6c3c290":"code","0701093f":"code","307f8c64":"code","c67d7fbd":"code","cbf20ed9":"code","b2e2877f":"code","8f28537b":"code","73f99057":"code","6e6acfe6":"code","9e4cb856":"code","2fcee160":"code","9e6fb7e2":"code","375991fb":"code","08fd321b":"code","277111d0":"code","9b957640":"code","3b0c8f0b":"code","830a7e37":"code","fa761ba7":"code","aa83af66":"code","6c8f50ea":"code","fde7522c":"code","7f79c23f":"code","9f70b350":"code","f45647b9":"code","77a4c746":"code","c1e0c1c8":"code","0da1eb26":"code","0ec5af0d":"code","8e31fa2b":"code","2ba8702d":"code","8ef41505":"code","1ab65d21":"code","147ddebf":"code","225e3348":"code","de65873c":"code","ec15eee2":"code","e4fe7378":"code","c827aa76":"code","12f913af":"code","dd04708c":"code","eadc930e":"code","350c111d":"code","6649f7a9":"code","2170a52b":"code","52017188":"code","1ba81965":"code","1af45d8a":"code","e705ba36":"code","3a8bc0fd":"code","5cb32a19":"code","f0067699":"code","6c0ff61c":"code","4f686705":"code","534f6b96":"code","71b5fb16":"code","45e58125":"code","f8337b8b":"code","aa07572a":"code","b8d722dc":"code","bbee128b":"code","4d129fa8":"code","e1d3e8ca":"code","aa8e4d57":"code","51e2b3ae":"code","695fab68":"code","c1f0c4d0":"code","224f2d6f":"code","71422d9e":"markdown","343170ea":"markdown","d2ccc65a":"markdown","f5834705":"markdown","dd1952c2":"markdown","baf2f787":"markdown","62e3ede6":"markdown","5ec7f04e":"markdown","6b8b9446":"markdown","5f4c81e4":"markdown","6e86614d":"markdown","111185ad":"markdown","251e4761":"markdown","601784f9":"markdown","976626fa":"markdown","93d82d46":"markdown","28fa347c":"markdown","6dac70ec":"markdown","c92693cd":"markdown"},"source":{"419f7cb0":"# Basic\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport matplotlib.gridspec as gs\nimport seaborn as sns\n#import geoplotlib as geo\n\nfrom sklearn.preprocessing import MinMaxScaler\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","0979cfaf":"pd.set_option('display.max_colwidth', None) #Dispaly full questions","5bb6b952":"#Colors to be used in the plots\ncolors=[\"#f94144\",\"#f3722c\",\"#f8961e\",\"#f9c74f\",\"#90be6d\",\"#43aa8b\",\"#577590\"]\nsns.palplot(colors)","b7bd5cb3":"life_df = pd.read_csv('\/kaggle\/input\/european-union-lgbt-survey-2012\/LGBT_Survey_DailyLife.csv')\nlife_df.shape","ab50d73f":"life_df.head()","c2de704d":"# Display all the questions\nlife_df.question_label.unique()","b6c3c290":"life_df.question_code.unique()","0701093f":"life_df.answer.unique()","307f8c64":"life_df.loc[life_df.question_code.str.contains(\"b1\")].answer.unique()","c67d7fbd":"life_df.CountryCode.unique()","cbf20ed9":"life_df.isnull().sum()","b2e2877f":"life_df.notes.unique()","8f28537b":"life_df = life_df.drop(\"notes\", axis=1)\nlife_df.shape","73f99057":"life_df.dtypes","6e6acfe6":"life_df.percentage.unique()","9e4cb856":"# Clean & Convert\nlife_df.percentage = life_df.percentage.replace(\":\", 0)\nlife_df.percentage = life_df.percentage.astype(int)","2fcee160":"g1_df = life_df.loc[life_df.question_code.str.contains(\"g1\")]\ng1_df.shape","9e6fb7e2":"g1_df.question_label.unique()","375991fb":"g1_df.answer.unique()","08fd321b":"g1_df['score'] = np.zeros","277111d0":"g1_df.dtypes","9b957640":"g1_df.percentage = g1_df.percentage.replace(\":\", 0)  # dropna\ng1_df.percentage = g1_df.percentage.astype(int) # Cast to int","3b0c8f0b":"# Define scoring for g1\nscoring_g1 = {\"Yes\": 1,\n              \"No\": -1,\n              \"I do not have a partner (Does not apply to me)\": 0,\n              \"Don`t know\": 0.5}\n\n# Apply scoring g1\ng1_df['score'] = g1_df.answer.map(scoring_g1).mul(g1_df.percentage)\ng1_df = g1_df.drop('percentage', axis=1)","830a7e37":"g1_df.head()","fa761ba7":"g1_df = g1_df.loc[g1_df.subset.str.contains('Bisexual men|Bisexual women')]","aa83af66":"fig=plt.figure(figsize=(15,3))\nplt.title(\"\tDoes your current partner know that you are L, G, B or T?\",family='Serif', weight='bold', size=15)\nax = sns.barplot(x='score', y='CountryCode', hue='subset', data=g1_df.loc[g1_df.CountryCode.str.contains('Average')])","6c8f50ea":"g1_df.groupby('subset').mean().round(2)","fde7522c":"g1_df_c = g1_df.groupby('CountryCode').mean()","7f79c23f":"scaler = MinMaxScaler()\n\ng1_df_c['score_s'] = scaler.fit_transform(g1_df_c[['score']])","9f70b350":"np.std(g1_df_c)","f45647b9":"fig=plt.figure(figsize=(10,20))\nplt.title(\"Openess to a partner [%]\",family='Serif', weight='bold', size=15)\nax = sns.barplot(x='score', y='CountryCode', data=g1_df_c.sort_values('score', ascending=False).reset_index())","77a4c746":"g3_df = life_df.loc[life_df.question_code.str.contains(\"g3\")]\ng3_df.shape","c1e0c1c8":"g3_df.question_label.unique()","0da1eb26":"g3_df.answer.unique()","0ec5af0d":"# Define scoring for g3\nscoring_g3 = {\n            \"None\": 0,\n            \"A few\": 0.33,\n            \"Most\": 0.66,\n            \"All\": 1\n             }\n\n# Apply scoring g3\ng3_df['score'] = g3_df.answer.map(scoring_g3).mul(g3_df.percentage)\ng3_df = g3_df.drop('percentage', axis=1)","8e31fa2b":"fig=plt.figure(figsize=(5,10))\nplt.title(\"Openess\",family='Serif', weight='bold', size=20)\nax = sns.barplot(x='CountryCode', y='score', hue='subset', \n                 data=g3_df.loc[g3_df.CountryCode.str.contains('Average')], ci=68, palette=colors)","2ba8702d":"g3_df.loc[g3_df.subset.str.contains('Gay|Bisexual men')].groupby('subset').mean().round(2)","8ef41505":"res = g3_df.loc[g3_df.subset.str.contains('Bisexual men|Bisexual women')].mean() \/ g3_df.loc[g3_df.subset.str.contains('Gay|Lesbian')].mean()\nprint(\"Bisexual people are less open about theirs sexuality by\", (res*100).round(2))","1ab65d21":"g3_df_c = g3_df.groupby('CountryCode').mean()","147ddebf":"np.std(g3_df_c)","225e3348":"scaler = MinMaxScaler()\n\ng3_df_c['score_s'] = scaler.fit_transform(g3_df_c[['score']])","de65873c":"fig=plt.figure(figsize=(10,20))\nplt.title(\"Openess (scaled)\",family='Serif', weight='bold', size=15)\nax = sns.barplot(x='score_s', y='CountryCode', data=g3_df_c.sort_values('score_s', ascending=False).reset_index())","ec15eee2":"b1_df = life_df.loc[life_df.question_code.str.contains(\"b1\")]\nb1_df.shape","e4fe7378":"b1_df.question_label.unique()","c827aa76":"b1_df.question_code.unique()","12f913af":"b1_df1 = b1_df.loc[b1_df.question_code.str.contains(\"b1_a|b1_b|b1_c|b1_d\")]\nb1_df1.shape","dd04708c":"# Define scoring for b1_a to b1_d\nscoring_b1_df1 = {\"Very widespread\": -1,\n           \"Fairly widespread\": -0.5,\n           \"Fairly rare\": 0.5,\n           \"Very rare\": 1,\n           \"Don`t know\": 0}\n\n# Apply scoring\nb1_df1['score'] = b1_df1.answer.map(scoring_b1_df1).mul(b1_df1.percentage)\nb1_df1 = b1_df1.drop('percentage', axis=1)","eadc930e":"# Plot the dataframe\nfig=plt.figure(figsize=(15,5))\nplt.title(\"LGBT Tolerance within EU by Subset\",family='Serif', weight='bold', size=20)\nax = sns.boxplot(x='score', y='CountryCode', hue='subset',\n                 data=b1_df1.loc[b1_df1.CountryCode == 'Average'], palette=colors)","350c111d":"# Hypothesis testing function\nfrom scipy.stats import ttest_ind, wilcoxon, ttest_rel\n\ndef ho_test(sub1,sub2):\n    s1 = b1_df1[b1_df1['subset']==sub1]['score']\n    s2 = b1_df1[b1_df1['subset']==sub2]['score']\n    stats, p_value= ttest_ind(s1, s2)\n    \n    if p_value <0.05:\n        t2=\"p-value : {} is < 0.05, thus we can reject the Null Hypothesis\".format(np.round(p_value,3))\n    else:\n        t2=\"p-value: {} is >0.05, thus we can't reject the Null Hypothesis\".format(np.round(p_value,3))\n        \n    print(t2)","6649f7a9":"# Test the Ho\nho_test(\"Gay\", \"Lesbian\")","2170a52b":"# Test the Ho\nho_test(\"Gay\", \"Transgender\")","52017188":"b1_df1.loc[b1_df1.subset.str.contains('Gay|Lesbian')].groupby('subset').mean().round(2)","1ba81965":"b1_df1_c = b1_df1.groupby('CountryCode').mean()","1af45d8a":"b1_df1_c['score_s'] = scaler.fit_transform(b1_df1_c[['score']])","e705ba36":"fig=plt.figure(figsize=(10,15))\nplt.title(\"Tolerance\",family='Serif', weight='bold', size=20)\nax = sns.barplot(x='score', y='CountryCode', data=b1_df1_c.sort_values('score', ascending=False).reset_index())","3a8bc0fd":"fig=plt.figure(figsize=(10,20))\nplt.title(\"Tolerance (scaled)\",family='Serif', weight='bold', size=20)\nax = sns.barplot(x='score_s', y='CountryCode', data=b1_df1_c.sort_values('score', ascending=False).reset_index())","5cb32a19":"b1_df2 = b1_df.loc[b1_df.question_code.str.contains(\"b1_e|b1_f\")]\nb1_df2.shape","f0067699":"b1_df2.question_label.unique()","6c0ff61c":"b1_df2.answer.unique()","4f686705":"b1_df2.question_code = b1_df2.question_code.replace('b1_e', 'same-sex')\nb1_df2.question_code = b1_df2.question_code.replace('b1_f', 'heterosexual')","534f6b96":"# Define scoring for b1_a to b1_d\nscoring_b1_df2 = {\"Very widespread\": 1,\n           \"Fairly widespread\": 0.75,\n           \"Fairly rare\": 0.5,\n           \"Very rare\": 0.25,\n           \"Don`t know\": 0}\n\n# Apply scoring\nb1_df2['score'] = b1_df2.answer.map(scoring_b1_df2).mul(b1_df2.percentage)\nb1_df2 = b1_df2.drop('percentage', axis=1)","71b5fb16":"fig, axes = plt.subplots(1, 2, sharex=True, figsize=(10,10))\nfig.suptitle('Holding hands', family='Serif', weight='bold', size=15)\naxes[0].set_title('Holding Hands (very widespread)')\naxes[1].set_title('Holding Hands (average)')\nax0 = sns.barplot(ax=axes[0], x='question_code', y='score', data=b1_df2.loc[b1_df2.answer == 'Very widespread'])\nax1 = sns.barplot(ax=axes[1], x='question_code', y='score', data=b1_df2)","45e58125":"ss = b1_df2['score'].loc[(b1_df2.answer == 'Very widespread') & (b1_df2.question_code == 'same-sex')].mean()\/(2)\nds = b1_df2['score'].loc[(b1_df2.answer == 'Very widespread') & (b1_df2.question_code == 'heterosexual')].mean()\/(2)\nprint(\"same-sex (very widespread) [%]:\", round(ss, 3))\nprint(\"different-sex (very widespread) [%]:\", round(ds, 3))\nprint(\"difference in respect to same-sex [ratio]:\", round(ss\/ds, 3))","f8337b8b":"df2_p = pd.pivot_table(b1_df2.loc[(b1_df2.answer == 'Very widespread')], values='score', index=['CountryCode'], columns='question_code', aggfunc='mean')\ndf2_p['ratio'] = (df2_p['same-sex'] \/ df2_p['heterosexual']).round(3)\ndf2_p = df2_p.drop(['heterosexual', 'same-sex'], axis=1)\ndf2_p.sort_values('ratio').tail()","aa07572a":"df2_p['ratio_s'] = scaler.fit_transform(df2_p[['ratio']])","b8d722dc":"fig=plt.figure(figsize=(10,20))\nplt.title(\"Holding hands (scaled)\",family='Serif', weight='bold', size=20)\nax = sns.barplot(x='ratio_s', y='CountryCode', data=df2_p.sort_values('ratio_s', ascending=False).reset_index())","bbee128b":"# Plot the dataframe\nfig=plt.figure(figsize=(15,5))\nplt.title(\"Overall score by question in B1 category\",family='Serif', weight='bold', size=20)\nax = sns.boxplot(x='score', y='CountryCode', hue='question_code',\n                 data=b1_df1.loc[b1_df1.CountryCode == 'Average'], palette=colors)","4d129fa8":"b1_df1['question_label'].loc[b1_df1.question_code == 'b1_b'].unique()  # Show more problematic question","e1d3e8ca":"fig=plt.figure(figsize=(15,5))\nplt.title(\"Overall score by question (B1 category)\", family='Serif', weight='bold', size=20)\nsns.kdeplot(b1_df1['score'], fill=True, hue=b1_df1['question_code'], color=colors, shade=True, linewidth=2, edgecolor='white', multiple='layer')\nplt.axvline(b1_df1['score'].mean(), c='black',ls='--')\nplt.text(x=b1_df1['score'].mean(), y=-0.01, s='mean', size=10)\nfor s in ['left','right','top','bottom']:\n    plt.gca().spines[s].set_visible(False)","aa8e4d57":"# Average acceptance for all subsets\ndf1_p = pd.pivot_table(b1_df1, values='score', index='CountryCode', aggfunc='mean')\n\nprint('Shape of the pivot table: ', df1_p.shape)\ndf1_p.head()","51e2b3ae":"# Calculate acceptance score\ndf1_p['score_s'] = scaler.fit_transform(df1_p[['score']])","695fab68":"plt.figure(figsize=(15,10))\n\nax = sns.barplot(x=df1_p.score, y=df1_p.index, order=df1_p.sort_values('score', ascending=False).index)\n\nplt.xlabel(\"Rainbow Score\", size=15)\nplt.ylabel(\"Country\", size=15)\nplt.title(\"LGBT Tolerance within EU\", size=18)\nplt.tight_layout()\nplt.savefig(\"Acceptance_lgbt_eu_RainbowScore.png\", dpi=100)","c1f0c4d0":"plt.figure(figsize=(15,10))\n\nax = sns.barplot(x=df1_p.score_s, y=df1_p.index, order=df1_p.sort_values('score_s', ascending=False).index)\n\nplt.xlabel(\"Relative Score\", size=15)\nplt.ylabel(\"Country\", size=15)\nplt.title(\"LGBT Acceptance within EU\", size=18)\nplt.tight_layout()\nplt.savefig(\"Acceptance_lgbt_eu_RelativeScore.png\", dpi=100)","224f2d6f":"# Plot the dataframe\nfig=plt.figure(figsize=(15,5))\nplt.title(\"Overall score by question\",family='Serif', weight='bold', size=20)\nax = sns.boxplot(x='score', y='CountryCode', hue='question_code',\n                 data=b1_df1.loc[b1_df1.CountryCode == 'Czech Republic'], palette=colors)","71422d9e":"Relative Score is a numerical representation of how accepting invidual countries seem within EU, based on the questionary.","343170ea":"## Load Data","d2ccc65a":"## B1 category","f5834705":"The column \"notes\" doesn't seem to hold any significant value. We can drop it.","dd1952c2":"\"percentage\" should be a number","baf2f787":"### Tolerance","62e3ede6":"Rainbow Score is a numerical representation of how lgbt responders subjectively view behaviour towards them.","5ec7f04e":"## Openess","6b8b9446":"### General","5f4c81e4":"Each category seem to have it's set of possible answers","6e86614d":"28 countries + 1 Average","111185ad":"### Holding hands","251e4761":"The questions seems to be organized into categories.","601784f9":"**Ho:** There's a difference in tolerance among subsets of LGBT people.","976626fa":"### Category G1","93d82d46":"### Category G3","28fa347c":"## Libraries","6dac70ec":"Total amount of categories: 29 countries x5 subsets x4 question_code x5 answer = 725 rows","c92693cd":"**Note**: During data research, I found Czechia usually scores at the very top in many domains, not considering question b1_a \"In your opinion, how widespread is offensive language about lesbian, gay, bisexual and\/or transgender people by politicians in the country where you live?\".\n\nThis would indicate, the society itself is very accepting in general and the overall score might by affected by the current political situation in the Czech Republic at the time of the questionary."}}