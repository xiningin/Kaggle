{"cell_type":{"2ea6eb85":"code","1ffd7044":"code","74bdbc9c":"code","64ea593b":"code","73cbadeb":"code","c90e22db":"code","02d8cf33":"code","f22b5954":"code","a945445e":"code","8e78fecc":"code","fe9ebfd5":"code","aa2f96fe":"code","12274c41":"code","e16341ff":"code","7ac31eb1":"code","d3dbc51c":"code","a00b657e":"code","5cadea9b":"code","64006110":"code","3558a0de":"code","65242f81":"code","107b18a1":"markdown","63066bcf":"markdown","64d876c4":"markdown","d70982cb":"markdown","05ce3f42":"markdown","4af6c828":"markdown","d1ac28be":"markdown","f79f6441":"markdown","684cd20f":"markdown","99eff861":"markdown","91bd1bef":"markdown","1443b2f3":"markdown","bd64f941":"markdown","f7930faf":"markdown","2882b140":"markdown","311d886c":"markdown"},"source":{"2ea6eb85":"import pandas as pd\nimport seaborn as sns\nimport pandasql as ps \nimport matplotlib.pyplot as plt\n%matplotlib inline","1ffd7044":"worldwide_meat_consumption = pd.read_csv(\"..\/input\/meatconsumption\/meat_consumption_worldwide.csv\")\nworldwide_meat_consumption","74bdbc9c":"print(worldwide_meat_consumption.isnull().any()) #check whether there are any missing values","64ea593b":"worldwide_meat_consumption.info()","73cbadeb":"worldwide_meat_consumption[\"LOCATION\"].nunique() #number of unique values in Location columns","c90e22db":"worldwide_meat_consumption[\"LOCATION\"].unique() #exploration of all participating values in Location column representing countries and international organisations","02d8cf33":"worldwide_meat_consumption[\"MEASURE\"].value_counts() # 7042 rows represent values (beef, pork, sheep, poultry) in thousand tonnes whereas 6718 rows represent values in kilograms\/capita. ","f22b5954":"worldwide_meat_consumption = worldwide_meat_consumption.rename(columns={\"TIME\": \"Year\", \"SUBJECT\": \"Meat\", \"LOCATION\":\"Location\", \"MEASURE\":\"Measure\"}) #rename column TIME\nworldwide_meat_consumption = worldwide_meat_consumption.replace({\"BEEF\": \"Beef\", \"PIG\": \"Pork\", \"POULTRY\": \"Poultry\", \"SHEEP\": \"Mutton\"}) # rename values in SUBJECT column\n\nfor i, col in enumerate(worldwide_meat_consumption.columns): \n    print(i+1,\". column is \",col)","a945445e":"world_most_consumed_meat_2020 = \"\"\"SELECT Meat, Measure, Year, Value FROM worldwide_meat_consumption WHERE Year = 2020 AND Location='WLD' ORDER BY Value DESC\"\"\"\nps.sqldf(world_most_consumed_meat_2020)","8e78fecc":"most_consumed_meat_kg_cap_bar = worldwide_meat_consumption.loc[(worldwide_meat_consumption.Measure == 'KG_CAP') & (worldwide_meat_consumption.Year == 2020) & (worldwide_meat_consumption.Location == \"WLD\")].sort_values('Value',ascending=False)\nmost_consumed_meat_kg_cap_bar\n\ncolor_blind_palette = ['#FFB000', '#FE6100', '#785EF0', '#DC267F']\n\nsns.set(style='whitegrid')\nsns.barplot(data=most_consumed_meat_kg_cap_bar, x =\"Meat\", y=\"Value\", palette=color_blind_palette)\nplt.xlabel('Meat', fontsize=12.5)\nplt.ylabel('Kg\/cap', rotation=90, fontsize=12.5)\nplt.figtext(.5, .9, 'World meat consumption in kilograms per capita (2020)', fontsize=15, fontweight='bold', fontname='Helvetica', ha='center') #formatted title\n\nplt.show()\n","fe9ebfd5":"most_consumed_meat_thnd_tonne_bar = worldwide_meat_consumption.loc[(worldwide_meat_consumption.Measure == 'THND_TONNE') & (worldwide_meat_consumption.Year == 2020) & (worldwide_meat_consumption.Location == \"WLD\")].sort_values('Value',ascending=False)\nmost_consumed_meat_thnd_tonne_bar\n\ncolor_blind_palette = ['#FFB000', '#FE6100', '#785EF0', '#DC267F']\n\nsns.set(style='whitegrid')\nsns.barplot(data=most_consumed_meat_thnd_tonne_bar, x =\"Meat\", y=\"Value\", palette=color_blind_palette)\n\nplt.xlabel('Meat', fontsize=12.5)\nplt.ylabel('Thousand tonnes', rotation=90, fontsize=12.5)\nplt.figtext(.5, .9, 'World meat consumption in thousand tonnes (2020)', fontsize=15, fontweight='bold', fontname='Helvetica', ha='center') #formatted title\n\nplt.show()","aa2f96fe":"country_most_consumed_meat_kg_cap_2020 = \"\"\"SELECT Location, Meat, Measure, Year, MAX(Value) \n                                            FROM worldwide_meat_consumption \n                                            WHERE Location NOT IN('WLD', 'BRICS', 'EU28', 'OECD') AND Measure='KG_CAP' AND Year=2020\"\"\"\nps.sqldf(country_most_consumed_meat_kg_cap_2020)","12274c41":"country_most_consumed_meat_thnd_tonne_2020 = \"\"\"SELECT Location, Meat, Measure, Year, MAX(Value) \n                                                FROM worldwide_meat_consumption \n                                                WHERE Location NOT IN('WLD', 'BRICS', 'EU28', 'OECD') AND Measure='THND_TONNE' AND Year=2020\"\"\"\nps.sqldf(country_most_consumed_meat_thnd_tonne_2020)","e16341ff":"world_most_consumed_meat_2026 = \"\"\"SELECT Location, Meat, Measure, MAX(Year), MAX(Value) \n                                   FROM worldwide_meat_consumption\"\"\"\nps.sqldf(world_most_consumed_meat_2026) ","7ac31eb1":"country_most_consumed_meat_kg_cap_2026 = \"\"\"SELECT Location, Meat, Measure, MAX(Year), MAX(Value) \n                                            FROM worldwide_meat_consumption WHERE Measure='KG_CAP'\"\"\"\nps.sqldf(country_most_consumed_meat_kg_cap_2026) ","d3dbc51c":"country_most_consumed_meat_thnd_tonne_2026 = \"\"\"SELECT Location, Meat, Measure, MAX(Year), MAX(Value) \n                                                FROM worldwide_meat_consumption \n                                                WHERE Location NOT IN('WLD', 'BRICS', 'EU28', 'OECD') AND Measure='THND_TONNE'\"\"\"\nps.sqldf(country_most_consumed_meat_thnd_tonne_2026)","a00b657e":"years_biggest_meat_consumption_kg_cap = \"\"\"SELECT Year, SUM(Value) AS Total_Meat_Consumption \n       FROM worldwide_meat_consumption\n       WHERE Measure = 'KG_CAP'\n       GROUP BY Year\n       HAVING MAX(Value)\"\"\"\nps.sqldf(years_biggest_meat_consumption_kg_cap)","5cadea9b":"meat_consumption_ratio = worldwide_meat_consumption.loc[worldwide_meat_consumption['Measure'] == 'KG_CAP']\n\nmeat_consumption_ratio_1990_2000 = meat_consumption_ratio.loc[(meat_consumption_ratio['Year'] >= 1990) & (meat_consumption_ratio['Year'] <= 2000)]\nmeat_consumption_ratio_2001_2010 = meat_consumption_ratio.loc[(meat_consumption_ratio['Year'] >= 2001) & (meat_consumption_ratio['Year'] <= 2010)]\nmeat_consumption_ratio_2011_2020 = meat_consumption_ratio.loc[(meat_consumption_ratio['Year'] >= 2011) & (meat_consumption_ratio['Year'] <= 2020)]\nmeat_consumption_ratio_2021_2026 = meat_consumption_ratio.loc[(meat_consumption_ratio['Year'] >= 2021) & (meat_consumption_ratio['Year'] <= 2026)] #future predictions\n\nmeat_consumption_ratio_1990_2000 = meat_consumption_ratio_1990_2000.groupby(by = ['Meat']).Value.sum()\nmeat_consumption_ratio_2001_2010 = meat_consumption_ratio_2001_2010.groupby(by = ['Meat']).Value.sum()\nmeat_consumption_ratio_2011_2020 = meat_consumption_ratio_2011_2020.groupby(by = ['Meat']).Value.sum()\nmeat_consumption_ratio_2021_2026 = meat_consumption_ratio_2021_2026.groupby(by = ['Meat']).Value.sum()\n\nfigure_pie = plt.figure(num=1, figsize=(20,10), facecolor=\"#F2F1EC\")\nfigure_pie.suptitle('World meat consumption 1990-2020 + prediction', fontsize=20, fontweight='bold', fontname='Helvetica', ha='right')\ncolor_blind_palette = ['#785EF0', '#DC267F', '#FE6100', '#FFB000']\nangle = 65\n\npie_1990_2000 = plt.subplot(1, 5, 1)\npie_1990_2000.set_title('1990-2000', fontweight =\"bold\")\nmeat_consumption_ratio_1990_2000.plot.pie(autopct='%1.1f%%', startangle=angle, colors=color_blind_palette)\nplt.axis(\"off\")\n\npie_2001_2010 = plt.subplot(1, 5, 2)\npie_2001_2010.set_title('2001-2010', fontweight =\"bold\")\nmeat_consumption_ratio_2001_2010.plot.pie(autopct='%1.1f%%', startangle=angle, colors=color_blind_palette)\nplt.axis(\"off\")\n\npie_2010_2020 = plt.subplot(1, 5, 3)\npie_2010_2020.set_title('2011-2020', fontweight =\"bold\")\nmeat_consumption_ratio_2011_2020.plot.pie(autopct='%1.1f%%', startangle=angle, colors=color_blind_palette)\nplt.axis(\"off\")\n\npie_2020_2026 = plt.subplot(2, 5, 4)\npie_2020_2026.set_title('2021-2026 prediction', fontweight =\"bold\")\nmeat_consumption_ratio_2021_2026.plot.pie(autopct='%1.1f%%', startangle=angle, colors=color_blind_palette)\nplt.axis(\"off\")\n","64006110":"worldwide_meat_consumption = worldwide_meat_consumption.set_index(\"Location\").sort_index() # with .set_index(), we can change default index with any column in the dataset.\nindia_meat_consumption = worldwide_meat_consumption.loc[\"IND\"]\nindia_meat_consumption_index_Measure_is_kg_cap =  india_meat_consumption[\"Measure\"]==\"KG_CAP\"\nindia_meat_consumption_kg_cap = india_meat_consumption[india_meat_consumption_index_Measure_is_kg_cap]\nindia_meat_consumption_index_Measure_is_thnd_tonnes = india_meat_consumption[\"Measure\"]==\"THND_TONNE\"\nindia_meat_consumption_thnd_tonnes = india_meat_consumption[india_meat_consumption_index_Measure_is_thnd_tonnes]\n","3558a0de":"#indian consumption of meat in thousand tonnes \ncolor_blind_palette = ['#785EF0','#FE6100','#FFB000','#DC267F']\n\nsns.set(style=\"whitegrid\",rc={'figure.figsize':(20, 10)})\nplot_india_thnd_tonnes = sns.lineplot(data=india_meat_consumption_thnd_tonnes, x=\"Year\", y=\"Value\", hue=\"Meat\", hue_order=['Beef', 'Pork', 'Poultry', 'Mutton'], lw=3, palette=color_blind_palette)\n\nplt.legend(loc=\"upper left\", facecolor='white') #get rid of plot legend title and set legend background color to white\nplot_india_thnd_tonnes.set(ylim=(0, 4000)) #set range for y-axis\nplt.xlabel('Year', fontsize=12.5)\nplt.ylabel('Thousand tonnes', rotation=90, fontsize=12.5)\nplt.figtext(.5,.9,\"India's meat consumption in thousand tonnes\", fontsize=20, fontweight='bold', fontname='Helvetica', ha='center') #formatted title\n\n\n","65242f81":"#indian consumption of meat in kilograms per capita\ncolor_blind_palette = ['#785EF0','#FE6100','#FFB000','#DC267F']\n\nsns.set(style=\"whitegrid\", rc={'figure.figsize':(20, 10)})\nplot_india_kg_capita = sns.lineplot(data=india_meat_consumption_kg_cap, x=\"Year\", y=\"Value\", hue=\"Meat\", hue_order=['Beef', 'Pork', 'Poultry', 'Mutton'], lw=3, palette=color_blind_palette)\nplt.legend(loc=\"upper left\", facecolor='white') #get rid of plot legend title and set legend background color to white\nplot_india_kg_capita.set(ylim=(0, 2.50)) #set range for y-axis\nplt.xlabel('Year', fontsize=12.5)\nplt.ylabel('Kg\/cap', rotation=90, fontsize=12.5)\nplt.figtext(.5,.9,\"India's meat consumption in kilograms per capita\", fontsize=20, fontweight='bold', fontname='Helvetica', ha='center') #formatted title\n\n\n","107b18a1":"Beef consumption is gradually decreasing whereas poultry consumption is on rise as deduced from 4 pie charts above.\n\nFinally, I have decided to take a closer look at India \ud83c\uddee\ud83c\uddf3 and see its consumption of meat. I've always thought that India will have barely any beef consumption, but the following results say otherwise. \n\nThe question is following: \u2753**What is the meat consumption in India, both in thousand tonnes and in kg\/cap?**","63066bcf":"I have decided to rename the columns for further use:","64d876c4":"In 2020, poultry \ud83c\udf57 is the most consumed meat on planet Earth \ud83c\udf0d with pork \ud83e\udd53 almost at the same level. The biggest consumer of poultry \ud83c\udf57 in kilograms per capita is Israel. \ud83c\uddee\ud83c\uddf1 On the other hand, China \ud83c\udde8\ud83c\uddf3 has the biggest consumption of pork \ud83e\udd53 in thousand tonnes!","d70982cb":"**Our second question!**\n\n\u2753**Which type of meat will be the most consumed worldwide?**","05ce3f42":"# 4. Conclusion\n\nThe answers provided above might not be surprising for some of you. I am personally happy that beef is not the most consumed meat worldwide both in kilograms per capita and thousand tonnes since beef consumption is one of the major contributors to overall warming of our planet and it takes a lot of water and feed to provide 1 kilogram of beef whereas the poultry consumption is more than three times less water intensive. (see the following source for more specific information: https:\/\/www.theguardian.com\/news\/datablog\/2013\/jan\/10\/how-much-water-food-production-waste). I have provided some additional questions to think about, which were mentioned in the intro.\n\n**Questions to think about:**\n1. What are the pros and cons of meat consumption in 21st century? \n1. What are the driving factors of increase or decrease in consumption of meat - dietary trends, increase in living standards etc.? \n1. Is the current and predicted consumption of meat (year 2026 in this dataset) sustainable in longterm for our planet? \ud83c\udf0d\n\n**I hope you have learned something useful about the meat consumption topic. This is my first shared notebook on Kaggle, please let me know, whether you've liked it (I believe you can use UPVOTE button for it) or if there is something missing in comments below. And of course, happy coding to everyone! \ud83d\udcbb**\n\n","4af6c828":"As is evident from both graphs, beef \ud83e\udd69 is the 2nd most consumed meat in India long term both in kilograms per capita and thousand tonnes. There is also a strong increase in consumption of poultry \ud83c\udf57, which takes 1st place.During years 2009-2014, beef consumption was significantly and gradually decreasing - I believe that one of the driving factors affecting this gradual decline in beef consumption after 2009 was the matter of affordability: chicken is simply cheaper \ud83c\udf57 and probably the world economic crisis as well.\n","d1ac28be":"As we can observe from this dataframe, meat consumption per capita is steadily on rise worldwide and will almost double by 2026 compared to 1990. What consequences will the increasing meat consumption have on our planet? \ud83c\udf31","f79f6441":"**Import libraries**\n\nFirst of all, let's import some of the Python \ud83d\udc0d data libraries necessary to be able to load, transform and visualise our dataset.","684cd20f":"# **2. Data Preparation**\n\n\ud83d\udd0eLet's see what data we have just uploaded...","99eff861":"\ud83d\udccc **Basic info about dataset**\n\nWe can also get summary of the dataset by using .info() method and basic statistics computations of the dataset using .describe() method.","91bd1bef":"# Meat Consumption of Today and Tomorrow [\ud83e\udd69,\ud83c\udf57,\ud83e\udd53,\ud83c\udf56]\n\n# 1. Introduction\n\nLast few weeks, I became obsessed with the topic of meat consumption. I am constantly thinking about the following: What are the pros and cons of meat consumption in 21st century? What are the driving factors of increase or decrease in consumption of meat - dietary trends,increase in living standards etc. ? Is the current and predicted consumption of meat (year 2026 in this dataset) sustainable in longterm for our planet? \ud83c\udf0d These questions are way much more complex to be answered within scope of this notebook. I hope that soon enough as my knowledge of the topic, statistics and python libraries will improve, it will enable me somehow to answer these questions mentionned above as well. For now, I want to stay down-to-earth and redirect my thoughts on the following questions ->\n\n**We will deal with the following questions in this dataset:**\n\n1. Which type of meat is now the most consumed worldwide? (year = 2020, both Measures)\n1. Which type of meat will be the most consumed worldwide? (both Measures)\n1. What was and what is predicted to be the total meat consumption in kilograms per capita in every single year from 90's to 20's?\n1. What is the meat consumption in India, both in thousand tonnes and in kg\/cap? (just for my own curiosity!)\n\n\n**We will deal with the following columns:**\n\n* LOCATION = country code representing either country or international organisation\n* SUBJECT = type of meat (Beef, Pork, Poultry, Mutton)\n* MEASURE = type of unit measure (KG_CAP=kilograms per capita,THND_TONNE=thousand tonnes) \n* TIME = year when the data were recorded\n* Value = value represented either in kg\/cap or thousand tonnes\n\nAfter our exploration of the dataset, I will provide additional questions to think about but which may also serve as starting point for further analysis of this topic.\n\n**Let's dive right into the amazing world of Python libraries!** \ud83d\udc0d Oh and if any additional questions will pop up during your exploration of this notebook, please let me know in the comments below! I will try to answer them as well.","1443b2f3":"<- After renaming our columns, we will work with following ones.","bd64f941":"Before plotting any graphs, I want them to be accessible for everyone. Therefore, I mixed my own **colorblind** palette. \ud83d\udc40","f7930faf":"\u26a0\ufe0f **Check missing values** \n\nAll columns seems reasonable for our use but before we get started, let's check if there are any missing values in this dataset.","2882b140":"# 3. It's question time!\n\nAll is set, let's jump right into it to answer our first question.\n\n\u2753**Which type of meat is now the most consumed worldwide?** \n\nWe are interested in both kilogram per capita and thousand tonnes consumption!","311d886c":"In 2026, poultry \ud83c\udf57 will continue to be the most consumed meat on planet Earth \ud83c\udf0d with current country in lead, Israel. \ud83c\uddee\ud83c\uddf1  On the other hand, China \ud83c\udde8\ud83c\uddf3 will have the biggest consumption of pork \ud83e\udd53 in thousand tonnes!\n\n**Let's take a look at our third question:**\n\n\u2753**What was and what is predicted to be the total meat consumption in kilograms per capita every single year from 90's to 20's?**\n\n"}}