{"cell_type":{"45c80984":"code","efbbe8ab":"code","c3ad096f":"code","0cbbb60c":"code","52bd94ab":"code","422f697f":"code","a9a959cc":"code","29a8f0a7":"code","1caa0e88":"code","96d15b07":"code","e8eb06a6":"code","7b71e87a":"code","8cc8f35c":"code","5dc2f006":"code","919e0153":"code","ab067734":"code","06bc9ffd":"code","5f36632a":"code","418f8be6":"code","7d07dc98":"markdown","8c54b029":"markdown","cc76b9e9":"markdown","b1676459":"markdown","2c0556b9":"markdown","54cc71b4":"markdown"},"source":{"45c80984":"import matplotlib.pyplot as plt\nimport numpy as np\nimport seaborn as sns\nimport pandas as pd\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn import linear_model\nfrom sklearn.model_selection import cross_val_score, cross_val_predict\nfrom sklearn import metrics\nfrom sklearn.ensemble import RandomForestRegressor\n%matplotlib inline","efbbe8ab":"df = pd.read_csv(\"..\/input\/BlackFriday.csv\")","c3ad096f":"df.head()","0cbbb60c":"# first we check number of unique users and products\nprint(\"Number of Unique Users \",df['User_ID'].nunique())\nprint(\"Number of Unique Products \",df['Product_ID'].nunique())\nprint(\"Number of Transactions \",len(df))","52bd94ab":"fig, axes = plt.subplots(nrows=5, ncols=2,figsize=(15,15))\nfig.tight_layout()\nfig.subplots_adjust(wspace=0.4,hspace=0.4)\n\ndf['User_ID'].groupby(df['Gender']).nunique().plot(kind='bar',ax=axes[0,0])\ndf['User_ID'].groupby(df['Age']).nunique().plot(kind='bar',ax=axes[0,1])\ndf['User_ID'].groupby(df['Occupation']).nunique().plot(kind='bar',ax=axes[1,0])\ndf['User_ID'].groupby(df['City_Category']).nunique().plot(kind='bar',ax=axes[1,1])\ndf['User_ID'].groupby(df['Stay_In_Current_City_Years']).nunique().plot(kind='bar',ax=axes[2,0])\ndf['User_ID'].groupby(df['Marital_Status']).nunique().plot(subplots=True,kind='bar',ax=axes[2,1])\ndf['User_ID'].groupby(df['Product_Category_1']).nunique().plot(subplots=True,kind='bar',ax=axes[3,0])\ndf['User_ID'].groupby(df['Product_Category_2']).nunique().plot(subplots=True,kind='bar',ax=axes[3,1])\ndf['User_ID'].groupby(df['Product_Category_3']).nunique().plot(kind='bar',ax=axes[4,0])","422f697f":"fig, axes = plt.subplots(nrows=5, ncols=2,figsize=(15,15))\nfig.tight_layout()\nfig.subplots_adjust(wspace=0.4,hspace=0.4)\n\ndf['Product_ID'].groupby(df['Gender']).nunique().plot(kind='bar',ax=axes[0,0])\ndf['Product_ID'].groupby(df['Age']).nunique().plot(kind='bar',ax=axes[0,1])\ndf['Product_ID'].groupby(df['Occupation']).nunique().plot(kind='bar',ax=axes[1,0])\ndf['Product_ID'].groupby(df['City_Category']).nunique().plot(kind='bar',ax=axes[1,1])\ndf['Product_ID'].groupby(df['Stay_In_Current_City_Years']).nunique().plot(kind='bar',ax=axes[2,0])\ndf['Product_ID'].groupby(df['Marital_Status']).nunique().plot(subplots=True,kind='bar',ax=axes[2,1])\ndf['Product_ID'].groupby(df['Product_Category_1']).nunique().plot(subplots=True,kind='bar',ax=axes[3,0])\ndf['Product_ID'].groupby(df['Product_Category_2']).nunique().plot(subplots=True,kind='bar',ax=axes[3,1])\ndf['Product_ID'].groupby(df['Product_Category_3']).nunique().plot(kind='bar',ax=axes[4,0])","a9a959cc":"lb = LabelEncoder()\ndf['Gender'] = lb.fit_transform(df['Gender'])\ndf['Age'] = lb.fit_transform(df['Age'])\ndf['City_Category'] = lb.fit_transform(df['City_Category'])\ndf['Stay_In_Current_City_Years'] = lb.fit_transform(df['Stay_In_Current_City_Years'])","29a8f0a7":"fig,ax = plt.subplots(figsize = (12,9))\nsns.heatmap(df.drop(['User_ID','Product_ID'],axis=1).corr())","1caa0e88":"df.fillna(0,inplace=True)","96d15b07":"from sklearn.model_selection import train_test_split\nX = df.drop(['User_ID','Product_ID','Purchase'],axis=1)\n# df.reset_index()\ny = df['Purchase']","e8eb06a6":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)","7b71e87a":"print(X_train.shape, y_train.shape)\nprint(X_test.shape, y_test.shape)","8cc8f35c":"lm = linear_model.LinearRegression()\nmodel = lm.fit(X_train, y_train)\npredictions = lm.predict(X_test)","5dc2f006":"model.score(X_test,y_test)","919e0153":"scores = cross_val_score(model, X, y, cv=6)\nprint(\"Cross-validated scores:\", scores)","ab067734":"regr = RandomForestRegressor(max_depth=5,random_state=42,n_estimators=100)","06bc9ffd":"regr.fit(X_train,y_train)","5f36632a":"regr.score(X_test,y_test)","418f8be6":"regr.feature_importances_","7d07dc98":"## Running linear regression Model on the data","8c54b029":"## Purchase is an important variable which we want to predict which is the price of the product that the user is buying\n## So lets conduct analysis on the products variable ","cc76b9e9":"# From above information we can see that above data is many to many mapping between Users and Products","b1676459":"## Running Random Forest Regressor on data","2c0556b9":"## From the above heatmap we can see that the correlation between product category 1 and product category 2 is high compared to product category 1 and product category 3\n\n## we can also observe that there is a negative correlation between purchase and product category 1 and product category 2 which might indicate the prices of product category 1 and product category 2 are high and few people purchase them\n\n## we can also check that age and marital status have high correlation which makes lot of sense\n\n## we can also observe that no variable is highly correlated with the purchase variable which is our target .It shows that purchase variable depends on ensemble of all the variables","54cc71b4":"## Even cross validation havent improved our accuracy metrics much"}}