{"cell_type":{"4afa34f7":"code","222b9235":"code","43a072fa":"code","845fa218":"code","25781f34":"code","0dd3d112":"code","b3bc34ba":"code","04e1abf5":"markdown","5fcc0e8c":"markdown"},"source":{"4afa34f7":"!pip install -q gpt-2-simple\nimport gpt_2_simple as gpt2\nimport re\nimport pandas as pd","222b9235":"gpt2.download_gpt2(model_name=\"124M\")","43a072fa":"def preprocess_text(text):\n    text = text.replace(\"(LN)\", \"\")\n    text = text.replace(\"LN\", \"\")\n    text = text.lower()\n    text = re.sub(r'[^\\w\\s]','',text)\n    return str(text)\n\ndf = pd.read_csv(\"..\/input\/isekai-light-novel-titles-and-descriptions\/light-novel-titles.csv\")\ndf[\"title_word_count\"] = df.titles.apply(lambda x: len(str(x).split()))\ntext_df = df.titles[df[\"title_word_count\"] > 4] # get rid of short titles\ntext_df = text_df.apply(preprocess_text)\ntext_df.to_csv('.\/titles.csv', index=False, header=False)  ","845fa218":"file_name = \".\/titles.csv\"\nsess = gpt2.start_tf_sess()\n\ngpt2.finetune(sess,\n              dataset=file_name,\n              model_name='124M',\n              steps=1000,\n              restore_from='fresh',\n              run_name='run1',\n              print_every=10,\n              sample_every=200,\n              save_every=500\n              )","25781f34":"gpt2.generate(sess,\n              length=20,\n              temperature=0.8,\n              prefix=\"Incompetent\",\n              nsamples=10,\n              batch_size=5,\n              truncate='<|endoftext|>',\n              )","0dd3d112":"gpt2.generate(sess,\n              length=30,\n              temperature=1.5,\n              prefix=\"The Hero is\",\n              nsamples=5,\n              batch_size=5,\n              truncate='<|endoftext|>',\n              )","b3bc34ba":"gpt2.generate(sess,\n              length=30,\n              temperature=1.5,\n              prefix=\"I was reincarnated\",\n              nsamples=5,\n              batch_size=5,\n              truncate='<|endoftext|>',\n              )","04e1abf5":"## We need input to be a csv file with only one column of texts","5fcc0e8c":"## Code heavily copied from [this colab notebook](https:\/\/colab.research.google.com\/drive\/1VLG8e7YSEwypxU-noRNhsv5dW4NfTGce)"}}