{"cell_type":{"2d5d2924":"code","866584e0":"code","0f9561e1":"code","67e25a23":"code","70964d07":"code","15e060f5":"code","be2fa9f7":"code","5fa72b16":"code","f3326623":"code","dce4a1a9":"code","abd80bb4":"code","2c307f6e":"code","8c6e5072":"code","c358b461":"code","1e8fb080":"code","ea7f8dba":"code","74771eae":"markdown","8ce71be9":"markdown","c5622e4e":"markdown","5026ab9d":"markdown","7596776e":"markdown","f060d4c4":"markdown","28e5cb37":"markdown","c2413a0b":"markdown","3f12c52c":"markdown","db7b88be":"markdown","b41e4dab":"markdown","f478f249":"markdown","baaeb2b8":"markdown","5fd7bcfd":"markdown","a654780b":"markdown","f676482f":"markdown","d40fb633":"markdown","e6a3cd18":"markdown"},"source":{"2d5d2924":"# Laden des Packages\nimport pandas as pd\n\n# Daten importieren\nsales = pd.read_csv(\"\/kaggle\/input\/dataakademie-zeitreihen-2021\/train.csv\", parse_dates = [\"Date\"],  low_memory=False).drop(columns=[\"Store\",\"StateHoliday\"], axis = 1)\nvalidation = pd.read_csv(\"\/kaggle\/input\/dataakademie-zeitreihen-2021\/test.csv\", parse_dates = [\"Date\"], low_memory=False).drop(columns=[\"Store\",\"StateHoliday\"], axis = 1)","866584e0":"# Sichten der Daten\nprint(sales.info())\nprint(\"\\n\")\nprint(sales.head())","0f9561e1":"print(validation.info())\nprint(\"\\n\")\nprint(validation.head())","67e25a23":"# Erstellen der Variablen in den Trainingsdaten\n# sales['Year'] = sales.Date.dt.year\n# sales['Month'] = sales.Date.dt.month\n# sales['WeekOfYear'] = sales.Date.dt.isocalendar().week\n# sales[\"Week\"]= sales.Date.dt.isocalendar().week%4\n\n# Erstellen der Variablen in den Validierungsdaten\n# validation['Year'] = validation.Date.dt.year\n# validation['Month'] = validation.Date.dt.month\n# validation['WeekOfYear'] = validation.Date.dt.isocalendar().week\n# validation[\"Week\"]= validation.Date.dt.isocalendar().week%4","70964d07":"# Anzeigen der Informationen\nprint(sales.info())\nprint(\"\\n\")\nprint(validation.info())","15e060f5":"# Importieren von Packages\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\n#Find Correlation between the data columns\nplt.figure(figsize=(15,15))\nsns.heatmap(sales.corr())","be2fa9f7":"# Entfernen von Variablen in den Trainingsdaten\n# sales.drop(columns=[\"DayOfWeek\",\"SchoolHoliday\"],inplace = True, axis = 1)\n\n# Entfernen von Variablen in den Validierungsdaten\n# validation.drop(columns=[\"DayOfWeek\",\"SchoolHoliday\"],inplace = True, axis = 1)","5fa72b16":"# Hinzuf\u00fcgen eines Index \nsales_index = sales.set_index(\"Date\")\n\n# Aufteilen in Erkl\u00e4rende und Ziel Variable\nX = sales_index.drop([\"Sales\"], axis = 1)\ny = sales_index[\"Sales\"]\n\n# Aufteilen in Trainings- und Testdaten\nX_train = X.sort_index().loc[\"2013\"].values\nX_test = X.sort_index().loc[\"2014\"].values\ny_train = y.sort_index().loc[\"2013\"].values\ny_test = y.sort_index().loc[\"2014\"].values","f3326623":"# Zuerst importieren wir die Funktion\nfrom sklearn.neural_network import MLPRegressor\n\n# Dann definieren wir das Modell\nmlp = MLPRegressor(max_iter= 10000)\n\n# Trainieren des Modells auf den Trainingsdaten\nmodel = mlp.fit(X_train,y_train)","dce4a1a9":"# Zuerst importieren wir die Funktion\n# from sklearn.svm import SVR\n\n# Dann definieren wir das Modell\n# svr = SVR()\n\n# Trainieren des Modells auf den Trainingsdaten\n# model = lss.fit(X_train,y_train)","abd80bb4":"# Zuerst importieren wir die Funktion\n# from sklearn.tree import DecisionTreeRegressor\n\n# Dann definieren wir das Modell\n# clf = DecisionTreeRegressor()\n\n# Trainieren des Modells auf den Trainingsdaten\n# model = clf.fit(X_train,y_train)","2c307f6e":"# Importieren der Funktion aus dem Package\nfrom sklearn.metrics import mean_squared_error\n\n# Berechnen der Vorhersage f\u00fcr die Testdaten\ny_pred_train = model.predict(X_train)\n\n# Berechnen des MSE f\u00fcr Lasso\nmean_squared_error(y_train,y_pred_train)","8c6e5072":"# Importieren der Funktion aus dem Package\nfrom sklearn.metrics import mean_squared_error\n\n# Berechnen der Vorhersage f\u00fcr die Testdaten\ny_pred_test = model.predict(X_test)\n\n# Berechnen des MSE f\u00fcr Lasso\nmean_squared_error(y_test,y_pred_test)","c358b461":"# Zuerst importieren wir die Funktion\nfrom sklearn.neural_network import MLPRegressor\n\n# Dann definieren wir das Modell\nmpl = MLPRegressor(max_iter= 100000)\n\n# Trainieren des Modells\nmodel_final = mlp.fit(X.values,y.values)","1e8fb080":"# Vorbereitung des Validationdatensatz\nvalidation_model = validation.drop([\"Date\",\"Id\"],axis = 1).values","ea7f8dba":"# Modell exportieren\nvalidation[\"Sales\"] = model_final.predict(validation_model)\nsubmission = validation[[\"Id\",\"Sales\"]]\nsubmission.to_csv(\"submission.csv\", index = False)","74771eae":"# Code f\u00fcr den Rossmann Hackathon","8ce71be9":"An dieser Stelle wird ein Modell trainiert. Der Teilnehmer ist dazu angehalten andere Modelle auszuprobieren, die wir im Kurs kennengelernt haben oder sich auf der Seite von [sci-kit learn](https:\/\/scikit-learn.org\/stable\/supervised_learning.html#supervised-learning) befinden. An dieser Stelle sind drei beispielhafte Modelle.","c5622e4e":"### 3.3 Feature Selektion","5026ab9d":"An dieser Stelle wird die Generalisierungsf\u00e4higkeit des Modells \u00fcberpr\u00fcft. Wir erinnern uns, dass ein Modell nicht auf die Trainingsdaten overfitted werden sollte.","7596776e":"An dieser Stelle k\u00f6nnen neue Variablen erstellet werden, um das Modell zu verbessern. Ein paar beispielhafte Variablen sind hier dargestellt. Teilnehmer sind explizit dazu angehalten sich neue Variablen auszudenken.","f060d4c4":"## 2. Aufbereitung der Daten","28e5cb37":"# HIER BEARBEITEN","c2413a0b":"Hier findet der Prozess der Feature Selektion statt. Daf\u00fcr liegt ein Korrelationsplot vor. Der Teilnehmer ist dazu angehalten Variablen zu entfernen und zu \u00fcberpr\u00fcfen ob das seine Modellierung verbessert.","3f12c52c":"Damit wird das Modell exportiert werden kann, passen wir es nun an die gesamten Daten an und nutzen das Modell danach um eine Vorhersage auf die ungesehen Daten zu t\u00e4tigen.","db7b88be":"### 3.6 Modell auswerten","b41e4dab":"### 3.7 Modell exportieren","f478f249":"# HIER BEARBEITEN","baaeb2b8":"### 3.4 Train Test Split","5fd7bcfd":"# HIER BEARBEITEN","a654780b":"Berechnen des MSE des Models auf den Trainingsdaten.","f676482f":"## 1. Laden der Daten","d40fb633":"Der Code ist ein grundlegendes Ger\u00fcst, dass von den Teilnehmern beliebig ver\u00e4ndert werden kann. Wir empfehlen jedoch nur die markierten Bereiche zu bearbeiten, um so zu verhindern, dass das Notebook nicht mehr funktioniert. Die Stelle an denen Sachen ver\u00e4ndert werden sollen sind klar gekennzeichnet und m\u00f6gliche \u00c4nderungen werden beschrieben.","e6a3cd18":"### 3.5 Modell trainieren"}}