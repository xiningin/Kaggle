{"cell_type":{"0f78efbd":"code","42e2720a":"code","0267d661":"code","60822be7":"code","ad0ea441":"code","a8f2fa25":"code","95915535":"code","1faa819a":"code","961ffe36":"code","42d7cb11":"code","1bc1f8b3":"code","05840473":"code","136cbe4d":"code","de2e1fa2":"code","dc920493":"code","62fbedf6":"code","e780b6ab":"code","3a34b444":"code","3bea229a":"code","12c09721":"code","e421519d":"code","0a95cb50":"code","d2027075":"code","ae3925fc":"code","dab11ac2":"code","38970eec":"code","4436e483":"code","f2db81af":"code","9211615c":"code","b9699713":"code","16d582ec":"code","bb61a612":"code","3c8a112e":"code","95790145":"code","dd4b6bc3":"code","90316288":"code","32569c67":"code","5221f655":"code","ccfce523":"code","7ce8aa07":"code","ff13959b":"code","89af8d8e":"code","c9553d6a":"code","b246bd89":"code","8714fb3c":"code","fa464803":"code","8cc00fde":"code","6b87f750":"code","ebd2cef9":"code","7338d3f7":"code","b8df0290":"code","3f6cd90c":"code","03029201":"code","5a413292":"code","87c1d57f":"code","e4563a72":"code","197e8027":"code","9d6c7ea3":"code","8833913e":"code","f219388e":"code","bdf11e31":"code","931d188a":"code","296a3563":"code","80e7f80b":"code","02323c87":"code","35dae043":"code","453b0505":"code","a486ccf1":"code","bd673c06":"code","97ac4439":"code","f95274ec":"code","6d745b31":"markdown","a8d2889a":"markdown","33395623":"markdown","1182b701":"markdown","6b49a480":"markdown","ac6b960b":"markdown","f0f02b2e":"markdown","068a7ccb":"markdown","1648c887":"markdown","5d37df4e":"markdown","d090450c":"markdown","6043a6ad":"markdown","1ba29c10":"markdown","4736e997":"markdown","7595b756":"markdown"},"source":{"0f78efbd":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","42e2720a":"train = pd.read_csv('..\/input\/neurodata\/Data_Train.csv')\ntest = pd.read_csv(\"..\/input\/neurodata\/Data_test.csv\")","0267d661":"print('Train Dataset contain',train.shape[0],'rows &',train.shape[1],'columns.')\nprint('Test Dataset contain',test.shape[0],'rows &',test.shape[1],'columns.')","60822be7":"train.head()","ad0ea441":"test.head()","a8f2fa25":"sns.heatmap(train.isnull())","95915535":"sns.heatmap(test.isnull())","1faa819a":"train.columns","961ffe36":"price = train.Price\ntrain.drop('Price',axis=1,inplace=True)","42d7cb11":"test.columns","1bc1f8b3":"joined = train.append(test)","05840473":"### Cleaning Edition Columns\nlist1 = []\nfor i in list(joined.Edition):\n    list1.append(i.split(',')[0])","136cbe4d":"joined.Edition = list1","de2e1fa2":"### Cleaning Reviews Columns\nlist1 = []\nfor i in joined.Reviews:\n    list1.append(i.split(\" \")[0])","dc920493":"joined.Reviews = list1","62fbedf6":"### Cleaning Ratings Columns\nlist1=[]\nfor i in joined.Ratings:\n    list1.append(i.split(\" \")[0])","e780b6ab":"joined.Ratings = list1","3a34b444":"from sklearn.preprocessing import LabelEncoder\nle = LabelEncoder()\njoined.Author = le.fit_transform(joined.Author)\njoined.Edition = le.fit_transform(joined.Edition)\njoined.Genre = le.fit_transform(joined.Genre)\njoined.BookCategory = le.fit_transform(joined.BookCategory)","3bea229a":"## Dropping Synopsis and Title\njoined.drop('Synopsis',axis=1,inplace=True)\njoined.drop('Title',axis=1,inplace=True)","12c09721":"joined.head()","e421519d":"joined.info()","0a95cb50":"### Convertings Obejects dtypes to int and float\njoined.Reviews = joined.Reviews.astype(float)\njoined.Ratings = joined.Ratings.astype(str)\njoined.Ratings = joined.Ratings.str.replace(',','')\njoined.Ratings = joined.Ratings.astype(int)","d2027075":"training = joined.iloc[:4277]\ntraining['Price'] = price\ntesting = joined.iloc[4277:]","ae3925fc":"plt.figure(figsize=(10,10))\nsns.heatmap(training.corr(),annot=True,square=True)\nplt.title('Correlation Heatmap of Featrues',size=25)","dab11ac2":"sns.scatterplot(training.Reviews,training.Price)","38970eec":"sns.scatterplot(training.Ratings,training.Price)","4436e483":"plt.title('Price Comparision with Reviews',size=20)\nsns.barplot(round(training.Reviews),training.Price)","f2db81af":"plt.title('Price Comparision with Book Category',size=20)\nplt.barh(train.BookCategory,price)","9211615c":"training.head()","b9699713":"from sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.metrics import r2_score\nimport numpy as np\nfrom sklearn.metrics import mean_absolute_error\nimport statsmodels.api as sm\nfrom sklearn.metrics import mean_squared_log_error","16d582ec":"X = training.drop('Price',axis=1)\ny = training[['Price']]","bb61a612":"X_train,X_test,y_train,y_test = train_test_split(X,y,train_size=0.7,random_state=0)","3c8a112e":"import xgboost as xgb\nmodel_xgb = xgb.XGBRegressor(max_depth=16, \n                             random_state =0,\n                             n_estimators=150,\n                            )","95790145":"model_xgb.fit(X_train,y_train)","dd4b6bc3":"y_pred = model_xgb.predict(X_test)","90316288":"print('RMSLE :',(np.sqrt(mean_squared_log_error( y_test, abs(y_pred)))))","32569c67":"from sklearn.feature_selection import RFE","5221f655":"rfe = RFE(model_xgb, 3)\nrfe.fit(X_train,y_train)","ccfce523":"rfe.support_","7ce8aa07":"print(X_train.columns[rfe.support_])","ff13959b":"Rcols = X_train.columns[rfe.support_]\nmodel_xgb.fit(X_train[Rcols],y_train)\ny_pred = model_xgb.predict(X_test[Rcols])","89af8d8e":"print('RMSLE :',(np.sqrt(mean_squared_log_error( abs(y_test),abs(y_pred)))))","c9553d6a":"model = sm.OLS(y, X)\nresults = model.fit()\nstart = \"\\033[1m\" ### for bold text\nprint(start)\nprint(results.summary())","b246bd89":"from sklearn.ensemble import RandomForestRegressor\nrf = RandomForestRegressor(random_state = 0,n_estimators = 50)","8714fb3c":"rf.fit(X_train,y_train)","fa464803":"y_pred = rf.predict(X_test)","8cc00fde":"print('RMSLE :',(np.sqrt(mean_squared_log_error( abs(y_test),abs(y_pred)))))","6b87f750":"rfe = RFE(rf, 2)\nrfe.fit(X_train,y_train)\nrfe.support_\nprint(X_train.columns[rfe.support_])\n\nRcols = X_train.columns[rfe.support_]\nrf.fit(X_train[Rcols],y_train)\ny_pred = rf.predict(X_test[Rcols])","ebd2cef9":"print('RMSLE :',(np.sqrt(mean_squared_log_error( abs(y_test),abs(y_pred)))))","7338d3f7":"training.columns","b8df0290":"tt = ['Edition', 'Reviews', 'Ratings', 'Genre']","3f6cd90c":"rf.fit(X_train[tt],y_train)\ny_pred = rf.predict(X_test[tt])","03029201":"print('RMSLE :',(np.sqrt(mean_squared_log_error(y_test,abs(y_pred)))))","5a413292":"from sklearn.svm import SVR","87c1d57f":"clf = SVR(C=1.0, epsilon=0.2)\nclf.fit(X_train, y_train)","e4563a72":"y_predsvr = clf.predict(X_test)","197e8027":"print('RMSLE for SVR :',(np.sqrt(mean_squared_log_error( y_test, y_predsvr))))","9d6c7ea3":"import lightgbm as lgb","8833913e":"X=training.drop('Price',axis=1)\ny=training[['Price']].values","f219388e":"X_train,X_test,y_train,y_test = train_test_split(X,y,train_size=0.7,random_state=0)","bdf11e31":"y_train = y_train.ravel()","931d188a":"model = lgb.LGBMRegressor(n_estimators=600,random_state=0)\nmodel.fit(X_train, y_train)","296a3563":"y_pred = model.predict(X_test)","80e7f80b":"print('RMSLE for Light GBM:',(np.sqrt(mean_squared_log_error( y_test,abs(y_pred)))))","02323c87":"fig, ax = plt.subplots(figsize=(10,10))\nlgb.plot_importance(model, height=0.8, ax=ax)\nax.grid(False)\nplt.title(\"LightGBM - Feature Importance\", fontsize=15)\nplt.show()","35dae043":"sol = model.predict(testing)","453b0505":"solution = pd.DataFrame(abs(sol),columns={'Price'})","a486ccf1":"solution.head()","bd673c06":"solution.to_csv('Predicted.csv',index=False)","97ac4439":"test['Price'] = solution.Price","f95274ec":"test.head()","6d745b31":"## LightGBM","a8d2889a":"## Splitting train and test","33395623":"## EDA ","1182b701":"## XGBOOST","6b49a480":"## SVR","ac6b960b":"#### Null values not present ","f0f02b2e":"## RANDOM FOREST","068a7ccb":"## One Hot Encoding","1648c887":"## MANUAL ELIMINATING ","5d37df4e":"## MANUAL APPROACH ","d090450c":"## Data Wrangling","6043a6ad":"## RFE","1ba29c10":"## RFE","4736e997":"#### Author, Genre and Ratings plays an important role in Price of Book.","7595b756":"## Modeling "}}