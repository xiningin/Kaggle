{"cell_type":{"43e4c7f8":"code","f7ec835f":"code","b99382d5":"code","b18cce88":"code","7f96c70f":"code","9f1047ce":"code","ab63e83f":"code","55588cc7":"code","66da32e7":"code","4bef0b51":"code","0abcf31b":"code","c12d7fe6":"code","e840a541":"code","ab8bca6b":"code","095a198d":"code","33a69a24":"code","faa2b0ad":"code","0b8fc0e5":"code","0eb379e2":"code","b99543f2":"code","b43f3880":"code","5f66e3dd":"code","dde569fe":"markdown","964fdb48":"markdown","b4c29dc7":"markdown","8ca1bedf":"markdown","fc9e33d9":"markdown","8e6e3212":"markdown","1ef0e453":"markdown","2164b8a7":"markdown","c9bca606":"markdown","8aad1e9c":"markdown","2c10fb17":"markdown","06c9c17e":"markdown"},"source":{"43e4c7f8":"import pandas as pd\nfrom tensorflow.keras.layers import Embedding\nfrom tensorflow.keras.preprocessing.sequence import pad_sequences\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense\nfrom tensorflow.keras.layers import LSTM\nfrom tensorflow.keras.layers import Dropout\nfrom tensorflow.keras.preprocessing.text import one_hot\nimport nltk\nfrom nltk.corpus import stopwords\nfrom nltk.stem import WordNetLemmatizer\nimport re\nimport seaborn as sns","f7ec835f":"df=pd.read_csv('\/kaggle\/input\/fake-news-data\/train.csv')","b99382d5":"df.head()","b18cce88":"df=df.dropna()","7f96c70f":"df.reset_index(inplace=True)","9f1047ce":"y=df.label","ab63e83f":"X=df.drop('label',axis=1)","55588cc7":"vs=7000","66da32e7":"corpus=[]","4bef0b51":"lemmatizer=WordNetLemmatizer()\nfor i in range(0,len(X)):\n    res=re.sub('[^a-zA-Z]',' ',X['text'][i])\n    res=res.lower()\n    res=res.split()\n    res=[lemmatizer.lemmatize(word) for word in res if not word in stopwords.words('english')]\n    res=' '.join(res)\n    corpus.append(res)","0abcf31b":"onehot=[one_hot(words,vs) for words in corpus]","c12d7fe6":"p=[]\nfor j in range(0,len(onehot)):\n     p.append(len(onehot[j]))\nprint(max(p))\nprint(p.index(max(p)))\n    ","e840a541":"sent_list=12060\nembedding=pad_sequences(onehot,padding='pre',maxlen=sent_list)\n","ab8bca6b":"embedding_vector_features=100\nmodel=Sequential()\nmodel.add(Embedding(vs,embedding_vector_features,input_length=sent_list))\nmodel.add(Dropout(0.3))\nmodel.add(LSTM(100))\nmodel.add(Dropout(0.3))\nmodel.add(Dense(1,activation='sigmoid'))\nmodel.compile(loss='binary_crossentropy',optimizer='adam',metrics=['accuracy'])","095a198d":"import numpy as np\nX_final=np.array(embedding)\ny_final=np.array(y)","33a69a24":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X_final, y_final, test_size=0.33)","faa2b0ad":"model.fit(X_train,y_train,validation_data=(X_test,y_test),epochs=10,batch_size=64)","0b8fc0e5":"y_pred=model.predict_classes(X_test)","0eb379e2":"from sklearn.metrics import confusion_matrix","b99543f2":"cm=confusion_matrix(y_test,y_pred)","b43f3880":"sns.heatmap(cm)","5f66e3dd":"from sklearn.metrics import accuracy_score\nprint(\"The accuracy score of Testing data\":,accuracy_score(y_test,y_pred))\nprint(\"The accuracy score of Training data:\",accuracy_score(y_train,model.predict_classes(X_train)))\n","dde569fe":"# <span style='font-family:MV Boli'><span style='color:red'> <center>FAKE NEWS DETECTOR","964fdb48":"### Lemmatizing","b4c29dc7":"### Confusion Matrix and Accuracy Score","8ca1bedf":"### Modelling ","fc9e33d9":"<font color='Indigo'><b> Please Upvotes and suggest more to accurate<\/span>","8e6e3212":"### Training","1ef0e453":"## <span style='color:blue'> Content <br>\n1. Import library\n2. Data preprocessing\n3. Lemmatizing\n4. Modelling\n5. Training\n6. Testing \n7. Classification report and confusion Matrix ","2164b8a7":"### Data Preprocessing","c9bca606":"# <span style='font-family:Arial Black'><span style='color:green'><center>Detector","8aad1e9c":"### TESTING","2c10fb17":"### Import library","06c9c17e":"![image.png](attachment:0d71206e-863d-49a3-ba58-71b2ad208e4d.png)![image.png](attachment:e0ac403c-9f01-45aa-ba1b-b745402a9082.png)"}}