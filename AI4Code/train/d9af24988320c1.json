{"cell_type":{"4cc4255b":"code","bfc0b907":"code","d60cc03a":"code","6ae9cde9":"code","2923eb15":"code","b7116c22":"code","a2adfa27":"code","45286dc7":"code","672598b9":"code","f9be9baf":"code","d96809f9":"code","735973ec":"code","79b1e5f6":"code","6ca16c07":"code","bc327d9d":"code","6f1833da":"code","a95d5df2":"code","f7d53f9f":"code","8c3ab5ec":"code","9494af37":"code","e5adcfcf":"code","80c5e7e2":"code","dec63ecc":"code","4eed02ad":"code","f761551a":"code","b41079ec":"code","570f4c66":"code","2bd7c51d":"code","030a6b4e":"code","4ba42717":"code","e666f1f1":"code","7bafaccc":"code","cb956e22":"code","80336d0f":"code","7113f81f":"markdown","c9e7bb04":"markdown","b978f792":"markdown","6b65236c":"markdown"},"source":{"4cc4255b":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport warnings\nnp.random.seed(0)\nwarnings.filterwarnings('ignore')\n\n\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.linear_model import LinearRegression,Lasso\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.metrics import mean_absolute_error\n\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.linear_model import Ridge\nfrom sklearn.ensemble import ExtraTreesRegressor","bfc0b907":"df = pd.read_csv('..\/input\/bigmart-sales-data\/Train.csv')\ndf.head()","d60cc03a":"df.info()","6ae9cde9":"df.isna().sum()","2923eb15":"df[df['Outlet_Size'].isnull()]","b7116c22":"df[df['Item_Weight'].isnull()]","a2adfa27":"df.groupby(\"Item_Type\")[\"Item_Weight\"].mean()\n","45286dc7":"mean = df.groupby('Item_Type')['Item_Weight'].mean()\nfor i in range(len(mean)):\n    c1 = (df['Item_Type']==mean.index[i])&(df['Item_Weight'].isna()==True)\n    df['Item_Weight'] = np.select([c1], [mean[i]], df['Item_Weight'])","672598b9":"from statistics import mode\ndf['Outlet_Size'].fillna(mode(df['Outlet_Size']),inplace=True)","f9be9baf":"df.head()","d96809f9":"df[\"Item_Fat_Content\"].unique()","735973ec":"fat_content = {\"low fat\": \"Low Fat\",\n               \"LF\": \"Low Fat\",\n               \"reg\":\"Regular\"}\ndf[\"Item_Fat_Content\"]= df[\"Item_Fat_Content\"].replace(fat_content)","79b1e5f6":"cols =[\"Item_Type\",\"Outlet_Identifier\",\"Outlet_Establishment_Year\",\"Outlet_Size\",\"Outlet_Location_Type\",\"Outlet_Type\"]\nfor i in cols:\n    print(df[i].unique())","6ca16c07":"sns.pairplot(df, hue = \"Item_Fat_Content\");","bc327d9d":"sns.countplot(df['Item_Fat_Content']);","6f1833da":"sns.distplot(df['Item_Outlet_Sales']);","a95d5df2":"sns.scatterplot(x='Item_Visibility',y='Item_Outlet_Sales',data=df);","f7d53f9f":"sns.countplot(df['Outlet_Identifier']);\nplt.xticks(rotation = 45)\nplt.show()","8c3ab5ec":"sns.scatterplot(x='Item_MRP',y='Item_Outlet_Sales',data=df);","9494af37":"sns.boxplot(x='Outlet_Identifier',y='Item_Outlet_Sales',data =df);\nplt.xticks(rotation = 90)\nplt.show()","e5adcfcf":"sns.countplot(x='Item_Type',data=df);\nplt.xticks(rotation = 90)\nplt.show()","80c5e7e2":"sns.barplot(y='Item_Outlet_Sales',x='Outlet_Type',data=df);\nplt.xticks(rotation = 90)\nplt.show()","dec63ecc":"sns.heatmap(df.corr(),annot=True);","4eed02ad":"sns.countplot(x=\"Outlet_Establishment_Year\", data = df);","f761551a":"sns.countplot(x=\"Outlet_Location_Type\", data = df);","b41079ec":"sns.countplot(x=\"Outlet_Size\", data = df);","570f4c66":"df.head()","2bd7c51d":"le = LabelEncoder()\ndf['Outlet'] = le.fit_transform(df['Outlet_Identifier'])\ncat_col = ['Item_Fat_Content', 'Item_Type', 'Outlet_Size', 'Outlet_Location_Type', 'Outlet_Type']\nfor col in cat_col:\n    df[col] = le.fit_transform(df[col])","030a6b4e":"df = pd.get_dummies(df, columns=['Item_Fat_Content', \n                                 'Outlet_Size', \n                                 'Outlet_Location_Type', \n                                 'Outlet_Type'])","4ba42717":"X = df.drop(columns=['Outlet_Establishment_Year', 'Item_Identifier', 'Outlet_Identifier', 'Item_Outlet_Sales'])\ny = df['Item_Outlet_Sales']","e666f1f1":"X_train,X_test,y_train,y_test = train_test_split(X,y,test_size =0.2)","7bafaccc":"rf = ExtraTreesRegressor()\nrf.fit(X_train,y_train)\ny_pred = rf.predict(X_test)\nmae = mean_absolute_error(y_test,y_pred)\nprint(\"MAE : \", mae)\ncoef = pd.Series(rf.feature_importances_, X.columns).sort_values(ascending=False)\ncoef.plot(kind='bar', title=\"Feature Importance\" , color = 'red')\nplt.show()","cb956e22":"from sklearn.model_selection import GridSearchCV\nparam_grid = {\n    'n_estimators': [10,50,100],\n    'criterion': ['mse', 'mae'],\n    'max_depth': [2,8,16,32,50],\n    'max_features': ['auto','sqrt','log2'],    \n}\ngcv = GridSearchCV(rf,param_grid,cv=5,n_jobs=-1)\ngcv.fit(X_train,y_train)","80336d0f":"y_pred = gcv.predict(X_test)\nmae = mean_absolute_error(y_test,y_pred)\nprint(\"MaE : \", mae)","7113f81f":"## Exploratory Data Analysis","c9e7bb04":"## Pre Processing","b978f792":"## Model Building","6b65236c":"## IMPORTS"}}