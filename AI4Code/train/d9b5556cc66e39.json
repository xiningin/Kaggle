{"cell_type":{"f2f86661":"code","8958ae5c":"code","78a337a8":"code","4dcb8737":"code","adf79051":"code","5ddc259d":"code","3c09abc2":"code","572ab39e":"code","e23232e1":"code","09129945":"code","10d15986":"code","f8dbc265":"code","fbfd53b2":"markdown","697836b3":"markdown","a49f4e8f":"markdown","1c554490":"markdown","68b189f8":"markdown"},"source":{"f2f86661":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom sklearn.metrics import roc_auc_score\nimport matplotlib.pyplot as plt\n\nimport os","8958ae5c":"train = pd.read_csv('..\/input\/siim-isic-melanoma-classification\/train.csv')\ntest  = pd.read_csv('..\/input\/siim-isic-melanoma-classification\/test.csv')\nsub   = pd.read_csv('..\/input\/siim-isic-melanoma-classification\/sample_submission.csv')\n\ntrain.shape, test.shape, sub.shape","78a337a8":"train['sex'] = train['sex'].fillna('na')\ntrain['age_approx'] = train['age_approx'].fillna(0)\ntrain['anatom_site_general_challenge'] = train['anatom_site_general_challenge'].fillna('na')\n\ntest['sex'] = test['sex'].fillna('na')\ntest['age_approx'] = test['age_approx'].fillna(0)\ntest['anatom_site_general_challenge'] = test['anatom_site_general_challenge'].fillna('na')","4dcb8737":"train.head()","adf79051":"test.head()","5ddc259d":"feat = ['sex','age_approx','anatom_site_general_challenge']\ngrp_mean_train = train.groupby(feat)['target'].agg(['mean']) \\\n                .reset_index().rename(columns={'mean': 'baseline'})\n\ngrp_mean_train","3c09abc2":"test = test.merge(grp_mean_train, on=feat, how='left' )\ntest.head()","572ab39e":"M = train.target.mean()\nM","e23232e1":"test['baseline'] = test['baseline'].fillna(M)","09129945":"sub.target = test.baseline.values\nsub.head(5)","10d15986":"plt.hist(sub.target,bins=100)\nplt.show()","f8dbc265":"sub.to_csv( 'submission.csv', index=False )","fbfd53b2":"### Make submission using baseline predictions","697836b3":"### Imputing missing values","a49f4e8f":"### Grouped target mean by features in training set","1c554490":"### Impute missing values for test set baseline\nUsing mean value of target variable in the training set","68b189f8":"### Join grouped mean values with test set"}}