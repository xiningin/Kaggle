{"cell_type":{"21c9f87f":"code","8b40d57e":"code","5abc780d":"code","b712af9a":"code","971b5233":"code","98a6c5c3":"code","0ed692c9":"code","a2fbccf8":"code","e523d6af":"code","fa3ff126":"code","749c2a62":"code","faf346ce":"code","44928306":"code","6d22afd5":"code","18c4f9c1":"code","5f3d861d":"code","fec91104":"code","21a71102":"code","86b796d1":"code","fd45cb25":"code","9dd30eda":"code","616b5be0":"code","4edad80b":"code","25420014":"code","b9e6fb96":"code","8f304093":"code","2017b490":"markdown","0847840c":"markdown","aa8a502f":"markdown","8ac0d95b":"markdown","33200be0":"markdown","cb169284":"markdown","ff87f4e2":"markdown","ee26fad0":"markdown","28c1138c":"markdown","43ff5ff3":"markdown","b90e94b7":"markdown","8c5b160d":"markdown","07317b9d":"markdown","62e13ab2":"markdown","0d99e278":"markdown","416ed215":"markdown"},"source":{"21c9f87f":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","8b40d57e":"pd.set_option('display.max_columns', None)\npd.set_option('display.max_rows', None)\npd.set_option('display.max_colwidth', -1)\npd.plotting.register_matplotlib_converters()\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nsns.set_style('darkgrid')\n\n","5abc780d":"from google.cloud import bigquery","b712af9a":"client = bigquery.Client()\n\ndataset_ref = client.dataset('world_bank_health_population', project='bigquery-public-data')\n\ndataset = client.get_dataset(dataset_ref)","971b5233":"tables = list(client.list_tables(dataset))\n\nlist_of_tables = [table.table_id for table in tables]\n\nprint(list_of_tables)","98a6c5c3":"table_ref = dataset_ref.table('country_series_definitions')\n\ntable = client.get_table(table_ref)\n\nclient.list_rows(table, max_results=5).to_dataframe()","0ed692c9":"table_ref = dataset_ref.table('country_summary')","a2fbccf8":"table = client.get_table(table_ref)\n\nclient.list_rows(table, max_results=5).to_dataframe()","e523d6af":"table_ref = dataset_ref.table('health_nutrition_population')\n\ntable = client.get_table(table_ref)\n\nclient.list_rows(table, max_results=5).to_dataframe()","fa3ff126":"table_ref = dataset_ref.table('series_summary')\n\ntable = client.get_table(table_ref)\n\nclient.list_rows(table, max_results=5).to_dataframe()","749c2a62":"table_ref = dataset_ref.table('series_times')\n\ntable = client.get_table(table_ref)\n\nclient.list_rows(table, max_results=5).to_dataframe()","faf346ce":"qseries = '''\n     SELECT DISTINCT series_code, topic, indicator_name\n     FROM `bigquery-public-data.world_bank_health_population.series_summary`\n     '''\n\nsafe_config = bigquery.QueryJobConfig(maximum_bytes_billed=10**10)\nqseries_job = client.query(qseries, job_config=safe_config)\n\nqseries_results = qseries_job.to_dataframe()\n\nqseries_results","44928306":"q1 = '''\n     SELECT country_name, indicator_name, year, value\n     FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`\n     WHERE indicator_code = 'SP.DYN.AMRT.MA' AND country_name = 'Canada' OR indicator_code = 'SP.DYN.AMRT.FE' AND country_name = 'Canada'\n     ORDER BY year\n     '''\n\nsafe_config = bigquery.QueryJobConfig(maximum_bytes_billed=10**10)\nq1_job = client.query(q1, job_config=safe_config)\n\nq1_results = q1_job.to_dataframe()\n\nq1_results","6d22afd5":"q1 = q1_results[['year', 'value']]\n\nyear_lst = []\nfor x in q1['year']:\n    year_lst.append(x)\nyear_lst = year_lst[0::2]\n\nmale_lst = []\nfor x in q1['value']:\n    male_lst.append(x)\nmale_lst = male_lst[1::2]\n\nfemale_lst = []\nfor x in q1['value']:\n    female_lst.append(x)\nfemale_lst = female_lst[0::2]\n\nq1_data = {'Year': year_lst,\n           'Male': male_lst,\n           'Female': female_lst\n          }\n\nq1_df = pd.DataFrame(q1_data, columns = ['Year','Male', 'Female'])\nq1_df = q1_df.set_index('Year')\n\nplt.figure(figsize=(10,7))\nplt.title('Adult Mortality Rate Based on Gender in Canada')\nplt.ylabel('Mortality Rate (per 1000)')\nsns.lineplot(data=q1_df)","18c4f9c1":"q2 = '''\n     SELECT country_name, indicator_name, year, value\n     FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`\n     WHERE indicator_code = 'SP.POP.0014.TO.ZS' AND country_name = 'High income' \n         OR indicator_code = 'SP.POP.0014.TO.ZS' AND country_name = 'Middle income' \n         OR indicator_code = 'SP.POP.0014.TO.ZS' AND country_name = 'Low income'\n     ORDER BY year\n     '''\n\nsafe_config = bigquery.QueryJobConfig(maximum_bytes_billed=10**10)\nq2_job = client.query(q2, job_config=safe_config)\n\nq2_results = q2_job.to_dataframe()\n\nq2_results","5f3d861d":"q2 = q2_results[['year', 'value']]\n\nyear_lst = []\nfor x in q2['year']:\n    year_lst.append(x)\nyear_lst = year_lst[0::3]\n\nhigh_income_lst = []\nfor x in q2['value']:\n    high_income_lst.append(x)\nhigh_income_lst = high_income_lst[0::3]\n\nlow_income_lst = []\nfor x in q2['value']:\n    low_income_lst.append(x)\nlow_income_lst = low_income_lst[1::3]\n\nmiddle_income_lst = []\nfor x in q2['value']:\n    middle_income_lst.append(x)\nmiddle_income_lst = middle_income_lst[2::3]\n\nq2_data = {'Year': year_lst,\n           'Low Income': low_income_lst,\n           'Middle Income': middle_income_lst,\n           'High Income': high_income_lst\n          }\n\nq2_df = pd.DataFrame(q2_data, columns=['Year', 'Low Income', 'Middle Income', 'High Income'])\nq2_df = q2_df.set_index('Year')\nq2_df = q2_df.iloc[0::10]\nq2_df\n\nplt.figure(figsize=(5,10))\nplt.title('Children Population Percentage Based on Income Class')\nsns.heatmap(data=q2_df, annot=True)","fec91104":"q3 = '''\n     SELECT country_name, indicator_name, year, value\n     FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`\n     WHERE indicator_code = 'SH.STA.OWAD.FE.ZS' AND country_name = 'Canada' \n         OR indicator_code = 'SH.STA.OWAD.MA.ZS' AND country_name = 'Canada'\n     '''\n\nsafe_config = bigquery.QueryJobConfig(maximum_bytes_billed=10**10)\nq3_job = client.query(q3, job_config=safe_config)\n\nq3_results = q3_job.to_dataframe()\n\nq3_results","21a71102":"gender = []\n\nfor x in range(0,42):\n    x = 'Female'\n    gender.append(x)\nfor y in range(0,42):\n    y ='Male'\n    gender.append(y)\n\nq3_results['Gender'] = gender\n\nq3 = q3_results[['year', 'value', 'Gender']]\nq3.columns = ['Year', 'Overweight Percentage', 'Gender']\n\n\nplt.figure(figsize=(7,5))\nplt.title('Canadian Overweight Percentage Based on Gender')\nsns.scatterplot(x='Year', y='Overweight Percentage', hue='Gender', data=q3)","86b796d1":"q5 = '''\n     SELECT country_name, indicator_name, year, value\n     FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`\n     WHERE indicator_code = 'SL.UEM.TOTL.ZS' AND country_name = 'Canada'\n         OR indicator_code = 'SL.UEM.TOTL.ZS' AND country_name = 'United States'\n         OR indicator_code = 'SL.UEM.TOTL.ZS' AND country_name = 'Mexico'\n     '''\n\nsafe_config = bigquery.QueryJobConfig(maximum_bytes_billed=10**10)\nq5_job = client.query(q5, job_config=safe_config)\n\nq5_results = q5_job.to_dataframe()\n\nq5_results","fd45cb25":"q5_mexico = q5_results.iloc[28:83]\nq5_usa = q5_results.iloc[26:27]\nq5_canada = q5_results.iloc[0:27]\n\nsns.distplot(a=q5_mexico['value'], label='Mexico', kde=False)\nsns.distplot(a=q5_usa['value'], label='United States', kde=False)\nsns.distplot(a=q5_canada['value'], label='Canada', kde=False)\n\nplt.title(\"Histogram of North American Country's Unemployment %\")\nplt.xlabel('Percentage')\nplt.legend()","9dd30eda":"q6 = '''\n     WITH smoking AS\n     (\n         SELECT year, value AS smoking_prevalence\n         FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`\n         WHERE indicator_code = 'SH.PRV.SMOK' AND country_name = 'Canada'\n     )\n     SELECT le.country_name, le.indicator_code, le.year, le.value AS life_expectancy, smoking.smoking_prevalence,\n     CASE\n         WHEN le.indicator_code = 'SP.DYN.LE00.FE.IN' THEN 'Female'\n         ELSE 'Male'\n     END AS gender\n     FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population` AS le\n     RIGHT JOIN smoking\n     ON le.year = smoking.year\n     WHERE indicator_code = 'SP.DYN.LE00.MA.IN' AND country_name = 'Canada'\n         OR indicator_code = 'SP.DYN.LE00.FE.IN' AND country_name = 'Canada'\n     '''\n\nsafe_config = bigquery.QueryJobConfig(maximum_bytes_billed=10**10)\nq6_job = client.query(q6, job_config=safe_config)\n\nq6_results = q6_job.to_dataframe()\n\nq6_results","616b5be0":"sns.lmplot(x=\"life_expectancy\", y=\"smoking_prevalence\", hue=\"gender\", data=q6_results)\nplt.title('Life Expectancy vs Smoking Prevalence in Canada')\nplt.xlabel('Life Expectancy')\nplt.ylabel('Smoking Prevalence')","4edad80b":"q6_1 = '''\n        SELECT country_name, indicator_code, year, value AS life_expectancy,\n        CASE\n            WHEN le.indicator_code = 'SP.DYN.LE00.FE.IN' THEN 'Female'\n            ELSE 'Male'\n        END AS gender\n        FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population` AS le\n        WHERE indicator_code = 'SP.DYN.LE00.MA.IN' AND country_name = 'Canada'\n            OR indicator_code = 'SP.DYN.LE00.FE.IN' AND country_name = 'Canada'\n     '''\n\nsafe_config = bigquery.QueryJobConfig(maximum_bytes_billed=10**10)\nq6_1_job = client.query(q6_1, job_config=safe_config)\n\nq6_1_results = q6_1_job.to_dataframe()\n\nq6_1_results","25420014":"sns.swarmplot(x= q6_1_results['gender'], y=q6_1_results['life_expectancy'])\nplt.title('Life Expectancy Based on Gender in Canada')\nplt.xlabel('Gender')\nplt.ylabel('Life Expectancy')","b9e6fb96":"q7 = '''\n     SELECT * \n     FROM `bigquery-public-data.world_bank_health_population.health_nutrition_population`\n     WHERE indicator_code = 'SP.POP.GROW' and country_name = 'Canada'\n     '''\n\nsafe_config = bigquery.QueryJobConfig(maximum_bytes_billed=10**10)\nq7_job = client.query(q7, job_config=safe_config)\n\nq7_results = q7_job.to_dataframe()\n\nq7_results","8f304093":"from xgboost import XGBRegressor\n\nx = q7_results.year\ny = q7_results.value\n\nx_lst = []\nfor num in x:\n    num = [num]\n    x_lst.append(num)\n\ny_lst = []\nfor num in y:\n    num = [num]\n    y_lst.append(num)\n\nx_array = np.array(x_lst)\ny_array = np.array(y_lst)\n\nmodel = XGBRegressor(n_estimators = 2000)\nmodel.fit(x_array, y_array)\n\nprediction = model.predict(np.array([[2019]]))\nprediction = prediction.tolist()\n\nplot_data = q7_results[['year', 'value']]\nplot_prediction = plot_data.iloc[-1:]\nplot_prediction = plot_prediction.append({'year': 2019, 'value':prediction[0]}, ignore_index = True)\n\nplot_data = plot_data.set_index('year')\nplot_prediction = plot_prediction.set_index('year')\n\nplt.figure(figsize=(14,6))\n\nplt.title(\"Canada's Annual Population Growth 2019 Prediction\")\nsns.lineplot(data=plot_data['value'], label=\"Canada's Annual Population Growth %\")\nax = sns.lineplot(data=plot_prediction['value'], label=\"Predicted Growth\")\nax.lines[1].set_linestyle(\"--\")\nplt.xlabel(\"Year\")\nplt.ylabel('Growth %')\nleg = ax.legend()\nleg_lines = leg.get_lines()\n\nprint(prediction)","2017b490":"1. Question 2: What's the difference in the children population percentage based on income class, and how has it changed?","0847840c":"Answer 3: Both the males and females' overweight percentage has increased from 1975 to 2016. In 1975 females' overweight percentage was 35.5 and males were 44.6, in 2016 females' overweight percentage was 58.5 and males were 69.8 an increase in over 20 percent respectively.","aa8a502f":"# Viewing tables","8ac0d95b":"# Question 6: Create an XGBoost machine learning model that predicts the population growth of Canada for 2019.","33200be0":"# Question 5: Has smoking prevalence had an impact on life expectancy for males and females?","cb169284":"# Viewing series codes and what they mean","ff87f4e2":"Answer 5: The lower smoking prevalence is the higher life expectancy becomes for both male and female. Also, in general females tend to have a longer life expectancy than males.","ee26fad0":"# Retrieving Data","28c1138c":"# Question 4: What has the North American country's unemployment percentage of total labor force mostly been since 1991?","43ff5ff3":"Answer 1: Both male and female adults are expected to live longer in Canada now then in comparrison to 1960!","b90e94b7":"Answer 4: We can see from the histogram that since 1991 Canada's unemployment percentage has mostly been between 6 and 12, the United States has mostly been between 6 and 7, and Mexicos has been between 1 and 5 percent.","8c5b160d":"* Answer 2: High income has the lowest children population percentage at 17, followed by middle income at 27 percent, and then low income with the highest percentage of children at 44. Since 1960 low-income children's percentage has slightly increased, where middle and high-income children's percentage has decreased by more than 10 percent respectively.","07317b9d":"Answer 6: According to the created XGBoost model, Canada's population is predicted to grow by 1.4078% in 2019.","62e13ab2":"# Solving Questions\nQuestion 1: How has the mortality rate for an adult changed in Canada for a male compared to female?","0d99e278":"# Question 3: How has the Canadian population overweight percentage changed when comparing males and females?","416ed215":"# Notebook Summary:\n\n**Question Solved for World Bank: Education Data** :\n\nQuestion 1: How has the mortality rate for an adult changed in Canada for a male compared to female?\n\nQuestion 2: What's the difference in the children population percentage based on income class, and how has it changed?\n\nQuestion 3: How has the Canadian population overweight percentage changed when comparing males and females?\n\nQuestion 4: What has the North American country's unemployment percentage of total labor force mostly been since 1991?\n\nQuestion 5: Has smoking prevalence had an impact on life expectancy for males and females?\n\n\nQuestion 6: Create an XGBoost machine learning model that predicts the population growth of Canada for 2019.\n\n#---------------------------------------------------------------------------\n\n#Previous Work:\n\nData Set name:Bitcoin Blockchain Historical Data(Complete historical Bitcoin blockchain data (BigQuery))\n\n# Blockchain System Anomaly Detection with Big Query & Machine learning Algorithms(IsolationForest & K-means)\n\n\n---------------------------------------------------------------------------\n\n# (*)Air Quality forcesing with Time series with ML \n\n1. (models: ARIMA,Autoregression (AR)\n1. Moving Average (MA)\n1. Autoregressive Moving Average (ARMA)\n1. Autoregressive Integrated Moving Average (ARIMA)\n1. Seasonal Autoregressive Integrated Moving-Average (SARIMA))\n\n\n---------------------------------------------------------------\n\nDataset: Medicare Data \n\n#  BigQuery for Deep Healthcare Analysis\n\nSample code:https:\/\/www.kaggle.com\/sohelranaccselab\/bigquery-for-deep-healthcare-analysis\n\n--------------------------------------------------------------\n\n\nInprogress:Data set name;\n\n(1)Google Analytics Sample data set\n\n(2)ChEMBL EBI Small Molecules Database \n\n(3)World Development Indicators (WDI) Data\n\n\n**********************************************************************\n\nGithub links for AI, Data Science & Remote Sensing Projects:\n\nhttps:\/\/github.com\/sohel-ccse\n\n------------------------------------------\n\nResearchgate Profile Link for Research projects & Publication:\n\nhttps:\/\/www.researchgate.net\/profile\/Sohel_Rana5\/research\n\n\n"}}