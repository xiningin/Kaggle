{"cell_type":{"d28a2c4a":"code","1c18d18f":"code","c7efcf15":"code","add18c1c":"code","352becb1":"code","229b6652":"code","ff591419":"code","5f06adde":"code","1f13f507":"code","715894eb":"code","67ea33fe":"code","fb0c98bb":"code","82ae63cc":"code","0e0ddfbd":"code","6a9392d6":"code","11beae28":"code","d243fd82":"code","0300b114":"code","a97e2bf1":"code","2f91319c":"code","e4e67e00":"code","68437e60":"code","4a3b1e25":"code","0998bbc7":"code","5e351324":"code","0f6eb46a":"code","980ec00b":"code","f6714c4f":"code","d312432a":"code","20016df1":"code","0bd28c76":"code","6e7bebec":"code","baa3b7b5":"code","377613e5":"code","e73487ba":"code","d524cb16":"code","80fa8257":"code","ff783d82":"code","6b295dc8":"code","e59314e5":"code","dea3919e":"code","489694dc":"markdown","632d7719":"markdown","3c0026c4":"markdown","c6d2bb08":"markdown","b3caa6b9":"markdown","2de04a23":"markdown","f20334ef":"markdown","11c19190":"markdown","9d48b004":"markdown","d384dd52":"markdown","4dd8ab2b":"markdown","c5f5c516":"markdown","f8d1eed0":"markdown"},"source":{"d28a2c4a":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","1c18d18f":"import pandas as pd\nimport numpy as np\nimport pickle\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.preprocessing import StandardScaler\nfrom scipy.cluster.hierarchy import dendrogram, linkage\nfrom sklearn.cluster import KMeans\nfrom sklearn.decomposition import PCA\nsns.set()","c7efcf15":"seg=pd.read_csv('..\/input\/segmentation1\/segmentation1.csv',index_col=[0])\nseg.sample(6)","add18c1c":"seg['Sex']=seg['Sex'].map({\"male\":0,\n                           'female':1})\nseg['Education']=seg['Education'].map({'other':0,\n                                       'high school':1,\n                                        'university':2,\n                                        'graduate school':3})\nseg['Settlement size']=seg['Settlement size'].map({'small city':0,\n                                                  'mid-sized city':1, \n                                                   'big city':2})\nseg['Occupation']=seg['Occupation'].map({'unemployed \/ unskilled':0, \n                                         'skilled employee \/ official':1,\n                                         'management \/ self-employed \/ highly qualified employee \/ officer':2})\nseg['Marital status']=seg['Marital status'].map({'single':0,\n                                                ' non-single':1})\nseg.sample(5)","352becb1":"seg.info()","229b6652":"seg.describe()","ff591419":"seg.corr().round(2)","5f06adde":"plt.figure(figsize=(10,5))\nsns.heatmap(seg.corr().round(2),annot=True,vmin=-1,vmax=1)\nplt.title('Correlation Map', fontsize=20)\n","1f13f507":"stand=StandardScaler()\nstand=stand.fit_transform(seg)\nstand","715894eb":"lin=linkage(stand,\"ward\")\nplt.figure(figsize=(20,20))\ndendrogram(lin,show_leaf_counts=False,no_labels=True,truncate_mode='level',p=5)\nplt.ylabel('Distance')\nplt.title('Hierachitical Clustering', fontsize=20)\nplt.show()","67ea33fe":"km_clus=[]\nfor i in range(1,11):\n    kmeans=KMeans(n_clusters=i,init=\"k-means++\",random_state=50)\n    kmeans.fit(stand)\n    km_clus.append(kmeans.inertia_)","fb0c98bb":"km_clus","82ae63cc":"plt.figure(figsize=(10,8))\nplt.plot(range(1,11),km_clus,marker=\"o\",linestyle=\"--\")","0e0ddfbd":"kmeans=KMeans(n_clusters=4,init=\"k-means++\",random_state=50)\nkmeans.fit(stand)\nk=kmeans.labels_","6a9392d6":"seg['Seg by k-means\/Labels']= k","11beae28":"seg.sample(5)","d243fd82":"seg_analysis=seg.groupby('Seg by k-means\/Labels').mean()\nseg_analysis","0300b114":"seg_analysis['Number of Observation']=seg[['Age','Seg by k-means\/Labels']].groupby('Seg by k-means\/Labels').count()\nseg_analysis[\"Probability Observation\"]=seg_analysis['Number of Observation']\/seg_analysis['Number of Observation'].sum()\nseg_analysis","a97e2bf1":"seg_analysis.rename(index={0:\"Fewer-Opportunities\",\n                           1:\"Well-Off\",\n                           2:\"standard\",\n                           3:'Educated & Carrer Focused'},\n                         inplace=True)","2f91319c":"seg_analysis","e4e67e00":"plt.figure(figsize=(10,5))\nsns.barplot(seg_analysis.index,seg_analysis['Number of Observation'],data=seg_analysis)\nplt.xticks(rotation=90)","68437e60":"seg['Labels']=seg['Seg by k-means\/Labels'].map({0:\"Fewer-Opportunities\",\n                           1:\"Well-Off\",\n                           2:\"standard\",\n                           3:'Educated & Carrer Focused'\n                         })\nseg","4a3b1e25":"plt.figure(figsize=(20,10))\nsns.scatterplot(seg.Age,seg.Income,hue=seg[\"Labels\"],data=seg)\nplt.title(\"segmentation k-means\")\nplt.show()","0998bbc7":"pca=PCA()\npca.fit(stand)\npca.explained_variance_ratio_","5e351324":"plt.figure(figsize=(15,10))\nplt.plot(range(1,8),pca.explained_variance_ratio_.cumsum(),marker=\"o\",linestyle=\"--\")\nplt.title(\"Explained variance by components\")\nplt.xlabel('Number of components')\nplt.ylabel('cumulative explained variance')","0f6eb46a":"pca=PCA(n_components=3)\npca.fit(stand)\npca.components_.round(2)","980ec00b":"seg.columns","f6714c4f":"pca_component=pd.DataFrame(pca.components_.round(2),columns=['Sex', 'Marital status', 'Age', 'Education', 'Income', 'Occupation',\n       'Settlement size'],index=['comp 1','comp 2','comp 3'])\npca_component","d312432a":"sns.heatmap(pca_component,\n           vmin=-1,\n           vmax=1,\n           cmap='RdBu',\n           annot=True)\nplt.yticks([0,1,2],\n          ['comp 1','comp 2','comp 3'],\n          rotation=45,\n          fontsize=9)","20016df1":"pca_1=pca.transform(stand)","0bd28c76":"k_clus_pca=[]\nfor i in range(1,11):\n    kmeans=KMeans(n_clusters=i,random_state=40)\n    kmeans.fit(pca_1)\n    k_clus_pca.append(kmeans.inertia_)","6e7bebec":"plt.figure(figsize=(10,5))\nplt.plot(range(1,11),k_clus_pca,marker='o')\nplt.title('K-means Clustering with PCA')\nplt.ylabel('Distance')","baa3b7b5":"k_clus_pca=KMeans(n_clusters=4,init=\"k-means++\",random_state=40)\nk_clus_pca.fit(pca_1)\nk_clus_pca.labels_","377613e5":"del seg[\"Labels\"],seg['Seg by k-means\/Labels']","e73487ba":"seg.sample(5)","d524cb16":"seg[\"segment k-means and pca\"]=k_clus_pca.labels_\nseg[['comp 1','comp 2','comp 3']]=pca_1.round(2)","80fa8257":"seg[['comp 1','comp 2','comp 3']]=pca_1.round(2)","ff783d82":"seg.sample(6)","6b295dc8":"grp_seg=seg.groupby('segment k-means and pca').mean().round(3)\ngrp_seg['Number of observation']=seg[['Age','segment k-means and pca']].groupby('segment k-means and pca').count()\ngrp_seg['probability of observation']=(grp_seg['Number of observation']\/seg['segment k-means and pca'].sum()).round(3)\ngrp_seg.rename(index={3:'Carrer Focus',\n                      2:\"low oppurtunies & Income\",\n                      1:\"Standard\",\n                      0:\"well-Off\"},inplace=True)\ngrp_seg","e59314e5":"seg['label']=seg['segment k-means and pca'].map({3:'Carrer Focus',\n                      2:\"low oppurtunies & Income\",\n                      1:\"Standard\",\n                      0:\"well-Off\"})\nseg","dea3919e":"plt.figure(figsize=(15,5))\nax=sns.scatterplot(seg['comp 1'],seg['comp 2'],hue=seg['label'])\nax.legend(loc='upper left')\n","489694dc":"# **Segmmentation Analysis**","632d7719":"# **Hierachitical clustering for segmentation**","3c0026c4":"# **Data Exploration**","c6d2bb08":"**checking for correlation**","b3caa6b9":"# **Data Preprocessing**","2de04a23":"# **Standardization**","f20334ef":"**from above, base on hierarchical clustering the data is cluster into 4 segment**","11c19190":"# **Customer Segmentation and Analysis**","9d48b004":"# **Principle Component Analysis**","d384dd52":"# **K-means Clustering with PCA**","4dd8ab2b":"**from above we can see that the data contain no null**","c5f5c516":"# **K-Means Clustering**","f8d1eed0":"# ID\tnumerical\tInteger\tShows a unique identificator of a customer.\t\n\t\t\t\t\n# Sex\tcategorical\t{0,1}\tBiological sex (gender) of a customer. In this dataset there are only 2 different options.\t\n\t\t0\tmale\t\n\t\t1\tfemale\t\n\n# Marital status\tcategorical\t{0,1}\tMarital status of a customer.\t\n\t\t0\tsingle\t\n\t\t1\tnon-single (divorced \/ separated \/ married \/ widowed)\t\n\t\t\t\t\n\n# Education\tcategorical\t{0,1,2,3}\tLevel of education of the customer\t\n\t\t0\tother \/ unknown\t\n\t\t1\thigh school\t\n\t\t2\tuniversity\t\n\t\t3\tgraduate school\t\n\n\n# ccupation\tcategorical\t{0,1,2}\tCategory of occupation of the customer.\t\n\t\t0\tunemployed \/ unskilled\t\n\t\t1\tskilled employee \/ official\t\n\t\t2\tmanagement \/ self-employed \/ highly qualified employee \/ officer\t\n\t\t\t\t\n# Settlement size\tcategorical\t{0,1,2}\tThe size of the city that the customer lives in.\t\n\t\t0\tsmall city\t\n\t\t1\tmid-sized city\t\n\t\t2\tbig city\t"}}