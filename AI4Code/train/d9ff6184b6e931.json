{"cell_type":{"511f39a4":"code","268198db":"code","ae3ab554":"code","cc3d3db9":"code","a2ed7f52":"code","75ebdca5":"code","7c8f3c39":"code","619f9f06":"code","9d4fbf41":"code","2fa68719":"code","301ff5d2":"code","c7c712dd":"code","8eebdbf9":"code","c8e1d8ed":"code","f1a94c1e":"code","588c1572":"markdown","d2cb7c72":"markdown","50b72b02":"markdown","8f62ae8e":"markdown","84598eca":"markdown","f2911ced":"markdown","8800447e":"markdown","f267ad39":"markdown"},"source":{"511f39a4":"%%capture\n!pip install pycaret[full]","268198db":"import pandas as pd\nimport numpy as np \nfrom pycaret.regression import *","ae3ab554":"train = pd.read_csv('..\/input\/tabular-playground-series-jan-2022\/train.csv',index_col='row_id')\ntest = pd.read_csv('..\/input\/tabular-playground-series-jan-2022\/test.csv',index_col='row_id')","cc3d3db9":"train","a2ed7f52":"train['date'] = pd.to_datetime(train['date'])","75ebdca5":"test","7c8f3c39":"def pre_process(df):\n    \n    df['date'] = pd.to_datetime(df['date'])\n    df['week']= df['date'].dt.week\n    df['year'] = 'Y'+df['date'].dt.year.astype(str)\n    df['quarter'] = 'Q'+df['date'].dt.quarter.astype(str)\n    df['day'] = df['date'].dt.day\n    df['dayofyear'] = df['date'].dt.dayofyear\n    df.loc[(df.date.dt.is_leap_year) & (df.dayofyear >= 60),'dayofyear'] -= 1\n    df['weekend'] = df['date'].dt.weekday >=5\n    df['weekday'] = 'WD' + df['date'].dt.weekday.astype(str)\n    return df\n\npre_process(train)\npre_process(test)","619f9f06":"train.info(), test.info()","9d4fbf41":"# Credit to https:\/\/www.kaggle.com\/c\/web-traffic-time-series-forecasting\/discussion\/36414\ndef SMAPE(y_true, y_pred):\n    denominator = (y_true + np.abs(y_pred)) \/ 200.0\n    diff = np.abs(y_true - y_pred) \/ denominator\n    diff[denominator == 0] = 0.0\n    return np.mean(diff)","2fa68719":"import seaborn as sns\nsns.countplot(data = train, x = 'country')","301ff5d2":"reg = setup(data = train,\n            target = 'num_sold',\n            normalize=True,\n            normalize_method='robust',\n            transform_target = True,\n            data_split_shuffle = False, #so that we do not use \"future\" observations to predict \"past\" observations\n            create_clusters = False,\n            use_gpu = True,\n            silent = True,\n            fold=10,\n            n_jobs = -1)","c7c712dd":"add_metric('SMAPE', 'SMAPE', SMAPE, greater_is_better = False)\ntop = compare_models(sort = 'SMAPE',n_select = 3, include = ['catboost','lightgbm','xgboost'])","8eebdbf9":"blend = blend_models(top)\npredict_model(blend)","c8e1d8ed":"final_blend = finalize_model(blend)\npredict_model(final_blend)","f1a94c1e":"preds = predict_model(final_blend, data=test)\nsub = pd.DataFrame(list(zip(test.index,preds.Label)),columns = ['row_id', 'num_sold'])\nsub.to_csv('submission.csv', index = False)\nprint(sub.head(),sub.describe())","588c1572":"## Membuat prediksi buat target yang ditentukan (Prediksi tahun 2019)","d2cb7c72":"## Nambahin, hari, tahun, minggu, dkk","50b72b02":"## Ambil Data","8f62ae8e":"## Membadingkan sesama Algoritma","84598eca":"## Membuat prediksi yang punya akurasi paling bagus","f2911ced":"## Import","8800447e":"This notebooks builds on the approach in https:\/\/www.kaggle.com\/mfedeli\/tabular-playground-series-jan-2022 - thanks for sharing!","f267ad39":"## Cari Algoritma Terbaik"}}