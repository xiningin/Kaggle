{"cell_type":{"ddd26014":"code","7aa90865":"code","f8560470":"code","0b308fdb":"code","f9aff4d0":"code","a7f78a07":"code","ff00360a":"code","51905dae":"code","90ece875":"code","343f3ca5":"code","d9c7f69b":"code","4b4c7f10":"code","c90d3051":"markdown","29db71b4":"markdown","2bc2fe26":"markdown","8de33ef2":"markdown","ffec404e":"markdown","559e9964":"markdown","93b61591":"markdown","f960b2a7":"markdown"},"source":{"ddd26014":"!pip install catboost","7aa90865":"import numpy as np\nimport random\nimport os\nimport torch\nfrom pathlib import Path\nimport pandas as pd\nfrom catboost import CatBoostClassifier\nfrom sklearn.multioutput import MultiOutputClassifier\nfrom sklearn.pipeline import Pipeline\nfrom category_encoders import CountEncoder","f8560470":"def seed_everything(seed=0):\n    random.seed(seed)\n    os.environ['PYTHONHASHSEED'] = str(seed)\n    np.random.seed(seed)\n    torch.manual_seed(seed)\n    torch.cuda.manual_seed(seed)\n    torch.backends.cudnn.deterministic = True\n\nseed_everything()","0b308fdb":"path = Path('\/kaggle\/input\/lish-moa')","f9aff4d0":"train = pd.read_csv(path \/ 'train_features.csv')\ntargets = pd.read_csv(path \/ 'train_targets_scored.csv')\n\ntest = pd.read_csv(path \/ 'test_features.csv')\nsub = pd.read_csv(path \/ 'sample_submission.csv')","a7f78a07":"model = CatBoostClassifier(iterations=1,silent=False, random_state=0)\nclassifier = MultiOutputClassifier(model)\nclf = Pipeline([('encode', CountEncoder(cols=[\"cp_type\", \"cp_dose\"])), ('classify', classifier)])","ff00360a":"drop_id = [\"sig_id\"]\n\nX_train = train.drop(drop_id, axis=1)\ny_train = targets.drop(drop_id, axis=1)","51905dae":" clf.fit(X_train, y_train)","90ece875":"X_test = test.drop(drop_id, axis=1)\npreds = clf.predict_proba(X_test)\npreds = np.array(preds)[:,:,1].T ","343f3ca5":"control_mask = test['cp_type']=='ctl_vehicle'\nX_test[control_mask] = 0","d9c7f69b":"sub.iloc[:,1:] = preds","4b4c7f10":"sub.to_csv('submission.csv', index=False)","c90d3051":"### Baseline Multiclassifier","29db71b4":"Cat motivation before we begin.","2bc2fe26":"CatBoost is a high-performance open source library for gradient boosting on decision trees. More details can be found [here](https:\/\/catboost.ai\/). This is one of my favourite gradient boosting library. ","8de33ef2":"### Importing Libraries","ffec404e":"### Reading Dataset","559e9964":"![Cat Image](http:\/\/pngimg.com\/uploads\/cat\/cat_PNG50538.png)","93b61591":"### Predictions","f960b2a7":"### Seed"}}