{"cell_type":{"b1eabba7":"code","52f03894":"code","3b150ba8":"code","b834c4f7":"code","0e76f4da":"code","f51c041c":"code","66db7574":"code","da1e52d7":"code","5049a76f":"code","c2587547":"code","cfed4074":"code","dbb32cde":"code","4b387489":"code","8a0bec45":"code","3e4930e5":"code","89c2df59":"code","1b96557e":"code","39a9a994":"code","1935f7e5":"code","78361032":"code","8a231d49":"code","d68b8ac3":"code","9d06e5c9":"code","f1252c22":"code","bf68f303":"code","01dd3937":"code","432aa5f2":"code","55bf2114":"code","73d6293a":"code","70c4fea9":"code","5879f609":"code","201dd148":"code","d93f57ff":"code","6eeb2ef1":"markdown","1287564c":"markdown","b28c77ac":"markdown","0a75b63e":"markdown","8af57c3b":"markdown","c9ffcbbc":"markdown","06ff1e9e":"markdown","a4f892fc":"markdown","c545c52a":"markdown","9edb4037":"markdown","d377e59a":"markdown","2b470d9f":"markdown","f1d88332":"markdown","0adc1a0c":"markdown","fc80f395":"markdown","ade805a0":"markdown","804366f5":"markdown","bfd6c57a":"markdown","90b1736a":"markdown","53e4af14":"markdown","1695aee1":"markdown","48292e01":"markdown","6ad175f0":"markdown"},"source":{"b1eabba7":"import numpy as np \nimport pandas as pd\nimport seaborn as sns\nfrom matplotlib import pyplot as plt\n\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.ensemble import RandomForestRegressor\nimport pickle","52f03894":"world = pd.read_csv(\"..\/input\/countries-of-the-world\/countries of the world.csv\",decimal=',')","3b150ba8":"world.describe()","b834c4f7":"plt.figure(figsize=(12,10))\nsns.barplot(data=world.isnull().sum().reset_index(), y='index',x=0)\nplt.ylabel('Variables')\nplt.title('Missing Values Plot')\nplt.xlabel('Missing value Count')\nplt.show()","0e76f4da":"for col in world.columns.values:\n    if world[col].isnull().sum() == 0:\n        continue\n    if col == 'Climate':\n        guess_values = world.groupby('Region')['Climate'].apply(lambda x: x.mode().max())\n    else:\n        guess_values = world.groupby('Region')[col].median()\n    for region in world['Region'].unique():\n        world[col].loc[(world[col].isnull())&(world['Region']==region)] = guess_values[region]","f51c041c":"world.isnull().sum()","66db7574":"fig, ax = plt.subplots(figsize=(16,6))\nsns.barplot(x='Country',y='GDP ($ per capita)',data=world.sort_values('GDP ($ per capita)',ascending=False).head(20), palette='Set3')\nplt.xticks(rotation=90)\nplt.show()","da1e52d7":"fig, ax = plt.subplots(figsize=(16,6))\nsns.barplot(x='Country',y='GDP ($ per capita)',data=world.sort_values('GDP ($ per capita)',ascending=True).head(20), palette='Set3')\nplt.xticks(rotation=90)\nplt.show()","5049a76f":"world['Total_GDP'] = world['GDP ($ per capita)'] * world['Population']\nplt.figure(figsize=(14,10))\n\nsns.barplot(x='Country',y='Total_GDP',data=world.sort_values('Total_GDP',ascending=False).head(10),palette='Set3')","c2587547":"plt.subplots(figsize=(14,10))\ngdp=world.sort_values('Total_GDP',ascending=False).head(25)\nplt.pie(gdp['Total_GDP'],labels=gdp['Country'],autopct='%1.1f%%',shadow=True);","cfed4074":"plt.figure(figsize=(14,10))\nsns.boxplot(x=\"Region\",y=\"GDP ($ per capita)\",data=world,width=0.7,palette=\"Set3\",fliersize=5)\nplt.xticks(rotation=90)\nplt.title(\"GDP BY REG\u0130ON\",color=\"red\")","dbb32cde":"plt.figure(figsize=(16,12))\nsns.heatmap(data=world.iloc[:,2:].corr(),annot=True,fmt='.2f',cmap='coolwarm')\nplt.show()","4b387489":"plt.figure(figsize=(14,10))\nsns.scatterplot(data=world,x='Infant mortality (per 1000 births)',y='GDP ($ per capita)',hue='Region')","8a0bec45":"plt.figure(figsize=(14,10))\nsns.scatterplot(data=world,x='Literacy (%)',y='GDP ($ per capita)',hue='Region')","3e4930e5":"plt.figure(figsize=(14,10))\nsns.scatterplot(data=world,x='Phones (per 1000)',y='GDP ($ per capita)',hue='Region')","89c2df59":"plt.figure(figsize=(14,10))\nsns.scatterplot(data=world,x='Agriculture',y='GDP ($ per capita)',hue='Region')","1b96557e":"plt.figure(figsize=(14,10))\nsns.scatterplot(data=world,x='Birthrate',y='GDP ($ per capita)',hue='Region')","39a9a994":"plt.figure(figsize=(16,12))\nsns.lineplot(data=world.sort_values('GDP ($ per capita)',ascending=False).head(100),x='GDP ($ per capita)',y='Birthrate',ci=None,label='Birthrate')\nsns.lineplot(data=world.sort_values('GDP ($ per capita)',ascending=False).head(100),x='GDP ($ per capita)',y='Deathrate',ci=None,label='Deathrate')","1935f7e5":"plt.figure(figsize=(16,12))\nsns.lineplot(data=world.sort_values('GDP ($ per capita)',ascending=True).head(100),x='GDP ($ per capita)',y='Birthrate',ci=None,label='Birthrate')\nsns.lineplot(data=world.sort_values('GDP ($ per capita)',ascending=True).head(100),x='GDP ($ per capita)',y='Deathrate',ci=None,label='Deathrate')","78361032":"plt.figure(figsize=(16,12))\ngdp[['Country','Agriculture', 'Industry', 'Service']].set_index('Country').head(10).plot.bar(stacked=True,figsize=(10,6))","8a231d49":"LE = LabelEncoder()\nworld['Region_label'] = LE.fit_transform(world['Region'])\nworld['Climate_label'] = LE.fit_transform(world['Climate'])\nworld.head()","d68b8ac3":"train, test = train_test_split(world, test_size=0.3, shuffle=True)\ntraining_features = ['Population', 'Area (sq. mi.)',\n       'Pop. Density (per sq. mi.)', 'Coastline (coast\/area ratio)',\n       'Net migration', 'Infant mortality (per 1000 births)',\n       'Literacy (%)', 'Phones (per 1000)',\n       'Arable (%)', 'Crops (%)', 'Other (%)', 'Birthrate',\n       'Deathrate', 'Region_label',\n       'Climate_label']\ntarget = 'GDP ($ per capita)'\ntrain_X = train[training_features]\ntrain_Y = train[target]\ntest_X = test[training_features]\ntest_Y = test[target]","9d06e5c9":"print(train_X.shape) \nprint(train_Y.shape)\nprint(test_X.shape)\nprint(test_Y.shape)","f1252c22":"model1 = LinearRegression()\nmodel1.fit(train_X, train_Y)\ntrain_pred_Y = model1.predict(train_X)\ntest_pred_Y = model1.predict(test_X)","bf68f303":"from sklearn.metrics import r2_score","01dd3937":"print('Training Score : ',model1.score(train_X,train_Y))\nprint(f'Test score : ',r2_score(test_pred_Y,test_Y))","432aa5f2":"plt.figure(figsize=(18,9))\nwhole=model1.predict(world[training_features])\nsns.regplot(x=world[target],y=whole) ","55bf2114":"model = RandomForestRegressor(n_estimators = 100,\n                             max_depth = 6,\n                             min_weight_fraction_leaf = 0.05,\n                             max_features = 0.8,\n                             random_state = 42)\nmodel.fit(train_X, train_Y)\ntrain_pred_Y = model.predict(train_X)\ntest_pred_Y = model.predict(test_X)","73d6293a":"print('Training Score :',model.score(train_X,train_Y))\nprint(f'Test score : ',r2_score(test_pred_Y,test_Y))","70c4fea9":"plt.figure(figsize=(18,9))\nwhole=model.predict(world[training_features])\nsns.regplot(x=world[target],y=whole) \n\n","5879f609":"df = pd.DataFrame(columns = training_features)","201dd148":"df = df.append({'Population':500000000, 'Area (sq. mi.)':3287263,\n       'Pop. Density (per sq. mi.)':152.0, 'Coastline (coast\/area ratio)':2.0,\n       'Net migration':0.0, 'Infant mortality (per 1000 births)':5,\n       'Literacy (%)':99.0, 'Phones (per 1000)':1000,\n       'Arable (%)':60, 'Crops (%)':10, 'Other (%)':30, 'Birthrate':10,\n       'Deathrate':5, 'Region_label':0,\n       'Climate_label':0},ignore_index = True) \ndf = df.append({'Population':28740280, 'Area (sq. mi.)':598227,\n       'Pop. Density (per sq. mi.)':379, 'Coastline (coast\/area ratio)':21.16,\n       'Net migration':0.03, 'Infant mortality (per 1000 births)':35.28,\n       'Literacy (%)':83.58, 'Phones (per 1000)':234.62,\n       'Arable (%)':13.7, 'Crops (%)':4.3, 'Other (%)':81.67, 'Birthrate':22.06,\n       'Deathrate':9.19, 'Region_label':0,\n       'Climate_label':0},ignore_index = True)\ndf","d93f57ff":"model.predict(df)","6eeb2ef1":"# Birthrate and Deathrate of Top 100 Countries","1287564c":"# We will try to predict GDP per capita of Two Imaginary Countries\n# 1.DreamLand : Better than Average in all features\n# 2.MeanLand : Mean of all Countries","b28c77ac":"## The missing data is filled using the median of the region that a country belongs, as countries that are close geologically are often similar in many ways","0a75b63e":"# Linear Regression Model","8af57c3b":"# Visualization of Results","c9ffcbbc":"# Thank You","06ff1e9e":"## Top Countries with lowest GDP per capita","a4f892fc":"# Predicted GDP per capita\n# DreamLand :  \\$20946.20\n# MeanLand : \\$5438.23","c545c52a":"# Data Exploration\n## Top Countries with highest GDP per capita","9edb4037":"# Share of Total GDP of Top 25 countries","d377e59a":"#  Comparison of the economy structure for the ten countries with highest total GDP","2b470d9f":"# Correlation between Variables","f1d88332":"# Top Countries with highest Total GDP","0adc1a0c":"# Top Factors affecting GDP per capita\n## We pick the five columns that mostly correlate to GDP per capita and make scatter plots.","fc80f395":"# Random Forest Regressor","ade805a0":"# Visualization of Results","804366f5":"# Countries of the World\n","bfd6c57a":"# Modeling\n# Training and Testing","90b1736a":"## Training Score : 90.36%\n## Test score :  76.15%","53e4af14":"## Training Score : 73.71%\n## Test score :  76.90%","1695aee1":"#  Total GDP per capita by Region","48292e01":"# Birthrate and Deathrate of Last 100 Countries","6ad175f0":"# Data Pre-processing"}}