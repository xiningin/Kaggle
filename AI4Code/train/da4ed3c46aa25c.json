{"cell_type":{"7b1fe5c6":"code","dce8cf39":"code","630c8d3b":"code","e8ea6a23":"code","30f9ad37":"code","944e044c":"code","79a52ffd":"code","f820082b":"code","40562a42":"code","6ebb77df":"markdown","f8752efa":"markdown","7a0d7df0":"markdown","d1f2ad3e":"markdown"},"source":{"7b1fe5c6":"import plotly.express as px\nfrom pandas import Timestamp\nimport numpy as np\nimport pandas as pd\n","dce8cf39":"dfLockdownDates = pd.read_csv('\/kaggle\/input\/covid19-lockdown-dates-by-country\/countryLockdowndatesJHUMatch.csv', parse_dates=['Date'])\ndfLockdownDates.head()","630c8d3b":"dfConfirmedCases = pd.read_csv('\/kaggle\/input\/novel-corona-virus-2019-dataset\/covid_19_data.csv', parse_dates=['ObservationDate'])\ndfConfirmedCases = dfConfirmedCases.groupby(['ObservationDate', 'Country\/Region'])['Confirmed'].sum().reset_index()\n# dfFullGB = dfFullGB.sort_values('Confirmed',ascending=False, axis=0)#.reset_index()\ndfConfirmedCases = dfConfirmedCases.rename(columns={'index': 'Country\/Region'})","e8ea6a23":"# get a sorted list of countries based of number of cases per country\ndef getListofSortedCountries(dfRaw, thresholdCases=1):\n    dfSorted = dfRaw.groupby(['ObservationDate','Country\/Region'])['Confirmed'].sum().reset_index()\n    dfSorted = dfSorted.groupby(['Country\/Region'])['Confirmed'].max().reset_index()\n    dfSorted= dfSorted.sort_values('Confirmed',ascending=False, axis=0).reset_index()\n    dfSorted = dfSorted[dfSorted['Confirmed']>=thresholdCases]\n    countries = dfSorted['Country\/Region'].unique()\n    return countries\n\ncountries = getListofSortedCountries(dfConfirmedCases)","30f9ad37":"# pivot john hopkins data, each column will be a country total countrs, country new cases\ndef getPivotedCountryData(dfRaw, columns):\n    dfFullPivot = dfRaw.pivot_table('Confirmed',['ObservationDate'], 'Country\/Region').reset_index()\n    for column in columns:\n        dfFullPivot[column+'NewCases'] = dfFullPivot[column].diff()\n\n    dfFullPivot = dfFullPivot.reindex(sorted(dfFullPivot.columns), axis=1)\n    return dfFullPivot\n\ndfFullPivot = getPivotedCountryData(dfConfirmedCases, countries)\ndfFullPivot.head()","944e044c":"lockdownDate= dfLockdownDates[dfLockdownDates['Country\/Region']=='Italy']['Date'].values[0]\ndfFullPivot[dfFullPivot['ObservationDate']==lockdownDate]['Italy'].values[0]","79a52ffd":"def showCountry(country, countryToShow):\n    if country not in countryToShow:\n        return 'legendonly'\n    else:\n        return True","f820082b":"fig = px.line(title=\"Number of cases - lockdown highlighted with a marker - click legend to add\/remove country\")\ncolors = [\n    '#1f77b4',  # muted blue\n    '#ff7f0e',  # safety orange\n    '#2ca02c',  # cooked asparagus green\n    '#d62728',  # brick red\n    '#9467bd',  # muted purple\n    '#8c564b',  # chestnut brown\n    '#e377c2',  # raspberry yogurt pink\n    '#7f7f7f',  # middle gray\n    '#bcbd22',  # curry yellow-green\n    '#17becf'   # blue-teal\n]\n\ni = 0\nconfirmedCases = 0\nfor country in countries:\n    color = colors[i]\n    i+=1\n    if i == 10:\n        i=0\n\n    if country != 'Others':\n        fig.add_scatter(x=dfFullPivot['ObservationDate'], y=dfFullPivot[country], \n                        mode='lines', \n                        name= country, \n                        legendgroup=country,\n                        visible = showCountry(country,'UK,US,Spain,Italy,Germany,France,Turkey,Iran'),\n                        line_color=color)\n\n        try:\n            lockdownDate = Timestamp(dfLockdownDates[dfLockdownDates['Country\/Region']==country]['Date'].values[0])\n            confirmedCases = dfFullPivot[dfFullPivot['ObservationDate']==lockdownDate][country].values[0]\n            fig.add_scatter(x=[lockdownDate], y=[confirmedCases]\n                            ,mode='markers',  \n                            name=country,\n                            legendgroup=country,\n                            visible = showCountry(country,'UK,US,Spain,Italy,Germany,France,Turkey,Iran'),\n                            line_color=color)\n        except Exception as e:\n#             print(e)\n            confirmedCases = confirmedCases\n    \nfig.update_layout( yaxis_type=\"log\")\n# fig.update_layout( xaxis_type=\"log\")\nfig.update_layout(\n    xaxis_title=\"Date\",\n    yaxis_title=\"Total confirmed Cases\",\n)\nfig.show()","40562a42":"fig = px.line(title=\"New Cases - Lockdown highlighted with a marker - click legend to add\/remove country\")\ncolors = [\n    '#1f77b4',  # muted blue\n    '#ff7f0e',  # safety orange\n    '#2ca02c',  # cooked asparagus green\n    '#d62728',  # brick red\n    '#9467bd',  # muted purple\n    '#8c564b',  # chestnut brown\n    '#e377c2',  # raspberry yogurt pink\n    '#7f7f7f',  # middle gray\n    '#bcbd22',  # curry yellow-green\n    '#17becf'   # blue-teal\n]\n\ni = 0\nfor country in countries:\n    color = colors[i]\n    i+=1\n    if i == 10:\n        i=0\n\n    if country == 'Others':\n        break\n    \n    fig.add_scatter(x=dfFullPivot['ObservationDate'], y=dfFullPivot[country+'NewCases'], \n                    mode='lines', \n                    name= country, \n                    visible = showCountry(country,'UK,US,Spain,Italy,Germany,France,Turkey,Iran'),\n                    legendgroup=country,\n                    line_color=color)\n    \n    try:\n        lockdownDate = Timestamp(dfLockdownDates[dfLockdownDates['Country\/Region']==country]['Date'].values[0])\n        confirmedCases = dfFullPivot[dfFullPivot['ObservationDate']==lockdownDate][country+'NewCases'].values[0]\n        fig.add_scatter(x=[lockdownDate], y=[confirmedCases]\n                        ,mode='markers',  \n                        name=country,\n                        visible = showCountry(country,'UK,US,Spain,Italy,Germany,France,Turkey,Iran'),\n                        legendgroup=country,\n                        line_color=color)\n    except Exception as e:\n#         print('no lock down', country)\n        confirmedCases = confirmedCases\n    \n# fig.update_layout( yaxis_type=\"log\")\n# fig.update_layout( xaxis_type=\"log\")\nfig.update_layout(\n    xaxis_title=\"Date\",\n    yaxis_title=\"Daily New Cases\",\n)\nfig.show()","6ebb77df":"# Import John Hopkins data\nhttps:\/\/www.kaggle.com\/sudalairajkumar\/novel-corona-virus-2019-dataset","f8752efa":"# Covid-19 Lockdown data\n\n### Context\n\nIt is assumed that this data will be useful to help predict or forecast the total numbers of confirmed cases and deaths. A lockdown is started to help retard the spread of the virus. \n\n\n### Content\n\nThe data was acquired by going through each country that had at least 1 confirmed case. Searching for news articles, wikipedia and government websites to identify when the lockdown was started. A lockdown is assumed when schools\/universities and any non-essential businesses are closed. \n\n\n### Inspiration\n\nThere are three main questions this dataset hopes to help try and solve:\n1. provide context to help forecast\/predict number of cases\n2. provide context to help forecast\/predict number of deaths\n3. identify the effectiveness of a lockdown","7a0d7df0":"# Plot of confirmed cases and lockdown with a marker","d1f2ad3e":"# Import Lockdown data"}}