{"cell_type":{"04ec3f58":"code","d6a41361":"code","b4c97d48":"code","ad161ea8":"code","5a617c00":"code","e3896336":"code","75873d1d":"code","6ad9a9d1":"code","9467d508":"code","f8752ce8":"code","2e9e2e08":"code","8d39535f":"code","69940c15":"code","96aa2d88":"code","b71d7441":"code","61e91f53":"code","1a228a49":"code","2797cf08":"code","cc74ce45":"code","c677255a":"code","41fba5a8":"code","d9e41df8":"code","3d5cb85c":"code","d7f1c220":"code","f188fa03":"code","f6eaca17":"code","f9287de6":"code","1c90e7de":"code","c3eed2e4":"code","7ccd8d6a":"code","1c8dacfd":"code","2ce936b5":"code","92cd106f":"code","be214a7d":"code","198a0f56":"code","31f1f982":"code","7f4c4cb9":"code","faf5680e":"code","734bfbe1":"code","1260b745":"markdown","5a76347d":"markdown","25dfc130":"markdown","bef29548":"markdown","3a45423e":"markdown","259027d5":"markdown","42e040e3":"markdown"},"source":{"04ec3f58":"#importing libraries\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport re\nfrom nltk.corpus import stopwords\nfrom nltk.stem.porter import PorterStemmer\nfrom nltk.stem import WordNetLemmatizer\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.model_selection import train_test_split,cross_val_score\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import accuracy_score,classification_report,confusion_matrix,plot_confusion_matrix\nimport matplotlib.pyplot as plt\n\n\n%matplotlib inline","d6a41361":"import nltk\n","b4c97d48":"data =pd.read_csv(\"..\/input\/fake-news\/train.csv\")","ad161ea8":"data.head()","5a617c00":"data.shape","e3896336":"data.isnull().sum()","75873d1d":"data = data.fillna('')","6ad9a9d1":"data.isnull().sum()","9467d508":"data['label'].value_counts()","f8752ce8":"data['content'] = data['author']+' '+data['title']","2e9e2e08":"data.head()","8d39535f":"X = data['content']\ny = data['label']","69940c15":"wordnet = WordNetLemmatizer()","96aa2d88":"def lemmatize(content):\n  words = re.sub('[^a-zA-Z]', ' ',content)\n  words = words.lower()\n  words = words.split()\n  words = [wordnet.lemmatize(word) for word in words if not word in stopwords.words('english')]\n  words = ' '.join(words)\n  return words","b71d7441":"data['content'] = data['content'].apply(lemmatize)","61e91f53":"data['content']","1a228a49":"X = data['content'].values\nY = data['label'].values","2797cf08":"print(X.shape , y.shape)","cc74ce45":"# converting the textual data to numerical data\nvectorizer = TfidfVectorizer()","c677255a":"X = vectorizer.fit_transform(X)","41fba5a8":"print(X)","d9e41df8":"X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size = 0.2, stratify=Y, random_state=2)","3d5cb85c":"print(X.shape, X_train.shape, X_test.shape)","d7f1c220":"model = LogisticRegression()","f188fa03":"model.fit(X_train, Y_train)","f6eaca17":"y_pred = model.predict(X_train)\ntrain_accuracy = accuracy_score(Y_train,y_pred)","f9287de6":"print('train accuracy score : ', train_accuracy)","1c90e7de":"y_pred = model.predict(X_test)\ntest_accuracy = accuracy_score(Y_test,y_pred)","c3eed2e4":"print('test accuracy score : ', test_accuracy)","7ccd8d6a":"confusion_matrix(Y_test,y_pred)","1c8dacfd":"plot_confusion_matrix(model, X_test, Y_test)  \nplt.show()","2ce936b5":"cross_val_score(model, X_test, Y_test, cv=10, scoring = 'accuracy').mean()","92cd106f":"print(classification_report(Y_test,y_pred))","be214a7d":"print(Y_train[0])","198a0f56":"test = X_train[0]\n\nprediction = model.predict(test)\nprint(prediction)\n\nif (prediction[0]==0):\n  print('The news is Real')\nelse:\n  print('The news is Fake')","31f1f982":"def classify_message(text):\n    text = vectorizer.transform(text)\n    predicted = model.predict(text)\n    probability = model.predict_proba(text).max()*100\n\n    if predicted==0:\n        print(\"not Fake news\")\n        print('the probability percentage is:',round(probability))\n    else:\n        print(\"The news is Fake\")\n        print('the probability percentage is:',round(probability))\n\ntest = ['Aaron Klein Obama\u00e2\u20ac\u2122s Organizing for Action Partners with Soros-Linked \u00e2\u20ac\u02dcIndivisible\u00e2\u20ac\u2122 to Disrupt Trump\u00e2\u20ac\u2122s Agenda']\nclassify_message(test)\n","7f4c4cb9":"submission_data = pd.read_csv('\/kaggle\/input\/fake-news\/submit.csv')","faf5680e":"submission_data","734bfbe1":"submission_data.to_csv('submit.csv' ,index=False)","1260b745":"**making predictions using real world text data**","5a76347d":"**libraries**","25dfc130":"**Evaluation**","bef29548":"**classification report**","3a45423e":"**Confusion matrix**","259027d5":"**cross validation scores**","42e040e3":"**making predictions using the test data**"}}