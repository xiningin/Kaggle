{"cell_type":{"1781ad50":"code","34444324":"code","6395b1e6":"code","685dfea5":"code","36aaf27a":"code","2950364e":"code","10a2ad55":"code","6fbd3895":"code","14395a45":"code","c0c6200b":"code","3f902c0d":"code","dae72768":"code","25ccbde4":"code","a26eaba2":"code","41170ae7":"code","a765cc36":"code","fd059dd5":"markdown","c84e9f6c":"markdown","256d4a18":"markdown","3ae44a5c":"markdown","c7dde0db":"markdown","f9fa32cc":"markdown","7ef567e6":"markdown","5e03143d":"markdown","5d458269":"markdown","91d657b7":"markdown","f7b80cfa":"markdown","bd278cba":"markdown"},"source":{"1781ad50":"import warnings\nwarnings.filterwarnings('ignore') # Disabling warnimgs for clearer outputs\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n\nimport category_encoders as ce        ","34444324":"#Load TRAIN data\ntrain =     pd.read_csv(\"\/kaggle\/input\/titanic\/train.csv\")\n#Load TEST data\ntest =      pd.read_csv(\"\/kaggle\/input\/titanic\/test.csv\")\n\ntrain.head()","6395b1e6":"all_data=pd.concat([train, test]).reset_index(drop=True)\nall_data","685dfea5":"def all_die_model(data):\n    \n    data[\"Survived\"][(data[\"PassengerId\"] > 891)] = 0\n    \n    return data\n\ndef make_submission (data,file_name):    \n    \n    data[\"Survived\"] = data[\"Survived\"].astype(int)\n    data.loc[891:, [\"PassengerId\", \"Survived\"]].to_csv('\/kaggle\/working\/'+file_name, index=False)\n    \n    \n    ","36aaf27a":"all_data=all_die_model(all_data)","2950364e":"#make All Die Model submission\nmake_submission(all_data,\"all_die_model.csv\")","10a2ad55":"def gender_model(data):\n    # make gender model\n    data[\"Survived\"][(data[\"PassengerId\"] > 891)] = 0\n    data[\"Survived\"][(data[\"PassengerId\"] > 891) & (data[\"Sex\"] == 'female')] = 1\n    \n    return data","6fbd3895":"all_data=gender_model(all_data)","14395a45":"#make our gender submission\nmake_submission(all_data,\"gender_model.csv\")\n","c0c6200b":"all_data","3f902c0d":"def woman_childs_model(data):\n    \n    #ADD need features\n    data[\"Last_Name\"]=data.Name.str.split(',').str[0]\n    data[\"Boy\"] = ((data.Name.str.contains('Master', case=False) == True) | ((data.Sex=='male') & (data.Age<14))).astype('int')\n    data[\"Sex2\"]=data[\"Sex\"]\n    data[\"Sex2\"][(data[\"Boy\"]==1) | (data[\"Age\"]<14)]=\"children\"\n    \n    #Group_LPE Last_Name_Pclass_Embarked\n    data[\"Group_LPE\"] = data[\"Last_Name\"].astype(str) + \"_\" + data[\"Pclass\"].astype(str)+ \"_\" + data[\"Embarked\"].astype(str)  \n\n \n\n    #ADD to group Group_LPE persons with same tickets number\n    data[\"Group_Big\"]=data[\"Group_LPE\"]\n    for index, row in data[data[\"Group_LPE\"] != \"NO\"].groupby(\"Group_LPE\"):\n        for ticket in row.Ticket:        \n            data[\"Group_Big\"][(data[\"Ticket\"]==ticket) & (data[\"Group_LPE\"]!=index)]= index\n    \n    #ADD to group Group_LPE persons with same CABIN\n    for index, row in data[data[\"Group_Big\"] != \"NO\"].groupby(\"Group_Big\"):\n        for Cabin in row.Cabin:\n            data[\"Group_Big\"][(data[\"Cabin\"]==Cabin) & (data[\"Group_Big\"]!=index) & (Cabin!=\"Unknown\")]= index\n    \n\n    \n    \n    \n    #delete all adults mens from Group_WC\n    data[\"Group_WC\"]=data[\"Group_Big\"]\n    data[\"Group_WC\"][data[\"Sex2\"]=='male']=\"NO\"     \n    \n    \n    \n    data[\"Group_Survived\"] = 0\n    data[\"Group_Survived\"][data['Group_WC'] != \"NO\"] = 10\n\n    for index, row in data.iterrows():\n        # print(index,row)\n        if row['Group_WC'] != \"NO\":\n            # print(index, row['Group_ID'], \" - \", row[\"Group_Count\"], \" - \", row[\"Survived\"])\n\n            if (row[\"Survived\"] == 0) & (row[\"Pclass\"] == 3):\n                data[\"Group_Survived\"][data['Group_WC'] == row['Group_WC']] = 0\n\n            if row[\"Survived\"] == 1:\n                if data[\"Group_Survived\"][data['PassengerId'] == row['PassengerId']].item() > 0:\n                    data[\"Group_Survived\"][data['Group_WC'] == row['Group_WC']] = 1\n\n    data[\"Group_Survived\"][(data['Group_Survived'] == 10) & (data['Pclass'] < 3)] = 1\n    data[\"Group_Survived\"][(data['Group_Survived'] == 10) & (data['Pclass'] == 3)] = 0\n    \n    \n    \n    data['Group_WC_Count'] = data[\"Group_WC\"]\n    count_enc = ce.CountEncoder()\n    count_encoded = count_enc.fit_transform(data[\"Group_WC_Count\"])\n    data['Group_WC_Count'] = count_encoded\n    data[\"Group_WC\"][data['Group_WC_Count'] == 1] = \"NO\" \n\n   \n    # make gender model\n    data[\"Survived\"][(data[\"PassengerId\"] > 891)] = 0 #ALL DIE MODEL\n    data[\"Survived\"][(data[\"PassengerId\"] > 891) & (data[\"Sex\"] == 'female')] = 1 #GENDER MODEL\n    \n    # add woman_childs_model\n    data[\"Survived\"][(data[\"PassengerId\"] > 891) & (data[\"Group_WC\"] != \"NO\") & (data[\"Group_Survived\"] == 0)] = 0\n    data[\"Survived\"][(data[\"PassengerId\"] > 891) & (data[\"Group_Survived\"] == 1)] = 1\n\n\n    return data    \n    ","dae72768":"all_data=pd.concat([train, test]).reset_index(drop=True)\nall_data=woman_childs_model(all_data)\n#make submission\nmake_submission(all_data,\"woman_childs_model.csv\")","25ccbde4":"male_alive=all_data[(all_data[\"PassengerId\"] > 891) & (all_data[\"Sex\"] == 'male') & (all_data[\"Survived\"] == 1)]\n\ndisplay(\"All Males Alive=\",len(male_alive))\ndisplay(male_alive[[\"PassengerId\",\"Pclass\",\"Name\",\"Sex\",\"Age\",\"Cabin\",\"Last_Name\"]])\n\nfemales_perish=all_data[(all_data[\"PassengerId\"] > 891) & (all_data[\"Sex\"] == 'female') & (all_data[\"Survived\"] == 0)]\n\ndisplay(\"Females Perish=\",len(females_perish))\ndisplay(females_perish[[\"PassengerId\",\"Pclass\",\"Name\",\"Sex\",\"Age\",\"Cabin\",\"Last_Name\"]])","a26eaba2":"#All groups we can see here\nall_data.groupby([\"Group_WC\"])[[\"Group_WC_Count\"]].count() ","41170ae7":"#Add New Features\n\nall_data[\"Age_Missed\"]=(all_data[\"Age\"].isnull().astype(int))\nall_data['Cabin'].fillna('Unknown', inplace=True)\nall_data[\"Cabin_Missed\"]=(all_data[\"Cabin\"]==\"Unknown\").astype(int)\nall_data['Name_count']=all_data[\"Name\"].apply(lambda x: len(x.split())).astype(int)\n\n#Make model\n\nall_data[\"Survived\"][(all_data[\"Sex\"] == 'female') & (all_data[\"Pclass\"] == 3) & (all_data[\"Age_Missed\"] ==1)]  = 0\nall_data[\"Survived\"][(all_data[\"Sex\"] == 'female') & (all_data[\"Pclass\"] == 3) & (all_data[\"Name_count\"] ==3)]  = 0\nall_data[\"Survived\"][(all_data[\"Sex\"] == 'male')   & (all_data[\"Pclass\"] == 3) & (all_data[\"Cabin_Missed\"]==0)] = 1","a765cc36":"#make less information submission\nmake_submission(all_data,\"less_information_model.csv\")","fd059dd5":"Merge train and test data to all_data","c84e9f6c":"# 2. Gender Model\n\nWe predict all females alive and all male perish","256d4a18":"And we have Public Score 0.76555 !\nVery good, we predict with 76.5 % accuracy\nBut what next?","3ae44a5c":"**Gender model was a very strong** and if we want to improve result we need to predict who of woman are perish and who of man is survived.\n\nWe predict if adult woman is survived then her son(sons) is survived too.\n\nBoys have a title \"Master\".\n\nWe will combine familyes without adult males in groups.\n\nWe will use Last Name and Ticket number to do this.\n\nIf we don\u2019t know anyone who survived in group, then we use Pclass and predict Pclass<3 is alive and Pclass==3 is perish. \n","c7dde0db":"# Our goal\n\nWe have 891 people in train dataset and 418 people in test dataset.\n\nOur goal to predict who of 418 people in test dataset survived and who perish.\n\nWe merged train \nall_data with PassengerId more then 891 its test data\nall_data with PassengerId less then 891 its train data","f9fa32cc":"We can assume that there is more information about the survivors than the victims.\n\nWe predict:\n    1. Females in 3 Class with Missed Age are rather died than survived\n    2. Females in 3 Class with count in Name==3 are rather died than survived. Because 1 word it Title, and 2 other is Last Name and First Name\n    3. Males in 3 Class with known cabin number are Alive \n","7ef567e6":"# 1. All Die Model\n\nWe predict that all 418 in test dataset people are perish\n\n\n","5e03143d":"# 4. Less information model","5d458269":"All_Die_Model give us 0.62200 on public score, not bad for super-simple model","91d657b7":"We summarize a few simple patterns to achieve a great result!","f7b80cfa":"# 3. Woman - Childs Groups Model","bd278cba":"1. All Die Model 0.62200\n2. Gender Model 0.76555\n3. Woman - Childs Groups Model\n4. Less Information Models"}}