{"cell_type":{"240f9eb7":"code","09ba38b7":"code","19b12470":"code","96dec0ac":"code","26634e68":"code","90229352":"code","ea03723a":"code","f522c24f":"code","d9b1d7ae":"code","9d400198":"code","fbba16af":"code","79632e36":"code","cddd217b":"code","0437326f":"markdown"},"source":{"240f9eb7":"import pandas as pd\n\n#Input movies dataset\nmovies = pd.read_csv(\"..\/input\/movies.dat\", sep=\"::\", names=['MovieID', 'Title', 'Genres'] )\n\n#Read the sample movies dataset\nmovies.head()","09ba38b7":"#Input ratings dataset\nratings = pd.read_csv(\"..\/input\/ratings.dat\", sep=\"::\", names=['UserID', 'MovieID', 'Rating', 'Timestamp'] )\n\n#Read the sample ratings dataset\nratings.head()","19b12470":"#Input users dataset\nusers = pd.read_csv(\"..\/input\/users.dat\", sep=\"::\", names=['UserID', 'Gender', 'Age', 'Occupation', 'Zip-code'] )\n\n#Read the sample users dataset\nusers.head()","96dec0ac":"#Merge the ratings and users with movieID and UserID\nratings_user = pd.merge(ratings,users, on=['UserID'])\nratings_movie = pd.merge(ratings,movies, on=['MovieID'])\n\nmaster_data = pd.merge(ratings_user,ratings_movie,\n                       on=['UserID', 'MovieID', 'Rating'])[['MovieID', 'Title', 'UserID', 'Age', 'Gender', 'Occupation', \"Rating\"]]\n\nmaster_data.head()","26634e68":"#User age distribution\nimport matplotlib.pyplot as plt\n\nusers['Age'].hist(bins=50)\nplt.xlabel('Age')\nplt.ylabel('Population')\nplt.show","90229352":"#User rating of the movie \u201cToy Story\u201d\n\nres = master_data[master_data.Title == \"Toy Story (1995)\"]\n\nplt.plot(res.groupby(\"Age\")[\"MovieID\"].count(),'--bo')\nres.groupby(\"Age\")[\"MovieID\"].count()","ea03723a":"#Top 25 movies by viewership rating\n\nres = master_data.groupby(\"Title\").size().sort_values(ascending=False)[:25]\nplt.ylabel(\"Title\")\nplt.xlabel(\"Viewership Count\")\nres.plot(kind=\"barh\")\n#res\n","f522c24f":"#Find the ratings for all the movies reviewed by for a particular user of user id = 2696\n\nres = master_data[master_data.UserID == 2696]\n\nplt.scatter(y=res.Title, x=res.Rating)\n\nres\n","d9b1d7ae":"#Feature Engineering\n\nval = movies.Genres.str.split(\"|\")\n\nres_col = []\nfor v in val:\n    for i in v:\n        if i not in res_col:\n            res_col.append(i)\n\nres_col.append(\"Gender\")\nres_col.append(\"Age\")\nres_col.append(\"Rating\")\n\ndf = pd.DataFrame(columns=res_col)\n\nres = master_data.merge(movies, on = ['MovieID'], how=\"left\")[[\"Genres\",\"Rating\",\"Gender\", \"Age\"]]\n\nfor index, row in res.head(20000).iterrows():\n    tmp = row.Genres.split(\"|\") \n    \n    for i in tmp:\n       # print(i)\n        df.loc[index,i] = 1\n        df.loc[index,\"Gender\"] = res.loc[index,\"Gender\"]\n        df.loc[index,\"Age\"] = res.loc[index,\"Age\"]\n        df.loc[index,\"Rating\"] = res.loc[index,\"Rating\"]\n         \n#         var = res.loc[index, \"Rating\"]\n#         if var == 1:\n#             df.loc[index,\"Rating\"] = \"one\" \n#         elif var == 2:\n#             df.loc[index,\"Rating\"] = \"two\"\n#         elif var == 3:\n#             df.loc[index,\"Rating\"] = \"three\"\n#         elif var == 4:\n#             df.loc[index,\"Rating\"] = \"four\"\n#         else:\n#             df.loc[index,\"Rating\"] = \"five\"\n     \n    df.loc[index,df.columns[~df.columns.isin(tmp+[\"Gender\",\"Rating\",\"Age\"])]] = 0\n\ndf.head()\n    \n\n#df.loc[i,\"Animation\"] = 1\n\n#df","9d400198":"from sklearn import datasets \nfrom sklearn.metrics import confusion_matrix \nfrom sklearn.model_selection import train_test_split \nfrom sklearn.preprocessing import LabelEncoder\n\nX = df[df.columns[~df.columns.isin([\"Rating\"])]]\ny = df.Rating\n\n# dividing X, y into train and test data \nX_train, X_test, y_train, y_test = train_test_split(X, y, random_state = 0) \n\nnumber = LabelEncoder()\nX_train.Gender = number.fit_transform(X_train[\"Gender\"].astype(\"str\"))\nX_test.Gender = number.fit_transform(X_test[\"Gender\"].astype(\"str\"))\ny_train = number.fit_transform(y_train.astype(\"int\"))\ny_test = number.fit_transform(y_test.astype(\"int\"))\n","fbba16af":"#SVM\n\nfrom sklearn.svm import SVC \nsvm_model_linear = SVC(kernel = 'linear', C = 1).fit(X_train, y_train) \nsvm_predictions = svm_model_linear.predict(X_test) \n  \n# model accuracy for X_test   \naccuracy = svm_model_linear.score(X_test, y_test) \n  \n# creating a confusion matrix \ncm = confusion_matrix(y_test, svm_predictions) \naccuracy\n#cm","79632e36":"#KNN\n\nfrom sklearn.neighbors import KNeighborsClassifier \nknn = KNeighborsClassifier(n_neighbors = 7).fit(X_train, y_train) \n  \n# accuracy on X_test \naccuracy = knn.score(X_test, y_test) \n  \n# creating a confusion matrix \nknn_predictions = knn.predict(X_test)  \ncm = confusion_matrix(y_test, knn_predictions) \n\naccuracy\n","cddd217b":"#Naive Bayes classifier \n\nfrom sklearn.naive_bayes import GaussianNB \ngnb = GaussianNB().fit(X_train, y_train) \ngnb_predictions = gnb.predict(X_test) \n  \n# accuracy on X_test \naccuracy = gnb.score(X_test, y_test)  \n  \n# creating a confusion matrix \ncm = confusion_matrix(y_test, gnb_predictions) \n\naccuracy\n\n","0437326f":"**DESCRIPTION**\n\n*Background of Problem Statement :*\n\n     The GroupLens Research Project is a research group in the Department of Computer Science and Engineering at the University of Minnesota. Members of the GroupLens Research Project are involved in many research projects related to the fields of information filtering, collaborative filtering, and recommender systems. The project is led by professors John Riedl and Joseph Konstan. The project began to explore automated collaborative filtering in 1992 but is most well known for its worldwide trial of an automated collaborative filtering system for Usenet news in 1996. Since then the project has expanded its scope to research overall information by filtering solutions, integrating into content-based methods, as well as, improving current collaborative filtering technology.\n\n*Problem Objective :*\n\n    Here, we ask you to perform the analysis using the Exploratory Data Analysis technique. You need to find features affecting the ratings of any particular movie and build a model to predict the movie ratings.\n\n**Domain: Entertainment**\n\n*Analysis Tasks to be performed:*\n\n    1. Import the three datasets\n    2. Create a new dataset [Master_Data] with the following columns MovieID Title UserID Age Gender Occupation      \n       Rating. (Hint: (i) Merge two tables at a time. (ii) Merge the tables using two primary keys MovieID & UserId)\n    3. Explore the datasets using visual representations (graphs or tables), also include your comments on the following:\n        a. User Age Distribution\n        b. User rating of the movie \u201cToy Story\u201d\n        c. Top 25 movies by viewership rating\n        d. Find the ratings for all the movies reviewed by for a particular user of user id = 2696\n    \n    4. Feature Engineering:\n         \n        Use column genres:\n        a. Find out all the unique genres (Hint: split the data in column genre making a list and then process the \n           data to find out only the unique categories of genres)\n        b. Create a separate column for each genre category with a one-hot encoding ( 1 and 0) whether or not the \n           movie belongs to that genre. \n        c. Determine the features affecting the ratings of any particular movie.\n        d. Develop an appropriate model to predict the movie ratings\n"}}