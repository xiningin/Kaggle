{"cell_type":{"9d3605bf":"code","1dd5dfe9":"code","cba99165":"code","9d5095cc":"code","8aae1d47":"code","bb835b9f":"code","fdccea23":"code","8619fe45":"code","bf1da604":"code","e553f066":"code","c6857c81":"code","483ade5c":"code","687f4a17":"code","ef6a73ed":"code","bf86f29f":"code","c38c4225":"code","0fefa320":"code","8e17ecdb":"code","0da5a78d":"code","3294d954":"code","92cf3405":"code","60d5d7e7":"code","279f77b1":"code","e4b54269":"code","62a85334":"code","aee4a8c6":"code","518a7e34":"code","36061f52":"code","21056c0c":"code","35fbe461":"code","f42a4097":"code","61c1f875":"code","9359a7ab":"code","b96b2494":"code","46f9470c":"code","53685282":"code","1542bac5":"code","646c935f":"code","b4cc562f":"code","05a1cea9":"code","f806c0b9":"code","e3f10c4a":"code","386797e9":"code","50ccde4b":"code","1f427591":"code","0a498a69":"code","c4bc6603":"code","36a518ba":"code","19a20dfd":"code","17b92e26":"code","f518e1ba":"code","8b7bae4d":"code","3ff5bf33":"code","b8b41479":"code","16259832":"code","81fd1e70":"code","874b430f":"code","2ef8bf32":"markdown","f6d0461f":"markdown"},"source":{"9d3605bf":"\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n","1dd5dfe9":"df = pd.read_csv('..\/input\/vehicle-dataset-from-cardekho\/car data.csv')","cba99165":"df.head()","9d5095cc":"df.isna().sum()","8aae1d47":"df['Year'] = 2021 - df['Year']","bb835b9f":"df.head(-5)","fdccea23":"pd.get_dummies(df['Seller_Type'])","8619fe45":"feature_metadata = {'seller_type_metadata':seller_type_metadata,\n                    'fuel_type_metadata' : fuel_type_metadata,\n                   'transmission_metadata' : transmission_metadata}","bf1da604":"metadata_file = open('feature_metadata.pickle','wb')\npickle.dump(feature_metadata,metadata_file)","e553f066":"seller_type_metadata = {'Dealer' : 0, 'Individual' : 1}","c6857c81":"df['Seller_Type'] = df['Seller_Type'].map(seller_type_metadata)","483ade5c":"pd.get_dummies(df['Fuel_Type'])","687f4a17":"fuel_type_metadata = {'Petrol' : 2, 'Diesel' : 1, 'CNG' : 0}","ef6a73ed":"df['Fuel_Type'] = df['Fuel_Type'].map(fuel_type_metadata)","bf86f29f":"df.head()","c38c4225":"pd.get_dummies(df['Transmission'])","0fefa320":"transmission_metadata = {'Automatic' : 1, 'Manual' : 0}","8e17ecdb":"df['Transmission'] = df['Transmission'].map(transmission_metadata)","0da5a78d":"final_df = df.drop('Car_Name',axis=1)","3294d954":"final_df.head()","92cf3405":"import seaborn as sns\nimport matplotlib.pyplot as plt","60d5d7e7":"def plot_distribution(df,feature):\n    plt.figure(figsize=[10,8])\n    plt.title(feature)\n    sns.distplot(df[feature])","279f77b1":"for feature in final_df.columns:\n    plot_distribution(final_df,feature)","e4b54269":"def plot_box(df,feature):\n    plt.figure(figsize=[10,8])\n    plt.title(feature)\n    sns.boxplot(df[feature])","62a85334":"for feature in final_df.columns:\n    plot_box(final_df,feature)","aee4a8c6":"plt.figure(figsize=[30,30])\nsns.pairplot(final_df)","518a7e34":"x = final_df.drop('Selling_Price',axis=1)\ny = final_df['Selling_Price']","36061f52":"from sklearn.model_selection import train_test_split\nx_train, x_test, y_train, y_test = train_test_split(x,y,test_size=0.2,random_state=42)","21056c0c":"from sklearn.decomposition import PCA\npca = PCA(n_components=3)","35fbe461":"x_train_pca_components = pca.fit_transform(x_train)","f42a4097":"x_train_pca_components","61c1f875":"from sklearn.ensemble import RandomForestRegressor\nregressor = RandomForestRegressor()","9359a7ab":"n_estimators = [int(x) for x in np.linspace(start = 100, stop = 2000, num = 20)]","b96b2494":"max_features = ['auto', 'sqrt']\n\nmax_depth = [int(x) for x in np.linspace(5, 50, num = 10)]\n\nmin_samples_split = [2, 5, 10, 15, 25, 50, 75,100]\n\nmin_samples_leaf = [1, 2, 5, 7,10]","46f9470c":"random_grid = {'n_estimators': n_estimators,\n               'max_features': max_features,\n               'max_depth': max_depth,\n               'min_samples_split': min_samples_split,\n               'min_samples_leaf': min_samples_leaf}","53685282":"from sklearn.model_selection import RandomizedSearchCV","1542bac5":"rf_random = RandomizedSearchCV(estimator = regressor, param_distributions = random_grid,scoring='neg_mean_squared_error', n_iter = 20, verbose=1,cv = 5, random_state=42, n_jobs = -1)","646c935f":"rf_random.fit(x_train_pca_components,y_train)","b4cc562f":"rf_random.best_score_","05a1cea9":"rf_random.best_params_","f806c0b9":"x_test_pca_components = pca.transform(x_test)","e3f10c4a":"predictions = rf_random.predict(x_test_pca_components)","386797e9":"plt.figure(figsize=[10,8])\nsns.distplot(y_test-predictions)\nplt.title('Comparision')","50ccde4b":"plt.figure(figsize=[10,8])\nplt.scatter(y_test,predictions)\nplt.title('Comparision')","1f427591":"from sklearn import metrics","0a498a69":"print('MAE:', metrics.mean_absolute_error(y_test, predictions))\nprint('MSE:', metrics.mean_squared_error(y_test, predictions))\nprint('RMSE:', np.sqrt(metrics.mean_squared_error(y_test, predictions)))","c4bc6603":"plt.figure(figsize=[20,20])\nsns.heatmap(final_df.corr(),annot=True,cmap=\"RdYlGn\")","36a518ba":"regressor_random = RandomizedSearchCV(estimator = regressor, param_distributions = random_grid,scoring='neg_mean_squared_error', n_iter = 20, verbose=1,cv = 5, random_state=42, n_jobs = -1)","19a20dfd":"regressor_random.fit(x_train,y_train)","17b92e26":"regressor_random.best_score_","f518e1ba":"regressor_random.best_params_","8b7bae4d":"predictions = regressor_random.predict(x_test)","3ff5bf33":"plt.figure(figsize=[10,8])\nsns.distplot(y_test-predictions)\nplt.title('Comparision')\nplt.savefig('distribution.png')","b8b41479":"plt.figure(figsize=[10,8])\nplt.scatter(y_test,predictions)\nplt.title('Comparision')\nplt.savefig('scatter.png')","16259832":"print('MAE:', metrics.mean_absolute_error(y_test, predictions))\nprint('MSE:', metrics.mean_squared_error(y_test, predictions))\nprint('RMSE:', np.sqrt(metrics.mean_squared_error(y_test, predictions)))","81fd1e70":"import pickle","874b430f":"model_file = open('model.pickle','wb')\npickle.dump(regressor_random,model_file)","2ef8bf32":"### Using PCA Component Analysis","f6d0461f":"### Using Corealtion Matrix"}}