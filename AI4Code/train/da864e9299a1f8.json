{"cell_type":{"aac9819a":"code","4ac18ae5":"code","c9099d0f":"code","394877b7":"code","53b08d4e":"code","bf1fec26":"code","60cc746d":"code","c343eb3d":"code","fa390ed3":"code","6c11bad0":"code","4b8e52cb":"code","f8e9a06e":"code","bfa13830":"code","6152e2dc":"code","302934bd":"code","4b978f58":"code","15963230":"code","57885ea9":"code","fdca8def":"code","206b5d60":"code","853f73c9":"code","bab95005":"code","11ec2815":"code","f68d2e67":"code","a62a56cf":"code","45aee274":"code","88c2242e":"code","c705cd91":"code","5c13a81c":"code","140b9c71":"code","8754610d":"code","c755395a":"code","1d13ff64":"code","1a3b0b34":"code","4363070a":"code","19b96835":"markdown","886c0798":"markdown","0ba74e4b":"markdown","a0c3ffe7":"markdown","5b89f5ef":"markdown","d0b76d9b":"markdown","07ac3817":"markdown","c020ad52":"markdown","19feee2f":"markdown","7e863b96":"markdown","d71f1a00":"markdown"},"source":{"aac9819a":"import pandas as pd\nimport numpy as np\nimport os\nimport matplotlib.pyplot as plt\nimport seaborn as sns \nimport datetime as dt\nimport folium\nfrom folium.plugins import HeatMap, HeatMapWithTime\n%matplotlib inline\nimport warnings\nwarnings.filterwarnings(\"ignore\")","4ac18ae5":"data_df = pd.read_csv(os.path.join(\"\/kaggle\", \"input\", \"household-internet-connection-in-european-union\", \"isoc_ci_it_h.tsv\"), sep='\\t')","c9099d0f":"data_df.shape","394877b7":"data_df.head()","53b08d4e":"data_df.columns","bf1fec26":"data_df.columns = ['composed', '2019', '2018','2017','2016','2015','2014','2013','2012','2011','2010','2009','2008','2007','2006','2005','2004','2003']","60cc746d":"data_df.head()","c343eb3d":"data_df['connection_type'] = data_df['composed'].apply(lambda x: x.split(\",\")[0])\ndata_df['unit'] = data_df['composed'].apply(lambda x: x.split(\",\")[1])\ndata_df['household_type'] = data_df['composed'].apply(lambda x: x.split(\",\")[2])\ndata_df['country'] = data_df['composed'].apply(lambda x: x.split(\",\")[3])","fa390ed3":"data_df.head()","6c11bad0":"data_df.country.unique()","4b8e52cb":"data_df.connection_type.unique()","f8e9a06e":"data_df.unit.unique()","bfa13830":"data_df.household_type.unique()","6152e2dc":"a2_dch_data_df = data_df.loc[(data_df.household_type==\"A2_DCH\") & (data_df.connection_type==\"H_BBFIX\") & (data_df.unit==\"PC_HH\")]","302934bd":"a2_dch_data_df.shape","4b978f58":"a2_dch_data_df.head(44)","15963230":"import re\ndef clean_text(text):\n    text = re.sub(r\"[a-zA-Z: ]\", \"\", text)\n    text = text.replace(\" \",\"\")\n    if text:\n        text = int(text)\n    else:\n        text = None\n    return text","57885ea9":"a2_dch_data_df['2019'] = a2_dch_data_df['2019'].apply(lambda x: clean_text(x))","fdca8def":"def plot_count(feature, value, title, df, size=1):\n    f, ax = plt.subplots(1,1, figsize=(4*size,4))\n    df = df.sort_values([value], ascending=False).reset_index(drop=True)\n    g = sns.barplot(df[feature][0:45], df[value], palette='Set3')\n    g.set_title(\"Number of {}\".format(title))\n    ax.set_xticklabels(ax.get_xticklabels(),rotation=90)\n    plt.show()    ","206b5d60":"plot_count(\"country\", \"2019\", \"Fixed internet connection \/ household with 2 adults and dependent children - 2019\", a2_dch_data_df, size=4)","853f73c9":"def plot_data_per_year(year):\n    a2_dch_data_df[year] = a2_dch_data_df[year].apply(lambda x: clean_text(x))\n    plot_count(\"country\", f\"{year}\", f\"Fixed internet connection \/ household with 2 adults and dependent children - {year}\", a2_dch_data_df, size=4)        ","bab95005":"plot_data_per_year('2018')","11ec2815":"plot_data_per_year('2017')","f68d2e67":"plot_data_per_year('2016')","a62a56cf":"plot_data_per_year('2015')","45aee274":"plot_data_per_year('2014')","88c2242e":"plot_data_per_year('2013')","c705cd91":"plot_data_per_year('2012')","5c13a81c":"plot_data_per_year('2011')","140b9c71":"plot_data_per_year('2010')","8754610d":"def plot_data_per_year_subset(hh_type='A2_DCH', con_type='H_BBFIX', unit='PC_HH', year='2019'):\n\n    subset_df = data_df.loc[(data_df.household_type==\"A2_DCH\") & (data_df.connection_type==\"H_BBFIX\") & (data_df.unit==\"PC_HH\")]\n    subset_df[year] = subset_df[year].apply(lambda x: clean_text(x))\n    plot_count(\"country\", f\"{year}\", f\"internet connection: {con_type} household type: {hh_type} - year: {year}\", subset_df, size=4)           ","c755395a":"plot_data_per_year_subset(year='2019')","1d13ff64":"plot_data_per_year_subset(con_type='H_BBMOB', year='2019')","1a3b0b34":"plot_data_per_year_subset(hh_type=\"A1\", con_type='H_BBMOB', year='2019')","4363070a":"plot_data_per_year_subset(hh_type=\"A1\", con_type='H_BBFIX', year='2019')","19b96835":"We can try to create a more generic function.","886c0798":"Filter for A2_DCH (2 adults and dependent children)","0ba74e4b":"We perform some data cleaning.","a0c3ffe7":"We show here the distribution of fixed internet connection for households with 2 adults and dependent children for few years, per each EU country.","5b89f5ef":"## 3. Data exploration","d0b76d9b":"### 2.1. Load data","07ac3817":"### 3.2. Focus on \n\nWe will select now one type of household, one type of connection and one unit.\n\n**Household typ**e:  **A2_DCH** - Household with 2 parents and 2 children;  \n\n**Connection type**:  **H_BBFIX** - Fixed connection;  \n\n**Unit**: **PC_HH** - Percent per household.","c020ad52":"## 1. Introduction\n\n\n<img src=\"https:\/\/images.unsplash.com\/photo-1554098415-4052459dc340?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1398&q=80\" width=\"400\"><img>   \n\n\n\n\nWe analyze here the dataset with European Union internet connections.\n\nThe dataset contains a composite field and several year values.\n\nThe composite field is:\n\nindic_is,unit,hhtyp,geo\\time\n\nThe meaning of each component in the composed field is:\n\n* indic_is - type of connection;  \n* unit - unit of measure - can be either % per household or % per person;  \n* hhtyp - household type;  \n* geo - geography - can be either country or EU region\/period.\n\nThere are as well several years columns, from 2003 to 2019.\n\n\n*For the unit type, the types are:*\n* PC_HH - Percentage of households;  \n* PC_HH_IACC - Percentage of households with Internet.\n\n*For the type of connection, the possible types are:*\n* H_BBFIX - Household internet connection type: fixed broadband;  \n* H_BBMOB - Household internet connection type: mobile broadband;  \n* H_BBOTH - Household internet connection type: other broadband;  \n* H_BROAD - Household internet connection type: broadband;  \n* H_DIALUP - Household internet connection type: modem or ISDN;  \n* H_DIALUP1 - Household internet connection type: dial-up access via normal telephone line or ISDN;    \n* H_DSL - Household internet connection type: DSL;  \n* H_MPHNAR - Household internet connection type: mobile phone over narrowband;  \n* H_MPHNAR - Household internet connection type: mobile phone over narrowband (as of 2014)   \n\nExtendend list of type of connections can be find on EU data portal, [here](https:\/\/ec.europa.eu\/eurostat\/documents\/341889\/0\/Variables+Years+HH+IND+2003-2019+by+variable\/b3cc8d79-bdd1-93a3-e06a-06bb8376ebc7).\n\n*For the household type, the possible values are:*\n\n* F1_CH\t -\tHousehold composed of lone mother living with at least one child   \n* F1_YCH\t- \tHousehold composed of lone mother with at least one resident child under 25 years  \n* F1_OCH\t -\tHousehold composed of lone mother with at least one resident child 25 years or older  \n* P1_CH\t -\tHousehold composed of lone mother or father living with at least one child  \n* FAM_GE2 -\t \tHousehold composed of two-or-more-family nucleus  \n* NFAM\t -\tHousehold composed of non-family nucleus  \n* P1\t- \tOne-person household  \n* A1\t- \tHousehold composed of one adult  \n* A1_DCH\t- \tHousehold composed of one adult with dependent children  \n* A2\t -\tHousehold composed of two adults  \n* A2_DCH\t- \tHousehold composed of two adults with dependent children  \n* A_GE2_DCH\t -\tHousehold composed of two or more adults with dependent children  \n* A_GE3\t -\tHousehold composed of three or more adults  \n* A_GE3_DCH\t- \tHousehold composed of three or more adults with dependent children  \n* MULTI\t -\tMultiperson household other than family nucleus   \n* DCH\t- \tHouseholds with dependent children  \n* NDCH\t -\tHouseholds without dependent children  \n* A1_GE65\t- \tHousehold composed of one adult 65 years or over  \n* A2_GE1_GE65\t- \tHousehold composed of two adults, at least one aged 65 years or over  \n* OTH\t -\tOther  \n* NRP\t- \tNo response  \n* UNK\t- \tUnknown   \n\nComplete list on EU portal, in the [nomenclator](https:\/\/ec.europa.eu\/eurostat\/ramon\/nomenclatures\/index.cfm?TargetUrl=LST_NOM_DTL&IntCurrentPage=2&StrNom=CL_HHCOMP&IntPcKey=&StrLanguageCode=EN&StrLayoutCode=HIERARCHIC).\n","19feee2f":"### 3.1. Extract new columns from the composite feature","7e863b96":"## 2. Prepare analysis\n\n### 2.1. Load packages","d71f1a00":"Note: the data does not contains recent information (2020). Still, it is relevant, since the status might be the same for 2020.\n\nLet's change the columns names."}}