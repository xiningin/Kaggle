{"cell_type":{"099bf334":"code","7929d4a2":"code","37b8043e":"code","e61294fe":"code","957896a1":"code","341fd6d0":"code","bf6738b8":"code","7020a247":"code","e6cf3034":"code","cf65d060":"code","535f3c90":"code","c8208943":"code","bfd49d02":"code","fb798939":"code","f753dba1":"code","1259e3d8":"code","2ecb43ca":"code","643032f6":"code","dba929f5":"code","b271f6e4":"code","ac3eb0e9":"code","7a38de3d":"code","e2867443":"code","1cc495df":"code","3a2a3111":"code","1125e136":"code","bd01d19c":"code","27fc40e4":"code","618a51dd":"code","2046a597":"code","517ba919":"code","f7b9a47e":"code","7576d2f6":"code","df19ac34":"code","22212d8d":"code","3436beb9":"code","b073e3e8":"code","c205286a":"code","04001659":"code","8a7dbf56":"code","7ffa3ca5":"code","9f068ceb":"code","0940bae6":"code","44af9487":"code","d7b308e3":"code","f98b0c61":"code","8b252b5d":"code","0116b7d0":"code","427a33fc":"code","614bb019":"code","47b33ab8":"code","fe3bbb8e":"code","f127ba2c":"code","ed9d2676":"code","f884a744":"code","f88c18fb":"code","83099530":"code","abe0e9d1":"markdown","cee47572":"markdown","5a49c3ff":"markdown"},"source":{"099bf334":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nplt.style.use('seaborn')\nsns.set(font_scale=2.5)\n\nimport missingno as msno\n\n# ignore warnings\nimport warnings\nwarnings.filterwarnings('ignore')\n\n%matplotlib inline","7929d4a2":"df_train = pd.read_csv('..\/input\/titanic\/train.csv')\ndf_test = pd.read_csv('..\/input\/titanic\/test.csv')","37b8043e":"df_train[\"Age\"].mean()","e61294fe":"df_train[\"Initial\"] = df_train['Name'].str.extract(\"([A-Za-z]+)\\.\")\ndf_test[\"Initial\"] = df_test['Name'].str.extract(\"([A-Za-z]+)\\.\")","957896a1":"pd.crosstab(df_train['Initial'], df_train['Sex']).T.style.background_gradient(cmap='cool')","341fd6d0":"df_train['Initial'].replace(['Mlle', \"Mme\", \"Ms\", \"Dr\", \"Major\", \"Lady\", \"Countess\", \"Jonkheer\", \"Col\", \"Rev\", \"Capt\", \"Sir\", \"Don\", \"Dona\"], \n                           [\"Miss\", \"Miss\", \"Miss\", \"Mr\", \"Mr\", \"Mrs\", \"Mrs\", \"Other\", \"Other\", \"Other\", \"Mr\", \"Mr\", \"Mr\", \"Mr\"], inplace=True)\ndf_test['Initial'].replace(['Mlle', \"Mme\", \"Ms\", \"Dr\", \"Major\", \"Lady\", \"Countess\", \"Jonkheer\", \"Col\", \"Rev\", \"Capt\", \"Sir\", \"Don\", \"Dona\"], \n                           [\"Miss\", \"Miss\", \"Miss\", \"Mr\", \"Mr\", \"Mrs\", \"Mrs\", \"Other\", \"Other\", \"Other\", \"Mr\", \"Mr\", \"Mr\", \"Mr\"], inplace=True)","bf6738b8":"df_train.groupby(\"Initial\").mean()","7020a247":"df_train.groupby(\"Initial\")['Survived'].mean().plot.bar()","e6cf3034":"df_train.loc[(df_train['Age'].isnull()) & (df_train[\"Initial\"]==\"Mr\"), \"Age\"] = 33\ndf_train.loc[(df_train['Age'].isnull()) & (df_train[\"Initial\"]==\"Mrs\"), \"Age\"] = 36\ndf_train.loc[(df_train['Age'].isnull()) & (df_train[\"Initial\"]==\"Master\"), \"Age\"] = 5\ndf_train.loc[(df_train['Age'].isnull()) & (df_train[\"Initial\"]==\"Miss\"), \"Age\"] = 22\ndf_train.loc[(df_train['Age'].isnull()) & (df_train[\"Initial\"]==\"Other\"), \"Age\"] = 46","cf65d060":"df_test.loc[(df_test['Age'].isnull()) & (df_test[\"Initial\"]==\"Mr\"), \"Age\"] = 33\ndf_test.loc[(df_test['Age'].isnull()) & (df_test[\"Initial\"]==\"Mrs\"), \"Age\"] = 36\ndf_test.loc[(df_test['Age'].isnull()) & (df_test[\"Initial\"]==\"Master\"), \"Age\"] = 5\ndf_test.loc[(df_test['Age'].isnull()) & (df_test[\"Initial\"]==\"Miss\"), \"Age\"] = 22\ndf_test.loc[(df_test['Age'].isnull()) & (df_test[\"Initial\"]==\"Other\"), \"Age\"] = 46","535f3c90":"df_train['Embarked'].isnull().sum()","c8208943":"df_train.shape","bfd49d02":"df_train['Embarked'].fillna('S', inplace=True)","fb798939":"df_train['Embarked'].isnull().sum()","f753dba1":"df_train['Age_cat'] = 0\ndf_train.head()","1259e3d8":"df_train.loc[df_train[\"Age\"]<10, 'Age_cat'] = 0\ndf_train.loc[(10 <= df_train['Age']) & (df_train['Age'] < 20), 'Age_cat'] = 1\ndf_train.loc[(20 <= df_train['Age']) & (df_train['Age'] < 30), 'Age_cat'] = 2\ndf_train.loc[(30 <= df_train['Age']) & (df_train['Age'] < 40), 'Age_cat'] = 3\ndf_train.loc[(40 <= df_train['Age']) & (df_train['Age'] < 50), 'Age_cat'] = 4\ndf_train.loc[(50 <= df_train['Age']) & (df_train['Age'] < 60), 'Age_cat'] = 5\ndf_train.loc[(60 <= df_train['Age']) & (df_train['Age'] < 70), 'Age_cat'] = 6\ndf_train.loc[(70 <= df_train['Age']), 'Age_cat'] = 7","2ecb43ca":"df_test.loc[df_test[\"Age\"]<10, 'Age_cat'] = 0\ndf_test.loc[(10 <= df_test['Age']) & (df_test['Age'] < 20), 'Age_cat'] = 1\ndf_test.loc[(20 <= df_test['Age']) & (df_test['Age'] < 30), 'Age_cat'] = 2\ndf_test.loc[(30 <= df_test['Age']) & (df_test['Age'] < 40), 'Age_cat'] = 3\ndf_test.loc[(40 <= df_test['Age']) & (df_test['Age'] < 50), 'Age_cat'] = 4\ndf_test.loc[(50 <= df_test['Age']) & (df_test['Age'] < 60), 'Age_cat'] = 5\ndf_test.loc[(60 <= df_test['Age']) & (df_test['Age'] < 70), 'Age_cat'] = 6\ndf_test.loc[(70 <= df_test['Age']), 'Age_cat'] = 7","643032f6":"df_train.head()","dba929f5":"def category_age(x):\n    if x < 10:\n        return 0\n    elif x < 20:\n        return 1\n    elif x < 30:\n        return 2\n    elif x < 40:\n        return 3\n    elif x < 50:\n        return 4\n    elif x < 60:\n        return 5\n    elif x < 70:\n        return 6\n    else:\n        return 7","b271f6e4":"df_train['Age_cat_2'] = df_train['Age'].apply(category_age)","ac3eb0e9":"(df_train['Age_cat'] == df_train['Age_cat_2']).all()","7a38de3d":"df_train.drop(['Age', 'Age_cat_2'], axis=1, inplace=True)\ndf_test.drop(['Age'], axis=1, inplace=True)","e2867443":"df_train.Initial.unique()","1cc495df":"df_train[\"Initial\"] = df_train['Initial'].map({\"Master\": 0, \"Miss\": 1, \"Mr\": 2, \"Mrs\": 3, \"Other\": 4})\ndf_test[\"Initial\"] = df_test['Initial'].map({\"Master\": 0, \"Miss\": 1, \"Mr\": 2, \"Mrs\": 3, \"Other\": 4})","3a2a3111":"df_train.Embarked.unique()","1125e136":"df_train[\"Embarked\"] = df_train[\"Embarked\"].map({\"C\": 0, \"Q\": 1, \"S\": 2})\ndf_test[\"Embarked\"] = df_test[\"Embarked\"].map({\"C\": 0, \"Q\": 1, \"S\": 2})","bd01d19c":"df_train.head()","27fc40e4":"df_train.Embarked.isnull().any()","618a51dd":"df_train[\"Sex\"].unique()","2046a597":"df_train[\"Sex\"] = df_train[\"Sex\"].map({'female': 0, 'male': 1})\ndf_test[\"Sex\"] = df_test[\"Sex\"].map({'female': 0, 'male': 1})","517ba919":"df_train[\"FamilySize\"] = df_train['SibSp'] + df_train['Parch'] + 1\ndf_test[\"FamilySize\"] = df_test['SibSp'] + df_test['Parch'] + 1","f7b9a47e":"heatmap_data = df_train[['Survived', 'Pclass', 'Sex', 'Fare', 'Embarked', 'FamilySize', 'Initial', 'Age_cat']]","7576d2f6":"colormap = plt.cm.Blues\nplt.figure(figsize=(12,10))\nplt.title(\"Pearson Correlation of Features\", y=1.05, size=15)\nsns.heatmap(heatmap_data.astype(float).corr(), linewidths=0.1, vmax=1.0, square=True, cmap=colormap, linecolor='white', annot=True, annot_kws={'size': 16}, fmt=\".2f\")","df19ac34":"df_train = pd.get_dummies(df_train, columns=['Initial'], prefix=\"Initial\")\ndf_test = pd.get_dummies(df_test, columns=['Initial'], prefix=\"Initial\")","22212d8d":"df_train.head()","3436beb9":"df_test.head()","b073e3e8":"df_train = pd.get_dummies(df_train, columns=[\"Embarked\"], prefix=\"Embarked\")\ndf_test = pd.get_dummies(df_test, columns=[\"Embarked\"], prefix=\"Embarked\")","c205286a":"df_train.head()","04001659":"df_test.head()","8a7dbf56":"df_train.drop(['PassengerId', 'Name', \"SibSp\", 'Parch', 'Ticket', 'Cabin'], axis=1, inplace=True)\ndf_test.drop(['PassengerId', 'Name', \"SibSp\", 'Parch', 'Ticket', 'Cabin'], axis=1, inplace=True)","7ffa3ca5":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn import metrics\nfrom sklearn.model_selection import train_test_split","9f068ceb":"df_test.isnull().sum()","0940bae6":"df_test.fillna(0.0,inplace=True)","44af9487":"df_test.isnull().sum()","d7b308e3":"x_train = df_train.drop(\"Survived\", axis=1).values\ntarget_label = df_train['Survived'].values\nx_test = df_test.values","f98b0c61":"x_tr, x_vld, y_tr, y_vld = train_test_split(x_train, target_label, test_size=0.3, random_state=2020)","8b252b5d":"model = RandomForestClassifier()\nmodel.fit(x_tr, y_tr)","0116b7d0":"prediction = model.predict(x_vld)\nprint(\"Accuracy {:.2f}%\".format(100*metrics.accuracy_score(prediction,y_vld)))","427a33fc":"model.feature_importances_","614bb019":"from pandas import Series\nfeature_importance = model.feature_importances_\nSeries_feat_imp = Series(feature_importance, index=df_test.columns)","47b33ab8":"Series_feat_imp","fe3bbb8e":"plt.figure(figsize=(8, 8))\nSeries_feat_imp.sort_values(ascending=True).plot.barh()\nplt.xlabel('Feature importance')\nplt.ylabel('Feature')\nplt.show()","f127ba2c":"submission = pd.read_csv('..\/input\/titanic\/gender_submission.csv')","ed9d2676":"submission.head()","f884a744":"prediction = model.predict(x_test)","f88c18fb":"submission['Survived'] = prediction","83099530":"submission.to_csv('.\/submission.csv', index=False)","abe0e9d1":"## Filling Age","cee47572":"## Age categorization","5a49c3ff":"## Filling embarked"}}