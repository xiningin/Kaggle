{"cell_type":{"20409c97":"code","817c81c8":"code","fe8b73a1":"code","62243864":"code","22c5d896":"code","b7426761":"code","00257377":"code","60e8e3eb":"code","6bab787c":"code","7f0bb882":"code","7a54ad54":"code","b1911fd7":"code","36ebd74c":"code","361916c6":"code","6e146526":"code","8558e755":"code","cfa46949":"code","686aca45":"code","67d9bc6f":"code","5200c947":"code","65add7d9":"code","ab4b08e9":"code","75de29f1":"code","6fb16bea":"code","4fb9089b":"code","860cc60b":"code","5e5960f6":"code","f25b5618":"code","5b3bf5e2":"code","38d87c42":"code","158d002e":"code","7ef82d3c":"code","6cf5e1bf":"code","759e2e68":"markdown","66670106":"markdown","b06e846d":"markdown","67c523c7":"markdown","dcf1a375":"markdown","244506cd":"markdown","f077ce82":"markdown","b82c9b3b":"markdown","9f5a4088":"markdown","f080086d":"markdown","4b35eb63":"markdown","fe86007e":"markdown","f46d1ad7":"markdown","603d8dd6":"markdown","300c05a1":"markdown"},"source":{"20409c97":"import pandas as pd\nimport numpy as np\nfrom sklearn.feature_extraction.text import TfidfVectorizer","817c81c8":"df=pd.read_csv('..\/input\/apple-iphone-se-reviews-ratings\/APPLE_iPhone_SE.csv')\ndf.head(10)","fe8b73a1":"df.shape","62243864":"df.info()","22c5d896":"df.isnull().sum()","b7426761":"df.Reviews[0]","00257377":"df.Comment[4]","60e8e3eb":"df.Ratings.value_counts()","6bab787c":"df.Comment.unique()","7f0bb882":"X=df.Comment\ny=df.Ratings","7a54ad54":"X.head()","b1911fd7":"y.head()","36ebd74c":"# TF-IDF","361916c6":"tfidf= TfidfVectorizer()\nX_tfidf = tfidf.fit_transform(X)","6e146526":"df.head()","8558e755":"tfidf.get_feature_names()","cfa46949":"y.head()","686aca45":"X_tfidf.toarray()[:5]","67d9bc6f":"# Train test split","5200c947":"from sklearn.model_selection import train_test_split\n\nX_train,X_test,y_train,y_test= train_test_split(X_tfidf,y,test_size=0.2,random_state=47)","65add7d9":"from imblearn.over_sampling import SMOTE\nsmote = SMOTE()","ab4b08e9":"X_train_smote, y_train_smote = smote.fit_resample(X_train, y_train)","75de29f1":"y_train.value_counts()","6fb16bea":"y_train_smote.value_counts()","4fb9089b":"# for evaluating the metrics\nfrom sklearn.metrics import accuracy_score,classification_report,confusion_matrix\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.naive_bayes import MultinomialNB","860cc60b":"from sklearn.neighbors import KNeighborsClassifier\nmodel1=KNeighborsClassifier()\nmodel1.fit(X_train_smote,y_train_smote)\ny_predict1=model1.predict(X_test)\naccuracy_score(y_test,y_predict1)","5e5960f6":"pd.crosstab(y_test,y_predict1)","f25b5618":"print(classification_report(y_test,y_predict1))","5b3bf5e2":"KNN_prediction= pd.DataFrame({'Actual_Rating' : y_test, 'Predicted_Rating' : y_predict1})\nKNN_prediction.head(10)","38d87c42":"model2=MultinomialNB()\nmodel2.fit(X_train_smote,y_train_smote)\ny_predict2=model2.predict(X_test)\naccuracy_score(y_test,y_predict2)","158d002e":"pd.crosstab(y_test,y_predict2)","7ef82d3c":"print(classification_report(y_test,y_predict2))","6cf5e1bf":"NB_prediction= pd.DataFrame({'Actual_Rating' : y_test, 'Predicted_Rating' : y_predict2})\nNB_prediction.head(10)","759e2e68":"- ### *We can see that Ratings are Imbalanced*","66670106":"### Using SMOTE as target,Rating is imbalanced ","b06e846d":"### Checking 5th Comment","67c523c7":"## KNN","dcf1a375":"### Importing Supporting Libraries","244506cd":"### Checking first Review","f077ce82":"## Considering Comment for the prediction of rating.","b82c9b3b":"- ### *By checking the classification report and confusion matrix, KNN showing better classification.*","9f5a4088":"### Loading Data","f080086d":"### Checking File-Size","4b35eb63":"## Multinomial Naive Bayes","fe86007e":"### Checking Ratings","f46d1ad7":"### File Info","603d8dd6":"### Checking Comments","300c05a1":"### Checking Null values"}}