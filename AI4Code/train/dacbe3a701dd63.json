{"cell_type":{"ee29df71":"code","b13954e0":"code","070d957e":"code","ace70dec":"code","857a55d8":"code","55fd9b5b":"code","55f1d247":"code","208d3f66":"code","5b06433c":"code","b15f1dbf":"code","b36c483b":"code","1f8836be":"code","0ee8f615":"code","b4d3b4fa":"code","92f2ad74":"code","e65d8d6e":"code","a101f1c9":"code","dea2b8b4":"code","cee0f1a5":"code","aefa84ca":"code","77ce6066":"code","0813cf6b":"code","18fcfc1f":"code","ec9411b8":"code","094b91a8":"code","c9647de9":"markdown","5d02ff6f":"markdown","6225d606":"markdown","0a11dd24":"markdown","4e4d36fc":"markdown","90aa59a3":"markdown","e347cd98":"markdown","7805d679":"markdown","b4ce7475":"markdown","f62d196e":"markdown","7faca42b":"markdown","4af99559":"markdown","85a70b82":"markdown","f44322a2":"markdown","ae0a0fc6":"markdown","30c43aed":"markdown","0eb65cd0":"markdown","7e429e08":"markdown","19e98743":"markdown","4e054ef3":"markdown","4797c361":"markdown","46671d23":"markdown","8829f1bb":"markdown","6d2501c3":"markdown","dc3e0856":"markdown","4e4e6c06":"markdown","8dc4a8be":"markdown","6d0ea394":"markdown","f670aec8":"markdown"},"source":{"ee29df71":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport matplotlib.gridspec as gridspec\nimport matplotlib.font_manager as fm\nimport math\nfont = fm.FontProperties(fname='..\/input\/acmeregular\/Acme-Regular.ttf')\n\ntrain = pd.read_csv(\"..\/input\/titanic\/train.csv\")\ntest = pd.read_csv(\"..\/input\/titanic\/test.csv\")\nsubmission = pd.read_csv(\"..\/input\/titanic\/gender_submission.csv\")\n\ntrain.head(3)","b13954e0":"train = train.drop('PassengerId',axis=1)\ntest = test.drop('PassengerId',axis=1)\ntrain.head(3)","070d957e":"total = dict(train['Pclass'].value_counts())\nsurvived = dict(train.groupby('Pclass')['Survived'].sum())\n\nexplode = (0, 0.15)\n\nfig, ax = plt.subplots(figsize=(25,10),facecolor=\"#363336\")\nax.patch.set_facecolor('#363336')\n\nspec = gridspec.GridSpec(ncols=12, nrows=8, figure=fig)\nax1 = fig.add_subplot(spec[:5, :4],facecolor=\"#363336\")\nax2 = fig.add_subplot(spec[:5, 4:8],facecolor=\"#363336\")\nax3 = fig.add_subplot(spec[:5, 8:],facecolor=\"#363336\")\nax4 = fig.add_subplot(spec[7:, :],facecolor=\"#363336\")\n\n\nax1.pie([survived[1],total[1]-survived[1]], explode=explode, shadow=True, startangle=90, colors =['#F2F2F2','#706B70'])\nax2.pie([survived[2],total[2]-survived[2]], explode=explode, shadow=True, startangle=90, colors =['#F2F2F2','#706B70'])\nax3.pie([survived[3],total[3]-survived[3]], explode=explode, shadow=True, startangle=90, colors =['#F2F2F2','#706B70'])\n\nax1.text(s=\"Survived\",x=-0.48,y=0.2, font=font,fontsize=35,va='center',ha='center',color='#706B70')\nax1.text(s=f\"{round(survived[1]\/total[1] * 100,1)}%\",x=-0.42,y=-0.2, font=font,fontsize=55,va='center',ha='center',color='#706B70')\nax1.text(s=\"1st Class\",x=0,y=-1.3, font=font,fontsize=40,va='center',ha='center',color='#F2F2F2')\n\n\nax2.text(s=\"Survived\",x=-0.48,y=0.2, font=font,fontsize=30,va='center',ha='center',color='#706B70')\nax2.text(s=f\"{round(survived[2]\/total[2] * 100,1)}%\",x=-0.46,y=-0.1, font=font,fontsize=45,va='center',ha='center',color='#706B70')\nax2.text(s=\"2nd Class\",x=0,y=-1.3, font=font,fontsize=40,va='center',ha='center',color='#F2F2F2')\n\nax3.text(s=\"Survived\",x=-0.48,y=0.5, font=font,fontsize=20,va='center',ha='center',color='#706B70')\nax3.text(s=f\"{round(survived[3]\/total[3] * 100,1)}%\",x=-0.46,y=0.3, font=font,fontsize=35,va='center',ha='center',color='#706B70')\nax3.text(s=\"3rd Class\",x=0.1,y=-1.3, font=font,fontsize=40,va='center',ha='center',color='#F2F2F2')\n\nax4.barh(y=0, width=sum(total.values()), color = '#F2F2F2', alpha=0.4)\nax4.barh(y=0, width=total[1], color = '#F2F2F2', alpha=0.8)\nax4.barh(y=0, width=total[1] + total[2], color = '#F2F2F2', alpha=0.7)\n\nax4.text(s=f\"3rd Class : {round(total[3]\/sum(total.values()) * 100,2)}%\", x = 550, y = 0, font =font, fontsize=30,va='center')\nax4.text(s=f\"2nd Class : {round(total[2]\/sum(total.values()) * 100,2)}%\", x = 230, y = 0, font =font, fontsize=30,va='center')\nax4.text(s=f\"1st Class : {round(total[1]\/sum(total.values()) * 100,2)}%\", x = 40, y = 0, font =font, fontsize=30,va='center')\n\nax4.text(s=\"The proportion of Class\", x = 0, y =1, font=font, fontsize=30, color ='white',va='top')\n\n\nax.axis(\"off\")\nax4.axis(\"off\")\nax4.set_xlim(0,sum(total.values()))\nax.text(s=\"The influence of class\", x= 0,y=1.05, font=font,color='#F5E9F5',fontsize=50)\nplt.show()","ace70dec":"def change_name(name):\n    if \"Mr.\" in name: return \"Mr\"\n    elif \"Mrs.\" in name: return \"Mrs\"\n    elif \"Miss.\" in name: return \"Miss\"\n    elif \"Master.\" in name: return \"Master\"\n    elif \"Ms.\": return \"Ms\"\n    else: return \"No\"\ntrain['Name'] = train['Name'].apply(change_name)\ntest['Name'] = test['Name'].apply(change_name)","857a55d8":"name = train.groupby('Name')['Survived'].mean()\nname = sorted([*name.items()], key = lambda x : x[1], reverse=True)\n\nsex = train.groupby('Sex')['Survived'].mean()\nsex = sorted([*sex.items()], key = lambda x : x[1], reverse=True)\n\ntotal = dict(train['Pclass'].value_counts())\nsurvived = dict(train.groupby('Pclass')['Survived'].sum())\n\nfig, ax = plt.subplots(figsize=(25,10),facecolor=\"#363336\")\nax.patch.set_facecolor('#363336')\n\nspec = gridspec.GridSpec(ncols=10, nrows=1, figure=fig)\nax1 = fig.add_subplot(spec[:, :7],facecolor=\"#363336\")\nax2 = fig.add_subplot(spec[:, 7:],facecolor=\"#363336\")\n\nax1.bar(x = [*map(lambda x : x[0], name)], height = [*map(lambda x : x[1], name)], width=0.6,color = \"#F2F2F2\",alpha=0.7)\nfor i,v in enumerate([*map(lambda x : x[0], name)]):\n    ax1.text(s=v, x=i, y=0, va='top',ha='center', font=font, color ='#F2F2F2',fontsize=30)\nfor i,v in enumerate([*map(lambda x : x[1], name)]):\n    ax1.text(s=f\"{round(v*100,1)}%\", x=i, y=v, va='bottom',ha='center', font=font, color ='#F2F2F2',fontsize=30)\n\nax1.axis(\"off\")\nax2.axis(\"off\")\n\nx_pos = [0,0.5]\nax2.bar(x = x_pos, height = [*map(lambda x : x[1], sex)], width=0.4,color = [\"#F05B5B\",'#5B79F0'],alpha=0.7)\ncolor = [\"#F05B5B\",'#5B79F0']\n\nfor i,v in enumerate([*map(lambda x : x[0], sex)]):\n    ax2.text(s=v, x=x_pos[i], y=0, va='top',ha='center', font=font, color =color[i],fontsize=30)\nfor i,v in enumerate([*map(lambda x : x[1], sex)]):\n    ax2.text(s=f\"{round(v*100,1)}%\", x=x_pos[i], y=v, va='bottom',ha='center', font=font, color =color[i],fontsize=30)\n\nax.text(s=\"The influence of Name\/Sex \", x= 0,y=1.05, font=font,color='#F5E9F5',fontsize=50)\nax.axis('off')\n\nplt.show()","55fd9b5b":"age_total = dict(train['Age'].value_counts())\nage_total = sorted(age_total.items(), key=lambda x : x[0])\ntmp = [*map(lambda x: x[0]\/\/3 *3,age_total)]\n\nage_tmp = {}\nfor a,b in zip(tmp, [*map(lambda x : x[1], age_total)]):\n    if a in age_tmp.keys():\n        age_tmp[a] +=b\n    else:\n        age_tmp[a]=b\n\nage_survived = dict(train[train['Survived']==1]['Age'].value_counts())\nage_survived = sorted(age_survived.items(), key=lambda x : x[0])\ntmp = [*map(lambda x: x[0]\/\/3 *3,age_survived)]\n\nage_tmp_s = {}\nfor a,b in zip(tmp, [*map(lambda x : x[1], age_survived)]):\n    if a in age_tmp_s.keys():\n        age_tmp_s[a] +=b\n    else:\n        age_tmp_s[a]=b\n    \nfig, ax = plt.subplots(figsize=(25,10),facecolor=\"#363336\")\nax.patch.set_facecolor('#363336')\n\nspec = gridspec.GridSpec(ncols=10, nrows=1, figure=fig)\nax1 = fig.add_subplot(spec[:, :],facecolor=\"#363336\")\n\nax1.plot([*map(lambda x : x[0], age_tmp.items())],[*map(lambda x : x[1], age_tmp.items())])\nax1.fill_between([*map(lambda x : x[0], age_tmp.items())], 0, [*map(lambda x : x[1], age_tmp.items())], color='#85C0EA',alpha=0.3)\nax1.plot([*map(lambda x : x[0], age_tmp_s.items())],[*map(lambda x : x[1], age_tmp_s.items())])\nax1.fill_between([*map(lambda x : x[0], age_tmp_s.items())], 0, [*map(lambda x : x[1], age_tmp_s.items())], color='#EA8881',alpha=0.3)\nax1.set_xlim(0,)\nax1.set_ylim(0,)\nax1.text(s=\"Total\", x=80,y=70,font=font,fontsize=30, color='#85C0EA',va='center',ha='right')\nax1.text(s=\"Survived\", x=80,y=65,font=font,fontsize=30, color='#EA8881',va='center',ha='right')\nax1.spines['right'].set_visible(False)\nax1.spines['top'].set_visible(False)\nax1.spines['left'].set_visible(False)\nax.axis(\"off\")\nax1.set_xticks([])\nax1.set_yticks([])\nfor i in range(0, 81,10):\n    ax1.text(s=i, x=i, y=0, font=font, fontsize=25, color = \"#F2F2F2\",va='top',ha='center',alpha=0.8)\nfor i in range(10, 80,10):\n    ax1.text(s=i, x=0, y=i, font=font, fontsize=25, color = \"#F2F2F2\",va='center',ha='right',alpha=0.8)\n\nax1.text(s=\"The influence of Age\", x=1, y=75, font=font, fontsize=50, color = \"#F2F2F2\", va='center', ha='left')\n\nplt.show()","55f1d247":"print(\"train 'Age' colunms's NaN : \",train['Age'].isnull().sum())\nprint(\"test 'Age' colunms's NaN : \",test['Age'].isnull().sum())\n\ntrain[train['Age'].isnull()]['Name'].value_counts()","208d3f66":"median_value = dict(train.groupby('Name')['Age'].median())\ntrain['Age'] = train.apply(lambda x : int(median_value[x.Name]) if math.isnan(x.Age) else int(x.Age) ,axis=1)\ntest['Age'] = test.apply(lambda x : int(median_value[x.Name]) if math.isnan(x.Age) else int(x.Age) ,axis=1)","5b06433c":"sib_total = dict(train['SibSp'].value_counts())\nsib_total = sorted(sib_total.items(), key = lambda x : x[0])\n\nsib_sur = dict(train[train['Survived'] == 1]['SibSp'].value_counts())\nsib_sur = sorted(sib_sur.items(), key = lambda x : x[0])\n\npar_total = dict(train['Parch'].value_counts())\npar_total = sorted(par_total.items(), key = lambda x : x[0])\n\npar_sur = dict(train[train['Survived'] == 1]['Parch'].value_counts())\npar_sur = sorted(par_sur.items(), key = lambda x : x[0])\n\nfig, ax = plt.subplots(figsize=(25,10),facecolor=\"#363336\")\nax.patch.set_facecolor('#363336')\n\nspec = gridspec.GridSpec(ncols=10, nrows=1, figure=fig)\nax1 = fig.add_subplot(spec[:, :5],facecolor=\"#363336\")\nax2 = fig.add_subplot(spec[:, 5:],facecolor=\"#363336\")\n\n\nax1.plot([*map(lambda x : x[0],sib_total)],[*map(lambda x : x[1],sib_total)])\nax1.fill_between([*map(lambda x : x[0],sib_total)], 0, [*map(lambda x : x[1],sib_total)], color='#85C0EA',alpha=0.3)\n\nax1.plot([*map(lambda x : x[0],sib_sur)],[*map(lambda x : x[1],sib_sur)])\nax1.fill_between([*map(lambda x : x[0],sib_sur)], 0, [*map(lambda x : x[1],sib_sur)], color='#EA8881',alpha=0.3)\n\nax1.set_xlim(0,)\nax1.set_ylim(0,)\nax1.text(s=\"Total\", x=8,y=500,font=font,fontsize=30, color='#85C0EA',va='center',ha='right')\nax1.text(s=\"Survived\", x=8,y=470,font=font,fontsize=30, color='#EA8881',va='center',ha='right')\nax1.spines['right'].set_visible(False)\nax1.spines['top'].set_visible(False)\nax1.spines['left'].set_visible(False)\nax.axis(\"off\")\nax1.set_xticks([])\nax1.set_yticks([])\nfor i in range(0, 9):\n    ax1.text(s=i, x=i, y=0, font=font, fontsize=25, color = \"#F2F2F2\",va='top',ha='center',alpha=0.8)\nfor i in range(100,600,100):\n    ax1.text(s=i, x=0, y=i, font=font, fontsize=25, color = \"#F2F2F2\",va='center',ha='right',alpha=0.8)\n\nax1.text(s=\"The influence of SibSp\", x=1, y=600, font=font, fontsize=50, color = \"#F2F2F2\", va='center', ha='left')\n\nax2.plot([*map(lambda x : x[0],par_total)],[*map(lambda x : x[1],par_total)])\nax2.fill_between([*map(lambda x : x[0],par_total)], 0, [*map(lambda x : x[1],par_total)], color='#85C0EA',alpha=0.3)\n\nax2.plot([*map(lambda x : x[0],par_sur)],[*map(lambda x : x[1],par_sur)])\nax2.fill_between([*map(lambda x : x[0],par_sur)], 0, [*map(lambda x : x[1],par_sur)], color='#EA8881',alpha=0.3)\n\nax2.set_xlim(0,)\nax2.set_ylim(0,)\nax2.text(s=\"Total\", x=6,y=560,font=font,fontsize=30, color='#85C0EA',va='center',ha='right')\nax2.text(s=\"Survived\", x=6,y=520,font=font,fontsize=30, color='#EA8881',va='center',ha='right')\nax2.spines['right'].set_visible(False)\nax2.spines['top'].set_visible(False)\nax2.spines['left'].set_visible(False)\nax2.set_xticks([])\nax2.set_yticks([])\nfor i in range(0, 6):\n    ax2.text(s=i, x=i, y=0, font=font, fontsize=25, color = \"#F2F2F2\",va='top',ha='center',alpha=0.8)\nfor i in range(100,700,100):\n    ax2.text(s=i, x=0, y=i, font=font, fontsize=25, color = \"#F2F2F2\",va='center',ha='right',alpha=0.8)\n\nax2.text(s=\"The influence of Parch\", x=1, y=660, font=font, fontsize=50, color = \"#F2F2F2\", va='center', ha='left')\n\nplt.show()","b15f1dbf":"train = train.drop('Ticket',axis=1)\ntest = test.drop('Ticket',axis=1)","b36c483b":"train['Fare'] = train['Fare'].apply(lambda x : 100 if x >= 100 else x)\ntest['Fare'] = test['Fare'].apply(lambda x : 100 if x >= 100 else x)","1f8836be":"fare_total = dict(train['Fare'].value_counts())\nfare_total = sorted(fare_total.items(), key=lambda x : x[0])\ntmp = [*map(lambda x: x[0]\/\/5 *5,fare_total)]\n\nfare_tmp = {}\nfor a,b in zip(tmp, [*map(lambda x : x[1], fare_total)]):\n    if a in fare_tmp.keys():\n        fare_tmp[a] +=b\n    else:\n        fare_tmp[a]=b\n\nfare_survived = dict(train[train['Survived']==1]['Fare'].value_counts())\nfare_survived = sorted(fare_survived.items(), key=lambda x : x[0])\ntmp = [*map(lambda x: x[0]\/\/5 *5,fare_survived)]\n\nfare_tmp_s = {}\nfor a,b in zip(tmp, [*map(lambda x : x[1], fare_survived)]):\n    if a in fare_tmp_s.keys():\n        fare_tmp_s[a] +=b\n    else:\n        fare_tmp_s[a]=b\n    \nfig, ax = plt.subplots(figsize=(25,10),facecolor=\"#363336\")\nax.patch.set_facecolor('#363336')\n\nspec = gridspec.GridSpec(ncols=10, nrows=1, figure=fig)\nax1 = fig.add_subplot(spec[:, :],facecolor=\"#363336\")\n\nax1.plot([*map(lambda x : x[0], fare_tmp.items())],[*map(lambda x : x[1], fare_tmp.items())])\nax1.fill_between([*map(lambda x : x[0], fare_tmp.items())], 0, [*map(lambda x : x[1], fare_tmp.items())], color='#85C0EA',alpha=0.3)\nax1.plot([*map(lambda x : x[0], fare_tmp_s.items())],[*map(lambda x : x[1], fare_tmp_s.items())])\nax1.fill_between([*map(lambda x : x[0], fare_tmp_s.items())], 0, [*map(lambda x : x[1], fare_tmp_s.items())], color='#EA8881',alpha=0.3)\nax1.set_xlim(0,)\nax1.set_ylim(0,)\nax1.text(s=\"Total\", x=100,y=280,font=font,fontsize=30, color='#85C0EA',va='center',ha='right')\nax1.text(s=\"Survived\", x=100,y=255,font=font,fontsize=30, color='#EA8881',va='center',ha='right')\nax1.spines['right'].set_visible(False)\nax1.spines['top'].set_visible(False)\nax1.spines['left'].set_visible(False)\nax.axis(\"off\")\nax1.set_xticks([])\nax1.set_yticks([])\nfor i in range(0, 101,10):\n    ax1.text(s=i, x=i, y=0, font=font, fontsize=25, color = \"#F2F2F2\",va='top',ha='center',alpha=0.8)\nfor i in range(50, 350,50):\n    ax1.text(s=i, x=0, y=i, font=font, fontsize=25, color = \"#F2F2F2\",va='center',ha='right',alpha=0.8)\n\nax1.text(s=\"The influence of Fare\", x=6, y=320, font=font, fontsize=50, color = \"#F2F2F2\", va='center', ha='left')\n\nplt.show()","0ee8f615":"print(\"Cabin's NaN value : \",train['Cabin'].isnull().sum())\nprint(\"Cabin's NaN percent : \",round(train['Cabin'].isnull().sum()\/len(train['Cabin'])*100,2), \"%\")\n\ntrain = train.drop(\"Cabin\", axis=1)\ntest = test.drop(\"Cabin\", axis=1)","b4d3b4fa":"total = dict(train['Embarked'].value_counts())\nsurvived = dict(train.groupby('Embarked')['Survived'].sum())\n\nexplode = (0, 0.15)\n\nfig, ax = plt.subplots(figsize=(25,10),facecolor=\"#363336\")\nax.patch.set_facecolor('#363336')\n\nspec = gridspec.GridSpec(ncols=12, nrows=8, figure=fig)\nax1 = fig.add_subplot(spec[:5, :4],facecolor=\"#363336\")\nax2 = fig.add_subplot(spec[:5, 4:8],facecolor=\"#363336\")\nax3 = fig.add_subplot(spec[:5, 8:],facecolor=\"#363336\")\nax4 = fig.add_subplot(spec[7:, :],facecolor=\"#363336\")\n\nax1.pie([survived['S'],total['S']-survived['S']], explode=explode, shadow=True, startangle=90, colors =['#F2F2F2','#706B70'])\nax2.pie([survived['C'],total['C']-survived['C']], explode=explode, shadow=True, startangle=90, colors =['#F2F2F2','#706B70'])\nax3.pie([survived['Q'],total['Q']-survived['Q']], explode=explode, shadow=True, startangle=90, colors =['#F2F2F2','#706B70'])\n\nax1.text(s=\"Survived\",x=-0.48,y=0.4, font=font,fontsize=30,va='center',ha='center',color='#706B70')\nax1.text(s=f\"{round(survived['S']\/total['S'] * 100,1)}%\",x=-0.42,y=0.1, font=font,fontsize=40,va='center',ha='center',color='#706B70')\nax1.text(s=\"Embarked: S\",x=0,y=-1.3, font=font,fontsize=40,va='center',ha='center',color='#F2F2F2')\n\nax2.text(s=\"Survived\",x=-0.48,y=0.2, font=font,fontsize=35,va='center',ha='center',color='#706B70')\nax2.text(s=f\"{round(survived['C']\/total['C'] * 100,1)}%\",x=-0.46,y=-0.1, font=font,fontsize=50,va='center',ha='center',color='#706B70')\nax2.text(s=\"Embarked: C\",x=0,y=-1.3, font=font,fontsize=40,va='center',ha='center',color='#F2F2F2')\n\nax3.text(s=\"Survived\",x=-0.48,y=0.3, font=font,fontsize=30,va='center',ha='center',color='#706B70')\nax3.text(s=f\"{round(survived['Q']\/total['Q'] * 100,1)}%\",x=-0.46,y=0.0, font=font,fontsize=43,va='center',ha='center',color='#706B70')\nax3.text(s=\"Embarked: Q\",x=0.1,y=-1.3, font=font,fontsize=40,va='center',ha='center',color='#F2F2F2')\n\nax4.barh(y=0, width=sum(total.values()), color = '#F2F2F2', alpha=0.4)\nax4.barh(y=0, width=total['S'], color = '#F2F2F2', alpha=0.8)\nax4.barh(y=0, width=total['S'] + total['C'], color = '#F2F2F2', alpha=0.7)\n\nax4.text(s=f\"Q : {round(total['Q']\/sum(total.values()) * 100,2)}%\", x = 815, y = 0, font =font, fontsize=30,va='center')\nax4.text(s=f\"C : {round(total['C']\/sum(total.values()) * 100,2)}%\", x = 700, y = 0, font =font, fontsize=30,va='center')\nax4.text(s=f\"S : {round(total['S']\/sum(total.values()) * 100,2)}%\", x = 250, y = 0, font =font, fontsize=30,va='center')\n\nax4.text(s=\"The proportion of Embarked\", x = 0, y =1, font=font, fontsize=30, color ='white',va='top')\n\n\nax.axis(\"off\")\nax4.axis(\"off\")\nax4.set_xlim(0,sum(total.values()))\nax.text(s=\"The influence of Embarked\", x= 0,y=1.05, font=font,color='#F5E9F5',fontsize=50)\nplt.show()","92f2ad74":"train.head(3)","e65d8d6e":"train = pd.get_dummies(train,columns=['Pclass','Name','Sex','Embarked'],drop_first=True)\ntest = pd.get_dummies(test,columns=['Pclass','Name','Sex','Embarked'],drop_first=True)\ntrain.head(3)","a101f1c9":"y = train['Survived']\nX = train.drop('Survived',axis=1)","dea2b8b4":"from sklearn.preprocessing import MinMaxScaler\nscaler = MinMaxScaler()\nX = scaler.fit_transform(X)\ntest = scaler.transform(test)","cee0f1a5":"import torch\nimport torch.nn as nn\nfrom torch import optim\n\nfrom torch.utils.data import DataLoader\nfrom torch.utils.data import TensorDataset\nfrom torch.utils.data.dataset import random_split\n\ntorch.manual_seed(100)","aefa84ca":"X = torch.tensor(X,dtype=torch.float32)\ny = torch.tensor(y,dtype = torch.float32)\ntest = torch.tensor(test,dtype=torch.float32)\ny = y.reshape(-1,1)\n\ndataset = TensorDataset(X, y)\ntrain_dataset, val_dataset = random_split(dataset, [713,178])\ntrain_dataset = DataLoader(train_dataset, batch_size=1, shuffle=True)\nval_dataset = DataLoader(val_dataset, batch_size=1, shuffle=True)","77ce6066":"device = 'cuda' if torch.cuda.is_available() else 'cpu'\nmodel = nn.Sequential().to(device)\nmodel.add_module('fc1', nn.Linear(13, 13))\nmodel.add_module('dropout1', nn.Dropout(0.1))\nmodel.add_module('relu1', nn.ReLU())\nmodel.add_module('fc2', nn.Linear(13, 13))\nmodel.add_module('dropout2', nn.Dropout(0.1))\nmodel.add_module('relu2', nn.ReLU())\nmodel.add_module('fc3', nn.Linear(13, 10))\nmodel.add_module('dropout3', nn.Dropout(0.1))\nmodel.add_module('relu3', nn.ReLU())\nmodel.add_module('fc4', nn.Linear(10, 5))\nmodel.add_module('relu4', nn.ReLU())\nmodel.add_module('fc5', nn.Linear(5, 1))\nmodel.add_module('Sigmoid1', nn.Sigmoid())\nprint(model)","0813cf6b":"loss_fn = nn.BCELoss().to(device)\noptimizer = optim.Adam(model.parameters(), lr=0.01)","18fcfc1f":"nb_epochs = 4\nfor epoch in range(nb_epochs + 1):\n    for batch_idx, samples in enumerate(train_dataset):\n        x_train, y_train = samples\n        optimizer.zero_grad()\n        prediction = model(x_train)\n        cost = loss_fn(prediction, y_train)\n        cost.backward()\n        optimizer.step()\n        \n        if batch_idx%250 == 0:\n            print('Epoch {:4d}\/{} Batch {}\/{} Cost: {:.6f}'.format(\n                epoch, nb_epochs, batch_idx+1, len(train_dataset),\n                cost.item()\n                ))\n    validation_data_eval = []\n    for batch_idx, samples in enumerate(val_dataset):\n        x_train, y_train = samples\n        prediction = model(x_train)\n        cost = loss_fn(prediction, y_train)\n        validation_data_eval.append(cost.item())\n    print(\"validation cost : \", np.mean(validation_data_eval))","ec9411b8":"pred = model(test)\npred = pd.DataFrame(pred.tolist())\n\npred[0] = pred[0].apply(lambda x : 1 if x>=0.5 else 0)","094b91a8":"submission['Survived'] = pred\nsubmission.to_csv(\"test.csv\",index=None)","c9647de9":"# Data Preprocessing","5d02ff6f":"### 3. Name \/ Sex\nIf you change some name, You can make meaningful data","6225d606":"### Predict","0a11dd24":"### 9 Embarked","4e4d36fc":"This time, I using pytorch.","90aa59a3":"First, I extract the data from name, like \"Mr\", \"Mrs\" ...","e347cd98":"The loss function is Binary classification and, optimizer is adam","7805d679":"### 6. Ticket\n\nI can't find any meaning in Ticket","b4ce7475":"### 4. Age","f62d196e":"You can know that, the young generation's survived rate is lower than others","7faca42b":"### 5. SibSp \/ Parch","4af99559":"### 1. PassengerId\n\nI think 'PassengerId' has no meanning. So I dropped it","85a70b82":"I delete some columns like passengerId, ticket, cabin. And, I changed name, make max Fare (100).\n","f44322a2":"Then, I check them. Mrs's survived rate is 79.2% and Miss 69.8%, Master 57.5%, Ms 44.4% , Mr's survived only 15.7%\n\nSimilarly, Female's survived rate is 74.2% but, Male's survived rate only 18.9%","ae0a0fc6":"### Change to numeric\nI will change object to numeric using pandas get dummies function","30c43aed":"### 7. Fare","0eb65cd0":"# Make Model","7e429e08":"In Embarked: C's survived rate is 55.4%. I didn't put it in the text. There were many 1st class passengers in C. This effect is presumed to have resulted in the following results.","19e98743":"First, You should change datatype numpy to torch.tensor, and change y's shape\nand split the dataset to train, validation dataset. ( I split it 8:2 )","4e054ef3":"Fare showed big influence. I think it's relation with class. The higher the fee, the higher the survival rate.","4797c361":"### 8. Cabin\nCabin has many NaN value. So, I think it's hard to handling so, I dropped it","46671d23":"### Train","8829f1bb":"It's finish. Now make submission","6d2501c3":"Our output is taken sigmoid. So, I will change it if 0.5 > x is 1 and others 0","dc3e0856":"### 2. Pclass\n\nPclass is a important data. Look these charts.\n\nThe 1st class's survived rate is 63%, the 2nd class's survived rate is 47.3%, and the 3rd class's survived rate is 24.2%","4e4e6c06":"I made MLP model.","8dc4a8be":"# Data Analysis","6d0ea394":"#### Scaler\nNow I will using MinMaxScaler","f670aec8":"FamilySize has some influence. I can't explain detail, but If familysize is bigger, the survived rate is higher"}}