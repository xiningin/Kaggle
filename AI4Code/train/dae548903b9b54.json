{"cell_type":{"5a8dae0f":"code","704528b2":"code","41583e1c":"code","65ce61e9":"code","120aaadc":"code","92fd5175":"code","3bf65811":"code","a4685059":"code","23393405":"code","1d106e77":"code","321f83f8":"code","81ece905":"code","04df4775":"code","4131254e":"code","680cb63b":"code","37f8f75d":"code","9a86a2bd":"code","1030cd5f":"code","f11ba0bd":"code","b98ea0fb":"code","18cafa27":"code","0a0abc25":"code","f914c94e":"code","c5b1144d":"code","6d1f10bb":"code","fe0eb985":"code","070ffa97":"code","61514e30":"code","329d1c98":"code","34fde471":"code","1b6e8e95":"code","65014ca6":"code","0a58b5c6":"code","1498d512":"code","7604bf0f":"code","bf91832e":"code","70176fb3":"code","ebd38849":"code","511444e3":"code","24c83688":"code","bd6ae15b":"code","77e242f1":"code","a48bd356":"code","7930844c":"code","8c588d02":"code","5c53ef1a":"code","3ec3b58e":"code","3e05db80":"code","75915b23":"code","da2186b7":"code","2cfead0c":"code","f928d79c":"code","ec5b7cc3":"code","593cc26c":"code","138b416a":"code","04688a48":"code","bf5d5bff":"code","c1afa1ec":"code","c07f5798":"code","b23167c9":"code","8a7718bb":"code","064c1f40":"code","4dc3c374":"code","8e698caa":"code","0194ea9b":"code","4395afd4":"code","6cac7e00":"code","a3f57ab2":"code","b4ddd9e0":"code","1f31ad5b":"code","53bb36b6":"code","ab1d0c91":"code","242f627a":"code","ba181f18":"code","38e5e786":"code","0338b526":"code","7f1f119b":"code","cc504fa9":"code","dfe58684":"code","953e8d66":"code","44914bf7":"code","c3738daf":"code","24bcb7be":"code","ee7e2bcc":"code","63794266":"code","64ff4332":"code","be51c952":"code","362631dc":"code","8d87f5db":"code","cdc291e1":"code","054e2ef7":"code","283cd3e4":"code","c7bdf5d6":"code","f526bafa":"code","0f80a0d5":"code","2c2cc648":"markdown","2d6946c6":"markdown","5d7b04a8":"markdown","b267cf88":"markdown","d99de6c6":"markdown","944f891c":"markdown","2676b6c9":"markdown","b2e614e9":"markdown","498a84c3":"markdown","e1935b2b":"markdown","ddfe5c79":"markdown","a6bbe608":"markdown","b35ff9b4":"markdown","27badee1":"markdown","84fd839e":"markdown","81156287":"markdown","b5b7a6df":"markdown","a1fa4023":"markdown","4e63bc03":"markdown","20690a19":"markdown","acfed337":"markdown"},"source":{"5a8dae0f":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","704528b2":"import matplotlib.pyplot as plt\nimport seaborn as sns","41583e1c":"dataset=pd.read_csv(\"..\/input\/machine-learning-24-hrs-hackathon\/train_SJC.csv\",header=1)","65ce61e9":"dataset.head()","120aaadc":"dataset=dataset.rename(columns={\"Unnamed: 2\":\"DateReported\",\"Unnamed: 7\":\"DependentsOther\",\"Unnamed: 11\":\"DaysWorkedPerWeek\"})","92fd5175":"dataset.head()","3bf65811":"dataset.isna().sum()","a4685059":"dataset[\"MaritalStatus\"]= dataset[\"MaritalStatus\"].fillna('U')","23393405":"dataset[\"WeeklyWages\"]= dataset[\"WeeklyWages\"].fillna(dataset[\"WeeklyWages\"].median())","1d106e77":"dataset[\"HoursWorkedPerWeek\"]= dataset[\"HoursWorkedPerWeek\"].fillna(dataset[\"HoursWorkedPerWeek\"].mean())","321f83f8":"dataset.isna().sum()","81ece905":"dataset[\"InitialIncurredCalimsCost\"].describe()","04df4775":"dataset.dtypes","4131254e":"dataset[\"DateTimeOfAccident\"]=pd.to_datetime(dataset[\"DateTimeOfAccident\"])\ndataset[\"DateReported\"]=pd.to_datetime(dataset[\"DateReported\"])","680cb63b":"dataset[\"DateTimeOfAccident\"]=dataset[\"DateTimeOfAccident\"].dt.tz_convert(None)\ndataset[\"DateReported\"]=dataset[\"DateReported\"].dt.tz_convert(None)","37f8f75d":"dataset.head()","9a86a2bd":"dataset.info()","1030cd5f":"dataset.dtypes","f11ba0bd":"dataset[\"DaysofDelayofReport\"]=(dataset[\"DateReported\"]-dataset[\"DateTimeOfAccident\"]).dt.days","b98ea0fb":"dataset[\"YearofAccident\"]=dataset[\"DateTimeOfAccident\"].dt.year","18cafa27":"dataset[\"HourofAccident\"]=dataset[\"DateTimeOfAccident\"].dt.hour","0a0abc25":"dataset[\"YearReported\"]=dataset[\"DateReported\"].dt.year","f914c94e":"dataset.head()","c5b1144d":"dataset.describe()","6d1f10bb":"dataset.Gender.value_counts().plot.bar()","fe0eb985":"dataset.head()","070ffa97":"dataset.PartTimeFullTime.value_counts().plot.bar()","61514e30":"plt.hist(dataset[\"Age\"])","329d1c98":"dataset.DependentChildren.value_counts().plot.bar()","34fde471":"dataset.DependentsOther.value_counts()","1b6e8e95":"dataset.DependentsOther.value_counts().plot.bar()","65014ca6":"dataset.columns","0a58b5c6":"plt.hist(dataset[\"HoursWorkedPerWeek\"])","1498d512":"dataset[dataset[\"HoursWorkedPerWeek\"]>100]","7604bf0f":"dataset[\"DaysWorkedPerWeek\"].value_counts().plot.bar()","bf91832e":"dataset.columns\n","70176fb3":"dataset[\"YearReported\"].value_counts().plot.bar()","ebd38849":"sns.catplot(x=\"YearReported\",y=\"UltimateIncurredClaimCost\",data=dataset,kind='point')","511444e3":"sns.catplot(x=\"InitialIncurredCalimsCost\",y=\"UltimateIncurredClaimCost\",data=dataset,kind='point')","24c83688":"plt.hist(dataset[\"HourofAccident\"])","bd6ae15b":"plt.hist(dataset[\"DaysofDelayofReport\"])","77e242f1":"sns.catplot(x=\"DaysofDelayofReport\",y=\"UltimateIncurredClaimCost\",data=dataset,kind='point')","a48bd356":"dataset.InitialIncurredCalimsCost.plot.box()","7930844c":"dataset.UltimateIncurredClaimCost.plot.box()","8c588d02":"#dataset=dataset[dataset[\"HoursWorkedPerWeek\"]<100]","5c53ef1a":"dataset.head()","3ec3b58e":"sns.heatmap(dataset.corr())","3e05db80":"dataset[\"Age\"].describe()","75915b23":"dataset['age_cut']=pd.cut(dataset['Age'],bins=[10,18,50,90],labels=['underage','middle_age','Senior_age'])","da2186b7":"dataset.info()","2cfead0c":"dataset['age_cut'].value_counts()","f928d79c":"sns.countplot(x='age_cut',data=dataset)","ec5b7cc3":"dataset[\"WeeklyWages\"].plot.box()","593cc26c":"dataset[\"WeeklyWages\"].describe()","138b416a":"testdata=pd.read_csv(\"..\/input\/machine-learning-24-hrs-hackathon\/Test_SJC.csv\")","04688a48":"testdata.isna().sum()","bf5d5bff":"testdata[\"MaritalStatus\"]= testdata[\"MaritalStatus\"].fillna('U')","c1afa1ec":"testdata[\"DateTimeOfAccident\"]=pd.to_datetime(testdata[\"DateTimeOfAccident\"])\ntestdata[\"DateReported\"]=pd.to_datetime(testdata[\"DateReported\"])","c07f5798":"testdata[\"DateTimeOfAccident\"]=testdata[\"DateTimeOfAccident\"].dt.tz_convert(None)\ntestdata[\"DateReported\"]=testdata[\"DateReported\"].dt.tz_convert(None)","b23167c9":"testdata[\"DaysofDelayofReport\"]=(testdata[\"DateReported\"]-testdata[\"DateTimeOfAccident\"]).dt.days","8a7718bb":"testdata[\"YearofAccident\"]=testdata[\"DateTimeOfAccident\"].dt.year","064c1f40":"testdata[\"HourofAccident\"]=testdata[\"DateTimeOfAccident\"].dt.hour","4dc3c374":"testdata[\"YearReported\"]=testdata[\"DateReported\"].dt.year","8e698caa":"testdata['age_cut']=pd.cut(testdata['Age'],bins=[10,18,50,90],labels=['underage','middle_age','Senior_age'])","0194ea9b":"dataset.skew()","4395afd4":"testdata.skew()","6cac7e00":"import sklearn.preprocessing as pre\nimport sklearn.model_selection as ms","a3f57ab2":"data_cat=dataset.select_dtypes(exclude=['int64','float64']).columns.tolist()","b4ddd9e0":"le=pre.LabelEncoder()\nfor x in data_cat:\n    dataset[x]=le.fit_transform(dataset[x])","1f31ad5b":"data_cat1=testdata.select_dtypes(exclude=['int64','float64']).columns.tolist()","53bb36b6":"le=pre.LabelEncoder()\nfor x in data_cat1:\n    testdata[x]=le.fit_transform(testdata[x])","ab1d0c91":"dataset=dataset.drop(['Age','DateTimeOfAccident','DateReported','ClaimDescription','ClaimNumber'],axis=1)","242f627a":"testdata=testdata.drop(['Age','DateTimeOfAccident','ClaimDescription','DateReported','ClaimNumber'],axis=1)","ba181f18":"X_scale=pre.minmax_scale(dataset.drop(['UltimateIncurredClaimCost'],axis=1))","38e5e786":"Y=dataset['UltimateIncurredClaimCost']","0338b526":"dataset.info()","7f1f119b":"x_train,x_test,y_train,y_test=ms.train_test_split(X_scale,Y,test_size=0.3,random_state=1234456)","cc504fa9":"x_train.shape,x_test.shape,y_train.shape,y_test.shape","dfe58684":" import sklearn.linear_model as lm","953e8d66":"glm=lm.LinearRegression()","44914bf7":"glm.fit(x_train,y_train)","c3738daf":"glm.score(x_test,y_test)","24bcb7be":"glm.score(x_train,y_train)","ee7e2bcc":"test_scale=pre.minmax_scale(testdata)","63794266":"y_pred1=glm.predict(test_scale)","64ff4332":"y_pred1","be51c952":"import sklearn.metrics as mt","362631dc":"np.sqrt(mt.mean_squared_error(y_pred=glm.predict(x_test),y_true=y_test))","8d87f5db":"file2=pd.read_csv(\"..\/input\/machine-learning-24-hrs-hackathon\/sample_submission.csv\")","cdc291e1":"file2[\"UltimateIncurredClaimCost\"]=y_pred1","054e2ef7":"file2.to_csv(\"Samplesub7.csv\",index=False)","283cd3e4":"from sklearn.ensemble import RandomForestRegressor\nrf= RandomForestRegressor(n_estimators=1000,random_state=42351)","c7bdf5d6":"rf.fit(x_train,y_train)","f526bafa":"predictions=rf.predict(x_test)","0f80a0d5":"np.sqrt(mt.mean_squared_error(y_test,predictions))","2c2cc648":"Most of the workers are full time workers","2d6946c6":"## Data Processing","5d7b04a8":"We can say that little correlation(positive) is present between InitialIncurredCalimsCost and UltimateIncurredClaimCost","b267cf88":"Total hours in a week is 168. So values greater than that is impossible . So it is better to subset them","d99de6c6":"Middle aged people are more","944f891c":"## EDA","2676b6c9":"### Random Forest","b2e614e9":"### Linear Model","498a84c3":"### Data Transformation:","e1935b2b":"### Binning","ddfe5c79":"As year increases the cost also increases","a6bbe608":"The cost may depend on the year of accident ","b35ff9b4":"Test data preparation","27badee1":"## Data Loading","84fd839e":"### Model Selection","81156287":"Converted datetime to date only since time was not specified","b5b7a6df":"### Feature Extraction","a1fa4023":"Gender of one person is unknown and most of the workers are male","4e63bc03":"Most workers belongs to 20-40 agegroup","20690a19":"More accidents between 7th and 16th hour. Also less accidents are reported in 2006 probably due to lack of recent data. ","acfed337":"#### Linear Regression works better than Random Forest"}}