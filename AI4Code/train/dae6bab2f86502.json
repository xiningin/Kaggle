{"cell_type":{"e8bcc220":"code","6331a612":"code","a330b604":"code","559a3738":"code","8c99f405":"code","42cb7690":"code","dac6a830":"code","7bd49fff":"code","29f84ab1":"code","ac65b6d2":"code","d4436f82":"code","86cd4f44":"code","03d5b86d":"code","65019d43":"code","6f6b3174":"code","5af59053":"code","8906eae8":"code","b910a005":"code","1a5433aa":"code","5a8be434":"code","236b5700":"code","4dbb11de":"code","ae3fc9c1":"code","ab1db658":"markdown"},"source":{"e8bcc220":"import os\nimport pandas as pd","6331a612":"tru = pd.read_csv('..\/input\/fakenews\/True.csv')\nfake =  pd.read_csv('..\/input\/fakenews\/Fake.csv')","a330b604":"tru.head()","559a3738":"fake.head()","8c99f405":"tru['label'] = 'True'","42cb7690":"tru.head()","dac6a830":"fake['label'] = 'Fake'\nfake.head()","7bd49fff":"data = pd.concat([fake, tru]).reset_index(drop = True)\ndata.head()","29f84ab1":"from sklearn.utils import shuffle\ndata = shuffle(data)\ndata = data.reset_index(drop=True)\n\n\ndata.head()\n","ac65b6d2":"data.drop([\"date\"],axis=1,inplace=True)\ndata.head()","d4436f82":"data.drop([\"title\"],axis=1,inplace=True)\ndata.head()","86cd4f44":"data['text'] = data['text'].apply(lambda x: x.lower())\ndata.head()","03d5b86d":"import string\ndef punctuation_removal(text):\n    all_list = [char for char in text if char not in string.punctuation]\n    clean_str = ''.join(all_list)\n    return clean_str\ndata['text'] = data['text'].apply(punctuation_removal)\ndata.head()","65019d43":"import matplotlib.pyplot as plt\n","6f6b3174":"print(data.groupby(['subject'])['text'].count())\ndata.groupby(['subject'])['text'].count().plot(kind=\"bar\")\nplt.show()","5af59053":"print(data.groupby(['label'])['text'].count())\ndata.groupby(['label'])['text'].count().plot(kind='bar')\nplt.show()","8906eae8":"import itertools\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.linear_model import PassiveAggressiveClassifier\nfrom sklearn.metrics import accuracy_score, confusion_matrix\nfrom sklearn.metrics import plot_confusion_matrix\n","b910a005":"labels=data.label\nlabels.head()\n","1a5433aa":"x_train,x_test,y_train,y_test=train_test_split(data['text'],labels, test_size=0.3, random_state=100)","5a8be434":"#DataFlair - Initialize a TfidfVectorizer\ntfidf_vectorizer=TfidfVectorizer(stop_words='english', max_df=0.7)\n#DataFlair - Fit and transform train set, transform test set\ntfidf_train=tfidf_vectorizer.fit_transform(x_train) \ntfidf_test=tfidf_vectorizer.transform(x_test)\n","236b5700":"#DataFlair - Build confusion matrix\ncm = confusion_matrix(y_test,y_pred, labels=['Fake','True'])\ncm\n","4dbb11de":"#DataFlair - Initialize a PassiveAggressiveClassifier\npac=PassiveAggressiveClassifier(max_iter=50)\npac.fit(tfidf_train,y_train)\n#DataFlair - Predict on the test set and calculate accuracy\ny_pred=pac.predict(tfidf_test)\nscore=accuracy_score(y_test,y_pred)\nprint(f'Accuracy: {round(score*100,2)}%')\n","ae3fc9c1":"#DataFlair - Build confusion matrix\ncm = confusion_matrix(y_test,y_pred, labels=['Fake','True'])\ncm\n\n","ab1db658":"Got accurACY SCORE OF 99.25% WHICH IS VERY HIGH."}}