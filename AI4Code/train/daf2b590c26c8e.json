{"cell_type":{"315fad64":"code","f5ce60fb":"code","3408d3c3":"code","b20e10dc":"code","91238b87":"code","6d59fdfc":"code","b7fe2e1e":"code","398148c2":"code","47f5fead":"code","a13eb94c":"code","c893776d":"code","982ad266":"code","097a598a":"code","e68f67b5":"code","518a7327":"code","1f036b9c":"code","398ad156":"code","92b44245":"code","02d1ee81":"code","99eb725f":"code","2ef61e99":"code","fc66fe8a":"markdown","e04597ba":"markdown","e952cf9c":"markdown","d1f6c7c4":"markdown","cd295cb6":"markdown","0f2ad3a4":"markdown","abd1f1dc":"markdown"},"source":{"315fad64":"import pandas as pd\nimport numpy as np","f5ce60fb":"data = pd.read_csv(\"..\/input\/diagnosis\/AIML(diagnosis).csv\")","3408d3c3":"data.head()","b20e10dc":"data.columns[0]","91238b87":"data.drop(['id','Unnamed: 32'],axis=1,inplace=True)","6d59fdfc":"def determine_random_variable_type1(column_name):\n    \n    if (data.dtypes[column_name] == object or data.dtypes[column_name] == int) and (len(data[column_name].unique()) < len(data[column_name])):\n        \n        return 'discrete'\n    \n    else:\n        \n        return 'continous'","b7fe2e1e":"result1=dict()","398148c2":"result1=result1.fromkeys(data.columns, None)","47f5fead":"final_result = result1","a13eb94c":"result1.keys()","c893776d":"z=0\nfor i in result1.keys():\n  result1[i] = determine_random_variable_type1(data.columns[z])\n  z=z+1","982ad266":"result1","097a598a":"data.diagnosis.unique()","e68f67b5":"import scipy.stats as s\nimport math","518a7327":"def calculate_L_max_normal(column_name):\n\n    mu_best_normal = data[column_name].mean()\n\n    sigma_best_normal = data[column_name].std()\n\n    L_max_normal = np.sum(np.log(s.norm.pdf(data[column_name], loc =mu_best_normal,scale = sigma_best_normal )))\n\n    return L_max_normal\n","1f036b9c":"calculate_L_max_normal(data.columns[1])","398ad156":"def calculate_L_max_rayleigh(column_name):\n    tf = np.array(data[column_name])\n    sigma_best_rayleigh = np.sqrt(np.mean(tf ** 2)\/2)\n    \n    L_max_rayleigh = np.sum(np.log((tf \/ (sigma_best_rayleigh ** 2)) * (math.e ** -((tf ** 2) \/ (2 * sigma_best_rayleigh ** 2)))))\n    return L_max_rayleigh","92b44245":"calculate_L_max_rayleigh(data.columns[1])","02d1ee81":"def determine_distribution_type(column_name):\n    column_type = determine_random_variable_type1(column_name)\n    #print(column_name)\n    #Write the code here to first determine type of random variable : Either Discrete or Continous\n    if column_type == 'discrete':\n      #print(\"it is binomial\")\n      if len(data[column_name].unique())==2:\n        print(column_name,\"column has binomial distribution\")\n      else:\n        print(column_name,\"column has multinomial distribution\")\n\n        #if the above condition is true, then write the code to determine whether it's binomial or multinomial\n        #and return the strings 'binomial' or 'multinomial' accordingly   \n    else:\n        x = calculate_L_max_normal(column_name)\n        #write the code to find L_max_normal here \n        y = calculate_L_max_rayleigh(column_name)\n        #write the code to find the L_max_rayleigh here \n        \n        if x > y:\n            \n            print(column_name,\"column has normal distribution\")\n        \n        else:\n            \n            print(column_name,\"column has rayleigh distribution\")","99eb725f":"determine_distribution_type(data.columns[3])","2ef61e99":"for i in data.columns:\n  determine_distribution_type(i)\n  print(\"\\n\")","fc66fe8a":"Now, the next task is to calculate the value of the best estimator of the population parameter of the probability distribution from which a specific column data is being sampled. In case of discrete random variables, it's pretty easy to determine that: If there are only two unique values in the column data, then it's binomial distribution and multinomial if there are more than two unique values.\n\nBut, the real challenge lies in case of continous random variables, where it is difficult to determine that from which continous probability distibution the column data is being sampled. We have two options here: Either Normal (Symmetric) or Rayleigh (Skewed). So, in this case we have to find the best fit of our data on both the distributions and then select the distribution with the BESTEST FIT.\n\nWell, now the question arrises that how we are going to do that. We know that the Log Likelihood Function Value calculated on the data determines the quality of fit of data on the presumed distribution and if we maximize that value then we get the best fit of a specific probability distribution on the data. so, we first find the best fit of normal distibution on our continous data and then we find the best fit of Rayleigh Distribution on our continous data by maximizing the Log Likelihood Function Value for both the cases and because we have to select that distribution which gives us the bestest fit so we will end up selecting the distribution whose Log Likelihood Function value is maximum among both maxmized Log Likelihood Function Values.\n\nThe problem is that in order to find the Log Likelihood Function value evaluated in case of fit of specific distribution on the data, we need the PDF of that distribution, which we know but we dont know the values of best estimators of population parameters:\n\u03bc,\u03c3\nof Normal Distribution and best estimator of population parameter,\n\u03c3(mode)\n\nof Rayleigh Distribution.\n\nNow, how do we get the values of the best estimators of population parameters of respective distributions. Well, we know the answer to this question and that is by Maximum Log Likelihood Estimation. We know that the data in each column of this dataset is IID (Independent and Identically Distributed) therefore, for any random column of this dataset, X where X can be 'radius_mean' or 'testure_mean' or anything else, the Log Likelihood function is evaluated as:\n\n\\begin{equation}\n\\log_e L(\\mu,\\sigma) = \\log_e P(X=x_1\\cap X=x_2\\cap .........X=x_N)\n\\end{equation}\n\nFor Normal Distribution\n\n\\begin{equation}\n\\log_e L(\\mu, \\sigma) = \\log_e\\prod\\limits_{i=0}^{N}\\left(\\frac{1}{\\sqrt{2\\pi}\\sigma}e^\\frac{(x_i-\\mu)^2}{2\\sigma^2}\\right)\n\\end{equation}\n\n\\begin{equation}\n\\log_e L(\\mu, \\sigma) = \\sum\\limits_{i=0}^{N}\\log_e\\left(\\frac{1}{\\sqrt{2\\pi}\\sigma}e^\\frac{(x_i-\\mu)^2}{2\\sigma^2}\\right)\n\\end{equation}\n\nHere, the population mean and population standard deviation estimator best estimate for normal distribution can be evaluated by taking the derivative of the above function with respect to \u03bc and \u03c3 and when we do that, that is:\n\n\\begin{equation}\n\\frac{\\partial\\log_e L(\\mu, \\sigma)}{\\partial\\mu} = 0\n\\end{equation}\n\n\\begin{equation}\n\\frac{\\partial log_e L(\\mu, \\sigma)}{\\partial\\sigma} = 0\n\\end{equation}\n\nWe get,\n\\begin{equation}\n\\mu_\\text{best,normal} = \\frac{\\sum\\limits_{i=0}^{N}{X_i}}{N}\n\\end{equation}\n\nAnd, \n\n\\begin{equation}\n\\sigma_\\text{best,normal} = \\sqrt{\\frac{\\sum\\limits_{i=0}^{N}{(x_i-\\mu_\\text{best,normal})^2}}{N}}\n\\end{equation}\n\ue000\ue000\n\nWhich is sample mean and sample standard deviation, therefore these are the best estimates of the population parameters of Normal Distribution for the best fit on our column data.\n\nSimilarly, we can find the values of the best estimators of the population parameter of Rayliegh Distribution by following the above mentioned steps, and we get the following value for the best estimate in case of Rayleigh Distribution:\n\n\\begin{equation}\n\\sigma_\\text{best,rayleigh} = \\sqrt{\\frac{\\sum\\limits_{i=0}^{N}{x_i^2}}{2N}}\n\\end{equation}\ue000\ue000\ue000\n\nSo, these best estimates of the MVU Estimators of respective population parameters of respective Probability Distributions will maximize the Log Likelihood Function values for respective probability distributions and hence will result in best fit of respective distributions. Now, to determine the bestest fit among both of the distributions, we have to select that distribution for which the Log Likelihood Function is the highest among both already maximized values.\n\nNow, in our case N = 569, so the best estimates of the MVU estimators of the population parameters of respective probability distributions are given by:\n\n\\begin{equation}\n\\mu_\\text{best,normal} = \\frac{\\sum\\limits_{i=0}^{569}{x_i}}{569}\n\\end{equation}\n\nAnd, \n\n\\begin{equation}\n\\sigma_\\text{best,normal} = \\sqrt{\\frac{\\sum\\limits_{i=0}^{569}{(x_i-\\mu_\\text{best,normal})^2}}{569}}\n\\end{equation}\ue000\n\nFor Normal Distribution\n\nAnd,\n\n\\begin{equation}\n\\sigma_\\text{best,rayleigh} = \\sqrt{\\frac{\\sum\\limits_{i=0}^{569}{x_i^2}}{2*569}}\n\\end{equation}\n\nTherefore, the maximized values of Log Likelihood Function for the case of both the probability distributions is given by:\n\n\\begin{equation}\nL_\\text{max,normal} = \\log_e L(\\mu_\\text{best,normal},\\sigma_\\text{best,normal})\n\\end{equation}\n\nFor Normal Distribution\n\nAnd,\n\nSimilarly, maximized value of Log Likelihood Function for Rayleigh Distribution can be calculated as we have just calculated for Normal Distribution.\n\n\\begin{equation}\nL_\\text{max,rayleigh} = \\log_e L(\\sigma_\\text{best,rayleigh})\n\\end{equation}\n\nNow, the column data will be considered to be sampled from Normal Distribution if:\n\n\\begin{equation}\nL_\\text{max,normal} > L_\\text{max,rayleigh}\n\\end{equation}\n\nelse:\n\ncolumn data will be considered to be sampled from Rayleigh Distribution.\n\nTherefore, in order to do all that, we are going to create following set of functions:","e04597ba":"\\begin{equation}\nL_\\text{max,normal} = \\sum\\limits_{i=0}^{569}\\log_e\\left(\\frac{1}{\\sqrt{2\\pi}\\sigma_\\text{best,normal}}e^\\frac{(x_i-\\mu_\\text{best,normal})^2}{2\\sigma_\\text{best,normal}^2}\\right)\n\\end{equation}","e952cf9c":"The task is to determine the best fitting probability distribution on each column data (Sample Data of the Random Variable) of the dataset, out of the possible choices of probability distributions: Normal(Symmetric), Rayleigh(Skewed) or Binomial.\n\nSo, let's see that how are we going to do that for a single column data and then we have to repeat this process for rest of the columns:\n\nStep 1: First, we will check whether the Random Variable is Discrete or Continous by checking that how many unique values are there in the single column of the Random Variable and does the Random Variable has string or floating point or integer values? Usually, Discrete Random Variables have either Integer or String values whereas continous random variables have floating point values and also because the values are not sparse (0s or 1s) in continous random variables and they are dense (floating point values) so values don't repeat much and hence the number of unique values are almost equal to the total number of values in the column. As an example, lets take one by one two columns: 'diagnosis' and 'radius_mean':","d1f6c7c4":"In this Notebook we work on Diagnosis dataset, we perform MAXIMUM LIKELIHOOD ESTIMATION.\n\nDownload the dataset from here : https:\/\/www.kaggle.com\/aniketyadav1\/diagnosis\n\nLet's Start \u270c","cd295cb6":"\nRemove the first column 'id' and the last column 'Unnamed:32' from this dataset:","0f2ad3a4":"**Importing Libraries**","abd1f1dc":"As we see in diagnosis column, there are only two random values,i.e. we conclude that diagnosis is binomial distribution."}}