{"cell_type":{"88eb8fc3":"code","a6ff0feb":"code","c83db74a":"code","b7e64986":"code","019d2c85":"code","caa53149":"code","d1738a1f":"code","940303df":"code","74a612f7":"code","e87517f4":"code","61744a57":"code","581ab959":"code","dfa9be2d":"code","f59b61ad":"code","da5835c3":"code","b6a611a4":"code","9e4a2066":"code","7fdc1b30":"code","49baf062":"code","09e82742":"code","ed9f99a0":"code","c382a00d":"code","331359fa":"code","c247f93f":"code","02c8b263":"code","1c12f198":"code","9f17ed6c":"code","3ac02228":"code","71434126":"code","7e569b20":"code","c6501e2d":"code","f4a86fdd":"code","a1debc21":"markdown","52903056":"markdown","83f9c48a":"markdown","892641b3":"markdown","1e596b3f":"markdown","16c56720":"markdown","28288ba7":"markdown","51870fda":"markdown","0309ac60":"markdown","042edda9":"markdown","ace2072c":"markdown","342d132d":"markdown","18554864":"markdown","f933108f":"markdown","4f9faa71":"markdown","5ba2f722":"markdown","637e386f":"markdown","e27d82c4":"markdown","72854e3d":"markdown","108d5cb1":"markdown","f49445db":"markdown","06e65278":"markdown","2223f374":"markdown","64ab8816":"markdown","feb7523b":"markdown","f1495f75":"markdown","8b432bc9":"markdown","6e90a89d":"markdown","16625638":"markdown"},"source":{"88eb8fc3":"import matplotlib.pyplot as plt\nimport numpy as np\nimport tensorflow as tf","a6ff0feb":"def function(x):\n    return x**2","c83db74a":"# We will calculate by passing a value of x and delta x, I have choosen as delta x = 0.0001\ndef derivative(x):\n    delta_x = 0.0001\n    return (function(x + delta_x) - function(x))\/ delta_x ","b7e64986":"x = np.arange(-100,100,0.1)\ny = function(x)","019d2c85":"plt.plot(x, y)\nplt.xlabel('X-axis')\nplt.ylabel('Y-axis')\nplt.title('X^2 curve')\nplt.show()","caa53149":"x_value = -100\nlr = 0.01\nnew_points = [] # In this we will strore all update of initial point\nfor i in range(200):\n    x_value  = x_value - lr * derivative(x_value)\n    new_points.append(x_value)","d1738a1f":"plt.plot(x, y)\nplt.scatter(new_points, function(np.array(new_points)),s = 10, c='r')\nplt.xlim(-100, 100)\nplt.show()","940303df":"from matplotlib.animation import FuncAnimation\nfrom IPython.display import HTML\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport math\ndef Create_animation(new_points):\n    fig = plt.figure()\n\n    plt.plot(x, y, lw = 2)\n    # plt.scatter(new_points, f(np.array(new_points)),s = 10, c='r')\n\n    balle, = plt.plot([0], [0], 'ko', ms = 10, mfc = 'r')\n\n    def animate(i):\n\n        balle.set_data(i, function(i))\n        return balle,\n    \n    animation = FuncAnimation(fig, animate, frames = np.array(new_points), interval = 100,blit =True, repeat=True)\n    return animation\nanimation = Create_animation(new_points)    \nHTML(animation.to_html5_video())\n","74a612f7":"def function(x):\n    return x*tf.math.cos(1.2*x)\n\n# We will calculate by passing a value of x and delta x, I have choosen as delta x = 0.0001\ndef derivative(x):\n    delta_x = 0.0001\n    return (function(x + delta_x) - function(x))\/ delta_x  # This is formula we use to calculate derivative of a point\n\nx = np.arange(-4,4,0.1)\ny = function(x)","e87517f4":"plt.plot(x,y)\nplt.title('Curve with mathematical equation = x * cos(1.2 * x)')\nplt.show()","61744a57":"x_value = -2.5\nnew_points = []\nfor i in range(200):\n    x_value  = x_value - 0.01 * derivative(x_value)\n    new_points.append(x_value)\n# new_points = [i.numpy() for i in new_points]","581ab959":"plt.plot(x, y)\nplt.scatter(new_points, function(np.array(new_points)),s = 15, c='r')\nplt.xlim(-4, 4)\nplt.title('Showing the updation we achieved during iterations')\nplt.show()","dfa9be2d":"\nanimation = Create_animation(new_points)    \nHTML(animation.to_html5_video())","f59b61ad":"x_value = -2.5\nvx = 0    # Initializing velocity with zero\nrho = 0.9 # As per documentation, Value of rho can vary between 0.9 - 0.99\nnew_points = []\nfor i in range(300):\n    d = derivative(x_value)\n    vx = rho * vx + d\n    x_value  = x_value - 0.01 * vx\n    new_points.append(x_value)\n# new_points = [i.numpy() for i in new_points]","da5835c3":"plt.plot(x, y)\nplt.scatter(new_points, function(np.array(new_points)),s = 20, c='r')\nplt.xlim(-4, 10)\nplt.title('Showing the updation we achieved during iterations')\nplt.show()","b6a611a4":"animation = Create_animation(new_points)    \nHTML(animation.to_html5_video())","9e4a2066":"x_value = -2.5\nvx = 0\nrho = 0.95\nnew_points = []\nvelocity = []\nfor i in range(200):\n    d = derivative(x_value)\n    velocity.append(vx)\n    vx = rho * vx + d\n    x_value  = x_value - 0.02 * vx\n    new_points.append(x_value)\n# new_points = [i.numpy() for i in new_points]","7fdc1b30":"plt.plot(x, y)\nplt.scatter(new_points, function(np.array(new_points)),s = 10, c='r')\nplt.xlim(-4, 4)\nplt.title('Showing the updation we achieved during iterations')\nplt.show()","49baf062":"plt.plot(x, y)\nplt.plot(np.linspace(-2.5, 4,200), velocity, c='r')\nplt.title('Velocity over time')\nplt.xlabel('Time- Axis')\nplt.ylabel('Velocity')\nplt.show()","09e82742":"animation = Create_animation(new_points)    \nHTML(animation.to_html5_video())","ed9f99a0":"x_value = -2.5\nv = 0\nrho = 0.95\nlr = 0.03\nnew_points = []\nfor i in range(200):\n    dx = derivative(x_value)\n    old_v = v\n    v = rho*v - lr * dx\n    x_value  = x_value - (rho * old_v) + (1+rho)*v\n    new_points.append(x_value)\n# new_points = [i.numpy() for i in new_points]","c382a00d":"plt.plot(x, y)\nplt.scatter(new_points, function(np.array(new_points)),s = 10, c='r')\nplt.title('Showing the updation we achieved during iterations')\nplt.xlim(-4, 10)\nplt.show()","331359fa":"animation = Create_animation(new_points)    \nHTML(animation.to_html5_video())","c247f93f":"grad_square = 0\nx_value = -2.5\nlr= 0.09\nnew_points = []\nfor i in range(200):\n    dx = derivative(x_value)\n    grad_square = grad_square + dx**2\n    x_value = x_value - lr * dx\/(np.sqrt(grad_square) + 0.0000001)\n    new_points.append(x_value)\n# new_points = [i.numpy() for i in new_points]","02c8b263":"plt.plot(x, y)\nplt.scatter(new_points, function(np.array(new_points)),s = 10, c='r')\nplt.title('Showing the updation we achieved during iterations')\nplt.xlim(-4, 4)\nplt.show()","1c12f198":"animation = Create_animation(new_points)    \nHTML(animation.to_html5_video())","9f17ed6c":"x_value = -2.5\ngrad_square = 0\ndecay_rate = 0.95\nlr= 0.01\nnew_points = []\nfor i in range(200):\n    dx = derivative(x_value)\n    grad_square = decay_rate * grad_square + (1-decay_rate)*dx*dx\n    x_value = x_value - (lr * dx)\/(np.sqrt(grad_square)+ 0.00000001)\n    new_points.append(x_value)\n# new_points = [i.numpy() for i in new_points]","3ac02228":"plt.plot(x, y)\nplt.scatter(new_points, function(np.array(new_points)),s = 10, c='r')\nplt.xlim(-4, 4)\nplt.show()","71434126":"animation = Create_animation(new_points)    \nHTML(animation.to_html5_video())","7e569b20":"first_moment = 0\nsecond_moment = 0\nbeta_1 = 0.98\nbeta_2 = 0.999\nlr = 0.01\n\nx_value = -2.5\nnew_points = []\nfor i in range(1,900):\n    dx = derivative(x_value)\n    first_moment = beta_1 * first_moment +(1-beta_1)*dx\n    second_moment = beta_2 * second_moment + (1-beta_2)*dx*dx\n    x_value = x_value - (lr*first_moment)\/(np.sqrt(second_moment)+ 0.0000001)\n    new_points.append(x_value)\n# new_points = [i.numpy() for i in new_points]","c6501e2d":"plt.plot(x, y)\nplt.scatter(new_points, function(np.array(new_points)),s = 10, c='r')\nplt.xlim(-4, 4)\nplt.show()","f4a86fdd":"animation = Create_animation(new_points)    \nHTML(animation.to_html5_video())","a1debc21":"### Animation  \n","52903056":"## 1) Gradiant descent  \n<a id = 'section_2_1'><\/a>","83f9c48a":"## 3) Nestorom Momentum   \n<a id = 'section_2_3'><\/a>","892641b3":"## 2)  Gradient Descent + Momentum  \n<a id = 'section_2_2'><\/a>","1e596b3f":"### 2.1) Hyperparameters :   \nro = 0.9  \nlearning_rate = 0.01  \n\nAs we can see due to the velocity, Our ball escaped the first local minima, And went little bit up","16c56720":"Let's visualize it so that, We can understand how we are decreasing error with iteration","28288ba7":"## function : x**2  \n<a id = 'section_1'><\/a>","51870fda":"## 5) RMSProp   \n<a id = 'section_2_5'><\/a>","0309ac60":"Finally you arrive at the end of this notebook, If you like this notebook please upvote, This will give me motivation to work more.  \nThanks :)","042edda9":"Let's try to play around with this curve where we have 2 local minima, Our goal is to reach the Global minima.  \n\nConclusion from the experiments that i have done  \ni) There are two minima and our point just get stuck at a 1st minima. I have tried with higher learning rate but still  \n  Unable to leave the 1st minima.  \nii) Also tried with increasing iteration, But didn't help.  \n\nBecauuuuuuseeeee, We reached at zero gradient.  ","ace2072c":"As we see from the animation above, It our ball is taking too much time to reach global minima, It stops when it reached  \nto the minima.  \nWhat consequences we can face when our gradient descent doesent work?  \n--> i) Sometime when we are at local minima and still we stop improving will cause to have bad accuracy at the end  \n    ii) We can't escape flat platue and valley.  ","342d132d":"### Animaion  \n<a id = 'animationNM'><\/a>","18554864":"## 1) Gradient Descent  \n<a id = 'section_1_1'><\/a>","f933108f":"## function:- x*cos(1.2*x)  \n<a id = 'section_2'><\/a>","4f9faa71":"We know the formula for the derivative (f(x + delta(x)) - f(x))\/ delta(x).  \nYou can get good idea on this page [What exactly gradient is?](https:\/\/www.mathsisfun.com\/calculus\/derivatives-introduction.html)","5ba2f722":"### Animation  \n<a id = 'animationGD'><\/a>","637e386f":"This will be really interesting to see how we velocity is chsnging over time,  \nLet's visualize it for better understanding  ","e27d82c4":"\nNow let's create a Animation and move on to other optimizer to see , If we can reach to global minima of function","72854e3d":"## 6) Adam  \n<a id = 'section_2_6'><\/a>","108d5cb1":"### 2.2) HyperParameters :  \nYehhhhhh, Finally after some hyper parameter tuning, able to show that this optimizer is using velocity.  \nro = 0.95,  learning_rate = 0.02   \n\n* Comments:-  \nAs you can see that, Velocity is increasing with time as we move on slope, Also we can see oscillation of ball due to  \nmomentum of the ball.","f49445db":"### Animaion  \n<a id ='animationadam'><\/a>","06e65278":"### Animaion  \n<a id = 'animationA'><\/a>","2223f374":"### Animation","64ab8816":"### Animation  \n<a id = 'animationGDM'><\/a>","feb7523b":"### Animaion  \n<a id = 'animationR'><\/a>","f1495f75":"We will try to get points of a curve x^2","8b432bc9":"# Table of content  \n* 1) [Function : x**2](#section_1)  \n    * 1.1) [Gradient Descent](#section_1_1)  \n* 2) [Function : x*cos(1.2*x)](#section_2)  \n    * 2.1) [Gradient Descent](#section_2_1)  \n        * [Animation of Gradient Descent](#animationGD)  \n    * 2.2) [Gradient Descent+ Momentum](#section_2_2)  \n        * [Animation of Gradient Descent + Momentum](#animationGDM)  \n    * 2.3) [Nestorov Momentum](#section_2_3)  \n        * [Animation of Nestorov Momentum](#animationNM)  \n    * 2.4) [AdaGrad](#section_2_4)  \n        * [Animation of AdaGrad](#animationA)  \n    * 2.5) [RMSProp](#section_2_5)  \n        * [Animation of RMSProp](#animationR)  \n    * 2.6) [Adam](#section_2_6)  \n        * [Animation of Adam](#animationadam)\n* Reference    \n","6e90a89d":"## Reference  \nhttps:\/\/cs231n.github.io\/neural-networks-3\/","16625638":"## 4) AdaGrad  \n<a id = 'section_2_4'><\/a>"}}