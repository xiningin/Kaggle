{"cell_type":{"3e4e7f8b":"code","becd7afe":"code","faea0dff":"code","b747b9a0":"code","9d8c180b":"code","f989b7c4":"code","1cf4bff9":"code","5d07e5d1":"code","3d78d33e":"code","bd10681c":"code","c63f9b8a":"code","5c2b7a05":"code","f74558f5":"code","fd561b61":"code","a3bdc135":"code","73e2e9b6":"code","94e455d0":"code","493c29bc":"code","9b455841":"code","d83bcc2a":"code","db6642b7":"code","c8e681f6":"code","f9c21c6d":"code","a6eeb2a6":"code","0e5567e6":"code","c909019c":"code","83fe95d3":"code","52673009":"code","38dc617a":"code","4bce18a8":"code","d474cf37":"code","efe377fa":"code","974df84c":"code","dd2d54f9":"code","52b568f3":"code","8629aefb":"code","984b6303":"code","c47e1836":"code","110f2c0a":"code","a6a86543":"code","01798310":"code","e9f5d295":"code","31b7452b":"code","4db56243":"code","d4a2f4f9":"code","8bfde179":"code","2aa4f13c":"code","cd8c9d2b":"code","a4cbacbd":"code","c592090d":"code","79fcda9a":"code","cfe659a6":"code","d9915301":"code","6215fd27":"code","9ff549d5":"code","843372c1":"code","640e8bb9":"markdown","4108a843":"markdown","52c92d82":"markdown","8ae86999":"markdown","6588d4ec":"markdown","43f2f6be":"markdown","dccf795c":"markdown","8d304a2a":"markdown","00388b0b":"markdown","34cb6695":"markdown","71d9ec1b":"markdown","697d5e30":"markdown","6ae4a748":"markdown","4a01ac86":"markdown","6aacd578":"markdown"},"source":{"3e4e7f8b":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport numpy as np\nimport warnings\n\nwarnings.filterwarnings('ignore')\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n%matplotlib inline","becd7afe":"df = pd.read_csv('..\/input\/Consumo_cerveja.csv')\ndf.columns = df.columns.str.replace(' ','_')\ndf.columns = df.columns.str.replace('[)(]' ,'')","faea0dff":"df.head(10)","b747b9a0":"df.shape","9d8c180b":"df.isnull().sum()","f989b7c4":"# remo\u00e7\u00e3o de dados faltantes\ndf.dropna(subset=['Data','Final_de_Semana','Consumo_de_cerveja_litros'],how='all', inplace=True)","1cf4bff9":"df['Temperatura_Media_C'] = df['Temperatura_Media_C'].str.replace(',' ,'.').astype(float)\ndf['Temperatura_Minima_C'] = df['Temperatura_Minima_C'].str.replace(',' ,'.').astype(float)\ndf['Temperatura_Maxima_C'] = df['Temperatura_Maxima_C'].str.replace(',' ,'.').astype(float)\ndf['Precipitacao_mm'] = df['Precipitacao_mm'].str.replace(',' ,'.').astype(float)\ndf['Final_de_Semana'] = df['Final_de_Semana'].astype(int)","5d07e5d1":"df['Data'] = pd.to_datetime(df['Data'])\ndf['mes'] = pd.to_datetime(df['Data']).dt.month\ndf['dia_semana'] = pd.to_datetime(df['Data']).dt.dayofweek\ndf['dia'] = pd.to_datetime(df['Data']).dt.day","3d78d33e":"df.head()","bd10681c":"df[['Consumo_de_cerveja_litros']].describe()","c63f9b8a":"print(df.corr()['Consumo_de_cerveja_litros'].sort_values())","5c2b7a05":"plt.figure(figsize=(10,10));\nsns.heatmap(df.corr(), square=True ,annot=True, linewidths=1, linecolor='k');","f74558f5":"plt.figure(figsize=(12,6))\nsns.distplot(df['Consumo_de_cerveja_litros'],kde=False, bins=20);\nplt.xlabel('Consumo de cerveja litros')\nplt.title('\\nDistribui\u00e7\u00e3o de frequ\u00eancia\\n'.upper())\nplt.grid(ls='-.', lw=.5)","fd561b61":"plt.figure(figsize=(12,3))\nsns.boxplot(df['Consumo_de_cerveja_litros']);\nplt.xlabel('Consumo de cerveja litros')\nplt.xlim(10,40)\nplt.grid(ls='-.', lw=.5);","a3bdc135":"g = sns.FacetGrid(df, col='Final_de_Semana', hue='Final_de_Semana',\n                  height=5, aspect=1.5)\n\ng.map(sns.distplot,'Consumo_de_cerveja_litros', kde=False, bins=20);\n\ng.set_xlabels('Consumo de cerveja litros');","73e2e9b6":"dcc = df.groupby(['Final_de_Semana']).agg({'Consumo_de_cerveja_litros':['count','sum',\n                                                                  'mean','std',\n                                                                  'min','median',\n                                                                  'max']}).round(3)\n\ndcc","94e455d0":"f, ax = plt.subplots(1,2,figsize=(16, 6))\n\na = sns.boxplot(x = 'Final_de_Semana', y= 'Consumo_de_cerveja_litros', data=df, ax=ax[0]);\na.set_xlabel('Final de semana')\na.set_ylabel('Consumo de cerveja litros')\na.set_title('\\nConsumo de litros de cerveja\\n')\na.grid(ls='-.', lw=.5)\n\nb = sns.countplot(df['Final_de_Semana'], ax=ax[1]);\nb.set_xlabel('Final de semana')\nb.set_ylabel('quantidade')\nb.set_title('\\nQuantidade de dias\\n')\nb.set_ylim(0,300)\nb.grid(ls='-.', lw=.5)","493c29bc":"plt.figure(figsize=(6, 6))\n\nplt.pie(dcc['Consumo_de_cerveja_litros']['sum'],\n        labels=['Semama','Final de semana'],\n        autopct='%.2f%%',\n        explode=[0,0.05]);","9b455841":"plt.figure(figsize=(12, 6))\nsns.boxplot(x='mes', y='Consumo_de_cerveja_litros', data=df);\nplt.xlabel('M\u00eas')\nplt.ylabel('Consumo de cerveja litros')\nplt.title('Consumo de cerveja por m\u00eas')\nplt.grid(ls='-.', lw=0.2, c='k');","d83bcc2a":"df.groupby(['mes','Final_de_Semana']).agg({'Consumo_de_cerveja_litros':['count','sum',\n                                                                  'mean','std',\n                                                                  'min','median',\n                                                                  'max']}).round(3)","db6642b7":"sns.lmplot(x='Temperatura_Media_C', y='Consumo_de_cerveja_litros', hue='Final_de_Semana',\n           data=df, aspect=1.5, height=6);\n\nplt.xlabel('Temperatura Media \u00b0C')\nplt.ylabel('Consumo de cerveja litros')\nplt.grid(ls='-.', lw=.5);","c8e681f6":"f, ax = plt.subplots(1,2,figsize=(16, 6))\n\na = sns.boxplot(x= 'mes', y='Consumo_de_cerveja_litros', hue='Final_de_Semana', data=df, ax=ax[0])\na.set_ylabel('Consumo de cerveja litros')\na.set_xlabel('M\u00eas')\na.set_title('\\nConsumo de cerveja litros por m\u00eas\\n')\na.grid(ls='-.', lw=.5)\n\nb = sns.boxplot(x= 'mes', y='Temperatura_Media_C', data=df,hue='Final_de_Semana',ax=ax[1],);\nb.set_ylabel('Temperatura Media \u00b0C')\nb.set_xlabel('M\u00eas')\nb.set_title('\\nTemperatura Media \u00b0C por m\u00eas\\n')\nb.grid(ls='-.', lw=.5);\n","f9c21c6d":"sns.lmplot(x='Precipitacao_mm', y='Consumo_de_cerveja_litros', hue='Final_de_Semana',\n           data=df, aspect=1.5, height=6);\n\nplt.xlabel('Precipitacao mm')\nplt.ylabel('Consumo de cerveja litros')\nplt.xlim(-5,100)\nplt.grid(ls='-.', lw=.5);","a6eeb2a6":"plt.figure(figsize=(16,6))\n\nsns.lineplot(x='Data',y='Consumo_de_cerveja_litros', data=df,alpha=.5);\nsns.lineplot(x='Data',y=df['Consumo_de_cerveja_litros'].rolling(15).mean(), data=df,alpha=.5);\n\nplt.ylabel('Consumo de cerveja litros')\n\nplt.grid(ls='-.', lw=.5);","0e5567e6":"df.columns","c909019c":"plt.figure(figsize=(16, 6))\nsns.heatmap(df.pivot_table(values='Consumo_de_cerveja_litros', index='mes', columns='dia_semana'),\n            annot=True, fmt='.3f');\n\nplt.yticks(rotation=0);","83fe95d3":"plt.figure(figsize=(16, 6))\nsns.boxplot(x='dia', y='Consumo_de_cerveja_litros', data=df , hue='Final_de_Semana');\nplt.xlabel('Dia')\nplt.ylabel('Consumo de cerveja litros')\nplt.title('Consumo de cerveja por dia')\nplt.grid(ls='-.', lw=0.2, c='k');","52673009":"plt.figure(figsize=(16, 6))\nsns.heatmap(df.pivot_table(values='Consumo_de_cerveja_litros', index='mes', columns='dia'),\n            annot=False, fmt='.3f');\n\nplt.yticks(rotation=0);","38dc617a":"g = sns.FacetGrid(df, col='mes', col_wrap=2,\n                  aspect=1.5, height=5,hue='mes',\n                  sharex=False)\n\ng.map(sns.barplot,'dia','Consumo_de_cerveja_litros');","4bce18a8":"from sklearn.preprocessing import OneHotEncoder, StandardScaler\nfrom sklearn.metrics  import mean_squared_error,r2_score","d474cf37":"X = df.drop(['Data','Temperatura_Media_C','Consumo_de_cerveja_litros'],axis=1)\ny = df['Consumo_de_cerveja_litros'].values","efe377fa":"X.head()","974df84c":"oneH = OneHotEncoder(categorical_features=[3,4,5,6])\nsSC = StandardScaler()","dd2d54f9":"X = oneH.fit_transform(X).toarray()\nX = sSC.fit_transform(X)","52b568f3":"from sklearn.model_selection import train_test_split","8629aefb":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=42,shuffle=True )","984b6303":"def info(yTest_, pred_,sg = 'X'):\n    ''' Return resultados '''\n    \n    print(f'''\n{sg}    \n    \n{'-' * 65}\n          \nMean squared error | {mean_squared_error(yTest_,pred_)}\nr2 Score           | {r2_score(yTest_, pred_)}        \n          \n{'.' * 65}\ny-test max         | {y_test.max()}\ny-test min         | {y_test.min()}\ny-test mean        | {y_test.mean()} \ny-test var         | {y_test.var()}\n{'.' * 65}\n                \nPrediction {sg} max  | {pred_.max()}\nPrediction {sg} min  | {pred_.min()}\nPrediction {sg} Mean | {pred_.mean()}\nPrediction {sg} Var  | {pred_.var()}\n\n          \n{'-' * 65}\n''')","c47e1836":"def graficos(y, pred):\n    \n    # scatter\n    plt.figure(figsize=(12, 6))\n\n    plt.plot(y,y)\n    plt.scatter(pred,y, c='r', marker='o')\n    plt.legend(['Previs\u00e3o','Real'])\n    plt.grid(ls='-.', lw=0.2, c='k');\n    \n    # distplot\n    plt.figure(figsize=(12, 6))    \n    sns.distplot(y)\n    sns.distplot(pred)\n    plt.legend(['Previs\u00e3o','Real'])\n    plt.grid(ls='-.', lw=0.2, c='k')","110f2c0a":"from sklearn.linear_model import LinearRegression","a6a86543":"lR = LinearRegression()","01798310":"%time lR.fit(X_train,y_train)","e9f5d295":"%time pred_lR = lR.predict(X_test)","31b7452b":"info(y_test, pred_lR, 'LinearRegression') ","4db56243":"graficos(y_test, pred_lR)","d4a2f4f9":"from sklearn.neighbors import KNeighborsRegressor","8bfde179":"kNR = KNeighborsRegressor(n_neighbors=5)","2aa4f13c":"%time kNR.fit(X_train,y_train)","cd8c9d2b":"%time pred_kNR = kNR.predict(X_test)","a4cbacbd":"info(y_test, pred_kNR, 'KNeighborsRegressor') ","c592090d":"graficos(y_test, pred_kNR)","79fcda9a":"from sklearn.neural_network import MLPRegressor","cfe659a6":"mLPR = MLPRegressor(hidden_layer_sizes=(100,100,100,),tol=0.000000001,\n                         max_iter=1000,\n                         verbose=2)","d9915301":"%time mLPR.fit(X_train,y_train)","6215fd27":"%time pred_mLPR =mLPR.predict(X_test)","9ff549d5":"info(y_test, pred_mLPR, 'MLPRegressor')","843372c1":"graficos(y_test, pred_mLPR)","640e8bb9":"### KNeighborsRegressor","4108a843":"* Os dias de semana **\"0\"** possuem o consumo m\u00e9dio menor de \u00e1lcool por\u00e9m s\u00e3o respons\u00e1veis por 67.56% do volume de cerveja vendido no ano ","52c92d82":" - 0 - Dia de semana\n - 1 - Final de semana","8ae86999":"#### Resuldado ","6588d4ec":"#### Resuldado ","43f2f6be":"### Consumo de litros de cerveja por m\u00eas","dccf795c":"# Regress\u00e3o Linear","8d304a2a":"### Consumo de litros de cerveja aos  fins de semana versos dia de semana ","00388b0b":"# Beer Consumption - Sao Paulo","34cb6695":"- O gr\u00e1fico apresenta uma correla\u00e7\u00e3o  linear positiva entre o consumo de cerveja e a temperatura m\u00e9dia. \n<br>   **Nota:** O volume de litros de cerveja vendida em rela\u00e7\u00e3o a temperatura \u00e9 ainda maior nos fins de semana","71d9ec1b":"### MLPRegressor","697d5e30":"#### Resultados","6ae4a748":"### Influ\u00eancia da Temperatura","4a01ac86":"* O consumo de cerveja aos fins de semana **\"1\"** \u00e9 relativamente maior do que o consumo durante a semana. Por\u00e9m os fins-de-semana correspondem a 104 dias do total de 365 dias do ano. ","6aacd578":"### LinearRegression"}}