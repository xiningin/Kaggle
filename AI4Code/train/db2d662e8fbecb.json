{"cell_type":{"c6f456cb":"code","5d5b730d":"code","554fde75":"code","b4fc712f":"code","28f71292":"code","85d9d7a2":"code","da395547":"code","263b633b":"code","1098ec94":"code","03f8c0ac":"code","14f39e3a":"code","13ba6803":"code","28631f53":"code","f8f66949":"code","42194178":"code","c48aca08":"code","67e93cb7":"code","a24b597a":"code","7a7db1ab":"code","1eda3931":"code","ecdceee4":"code","5ea24d95":"code","48dfeda0":"code","7c6d70d8":"code","a43fd391":"code","74f4a773":"code","06f1be9b":"code","b1f8d641":"code","fd1f5c18":"code","66360324":"code","89a9bbe1":"code","d532e1d5":"code","ace100f8":"code","03491821":"markdown","4856f757":"markdown","683463ff":"markdown","a58a459e":"markdown","38999d93":"markdown","f05d568d":"markdown","c9cd2bd4":"markdown","ecd8566f":"markdown","1a445c10":"markdown"},"source":{"c6f456cb":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n","5d5b730d":"df=pd.read_csv('..\/input\/jobathon-may-2021-credit-card-lead-prediction\/train.csv')\ntest=pd.read_csv('..\/input\/jobathon-may-2021-credit-card-lead-prediction\/test.csv')","554fde75":"df.isna().sum()","b4fc712f":"test.isna().sum()","28f71292":"df.fillna('Others', inplace=True)\n","85d9d7a2":"df.Avg_Account_Balance=pd.qcut(df.Avg_Account_Balance, q=10, labels=[0,1,2,3,4,5,6,7,8,9])\ndf.head(10)","da395547":"from sklearn.preprocessing import LabelEncoder\nle = LabelEncoder()\ndf['Gender'] = le.fit_transform(df['Gender'])\ndf['Region_Code'] = le.fit_transform(df['Region_Code'])\ndf['Occupation'] = le.fit_transform(df['Occupation'])\ndf['Channel_Code'] = le.fit_transform(df['Channel_Code'])\ndf['Credit_Product'] = le.fit_transform(df['Credit_Product'])\ndf['Is_Active'] = le.fit_transform(df['Is_Active'])","263b633b":"df.isna().sum()","1098ec94":"df.to_csv('train_extracted.csv',index=False)","03f8c0ac":"!pip install xlrd","14f39e3a":"pip install autoviz\n","13ba6803":"from autoviz.AutoViz_Class import AutoViz_Class\n\nAV = AutoViz_Class()","28631f53":"filename = \".\/train_extracted.csv\"\nsep = \",\"\ndft = AV.AutoViz(\n    filename,\n    sep=\",\",\n    depVar=\"\",\n    dfte=None,\n    header=0,\n    verbose=0,\n    lowess=False,\n    chart_format=\"svg\",\n    max_cols_analyzed=30,\n)\n","f8f66949":"train=pd.read_csv('.\/train_extracted.csv')\n","42194178":"train=train[train.Avg_Account_Balance<train.Avg_Account_Balance.quantile(0.99)]\ntrain.isna().sum()","c48aca08":"train.fillna('Others', inplace=True)","67e93cb7":"del train['ID']","a24b597a":"test.Credit_Product.fillna('Others', inplace=True)\n","7a7db1ab":"test.Avg_Account_Balance=pd.qcut(test.Avg_Account_Balance, q=10, labels=[0,1,2,3,4,5,6,7,8,9])","1eda3931":"test['Gender'] = le.fit_transform(test['Gender'])\ntest['Region_Code'] = le.fit_transform(test['Region_Code'])\ntest['Occupation'] = le.fit_transform(test['Occupation'])\ntest['Channel_Code'] = le.fit_transform(test['Channel_Code'])\ntest['Credit_Product'] = le.fit_transform(test['Credit_Product'])\ntest['Is_Active'] = le.fit_transform(test['Is_Active'])","ecdceee4":"test.to_csv('test_extracted.csv',index=False)","5ea24d95":"sub_df=pd.read_csv('.\/test_extracted.csv')","48dfeda0":"sub_df.isna().sum()","7c6d70d8":"sub_df.fillna('NA', inplace=True)","a43fd391":"X=train.drop(columns=['Is_Lead'],axis=1)\ny=train.Is_Lead","74f4a773":"from sklearn.model_selection import train_test_split\nfrom sklearn.metrics import roc_auc_score\n","06f1be9b":"X_train, X_test, y_train, y_test=train_test_split(X,y, test_size=0.30, random_state=42,) #stratify=y)","b1f8d641":"from sklearn.ensemble import BaggingClassifier\nimport xgboost as xgb\n\nfrom lightgbm import LGBMClassifier\nfrom catboost import CatBoostClassifier\nmodel = BaggingClassifier(base_estimator=LGBMClassifier(boosting_type='gbdt',\n                                                class_weight=None,\n                                                colsample_bytree=1.0,\n                                                importance_type='split',\n                                                learning_rate=0.1, max_depth=-1,\n                                                min_child_samples=20,\n                                                min_child_weight=0.001,\n                                                min_split_gain=0.0,\n                                                n_estimators=100, n_jobs=-1,\n                                                num_leaves=31, objective=None,\n                                                random_state=123, reg_alpha=0.0,\n                                                reg_lambda=0.0, silent=True,\n                                                subsample=1.0,\n                                                subsample_for_bin=200000,\n                                                subsample_freq=0),\n                  bootstrap=True, bootstrap_features=False, max_features=1.0,\n                  max_samples=1.0, n_estimators=10, n_jobs=1, oob_score=False,\n                  random_state=123, verbose=0, warm_start=False)\n\nmodel.fit(X_train, y_train)\nmodel.score(X_test, y_test)","fd1f5c18":"roc_auc_score(y_true=y_test, y_score=model.predict_proba(X_test)[:, 1])","66360324":"data = model.predict_proba(sub_df.loc[:, sub_df.columns != 'ID'])\nvalues = pd.DataFrame({'class_0': data[:, 0], 'class_1': data[:, 1]})","89a9bbe1":"sub_df['Is_Lead']=values['class_1']","d532e1d5":"sub_df","ace100f8":"sub_df[['ID','Is_Lead']].to_csv('sub.csv', index=False)","03491821":"**Loading the dataset**","4856f757":"# Removing the outliers","683463ff":"**Credit Card Lead Prediction**\n\nHappy Customer Bank is a mid-sized private bank that deals in all kinds of banking products, like Savings accounts, Current accounts, investment products, credit products, among other offerings.\n\n\n\nThe bank also cross-sells products to its existing customers and to do so they use different kinds of communication like tele-calling, e-mails, recommendations on net banking, mobile banking, etc. \n\n\n\nIn this case, the Happy Customer Bank wants to cross sell its credit cards to its existing customers. The bank has identified a set of customers that are eligible for taking these credit cards.\n\n\n\nNow, the bank is looking for your help in identifying customers that could show higher intent towards a recommended credit card, given:\n\nCustomer details (gender, age, region etc.)\nDetails of his\/her relationship with the bank (Channel_Code,Vintage, 'Avg_Asset_Value etc.)","a58a459e":"**Label Encoding of the data**","38999d93":"# As the Average account balance is continuous in nature and the data is wide spread combining them into 10 bins to use them as categories","f05d568d":"# Data Visualization using AutoViz","c9cd2bd4":"### Test data","ecd8566f":"# **Filling the nan values to others as the bank is unaware if the Customer has any active credit product**","1a445c10":"# Data split and model building"}}