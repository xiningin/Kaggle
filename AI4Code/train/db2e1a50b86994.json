{"cell_type":{"1a893a92":"code","737dd084":"code","d10250e6":"code","d344794b":"code","bdf7e1bd":"code","e6f4aae6":"code","949d18f1":"code","c8b1665c":"code","cbf4b606":"code","375bcf19":"code","277997ff":"code","4717f67c":"code","edacd9a6":"code","61c30a89":"code","cdbc6b04":"code","ce5042fa":"code","6f4437d8":"code","8df7af1c":"code","8df932fd":"code","e81503c7":"code","05477a02":"code","b5c457c5":"code","e287860b":"code","09fdd6c4":"markdown","3a3cbc22":"markdown","04fbff78":"markdown","ebdd8cfb":"markdown","662c7311":"markdown","1b301c7d":"markdown","274a518c":"markdown","042fd7a7":"markdown","826b066b":"markdown","e4c649a0":"markdown","df18cf5b":"markdown","98957bcf":"markdown","a9599528":"markdown","b53ef3d3":"markdown","26704ace":"markdown","78cb57b0":"markdown","33d6e861":"markdown","4bc51246":"markdown","db829620":"markdown","b4758e29":"markdown"},"source":{"1a893a92":"import pandas as pd  \nimport matplotlib.pyplot as plt\nfrom sklearn import preprocessing ","737dd084":"# Read the dataset \ntent_sales = pd.read_csv('..\/input\/sales_data.csv')  \ntent_sales.head()","d10250e6":"tent_sales.shape","d344794b":"tent_sales.describe()","bdf7e1bd":"plt.figure(figsize=(10, 7))\npd.value_counts(tent_sales['IS_TENT']).plot.bar()\nplt.show()","e6f4aae6":"plt.figure(figsize=(10, 7))\npd.value_counts(tent_sales['MARITAL_STATUS']).plot.bar()\nplt.show()","949d18f1":"plt.figure(figsize=(10, 7))\npd.value_counts(tent_sales['GENDER']).plot.bar()\nplt.show()","c8b1665c":"plt.figure(figsize=(10, 7))\npd.value_counts(tent_sales['PROFESSION']).plot.bar()\nplt.show()","cbf4b606":"# Gender Column \ngender = ['M','F'] \n\nlabel_encoding = preprocessing.LabelEncoder()\n\n'''\nThis will generate a unique ID for Male and \na unique ID for Female. \n'''\nlabel_encoding = label_encoding.fit(gender)","375bcf19":"tent_sales['GENDER'] = label_encoding.transform(tent_sales['GENDER'].astype(str))","277997ff":"# Shows the categories that have been encoded.\nlabel_encoding.classes_","4717f67c":"tent_sales.sample(10)","edacd9a6":"# Marital Status Column \ntent_sales['MARITAL_STATUS'].unique()","61c30a89":"one_hot_encoding = preprocessing.OneHotEncoder()\none_hot_encoding = one_hot_encoding.fit(tent_sales['MARITAL_STATUS'].values.reshape(-1, 1))","cdbc6b04":"one_hot_encoding.categories_","ce5042fa":"one_hot_labels = one_hot_encoding.transform(\n                tent_sales['MARITAL_STATUS'].values.reshape(-1,1)).toarray()\none_hot_labels","6f4437d8":"labels_df = pd.DataFrame()\n\nlabels_df['MARITAL_STATUS_Married'] = one_hot_labels[:,0]\nlabels_df['MARITAL_STATUS_Single'] = one_hot_labels[:,1]\nlabels_df['MARITAL_STATUS_Unspecified'] = one_hot_labels[:,2]\n\nlabels_df.head(10)","8df7af1c":"encoded_df = pd.concat([tent_sales, labels_df], axis=1)\nencoded_df.drop('MARITAL_STATUS', axis=1, inplace=True)","8df932fd":"encoded_df.sample(10)","e81503c7":"# Marital Status Column \ntent_sales['PROFESSION'].unique()","05477a02":"tent_sales = pd.get_dummies(encoded_df, columns=['PROFESSION'])\ntent_sales.sample(10)","b5c457c5":"# Read the dataset \ntent_sales = pd.read_csv('..\/input\/sales_data.csv')  \ntent_sales.head()","e287860b":"'''\nEncode all of the categorical features while removing \nall the original categorical features.\n'''\ntent_sales = pd.get_dummies(tent_sales)\ntent_sales.sample(10)","09fdd6c4":"The encoded columns are Married, Single and Unspecified. \nWe need to get **MARITAL STATUS** in one hot encoding form by calling transform on the same column. The one hot encoder expects the input feature to be in two dimensions, so we need to reshape the values of that column to be two dimensional. ","3a3cbc22":"# Convert Categorical Data to Numerical data \nThe goal of this notebook is to help you understand two different methods of converting categorical data to numerical data.  \nFirst of all, we are going to understand how those technic work by implementing manually and then apply the existing functions \nthat can get the job done easily.  ","04fbff78":"We can notice that over 50.000 customers did not purchase a tent. ","ebdd8cfb":"Our customers are distributed between males and females. Over 30000 of them are males and the others are female. ","662c7311":"We can now see that the Gender column have been transformed. \nWhen we are using more than 2 categories in our features, then after label encoding the sklearn estimators could understand that there are some specific orders. This is not a problem when we are using binary categories. But we must be careful while using more than 2 categories. ","1b301c7d":"Categorical features are not understood by machine learning models, we need to encode them into numeric form. So, we will encode all the categorical columns. The encoding technics will be performed using both **label and one hot** encoders.","274a518c":"We see that the marital status has three categories. We also know that there is not a specific order in our categories (Married > Single > Unspecified). So, using a label encoder might not be a good solution. \nThe solution here is to use **One hot Encoding** ","042fd7a7":"Our dataframe has MARITAL_STATUS and GENDER columns in the right encoded format. ","826b066b":"We can notice that our dataset has many categorical features: Gender, Marital Status Profession. Using this dataset involves predicting if the customer purchased a tent or not, given by the **IS_TENT** column.","e4c649a0":"* **F** will be represented using the numeric integer **0** \n* **M** will be represented using the integer **1**.","df18cf5b":"Most of our customers have characterised their profession as others. some are in Sales, some are Executives and few are retired.  ","98957bcf":"We can now see that the **PROFESSION** column has been automatically one hot encoded while removing the original column. ","a9599528":"Here, we can see that each category is represented using one hot encoding. \n* The first column represents the Married status  \n* The second column represents the Single status  \n* The third column represents the Unspecified status  \n\nThe one hot encoded values are in the form of a numpy array, now we are going to assign these as columns in our dataframe.  ","b53ef3d3":"Now, we can drop the origial categorical column MARITAL_STATUS. ","26704ace":"Most of the customers are married, many are single, and few have not specified their marrital status. ","78cb57b0":"label encoder generate a numeric identifier starting with zero. ","33d6e861":"#### Some Visualization   \nWe are going to perform some visualizations before we move forward for processing.","4bc51246":"We manually used this technic in order to understand the process. But the easiest way to one hot encode our categorical features is to use **pd.get_dummies** function by giving the corresponding column. ","db829620":"### Let's restart using pd.getdummies()   \nWe are going to re-read the dataset in order to apply the pd.getdummies() function. ","b4758e29":"The average age of customers is around 34 years and the standard deviation is around 10.  "}}