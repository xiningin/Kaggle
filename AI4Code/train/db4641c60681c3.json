{"cell_type":{"2bd82b91":"code","e692d69d":"code","fd60bdd2":"code","858a57e5":"code","f6146522":"code","e94639b1":"code","3ce5efd2":"code","c9bf080f":"code","9575b2a7":"code","54fcd704":"code","3ae8e5fc":"code","6ad447db":"code","1d67aa3b":"code","c0e1030e":"code","7b9dd05c":"code","8ff2339a":"code","5444961b":"code","ef5893d9":"code","80cd3a41":"code","bff0d193":"code","a2968d54":"code","2565a4cf":"code","486de697":"code","13725c10":"code","00b4f1dc":"code","e6632da7":"code","9ffff3d3":"code","f8367cce":"code","2478a215":"code","43972e67":"code","5d3a00bb":"code","be52d5ca":"markdown","7b79f794":"markdown","d563fe66":"markdown","684a05c4":"markdown","54c1c764":"markdown","15eae8d7":"markdown","6a2042f4":"markdown","c6048a60":"markdown","9c52aef6":"markdown","edff2012":"markdown","6d60c138":"markdown","d84d82c2":"markdown","7ef2ea43":"markdown","d20d7176":"markdown","6736817a":"markdown","cc5c4284":"markdown","87cd538c":"markdown","6e91a873":"markdown","8ea4294a":"markdown","fc725d31":"markdown","2c485a54":"markdown","5d56df9e":"markdown","d9b2da74":"markdown","8089798d":"markdown","bb6ed2b1":"markdown","ff58cf8d":"markdown","4781ae56":"markdown"},"source":{"2bd82b91":"#importing libraries\n\nimport pandas as pd, numpy as np, matplotlib.pyplot as plt, seaborn as sns\nimport warnings\nwarnings.filterwarnings('ignore')","e692d69d":"# reading the file\n\ndataset= pd.read_csv('..\/input\/clicks-conversion-tracking\/KAG_conversion_data.csv')","fd60bdd2":"dataset.info()","858a57e5":"dataset.head()","f6146522":"dataset.describe().T","e94639b1":"categorical_features=[ x for x in dataset.columns if dataset[x].dtype == 'O']\ncategorical_features","3ce5efd2":"#finding count of different elements in the column\n\nfor x in categorical_features:\n    abc = dataset[x].value_counts()\n    print(abc)","c9bf080f":"for i in categorical_features:\n    sns.countplot(dataset[i], hue= dataset[i])\n    plt.ylim(0,650)\n    plt.legend(loc='upper right', facecolor='yellow', framealpha=0.5, bbox_to_anchor=(1.2,1))\n    plt.show()","9575b2a7":"categorical_features_with_nan = [x for x in categorical_features if dataset[x].isnull().sum()>0]\ncategorical_features_with_nan","54fcd704":"numerical_features = [x for x in dataset.columns if x not in categorical_features]\nnumerical_features","3ae8e5fc":"numerical_features_with_nan = [x for x in numerical_features if dataset[x].isnull().sum()>0]\nnumerical_features_with_nan","6ad447db":"fig= plt.figure(figsize=(11,10))\n\ndataset.groupby(categorical_features)['Clicks','Spent'].mean().plot.bar()\nplt.title('Average clicks\/money spent vs Male\/Female of different age groups', fontweight=\"bold\")\nplt.ylabel('count')\n\nplt.show()","1d67aa3b":"fig= plt.figure(figsize=(15,10))\n\ndataset.groupby('Total_Conversion')['Spent'].mean().plot.barh()\nplt.title('Average Money spent vs Ads Enquiry', fontweight=\"bold\")\nplt.ylabel('Ads enquiry')\n\nabc= round(dataset.groupby('Total_Conversion')['Spent'].mean(),2)\n\nfor index, value in enumerate(abc):\n    plt.text(value, index, str(value))       ","c0e1030e":"fig= plt.figure(figsize=(9,10))\n\nvalue=[dataset['Total_Conversion'].mean(), dataset['Approved_Conversion'].mean()]\nlabels= ['Enquiry of product', 'Buying the product']\nplt.pie(value, labels = labels, autopct='%.2f%%')\n\nplt.show()","7b9dd05c":"fig= plt.figure(figsize=(12,10))\n\ndataset.groupby(['Approved_Conversion'])['Impressions'].mean().plot.barh()\nxyz=round(dataset.groupby(['Approved_Conversion'])['Impressions'].mean(),2)\nplt.title('Average Impressions vs Product Bought', fontweight=\"bold\")\n\n#to put the value above the bar\nfor index, value in enumerate(xyz):\n    plt.text(value, index, str(value))","8ff2339a":"women= dataset[dataset['gender']=='F']\nmen= dataset[dataset['gender']=='M']\n\nmen_abv_avg_Impression = men[men['Impressions']>dataset['Impressions'].mean()]\nwomen_abv_avg_Impression = women[women['Impressions']>dataset['Impressions'].mean()]\n\nmen_below_avg_Impression = men[men['Impressions']<dataset['Impressions'].mean()]\nwomen_below_avg_Impression = women[women['Impressions']<dataset['Impressions'].mean()]","5444961b":"fig, (ax1,ax2) = plt.subplots(2,1, figsize=(8,9))\n\nsns.distplot(men_abv_avg_Impression.Clicks, bins=10, kde= False, label= 'men_Clicks', ax= ax1)\nsns.distplot(women_abv_avg_Impression.Clicks, bins=10, kde= False, label= 'women_Clicks', ax= ax1)\nax1.legend()\nax1.set_ylabel('count')\nax1.set_title('Above average impression vs Clicks', fontweight=\"bold\", fontname=\"Times New Roman\", size=28)\n\nsns.distplot(men_below_avg_Impression.Clicks, bins=10, kde= False, label= 'men_Clicks', ax= ax2)\nsns.distplot(women_below_avg_Impression.Clicks, bins=10, kde= False, label= 'women_Clicks', ax= ax2)\nax2.set_ylabel('count')\nax2.set_title('Below average impression vs Clicks', fontweight=\"bold\", fontname=\"Times New Roman\", size=28)\nax2.legend()\n\nplt.tight_layout()\nplt.show()","ef5893d9":"#removig the 'id' columns from the dataset\nnumerical_features_new = [x for x in numerical_features if '_id' not in x]\nnumerical_features_new","80cd3a41":"from sklearn.preprocessing import LabelEncoder\nle= LabelEncoder()\n\nfor x in categorical_features:\n    dataset[x]= le.fit_transform(dataset[x])\n    print(x, le.classes_)","bff0d193":"for i in numerical_features_new:\n    sns.distplot(dataset[i])\n    plt.title(i)\n    plt.ylabel('Count')\n    plt.show()","a2968d54":"from sklearn.preprocessing import StandardScaler\nscale= StandardScaler()\ndataset_scaled = pd.DataFrame(scale.fit_transform(dataset) ,columns = dataset.columns)","2565a4cf":"fig= plt.figure(figsize=(12,10))\n\nsns.heatmap(dataset_scaled.corr().abs() , annot= True)","486de697":"data= dataset_scaled.copy()\ndata= data[['Impressions', 'Clicks', 'Spent']]","13725c10":"from sklearn.cluster import KMeans\nfrom sklearn.metrics import silhouette_score\n\ninertia= []\nk= np.arange(1,9)\nfor i in k:\n    model = KMeans(n_clusters= i, max_iter=5)\n    ab = model.fit(data.values)\n    inertia.append(pd.Series({'k': i,\n                              'inertia': model.inertia_\n                             }))","00b4f1dc":"inertias= pd.concat(inertia, axis=1).T.set_index('k')\ninertias","e6632da7":"# Plot k vs inertias\n\nplt.figure(figsize=(12,6))\nplt.plot(inertias.index, inertias['inertia'], '-*')\nplt.title('Best k using Elbow method')\nplt.xlabel('number of clusters, k')\nplt.ylabel('inertia')\nplt.xticks(k)\nplt.show()","9ffff3d3":"score=[]\nk= np.arange(2,9)\nfor i in k:\n    model = KMeans(n_clusters= i, max_iter=5)\n    pred = model.fit_predict(data.values)\n    sil_score= silhouette_score(data.values, pred)\n    score.append(pd.Series({'k': i,\n                            'Score': sil_score\n                             }))","f8367cce":"result= pd.concat(score, axis=1).T.set_index('k')\nresult","2478a215":"model = KMeans(n_clusters= 2, max_iter=5)\nmodel.fit(data.values)","43972e67":"data['Score']= model.predict(data.values)\ndata.sample(5)","5d3a00bb":"sns.lmplot(x='Impressions', y='Clicks', data= data, hue='Score',fit_reg=False, markers=[\"o\", \"^\"] ,palette='Set1')\nsns.lmplot(x='Spent', y='Clicks', data= data, hue='Score',fit_reg=False, markers=[\"o\", \"^\"], palette=\"ocean\" )\nsns.lmplot(x='Impressions', y='Spent', data= data, hue='Score',fit_reg=False, markers=[\"o\", \"^\"] ,palette=\"cool\" )\nplt.show()","be52d5ca":"From the above table, it is clear that k=2 i.e. , two yields the best result so we'll choose it.","7b79f794":"#### b) Numerical","d563fe66":"#### Bringing down all the values to same scale(between 0 to 1)","684a05c4":"From the above codes, we can conclude that this data has 'NO NULL' value.","54c1c764":"Around 3\/4th of the people only enquires about the products seen via ads but only 1\/4th people buys it.","15eae8d7":"### Separating 'Categorical' and 'Numerical' columns ","6a2042f4":"## DATA VISUALISATION","c6048a60":"### Keeping only the related columns","9c52aef6":"The 'numerical_features_with_nan' list shows that there is null value present in the categorical columns.","edff2012":"#### Insights from above graph:\n\nWhen the company spent an average of \n\n1) $10-200 on Ads, then, they got 120 Ads enquiry in return.\n\n2) $200-400 on Ads, then, they got 319 Ads enquiry in return.\n\n3) > $400 on Ads, then, they got 114 Ads enquiry in return.\n\nWe can conclude that spending between $200-400 on Ads seems reasonable for any company because it yields the max Ads enquiry.","6d60c138":"There are only 2 categorical columns namely, age and gender.","d84d82c2":"#### a) Categorical ","7ef2ea43":"### Visualisation of the result","d20d7176":"#### Giving numerical value to the categorical values by using LabelEncoder\n","6736817a":"#### Finding the Correlation","cc5c4284":"# Data Exploration","87cd538c":"#### Insights:\nWhen the ads were shown more than 1300000 times, a total of 68 products were bought by the people, and,\n\n64 products were sold when the Impressions were less than 1300000.\n\ni.e. More impression implies more publicity and thus more people will buy it.","6e91a873":"## Applying algorithm (kmeans)","8ea4294a":"#### Separating data in 2 parts(men and women)\n ","fc725d31":"From the above graph, we can depict that females of every age clicked on the Ads the most compared to men of same age group. \n\nAnd money was also spent more on females of every age group.","2c485a54":"From the above elbow graph, we can see that for k=2, inertia drops with a high rate, so, we can choose k=2 or k=3 (to be on the safe side).","5d56df9e":"The 'categorical_features_with_nan' list shows that there is null value present in the categorical columns.","d9b2da74":"A Silhouette score of :\n\n1) -1 shows BAD CLUSTERING,\n\n2) 0 shows CLUSTERS ARE OVERLAPPED,\n\n3) 1 or >1 shows GOOD CLUSTERING.","8089798d":"When women were shown ads more than the above average amount, they tend to click on it more often than men, \nwho were shown the same amount of ads.\n\nWhen women were shown ads less than the above average amount, then number of clicks fell drastically for both men and women, but women still clicked more than men did.","bb6ed2b1":"# About this data\n### Source: https:\/\/www.kaggle.com\/loveall\/clicks-conversion-tracking\n\n1.) ad_id: an unique ID for each ad.\n\n2.) xyzcampaignid: an ID associated with each ad campaign of XYZ company.\n\n3.) fbcampaignid: an ID associated with how Facebook tracks each campaign.\n\n4.) age: age of the person to whom the ad is shown.\n\n5.) gender: gender of the person to whim the add is shown\n\n6.) interest: a code specifying the category to which the person\u2019s interest belongs (interests are as mentioned in the person\u2019s Facebook public profile).\n\n7.) Impressions: the number of times the ad was shown.\n\n8.) Clicks: number of clicks on for that ad.\n\n9.) Spent: Amount paid by company xyz to Facebook, to show that ad.\n\n10.) Total conversion: Total number of people who enquired about the product after seeing the ad.\n\n11.) Approved conversion: Total number of people who bought the product after seeing the ad.","ff58cf8d":"Lesser the inertia better the result.\n\nBut, we can see the drop in inertia from k=1 to k=2 and k=2 to k=3 is much greater.\n\nThough, inertia decreases with increase in k, but the rate is very low.","4781ae56":"Plotting the categorical variable to check the count of each element in it."}}