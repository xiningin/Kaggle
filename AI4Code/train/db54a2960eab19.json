{"cell_type":{"1a3222cd":"code","3f9cc5c8":"code","47c58926":"code","b560447e":"code","a760d81d":"code","5b6e575b":"code","71838e54":"code","a9c2e61c":"code","ecd0373c":"code","46301167":"code","8869d1cc":"code","8f31b1cd":"code","c7c4d271":"code","3d846425":"code","fcbf9115":"code","2231a650":"code","2211dc34":"code","c12ae45d":"code","ad912413":"code","9def5768":"code","b060a976":"code","744a0da3":"code","0e3fc8e3":"code","7fc27214":"code","4a79f630":"code","c5f194eb":"code","5e150e46":"code","dc93b8cb":"code","78aa34fc":"code","ccc11d74":"code","97fb73f4":"code","207b2987":"code","e760a0a6":"code","02bac0c9":"code","c691047c":"code","7492bf5e":"code","57c84457":"code","b217f598":"code","7cee5b8e":"code","dcac01a7":"markdown","87240823":"markdown","96f7a4f4":"markdown","8a65203f":"markdown","edda19f9":"markdown","75090477":"markdown","b5440c8a":"markdown","37b7ed71":"markdown","c78b122e":"markdown","fcd6cb5a":"markdown","f54f2687":"markdown","31796aca":"markdown","2e590161":"markdown"},"source":{"1a3222cd":"\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport cv2\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\nimport os","3f9cc5c8":"\n\ntrain_dir = '\/kaggle\/input\/deepfake-detection-challenge\/train_sample_videos\/'\ntrain_video_files = [train_dir + x for x in os.listdir(train_dir)]\ntest_dir = '\/kaggle\/input\/deepfake-detection-challenge\/test_videos\/'\ntest_video_files = [test_dir + x for x in os.listdir(test_dir)]\n\n","47c58926":"df_train = pd.read_json('\/kaggle\/input\/deepfake-detection-challenge\/train_sample_videos\/metadata.json').transpose()\ndf_train.head()","b560447e":"df_train.shape # We have 400 videos ","a760d81d":"df_train.original.nunique()  # from this aprox 209 originals create 400, would be the same video? lest check soon","5b6e575b":"df_train.label.value_counts()","71838e54":"df_train.label.value_counts().plot.bar()","a9c2e61c":"df_train.label.value_counts(normalize=True) # Check that aprox 80% are fake","ecd0373c":"df_train['original'].value_counts()","46301167":"df_train[df_train['original']=='meawmsgiti.mp4']  # Looking the same files of videos","8869d1cc":"video1= train_dir + 'akxoopqjqz.mp4'  \nvideo2 =train_dir + 'altziddtxi.mp4'\nvideo3 = train_dir+ 'arlmiizoob.mp4'","8f31b1cd":"def display_img(video):\n    cap = cv2.VideoCapture(video)  # take 1 picture\n    ret, frame = cap.read()\n    fig = plt.figure(figsize=(8,8))\n    ax = fig.add_subplot(111)\n    frame = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)\n    ax.imshow(frame)","c7c4d271":"display_img(video1)","3d846425":"display_img(video2)\n","fcbf9115":"display_img(video3)  # lets check this picture ","2231a650":"first_Video = train_video_files[8]\nfirst_Video","2211dc34":"name_video = first_Video.split('\/', 5)[5] # I will use this funtion soon","c12ae45d":"df_train[df_train.index == name_video] ","ad912413":"count = 0\ncap = cv2.VideoCapture(first_Video)\nret,frame = cap.read()\n\nwhile count < 3:\n    cap.set(cv2.CAP_PROP_POS_MSEC,(count*1000))   \n    ret,frame = cap.read()\n    if count == 0:\n        image0 = frame\n    elif count == 1:\n        image1 = frame\n    elif count == 2:\n        image2 = frame\n    \n    #cv2.imwrite( filepath+ \"\\frame%d.jpg\" % count, image)     # Next I will save frame as JPEG\n    count = count + 1","9def5768":"def display(img):\n    \n    fig = plt.figure(figsize=(8,8))\n    ax = fig.add_subplot(111)\n    img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)\n    ax.imshow(img)","b060a976":"display(image0)  # frame 1","744a0da3":"display(image1) # frame 2","0e3fc8e3":"display(image2) # frame 3","7fc27214":"# You need to Download or add this file to your notebook, Check in the input files\n\nface_cascade = cv2.CascadeClassifier('\/kaggle\/input\/cascade\/haarcascade_frontalface_default.xml' ) # Cascade for faces","4a79f630":"def detect_face(img):\n    \n    face_img = img.copy()\n  \n    face_rects = face_cascade.detectMultiScale(face_img,scaleFactor=1.3, minNeighbors=5) \n    \n    for (x,y,w,h) in face_rects: \n        cv2.rectangle(face_img, (x,y), (x+w,y+h), (0,255,0), 10) \n        \n    return face_img","c5f194eb":"result = detect_face(image2)","5e150e46":"display(result)","dc93b8cb":"second_Video= train_video_files[10]\n","78aa34fc":"name_video2 = second_Video.split('\/', 5)[5] # I will use this funtion soon\nname_video2","ccc11d74":"df_train[df_train.index == name_video2] ","97fb73f4":"\ncount = 0\ncap = cv2.VideoCapture(second_Video)\nret,frame = cap.read()\n\nwhile count < 5:\n    cap.set(cv2.CAP_PROP_POS_MSEC,(count*1000))   \n    ret,frame = cap.read()\n    if count == 0:\n        image0 = frame\n    elif count == 1:\n        image1 = frame\n    elif count == 2:\n        image2 = frame\n    elif count == 3:\n        image3 = frame\n    elif count == 4:\n        image4 = frame\n    \n    #cv2.imwrite( pathOut + \"\\\\frame%d.jpg\" % count, image)     # Next I will save frame as JPEG\n    count = count + 1","207b2987":"image = detect_face(image0)\ndisplay(image)","e760a0a6":"image = detect_face(image2)\ndisplay(image)","02bac0c9":"image = detect_face(image3)\ndisplay(image)","c691047c":"def ROI(img):\n    \n    face_img = img.copy()\n  \n    face_rects = face_cascade.detectMultiScale(face_img,scaleFactor=1.3, minNeighbors=5) \n    \n    for (x,y,w,h) in face_rects: \n        roi = face_img[y:y+h,x:x+w] \n        \n        \n    return roi","7492bf5e":"image = ROI(image3)\ndisplay(image)","57c84457":"def ROI_Expand(img):\n    \n    offset = 50  # play around this value\n    \n    face_img = img.copy()\n  \n    face_rects = face_cascade.detectMultiScale(face_img,scaleFactor=1.3, minNeighbors=5) \n    \n    for (x,y,w,h) in face_rects: \n        roi = face_img[y-offset:y+h+offset,x-offset:x+w+offset] \n        \n        \n    return roi","b217f598":"image = ROI_Expand(image3)\ndisplay(image)","7cee5b8e":"submission = pd.read_csv(\"\/kaggle\/input\/deepfake-detection-challenge\/sample_submission.csv\")\nsubmission['label'] = 0.5 # \nsubmission.to_csv('submission.csv', index=False)","dcac01a7":"**<a id=\"1\"><\/a> <br>**\n## 1- Import","87240823":"<div class=\"alert alert-success\">  Lets Check the region of interest\n\n<\/div>","96f7a4f4":"<a id=\"top\"><\/a> <br>\n## Notebook  Content\n\n1. [Import](#1)\n1. [Load Data](#2)\n1. [Display images](#3)\n1. [TAke some frames](#4)\n1. [Face Detection](#5)\n1. [Region Of interest](#6)\n1. [Example of Submission](#7)\n\n","8a65203f":"**<a id=\"5\"><\/a> <br>**\n## 5- Face Detection","edda19f9":"**<a id=\"6\"><\/a> <br>**\n## 6- Create a Region of Interest (ROI)*","75090477":"**<a id=\"4\"><\/a> <br>**\n## 4- take some Frames","b5440c8a":"## <div style=\"text-align: center\"> First Impression about Deepfake Detection Challenge\n\n<\/div>\n<img src=\"http:\/\/www.unidiversidad.com.ar\/cache_2\/deepfakevide_630_945.jpg\">\n\nDeepfake techniques, which present realistic AI-generated videos of people doing and saying fictional things, have the potential to have a significant impact on how people determine the legitimacy of information presented online. These content generation and modification technologies may affect the quality of public discourse and the safeguarding of human rights\u2014especially given that deepfakes may be used maliciously as a source of misinformation, manipulation, harassment, and persuasion. Identifying manipulated media is a technically demanding and rapidly evolving challenge that requires collaborations across the entire tech industry and beyond.\n","37b7ed71":"**<a id=\"7\"><\/a> <br>**\n## 7- Example of Submission*","c78b122e":"**<a id=\"3\"><\/a> <br>**\n## 3- Display Images","fcd6cb5a":"## Expand Region of interest","f54f2687":"**<a id=\"2\"><\/a> <br>**\n## 2- Load Data","31796aca":"# Start working with simple video","2e590161":"## I hope this notebook **helpfull** for you\n\n"}}