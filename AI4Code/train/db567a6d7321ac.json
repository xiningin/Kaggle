{"cell_type":{"d2a1875a":"code","b8255655":"code","da8b67dd":"code","69aaaeb2":"code","76c33ba0":"code","ad338e91":"code","0c7768c2":"code","65c794ba":"code","505b883d":"code","c1481d6a":"code","42be675a":"code","c98f2aed":"code","0faf6cae":"code","0d12620e":"code","3fb30660":"code","214d848f":"code","56038b43":"code","86de020d":"code","21172f0c":"code","acd41790":"code","fd1135f4":"code","d9ad5ef7":"code","a21be241":"code","018936f9":"code","d34ac073":"code","429e7272":"code","ed2f9d67":"code","f5b64727":"code","b38fd638":"code","ff33c3a8":"code","18645963":"code","e2209508":"code","3787bca8":"code","905fea18":"code","c03c9d5f":"code","d50a7d6a":"code","12038ca8":"code","ff975bd5":"code","9b27a2eb":"code","36d870b7":"code","fd02a34a":"code","c8eb8177":"code","08444d01":"code","814c7c6c":"code","5f30b78f":"code","d81f5155":"code","cd84e41d":"code","e075e780":"code","34fc746c":"code","071d60ea":"code","f0bd222c":"code","61dae9d4":"code","2e21cf42":"code","de2c1226":"code","fa2d21d6":"code","6395e954":"code","2d803c96":"code","9a7c0cc5":"code","b362e9a8":"code","93a34cc6":"code","53ed7408":"code","479d7c0b":"code","3633e019":"code","45b55ce7":"code","f9c7a264":"code","dee6c1a7":"code","6b6e456f":"code","ad9d045d":"code","8069cdbe":"code","2d7e0cd2":"code","9623ec79":"code","07be875f":"code","3d8e0dcf":"code","62571217":"code","7353ac63":"code","c7fac333":"code","50c0f4a0":"code","06bd3da2":"code","5038d6d0":"code","852b5506":"code","90b92777":"code","c0183986":"code","68e4e201":"code","4aaf269d":"code","840edd3e":"code","8b6b7c8f":"markdown","16683d27":"markdown","32defe7d":"markdown","de9f792c":"markdown","54f9a8b1":"markdown","1fb26f14":"markdown","841359d8":"markdown","32b29ae4":"markdown","79182464":"markdown","d3c431eb":"markdown","dc2682e7":"markdown","d85f6ad3":"markdown","862ada2b":"markdown","f322974a":"markdown","bd6fdac1":"markdown","27ac7e3c":"markdown","e9c04e80":"markdown","8ef00f56":"markdown","5d6edc34":"markdown","69135e25":"markdown","d7230aa3":"markdown","89fe7344":"markdown","0919dd66":"markdown","4a197321":"markdown","b873d85e":"markdown","85947e2e":"markdown","f5930b35":"markdown","eadbc94a":"markdown","ccb4f1b3":"markdown","c38ea385":"markdown","5d1ec48a":"markdown","730c73cb":"markdown","6d296eb1":"markdown","5f2097c7":"markdown","800545ad":"markdown","fee65639":"markdown","cad5e9bd":"markdown","0a1ae820":"markdown","88997d37":"markdown","d11b1ab4":"markdown","7aef2ef4":"markdown","60df60f5":"markdown","a2949f59":"markdown","f7825b86":"markdown"},"source":{"d2a1875a":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n#%matplotlib inline\nimport seaborn as sns\nimport pandas_profiling as pp\nfrom sklearn.preprocessing import StandardScaler, MinMaxScaler\nfrom sklearn.model_selection import train_test_split, GridSearchCV, cross_validate, cross_val_score\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.svm import SVC\nfrom sklearn.metrics import classification_report, confusion_matrix, log_loss, recall_score\nfrom yellowbrick.classifier import ConfusionMatrix\nfrom yellowbrick.cluster import KElbowVisualizer\nimport warnings\nwarnings.filterwarnings('ignore')","b8255655":"df = pd.read_csv('..\/input\/heart-disease-uci\/heart.csv')","da8b67dd":"df.sample(5)","69aaaeb2":"print(\"You're welcome! Since I used to be a nurse it's my plesure!!\",(\"\\U0001F60E\"))","76c33ba0":"df1 = df.copy()","ad338e91":"df1.sample(3)","0c7768c2":"df1.info()","65c794ba":"df1.describe()","505b883d":"!pip install pandas-profiling","c1481d6a":"df1.profile_report()","42be675a":"df1.duplicated().sum()","c98f2aed":"df1.drop_duplicates(inplace=True)","0faf6cae":"df1.duplicated().sum()","0d12620e":"for col in df1:\n    print(col)\n    print(df[col].value_counts(),\"\\n\")\n    print(\"************************\" ,'\\n\\n')","3fb30660":"df1['thal'].value_counts()","214d848f":"# Drop 0's as they mean null\ndf1.drop(df1[df1['thal']==0].index, inplace=True)","56038b43":"df1['thal'].value_counts()","86de020d":"df.columns","21172f0c":"df1.sample(3)","acd41790":"plt.figure(figsize=(12, 8))\nsns.heatmap(df1.corr(), annot = True);","fd1135f4":"plt.figure(figsize=(12, 8))\nsns.countplot(x = df1.age, hue = df1.target);","d9ad5ef7":"plt.figure(figsize=(12, 8))\nsns.countplot(df1.target, hue = df1.sex);","a21be241":"df1.cp.value_counts()","018936f9":"plt.figure(figsize=(12, 8))\nsns.countplot(df1.cp, hue = df1.target);","d34ac073":"df1.columns","429e7272":"plt.figure(figsize=(14, 8))\nsns.boxplot(x=df1.target, y = df1.trestbps);","ed2f9d67":"plt.figure(figsize=(16, 8))\nsns.countplot(df1.trestbps, hue = df1.target);","f5b64727":"plt.figure(figsize=(14, 8))\nsns.boxplot(x=df1.target, y = df1.chol);","b38fd638":"plt.figure(figsize=(14, 8))\nsns.boxplot(x=df1.target, y = df1.thalach);","ff33c3a8":"df1.exang.value_counts()","18645963":"plt.figure(figsize=(12, 8))\nsns.countplot(df1.exang, hue = df1.target);","e2209508":"df1.columns","3787bca8":"X = df1.drop('target', axis = 1)","905fea18":"y = df1.target","c03c9d5f":"X","d50a7d6a":"y","12038ca8":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)","ff975bd5":"scaler = MinMaxScaler()","9b27a2eb":"X_train_scaled = scaler.fit_transform(X_train)","36d870b7":"X_test_scaled = scaler.transform(X_test)","fd02a34a":"knn = KNeighborsClassifier(n_neighbors=1)","c8eb8177":"knn.fit(X_train_scaled, y_train)","08444d01":"knn_pred = knn.predict(X_test_scaled)","814c7c6c":"print(classification_report(y_test, knn_pred))","5f30b78f":"%matplotlib inline","d81f5155":"plt.figure(figsize=(10, 6))\nsns.heatmap(confusion_matrix(y_test, knn_pred), annot=True);","cd84e41d":"plt.figure(figsize=(10, 6))\ncm = ConfusionMatrix(knn)\ncm.fit(X_train_scaled, y_train)\ncm.score(X_test_scaled, y_test)\ncm.show();","e075e780":"error_rate = []\nfor i in range(1,40):\n    knn = KNeighborsClassifier(n_neighbors=i)\n    knn.fit(X_train_scaled,y_train)\n    pred_i = knn.predict(X_test_scaled)\n    error_rate.append(1 - recall_score(y_test, pred_i))","34fc746c":"plt.figure(figsize=(10,6))\nplt.plot(range(1,40),error_rate,color='blue', linestyle='dashed', marker='o',\n         markerfacecolor='red', markersize=10)\nplt.title('Error Rate vs. K Value')\nplt.xlabel('K')\nplt.ylabel('Error Rate')","071d60ea":"knn = KNeighborsClassifier(n_neighbors=13)","f0bd222c":"knn.fit(X_train_scaled, y_train)","61dae9d4":"knn_pred = knn.predict(X_test_scaled)","2e21cf42":"print(classification_report(y_test, knn_pred))","de2c1226":"plt.figure(figsize=(10, 6))\n\ncm = ConfusionMatrix(knn)\ncm.fit(X_train_scaled, y_train)\ncm.score(X_test_scaled, y_test)\ncm.show();","fa2d21d6":"scores = cross_validate(KNeighborsClassifier(n_neighbors=13), X_train_scaled, y_train, cv=10, n_jobs=-1, scoring=['recall'])","6395e954":"pd.DataFrame(scores)","2d803c96":"pd.DataFrame(scores)['test_recall'].mean()","9a7c0cc5":"grid_params = {'weights':['uniform', 'distance'], 'algorithm': ['auto', 'ball_tree', 'kd_tree', 'brute'], 'p':[1, 2], 'leaf_size': [20, 25, 30, 35, 40, 45],\n              'n_neighbors': [2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 15, 17], 'metric': ['minkowski', 'manhattan', 'euclidean']}","b362e9a8":"cv = GridSearchCV(KNeighborsClassifier(n_jobs=-1), param_grid=grid_params, n_jobs=-1, verbose=1, scoring='recall')","93a34cc6":"cv.fit(X_train_scaled, y_train)","53ed7408":"cv.best_score_","479d7c0b":"cv.best_params_","3633e019":"knn_pred = cv.predict(X_test_scaled)","45b55ce7":"print(classification_report(y_test, knn_pred))","f9c7a264":"knn = KNeighborsClassifier(leaf_size=20, p=1, weights='distance', n_neighbors=15)","dee6c1a7":"knn.fit(X_train_scaled, y_train)","6b6e456f":"knn_pred = knn.predict(X_test_scaled)","ad9d045d":"scores = cross_val_score(knn, X_train_scaled, y_train, scoring='recall', cv=10, n_jobs=-1)","8069cdbe":"pd.DataFrame(scores).mean()","2d7e0cd2":"plt.figure(figsize=(10, 6))\ncm = ConfusionMatrix(knn)\ncm.fit(X_train_scaled, y_train)\ncm.score(X_test_scaled, y_test)\ncm.show()","9623ec79":"knn_recall = recall_score(y_test, knn_pred)","07be875f":"knn_recall","3d8e0dcf":"log_model = LogisticRegression(n_jobs=-1)","62571217":"log_model.fit(X_train_scaled, y_train)","7353ac63":"log_pred = log_model.predict(X_test_scaled)","c7fac333":"print(classification_report(y_test, log_pred))","50c0f4a0":"cm = ConfusionMatrix(log_model)\ncm.fit(X_train_scaled, y_train)\ncm.score(X_test_scaled, y_test)\ncm.show();","06bd3da2":"scores = cross_validate(log_model, X_train_scaled, y_train, scoring='recall', cv=10, n_jobs=-1)","5038d6d0":"pd.DataFrame(scores)","852b5506":"pd.DataFrame(scores)['test_score'].mean()","90b92777":"log_recall = recall_score(y_test, log_pred)","c0183986":"log_recall","68e4e201":"plt.figure(figsize=(10, 6))\n\nrec_df = pd.DataFrame({'knn_recall_score': knn_recall,\n              'log_reg_recall_score': log_recall}, index=[0])","4aaf269d":"rec_df","840edd3e":"plt.figure(figsize=(15, 10))\nsns.barplot(x=rec_df.columns, y=rec_df.iloc[0].values);","8b6b7c8f":"### Thalach","16683d27":"There is nothing surprising here, as many studies demonstrate men's having heart disease is higher than women's.","32defe7d":"All done here ! I hope you like this notebook! ","de9f792c":"<br>","54f9a8b1":"Let's see the corralation between columns by using heatmap.","1fb26f14":"## Analyzing the Data","841359d8":"<br>","32b29ae4":"We are good to go!","79182464":"# Heart Disease EDA  - Prediction\n","d3c431eb":"<br>","dc2682e7":"### trestbps","d85f6ad3":"## Visually Compare Model Scores","862ada2b":"### DATASET COLUMNS FEATURE EXPLAIN\n<br>\n\nIf you have a problem with understanding medical terms here is the explanation for the column names! \n<br><br>\n- Age (age in years)\n- Sex (1 = male; 0 = female)\n- CP (chest pain type)\n- TRESTBPS (resting blood pressure (in mm Hg on admission to the hospital))\n- CHOL (serum cholestoral in mg\/dl) - (needs to be less than 200 mg\/dL)\n- FPS (fasting blood sugar > 120 mg\/dl) (1 = true; 0 = false) - (A fasting blood sugar level less than 100 mg\/dL (5.6 mmol\/L) is normal. A fasting blood sugar level from 100 to 125 mg\/dL (5.6 to 6.9 mmol\/L) is considered prediabetes. If it's 126 mg\/dL (7 mmol\/L) or higher on two separate tests, you have diabetes.\n\n- RESTECH (resting electrocardiographic results)\n- THALACH (maximum heart rate achieved)\n- EXANG (exercise induced angina (1 = yes; 0 = no)) - (Angina is chest pain or discomfort caused when your heart muscle doesn't get enough oxygen-rich blood.)\n- OLDPEAK (ST depression induced by exercise relative to rest)\n- SLOPE (the slope of the peak exercise ST segment)\n- CA (number of major vessels (0-3) colored by flourosopy)\n- THAL (3 = normal; 6 = fixed defect; 7 = reversable defect)\n- TARGET (Value 0: < 50% diameter narrowing - Value 1: > 50% diameter narrowing)\n","f322974a":"### exang","bd6fdac1":"<br>","27ac7e3c":"I would like to explore each column one by one.","e9c04e80":"This columns shows resting blood pressure.\n- I assume that this is systolic blood pressure and over 120 or 130 can be thought as high.","8ef00f56":"<br>","5d6edc34":"- Well, tbh I was expecting a strong corralation between age and target column, wlike by age increases narrowing will increase too.\n- Only with medical results it is kind of hard do make a comment though but I really would love to see BMI and smoking condition.","69135e25":"This column demostrates chest pain type.","d7230aa3":"## Train - Test Split","89fe7344":"## Data Pre-processing","0919dd66":"<br><br>\n__Don't you think this is crazy ?!! I love it!__<br><br>","4a197321":"Here we can clearly see that most of the patients have pain type 1 or 2 are having heart disease.","b873d85e":"Even though we don't have any strong correlation between target and the other columns we can say that cp,thalach,exang,oldpeak columns are corralated with the target column","85947e2e":"Hello everyone !\n\nIn this notebook, we are going to do an exploratory data analysis.\n\nLet's start with importing the libraries we might need.","f5930b35":"### Age","eadbc94a":"*exercise induced angina (1 = yes; 0 = no)","ccb4f1b3":"I would like to see in which pain type we are having heart disease.","c38ea385":"___","5d1ec48a":"- The thing took my attention here is when we have a look at the ratio of having narrowing over %50 is the most between age of 41-55 which made me think stress would be another affect on these age interval.","730c73cb":"### cp","6d296eb1":"As we can see we don't have any null values in out dataset which is great!<br><br>\nAnother thing is all the columns we have are either int or float so we don't have to spend so much time on data pre-processing.<br><br>\nBut!! I see that we have 1 duplicate value which we are going to drop to increase power of analysis!<br><br>","5f2097c7":"<br>","800545ad":"Let's start with dropping the duplicate value.","fee65639":"<br>","cad5e9bd":"Just in case I always work with copy of my dataset :)","0a1ae820":"## Implement kNN","88997d37":"<br>","d11b1ab4":"<br>","7aef2ef4":"<br>\n\n_To explore the data, df.describe is pretty useful but a little basic for serious exploratory data analysis. Now, I am going to install pandas-profiling and you are going to be amazed!! It is amazing and extremely useful!!!_\n <br><br>","60df60f5":"<br>","a2949f59":"## Logistic Regression","f7825b86":"### Sex"}}