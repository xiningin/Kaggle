{"cell_type":{"f1ca000a":"code","55a06b2f":"code","1f0d6c85":"code","32fd01d6":"code","2b383f53":"code","7c78fd7d":"code","68c1b80d":"code","d6047e0d":"code","7135dd4b":"code","80af53cd":"code","e8d66b1b":"code","4e181f80":"code","8c857259":"code","ddd71ce4":"code","bc93f38d":"code","3da07d38":"code","fa8276c7":"code","e8650d3d":"code","104013b8":"code","d946d6c7":"code","45e694b9":"code","fde248f7":"code","392c9606":"code","02026fc0":"code","ce8defa9":"code","d01f19aa":"code","fa3c4f21":"code","d434550e":"code","0d9af354":"code","f4ab5e67":"code","364948ce":"code","9a148403":"code","3ee2285f":"code","591e8775":"code","ae4f9db7":"code","729de89b":"code","355f07d9":"code","6ae6303d":"code","5e843994":"code","dc60dd11":"code","536c167f":"code","8ff4d4b5":"code","548bfdea":"code","53ec981f":"code","bf494e10":"code","d46a3f37":"code","38bee423":"code","53a2ca0c":"code","bb50c4b5":"code","9f9063b2":"code","6bf3d10f":"code","c88154e1":"code","62a316ef":"code","e850f49e":"code","f3fd5976":"code","283af1bc":"code","c951f1f9":"code","a689574f":"code","6a04e29a":"code","c0aa775d":"code","b6694f7a":"code","3e18b18f":"code","6e7342aa":"code","b1f6e2ec":"code","0ce20e9c":"code","7eac5c6d":"code","e23f4be9":"code","8f9535a1":"code","27383cdc":"code","0bb4f8e5":"code","b3492d74":"code","b62b0520":"code","6c6712e8":"code","737c4640":"code","197968b8":"code","c7bb4ad8":"code","f8ed0895":"code","95333267":"code","4cc6756c":"code","88cac3b3":"code","f259b04c":"code","658b4b89":"code","9d78d91a":"markdown","9c835496":"markdown","c44c1ebd":"markdown","f0428386":"markdown","5591fc15":"markdown","d8ed7406":"markdown","ed2461cd":"markdown","4db59572":"markdown","c64b2419":"markdown","d2a2bddf":"markdown","6092f9a5":"markdown","f5f10336":"markdown","f18ee85b":"markdown","e91a5545":"markdown","f646fa05":"markdown","a9d1d056":"markdown","f6d27072":"markdown","bb36154b":"markdown","ddf157fc":"markdown","89f93467":"markdown","0a8df43d":"markdown","42b9fc8e":"markdown","5afa6cbe":"markdown","731333ec":"markdown","849b1623":"markdown","370a1811":"markdown","fb277c4d":"markdown","73070295":"markdown","bdf7200c":"markdown","bd9546cf":"markdown","2bf236dc":"markdown","f430837d":"markdown","0ba627ed":"markdown","727dc84f":"markdown","fd2c1c75":"markdown","099f513f":"markdown"},"source":{"f1ca000a":"import pandas as pd\nimport numpy as np\nimport statsmodels.api as sm\nimport statsmodels.formula.api as smf\nimport patsy\n\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.linear_model import RidgeCV\n%matplotlib inline\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression, Lasso, LassoCV, Ridge, RidgeCV\nfrom sklearn.preprocessing import StandardScaler,PolynomialFeatures\n \nimport warnings\nwarnings.filterwarnings('ignore')","55a06b2f":"df1 = pd.read_csv('..\/input\/bike-sales-in-europe\/Sales.csv')\ndf1","1f0d6c85":"df1.Product_Category.value_counts()","32fd01d6":"df1.columns","2b383f53":"df1.shape","7c78fd7d":"df1.info()","68c1b80d":"df1.isna().sum()","d6047e0d":"df1.describe()","7135dd4b":"sns.boxplot(df1.Profit);","80af53cd":"df1=df1[df1.Profit<=4000]","e8d66b1b":"sns.boxplot(df1.Profit);","4e181f80":"sns.boxplot(df1.Cost);","8c857259":"df1=df1[df1.Cost<=4000]","ddd71ce4":"sns.boxplot(df1.Cost);","bc93f38d":"sns.boxplot(df1.Unit_Cost);","3da07d38":"df1.shape","fa8276c7":"sns.boxplot(df1.Unit_Price);","e8650d3d":"df1=df1[df1.Unit_Price<=3000]\ndf1.shape","104013b8":"sns.boxplot(df1.Unit_Price);","d946d6c7":"sns.boxplot(df1.Revenue);","45e694b9":"df1=df1[df1.Revenue<=3000]\ndf1.shape","fde248f7":"sns.boxplot(df1.Revenue);","392c9606":"corr =df1.corr()\ncorr","02026fc0":"cp = sns.heatmap(corr,cmap='winter', annot=True)\nplt.gcf().set_size_inches(12,12)","ce8defa9":"df1.duplicated().values.any()","d01f19aa":"df1.duplicated().sum()","fa3c4f21":"df1 = df1.drop_duplicates()\ndf1.shape","d434550e":"df1.Product_Category.value_counts()","0d9af354":"df1.groupby(['Country', 'Product_Category'])['Revenue'].sum()\nsns.countplot(data = df1, x='Country', hue='Product_Category', palette=('winter'))\nplt.savefig('product11.jpg')\nplt.gcf().set_size_inches(12,6)\nsns.set_style(\"whitegrid\")\n","f4ab5e67":"sns.countplot(data = df1, x='Country', hue='Customer_Gender',palette=('winter'))\nplt.xticks(rotation=60)\nsns.set_style(\"whitegrid\")\nplt.legend(['Male', 'Female'])\nplt.gcf().set_size_inches(11,6)\nplt.savefig('gender2,.jpg')\nplt.show()","364948ce":"bikes_df =df1[df1['Product_Category']=='Bikes']\nbikes_df","9a148403":"rs = bikes_df.groupby('Customer_Gender')['Sub_Category'].value_counts()\nrs","3ee2285f":"fig, rs = plt.subplots(figsize=(8,8))\nrs = bikes_df.groupby('Customer_Gender')['Sub_Category'].value_counts()\nplt.savefig('Customer_Gender.jpg')\nsns.countplot(data = bikes_df, x='Sub_Category', hue='Customer_Gender',palette=('winter'))","591e8775":"df_product = df1['Product_Category'].value_counts()\nlabel= [df_product.index.tolist()]\nplt.pie(df_product, shadow=True,labels=label[0],explode=(0.2, 0.2, 0.2), autopct='%1.1f%%', startangle=80)\nplt.gcf().set_size_inches(12,6)\nplt.savefig('product.jpg')\nplt.show()","ae4f9db7":"fig, rs = plt.subplots(figsize=(8,8))\nrs = bikes_df.groupby('Country')['Sub_Category'].value_counts()\nplt.savefig('country1.jpg')\nsns.countplot(data = bikes_df, x='Sub_Category', hue='Country',palette=('winter'));","729de89b":"sns.countplot(data = df1, x='Country', hue='Age_Group',palette=('winter'))\nplt.xticks(rotation=60)\nsns.set_style(\"whitegrid\")\nplt.gcf().set_size_inches(12,6)\nplt.savefig('country.jpg')\nplt.show()","355f07d9":"df_Bikes = df1[df1['Product_Category'] == 'Bikes']\ndf_Bikes = df_Bikes['Sub_Category'].value_counts()\n\nlabel = [df_Bikes.index.tolist()]\nplt.pie(df_Bikes, shadow=True, autopct='%1.1f%%', startangle=90, labels=label[0])\nplt.gcf().set_size_inches(12,6)\nplt.savefig('sub.jpg')\nplt.show()","6ae6303d":"bikes_df","5e843994":"da = bikes_df.groupby('Country')['Sub_Category','Unit_Price'].max()\nda","dc60dd11":"plt.figure(figsize=(8,8))\nax = df1.groupby('Country')['Profit'].sum().plot(kind='barh',color= '#2a49a5')\nax.set(xlabel='Profit', ylabel='Country')","536c167f":"fig, ax = plt.subplots(figsize=(10,5))\nsns.barplot(data= df1, x='Country', y='Revenue', hue='Age_Group',  palette=('winter') ,alpha=1,ci=None, ax=ax)\nplt.title('Global Revenue by Age Group of Customers',fontdict={'fontsize': 15}, y=1.02)\nplt.legend(bbox_to_anchor=(1.05, 0.6))\nplt.tight_layout()\nplt.savefig('evenue by Age Group1.jpg')\nplt.show()","8ff4d4b5":"cols_to_plot = ['Sub_Category', 'Profit', 'Revenue', 'Customer_Age']\nplt.figure(figsize=(10,10))\nsns.pairplot(df1[cols_to_plot], hue='Sub_Category',palette=('winter'))\nplt.show() ","548bfdea":"# Correlation plot Revenue vs Cost\n\nsns.scatterplot(data=df1, x=\"Revenue\", y=\"Cost\", hue='Year', palette=('winter'))\nplt.xlim(0,3000)\nplt.ylim(0,2000)\nplt.gcf().set_size_inches(12,6)\n\nm, b = np.polyfit(df1[\"Revenue\"], df1[\"Cost\"], 1)\nplt.savefig('revenue.jpg')\nplt.plot(df1[\"Revenue\"], m*df1[\"Revenue\"] + b);","53ec981f":"df1.drop('Order_Quantity',axis =1,inplace=True)","bf494e10":"df1.drop('Unit_Cost',axis =1,inplace=True)","d46a3f37":"df1.drop('Unit_Price',axis =1,inplace=True)","38bee423":"df1.drop('Revenue',axis =1,inplace=True)","53a2ca0c":"df1","bb50c4b5":"df1.dtypes","9f9063b2":"bike = df1.select_dtypes(exclude=['object']).copy()","6bf3d10f":"bike","c88154e1":"bike['Customer_Age'] = df1['Customer_Age']","62a316ef":"bike['Customer_Gender'] = df1['Customer_Gender']","e850f49e":"bike['Country'] = df1['Country']","f3fd5976":"bike['Product_Category'] = df1['Product_Category']","283af1bc":"bike","c951f1f9":"bike = pd.get_dummies(bike)\nbike","a689574f":"bike.shape","6a04e29a":"bike.columns","c0aa775d":"X, y = bike.drop('Profit',axis=1), bike['Profit']\n\nX_train_val, X_test, y_train_val, y_test = train_test_split(X, y, test_size=0.2, random_state=100)","b6694f7a":"X_train, X_val, y_train, y_val = train_test_split(X, y, test_size=.25, random_state=100)","3e18b18f":"X_train_val","6e7342aa":"len(X_train_val.index)","b1f6e2ec":"y_train_val","0ce20e9c":"len(y_train_val.index)","7eac5c6d":"len(X_test)","e23f4be9":"X_train","8f9535a1":"y_train","27383cdc":"lm = LinearRegression().fit(X_train,y_train)\nlm.score(X_train,y_train)","0bb4f8e5":"scaler = StandardScaler()\n\nX_train_scaled =scaler.fit_transform(X_train.values)\nX_val_scaled = scaler.transform(X_val.values)\nX_test_scaled = scaler.transform(X_test.values)\n","b3492d74":"# no change in result\nlm = LinearRegression().fit(X_train_scaled,y_train)\nlm.score(X_train_scaled,y_train)","b62b0520":"lr_model_ridge = Ridge(alpha = 1000000)\nlr_model_ridge.fit(X_train, y_train)\n\nlist(zip(X_train.columns, lr_model_ridge.coef_))\n","6c6712e8":"lm_reg = Ridge(alpha=1)\nlm_reg.fit(X_train_scaled, y_train)\nprint(f'Ridge Regression train R^2: {lm_reg.score(X_train_scaled, y_train):.3f}')","737c4640":"poly = PolynomialFeatures(degree=2) \n\nX_train_poly = poly.fit_transform(X_train.values)\nX_val_poly = poly.transform(X_val.values)\nX_test_poly = poly.transform(X_test.values)\n\nlm_poly = LinearRegression().fit(X_train_poly,y_train)\nlm_poly.score (X_train_poly,y_train)","197968b8":"poly3 = PolynomialFeatures(degree=3) \n\nX_train_poly3 = poly3.fit_transform(X_train.values)\nX_val_poly3 = poly3.transform(X_val.values)\nX_test_poly3 = poly3.transform(X_test.values)\n\nlm_poly3 = LinearRegression().fit(X_train_poly3,y_train)\nlm_poly3.score (X_train_poly3,y_train)","c7bb4ad8":"poly4 = PolynomialFeatures(degree=4) \n\nX_train_poly4 = poly4.fit_transform(X_train.values)\nX_val_poly4 = poly4.transform(X_val.values)\nX_test_poly4 = poly4.transform(X_test.values)\n\nlm_poly4 = LinearRegression().fit(X_train_poly4,y_train)\nlm_poly4.score (X_train_poly4,y_train)","f8ed0895":"lm.fit(X_train, y_train)\nprint(f'Linear Regression train R^2: {lm.score(X_train, y_train):.3f}')\n\nlm_reg = Ridge(alpha=1)\nlm_reg.fit(X_train_scaled, y_train)\nprint(f'Ridge Regression train R^2: {lm_reg.score(X_train_scaled, y_train):.3f}')\n\nlm_poly.fit(X_train_poly, y_train)\nprint(f'Degree 2 polynomial regression train R^2: {lm_poly.score(X_train_poly, y_train):.3f}')\n\nlm_poly4.fit(X_train_poly4, y_train)\nprint(f'Degree 4 polynomial regression train R^2: {lm_poly4.score(X_train_poly4, y_train):.3f}')","95333267":"lm.fit(X_val, y_val)\nprint(f'Linear Regression val R^2: {lm.score(X_val, y_val):.3f}')\n\nlm_reg.fit(X_val_scaled, y_val)\nprint(f'Ridge Regression val R^2: {lm_reg.score(X_val_scaled, y_val):.3f}')\n\nlm_poly.fit(X_val_poly, y_val)\nprint(f'Degree 2 polynomial regression val R^2: {lm_poly.score(X_val_poly, y_val):.3f}')\n\nlm_poly3.fit(X_val_poly4, y_val)\nprint(f'Degree 4 polynomial regression val R^2: {lm_poly4.score(X_val_poly4, y_val):.3f}')","4cc6756c":"lm.fit(X_test, y_test)\nprint(f'Linear Regression test R^2: {lm.score(X_test, y_test):.3f}')\n\nlm_reg.fit(X_test_scaled, y_test)\nprint(f'Ridge Regression test R^2: {lm_reg.score(X_test_scaled, y_test):.3f}')\n\nlm_poly.fit(X_test_poly, y_test)\nprint(f'Degree 2 polynomial regression test R^2: {lm_poly.score(X_test_poly, y_test):.3f}')\n\nlm_poly3.fit(X_test_poly4, y_test)\nprint(f'Degree 4 polynomial regression test R^2: {lm_poly4.score(X_test_poly4, y_test):.3f}')","88cac3b3":"sns.scatterplot(data=bike, x=\"Profit\", y=\"Cost\", palette=('winter'));\nplt.xlim(0,3000);\nplt.ylim(0,2000);\nplt.gcf().set_size_inches(12,6);\n\nm, b = np.polyfit(bike[\"Profit\"], bike[\"Cost\"], 1)\nplt.savefig('cost.jpg');\nplt.plot(bike[\"Profit\"], m*bike[\"Profit\"] + b);","f259b04c":"lasso_model = Lasso(alpha = 10000) # this is a VERY HIGH regularization strength!, wouldn't usually be used\nlasso_model.fit(X_val , y_val)\n\nlist(zip(X_val.columns, lasso_model.coef_))","658b4b89":"lasso_model.score(X_train,y_train)","9d78d91a":" # Here was our choice to predict (y=profit)","9c835496":"# Percentage of revenue for each country according to age groups","c44c1ebd":"# Import and read data set","f0428386":"# **Remove duplicated Records**\n","5591fc15":"# Here we have filtered the bike product to get the types of bikes","d8ed7406":"# The following chart shows a strong relationship between profits and revenues","ed2461cd":"# Percentage of sales of each product","4db59572":"- Reasons for the picking this data .\u00a0\n- The types of bicycles are due to the nature of each country, and therefore the    percentage of purchase of each type varies from each country\n- First test results were promising .\n- Supervised ( Regression) .\u00a0\u000b\n","c64b2419":"#  This data not null values","d2a2bddf":"# Polynomial Regression","6092f9a5":"# Who owns each type of bike, female or male? \n       *Show the result on the graph*","f5f10336":"# Description \n\n_____________________________\nThis data contains bike sales in Europe and America and the relationship between leading profits with age groups of people and according to males and females and needs that can be purchased when buying a bike and we can predict future prices using machine learning once the product is developed so the machine will make the decision in setting the price.\n\n","f18ee85b":"\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\n\nAfter we found the prediction scores for each model, it became clear to us the best model (polynomial =4 )\n# Comparison between Linear , Ridge and Polynomial Regression","e91a5545":"# \u00a0The relationship between features","f646fa05":"# Data \n\n____________________________________________________\n\nThis data is characterized by a lot of diversity in bicycles and their accessories and clothes. We also noticed the large demand for them of all ages, their purchase and use on a daily basis, which led to an increase in their revenues in the countries selected in this data\n\n","a9d1d056":"# the model on LASSO is worst model","f6d27072":"# Remove outliers","bb36154b":"# \u00a0The heatmap relationship between features","ddf157fc":"# Here we divide the data to do algorithm training and choose the algorithm that showed the best results for entering the model","89f93467":"# Showing the percentage of sales of each type of bike, and we noticed that road bikes are the most purchased, and the reason is due to the nature of each country","0a8df43d":"# The percentage of profits in each country, and we noticed that the United States has the most sales percentage","42b9fc8e":" # A comparison between each type of bicycle and the percentage of its sale in each country","5afa6cbe":"# conclusion","731333ec":"# THANK YOU \n\n![TLC logo](https:\/\/encrypted-tbn0.gstatic.com\/images?q=tbn:ANd9GcQtIsYfO6_ROXkr2d8BFEzlyhbhxe-ZinfF0A&usqp=CAU)\n","849b1623":" # Is there a duplicated or not?","370a1811":"# The result is the best model on the chart","fb277c4d":"\n![TLC logo](https:\/\/shopdevs.net\/wp-content\/uploads\/2018\/07\/blog_post_img_03.jpg)","73070295":"# Linear Regression","bdf7200c":"# We noticed that accessories are sold more than both gender\n","bd9546cf":"# We used (scaler)to balance the data after a bad result appeared on the previous model","2bf236dc":"# Here we have shown the number of males and females purchased for each type of bike","f430837d":"# In this data, it became clear that the single currency is the euro, and therefore the highest price for the type of bike (tour bike) used in the race","0ba627ed":"# Find out who is the age group that buys the most bicycles","727dc84f":"# Ridge Regression","fd2c1c75":"# Most buy bikes and accessories for both gender .","099f513f":"# EDA for dataset"}}