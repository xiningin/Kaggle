{"cell_type":{"f19ce0c4":"code","c1d2c60b":"code","3ecadd78":"code","e78d62d0":"code","5d71ccff":"code","2a5aa7b7":"code","e0ef4199":"code","f016772e":"code","ac44236a":"code","4dd6e2ac":"code","2bc16925":"code","42ae3ce2":"code","d1dead1c":"code","15e40a40":"code","cb3ce126":"code","f6187666":"markdown","c1c14783":"markdown","b6ab4694":"markdown","e6adfa56":"markdown","63d886ea":"markdown","894d86d4":"markdown","efc03798":"markdown","6d1a1732":"markdown","7139d62a":"markdown","c174410f":"markdown","f901d4b0":"markdown","0a58ba48":"markdown"},"source":{"f19ce0c4":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport math\nimport seaborn as sns\nfrom scipy.integrate import odeint\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\nimport os\ndf = pd.read_csv('\/kaggle\/input\/corona-virus-brazil\/brazil_covid19.csv')\n# Any results you write to the current directory are saved as output.","c1d2c60b":"df.head()","3ecadd78":"rj = df[df['state'] == 'Rio de Janeiro']","e78d62d0":"rjc = rj[rj['cases']>0]\ndata = rjc['date'].values\ncasos = rjc['cases'].values\nmortes = rjc['deaths'].values\nplt.figure(figsize=(10,6))\nplt.title('Casos do novo coronav\u00edrus no RJ')\nk=sns.barplot(x='date',y='cases',data=rjc,palette=\"Blues_d\")\nk.set_xticklabels(k.get_xticklabels(), rotation=45)\nplt.show()","5d71ccff":"def exponencial(td,z0):\n    s1 = np.sum(td*np.log(z0))\n    s2 = (np.sum(np.log(z0)))*(np.sum(td))\/len(td)\n    s3 = np.sum(np.dot(td,td))\n    s4 = ((np.sum(td))**2)\/len(td)\n    A = (s1 - s2)\/(s3 - s4)\n    s5 = np.sum(np.log(z0))\/len(td)\n    s6 = np.sum(td)\/len(td)\n    B = math.exp(s5 - A*s6)\n\n    r1 = len(td)*np.sum(td*np.log(z0))\n    r2 = (np.sum(td)*np.sum(np.log(z0)))\n    r3 = ((len(td))*(np.sum(np.dot(td,td)))) - (np.sum(td))**2\n    r4 = ((len(td))*(np.sum(np.dot(np.log(z0),np.log(z0))))) - (np.sum(np.log(z0)))**2\n\n    R2 = ((r1 - r2)**2)\/(r3*r4)\n    return A,B,R2","2a5aa7b7":"dias = np.array([0,1,2,3,5,6,7,8,9,10,11,12,13,14,15,16])\ng = exponencial(dias,casos)\na = g[0]\nb = g[1]","e0ef4199":"r2 = g[2]\nr2","f016772e":"sp = df[df['state'] == 'S\u00e3o Paulo']\nspc = sp[sp['cases']>0]\ndata_sp = spc['date'].values\ncasos_sp = spc['cases'].values\nplt.figure(figsize=(10,6))\nplt.title('Casos do novo coronav\u00edrus em SP')\nk=sns.barplot(x='date',y='cases',data=spc,palette=\"Blues_d\")\nk.set_xticklabels(k.get_xticklabels(), rotation=45)\nplt.show()","ac44236a":"dias_sp = np.arange(len(spc))\ncasos_sp = spc['cases'].values\ng_sp = exponencial(dias_sp,casos_sp)\na_sp = g_sp[0]\nb_sp = g_sp[1]","4dd6e2ac":"r2s = g_sp[2]\nr2s","2bc16925":"caso_proj_rj = b*np.exp(a*dias)\ndays_proj_rj10 = np.arange(len(dias)+10)\ncaso_proj_rj10 = b*np.exp(a*days_proj_rj10)\ncaso_proj_sp = b_sp*np.exp(a_sp*dias_sp)\ndays_proj_sp10 = np.arange(len(dias_sp)+10)\ncaso_proj_sp10 = b_sp*np.exp(a_sp*days_proj_sp10)","42ae3ce2":"fig, ((ax1, ax2),(ax3,ax4)) = plt.subplots(2, 2,figsize=(22,17))\nax1.grid(True)\nax1.set_title('Casos de Coronav\u00edrus no RJ em 16 dias',fontsize=18)\nax1.set_xlabel('Dias',fontsize=15)\nax1.set_ylabel('Casos',fontsize=15)\nax1.scatter(dias,casos,label='Casos reais')\nax1.plot(dias,caso_proj_rj,label='Ajuste exponencial',color='red')\nhandles, labels = ax1.get_legend_handles_labels()\nax1.legend(loc='best')\n\nax2.grid(True)\nax2.set_yscale('log')\nax2.set_xlabel('Dias',fontsize=15)\nax2.set_ylabel('Casos (escala logaritmica)',fontsize=15)\nax2.set_title('Casos projetados para RJ nos pr\u00f3ximos 10 dias',fontsize=18)\nax2.tick_params(labelsize='large', width=3)\nax2.legend('Ajuste exponencial',loc='upper left')\nax2.plot(days_proj_rj10,caso_proj_rj10,color='green',label='Ajuste exponencial em escala log')\nhandles, labels = ax2.get_legend_handles_labels()\nax2.legend(loc='best')\n\nax3.grid(True)\nax3.set_title('Casos de Coronav\u00edrus no SP em 24 dias',fontsize=18)\nax3.set_xlabel('Dias',fontsize=15)\nax3.set_ylabel('Casos',fontsize=15)\nax3.scatter(dias_sp,casos_sp,label='Casos reais')\nax3.plot(dias_sp,caso_proj_sp,label='Ajuste exponencial',color='red')\nhandles, labels = ax3.get_legend_handles_labels()\nax3.legend(loc='best')\n\nax4.grid(True)\nax4.set_yscale('log')\nax4.set_xlabel('Dias',fontsize=15)\nax4.set_ylabel('Casos (escala logaritmica)',fontsize=15)\nax4.set_title('Casos projetados para SP nos pr\u00f3ximos 10 dias',fontsize=18)\nax4.tick_params(labelsize='large', width=3)\nax4.legend('Ajuste exponencial',loc='upper left')\nax4.plot(days_proj_sp10,caso_proj_sp10,color='green',label='Ajuste exponencial em escala log')\nhandles, labels = ax4.get_legend_handles_labels()\nax4.legend(loc='best')\nplt.show()","d1dead1c":"def modelo(x,t,N,beta,g):\n    S = x[0]\n    I = x[1]\n    R = x[2]\n    dSdt = -beta*I*S\/N \n    dIdt = beta*I*S\/N - g*I\n    dRdt = g*I \n    return [dSdt,dIdt,dRdt]","15e40a40":"beta_rj = g[0] \nbeta_sp = g_sp[0]\ngamma = 1.0\/14.0 #1\/DIAS DE RECUPERA\u00c7\u00c3O\nN_rj = 1.646e7 #pop do RJ\nN_sp = 4.404e7 #pop de SP\ndias_sim = 300 #n\u00famero de dias\nI0 = 1 #condi\u00e7\u00e3o inicial de infec\u00e7\u00e3o\nR0 = 0\nS0_rj = N_rj - I0 - R0\nS0_sp = N_sp - I0 - R0\nt = np.linspace(0,dias_sim,5*dias_sim)\nx0_rj = [S0_rj,I0,R0] #vetor com condi\u00e7\u00f5es iniciais no RJ\nx0_sp = [S0_sp,I0,R0] #vetor com condi\u00e7\u00f5es iniciais em SP\ny_rj = odeint(modelo,x0_rj,t,args=(N_rj,beta_rj,gamma))\ny_rj_130 = odeint(modelo,x0_rj,t,args=(N_rj,1.3*beta_rj,gamma))\ny_rj_70 = odeint(modelo,x0_rj,t,args=(N_rj,0.5*beta_rj,gamma))\ny_sp = odeint(modelo,x0_sp,t,args=(N_sp,beta_sp,gamma))\ny_sp_130 = odeint(modelo,x0_sp,t,args=(N_sp,1.3*beta_sp,gamma))\ny_sp_70 = odeint(modelo,x0_sp,t,args=(N_sp,0.5*beta_sp,gamma))","cb3ce126":"fig, (ax1, ax2) = plt.subplots(1, 2,figsize=(22,8))\nax1.grid(True)\nax1.set_xlim([0,dias_sim])\nax1.set_ylabel('N\u00famero de pessoas',fontsize=14)\nax1.set_xlabel('Dias',fontsize=14)\nhandles, labels = ax1.get_legend_handles_labels()\nax1.set_title('Perfil de contamina\u00e7\u00e3o por COVID-19 no RJ pelo modelo SIR',fontsize=13)\nax1.tick_params(labelsize='large', width=3)\nax1.plot(t,y_rj[:,0],'b',label = 'Suscet\u00edveis')\nax1.plot(t,y_rj[:,1],'r',label = 'Infectados')\nax1.plot(t,y_rj[:,2],'g',label = 'Recuperados')\nax1.plot(t,y_rj_130[:,1],'r:',label = 'Infectados com 30% a mais de contamina\u00e7\u00e3o')\nax1.plot(t,y_rj_70[:,1],'r--',label = 'Infectados com 50% a menos de contamina\u00e7\u00e3o')\nax1.legend(loc='upper right')#,handles=[caso, caso_proj])\n\nax2.grid(True)\nax2.set_xlim([0,dias_sim])\nax2.set_ylabel('N\u00famero de pessoas',fontsize=14)\nax2.set_xlabel('Dias',fontsize=14)\nhandles, labels = ax2.get_legend_handles_labels()\nax2.set_title('Perfil de contamina\u00e7\u00e3o por COVID-19 em SP pelo modelo SIR',fontsize=13)\nax2.tick_params(labelsize='large', width=3)\nax2.plot(t,y_sp[:,0],'c',label = 'Suscet\u00edveis')\nax2.plot(t,y_sp[:,1],'k',label = 'Infectados')\nax2.plot(t,y_sp[:,2],'m',label = 'Recuperados')\nax2.plot(t,y_sp_130[:,1],'k:',label = 'Infectados sem 30% a mais de contamina\u00e7\u00e3o')\nax2.plot(t,y_sp_70[:,1],'k--',label = 'Infectados com 50% a menos de contamina\u00e7\u00e3o')\nax2.legend(loc='upper right')\nplt.show()","f6187666":"O valor de R\u00b2 para SP foi ainda mais pr\u00f3ximo de 1,0. O modelo exponencial ainda \u00e9 mais adequado a esses pontos do que no RJ.\n\nDessa forma, farei gr\u00e1ficos mostrando a concord\u00e2ncia entre os modelos e os pontos, bem como os casos projetados para os pr\u00f3ximos dez dias, caso o modelo exponencial se mantenha.","c1c14783":"O valor de 0,9624 \u00e9 muito elevado, indicando quase uma correla\u00e7\u00e3o perfeita com o modelo proposto nessa fase.\nFarei o mesmo com SP, o maior foco de casos at\u00e9 ent\u00e3o.","b6ab4694":"O n\u00famero de casos parece crescer de forma exponencial. Criarei uma fun\u00e7\u00e3o que realiza uma regress\u00e3o exponencial","e6adfa56":"A modelagem epidemiol\u00f3gica completa se d\u00e1 com o modelo SIR (Susceptibilidade, Infec\u00e7\u00e3o e Recupera\u00e7\u00e3o). Consiste-se num sistema de 3 equa\u00e7\u00f5es diferenciais ordin\u00e1rias, que consideram a taxa de infec\u00e7\u00e3o e de recupera\u00e7\u00e3o. \nEsse modelo pode falhar se for poss\u00edvel a reinfec\u00e7\u00e3o, o que \u00e9 perfeitamente poss\u00edvel se o sistema imunol\u00f3gico n\u00e3o apresentar mem\u00f3ria para os ant\u00edgenos apresentados por esse v\u00edrus ou o mesmo possuir uma taxa de muta\u00e7\u00e3o muito elevada.","63d886ea":"Como a data n\u00e3o pode ingressar nessa fun\u00e7\u00e3o, trabalharei com a vari\u00e1vel dias, sendo zero, o primeiro dia de caso confirmado, que foi em 05\/03.\n\nTodos os dias tivemos casos, com exce\u00e7\u00e3o do dia 09\/03","894d86d4":"Considerando as popula\u00e7\u00f5es de SP e RJ, respectivamente iguais a 44,04 mi e 16,46 mi e as condi\u00e7\u00f5es iniciais est\u00e3o descritas na pr\u00f3xima linha de c\u00f3digo. Como as constantes beta na realidade s\u00e3o din\u00e2micas (n\u00e3o s\u00e3o constantes na realidade, portanto), farei 3 simula\u00e7\u00f5es para cada estado, aumentando em 30% e reduzindo em 50% essa constante al\u00e9m de simular com o valor experimental. \n\nObtive esses valores da fun\u00e7\u00e3o de regress\u00e3o exponencial (o termo a). A taxa de recupera\u00e7\u00e3o \u00e9 de 14 dias em m\u00e9dia, conforme observado em v\u00e1rios pa\u00edses. Essa constante deve ser reduzida ao m\u00ednimo poss\u00edvel, de modo a evitar o colapso do sistema de sa\u00fade. \n\nMedidas de quarentena podem ser \u00fateis para reduzir essa constante.","efc03798":"# Criando o modelo SIR","6d1a1732":"Vou criar um gr\u00e1fico de barras para observar a evolu\u00e7\u00e3o de suspeitos","7139d62a":"Veremos o coeficiente de correla\u00e7\u00e3o R\u00b2 e avaliar se a regress\u00e3o exponencial \u00e9 uma boa aproxima\u00e7\u00e3o nesse momento","c174410f":"Essa modelagem \u00e9 consagrada na epidemiologia, apesar das simplifica\u00e7\u00f5es. Sem medidas de controle podemos ter um pico de contamina\u00e7\u00e3o nos dois estados em aproximadamente 80 dias ap\u00f3s o in\u00edcio da infec\u00e7\u00e3o. No RJ isso ser\u00e1 no final de maio, pr\u00f3ximo ao dia 23\/05, enquanto em SP ser\u00e1 pr\u00f3ximo ao dia 15\/05. Isso ser\u00e1 o fim do sistema de sa\u00fade. Se os valores de contamina\u00e7\u00e3o estiverem subestimados em 30%, o auge ser\u00e1 mais cedo, pr\u00f3ximo ao dia 60, em rela\u00e7\u00e3o ao primeiro caso, o que significar\u00e1 algo em torno do fim de abril e in\u00edcio de maio. Em SP significaria um pouco mais de 2 milh\u00f5es de contaminados e no RJ em torno de 800 mil. Com um controle de 50% de contamina\u00e7\u00e3o, o pico seria achatado, evitando uma sobrecarga do sistema de sa\u00fade e reduzindo o auge de casos num curto espa\u00e7o de tempo.\n\nNo presente cen\u00e1rio, pode-se dizer que n\u00e3o come\u00e7amos a sofrer com a epidemia. De fato, ambos os estados sofrer\u00e3o as consequ\u00eancias em final de abril, causando forte crise nos estados at\u00e9 final de julho, quando as taxas de infec\u00e7\u00e3o devem ser reduzidas em n\u00edveis control\u00e1veis.","f901d4b0":"A regress\u00e3o exponencial parece bem adequada para modelar essa fase inicial da infec\u00e7\u00e3o","0a58ba48":"## Avaliando o Rio de Janeiro"}}