{"cell_type":{"2ce308d7":"code","327bf739":"code","8718f627":"code","f95ba9b6":"code","69c59fec":"code","6af46398":"code","2348e333":"code","1070f067":"markdown","fcff0192":"markdown","bb496027":"markdown","c2d4f813":"markdown","9e99057a":"markdown","e71eeaeb":"markdown","63b0d0a8":"markdown","daeba62d":"markdown","9e64ed6d":"markdown","49df7ad3":"markdown","be2ec33f":"markdown"},"source":{"2ce308d7":"import os\nimport tensorflow as tf\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\n\nprint(os.listdir('\/kaggle\/input\/digit-recognizer'))","327bf739":"# Import 'train.csv' using pandas and see how many rows and columns are there.\nall_data = pd.read_csv('\/kaggle\/input\/digit-recognizer\/train.csv', header=0)\nprint(all_data.shape)\nall_data.head()","8718f627":"# Assign 'label' column to target variable (y_all_data)\ny_all_data = all_data['label']\n\n# Remove 'label' column from rest of the data \nX_all_data = all_data.drop('label', axis=1)\n\n# Convert dataframe into numpy array \nX_all_data = np.asarray(X_all_data)\ny_all_data = np.asarray(y_all_data)\n\n#Normalize Data\nX_all_data = X_all_data\/255\n\n# No. of rows and columns per image\nin_shape = X_all_data[0].shape\n\nprint(in_shape)","f95ba9b6":"# Re-shape image into 28x28 pixels\ndisp_image = X_all_data[1].reshape(28,28)\n\n# Display image using matplotlib\nplt.imshow(disp_image)\nprint(\"Label: \",y_all_data[1])","69c59fec":"# Function to stop training once desired accuracy is acheived\nclass myCallback(tf.keras.callbacks.Callback):\n    def on_epoch_end(self, epoch, logs={}):\n        if(logs.get('acc')>0.999):\n            print('99.9% Accuracy reached')\n            self.model.stop_training = False\n            \nmycallback = myCallback()  \n\n# Start building model\nmodel = tf.keras.models.Sequential([\n                                    tf.keras.layers.Reshape((28,28,1), input_shape=in_shape),\n                                    tf.keras.layers.Conv2D(32, (3,3), activation='relu'),\n                                    tf.keras.layers.MaxPooling2D(2,2),\n                                    tf.keras.layers.Conv2D(32, (3,3), activation='relu'),\n                                    tf.keras.layers.MaxPooling2D(2,2),\n                                    tf.keras.layers.Flatten(),\n                                    tf.keras.layers.Dense(512, activation='relu'),\n                                    tf.keras.layers.Dense(10, activation='softmax')\n]\n)\n\n# Compiling the model\nmodel.compile(optimizer='adam', loss='sparse_categorical_crossentropy', metrics=['acc'])\n\n#model.fit(X_train,y_train, validation_data=(X_test,y_test), epochs=10, callbacks=[mycallback])\n\n# Start Training Process\nmodel.fit(X_all_data,y_all_data, epochs=50, callbacks=[mycallback])\n","6af46398":"# Making Prediction\nall_test_data = pd.read_csv('\/kaggle\/input\/digit-recognizer\/test.csv', header=0)\nfinal_test = np.asarray(all_test_data)\ncount=1\nlabel = []\nid = []\nfor test in final_test:\n    #print(test.reshape(1,784))\n    label.append(np.argmax(model.predict(test.reshape(1,784), batch_size=1000)))\n    id.append(count)\n    count += 1\n","2348e333":"#Save to csv\n\nsubmission = pd.DataFrame()\nsubmission['ImageId'] = id\nsubmission['Label'] = label\n\nsubmission.to_csv('submission.csv', index=False)","1070f067":"<div style=\"border: thin solid red; padding-left: 15px; padding-right:15px; padding-top:15px; padding-bottom:15px\"><h3><span style=\"color: #0000ff;\"><strong>Hey Everyone<\/strong><\/span><\/h3>\n<p>This kernel is for anyone who is just getting started with Machine Learning using Python\/Tensorflow and wants to get a basic idea about computer vision and how to implement it for Digit recognition.<br \/>I'll try to implement this kernel by dividing it into a couple of sections to make it easier to understand.<\/p>\n<p><span style=\"text-decoration: underline;\"><strong>Sections<\/strong><\/span>:<br \/>&nbsp; &nbsp;1. Importing required libraries<br \/>&nbsp; &nbsp;2. Importing Image Data and re-arranging it.<br \/>&nbsp; &nbsp;3. Building Convolutional Neural Network using tensorflow.<br \/>&nbsp; &nbsp;4. Making Predictions on Test Data.<br \/>&nbsp; &nbsp;5. Exporting the results for submission in competition.<\/p><\/div>","fcff0192":"<h2>1. Importing required libraries<\/h2>","bb496027":"<div style=\"border: thin solid red; padding-left: 15px; padding-right:15px; padding-top:15px; padding-bottom:15px\">\nNow, we have separated target variable(label) from rest of the data and printed the shape of a single image.\n<br>The 'in_shape' variable will be useful to us when we need to feed this data into tensorflow neural network.\n\n<br><br>Let's print one image from this data to see how it looks.\n<\/div>","c2d4f813":"<div style=\"border: thin solid red; padding-left: 15px; padding-right:15px; padding-top:15px; padding-bottom:15px\">\nLooks like this particular image is for the number zero, which is correctly reflected in the label.\n<\/div>","9e99057a":"<div style=\"border: thin solid red; padding-left: 15px; padding-right:15px; padding-top:15px; padding-bottom:15px\">\n<p>This model will be trained using input data for 50 epochs. <br \/>Once the training is complete, we can see that the training accuracy is ~0.99. <br \/><br \/><span style=\"text-decoration: underline;\"><strong>Note<\/strong><\/span>: It is recommended to divide input data into training and validation sets. Training set is used to train the model and validation set can be used to test the accuracy of the model on \"unseen\" data. <br \/>This technique is useful to prevent overfitting where a model has good accuracy on training data but doesn't perform well on test data. <br \/> For this notebook, I've used entire data for training to keep things easy to understand.<\/p>\n<\/div>","e71eeaeb":"<div style=\"border: thin solid red; padding-left: 15px; padding-right:15px; padding-top:15px; padding-bottom:15px\">\n<h2>Keep Learning !<\/h2>\n<\/div>","63b0d0a8":"<div style=\"border: thin solid red; padding-left: 15px; padding-right:15px; padding-top:15px; padding-bottom:15px\">\n<h2>2. Importing Image Data and re-arranging it:<\/h2>\nFor this competition the data is not given in form of images, rather we have a 'csv' file where each row represents one image.\n<br>Every row has 785 columns i.e 784 columns for pixel values and 1 column for label representing what number it is.\n<br><br><b><u>Note:<\/b><\/u> 784 pixels translates to 28x28 image.<br><br>First of all, we will import 'train.csv' using pandas and see how many rows and columns are there.<br>\n<\/div>","daeba62d":"<div style=\"border: thin solid red; padding-left: 15px; padding-right:15px; padding-top:15px; padding-bottom:15px\">\n<h2>4. Making Predictions on Test Data<\/h2>\n<p>Once the neural network is trained, we can start making predictions on the test data provided in dataset. <\/p>\n<p>For this competition, the submission file must contain two columns: <br \/>&nbsp; &nbsp;1. <span style=\"text-decoration: underline;\">ImageID<\/span>: This represents the serial no. of image in test dataset. <br \/>&nbsp; &nbsp;2. <span style=\"text-decoration: underline;\">Label<\/span>: Prediction made by model for test image. <br \/><br \/> As we make predictions, we'll keep storing these two values in two separate arrays.<\/p>\n<\/div>","9e64ed6d":"<div style=\"border: thin solid red; padding-left: 15px; padding-right:15px; padding-top:15px; padding-bottom:15px\">\n<h2>3. Building Convolutional Neural Network using tensorflow<\/h2>\n<p>Let's start building neural network using tensorflow. <br \/><br \/> This neural network contains following 8 layers: <br \/>&nbsp; &nbsp;1. <span style=\"text-decoration: underline;\">Reshape<\/span>: This layer converts 784 pixels into a 28x28 matrix which more accuarately represents an image. <br \/>&nbsp; &nbsp;2. <span style=\"text-decoration: underline;\">Convolution<\/span>: In simple terms, a convolution layer is used to highlight \"features\" in an image. Convolutions can be used to highlight edges of objects within an image for better classification. Since this neural network utilizes convolutions, hence the name Convolutional Neural Network (CNN). <br \/>&nbsp; &nbsp;3. <span style=\"text-decoration: underline;\">MaxPool<\/span>: This layer can be used to compress\/reduce the size of image while retaining most of the information, which makes the training process faster. <br \/>&nbsp; &nbsp;4. <span style=\"text-decoration: underline;\">Convolution<\/span>: Same as convolution layer above. <br \/>&nbsp; &nbsp;5. <span style=\"text-decoration: underline;\">MaxPool<\/span>: Same as maxpool layer above. <br \/>&nbsp; &nbsp;6. <span style=\"text-decoration: underline;\">Flatten<\/span>: This layer converts 2-D output from preceeding layers back into 1-D shape. <br \/>&nbsp; &nbsp;7. <span style=\"text-decoration: underline;\">Dense<\/span>: This particular layer is a hidden layer in our neural net. <br \/>&nbsp; &nbsp;8. <span style=\"text-decoration: underline;\">Dense<\/span>: Final\/Output layer of the network. This layer contains 10 nodes\/neurons representing 10 possible prediction values (0-9). <br><br>Once the structure of the model is defined, we need to compile it using parameters: optimizer, loss, metrics. <br \/><br \/>Finally, we'll start training the model using 'model.fit()' and passing: <br \/>&nbsp; &nbsp; 1. <span style=\"text-decoration: underline;\">Training data<\/span>: X_all_data &amp; y_all_data <br \/>&nbsp; &nbsp; 2. <span style=\"text-decoration: underline;\">Epochs<\/span>: No. of times entire training data is passed to the neural network for training. <br \/>&nbsp; &nbsp; 3. <span style=\"text-decoration: underline;\">Callbacks<\/span>: A function defined in top of the cell which defines that the model should stop training once desired accuracy is acheived.<\/p>\n<\/div>","49df7ad3":"<div style=\"border: thin solid red; padding-left: 15px; padding-right:15px; padding-top:15px; padding-bottom:15px\">\n<h2>5. Exporting the results for submission in competition<\/h2>\nFinally, we need to convert label and image id arrays into a format which can be submitted to the competition.\n<br> We'll store these two arrays in 'submission.csv' file using code given below.\n<br> You need to Commit the kernel by clicking blue \"Commit\" button on top right corner. It'll take a couple of minutes to run this entire notebook.\n<br><br> Once, the notebook is completely commited, you can see the 'submission.csv' file in the 'Output' section of the notebook.\n<br>Submit this file by either manually uploading the file in competition or by clicking \"Submit to competition\" button.\n<\/div>","be2ec33f":"<div style=\"border: thin solid red; padding-left: 15px; padding-right:15px; padding-top:15px; padding-bottom:15px\">\nSo, there are 42000 rows or images and every row has 785 columns.\n<br>Also, we can see the pixel values (0-255) for 784 pixel columns.\n<br><br>Now, we need to separate target variable from the data.\n<br>Here, Target variable = 'label' column which tells us what number is there in the image.\n<\/div>"}}