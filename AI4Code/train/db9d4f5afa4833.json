{"cell_type":{"040c335b":"code","a18dc5d8":"code","a246db11":"code","e549341c":"code","10d7a97c":"code","41d44413":"code","66ae5f2c":"code","21d1982c":"code","97bf908b":"code","b30e57a3":"code","d56c09af":"code","37298c86":"code","8cece602":"code","4ad30844":"code","658e7926":"code","b1540835":"code","4103fa26":"code","3799878d":"code","e60bc708":"code","35b136b0":"code","bb7bfd14":"code","27dcb1dd":"code","add3315a":"code","1655767d":"code","aac22985":"code","1fd0bb80":"code","a1440732":"code","09b175c6":"code","9704f70e":"code","d27d1f76":"code","a45959bb":"code","80c7d24e":"code","5b8fb043":"code","1787023a":"code","fe284ff9":"code","0bd684a4":"code","434e10ff":"code","cd802bcf":"code","1e1e2ae0":"code","7571f0ac":"code","9caf81c9":"code","16aea5a5":"code","fbc849f3":"code","29a79886":"code","a97e06f5":"code","76817f29":"code","290278b9":"code","894f0342":"code","c2f69439":"code","9d3acc63":"code","1c910dfe":"code","dd9c418c":"code","23522b5e":"code","f9377538":"code","30716c75":"code","010556a9":"code","449699fd":"code","91085d4f":"code","81ff49ea":"code","afa8631f":"code","eceaed98":"code","0c31100b":"code","d3a46797":"code","3ddbef03":"code","35ed2954":"code","892eaae7":"code","a0a7a8d9":"code","a58693d6":"code","de78cb43":"code","3c10348b":"code","2bb45a4a":"code","26b417a3":"code","a0ed13c2":"code","9d309e80":"code","a0d79a9b":"code","5e4538b2":"markdown","48583c97":"markdown","f24ad6df":"markdown","024d7623":"markdown","4adc3129":"markdown","3e2396a5":"markdown","5d5c05fc":"markdown","a7901843":"markdown","6d5b7d1b":"markdown","82cba34a":"markdown","08e6c335":"markdown","c3a2546e":"markdown","ff8819d7":"markdown"},"source":{"040c335b":"import pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt","a18dc5d8":"# ! pip install chart_studio","a246db11":"#import chart_studio\n#import chart_studio.plotly as py\n#import chart_studio.tools as tls","e549341c":"## chart_studio options\n#username =\"h3mkader\"\n#api_key = \" \"\n#tls.set_credentials_file(username,api_key)","10d7a97c":"pip install plotly --upgrade","41d44413":"import plotly.express as px","66ae5f2c":"df=pd.read_csv('..\/input\/insurance\/insurance.csv')","21d1982c":"df","97bf908b":"df.shape","b30e57a3":"df.info()","d56c09af":"df.describe()","37298c86":"df.isnull().sum()","8cece602":"plt.figure(figsize=(12,6))\nsns.displot(data=df,x='charges',kde=True)","4ad30844":"round(df['smoker'].value_counts()\/df.shape[0]*100,2).plot.pie(autopct='%1.1f%%',colors=['#33cccc','#ff6666'])","658e7926":"sns.catplot(data=df,x='smoker',y='charges')","b1540835":"#Relation between smoker and Charges\nfig = px.scatter(df, \n                 x='smoker', \n                 y='charges', \n                 opacity=0.8, \n                 hover_data=['sex'], \n                 title='smoker vs. Charges')\nfig.update_traces(marker_size=5)\nfig.show()","4103fa26":"sns.barplot(x=df['smoker'],y=df['charges'])\nplt.xticks(rotation='vertical')\nplt.show()","3799878d":"fig = px.histogram(df, \n                   x='age', \n                   marginal='box', \n                   nbins=47, \n                   title='Distribution of Age')\nfig.update_layout(bargap=0.1)\nfig.show()","e60bc708":"#py.plot(fig,filename='Distribution of Age',auto_open=True)","35b136b0":"#Relation between age and Charges\nplt.figure(figsize=(10,12))\nfig = px.scatter(df, \n                 x='age', \n                 y='charges', \n                 color='smoker', \n                 opacity=0.8, \n                 hover_data=['sex'], \n                 title='Age vs. Charges')\nfig.update_traces(marker_size=5)\nfig.show()","bb7bfd14":"#py.plot(fig,filename='Age vs. Charges due to smoker',auto_open=True)","27dcb1dd":"fig = px.histogram(df, \n                   x='bmi', \n                   marginal='box', \n                   color_discrete_sequence=['red'], \n                   title='Distribution of BMI (Body Mass Index)')\nfig.update_layout(bargap=0.1)\nfig.show()","add3315a":"#py.plot(fig,filename='Distribution of BMI (Body Mass Index)',auto_open=True)","1655767d":"#Relation between BMI and Charges\nfig = px.scatter(df, \n                 x='bmi', \n                 y='charges', \n                 color='smoker', \n                 opacity=0.8, \n                 hover_data=['sex'], \n                 title='BMI vs. Charges')\nfig.update_traces(marker_size=5)\nfig.show()","aac22985":"#py.plot(fig,filename='BMI vs. Charges due to smoker',auto_open=True)","1fd0bb80":"sns.catplot(x=\"children\", kind=\"count\", palette=\"ch:.25\", data=df)","a1440732":"fig = px.scatter(df, \n                 x='children', \n                 y='charges', \n                 color='smoker', \n                 opacity=0.8, \n                 hover_data=['sex'], \n                 title='Children vs. Charges')\nfig.update_traces(marker_size=5)\nfig.show()","09b175c6":"#py.plot(fig,filename='children vs. Charges due to smoker',auto_open=True)","9704f70e":"round(df['sex'].value_counts()\/df.shape[0]*100,2).plot.pie(autopct='%1.1f%%',colors=['skyblue','pink'])","d27d1f76":"sns.catplot(data=df,x='sex',y='charges')","a45959bb":"sns.catplot(data=df,x='sex',y='charges',hue='smoker')","80c7d24e":"#relation between region & charges\nsns.catplot(data=df,x='region',y='charges')","5b8fb043":"sns.catplot(data=df,x='region',y='charges',hue='smoker')","1787023a":"def normalize(col):\n    return (df[col]-df[col].min())\/(df[col].max()-df[col].min())","fe284ff9":"normalize('charges')","0bd684a4":"df['charges']","434e10ff":"#sns.set_theme(style=\"whitegrid\")\n#ax = sns.boxplot(x=df[\"charges\"], palette=\"Set3\")","cd802bcf":"df['region'].value_counts()","1e1e2ae0":"from sklearn.preprocessing import LabelEncoder","7571f0ac":"LE={}\nfor col in ['sex','smoker','region']:\n    LE[col]=LabelEncoder()\n    df[col]=LE[col].fit_transform(df[col])","9caf81c9":"df","16aea5a5":"plt.figure(figsize=(10,8))\nsns.heatmap(df.corr(),cbar=True,annot=True)","fbc849f3":"x=df.drop('charges',axis=1)\ny=df['charges']","29a79886":"from sklearn.model_selection import train_test_split","a97e06f5":"X_train ,X_test,Y_train ,Y_test=train_test_split(x,y,test_size=0.15,random_state=0)","76817f29":"X_train.shape","290278b9":"X_test.shape","894f0342":"from sklearn.tree import DecisionTreeRegressor","c2f69439":"dt=DecisionTreeRegressor(max_depth=5,max_features=5,random_state=123)","9d3acc63":"dt.fit(X_train,Y_train)","1c910dfe":"print('Train score : ',dt.score(X_train,Y_train)*100,'%')","dd9c418c":"print(\"Test score : \",dt.score(X_test,Y_test)*100,'%')","23522b5e":"new=[[24,0,30.5,2,1,4]]\ndt.predict(new)","f9377538":"from sklearn.ensemble import RandomForestRegressor\nrf = RandomForestRegressor(n_estimators=80,max_depth=6,max_features=5,random_state=123)","30716c75":"rf.fit(X_train,Y_train)","010556a9":"print('Train score : ',rf.score(X_train,Y_train)*100,'%')","449699fd":"print(\"Test score : \",rf.score(X_test,Y_test)*100,'%')","91085d4f":"rf.predict(new)","81ff49ea":"from sklearn.linear_model import LinearRegression","afa8631f":"lr=LinearRegression()","eceaed98":"lr.fit(X_train,Y_train)","0c31100b":"print('Train score : ',lr.score(X_train,Y_train)*100,'%')","d3a46797":"print(\"Test score : \",lr.score(X_test,Y_test)*100,'%')","3ddbef03":"lr.predict(new)","35ed2954":"from sklearn.svm import SVR","892eaae7":"svr=SVR(kernel='rbf')","a0a7a8d9":"svr.fit(X_train,Y_train)","a58693d6":"print('Train score : ',svr.score(X_train,Y_train)*100,'%')","de78cb43":"print(\"Test score : \",svr.score(X_test,Y_test)*100,'%')","3c10348b":"svr.predict(new)","2bb45a4a":"from sklearn.neighbors import KNeighborsRegressor\nkreg = KNeighborsRegressor(n_neighbors=25)","26b417a3":"kreg.fit(X_train,Y_train)","a0ed13c2":"print('Train score : ',kreg.score(X_train,Y_train)*100,'%')","9d309e80":"print(\"Test score : \",kreg.score(X_test,Y_test)*100,'%')","a0d79a9b":"kreg.predict(new)","5e4538b2":"# Test & Train","48583c97":"\n### **`Samsung Innovation Campus || SIC`**\n_______\n  >   -  Hadeer Emad\n  >   - Abdelrahman Ehab\n  >   - zyad Farag","f24ad6df":"# KNN Regressor","024d7623":"_____\n_____","4adc3129":"# Random Forest Regressor","3e2396a5":"## Decision Tree","5d5c05fc":"    - charges & smoker have a strong positive correlation\n    - charges & age have a weak positive correlation\n    - charges & bmi have a weak positive correlation\n    - charges & children have a very weak positive correlation\n    - charges & sex have a very weak positive correlation\n    - charges & region have a very very weak negative correlation","a7901843":"# SVR","6d5b7d1b":"# Linear Regression","82cba34a":"# Medical Cost \n  > **`Insurance dataset`**","08e6c335":"________\n________\n________\n","c3a2546e":"    No missing values","ff8819d7":"__________\n_________\n# **`The Best for this data`**\n____________\n_________"}}