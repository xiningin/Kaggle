{"cell_type":{"7b246bab":"code","eef28722":"code","eca5c740":"code","9a267900":"code","ba916ef1":"code","28c53f25":"code","2c2eadae":"code","059437c1":"code","83681a99":"code","d85ffb09":"code","e5c59689":"code","acd81645":"code","33f88bd7":"code","cf0fffe3":"code","0fb20827":"code","618f2b58":"code","4e2053b4":"markdown","3e47b5c6":"markdown","568cff38":"markdown","1c42d76e":"markdown","c2394c41":"markdown","2bf5a4fe":"markdown"},"source":{"7b246bab":"# Import Libraries\nfrom sklearn import datasets\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport seaborn as sns","eef28722":"# Load Data\niris = datasets.load_iris()\niris_y = iris.target\niris = pd.DataFrame(iris.data,columns=iris.feature_names)\niris.sample(5)","eca5c740":"# Check Data Quality\n(((iris.isna()*1).sum())\/len(iris))*100","9a267900":"# Project data into scatter plot to see the correlation\nfig = plt.figure(figsize=(12,6))\nax_sp = fig.add_subplot(121)\nax_pt = fig.add_subplot(122)\nax_sp.scatter(x=iris['sepal length (cm)'],y=iris['sepal width (cm)'])\nax_pt.scatter(x=iris['petal length (cm)'],y=iris['petal width (cm)'])","ba916ef1":"# Distribution of Sepal and Petal values\nfig = plt.figure(figsize=(12,6))\nax_spl = fig.add_subplot(221)\nax_spw = fig.add_subplot(222)\nax_ptl = fig.add_subplot(223)\nax_ptw = fig.add_subplot(224)\nsns.kdeplot(iris['sepal length (cm)'],ax=ax_spl,shade=True,color='blue')\nsns.kdeplot(iris['sepal width (cm)'],ax=ax_spw,shade=True,color='red')\nsns.kdeplot(iris['petal length (cm)'],ax=ax_ptl,shade=True,color='green')\nsns.kdeplot(iris['petal width (cm)'],ax=ax_ptw,shade=True,color='orange')","28c53f25":"# Normalise the data into 0 - 1 range\ndef NormVar(data):\n    return ((data - data.min())\/(data.max() - data.min()))","2c2eadae":"# Distribution of Sepal and Petal values after applying normalisation\nfig = plt.figure(figsize=(16,6))\nax_spl = fig.add_subplot(221)\nax_spw = fig.add_subplot(222)\nax_ptl = fig.add_subplot(223)\nax_ptw = fig.add_subplot(224)\nsns.kdeplot(NormVar(iris['sepal length (cm)']),ax=ax_spl,shade=True,color='blue')\nsns.kdeplot(NormVar(iris['sepal width (cm)']),ax=ax_spw,shade=True,color='red')\nsns.kdeplot(NormVar(iris['petal length (cm)']),ax=ax_ptl,shade=True,color='green')\nsns.kdeplot(NormVar(iris['petal width (cm)']),ax=ax_ptw,shade=True,color='orange')","059437c1":"# Apply Noramlisation into the data set to bring them between 0 and 1\nfor i in iris.columns:\n    iris[i] = NormVar(iris[i])\niris.head()","83681a99":"# Lets look at correlation between variables\nplt.figure(figsize=(12,6))\nsns.heatmap(iris.corr(),annot=True)","d85ffb09":"# As there is a very high correlation between petal length and Width, lets combine to make single column.\niris['petal'] = NormVar(iris['petal length (cm)'] * iris['petal length (cm)'])\nsns.kdeplot(iris['petal'],shade=True)","e5c59689":"# Drop the 2 columns as they are redundant now\niris = iris.drop(['petal length (cm)','petal width (cm)'],axis=1)","acd81645":"from sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn import metrics\nfrom sklearn.neighbors import KNeighborsClassifier","33f88bd7":"# Split Data into training and testing sets\nX_train,X_test,y_train,y_test = train_test_split(iris,iris_y,test_size=0.3)","cf0fffe3":"print(\"Shape of Train\/Test Data:\")\nprint(\"=> Train X : \",X_train.shape)\nprint(\"=> Train y : \",y_train.shape)\nprint(\"=> Test X  : \",X_test.shape)\nprint(\"=> Test y  : \",y_test.shape)","0fb20827":"# fit the model with different values of n_neighbors, and plot the accuracy score\nacc=list()\nfor i in range(1,11):\n    model = KNeighborsClassifier(n_neighbors=i)\n    model.fit(X_train,y_train)\n    pred = model.predict(X_test)\n    acc.append(round(metrics.accuracy_score(pred,y_test)*100,2))\nplt.plot(acc)","618f2b58":"# get the final predictions\nmodel = KNeighborsClassifier(n_neighbors=10)\nmodel.fit(X_train,y_train)\npred = model.predict(X_test)\nround(metrics.accuracy_score(pred,y_test)*100,2)","4e2053b4":"<h3>Observations:<\/h3>\n<ul>\n    <ol>=> There seems to be no important correlation between Sepal length and width<\/ol>\n    <ol>=> There is a linear correlation between Sepal length and width<\/ol>\n<\/ul>","3e47b5c6":"<h2>Exploratory Data Analysis<\/h2>","568cff38":"<title>IRIS  Dataset Analysis and Prediction<\/title>","1c42d76e":"<h3>Observations:<\/h3>\n<ul>\n    <ol>=> Sepal Length and Width data is normally distributed<\/ol>\n    <ol>=> Petal Length and Width data has a bimodal distribution<\/ol>\n<\/ul>","c2394c41":"<h2>Predictive Analytics using KNN<\/h2>","2bf5a4fe":"<h1>Iris Dataset - Data Analysis and Predictions<\/h1>"}}