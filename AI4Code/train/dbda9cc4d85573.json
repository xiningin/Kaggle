{"cell_type":{"796f311a":"code","18ec5a02":"code","e91722d7":"code","ff19f844":"code","f181a35d":"code","bc1666c8":"code","ab90787b":"code","ae962544":"code","9320a9c6":"code","394f8b3e":"code","e40f3f3d":"code","58dd33cd":"code","ea714fb1":"markdown","d34744ea":"markdown","43fdb682":"markdown","db6ade0e":"markdown","3a577bfb":"markdown","12c84c5c":"markdown","32700bc0":"markdown","4b4f7a77":"markdown","f1e150af":"markdown"},"source":{"796f311a":"from IPython.display import clear_output\n!pip3 install pycaret --user\nclear_output()\n\n\nimport numpy as np\nimport pandas as pd \n\nimport os\nimport random\n\nfrom pycaret.regression import *","18ec5a02":"TRAIN_PATH = \"..\/input\/tabular-playground-series-jan-2022\/train.csv\"\nTEST_PATH = \"..\/input\/tabular-playground-series-jan-2022\/test.csv\"\nSAMPLE_SUBMISSION_PATH = \"..\/input\/tabular-playground-series-jan-2022\/sample_submission.csv\"\nSUBMISSION_PATH = \"submission.csv\"\n\nID = \"row_id\"\nTARGET = \"num_sold\"\n\nMODEL_NAME = \"lightgbm\"\nCRITERIA = 'MAPE'\nPYCARET_TARGET_NAME = \"Label\"\n\nSEED = 777\n\ndef seed_everything(seed: int = SEED):\n    random.seed(seed)\n    np.random.seed(seed)\n    os.environ[\"PYTHONHASHSEED\"] = str(seed)\n    \nseed_everything()","e91722d7":"train = pd.read_csv(TRAIN_PATH)\ntest = pd.read_csv(TEST_PATH)","ff19f844":"setup(\n    data=train,\n    target=TARGET,\n    silent=True,\n    ignore_features=[ID]\n)","f181a35d":"model = create_model(MODEL_NAME)","bc1666c8":"predict_model(model)","ab90787b":"tuneModel = tune_model(model,optimize = CRITERIA)","ae962544":"predict_model(tuneModel)","9320a9c6":"finalModel = finalize_model(tuneModel)","394f8b3e":"predict_model(finalModel)","e40f3f3d":"pred_test = predict_model(finalModel, data=test)\npred_test[:5]","58dd33cd":"submission = pd.read_csv(SAMPLE_SUBMISSION_PATH)\nsubmission[TARGET]=pred_test[PYCARET_TARGET_NAME]\nsubmission.to_csv(SUBMISSION_PATH,index=False)\nsubmission.head()","ea714fb1":"# init pycaret","d34744ea":"# global variables ","43fdb682":"# build default model","db6ade0e":"# predict test data ","3a577bfb":"# select best model ","12c84c5c":"# make submission csv ","32700bc0":"# installs & imports","4b4f7a77":"# load data","f1e150af":"# optimize model"}}