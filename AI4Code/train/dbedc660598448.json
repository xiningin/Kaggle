{"cell_type":{"3d2db4be":"code","fd34b587":"code","4d1018c9":"code","812ba76e":"code","39efbf4d":"code","5bf56ad5":"code","ba82a41f":"code","a2d6cd22":"code","ec17e99d":"code","dfdea092":"code","dd8b3835":"markdown","7be4ab06":"markdown","4717f618":"markdown","c8ee0739":"markdown","f217e242":"markdown"},"source":{"3d2db4be":"import pandas as pd\nimport numpy as np\nfrom statistics import mean\nfrom tqdm import tqdm\nimport seaborn as sns\nfrom matplotlib import pyplot as plt\npd.set_option('display.max_rows', None)","fd34b587":"%%writefile submission1.py\nfrom kaggle_environments.envs.mab.mab import Observation, Configuration\n\n#\n# Paste your agent below\n#\n\nimport math\nimport random\n\ndef ucb_agent(observation, configuration):    \n    return random.randrange(configuration.banditCount)","4d1018c9":"%%writefile submission2.py\nfrom kaggle_environments.envs.mab.mab import Observation, Configuration\n\n#\n# Paste your agent below\n#\n\nimport math\nimport random\n\ndef ucb_agent(observation, configuration):    \n    return random.randrange(configuration.banditCount)","812ba76e":"!pip install kaggle-environments --upgrade","39efbf4d":"from kaggle_environments import evaluate, make, utils\n\nenv = make(\"mab\", debug=True)","5bf56ad5":"N = 300\nfreq = [0] * 100\ndf = pd.DataFrame()\ncount_m = []\n# repeat simulation N times\nfor i in tqdm(range(N)):\n    env.reset()\n    env.run([\"submission1.py\", \"submission2.py\"])\n    df_tmp = pd.DataFrame({\"trial\" : [i+1]*100,\"Machine\" : list(range(100)), \"threshold\" : env.__dict__['steps'][0][0]['observation']['thresholds']})\n    df = df.append(df_tmp)\n    count_m.append(mean(env.__dict__['steps'][0][0]['observation']['thresholds']))","ba82a41f":"# initial threshold of each machine\nsns.set()\nplt.figure(figsize=(20,10))\nsns.swarmplot(x=\"Machine\", y=\"threshold\", data=df)","a2d6cd22":"# box plot of initial thresholds\nplt.figure(figsize=(20,10))\nsns.boxplot(x=\"Machine\", y=\"threshold\", data=df)","ec17e99d":"# correlation between mechines\ncor_mat = np.corrcoef(df.pivot(values=['threshold'], index = [\"trial\"], columns=['Machine']).T)\nplt.figure(figsize=(15,15))\nsns.set(color_codes=True, font_scale=1.2)\n\nax = sns.heatmap(\n    cor_mat, \n    vmin=-1, vmax=1, center=0,\n    cmap=sns.diverging_palette(20, 220, n=200),\n    square=True\n)\nax.set_xticklabels(\n    ax.get_xticklabels(),\n    rotation=90,\n    horizontalalignment='right'\n)\n\nplt.show()","dfdea092":"# histgram of mean of initial thresholds\nplt.figure(figsize=(20,10))\nsns.distplot(count_m)","dd8b3835":"get the latest kaggle environments","7be4ab06":"**Repeated simulation many times and checked if the initil threshold is biased.**","4717f618":"Save number of selected machine to *df_selec*t and select logs to *df_log*.","c8ee0739":"# Santa 2020 Visualization of agents   ","f217e242":"Any bias in initial threshold cannot be seen. :)"}}