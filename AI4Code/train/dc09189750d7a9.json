{"cell_type":{"b46da5ba":"code","903317c9":"code","1731371b":"code","986de355":"code","79a08b3b":"code","d0005185":"code","ee033ad1":"code","2f7198ae":"code","1054ca51":"code","686b1dcf":"code","31e93dc2":"code","2bc1037c":"code","c391e296":"code","f77dbf16":"code","3a7d350e":"code","537df9cd":"code","95dbfc56":"code","c6386a9d":"code","136eebea":"code","607079a7":"code","487756be":"code","18d0181d":"code","ddb82e38":"markdown","8162b4ce":"markdown","bc39616a":"markdown","3be17388":"markdown","208d1e44":"markdown","30d2c434":"markdown","d89e5790":"markdown","d7ea1abf":"markdown","dce17c9b":"markdown","3e21ce24":"markdown","cc2cb293":"markdown","61a96c27":"markdown","0e04af89":"markdown","4d1fc2a2":"markdown","e51be196":"markdown","9898e451":"markdown","d0d08333":"markdown","1a2cfc4e":"markdown","eab731c4":"markdown","137c95f3":"markdown","0aecefad":"markdown","e8beffbe":"markdown","c2121bce":"markdown","da6c0503":"markdown","4bef4e55":"markdown","211e9d0a":"markdown"},"source":{"b46da5ba":"# EDA\n#---------------------\nimport numpy as np\nimport pandas as pd\n\n\n# Visualization\n#---------------------\n%matplotlib inline\nimport matplotlib.pyplot as plt\nfrom matplotlib.lines import Line2D\nimport seaborn as sns\n\n# Scaling\nfrom sklearn.preprocessing import StandardScaler\n\n# Dimensional\nfrom sklearn.decomposition import PCA\n\n# Clustering\nfrom sklearn.cluster import KMeans","903317c9":"data = pd.read_csv('..\/input\/mall-customers\/Mall_Customers.csv')","1731371b":"data.shape","986de355":"data.head()","79a08b3b":"data.info()","d0005185":"data.rename(columns = {'Genre':'Gender'} , inplace = True)","ee033ad1":"data.describe()","2f7198ae":"data.drop(labels = 'CustomerID' , axis = 1 , inplace = True)","1054ca51":"data.isnull().sum()","686b1dcf":"data.dtypes","31e93dc2":"data['Gender'].value_counts()","2bc1037c":"data['Gender'].replace({'Male':1 , 'Female':0} , inplace = True)","c391e296":"data.info()","f77dbf16":"sns.heatmap(data = data.corr() , annot = True , fmt = '.2f' , cmap = 'coolwarm')","3a7d350e":"plt_font = {'family':'serif' , 'size':16}\nplt.subplots_adjust(left = 1 , bottom = 1 , right = 2.5 , top = 2 , wspace = 0.5 , hspace = None)\n\n\nplt.subplot(1,2,1)\nplt.pie(x = [len(data[data.Gender == 1]) , len(data[data.Gender == 0])] , labels = ['Male' , 'Female']\n       , shadow = True , startangle = -30 , explode = [0.1,0] , autopct = '%.0f%%')\n\nplt.title(\"Customers gender\" , fontdict = plt_font)\n\nplt.subplot(1,2,2)\n\nmale_avg_score = data[data.Gender == 1]['Spending Score (1-100)'].mean()\nfemale_avg_score = data[data.Gender == 0]['Spending Score (1-100)'].mean()\n\nplt.bar(x = ['Male' , 'Female'] , height = [male_avg_score , female_avg_score] , color = ['tab:blue' , 'tab:orange'])\nplt.title('Customers spending score' , fontdict = plt_font)\nplt.ylabel('Average spending score' , fontdict = plt_font)\nplt.xlabel('Gender' , fontdict = plt_font)\n\nplt.text(-0.3 , 40 , 'Average = {:.2f}'.format(male_avg_score))\nplt.text(0.7 , 40 , 'Average = {:.2f}'.format(female_avg_score))\n\nplt.show()","537df9cd":"age_list = data.Age.unique()\nage_list.sort()\navg_list = []\n\n\nfor age in age_list:\n    avg_list.append(data[data.Age == age]['Spending Score (1-100)'].mean())\n\nplt.plot(age_list,avg_list)\nplt.xlabel('Age' , fontdict = plt_font)\nplt.ylabel('Average spending score' , fontdict = {'family':'serif' , 'size':14})\nplt.title('Spending score in different ages')\n\nplt.plot([20,70] , [40,40] , linestyle = '--' , c = 'tab:orange' , alpha = 0.8)\n\nplt.plot([35,35] , [10,90] , linestyle = '--' , c = 'tab:red' , alpha = 0.8)\nplt.text(31,7,'Age = 35')\nplt.show()","95dbfc56":"sc = StandardScaler()\ndata_scaled = sc.fit_transform(data)","c6386a9d":"pca = PCA(n_components = 2)\ndata_pca = pca.fit_transform(data_scaled)\nprint(\"data shape after PCA :\",data_pca.shape)","136eebea":"wcss_list = []\nfor i in range(1, 15):\n    kmeans = KMeans(n_clusters = i , init = 'k-means++'  , random_state = 1)\n    kmeans.fit(data_pca) \n    wcss_list.append(kmeans.inertia_)\n\nplt.plot(range(1,15) , wcss_list)\nplt.plot([4,4] , [0 , 500] , linestyle = '--' , alpha = 0.7)\nplt.text(4.2 , 300 , 'Elbow = 4')\nplt.xlabel('K' , fontdict = plt_font)\nplt.ylabel('WCSS' , fontdict = plt_font)\nplt.show()","607079a7":"kmeans = KMeans(n_clusters = 4 , init = 'k-means++'  , random_state = 1)\nkmeans.fit(data_pca)\ncluster_id = kmeans.predict(data_pca)","487756be":"result_data = pd.DataFrame()\nresult_data['PC1'] = data_pca[:,0]\nresult_data['PC2'] = data_pca[:,1]\nresult_data['ClusterID'] = cluster_id","18d0181d":"cluster_colors = {0:'tab:red' , 1:'tab:green' , 2:'tab:blue' , 3:'tab:pink'}\ncluster_dict = {'Centroid':'tab:orange','Cluster0':'tab:red' , 'Cluster1':'tab:green'\n                , 'Cluster2':'tab:blue' , 'Cluster3':'tab:pink'}\n\n\nplt.scatter(x = result_data['PC1'] , y = result_data['PC2'] \n                , c = result_data['ClusterID'].map(cluster_colors))\nhandles = [Line2D([0], [0], marker='o', color='w', markerfacecolor=v, label=k, markersize=8) for k, v in cluster_dict.items()]\nplt.legend(title='color', handles=handles, bbox_to_anchor=(1.05, 1), loc='upper left')\n\nplt.scatter(x = kmeans.cluster_centers_[:,0] , y = kmeans.cluster_centers_[:,1] , marker = 'o' , c = 'tab:orange'\n            , s = 150 , alpha = 1)\n\nplt.title(\"Clustered by KMeans\" , fontdict = plt_font)\nplt.xlabel(\"PC1\" , fontdict = plt_font)\nplt.ylabel(\"PC2\" , fontdict = plt_font)\n\nplt.show()","ddb82e38":"<a id = \"3\"><\/a>\n## 3. EDA","8162b4ce":"<h1>Data<\/h1>\n\n- <h2><a href=\"https:\/\/www.kaggle.com\/shwetabh123\/mall-customers\">Source<\/a><\/h2>","bc39616a":"<a id = \"1\"><\/a>\n## 1. Importing the libraries","3be17388":"<a id = \"6_2\"><\/a>\n<h2 style=\"color:#005b96\">6-2. KMeans clustered plot<\/h2>","208d1e44":"<a id = \"5_2\"><\/a>\n<h2 style=\"color:#005b96\">5-2. Relation between gender and spending score<\/h2>","30d2c434":"- <h2 style = \"color:#009b96\">Heatmap is showing that spending score has a higher correlation with customer age<\/h2>\n- <h2 style = \"color:#009b96\">we will analyze the relation between age and spending score<\/h2>","d89e5790":"<h1 style=\"color:tomato\">A simple combination of <u>PCA<\/u> & <u>KMeans<\/u><\/h1>","d7ea1abf":"<a id = \"4\"><\/a>\n## 4. Data Preprocessing","dce17c9b":"<a id = \"6\"><\/a>\n## 6. KMeans Clustering","3e21ce24":"<h2 style=\"color:#005b96\">Everything seems to be good until now.<br><br>I will do <u>scaling<\/u> and <u>Dimensionality reduction<\/u> after some visualization.<\/h2>","cc2cb293":"<a id = \"4_4\"><\/a>\n<h2 style=\"color:#005b96\">4-4. Scaling<\/h2>","61a96c27":"<a id = \"4_2\"><\/a>\n<h2 style=\"color:#005b96\">4-2. Missing values<\/h2>","0e04af89":"<a id = \"5\"><\/a>\n## 5. Strorytelling - Visualization","4d1fc2a2":"<a id = \"2\"><\/a>\n## 2. Load and Prepare Data","e51be196":"- <h2 style = \"color:#009b96\">It's a little tricky but customers with lower ages have more average spending score.<\/h2>\n- <h2 style = \"color:#009b96\">As you see the plot is showing that customers younger than 35 have more average spending score.<\/h2>","9898e451":"- <h3>K is a hyperparameter in KMeans algorithm.<\/h3>\n- <h3>WCSS : Within Cluster Sum of Squares, in other word it's sum of squared distance between each point and the centroid in a cluster<\/h3>\n- <h3>Lower WCSS shows a better clustering(because points in a cluster are more similar to each other, this is what we want)<\/h3>\n- <h3>Increasing the k value always results in a lower WCSS.<\/h3>\n- <h3>if we put k to be equal to the number of samples(so each point is a special cluster) then WCSS = 0 , but this is not a wise way.<\/h3>\n- <h3>Here we will use <u>elbow plot<\/u> to find the best k.<\/h3>\n- <h3>Elbow point will show the best k.<\/h3>\n- <h3>How to find this point ?<\/h3>\n- <h3>After this point the speed of WCSS decreasing will be lowered.<\/h3>","d0d08333":"<a id = \"6_1\"><\/a>\n<h2 style=\"color:#005b96\">6-1. Elbow plot<\/h2>","1a2cfc4e":"<h1 style=\"color:#88bddb\">What will i do in this notebook?<\/h1>\n\n- 1.<a href=\"#1\">Importing the libraries<\/a>\n\n\n- 2.<a href=\"#2\">Load the data<\/a>\n\n\n- 3.<a href=\"#3\">EDA :<\/a>\n\n\n- 4.<a href=\"#4\">Data Preprocessing :<\/a>\n- - 4-1.<a href=\"#4_1\">Drop useless columns<\/a>\n- - 4-2.<a href=\"#4_2\">Missing values<\/a>\n- - 4-3.<a href=\"#4_3\">Encoding<\/a>\n- - 4-4.<a href=\"#4_4\">Scaling<\/a>\n- - 4-5.<a href=\"#4_5\">Dimensionality reduction<\/a>\n\n\n- 5.<a href=\"#5\">Visualization :<\/a>\n- - 5-1.<a href=\"#5_1\">Heatmap: correlation between features<\/a>\n- - 5-2.<a href=\"#5_2\">Relation between gender and spending score<\/a>\n- - 5-3.<a href=\"#5_3\">Relation between age and spending score<\/a>\n\n\n- 6.<a href=\"#6\">KMeans Clustering :<\/a>\n- - 6-1.<a href=\"#6_1\">Elbow plot<\/a>\n- - 6-2.<a href=\"#6_2\">KMeans clustered plot<\/a>","eab731c4":"<a id = \"4_5\"><\/a>\n<h2 style=\"color:#005b96\">4-5. Dimensionality reduction<\/h2>","137c95f3":"<a id = \"4_1\"><\/a>\n<h2 style=\"color:#005b96\">4-1. Drop useless columns<\/h2>\n- Drop 'CustomerID'","0aecefad":"Clustering algorithms such as K-means do need feature scaling before they are fed to the algorithm. Since, clustering techniques use Euclidean Distance to form the cohorts, it will be wise to scale the variables.\n- <h3>here our problem is clustering and we dont have any label or target feature.<br>So we assume that all of the features are input features.<\/h3>","e8beffbe":"- <h2 style = \"color:#009b96\">The first subplot is showing that our female customers are more than our male customers.<\/h2>\n- <h2 style = \"color:#009b96\">Also the second subplot is showing that our female customers have more spending score on average.<\/h2>","c2121bce":"<a id = \"5_3\"><\/a>\n<h2 style=\"color:#005b96\">5-3. Relation between age and spending score<\/h2>","da6c0503":"- <h3>Our data is a 4 dimensional data.<\/h3>\n- <h3>It's impossible for us to see this space with naked eyes.<\/h3>\n- <h3>PCA projects the data into a lower dimension, allowing us to visualize the data in a 2D or 3D space with a naked eye.<\/h3>\n- <h3>Here we reduce the dimension to a 2D space.<\/h3>","4bef4e55":"<a id = \"4_3\"><\/a>\n<h2 style=\"color:#005b96\">4-3. Encoding<\/h2>","211e9d0a":"<a id = \"5_1\"><\/a>\n<h2 style=\"color:#005b96\">5-1. Heatmap: correlation between features<\/h2>"}}