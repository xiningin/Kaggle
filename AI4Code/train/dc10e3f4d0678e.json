{"cell_type":{"29df5134":"code","30d8619f":"code","7bd0a09e":"code","3f23d6d3":"code","a67a6d71":"code","51f262e9":"code","93414ec6":"code","4cc63221":"code","b1374194":"code","f3cd861f":"code","9d894921":"code","91fee563":"code","4230729c":"code","04b82488":"code","892622e4":"code","ab11c63f":"code","ac6b9312":"code","7adcd2ef":"code","9309c73b":"code","34fdb9ea":"code","31fdb67c":"code","f93d0a7e":"code","3dc75077":"code","5afb43e7":"code","6f7f7463":"code","b3e0a881":"code","f090e7bb":"code","9d504b82":"code","5d45351d":"code","fb95c6fe":"code","bf7ae168":"code","1761aa8a":"code","f64fccd2":"code","11be9889":"code","271e9264":"code","677853e4":"code","25f73cff":"code","627f9cae":"code","10c098e6":"code","3930ea1d":"code","bf45806d":"code","b508eb61":"code","a94e9f15":"code","aaf7c320":"code","75009ba2":"code","70dd2a6c":"code","b6b845f1":"code","a36cc0c8":"code","3c53b7cd":"code","e13531f1":"code","0ccc1b99":"code","9743624d":"code","960e7b8d":"code","6729b2d8":"code","22cecbaa":"markdown","f940ad79":"markdown","c4fe48a4":"markdown","e2145594":"markdown","a456f31e":"markdown","ccce206a":"markdown","03efcf31":"markdown"},"source":{"29df5134":"import pandas as pd\nfilepath = '..\/input\/melbourne-housing-snapshot\/melb_data.csv'","30d8619f":"data = pd.read_csv(filepath)","7bd0a09e":"data.describe()","3f23d6d3":"#data.columns()","a67a6d71":"data = data.dropna(axis=0)","51f262e9":"data","93414ec6":"y = data.Price","4cc63221":"y","b1374194":"X = data[['Rooms', 'Bathroom', 'Landsize', 'Lattitude', 'Longtitude', 'Regionname']]","f3cd861f":"X.head(50)","9d894921":"X.head()","91fee563":"from sklearn.tree import DecisionTreeRegressor","4230729c":"model = DecisionTreeRegressor(random_state=0)","04b82488":"model.fit(X, y)","892622e4":"print(model.predict(X.head()))","ab11c63f":"y.head()","ac6b9312":"from sklearn.metrics import mean_absolute_error","7adcd2ef":"predictedY = model.predict(X)","9309c73b":"mean_absolute_error(y, predictedY)","34fdb9ea":"from sklearn.model_selection import train_test_split","31fdb67c":"a, b = [1,2]","f93d0a7e":"train_X, test_X, train_y, test_y = train_test_split(X, y, random_state=0)","3dc75077":"model2 = DecisionTreeRegressor(random_state=0)","5afb43e7":"model2.fit(train_X, train_y)","6f7f7463":"predictionsTestX = model2.predict(test_X)","b3e0a881":"mean_absolute_error(test_y, predictionsTestX)","f090e7bb":"def getMAE(nodes, train_X, train_y, test_X, test_y):\n    model = DecisionTreeRegressor(max_leaf_nodes=nodes, random_state=0)\n    model.fit(train_X, train_y)\n    predictions = model.predict(test_X)\n    return(mean_absolute_error(test_y, predictions))","9d504b82":"def mae(a,b):\n    return(mean_absolute_error(a,b))","5d45351d":"for num in [750,760,770,780,790,800,810,820,830,840,850]:\n    val = getMAE(num, train_X, train_y, test_X, test_y)\n    print(\"Nodes: {}; MAE: {}\".format(num, val))","fb95c6fe":"from sklearn.ensemble import RandomForestRegressor","bf7ae168":"model = RandomForestRegressor(random_state=0)","1761aa8a":"model.fit(train_X, train_y)","f64fccd2":"predictions = model.predict(test_X)","11be9889":"mean_absolute_error(test_y, predictions)","271e9264":"from sklearn.model_selection import train_test_split\ndata = pd.read_csv(\"..\/input\/home-data-for-ml-course\/train.csv\", index_col=\"Id\")\ny = data.SalePrice\nfeatures = ['LotArea', 'YearBuilt', '1stFlrSF', '2ndFlrSF', 'FullBath', 'BedroomAbvGr', 'Neighborhood']\nX = data[features].copy()\nX_train, X_test, y_train, y_test = train_test_split(X, y,train_size=0.8, test_size=0.2, random_state=0)","677853e4":"missingDataColumns = [col for col in train_X.columns if train_X[col].isnull().any()]","25f73cff":"missingDataColumns","627f9cae":"sX_train = train_X.drop(missingDataColumns, axis=1)\nsX_test = test_X.drop(missingDataColumns, axis=1)","10c098e6":"from sklearn.impute import SimpleImputer","3930ea1d":"imputer = SimpleImputer()","bf45806d":"imputed_X_train = pd.DataFrame(imputer.fit_transform(X_train))\nimputed_X_test = pd.DataFrame(imputer.transform(X_test))","b508eb61":"imputed_X_train.columns = X_train.columns\nimputed_X_test.columns = X_test.columns","a94e9f15":"def getMAE(nodes, train_X, train_y, test_X, test_y):\n    model = DecisionTreeRegressor(max_leaf_nodes=nodes, random_state=0)\n    model.fit(train_X, train_y)\n    predictions = model.predict(test_X)\n    return(mean_absolute_error(test_y, predictions))","aaf7c320":"getMAE(790, X_train, y_train, X_test, y_test)","75009ba2":"getMAE(790, imputed_X_train, y_train, imputed_X_test, y_test)","70dd2a6c":"X_train_copy = X_train.copy()\nX_test_copy = X_test.copy()","b6b845f1":"for col in missingDataColumns:\n    X_train_copy[col + '_was_missing'] = X_train_copy[col].isnull()\n    X_test_copy[col + '_was_missing'] = X_test_copy[col].isnull()","a36cc0c8":"imputer2 = SimpleImputer()\nimputed_X_train_copy = pd.DataFrame(imputer2.fit_transform(X_train_copy))\nimputed_X_test_copy = pd.DataFrame(imputer2.transform(X_test_copy))\nimputed_X_train_copy.columns = X_train_copy.columns\nimputed_X_test_copy.columns = X_test_copy.columns","3c53b7cd":"X_train.shape","e13531f1":"missingValCount = (X_train.isnull().sum())\nprint(missingValCount[missingValCount > 0])","0ccc1b99":"tempTuple = (X_train.dtypes == 'object')","9743624d":"tempTuple","960e7b8d":"dropped_X_train = X_train.select_dtypes(exclude=['object'])\ndropped_X_test = X_test.select_dtypes(exclude=['object'])","6729b2d8":"getMAE(790, dropped_X_train, y_train, dropped_X_test, y_test)","22cecbaa":"# Model Validation\n## MAE = Mean Absolute Error","f940ad79":"# Imputation with and Extension","c4fe48a4":"1. Determine the model and the model parameters\n2. Make the training and test data and then fit to the model\n3. Predict the test data\n4. Figure out how accurate the model is and tune to refine it","e2145594":"# Imputation","a456f31e":"1. Analyze Data\n2. Understand Problem\n3. Data Processing\n4. Choose your model\n5. Import model\n6. Create the model with default parameters\n7. Train the model\n8. Evaluate the model\n9. Tune the model to your specifications\n10. Finished the model","ccce206a":"## Traning Data\nThe data used to train the model.\n## Model Accuracy\nHow accurate the data is.","03efcf31":"# Categorical Variables\n## 3 Different Ways\n1. Drop Categorical Variables\n2. Label Encoding\n3. One-Hot Encoding"}}