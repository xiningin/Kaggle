{"cell_type":{"42518f78":"code","0a510406":"code","a7e45b3e":"code","f0e29d08":"code","3b948ddf":"code","4db4b0c2":"code","96d8f112":"code","d8c14232":"code","5f123548":"code","c85560a3":"code","dcef8203":"code","6cd76526":"code","c987f789":"code","ba632c6f":"code","20846c99":"code","c0c18b8a":"code","eba58927":"code","f5623d1d":"code","ca57a54f":"markdown","0b4a118a":"markdown","552d9e97":"markdown","cdb9f2e3":"markdown","0c0a02c6":"markdown","5d3a16bb":"markdown","13ae216e":"markdown","3ac5847e":"markdown","6294c843":"markdown","eb333e7f":"markdown","6cf5d94f":"markdown","b0f7001c":"markdown","c56d07a2":"markdown"},"source":{"42518f78":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns","0a510406":"# Read in Data\ndf = pd.read_csv(\"..\/input\/new-york-city-airbnb-open-data\/AB_NYC_2019.csv\")","a7e45b3e":"df = df.sample(10000, random_state=42)","f0e29d08":"# Look at first 5 lines of data\ndf.head()","3b948ddf":"from sklearn.linear_model import LinearRegression","4db4b0c2":"lr = LinearRegression()\n\nX = df[['number_of_reviews']]\ny = df[['price']]\nlr.fit(X,y) # train the model","96d8f112":"# Coefficient(s)\nlr.coef_","d8c14232":"import statsmodels.api as sm\n\nX = df[['number_of_reviews']].values\ny = df[['price']].values\n\n# fit a OLS model with intercept\nX = sm.add_constant(X)\nmod = sm.OLS(y, X).fit()\n\nprint(mod.summary())","5f123548":"from sklearn.preprocessing import LabelEncoder\n\nlblenc = LabelEncoder()\n\ndf['neighbourhood_group_enc'] = lblenc.fit_transform(df['neighbourhood_group'].ravel())","c85560a3":"# Dummy Variables!\n\nborough_dummy = pd.get_dummies(df[['neighbourhood_group']], drop_first=True)","dcef8203":"lr2 = LinearRegression()\n\nX2 = pd.concat([ df[['number_of_reviews']], borough_dummy ], axis=1)\ny2 = df[['price']]\nlr2.fit(X2,y2) # train the model","6cd76526":"lr2.coef_","c987f789":"from sklearn.model_selection import train_test_split\n\nX = df[['number_of_reviews']].values\ny = df[['price']].values\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.30, random_state=42)","ba632c6f":"lr3 = LinearRegression()\n\nlr3.fit(X_train, y_train)","20846c99":"from sklearn.metrics import mean_squared_error","c0c18b8a":"# Mean Squared Error (MSE)\nmean_squared_error(lr3.predict(X_test), y_test)","eba58927":"# RMSE\nnp.sqrt(mean_squared_error(lr3.predict(X_test), y_test))","f5623d1d":"# from sklearn.model_selection import cross_val_score\n# from sklearn.metrics import mean_squared_error, median_absolute_error, mean_absolute_error, r2_score\n# from sklearn.model_selection import KFold","ca57a54f":"### Next steps...","0b4a118a":"- Regularized Linear Regressions: Ridge, Lasso, Elastic Net\n- Tree\/Forest Algorithms: Decision Tree, Random Forest\n- Other: Support Vector Regression (SVR), K-Nearest Neighbors Regressor(KNN)\n\nAND SO MUCH MORE!","552d9e97":"### OLS Regression","cdb9f2e3":"### How do I evaluate my model?","0c0a02c6":"Overfitting: You are training you model to closely for the training set but for new unseen data, your predictive ability for the model you created is very weak","5d3a16bb":"residual = real actual value - predicted","13ae216e":"### Import Libraries and Read in Data","3ac5847e":"### Simple Linear Regression","6294c843":"In Python (unlike R or STATA), you will get an error if you try to run a regression without encoding categorical variables. \"Encoding\" means the process of converting categorical variables into some form of vector so that the program \/ software can understand and be able to process the regression","eb333e7f":"If you add more features to X and then run LinearRegression(), that becomes Mutlilnear Regression (MLR)","6cf5d94f":"### Categorical Variables...? Encoding...?","b0f7001c":"Other more rigorous Methods:\n\n**Cross Validation**","c56d07a2":"There are various kind of regression algorithms already implemented on Python's Sklearn! Look up blog posts, watch online tutorials and read SKlearn's official documentation to master them all!\n\nhttps:\/\/scikit-learn.org\/stable\/user_guide.html"}}