{"cell_type":{"5791ba3c":"code","0ef68639":"code","c51cedf1":"code","20b83049":"code","eb5cf829":"code","03e13845":"code","c0a99ac8":"code","7b1210eb":"code","fd100b18":"code","548f7ff6":"code","9a7b7b32":"code","1a8f74a2":"code","067dc759":"code","c5e637b4":"code","cdc31482":"code","8224490b":"code","b8901d2d":"markdown","162c9924":"markdown","c5c6e547":"markdown","86c2f0e1":"markdown","2e9438f9":"markdown","6c71281e":"markdown","f4517212":"markdown"},"source":{"5791ba3c":"filename_train = '..\/input\/titanic\/train.csv'\nfilename_test  = '..\/input\/titanic\/test.csv'","0ef68639":"import pandas as pd\n\ndf_train = pd.read_csv(filename_train, index_col='PassengerId')\ndf_test  = pd.read_csv(filename_test, index_col='PassengerId')","c51cedf1":"df_train","20b83049":"df_test","eb5cf829":"drop_cols = ['Name', 'Ticket']\nobj_col = 'Survived'","03e13845":"X_train = df_train.drop(drop_cols + [obj_col], axis=1)\nX_train","c0a99ac8":"X_test = df_test.drop(drop_cols, axis=1)\nX_test","7b1210eb":"y_train = df_train['Survived']\ny_train","fd100b18":"def to_category(df, categorical_cols):\n    df = df.copy()\n    for col in categorical_cols:\n        df[col] = df[col].astype('category')\n    \n    return df","548f7ff6":"categorical_cols=['Sex', 'Cabin', 'Embarked']\nX_train = to_category(X_train, categorical_cols)\nX_test  = to_category(X_test, categorical_cols)","9a7b7b32":"import numpy as np\nimport lightgbm as lgb\nfrom sklearn.metrics import accuracy_score\n\ndef acc_score(preds, data):\n    y_true = data.get_label()\n    y_pred = np.where(preds > 0.5, 1, 0)\n    acc = accuracy_score(y_true, y_pred)\n    return 'acc', acc, True\n\nlgb_train = lgb.Dataset(X_train, y_train)\n\nparams = {\n    'objective': 'binary',    \n    'min_data_in_leaf': 15,  \n    'force_row_wise': True,\n}\n\ncv_rslt = lgb.cv(params, \n                 lgb_train, \n                 nfold=5, \n                 num_boost_round=10000, \n                 early_stopping_rounds=100,               \n                 feval=acc_score,\n                 return_cvbooster=True)","1a8f74a2":"cvbooster = cv_rslt['cvbooster']","067dc759":"cv_rslt['acc-mean']","c5e637b4":"import scipy\n\ny_preds = cvbooster.predict(X_test, num_iteration=cvbooster.best_iteration)\ny_preds = np.round(y_preds)\ny_test = scipy.stats.mode(y_preds)[0].squeeze()\ny_test = pd.Series(y_test, name=obj_col).astype(int)\ny_test","cdc31482":"answer = pd.concat([df_test.index.to_series().reset_index(drop=True), y_test], axis=1)\nanswer","8224490b":"filename_output = '.\/submission.csv'\nanswer.to_csv(filename_output, index=False)","b8901d2d":"# Modeling","162c9924":"## Objective variables","c5c6e547":"# Prediction","86c2f0e1":"## Explanatory variables","2e9438f9":"## Change object-type to category-type","6c71281e":"# Load files","f4517212":"# Preprocessing"}}