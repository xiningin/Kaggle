{"cell_type":{"2d8c2f42":"code","7f03371c":"code","4c11a440":"code","7b73a5cc":"code","afa237ca":"code","f9b666d1":"code","a4821d1b":"code","a453cf48":"code","2b9e57ff":"code","731cee29":"code","9089c4b1":"code","1614e2c4":"markdown","23f635a3":"markdown","9bfc18ec":"markdown","7d484e87":"markdown"},"source":{"2d8c2f42":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\nimport seaborn as sns\nfrom tqdm import tqdm\nimport re\nimport joblib\nimport gc\nfrom scipy import stats\n\nimport lightgbm as lgb\nfrom sklearn.model_selection import KFold, StratifiedKFold\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.metrics import accuracy_score\n\nimport sys\nsys.path.append('..\/input\/pycaret\/pyod')\nsys.path.append('..\/input\/pycaret\/pycaret')\nfrom pycaret.classification import *\n\nimport warnings\nwarnings.simplefilter('ignore')","7f03371c":"# Load data\ntrain = pd.read_pickle('..\/input\/tpsfeb2022-ds-to-pickle-with-folds\/train.pkl')\ntrain.drop(['5_folds', '10_folds', '20_folds'], axis=1, inplace=True)\ntrain = train.sample(frac=1)","4c11a440":"#Drop douplicates, credit: https:\/\/www.kaggle.com\/sfktrkl\/tps-feb-2022\ntrain.drop_duplicates(keep='first', inplace=True)","7b73a5cc":"print(train.shape)\ntrain.head()","afa237ca":"le = LabelEncoder()\ntrain.target = le.fit_transform(train.target)","f9b666d1":"clf = setup(data = train,  \n            target = 'target',\n            silent=True,\n            verbose=0)","a4821d1b":"top = compare_models(exclude=['rf', 'xgboost', 'gbc', 'lr', 'catboost'], n_select=2, sort='Accuracy')","a453cf48":"# Blend top 2 models\nmodel = blend_models(top)\nmodel = finalize_model(model)","2b9e57ff":"test = pd.read_pickle('..\/input\/tpsfeb2022-ds-to-pickle-with-folds\/test.pkl')\nsub = pd.read_pickle('..\/input\/tpsfeb2022-ds-to-pickle-with-folds\/sub.pkl')","731cee29":"pred = predict_model(model, data=test).Label","9089c4b1":"sub.target = le.inverse_transform(pred)\nsub.to_csv('submission.csv', index=False)\nsub.head()","1614e2c4":"# Prediction & submission","23f635a3":"# Model comparison with Pycaret","9bfc18ec":"# Objective\n\nClassify 10 different bacteria species based on repeated lossy measurements of DNA snippets.\n\n\n## Versions\n\n","7d484e87":"### Load data"}}