{"cell_type":{"ab769dbb":"code","335390c5":"code","1b598dc0":"code","b0ea2e23":"code","d96fad1a":"code","f755a2db":"code","14a954a3":"code","3928550d":"code","26d67ef8":"code","292c6fd3":"code","50938dd3":"code","9f16ca44":"markdown","b1d99f4c":"markdown","9cb90c08":"markdown"},"source":{"ab769dbb":"# import package with helper functions \nimport bq_helper\n\n# create a helper object for this dataset\nbitcoin_blockchain = bq_helper.BigQueryHelper(active_project=\"bigquery-public-data\",\n                                              dataset_name=\"bitcoin_blockchain\")","335390c5":"bitcoin_blockchain.list_tables()","1b598dc0":"bitcoin_blockchain.head('transactions')","b0ea2e23":"query1 = '''WITH time AS\n            (\n             SELECT TIMESTAMP_MILLIS(timestamp) AS trans_time, \n                    transaction_id\n             FROM `bigquery-public-data.bitcoin_blockchain.transactions`\n             )\n             SELECT COUNT(transaction_id) AS transactions,\n                    EXTRACT(DAYOFYEAR FROM trans_time) AS day,\n                    EXTRACT(YEAR FROM trans_time) AS year\n             FROM time\n             GROUP BY year, day\n             ORDER BY year, day\n         '''","d96fad1a":"daily_transactions = bitcoin_blockchain.query_to_pandas(query1)","f755a2db":"daily_transactions.head(10)","14a954a3":"daily_transactions_2017 = daily_transactions[daily_transactions.year == 2017]\ndaily_transactions_2017.head()","3928550d":"import matplotlib.pyplot as plt\nx = daily_transactions_2017.day\ny = daily_transactions_2017.transactions\nplt.figure(figsize = (12,6))\nplt.plot(x,y)\nplt.title('Bitcoin transactions made each day in 2017')\nplt.xlabel('day')\nplt.ylabel('transactions')\nplt.show()","26d67ef8":"query2 = '''SELECT COUNT(transaction_id) AS Transactions, \n                   merkle_root AS Merkle_Root\n            FROM `bigquery-public-data.bitcoin_blockchain.transactions`\n            GROUP BY merkle_root\n            ORDER BY Transactions\n         '''","292c6fd3":"merkle = bitcoin_blockchain.query_to_pandas(query2)","50938dd3":"merkle","9f16ca44":"Then write the code to answer the questions below.\n\n#### Note\nThis dataset is bigger than the ones we've used previously, so your queries will be more than 1 Gigabyte. You can still run them by setting the \"max_gb_scanned\" argument in the `query_to_pandas_safe()` function to be large enough to run your query, or by using the `query_to_pandas()` function instead.\n\n## Questions\n#### 1) How many Bitcoin transactions were made each day in 2017?\n* You can use the \"timestamp\" column from the \"transactions\" table to answer this question. You can go back to the [order-by tutorial](https:\/\/www.kaggle.com\/dansbecker\/order-by) for more information on timestamps.","b1d99f4c":"---\n# Keep Going\n[Click here](https:\/\/www.kaggle.com\/dansbecker\/joining-data) to learn how to combine multiple data sources with the JOIN command.\n\n# Feedback\nBring any questions or feedback to the [Learn Discussion Forum](kaggle.com\/learn-forum).\n\n----\n\n*This tutorial is part of the [SQL Series](https:\/\/www.kaggle.com\/learn\/sql) on Kaggle Learn.*","9cb90c08":"\n#### 2) How many transactions are associated with each merkle root?\n* You can use the \"merkle_root\" and \"transaction_id\" columns in the \"transactions\" table to answer this question. "}}