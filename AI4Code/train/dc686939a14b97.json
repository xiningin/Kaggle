{"cell_type":{"8b9fab53":"code","a10547d6":"code","10f1ded0":"code","afcababf":"code","e80aa02b":"markdown"},"source":{"8b9fab53":"import numpy as np\nimport pandas as pd\nfrom matplotlib import pyplot as plt\nfrom matplotlib.ticker import PercentFormatter\n","a10547d6":"# We read a submission file which predicts Cover_Type 4 for 29 samples.\nsub = pd.read_csv('..\/input\/tps-dec-2021-simple-ensemble-public-notebooks\/submission.csv')\nsub.Cover_Type.value_counts()","10f1ded0":"# We now replace the 29 Cover_Type 4 predictions by Cover_Type 3.\nsub.loc[sub.Cover_Type == 4, 'Cover_Type'] = 3\nsub.Cover_Type.value_counts()","afcababf":"# And we submit the modified predictions\nsub.to_csv('submission_without4.csv', index=False)\n\n# Plot the distribution of the test predictions\nplt.figure(figsize=(10,3))\nplt.hist(sub['Cover_Type'], bins=np.linspace(0.5, 7.5, 8), density=True, rwidth=0.7, label='Test predictions')\nprobes = [[1, 0.38565], [2, 0.51259], [3, 0.07817], [4, 0.00034], [6, 0.00701], [7, 0.01621]]\nplt.bar([c for c, f in probes], [f for c, f in probes], label='lb frequencies', color='k', width=0.2)\nplt.xticks(ticks=range(1, 8), labels=[f\"{i}\\n{(sub['Cover_Type'] == i).mean():.5f}\" for i in range(1, 8)])\nplt.xlabel('Cover_Type')\nplt.ylabel('Frequency')\nplt.gca().yaxis.set_major_formatter(PercentFormatter(xmax=1))\nplt.legend()\nplt.show()\n\nsub.head()","e80aa02b":"# Eliminate Cover_Type 4!\n\nThe lb score of this notebook proves that accuracy increases if we replace all Cover_Type 4 predictions by Cover_Type 3.\n\nOn the 24th day of this competition, it seems that nobody has found a model capable of classifying Cover_Type 4 with sufficient precision. The confusion matrix of the oof predictions shows it. [Learn more...](https:\/\/www.kaggle.com\/c\/tabular-playground-series-dec-2021\/discussion\/296912)"}}