{"cell_type":{"0d6de876":"code","2a1a94c4":"code","2464a7b5":"code","16f1183d":"code","f3e6f118":"code","aeda84a6":"code","031e5cce":"code","12f1ed1f":"code","d9d029b8":"code","726605c8":"code","2c3eaadd":"code","153f0972":"code","85a619a6":"code","5d984e69":"code","bddb977b":"code","7e4d4a17":"code","d4572312":"code","8c1a670e":"code","d115fbcd":"code","f441404f":"code","8d2f663e":"markdown","f7cca239":"markdown"},"source":{"0d6de876":"%reload_ext autoreload\n%autoreload 2\n%matplotlib inline","2a1a94c4":"from fastai.vision.all import *\nfrom fastai.imports import *\nfrom fastai.vision.data import *\nfrom fastai import *\nimport numpy as np\nimport fastai","2464a7b5":"path = Path(\"\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\")\npath.ls()\n","16f1183d":"np.random.seed(42)\n#data = ImageDataLoaders.from_folder(path, train=\".\", valid_pct=0.2, size=256, num_workers=4).normalize(imagenet_stats)\ndata = ImageDataLoaders.from_folder(path, train=\"train\", valid=\"val\", item_tfms=RandomResizedCrop(512, min_scale=0.75),\n                                    bs=16,batch_tfms=[*aug_transforms(size=224, max_warp=0), Normalize.from_stats(*imagenet_stats)],num_workers=0)\n","f3e6f118":"data.show_batch(nrows=3, figsize=(7,8))","aeda84a6":"learn = cnn_learner(data, resnet50, metrics=error_rate)","031e5cce":"learn.fit_one_cycle(4)","12f1ed1f":"learn.export(\"\/kaggle\/working\/Stage -1.pkl\")","d9d029b8":"learn.unfreeze()","726605c8":"learn.fit_one_cycle(3, lr_max=slice(2e-6,2e-7))","2c3eaadd":"learn.freeze()","153f0972":"learn.fit_one_cycle(2)","85a619a6":"learn.model = learn.model.cpu()","5d984e69":"learn.export('\/kaggle\/working\/pneumonia.pkl')","bddb977b":"defaults.device = torch.device('cpu')","7e4d4a17":"t = Image.open('\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/test\/NORMAL\/IM-0001-0001.jpeg')\nt #Normal Xray","d4572312":"t = Image.open('\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/test\/PNEUMONIA\/person100_bacteria_475.jpeg')\nt #Pneu Case","8c1a670e":"l = load_learner('\/kaggle\/working\/pneumonia.pkl', cpu=True)","d115fbcd":"defaults.device  = torch.device('cpu')\ndefaults.device","f441404f":"fnames_normal=get_image_files('\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/test\/NORMAL\/')\nfnames_pneu=get_image_files('\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/test\/PNEUMONIA\/')\n\n# fnames_normal\npred_class,pred_idx,outputs = l.predict(fnames_normal[0])\nprint(\"Actual: Normal, Predicted = {}\".format(pred_class))\npred_class,pred_idx,outputs = l.predict(fnames_pneu[0])\nprint(\"Actual: Pneumonia, Predicted = {}\".format(pred_class))\n","8d2f663e":"### Trainining the model","f7cca239":"## Fast.Ai - Pneumonia Detection ##"}}