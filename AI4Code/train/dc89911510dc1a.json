{"cell_type":{"3a36ac87":"code","bdf3b92d":"code","adc4146f":"code","96f9f414":"code","cff95a49":"code","99910381":"code","1f06947a":"code","674796f9":"code","8f765edb":"code","0b5b9a53":"code","c945c45e":"code","3ee07ba5":"code","e58dd160":"code","f8330784":"code","6f2ab668":"code","e88450e8":"code","762830b0":"code","d62e75f6":"code","28b9b605":"code","c20cf9f4":"code","3039cb9c":"code","63ee34bb":"code","c8998448":"code","3c333d1c":"code","e2e5ea54":"code","d6b5e344":"code","fb6e5502":"code","01819e9b":"code","3bed597e":"code","5a64e087":"code","fbebbf11":"code","b5224257":"code","2ab8946b":"markdown","208e957c":"markdown","987fdb89":"markdown","cc07480a":"markdown","22028a7a":"markdown","61ab9e73":"markdown","fbf85905":"markdown","1530d70c":"markdown","8b93b568":"markdown","7d67c1b3":"markdown","ffbea0c5":"markdown","b0aab6f8":"markdown","4fa924ba":"markdown","af4ab48c":"markdown","3721f067":"markdown"},"source":{"3a36ac87":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\npd.set_option('display.max_columns', None)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","bdf3b92d":"df = pd.read_csv(\"\/kaggle\/input\/fetal-health-classification\/fetal_health.csv\")\ndf.head()","adc4146f":"df.describe()","96f9f414":"df.info()","cff95a49":"import missingno as msno\nn = msno.bar(df,color=\"yellow\")","99910381":"plt.style.use(\"fivethirtyeight\")\nplt.figure(figsize=(9,7))\nsns.countplot(x=\"fetal_health\",data = df)\nplt.show()","1f06947a":"plt.figure(figsize=(20,10))\nsns.boxplot(data = df,palette = \"Set3\")\nplt.xticks(rotation=90)\nplt.show()","674796f9":"lowerlimit = df.histogram_variance.mean() - 3*df.histogram_variance.std()\nupperlimit = df.histogram_variance.mean() + 3*df.histogram_variance.std()\nprint(lowerlimit,upperlimit)\ndf1 = df[(df.histogram_variance > lowerlimit) & (df.histogram_variance < upperlimit)]\ndf.shape[0],df1.shape[0]","8f765edb":"lowerlimit = df1.histogram_median.mean() - 3*df1.histogram_median.std()\nupperlimit = df1.histogram_median.mean() + 3*df1.histogram_median.std()\nprint(lowerlimit,upperlimit)\ndf2 = df1[(df1.histogram_median > lowerlimit) & (df1.histogram_median < upperlimit)]\ndf1.shape[0],df2.shape[0]","0b5b9a53":"lowerlimit = df2.histogram_mode.mean() - 3*df2.histogram_mode.std()\nupperlimit = df2.histogram_mode.mean() + 3*df2.histogram_mode.std()\nprint(lowerlimit,upperlimit)\ndf3 = df2[(df2.histogram_mode > lowerlimit) & (df2.histogram_mode < upperlimit)]\ndf2.shape[0],df3.shape[0]","c945c45e":"lowerlimit = df3.histogram_max.mean() - 3*df3.histogram_max.std()\nupperlimit = df3.histogram_max.mean() + 3*df3.histogram_max.std()\nprint(lowerlimit,upperlimit)\ndf4 = df3[(df3.histogram_max > lowerlimit) & (df3.histogram_max < upperlimit)]\ndf3.shape[0],df4.shape[0]","3ee07ba5":"lowerlimit = df4.percentage_of_time_with_abnormal_long_term_variability.mean() - 3*df4.percentage_of_time_with_abnormal_long_term_variability.std()\nupperlimit = df4.percentage_of_time_with_abnormal_long_term_variability.mean() + 3*df4.percentage_of_time_with_abnormal_long_term_variability.std()\nprint(lowerlimit,upperlimit)\ndf5 = df4[(df4.percentage_of_time_with_abnormal_long_term_variability > lowerlimit) & (df4.percentage_of_time_with_abnormal_long_term_variability < upperlimit)]\ndf4.shape[0],df5.shape[0]","e58dd160":"df = df5.copy()\ncorrmat = df.corr()\ntop_corr_features = corrmat.index\nplt.figure(figsize=(20,10))\ng = sns.heatmap(df[top_corr_features].corr(),annot = True,cmap = \"RdYlGn\")","f8330784":"x = df.drop(\"fetal_health\",axis=1)\ny =  df[\"fetal_health\"]","6f2ab668":"from sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nx_train,x_test,y_train,y_test = train_test_split(x,y,test_size=0.3,random_state=0)","e88450e8":"scaler = StandardScaler()\nx_train = scaler.fit_transform(x_train)\nx_test = scaler.fit_transform(x_test)","762830b0":"from sklearn.ensemble import RandomForestClassifier\nfrom xgboost import XGBClassifier\nfrom lightgbm import LGBMClassifier","d62e75f6":"xgb_clf = XGBClassifier()\nxgb_clf.fit(x_train,y_train)","28b9b605":"from sklearn.metrics import accuracy_score,confusion_matrix,roc_auc_score\npred_xgb = xgb_clf.predict(x_test)\naccuracy_score(y_test,pred_xgb)","c20cf9f4":"from sklearn.preprocessing import LabelBinarizer\ndef calculate_roc_auc_score(y_test,y_pred,average=\"macro\"):\n    lb = LabelBinarizer()\n    y_test1 = lb.fit_transform(y_test)\n    y_pred1 =lb.transform(y_pred)\n    return roc_auc_score(y_test1,y_pred1,average=average)","3039cb9c":"calculate_roc_auc_score(y_test,pred_xgb)","63ee34bb":"from sklearn.metrics import classification_report\nprint(classification_report(y_test,pred_xgb))","c8998448":"lgb_clf = LGBMClassifier()\nlgb_clf.fit(x_train,y_train)\npred_lgb = lgb_clf.predict(x_test)\naccuracy_score(y_test,pred_lgb)","3c333d1c":"print(classification_report(y_test,pred_lgb))","e2e5ea54":"#roc auc score\ncalculate_roc_auc_score(y_test,pred_lgb)","d6b5e344":"rf_clf = RandomForestClassifier(random_state=0)\nrf_clf.fit(x_train,y_train)\n\npred_rf = rf_clf.predict(x_test)\naccuracy_score(y_test,pred_rf)","fb6e5502":"print(classification_report(y_test,pred_rf))","01819e9b":"#roc auc score\ncalculate_roc_auc_score(y_test,pred_rf)","3bed597e":"from sklearn.ensemble import VotingClassifier\nvc = VotingClassifier(estimators = [(\"xgb_clf\",xgb_clf),(\"lgb_clf\",lgb_clf),(\"rf_clf\",rf_clf)],voting='soft',\n                      weights =[8,7,5])\nvc.fit(x_train,y_train)\npred_vc = vc.predict(x_test)","5a64e087":"accuracy_score(y_test,pred_vc)","fbebbf11":"print(classification_report(y_test,pred_vc))","b5224257":"plt.style.use(\"ggplot\")\nfrom mlxtend.plotting import plot_confusion_matrix\ncm = confusion_matrix(y_test,pred_vc)\nplot_confusion_matrix(conf_mat = cm,figsize=(8,6),show_normed=True,\n                      class_names =[\"Normal\",\"Suspect\",\"Pathological\"])","2ab8946b":"- **As we can see there's a lot of outliers ,so let's remove some Outliers, Here i'm going to use 3 std for removing Outliers**","208e957c":"> <h3>Scaling:<\/h3>","987fdb89":"> <h3>Removing Outliers:<\/h3>","cc07480a":"><h3>Random Forest:<\/h3>","22028a7a":"><h3> Separating Features and Target Variables: <\/h3>","61ab9e73":"---\n\n<h1 style=\"text-align: center;font-size: 40px;\">Fetal Health Classification<\/h1>\n\n---","fbf85905":"><h3> Confusion Matrix:<\/h3>","1530d70c":"><h3>XGBoost:<\/h3>","8b93b568":"---\n\n<h1 style=\"text-align: center;font-size: 20px;\">Thanks for Reading!!<\/h1>\n\n---","7d67c1b3":"**Calculating Roc AUC Score for XGBoost**","ffbea0c5":"><h3>Voting Classifier:<\/h3>","b0aab6f8":"><h3>LightGBM:<\/h3>","4fa924ba":"><h3>Model Building:<\/h3>","af4ab48c":"- So there is no missing Values","3721f067":"- So,here we remove (2126-1977) = 149 numbers of  Outliers"}}