{"cell_type":{"ea0df1ec":"code","08f7c204":"code","df564dcc":"code","a82b992b":"code","8afb52bd":"code","100d7d19":"code","3a005c7d":"code","73a2d455":"code","db91cd73":"code","6d14bba8":"code","a11a4486":"code","84dddbeb":"code","727853c7":"code","b17320dc":"markdown","03250b58":"markdown","599c0ed6":"markdown","07bff68b":"markdown","f840e5f2":"markdown","7ec3a856":"markdown","33c3b1c2":"markdown","c232569f":"markdown"},"source":{"ea0df1ec":"# Note: this analysis uses data that were updated 23-08-2021\n# import modules\nimport numpy as np\nimport pandas as pd\nimport datetime\n","08f7c204":"# read the csv files: cases and death, vaccine rate, populations\ncases_and_deaths = pd.read_csv(\"..\/input\/covid-cases-and-deaths-updated-23082021\/country_vaccinations.csv\")\nvacc_data = pd.read_csv(\"..\/input\/covid-vaccination-updated-2382021\/covid-vaccination-doses-per-capita.csv\")\npopulation_data = pd.read_csv(\"..\/input\/population-by-country-2020\/population_by_country_2020.csv\")\n\n","df564dcc":"# clean some country naming issues\ncases_and_deaths.replace(\"Viet Nam\", \"Vietnam\", inplace=True)\ncases_and_deaths.replace(\"The United Kingdom\", \"United Kingdom\", inplace=True)\ncases_and_deaths.replace(\"United States of America\", \"United States\", inplace=True)","a82b992b":"# attempt to filter out countries not in all dataset (for simplicity)\nCountry_list = []\nfor c in cases_and_deaths.Country.unique():\n    if (c in vacc_data.Entity.unique()) and (c in population_data[\"Country (or dependency)\"].unique()):\n        Country_list.append(c)","8afb52bd":"# remove rows that have countries not included in analysis\ncases_and_deaths = cases_and_deaths.loc[cases_and_deaths[\"Country\"].isin(Country_list)]\nvacc_data = vacc_data.loc[vacc_data[\"Entity\"].isin(Country_list)]\npopulation_data = population_data.loc[population_data[\"Country (or dependency)\"].isin(Country_list)]","100d7d19":"# Set index to the country column\ncases_and_deaths.set_index([\"Country\"], inplace=True)\nvacc_data.set_index([\"Entity\"], inplace=True)\npopulation_data.set_index([\"Country (or dependency)\"], inplace=True)","3a005c7d":"# parse the date\ncases_and_deaths[\"date_parsed\"] = pd.to_datetime(cases_and_deaths[\"Date_reported\"], format=\"%d\/%m\/%Y\")\nvacc_data[\"date_parsed\"] = pd.to_datetime(vacc_data[\"Day\"], format=\"%d\/%m\/%Y\")","73a2d455":"# extract and modify columns used for analysis\ncases_and_deaths.drop([\"Country_code\",\"WHO_region\", \"Date_reported\"], inplace=True, axis=1)\nvacc_data.drop([\"Code\", \"Day\"], inplace=True, axis=1)\npopulation_data = population_data[\"Population (2020)\"]\n\nvacc_data.rename_axis(\"Country\", inplace=True, axis=0)\npopulation_data.rename_axis(\"Country\", inplace=True, axis=0)\npopulation_data.sort_index(inplace=True)","db91cd73":"# combine pop_data and case death data, and calculate per 100 values\ndf = cases_and_deaths.join(population_data)\ndf[\"New_cases_per_100\"] = 100 * df[\"New_cases\"] \/ df[\"Population (2020)\"]\ndf[\"Cumulative_cases_per_100\"] = 100 * df[\"Cumulative_cases\"] \/ df[\"Population (2020)\"]\ndf[\"New_deaths_per_100\"] = 100 * df[\"New_deaths\"] \/ df[\"Population (2020)\"]\ndf[\"Cumulative_deaths_per_100\"] = 100 * df[\"Cumulative_deaths\"] \/ df[\"Population (2020)\"]\ndf.drop([\"New_cases\",\"Cumulative_cases\",\"New_deaths\",\"Cumulative_deaths\", \"Population (2020)\"], inplace=True, axis=1)","6d14bba8":"# Create the final dataframe by joining cases-deaths and vacc data\nleft = df.set_index([df.index,\"date_parsed\"])\nright = vacc_data.set_index([vacc_data.index, \"date_parsed\"])\ndf2 = left.join(right)","a11a4486":"# fill the dates with missing values in total vacc column, using preceding values\ndf2.reset_index(inplace=True)\nfor c in Country_list:\n    df2[df2.Country == c] = df2[df2.Country == c].fillna(method=\"ffill\")\n","84dddbeb":"# the remaining NAs are filled with 0s\ndf2.fillna(0, inplace=True)\n\n# the final dataframe is now completed","727853c7":"# export the dataframe for EDAs (in later parts)\ndf2.to_csv(\".\/covid_data_cleaned.csv\")","b17320dc":"Now it is time to extract the useful columns in each dataframe. Once it is done they will be merged into one dataset.","03250b58":"Some countries in the first dataset is named differently from others, the following code will solve the problem.","599c0ed6":"The data is now cleaned. I will export the dataframe and use it for analysis later.","07bff68b":"In this project, I intend to investigate the relationship between the number of Covid-19 cases and its related deaths under different vaccination stage. The notebook will be divided into two parts. In this part, I will collect the data from different sources and merge the useful information into one single dataframe.","f840e5f2":"The final step is to fill in missing data, in this case only in the vaccination column. For each country, I simply dropped the value from above. If there is no value from above (due to the vaccine rollout had had not started), the missing values will be filled with 0s.","7ec3a856":"Time-series analysis requires the date to be parsed.","33c3b1c2":"There are three separate dataframes used:\n\nThe first one comes from the World Health Organisation, it gives the total number of cases and deaths in each country.\n\nThe second one gives the vaccination doses given per capita.\n\nThe third one gives the population count in 2020. For simplicity it will be used to calculate cases and deaths per 100.\n\nSource of datasets:\n\nWHO COVID-19 Dashboard. Geneva: World Health Organization, 2020. Available online: https:\/\/covid19.who.int\/ (last cited: 23 Aug 2021)\n\nOur World in Data. COVID-19 vaccine doses administered per 100 people. Available online: https:\/\/ourworldindata.org\/grapher\/covid-vaccination-doses-per-capita. (last cited: 23 Aug 2021)\n\nTanu N Prabhu. Population by Country - 2020. Available online: https:\/\/www.kaggle.com\/tanuprabhu\/population-by-country-2020. (last cited: 23 Aug 2021)","c232569f":"Different datasets include different countries, for simplicity I will only include countries that are present in all datasets."}}