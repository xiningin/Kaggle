{"cell_type":{"0b68b56f":"code","4ea26f7a":"code","15269b35":"code","3eee4404":"code","ad751690":"code","20f2e40b":"code","cc380686":"code","8a9a178f":"code","78253244":"code","0d47179d":"code","f09314be":"code","927df9e0":"code","cdb8700b":"code","ef72e275":"code","15842da5":"code","a7a1e5b3":"code","02dc02c5":"code","ea25f926":"code","45246f62":"code","157be344":"code","f068de23":"code","0cf33068":"code","dd2508b5":"code","99711a7e":"code","d5be0b01":"code","8853e0bb":"markdown","a1af6df3":"markdown","f4a6d56d":"markdown","6ff22863":"markdown","39ee93e8":"markdown","bf2faa5a":"markdown","0e22ee13":"markdown","c17e4bc0":"markdown","1c6c5dbb":"markdown","b196c14b":"markdown","603cdf23":"markdown","8ccb7e44":"markdown","596e6963":"markdown","6202cac0":"markdown","dbda25b1":"markdown","9da8e00f":"markdown","14450766":"markdown","8a81b477":"markdown","acdd1a63":"markdown","e6fcc51c":"markdown"},"source":{"0b68b56f":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn import linear_model","4ea26f7a":"train = pd.read_csv('\/kaggle\/input\/tabular-playground-series-jan-2022\/train.csv')\ntest = pd.read_csv('\/kaggle\/input\/tabular-playground-series-jan-2022\/test.csv')","15269b35":"train.head()","3eee4404":"train['num_sold'].describe()","ad751690":"train['country'].describe()","20f2e40b":"#Here we can see there are no null values for data cleaning\ntrain.isnull().sum()","cc380686":"#There are two indexes, thus we can drop row_id\ntrain = train.drop('row_id',axis=1)","8a9a178f":"train.head()","78253244":"train_grouped = train.groupby(['country',\"store\",\"product\"]).agg(num_sold=('num_sold','count'))\n\ntrain_grouped","0d47179d":"plt.figure(figsize=(20,5),dpi=200)\nsns.boxplot(data=train, x='num_sold')\nplt.title('num_sold distribution boxplot');","f09314be":"plt.figure(figsize=(20,5),dpi=200)\nsns.boxplot(data=train, x='country', y='num_sold')\nplt.title('country sales distribution boxplot');","927df9e0":"plt.figure(figsize=(20,5),dpi=200)\nsns.boxplot(data=train, x='store', y='num_sold')\nplt.title('store sales distribution boxplot');","cdb8700b":"plt.figure(figsize=(20,5),dpi=200)\nsns.boxplot(data=train, x='product', y='num_sold')\nplt.title('product sales distribution boxplot');","ef72e275":"plt.figure(figsize=(20,5),dpi=200)\ncomparison = sns.FacetGrid(train, col=\"country\", row=\"store\" ,hue='product',margin_titles=True,height=5,aspect=.9,legend_out=True)\ncomparison.map_dataframe(sns.histplot,x=\"num_sold\",element=\"poly\");\ncomparison.add_legend();","15842da5":"train['date'] = pd.to_datetime(train['date'])","a7a1e5b3":"plt.figure(figsize=(20,5))\nsns.lineplot(data=train,x=\"date\",y=\"num_sold\");","02dc02c5":"train['country'].replace(['Finland', 'Norway', 'Sweden'], [1, 2, 3], inplace=True)\ntrain['store'].replace(['KaggleMart', 'KaggleRama'], [1, 2], inplace=True)\ntrain['product'].replace(['Kaggle Mug', 'Kaggle Hat', 'Kaggle Sticker'], [1, 2, 3], inplace=True)","ea25f926":"test['country'].replace(['Finland', 'Norway', 'Sweden'], [1, 2, 3], inplace=True)\ntest['store'].replace(['KaggleMart', 'KaggleRama'], [1, 2], inplace=True)\ntest['product'].replace(['Kaggle Mug', 'Kaggle Hat', 'Kaggle Sticker'], [1, 2, 3], inplace=True)","45246f62":"X = train[['country', 'store', 'product']]\ny = train['num_sold']","157be344":"model = linear_model.LinearRegression()\nmodel.fit(X,y)","f068de23":"train.iloc[:,2:5]","0cf33068":"final_test = test.iloc[:,2:5]\n\nfinal_test","dd2508b5":"pred = model.predict(final_test)\n\npred","99711a7e":"final = pd.DataFrame({'row_id':test['row_id'], 'num_sold':pred})\n\nfinal","d5be0b01":"final.to_csv('submission.csv', index=False)","8853e0bb":"#### Exploring Dates","a1af6df3":"##### The Kaggle Hat is far more popular than the Kaggle Mug and Kaggle Sticker\n##### Here it is clear that the number of Kaggle Stickers sold is very low","f4a6d56d":"### Exploring Data","6ff22863":"### Preparing Data","39ee93e8":"### Importing Modules","bf2faa5a":"##### Here we can see the number of country sales is the lowest in Finland compared to Norway and Sweden","0e22ee13":"##### More products were sold towards the end of every year and also increases in sales every year","c17e4bc0":"##### The number of sales (and average number of sales) is lower at KaggleMart compared to KaggleRama","1c6c5dbb":"#### Exploring Stores","b196c14b":"#### Exploring Country","603cdf23":"### Visualizing Data","8ccb7e44":"##### Minimum number of sales: 70\n##### Maximum number of sales: 2884\n##### Average number of sales: 387","596e6963":"#### Saving Submission File to CSV","6202cac0":"#### Exploring number of sold items","dbda25b1":"### Prediction","9da8e00f":"#### Exploring Products","14450766":"##### The boxplot shows that the number of sold items is positively skewed\n##### There are outliers above the third quartile","8a81b477":"### Reading CSV Files","acdd1a63":"## Tabular Playground Series","e6fcc51c":"#### Comparing"}}