{"cell_type":{"3e31604f":"code","da399034":"code","d568d949":"code","0f7b1d4f":"code","bd0d940b":"code","91c7a14a":"code","3afcb2a4":"code","3dd23dc5":"code","cb898dd9":"code","74d897a5":"code","7ccdb647":"code","92c8432b":"code","4c414736":"code","73570a8e":"code","d2049a06":"code","e6f97885":"code","dfbe4f84":"code","6155f6c4":"code","cc4cd064":"code","610ae46c":"code","fc2998b5":"code","67359579":"code","fbf77e2a":"code","c4d6eba4":"code","ab461295":"code","7e4793d4":"code","ec469cd2":"code","5f80c97b":"code","b31dce5c":"code","dbdab2d5":"code","c6804680":"markdown"},"source":{"3e31604f":"'''Write a Script(R\/Python) which fetch the detail from the CSV and create an email template.'''\n\n\n","da399034":"import pandas as pd\nimport numpy as np\n\n","d568d949":"import pandas as pd\ndf = pd.read_csv(\"..\/input\/sample_email.csv\",encoding='windows-1254')","0f7b1d4f":"import csv\nwith open(\"..\/input\/sample_email.csv\",encoding='windows-1254', newline='') as f:\n    reader = csv.reader(f)\n    for row in reader:\n        print(row)\n","bd0d940b":"import csv\n\ninputfile = csv.reader(open(\"..\/input\/sample_email.csv\",'r',encoding='windows-1254'))\n\nfor row in inputfile:\n    print(row[2])","91c7a14a":"import email\n    ","3afcb2a4":"import csv\n\nf = open(\"..\/input\/sample_email.csv\",encoding='windows-1254')\ncsv_f = csv.reader(f)\n\nfor row in csv_f:\n    print(row[12])","3dd23dc5":"import csv\n\nf = open(\"..\/input\/sample_email.csv\",encoding='windows-1254')\ncsv_f = csv.reader(f)\n\nfor columns in csv_f:\n    print(columns[12])\n    \n","cb898dd9":"import re\n \nfileToRead = 'readText.txt'\nfileToWrite = 'emailExtracted.txt'\n \n \ndelimiterInFile = [',', ';']\n \ndef validateEmail(strEmail):\n    # .* Zero or more characters of any type. \n    if re.match(\"(.*)@(.*).(.*)\", strEmail):\n        return True\n    return False\n \ndef writeFile(listData):\n    file = open(fileToWrite, 'w+')\n    strData = \"\"\n    for item in listData:\n        strData = strData+item+'\\n'\n    file.write(strData)\n \nlistEmail = []\nfile = open(\"..\/input\/sample_email.csv\", 'r',encoding='windows-1254') \nlistLine = file.readlines()\nfor itemLine in listLine:\n    item =str(itemLine)\n    for delimeter in delimiterInFile:\n        item = item.replace(str(delimeter),' ')\n     \n    wordList = item.split()\n    for word in wordList:\n        if(validateEmail(word)):\n            listEmail.append(word)\n \nif listEmail:\n    uniqEmail = set(listEmail)\n    print(len(uniqEmail),\"emails collected!\")\n    writeFile(uniqEmail)\nelse:\n    print(\"No email found.\")","74d897a5":"listEmail","7ccdb647":"len(listEmail)","92c8432b":"keywods_search = ['.com']\nemail_list = []\nfor i in range(len(df)):\n    if \".com\" in df[\"Email Boby\"].iloc[i]:\n        email_list.append(df[\"Email Boby\"].iloc[i])\n\nfinal_email_list = []\nfor i in range(len(email_list)):\n    \".com\" in email_list[i].split()\n    final_email_list.append([j for j in email_list[i].split() if keywods_search[0] in j])\n","4c414736":"final_email_list","73570a8e":"number_list = []\nfor i in range(len(df)):\n    if \"-\" in df[\"Email Boby\"].iloc[i]:\n        number_list.append(df[\"Email Boby\"].iloc[i])\n       \n\n#final_email_list = []\n#for i in range(len(email_list)):\n#    keywods_search[0] in email_list[i].split()\n#    final_email_list.append([j for j in email_list[i].split() if keywods_search[0] in j])","d2049a06":"number_list","e6f97885":"bad_chars = ['-', '()', '!', \"*\"] \n  \n# initializing test string  \ntest_string = \"I have a nearly unreadable font in my Warehouse Software under Export-File Options for 2 days.Please do contact me at 504-621-8927\"\n  \n# printing original string  \nprint (\"Original String : \" + test_string) \n  \n# using join() + generator to  \n# remove bad_chars  \ntest_string = ''.join(i for i in test_string if not i in bad_chars) \n  \n# printing resultant string  \nprint (\"Resultant list is : \" + str(test_string)) ","dfbe4f84":"len(number_list)","6155f6c4":"import re\ndef transform_record(record):\n  new_record = re.search(r\"([0-9]{3}-)([0-9]{3}-[0-9]{4}|[0-9]{7})\",record)\n  if new_record!=None:\n     return new_record[1]+new_record[2]\nx=['I have a nearly unreadable font in my Warehouse Software under Export-File Options for 2 days.Please do contact me at 504-621-8927',\n 'on my detailsheet http:\/\/www.rhein-main-versand.de since yesterday evening some Calibri texts are replaced by blue speech bubbles (?!), i.a. also the imprint',\n 'I would like to use the studio version, but I can not exchange the preview images, even though they were deleted in the online organizer - i. E. I have changed the order of the products or deleted products so that the preview always shows the first product, but nothing happens.Reach out me at (541) 754-3010',\n 'If I then want to pull down the new process (example: Gelsenkirchen-Projekt2.dat) in overview mode with the mouse, to attach it to the first process, I only get the line 1 (data), which is line 2 (order numbers) disappeared.',\n 'Unfortunately I can not import CASH-builds into the DAT-procedure without any problem. The order-number line remains empty (ZD recordings work). Reach out me at calbares@gmail.com',\n 'There is no order number in SFC.Call me at 123-456-7890',\n 'have since yesterday Sales Firstclass 19 Special Edition installed-registered and then I have imported the sales files from the memory card and when viewing the process, simply no order number comes.',\n '- When burning a product preview with products in the IT & OFFICE catalog 12 & 13 The error message appears at step 7 of 9 - Disc Copy is generated. Call me at +1 (123) 456-7890',\n '!!! MBK exception in CopyWorkspace: 13 - process failed !!!']\ny=[]\nfor i in x:\n    t=transform_record(i)\n    if t!=None:\n        y.append(t)\nprint(y)\n    \n    ","cc4cd064":"import re\ndef transform_record(record):\n  new_record = re.search(r\"([0-9]{3}-|[(][0-9]{3}[)] )([0-9]{3}-[0-9]{4})\",record)\n  if new_record!=None:\n     return new_record[1]+new_record[2]\nx=['I have a nearly unreadable font in my Warehouse Software under Export-File Options for 2 days.Please do contact me at 504-621-8927',\n 'on my detailsheet http:\/\/www.rhein-main-versand.de since yesterday evening some Calibri texts are replaced by blue speech bubbles (?!), i.a. also the imprint',\n 'I would like to use the studio version, but I can not exchange the preview images, even though they were deleted in the online organizer - i. E. I have changed the order of the products or deleted products so that the preview always shows the first product, but nothing happens.Reach out me at (541) 754-3010',\n 'If I then want to pull down the new process (example: Gelsenkirchen-Projekt2.dat) in overview mode with the mouse, to attach it to the first process, I only get the line 1 (data), which is line 2 (order numbers) disappeared.',\n 'Unfortunately I can not import CASH-builds into the DAT-procedure without any problem. The order-number line remains empty (ZD recordings work). Reach out me at calbares@gmail.com',\n 'There is no order number in SFC.Call me at 123-456-7890',\n 'have since yesterday Sales Firstclass 19 Special Edition installed-registered and then I have imported the sales files from the memory card and when viewing the process, simply no order number comes.',\n '- When burning a product preview with products in the IT & OFFICE catalog 12 & 13 The error message appears at step 7 of 9 - Disc Copy is generated. Call me at +1 (123) 456-7890',\n '!!! MBK exception in CopyWorkspace: 13 - process failed !!!']\ny=[]\nfor i in x:\n    t=transform_record(i)\n    if t!=None:\n        y.append(t)\nprint(y)\n\n\n","610ae46c":"import csv\nwith open('number.csv', 'w', newline='') as file:\n    writer = csv.writer(file)\n    writer.writerow(['504-621-8927', '(541) 754-3010', '123-456-7890', '(123) 456-7890'])\n    ","fc2998b5":"import csv\nwith open('email.csv', 'w', newline='') as file:\n    writer = csv.writer(file)\n    writer.writerow([['asergi[at]apple.com'],\n ['asergi@yahoo.com'],\n ['calbares@gmail.com'],\n ['asergi@gmail.com']])\n    ","67359579":"import csv\nwith open('number_2.csv', 'w', newline='') as file:\n    writer = csv.writer(file)\n    writer.writerow(['504-621-8927'])\n    ","fbf77e2a":"df2 = pd.read_csv(\"email.csv\")","c4d6eba4":"df2.head()","ab461295":"df3 = pd.read_csv(\"number.csv\")","7e4793d4":"df3.head()","ec469cd2":"df4 = pd.read_csv(\"number_2.csv\")","5f80c97b":"df4","b31dce5c":"import smtplib\ndef gmailsend(email_id, subject, name,name_2,email_body,email_sender,password_sender):\n    server = 'smtp.gmail.com'\n    port = 587\n    sender = email_sender\n    password = password_sender\n    receivers = email_id\n    fromPerson = name_2\n    subject = subject\n    message = \"From:\"+fromPerson+\"\\nTo:\"+receivers+\"\\nMIME-Version: 1.0\\nContent-Type: text\/html\\nSubject: \"+subject+\"\\n\\n\\n\\nHi \"+name+\"<br><br>\"+email_body +\"<br><br>\"+\"Thanks,\"+\"<br><br>\"+name_2\n    smtpObj = smtplib.SMTP(server,int(port))\n    smtpObj.starttls()\n    smtpObj.login(sender,password) \n    smtpObj.sendmail(sender,receivers,message.encode(\"utf8\"))\n    print(\"Mail Sent Successfully\")\n\n ","dbdab2d5":"name_2 = input('Enter the name of sender')\nemail_sender = input('Enter your mail id:')\npassword_sender = input('Enter your password:')\nfor i in range(len(df)):\n\n    email_id = df[\"email\"].iloc[i]\n    name = df[\"first_name\"].iloc[i]\n    subject = df[\"subject\"].iloc[i]\n    email_body = df[\"Email Boby\"].iloc[i]\n    gmailsend(email_id, subject, name,name_2,email_body,email_sender,password_sender) \n        ","c6804680":" # The code is fully functional you can check by yourself by using your email id, password"}}