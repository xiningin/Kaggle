{"cell_type":{"80ef2505":"code","9186e849":"code","12771954":"code","0523a943":"code","0b8ea5fb":"code","0b322ef9":"code","100768cc":"code","0bf0d011":"code","805f9c98":"code","30c59c72":"code","1f7a2bee":"code","38296457":"code","94077cb7":"code","ae8baac0":"markdown"},"source":{"80ef2505":"import numpy as np\nimport pandas as pd\nimport os\nimport cv2\nfrom matplotlib import pyplot as plt\nfrom tqdm import tqdm\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings(\"ignore\")","9186e849":"image_labels=pd.read_csv('..\/input\/nfl-health-and-safety-helmet-assignment\/image_labels.csv')\nimage_labels","12771954":"labels=image_labels['label'].unique().tolist()\nprint(labels)\nprint(len(labels))\nN=list(range(len(labels))) \nnormal_mapping=dict(zip(labels,N)) \nreverse_mapping=dict(zip(N,labels)) ","0523a943":"img_dir='..\/input\/nfl-health-and-safety-helmet-assignment\/images'","0b8ea5fb":"impaths=[]\nfiles=os.listdir(img_dir)\nfor item in files:\n    impaths+=[os.path.join(img_dir,item)]","0b322ef9":"images0=[]\nfor i in tqdm(range(len(impaths)\/\/10)):\n    images0+=[cv2.imread(impaths[i])]","100768cc":"impaths[0:5]","0bf0d011":"image_labels[image_labels['image']=='57655_000176_Sideline_frame583.jpg'].iloc[:,1:6]","805f9c98":"def draw_box(num0):\n    \n    impath=impaths[num0]\n    image=cv2.imread(impath)\n    file=impath.split('\/')[-1]\n    box=image_labels[image_labels['image']==file].iloc[:,1:6].reset_index(drop=True)\n    #print(box)\n    \n    for i in range(len(box)):\n        label=box.iloc[i,0]\n        x=box.iloc[i,1]\n        w=box.iloc[i,2]\n        y=box.iloc[i,3]\n        h=box.iloc[i,4]\n        \n        if label==labels[0]:\n            cv2.rectangle(image,(x,y),(x+w,y+h),(255,255,0),2)  # yellow 'Helmet'\n        elif label==labels[1]:\n            cv2.rectangle(image,(x,y),(x+w,y+h),(0,255,255),2)  # light blue 'Helmet-Blurred            \n        elif label==labels[2]:\n            cv2.rectangle(image,(x,y),(x+w,y+h),(255,0,0),2)  # red 'Helmet-Difficult'\n        elif label==labels[3]:\n            cv2.rectangle(image,(x,y),(x+w,y+h),(0,255,0),2)  # yellow green 'Helmet-Sideline'               \n        elif label==labels[4]:\n            cv2.rectangle(image,(x,y),(x+w,y+h),(0,0,255),2)  # blue 'Helmet-Partial'             \n            \n        #cv2.imwrite('\/kaggle\/working\/source0\/'+file+'.png',image)        \n        #plt.imshow(cv2.cvtColor(image, cv2.COLOR_BGR2RGB))\n        #plt.show() \n        \n    return image","30c59c72":"images1=[]\nfor i in tqdm(range(len(impaths)\/\/10)):\n    images1+=[draw_box(i)]","1f7a2bee":"from matplotlib import animation, rc\nrc('animation', html='jshtml')","38296457":"def create_animation(ims):\n    \n    fig=plt.figure(figsize=(12,6))\n    plt.axis('off')\n    im=plt.imshow(cv2.cvtColor(ims[0],cv2.COLOR_BGR2RGB))\n    \n    def animate_func(i):\n        im.set_array(cv2.cvtColor(ims[i],cv2.COLOR_BGR2RGB))\n        return [im]\n\n    return animation.FuncAnimation(fig, animate_func, frames=len(ims), interval=1000\/\/2)","94077cb7":"create_animation(images1)","ae8baac0":"# image_labels"}}