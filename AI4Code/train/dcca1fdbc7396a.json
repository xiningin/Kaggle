{"cell_type":{"e8513dae":"code","58d7e0d8":"code","f6a162b4":"code","e70328e9":"code","0a1fa5fb":"code","dad320fc":"code","7725cba2":"code","e55f317d":"code","850c0b66":"code","c48974ee":"code","0d0b6e52":"code","c911a757":"code","935c3460":"code","fd03cff2":"code","c87ecc2e":"code","cdcb77d9":"code","9f1195e9":"code","3b084756":"code","762c2b43":"code","7fb6e217":"code","050d18b2":"code","eb3e16cf":"code","497b97b8":"code","3f9d6939":"code","d8475241":"code","b3f944cd":"code","c03f799b":"code","d4669308":"code","67c0f673":"code","9f700c6f":"code","ee5ae2a4":"code","eb380cb2":"code","8958cda4":"code","97d653f0":"code","a5fe2552":"code","4966d3c0":"code","e1bff4c1":"code","f8c73500":"code","9f979749":"code","4f4aeee8":"code","cec2281c":"code","1dd23fe6":"code","176888bd":"code","df8a68dc":"code","9ba9f8a2":"code","fe83aefd":"code","1742f9e3":"code","5264004c":"code","4f0d17d4":"code","e768fb8f":"code","131234c6":"code","b02baa59":"code","7ff5f1ea":"code","32344dd1":"code","a8251710":"code","0701d3ec":"code","fa24d4d5":"code","e2564172":"code","80e079ae":"code","aa6e3cf4":"code","287830e5":"code","0b9ed104":"code","55bc0ad0":"code","ef5b0a0a":"code","29eb9205":"code","beea1866":"code","9fa23443":"code","623da857":"code","2db2f2ec":"code","6b31ca57":"code","f81c8c88":"code","005e0ea1":"code","46fe6c9f":"code","78112f5b":"code","0613c687":"code","b9c36dd3":"code","d58d458f":"code","124568c0":"code","71bf9e66":"code","d4bdd291":"code","da80a7a4":"code","381ee4b5":"code","1480fb1a":"code","e3db812d":"code","18829760":"code","3274e175":"code","79c368f6":"code","3ff95f32":"code","0ce38d11":"code","4d1ecd48":"code","c776f6da":"code","331d87ec":"code","1cd59b64":"code","96e2fbbf":"code","2be17ca6":"code","59ca7bb6":"code","23a2403f":"code","0edee64d":"code","5684df92":"code","5d01151a":"code","6e683ff1":"code","a7765800":"code","88aea284":"code","466b6662":"code","845f8f82":"code","6607830b":"code","fa39a146":"code","4aacf09e":"code","ab356ad1":"code","820d6378":"code","93ddb6f1":"markdown","462d3c61":"markdown","560f51cc":"markdown","283c25b4":"markdown","a43faea1":"markdown","a4dfc26a":"markdown","6da6085b":"markdown","4b9281c1":"markdown","c0a6093a":"markdown","15e51475":"markdown","ff5c9536":"markdown","c389741e":"markdown","3fede37b":"markdown","2e3cadaa":"markdown","714c9d8c":"markdown","5d09fa8d":"markdown","f8b7b0c9":"markdown","ecab3587":"markdown","badbdada":"markdown","6dd8d57b":"markdown","6760a570":"markdown","8f9a1ddf":"markdown","6dd043d9":"markdown","6ecd175f":"markdown","577d9bae":"markdown","77034f71":"markdown","c6342620":"markdown"},"source":{"e8513dae":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\nimport os","58d7e0d8":"\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","f6a162b4":"customer = pd.read_csv(\"\/kaggle\/input\/credit-card-exploratory-data-analysis\/Customer Acqusition.csv\",usecols=[\"Customer\",\"Age\",\"City\",\"Product\",\"Limit\",\"Company\",\"Segment\"])\nrepay = pd.read_csv(\"\/kaggle\/input\/credit-card-exploratory-data-analysis\/Repayment.csv\",usecols = [\"Customer\",\"Month\",\"Amount\"])\nspend = pd.read_csv(\"\/kaggle\/input\/credit-card-exploratory-data-analysis\/spend.csv\",usecols=[\"Customer\",\"Month\",\"Type\",\"Amount\"])","e70328e9":"customer.head()","0a1fa5fb":"repay.head()","dad320fc":"spend.head(2)","7725cba2":"print(customer.shape)\nprint(repay.shape)\nprint(spend.shape)","e55f317d":"customer.dtypes","850c0b66":"repay.dtypes","c48974ee":"spend.dtypes","0d0b6e52":"spend.isnull().sum()","c911a757":"customer.isnull().sum()","935c3460":"repay.isnull().sum()","fd03cff2":"# dropping null values present in 'repay' data set\nrepay.dropna(inplace=True)","c87ecc2e":"repay.isnull().sum()","cdcb77d9":"mean_original = customer[\"Age\"].mean()","9f1195e9":"print(\"The mean of Age column is\",mean_original)","3b084756":"#replacing age less than 18 with mean of age values\ncustomer.loc[customer[\"Age\"] < 18,\"Age\"] = customer[\"Age\"].mean()","762c2b43":"mean_new = customer[\"Age\"].mean()","7fb6e217":"print(\"The new mean of Age column is\",mean_new)","050d18b2":"customer.loc[customer[\"Age\"] < 18,\"Age\"]","eb3e16cf":"print(\"All the customers who have age less than 18 have been replaced by mean of the age column.\")","497b97b8":"customer.head(2)","3f9d6939":"spend.head(2)","d8475241":"#merging customer and spend table on the basis of \"Customer\" column\ncustomer_spend = pd.merge(left=customer,right=spend,on=\"Customer\",how=\"inner\")","b3f944cd":"customer_spend.head()","c03f799b":"customer_spend.shape","d4669308":"#all the customers whose spend amount is more than the limit,replacing with 50% of that customer\u2019s limit\ncustomer_spend[customer_spend[\"Amount\"] > customer_spend['Limit']]","67c0f673":"#if customer's spend amount is more than the limit,replacing with 50% of that customer\u2019s limit\ncustomer_spend.loc[customer_spend[\"Amount\"] > customer_spend[\"Limit\"],\"Amount\"] = (50 * customer_spend[\"Limit\"]).div(100)","9f700c6f":"#there are no customers left whose spend amount is more than the limit\ncustomer_spend[customer_spend[\"Amount\"] > customer_spend['Limit']]","ee5ae2a4":"customer.head(1)","eb380cb2":"repay.head(1)","8958cda4":"#merging customer and spend table on the basis of \"Customer\" column\ncustomer_repay = pd.merge(left=repay,right=customer,on=\"Customer\",how=\"inner\")","97d653f0":"customer_repay.head()","a5fe2552":"#all the customers where repayment amount is more than the limit.\ncustomer_repay[customer_repay[\"Amount\"] > customer_repay[\"Limit\"]]","4966d3c0":"#customers where repayment amount is more than the limit, replacing the repayment with the limit.\ncustomer_repay.loc[customer_repay[\"Amount\"] > customer_repay[\"Limit\"],\"Amount\"] = customer_repay[\"Limit\"]","e1bff4c1":"#there are no customers left where repayment amount is more than the limit.\ncustomer_repay[customer_repay[\"Amount\"] > customer_repay[\"Limit\"]]","f8c73500":"distinct_customers = customer[\"Customer\"].nunique()","9f979749":"print(\"Number of distinct customers are\",distinct_customers)","4f4aeee8":"#customers from different segments\ncustomer[\"Segment\"].value_counts()","cec2281c":"plt.figure(figsize=(8,6))\nsns.countplot('Segment',data=customer)\nplt.show()","1dd23fe6":"print(\"We can see from the countplot that number of distinct categories are\", len(customer[\"Segment\"].value_counts()))","176888bd":"spend.head()","df8a68dc":"#converting Month column of \"spend\" table to date time format\nspend['Month'] = pd.to_datetime(spend['Month'])","9ba9f8a2":"spend.head()","fe83aefd":"#creating new columns which show \"Month\" and \"Year\"\nspend['Monthly'] = spend['Month'].apply(lambda x:pd.Timestamp.strftime(x,format=\"%B\"))\nspend['Yearly'] = spend['Month'].apply(lambda x:pd.Timestamp.strftime(x,format=\"%Y\"))","1742f9e3":"spend.head()","5264004c":"#grouping the dataset based on 'Yearly' and 'monthly'\ncustomer_spend_group= round(spend.groupby(['Yearly','Monthly']).mean(),2)","4f0d17d4":"customer_spend_group","e768fb8f":"repay.head(2)","131234c6":"#coverting \"Month\" column to date time format\nrepay[\"Month\"] = pd.to_datetime(repay[\"Month\"])","b02baa59":"repay.head(2)","7ff5f1ea":"repay.dtypes","32344dd1":"#creating new columns which show \"Month\" and \"Year\"\nrepay['Monthly'] = repay['Month'].apply(lambda x:pd.Timestamp.strftime(x,format=\"%B\"))\nrepay['Yearly'] = repay['Month'].apply(lambda x:pd.Timestamp.strftime(x,format=\"%Y\"))","a8251710":"#grouping the dataset based on 'Yearly' and 'monthly'\ncustomer_repay_group= round(repay.groupby(['Yearly','Monthly']).mean(),2)","0701d3ec":"customer_repay_group","fa24d4d5":"#merging all the three tables. Alreaady merged customer and spend table in 'customer_spend'. Using \"customer_spend\" and \"repay\"\n#table to form the final \"customer_spend_repay\" table\ncustomer_spend_repay = pd.merge(left=customer_spend,right=repay,on=\"Customer\",how=\"inner\")","e2564172":"customer_spend_repay.head(2)","80e079ae":"# renaming the columns for clearity\ncustomer_spend_repay.rename(columns={\"Amount_x\":\"Spend_Amount\",\"Amount_y\":\"Repay_Amount\"},inplace=True)","aa6e3cf4":"customer_spend_repay.head()","287830e5":"# grouping the data based on \"Yearly\",\"Month_x\" columns to get the 'Spend_Amount'and 'Repay_Amount'\ninterest_group = customer_spend_repay.groupby([\"Yearly\",\"Monthly\"])['Spend_Amount','Repay_Amount'].sum()","0b9ed104":"interest_group","55bc0ad0":" # Monthly Profit = Monthly repayment \u2013 Monthly spend.\ninterest_group['Monthly Profit'] = interest_group['Repay_Amount'] - interest_group['Spend_Amount']","ef5b0a0a":"interest_group","29eb9205":"#interest earned is 2.9% of Monthly Profit\ninterest_group['Interest Earned'] = (2.9* interest_group['Monthly Profit'])\/100","beea1866":"interest_group","9fa23443":"spend.head()","623da857":"#top 5 product types on which customer is spending\nspend['Type'].value_counts().head()","2db2f2ec":"spend['Type'].value_counts().head(5).plot(kind='bar')\nplt.show()","6b31ca57":"customer_spend.head()","f81c8c88":"city_spend = customer_spend.groupby(\"City\")[\"Amount\"].sum().sort_values(ascending=False)","005e0ea1":"city_spend","46fe6c9f":"plt.figure(figsize=(5,10))\ncity_spend.plot(kind=\"pie\",autopct=\"%1.0f%%\",shadow=True,labeldistance=1.0,explode=[0.1,0.0,0.0,0.0,0.0,0.0,0.0,0.0])\nplt.title(\"Amount spent on credit card by customers from different cities\")\nplt.show()","78112f5b":"print(\"From above pie chart we can see that Cochin is having maximum spend.\")","0613c687":"#creating new column \"Age Group\" with 8 bins between 18 to 88 \ncustomer_spend[\"Age Group\"] =  pd.cut(customer_spend[\"Age\"],bins=np.arange(18,88,8),labels=[\"18-26\",\"26-34\", \"34-42\" ,\"42-50\" ,\"50-58\",\"58-66\",\"66-74\",\"74-82\"],include_lowest=True)","b9c36dd3":"customer_spend.head()","d58d458f":"#grouping data based on \"Age Group\" and finding the amount spend by each age group and arranging in descending oreder\nage_spend = customer_spend.groupby(\"Age Group\")['Amount'].sum().sort_values(ascending=False)","124568c0":"age_spend","71bf9e66":"plt.figure(figsize=(5,10))\nage_spend.plot(kind = \"pie\",autopct=\"%1.0f%%\",explode=[0.1,0.0,0.0,0.0,0.0,0.0,0.0,0.0],shadow=True)\nplt.show()","d4bdd291":"print(\"From the pie chart shown above we can say that age group 42 - 50 is spending more money\")","da80a7a4":"customer_repay.head()","381ee4b5":"#grouping based on \"Customer\" column to find top 10 customers\ncustomer_repay.groupby(\"Customer\")[[\"Amount\"]].sum().sort_values(by=\"Amount\",ascending=False).head(10)","1480fb1a":"customer_spend.head()","e3db812d":"#converting \"Month\" column to date time \ncustomer_spend[\"Month\"] = pd.to_datetime(customer_spend[\"Month\"])","18829760":"#creating new column \"year\" \ncustomer_spend['Year'] = customer_spend['Month'].apply(lambda x:pd.Timestamp.strftime(x,format=\"%Y\"))","3274e175":"customer_spend.head(2)","79c368f6":"customer_spend_pivot = pd.pivot_table(data = customer_spend,index=[\"City\",\"Year\"],columns='Product',aggfunc=\"sum\",values=\"Amount\")","3ff95f32":"customer_spend_pivot","0ce38d11":"customer_spend_pivot.plot(kind=\"bar\",figsize=(18,5),width=0.8)\nplt.ylabel(\"Spend Amount\")\nplt.title(\"Amount spended by customers according to year and city\")\nplt.show()","4d1ecd48":"customer_spend.head()","c776f6da":"#creating new column \"Monthly\" \ncustomer_spend['Monthly'] = customer_spend['Month'].apply(lambda x:pd.Timestamp.strftime(x,format=\"%B\"))","331d87ec":"customer_spend.head()","1cd59b64":"#grouping data based on \"Monthly\" and \"City\" columns\nmonth_city = customer_spend.groupby([\"Monthly\",\"City\"])[[\"Amount\"]].sum().sort_index().reset_index()","96e2fbbf":"#creating pivot table based on \"Monthly\" and \"City\" columns\nmonth_city =pd.pivot_table(data=customer_spend,values='Amount',index='City',columns='Monthly',aggfunc='sum')","2be17ca6":"month_city","59ca7bb6":"month_city.plot(kind=\"bar\",figsize=(18,6),width=0.8)\nplt.show()","23a2403f":"customer_spend.head()","0edee64d":"air_tickets = customer_spend.groupby([\"Year\",\"Type\"])[[\"Amount\"]].sum().reset_index()","5684df92":"filtered = air_tickets.loc[air_tickets[\"Type\"]==\"AIR TICKET\"]","5d01151a":"filtered","6e683ff1":"plt.bar(filtered[\"Year\"],height=filtered[\"Amount\"],color=\"orange\")\nplt.xlabel(\"Year\")\nplt.ylabel(\"Amount Spent\")\nplt.title(\"Comparison of yearly spend on air tickets\")\nplt.show()\n","a7765800":"customer_spend.head(2)","88aea284":"#creating pivot table based on \"Monthly\" and \"Product\" columns\nproduct_wise = pd.pivot_table(data=customer_spend,index='Product',columns='Monthly',values='Amount',aggfunc='sum')","466b6662":"product_wise","845f8f82":"product_wise.plot(kind=\"bar\",figsize=(18,6),width=0.8)\nplt.ylabel(\"Amount Spend\")\nplt.title(\"Amount spent monthly on different products\")\nplt.show()","6607830b":"customer_repay.head(2)","fa39a146":"# converting 'Month' column to date time format\ncustomer_repay['Month'] = pd.to_datetime(customer_repay['Month'])","4aacf09e":"#creating new column \"Monthly\" and \"Yearly\" using already existing 'Month' column\ncustomer_repay['Monthly'] = customer_repay['Month'].apply(lambda x:pd.Timestamp.strftime(x,format=\"%B\"))\ncustomer_repay['Yearly'] = customer_repay['Month'].apply(lambda x:pd.Timestamp.strftime(x,format=\"%Y\"))","ab356ad1":"def summary_report(product,timeperiod):\n    print('Give the product name and timeperiod for which you want the data')\n    if product.lower()=='gold' and timeperiod.lower()=='monthly':\n        pivot = customer_repay.pivot_table(index=['Product','City','Customer'],columns='Monthly',aggfunc='sum',values='Amount')\n        result = pivot.loc[('Gold',['BANGALORE','COCHIN','CALCUTTA','BOMBAY','CHENNAI','TRIVANDRUM','PATNA','DELHI']),:]\n    elif product.lower()=='gold' and timeperiod.lower()=='yearly':\n        pivot = customer_repay.pivot_table(index=['Product','City','Customer'],columns='Yearly',aggfunc='sum',values='Amount')\n        result = pivot.loc[('Gold',['BANGALORE','COCHIN','CALCUTTA','BOMBAY','CHENNAI','TRIVANDRUM','PATNA','DELHI']),:]\n    elif product.lower()=='silver' and timeperiod.lower()=='monthly':\n        pivot = customer_repay.pivot_table(index=['Product','City','Customer'],columns='Monthly',aggfunc='sum',values='Amount')\n        result = pivot.loc[('Silver',['BANGALORE','COCHIN','CALCUTTA','BOMBAY','CHENNAI','TRIVANDRUM','PATNA','DELHI']),:]\n    elif product.lower()=='silver' and timeperiod.lower()=='yearly':\n        pivot = customer_repay.pivot_table(index=['Product','City','Customer'],columns='Yearly',aggfunc='sum',values='Amount')\n        result = pivot.loc[('Silver',['BANGALORE','COCHIN','CALCUTTA','BOMBAY','CHENNAI','TRIVANDRUM','PATNA','DELHI']),:]\n    if product.lower()=='platinum' and timeperiod.lower()=='monthly':\n        pivot = customer_repay.pivot_table(index=['Product','City','Customer'],columns='Monthly',aggfunc='sum',values='Amount')\n        result = pivot.loc[('Platinum',['BANGALORE','COCHIN','CALCUTTA','BOMBAY','CHENNAI','TRIVANDRUM','PATNA','DELHI']),:]\n    elif product.lower()=='platinum' and timeperiod.lower()=='yearly':\n        pivot = customer_repay.pivot_table(index=['Product','City','Customer'],columns='Yearly',aggfunc='sum',values='Amount')\n        result = pivot.loc[('Platinum',['BANGALORE','COCHIN','CALCUTTA','BOMBAY','CHENNAI','TRIVANDRUM','PATNA','DELHI']),:]\n    return result","820d6378":"summary_report('gold','monthly')","93ddb6f1":"## (c)  Incase the repayment amount is more than the limit, replace the repayment with the limit.","462d3c61":"# Import the datasets","560f51cc":"## (c) What is the average monthly spend by customers?","283c25b4":"# (2) From the above dataset create the following summaries:","a43faea1":"## (a) Monthly comparison of total spends, city wise","a4dfc26a":"# Business Problem:","6da6085b":"# Exploratory Data Analysis","4b9281c1":"##  (d) What is the average monthly repayment by customers?","c0a6093a":"<h1 align='center'>Data Exploratory Analysis For Credit Card Data<\/h1>","15e51475":"<b>In order to effectively produce quality decisions in the modern credit card industry, knowledge must be gained through effective data analysis and modelling. Through the use of dynamic data-driven decision-making tools and procedures, information can be gathered to successfully evaluate all aspects of credit card operations. PSPD Bank has banking operations in more than 50 countries across the globe. Mr. Jim Watson, CEO, wants to evaluate areas of bankruptcy, fraud and collections, respond to customer requests for help with proactive offers and services. <\/b><br><br>\n<b>Following are some of Mr. Watson's questionsn to understand the customer spend and repayment behaviour<\/b>","ff5c9536":"## (b) How many distinct categories exist?","c389741e":"## (c)  Comparison of monthly spend for each product (look for any seasonality that exists in terms of spend)","3fede37b":"## (3) Calculate the city wise spend on each product on yearly basis. Also include a graphical representation for the same.","2e3cadaa":"# Import necessary libraries","714c9d8c":"# (4) Create graphs for\n ","5d09fa8d":"# (1) In the above dataset,","f8b7b0c9":"## (g)  Which city is having maximum spend?","ecab3587":"<b>We can see from the above graph that the sales are high for all the Products during the months:<\/b>\n<ul>\n    <li>January<\/li>\n    <li>February<\/li>\n    <li>March<\/li>\n    <li>April<\/li>\n    <li>May<\/li><\/ul>\n<b> Out of these months,highest sales are in January <\/b> ","badbdada":"## (a) How many distinct customers exist?","6dd8d57b":"## (f) What are the top 5 product types?","6760a570":"## (b) Comparison of yearly spend on air tickets","8f9a1ddf":"##  (b) In case spend amount is more than the limit, replace it with 50% of that customer\u2019s limit. (customer\u2019s limit provided in acquisition table is the per transaction limit on his card)","6dd043d9":"## (h) Which age group is spending more money?","6ecd175f":"## (e)  If the monthly rate of interest is 2.9%, what is the profit for the bank for each month? ","577d9bae":"## (i) Who are the top 10 customers in terms of repayment?","77034f71":"## (a) In case age is less than 18, replace it with mean of age values.","c6342620":"## (5) Write user defined PYTHON function to perform the following analysis: You need to find top 10 customers for each city in terms of their repayment amount by different products and by different time periods i.e. year or month. The user should be able to specify the product (Gold\/Silver\/Platinum) and time period (yearly or monthly) and the function should automatically take these inputs while identifying the top 10 customers."}}