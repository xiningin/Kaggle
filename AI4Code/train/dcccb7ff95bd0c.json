{"cell_type":{"9937d437":"code","8dce38ab":"code","0b660f02":"code","fa1bd67e":"code","f9463158":"code","70cc6353":"code","851c333f":"code","6b6140cc":"code","ab0accac":"code","f663e335":"code","02c8f703":"code","a947f16c":"code","f8a86e44":"code","a19e22d5":"code","5f2fb80b":"markdown","36ae428d":"markdown","76715f1b":"markdown","75443538":"markdown","6638d3cd":"markdown","d6384eb5":"markdown","5824b5d0":"markdown","2506ceeb":"markdown","35695efe":"markdown"},"source":{"9937d437":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\npd.set_option('display.max_columns', 50)  ","8dce38ab":"dtype_dict= {'CCN': str,    \n             'Network': str, \n             'ZipCode': str}\n\ndfr=pd.read_csv(\"..\/input\/activity-one-blend-dfr-dfc-qip-data\/InterimDataset.csv\", parse_dates=True, dtype=dtype_dict)\nprint(\"\\nThe DFR data frame has {0} rows or facilities and {1} variables or columns\\n\".format(dfr.shape[0], dfr.shape[1]))","0b660f02":"dfr.head()","fa1bd67e":"dfr.drop(columns='Unnamed: 0', axis=1, inplace=True)  # remove this unnamed column\ndfr.head()","f9463158":"dtype_dict_acs= {'GEO.id2': str}\ncolumn_dict_acs={'GEO.id2': 'ZipCode',\n                 'HC03_VC50': 'PctgBlackACS',\n                 'HC03_VC88': 'PctgHispanicACS'}\nacs=pd.read_csv(\"..\/input\/rmudsc\/ACS_16_5YR_DP05_with_ann.csv\", skiprows=[1], dtype=dtype_dict_acs, usecols=column_dict_acs.keys() )\nacs.rename(columns=column_dict_acs, inplace=True)\nprint(\"\\nThe DP05 ACS dataset has {0} rows or zip codes and {1} variables or columns are selected.\\n\".format(acs.shape[0], acs.shape[1]))\nacs.info()","70cc6353":"acs.sample(5)","851c333f":"dfr = pd.merge(dfr, acs, on='ZipCode', how='left') \ndfr.shape","6b6140cc":"# First, we import the DFC dataset. We only need CCN and zip code column.\n\ndtype_dict_acs= {'GEO.id2': str}\ncolumn_dict_acs={'GEO.id2': 'ZipCode',\n                 'HC03_VC07': 'UnemploymentRate',\n                 'HC03_VC161': 'PctgFamilyBelowFPL'}\nacs=pd.read_csv(\"..\/input\/rmudsc\/ACS_16_5YR_DP03_with_ann.csv\", skiprows=[1], dtype=dtype_dict_acs, usecols=column_dict_acs.keys() )\nacs.rename(columns=column_dict_acs, inplace=True)\nprint(\"\\nThe DP03 ACS dataset has {0} rows or zip codes and {1} variables or columns are selected.\\n\".format(acs.shape[0], acs.shape[1]))\nacs.info()","ab0accac":"acs.sample(5)","f663e335":"dfr = pd.merge(dfr, acs, on='ZipCode', how='left') \ndfr.shape","02c8f703":"dtype_dict_acs= {'GEO.id2': str}\ncolumn_dict_acs={'GEO.id2': 'ZipCode',\n                 'HC03_VC173': 'PctgPoorEnglish'\n                }\nacs=pd.read_csv(\"..\/input\/rmudsc\/ACS_16_5YR_DP02_with_ann.csv\", skiprows=[1], dtype=dtype_dict_acs, usecols=column_dict_acs.keys() )\nacs.rename(columns=column_dict_acs, inplace=True)\nprint(\"\\nThe DP02 ACS dataset has {0} rows or zip codes and {1} variables or columns are selected.\\n\".format(acs.shape[0], acs.shape[1]))\nacs.info()","a947f16c":"acs.sample(5)","f8a86e44":"dfr = pd.merge(dfr, acs, on='ZipCode', how='left') \ndfr.shape","a19e22d5":"dfr.to_csv(\"InterimDataset2.csv\")","5f2fb80b":"End of Step Two - Activity Two","36ae428d":"Import the interim dataset which has the zip codes of facilities physical location","76715f1b":"### Step Two - Blend Data\n#### Activity Two - Obtain facility neighbourhood demographic and socioeconomic data from the American Community Survey\n\nWe use a facility's zip code to get information about demographic and socioeconomic characteristics of the community where the facilitie is located.","75443538":"Let's merge the demographic data into DFR dataframe.","6638d3cd":"Let's merge the socioeconomic data into DFR dataframe.","d6384eb5":"First, we import the DP05 dataset which has demographic information about gender, age, race, and ethnicity. \n* HC03_VC50 = Percent of RACE - One race - Black or African American\n* HC03_VC88\t= Percent of HISPANIC OR LATINO AND RACE - Total population - Hispanic or Latino (of any race)","5824b5d0":"Let save the DFR dataframe to a interim file for further processing.","2506ceeb":"Thirdly, we import the DP02 dataset. Data element HC03_VC173 is percentage of people aged 5 and over that have a primary language other than English and speak English less than well. This is a good measure of English proficiency of the community which may be indicator of difficulty in communication that can potentially lead to readmission. \n","35695efe":"Second, we import the DP03 dataset which has socioeconomic data elements."}}