{"cell_type":{"708cffc5":"code","ebe6d070":"code","80d8c668":"code","17e6f369":"code","7962322f":"code","6564783f":"code","5b060e6e":"code","241a5c8d":"code","13fc0c54":"code","fbe0b3c1":"code","c47cb4fa":"code","018e4984":"code","814677dd":"markdown","7255c183":"markdown"},"source":{"708cffc5":"import pandas as pd\n\ndf = pd.read_csv(\"..\/input\/iris\/Iris.csv\")\n\n# Drop id column since it is not that important\ndf.drop(\"Id\", axis=1, inplace=True)","ebe6d070":"df","80d8c668":"df[\"Species\"].unique()","17e6f369":"# Encode labels\nclass_names = list(df[\"Species\"].unique())\n\ndf[\"Species\"] = df[\"Species\"].map(lambda label: class_names.index(label))","7962322f":"# Split into training and validation\nfrom sklearn.model_selection import train_test_split\n\ntrain_df, val_df = train_test_split(df, test_size=0.3, stratify=df[\"Species\"], random_state=42)","6564783f":"import tensorflow as tf\n\nmodel = tf.keras.Sequential([\n    tf.keras.layers.Dense(64, activation=\"relu\"),\n    tf.keras.layers.Dense(64, activation=\"relu\"),\n    tf.keras.layers.Dense(3, activation=\"softmax\")\n])","5b060e6e":"model.compile(\n    loss=\"sparse_categorical_crossentropy\",\n    metrics=[\"accuracy\"]\n)","241a5c8d":"tf.random.set_seed(12345)","13fc0c54":"earlystopping = tf.keras.callbacks.EarlyStopping(patience=10, restore_best_weights=True)","fbe0b3c1":"model.fit(\n    train_df.drop(\"Species\", axis=1),\n    train_df[\"Species\"],\n    epochs=250,\n    validation_data=(val_df.drop(\"Species\", axis=1), val_df[\"Species\"]),\n    callbacks=[earlystopping],\n    batch_size=64,\n    verbose=0,\n)","c47cb4fa":"val_loss, val_acc = model.evaluate(val_df.drop(\"Species\", axis=1), val_df[\"Species\"])\ntrain_loss, train_acc = model.evaluate(train_df.drop(\"Species\", axis=1), train_df[\"Species\"])\n\nprint(f\"Training loss: {train_loss}\")\nprint(f\"Training accuracy: {train_acc}\")\nprint(f\"Validation loss: {val_loss}\")\nprint(f\"Validation accuracy: {val_acc}\")","018e4984":"#\u00a0Saving our model\nmodel.save(\".\/model\")","814677dd":"# Load data","7255c183":"# Deep learning"}}