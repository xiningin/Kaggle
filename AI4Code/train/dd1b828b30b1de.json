{"cell_type":{"8bf3ee55":"code","9918b339":"code","d239bbb2":"code","28d21f19":"code","9adf457a":"code","9eecd1bf":"code","cd542995":"code","e1d6991e":"code","3e9dd619":"code","6dcb3538":"code","ec7f89e0":"code","0ee140ed":"code","d511ccf6":"code","66a9bff2":"code","38baa566":"code","bba427a7":"code","9fa5f7b4":"code","2c6550bf":"code","d5b7ba70":"code","3aee6f7b":"code","79884fdb":"code","a2d24e97":"markdown","418e09f7":"markdown","8186b496":"markdown","f6b8ba6c":"markdown","a5ef126c":"markdown","95244d3d":"markdown","c0e870b7":"markdown","19335a0d":"markdown","3f8ea2a1":"markdown","1dbfdc4e":"markdown","f05b04b5":"markdown","2b663b0c":"markdown","26e074a2":"markdown","5905e45d":"markdown","86588828":"markdown","5f25e942":"markdown","b3b83f5f":"markdown","288e63bb":"markdown","2de7c390":"markdown","36c8b3de":"markdown","ac389221":"markdown","e1d3f9f6":"markdown","4f191d44":"markdown","675580ad":"markdown","05948a05":"markdown"},"source":{"8bf3ee55":"%matplotlib inline\n%load_ext autoreload\n%autoreload 2\n%config InlineBackend.figure_format = 'retina'\n\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns \nfrom math import pi","9918b339":"data_path = '..\/input\/heart.csv'\n\ndf = pd.read_csv(data_path)","d239bbb2":"df.head()","28d21f19":"df.describe()","9adf457a":"fig,ax = plt.subplots(figsize=(10, 10))\nsns.heatmap(df.corr(), ax=ax, annot=True, linewidths=0.05, fmt= '.2f',cmap=\"magma\")\nplt.show()","9eecd1bf":"sns.pairplot(data=df)","cd542995":"#print(\"Men vs Women Count\\n\", df.sex.value_counts())\nmen_count = len(df[df['sex']== 1])\nwomen_count = len(df[df['sex']==0])\n\nplt.figure(figsize=(8,6))\n\n# Data to plot\nlabels = 'Men','Women'\nsizes = [men_count,women_count]\ncolors = ['skyblue', 'yellowgreen']\nexplode = (0, 0)  # explode 1st slice\n \n# Plot\nplt.pie(sizes, explode=explode, labels=labels, colors=colors,\nautopct='%1.2f%%', shadow=True)\nplt.show()\n ","e1d6991e":"sns.countplot(x='target', data=df)","3e9dd619":"print(\"People having heart diseace vs people who doesn't: \\n\", df.target.value_counts())\nheart_disease = len(df[df['target']==1])\nno_heart_disease = len(df[df['target']==0])\nlabels = [\"Heart Diesease\", \"NO Heart Disease\"]\nsizes = [heart_disease, no_heart_disease]\ncolors = ['skyblue', 'yellowgreen']\nplt.figure(figsize=(8,6))\n\nplt.pie(sizes, explode=explode, labels=labels, colors=colors,\nautopct='%1.2f%%', shadow=True)\nplt.show()\n ","6dcb3538":"pd.crosstab(df.age, df.target).plot(kind='bar', figsize=(20, 10))\nplt.title(\"People having heart disease vs people not having heart disease for a given age\")\nplt.xlabel(\"Age Distribution\")\nplt.ylabel(\"Heart Disease Frequency\")\n\n","ec7f89e0":"my_colors = 'yr'\npd.crosstab(df.thalach, df.target).plot(kind='bar', figsize=(20,10), color=my_colors)\nplt.title(\"Heart diseases frequency for Maximum heart rate\")\nplt.xlabel(\"Maximum Heart Rate for a person\")\nplt.ylabel(\"Heart Disease Frequency\")","0ee140ed":"pd.crosstab(df.cp, df.target).plot(kind='bar', figsize = (20,10))\nplt.title(\"Heart disease frequency over Chesr Pain Type\")\nplt.xlabel(\"Cheast Pain Type \")\nplt.ylabel(\"Heart Disease Frequency\")","d511ccf6":"pd.crosstab(df.slope, df.target).plot(kind='bar', figsize=(10,10))\nplt.title(\"Heart disease frequency over Slope\")\nplt.xlabel(\"Slope Frequency\")\nplt.ylabel(\"Heart Disease Frequency\")","66a9bff2":"\na = pd.get_dummies(df['cp'], prefix = \"cp\")\nb = pd.get_dummies(df['thal'], prefix = \"thal\")\nc = pd.get_dummies(df['slope'], prefix = \"slope\")\nframes = [df, a, b, c]\ndf = pd.concat(frames, axis = 1)\n\nto_be_dropped = ['cp', 'thal', 'slope']\ndf = df.drop(to_be_dropped, axis=1)\ndf.head()","38baa566":"df = (df - np.min(df)) \/ (np.max(df) - np.min(df)).values","bba427a7":"features = df.drop(\"target\", axis=1)\ntargets = df.target.values","9fa5f7b4":"from sklearn.model_selection import train_test_split\ntrain_features,test_features,train_targets,test_targets = train_test_split(features,targets,test_size = 0.20,random_state = 42)\n\n","2c6550bf":"# Imports\nimport numpy as np\nfrom keras.models import Sequential\nfrom keras.layers.core import Dense, Dropout, Activation\nfrom keras.optimizers import SGD\nfrom keras.utils import np_utils\n\n# Building the model\nmodel = Sequential()\nmodel.add(Dense(128, activation='relu', input_shape=(train_features.shape[1],)))\nmodel.add(Dense(64, activation='relu'))\nmodel.add(Dense(32, activation='relu'))\nmodel.add(Dense(1, activation='sigmoid'))\n\n# Compiling the model\nmodel.compile(loss = 'mean_squared_error', optimizer='adam', metrics=['mse', 'mae'])\nmodel.summary()","d5b7ba70":"history = model.fit(train_features, train_targets, validation_split=0.2, epochs=100, batch_size=16, verbose=1)","3aee6f7b":"#print(vars(history))\nplt.plot(history.history['loss'])\n\nplt.title('Model loss')\nplt.ylabel('Loss')\nplt.xlabel('Epoch')\nplt.legend(['Train', 'Test'], loc='upper left')\nplt.show()","79884fdb":"y_pred = model.predict(test_features)\nplt.plot(test_targets)\nplt.plot(y_pred)\nplt.title('Prediction')","a2d24e97":"# Introduction\nThis notebook is built to help predict if a patient has a heart disease or not.\nWe have a data which classified if patients have heart disease or not according to features in it. We will try to use this data to create a model which tries predict if a patient has this disease or not.","418e09f7":"## Evaluating the model","8186b496":"## Converting the data to features and targets","f6b8ba6c":"### 1. Men vs Women %","a5ef126c":"## Normalizing the data","95244d3d":"## Analyzing heart disease frequency over chest pain type \n\nChest pain type:\n \n   1  --> Typical angina \n   \n   2  --> Atypical angina \n   \n   3  --> Non-anginal pain \n   \n   4  --> Asymptomatic","c0e870b7":"### Corelation plot to find important Features","19335a0d":"### 3. Heart Disease Ratio","3f8ea2a1":"## Splitting the data into train and test sets","1dbfdc4e":"### Inference\n\nWe could infer from the above chrat that people who have Atypical angina or non-anginal pain have higher probability of having heart disease","f05b04b5":"## Training the model","2b663b0c":"### 2. People who have disease vs who don't","26e074a2":"## Load and prepare the data\nA critical step in working with neural networks is preparing the data correctly. Variables on different scales make it difficult for the network to efficiently learn the correct weights. Below, we've written the code to load and prepare the data.","5905e45d":"### Inference\nWe could infer from the chart above that age is not a huge influening factor for heart disease","86588828":"## Prediction vs original labels","5f25e942":"## Finally we have prepared our data. Now it's time to train it with neural nets !!! \n","b3b83f5f":"### Inference\nIt's clear that chest pain, Maximum Heart Rate and Slope are significantly important than other","288e63bb":"### Inference\nWe could infer from the above chart that people who have higher heart rate has a higher probability of having a heart disease","2de7c390":"    age - age in years \n    sex - (1 = male; 0 = female) \n    cp - chest pain type \n    trestbps - resting blood pressure (in mm Hg on admission to the hospital) \n    chol - serum cholestoral in mg\/dl \n    fbs - (fasting blood sugar > 120 mg\/dl) (1 = true; 0 = false) \n    restecg - resting electrocardiographic results \n    thalach - maximum heart rate achieved \n    exang - exercise induced angina (1 = yes; 0 = no) \n    oldpeak - ST depression induced by exercise relative to rest \n    slope - the slope of the peak exercise ST segment \n    ca - number of major vessels (0-3) colored by flourosopy \n    thal - 3 = normal; 6 = fixed defect; 7 = reversable defect \n    target - have disease or not (1=yes, 0=no)","36c8b3de":"## Cleaning the data","ac389221":"## Columns - Defined","e1d3f9f6":"### Analyzing heart disease over Maximum Heart Rate","4f191d44":"## Analyzing Heart disease frequency over Slope\n\n1 --> upsloping\n\n2 --> flat\n\n3 --> downsloping","675580ad":"### Analyzing heart disease over age distribution","05948a05":"## Analyzing all Features"}}