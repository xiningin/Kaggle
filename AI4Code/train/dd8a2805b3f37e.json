{"cell_type":{"40a511eb":"code","763e2fef":"code","1edd7e31":"code","3ac8fd1c":"code","c784966b":"code","1b97c06e":"code","ff3fa418":"code","e6d18f64":"code","248e7295":"code","9fcaa6d7":"code","213865b6":"code","c3777928":"code","74013e46":"code","56303a07":"code","29874324":"code","b77374f0":"code","73478d49":"code","96f9a66f":"code","591ac6e8":"code","a1a9d1ab":"code","890a7d02":"markdown","2ae971bb":"markdown","3df4f759":"markdown","4763a64f":"markdown","e54d779f":"markdown"},"source":{"40a511eb":"%reload_ext autoreload\n%autoreload 2\n%matplotlib inline","763e2fef":"from fastai.vision import *\nfrom fastai.metrics import error_rate\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nprint(os.listdir(\"..\/input\"))","1edd7e31":"bs = 64\n# bs = 16   # uncomment this line if you run out of memory even after clicking Kernel->Restart","3ac8fd1c":"path = \"..\/input\/\"\ntfms = tfms = get_transforms(do_flip=False)","c784966b":"print(os.listdir(\"..\/input\/train\/train\")[0:5])","1b97c06e":"help(ImageDataBunch.from_csv)","ff3fa418":"data = ImageDataBunch.from_csv(path, folder = \"train\/train\", csv_labels = \"train.csv\",\n                               test = \"..\/input\/test\/test\", ds_tfms=tfms, size=224)","e6d18f64":"data","248e7295":"data.show_batch(rows=3, figsize=(7,6))","9fcaa6d7":"print(data.classes)\nlen(data.classes),data.c","213865b6":"learn = cnn_learner(data, models.resnet34, metrics=error_rate, model_dir=\"\/tmp\/model\/\")","c3777928":"learn.fit_one_cycle(1)\n#learn.fit_one_cycle(4)","74013e46":"learn.save('stage-1')","56303a07":"interp = ClassificationInterpretation.from_learner(learn)\n\nlosses,idxs = interp.top_losses()\n\nlen(data.valid_ds)==len(losses)==len(idxs)","29874324":"interp.plot_top_losses(9, figsize=(15,11))","b77374f0":"preds,_ = learn.get_preds(ds_type=DatasetType.Test)\npreds[0]","73478d49":"test_df = pd.read_csv(path+\"\/sample_submission.csv\")\ntest_df.head()","96f9a66f":"test_df.has_cactus = preds.numpy()[:, 0]\ntest_df.to_csv(\"submission.csv\", index=False)\ntest_df.head()","591ac6e8":"test_img = ImageList.from_df(test_df, path='..\/input\/test\/test')\ntest_img[0]\nlearn.predict(test_img[0])","a1a9d1ab":"test_predictions = []\nfor test_image in test_data:\n    test_predictions.append(learn.predict(test_image)[0])\n    \ntest_predictions[0:5]    ","890a7d02":"### Results","2ae971bb":"#### Making predictions by iteration (WIP)","3df4f759":"### Training : resnet34","4763a64f":"#### Directly using get_preds","e54d779f":"### Predictions on Test Set"}}