{"cell_type":{"60ad38ec":"code","f7eb4cc0":"code","6cf6347a":"code","1b7524c0":"code","9ac60c27":"code","e03f3293":"code","7ab112c3":"code","8cf9f814":"code","e250078b":"code","6fe9ff02":"code","eab69fb8":"code","d592e45e":"code","41089518":"code","b8021204":"code","5ff76ef6":"code","d1b8fa2f":"code","301fcd2e":"code","102791c7":"code","6c6aa228":"code","0750e35a":"code","cbd9ae23":"code","052943a0":"code","283d15d3":"code","670eb211":"code","bde05ed6":"code","a41da36d":"code","2e90595c":"code","d5f40bf7":"code","61340525":"code","a7b1eb2f":"code","5e836b93":"code","a0487a6a":"code","6692513f":"code","0d64eb8c":"code","6d16d2e6":"code","29c17bd9":"code","e5a13cc5":"code","4553b7ca":"code","0e9c05f0":"code","f8209442":"code","d1e84c8f":"code","186e465f":"code","593eb0a4":"code","cb5c230a":"code","74d85799":"code","eda75458":"code","0c5035ea":"code","2935ba68":"code","8ad92333":"markdown","3ae297f7":"markdown","2ee70eb9":"markdown","2f3757e0":"markdown","3636f0c5":"markdown","d8ab37fe":"markdown"},"source":{"60ad38ec":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n\nimport plotly.graph_objects as go\nimport plotly.express as px\nimport plotly.io as pio\npio.templates.default = \"plotly_dark\"\nfrom plotly.subplots import make_subplots\n","f7eb4cc0":"data = pd.read_csv('..\/input\/memory-test-on-drugged-islanders-data\/Islander_data.csv')","6cf6347a":"data.head()","1b7524c0":"data.info()","9ac60c27":"data.describe()","e03f3293":"cleaned_data = data.copy()","7ab112c3":"plt.figure(figsize=(16,6))\nsns.barplot(x='Drug',y='Mem_Score_Before',data=cleaned_data, order=cleaned_data.Drug.unique().tolist())\nplt.title('Distribution of Drugs')","8cf9f814":"fig = px.bar(cleaned_data, x=\"age\", y=\"Mem_Score_Before\", title=\"Mem_Score_Before over Age\",\n             color_discrete_sequence=['#F42272'])\nfig.show()\n\nfig = px.bar(cleaned_data, x=\"age\", y=\"Mem_Score_After\", title=\"Mem_Score_After over Age\", \n              log_y=True, color_discrete_sequence=['#F42272'])\nfig.show()","e250078b":"fig = px.sunburst(cleaned_data.sort_values(by='age', ascending=False).reset_index(drop=True), \n                 path=[\"first_name\"], values=\"Mem_Score_Before\", height=700,\n                 title='Sunburst for Mem_Score_Before ',\n                 color_discrete_sequence = px.colors.qualitative.Prism)\nfig.data[0].textinfo = 'label+text+value'\nfig.show()","6fe9ff02":"fig = px.bar(cleaned_data.sort_values('age', ascending=False)[:10][::-1], \n             x='Mem_Score_Before', y='first_name',\n             title='Patient with Higest Mem_Score_Before', text='Mem_Score_Before', orientation='h')\nfig.show()","eab69fb8":"fig = px.bar(cleaned_data.sort_values('age', ascending=False)[:10][::-1], \n             x='Mem_Score_After', y='first_name',\n             title='Patient with Higest Mem_Score_After', text='Mem_Score_After', orientation='h')\nfig.show()","d592e45e":"bins = [0, 2, 18, 35, 65, np.inf]\nnames = ['<2', '2-18', '18-35', '35-65', '65+']\n\ncleaned_data['AgeRange'] = pd.cut(cleaned_data['age'], bins, labels=names)\n","41089518":"labels = ['A', 'S','T']\nsizes = []\nsizes.append(list(cleaned_data['Drug'].value_counts())[0])\nsizes.append(list(cleaned_data['Drug'].value_counts())[1])\nsizes.append(list(cleaned_data['Drug'].value_counts())[2])\n\n\nexplode = (0, 0.1, 0)\ncolors = ['#ffcc99','#66b3ff','#ff9999']\n\nplt.figure(figsize= (15,10))\nplt.title('Distribution of Drug',fontsize = 20)\nplt.pie(sizes, explode=explode, labels=labels, colors=colors, autopct='%1.1f%%',shadow=True, startangle=90)\nplt.axis('equal')\nplt.tight_layout()","b8021204":"sns.pairplot(cleaned_data)","5ff76ef6":"from pandas.plotting import scatter_matrix\n\nfig, ax = plt.subplots(figsize=(12,12))\nscatter_matrix(cleaned_data, alpha=1, ax=ax)","d1b8fa2f":"df_plot = cleaned_data[(cleaned_data['Diff']>0)]\nsns.boxplot('AgeRange', 'Diff', data=df_plot)","301fcd2e":"plt.figure(figsize=(10,6))\nax = sns.boxplot(x=\"Drug\", y=\"Mem_Score_After\", hue=\"Drug\",\n                 data=cleaned_data, palette=\"Set3\")","102791c7":"grgs = cleaned_data.groupby([\"Drug\",\"Happy_Sad_group\"])[[\"Mem_Score_After\"]].mean().reset_index()\nfig = px.bar(grgs[['Drug', 'Mem_Score_After','Happy_Sad_group']].sort_values('Mem_Score_After', ascending=False), \n             y=\"Mem_Score_After\", x=\"Drug\", color='Happy_Sad_group', \n             log_y=True, template='plotly_dark')\nfig.show()","6c6aa228":"fig = px.scatter(cleaned_data, x=\"Mem_Score_Before\", y=\"Mem_Score_After\", color=\"Drug\", facet_col=\"Drug\",\n           color_continuous_scale=px.colors.sequential.Viridis, render_mode=\"webgl\")\nfig.show()","0750e35a":"fig = px.scatter(cleaned_data, x=\"Mem_Score_Before\", y=\"Mem_Score_After\", color=\"Happy_Sad_group\", facet_col=\"Happy_Sad_group\",\n           color_continuous_scale=px.colors.sequential.Viridis, render_mode=\"webgl\")\nfig.show()","cbd9ae23":"df = cleaned_data\nfig = px.density_contour(df, x=\"Mem_Score_Before\", y=\"Mem_Score_After\", color=\"AgeRange\", marginal_x=\"rug\", marginal_y=\"histogram\")\nfig.show()","052943a0":"fig = px.violin(cleaned_data, y=\"Diff\", x=\"Happy_Sad_group\", color=\"Happy_Sad_group\", box=True, points=\"all\")\nfig.show()","283d15d3":"fig = px.parallel_categories(cleaned_data, color=\"age\", color_continuous_scale=px.colors.sequential.Inferno)\nfig.show()","670eb211":"fig = px.scatter(cleaned_data, x=\"Mem_Score_Before\", y=\"Diff\", size=\"Mem_Score_Before\", color=\"Drug\",\n           hover_name=\"Drug\", log_x=True, size_max=60)\nfig.show()","bde05ed6":"fig = px.strip(cleaned_data, x=\"AgeRange\", y=\"Diff\", orientation=\"h\", color=\"Drug\")\nfig.show()","a41da36d":"ms = cleaned_data.sort_values(by=['age'],ascending=False)\nms = ms.head(30)\nfig = px.funnel(ms, x='Mem_Score_Before', y='Happy_Sad_group')\nfig.show()","2e90595c":"cleaned_data.head()","d5f40bf7":"cleaned_data.info()","61340525":"fig,ax=plt.subplots(figsize=(15,5))\nsns.heatmap(cleaned_data.isnull(), annot=True)","a7b1eb2f":"fig=plt.figure(figsize=(18,18))\nsns.heatmap(cleaned_data.corr(), annot= True, cmap='Blues')\n","5e836b93":"preprocessed_data = cleaned_data.drop(['first_name','last_name','Happy_Sad_group'],axis=1)","a0487a6a":"cleaned_data.Happy_Sad_group = cleaned_data.Happy_Sad_group.apply(lambda x: 1 if x == 'H' else 0)\ndata_label=cleaned_data['Happy_Sad_group']\ndel data['Happy_Sad_group']\ndata_label=pd.DataFrame(data_label)","6692513f":"preprocessed_data = pd.get_dummies(preprocessed_data,columns=['Drug','AgeRange'],drop_first=True)","0d64eb8c":"from sklearn.preprocessing import StandardScaler, MinMaxScaler\ndata_scaled=MinMaxScaler().fit_transform(preprocessed_data)\ndata_scaled=pd.DataFrame(data=data_scaled, columns=preprocessed_data.columns)","6d16d2e6":"from sklearn.model_selection import train_test_split\nXtrain,Xtest,Ytrain,Ytest = train_test_split(data_scaled, data_label, test_size=0.10,\n                                             stratify=data_label,random_state=121)","29c17bd9":"from sklearn.linear_model import SGDClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.ensemble import ExtraTreesClassifier\nfrom sklearn.ensemble import BaggingClassifier\nfrom sklearn.ensemble import AdaBoostClassifier\nfrom sklearn.ensemble import GradientBoostingClassifier\n#from sklearn.ensemble import StackingClassifier Need to update sklearn to use inbuilt stacking classifier\nfrom sklearn.ensemble import VotingClassifier\n\nfrom sklearn.metrics import confusion_matrix,classification_report\nfrom sklearn.metrics import precision_recall_curve\nfrom sklearn.metrics import average_precision_score\nfrom sklearn.metrics import roc_curve\nfrom sklearn.metrics import auc\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.metrics import f1_score","e5a13cc5":"def CrossVal(dataX,dataY,mode,cv=3):\n    score=cross_val_score(mode,dataX , dataY, cv=cv, scoring='accuracy')\n    return(np.mean(score))","4553b7ca":"modelk=KNeighborsClassifier(algorithm='auto',n_neighbors= 5)\nscore_k=CrossVal(Xtrain,Ytrain,modelk)\nprint(\"Accuracy is : \",score_k)\nmodelk.fit(Xtrain,Ytrain)\ncr = classification_report(Ytest, modelk.predict(Xtest))\nprint(cr)\n\n# confusion matrix \n\nfig=plt.figure()\nsns.heatmap(confusion_matrix(Ytest,modelk.predict(Xtest)), annot= True, cmap='Reds')\nk_f1=f1_score(Ytest,modelk.predict(Xtest))\nplt.title('F1 Score = {}'.format(k_f1))","0e9c05f0":"modellog=LogisticRegression()\nscore_k=CrossVal(Xtrain,Ytrain,modellog)\nprint(\"Accuracy is : \",score_k)\nmodellog.fit(Xtrain,Ytrain)\ncr = classification_report(Ytest, modellog.predict(Xtest))\nprint(cr)\n\n# confusion matrix \n\nfig=plt.figure()\nsns.heatmap(confusion_matrix(Ytest,modellog.predict(Xtest)), annot= True, cmap='Reds')\nlog_f1=f1_score(Ytest,modellog.predict(Xtest))\nplt.title('F1 Score = {}'.format(log_f1))","f8209442":"modeldt=DecisionTreeClassifier(max_depth=6)\nscore_k=CrossVal(Xtrain,Ytrain,modeldt)\nprint(\"Accuracy is : \",score_k)\nmodeldt.fit(Xtrain,Ytrain)\ncr = classification_report(Ytest, modeldt.predict(Xtest))\nprint(cr)\n\n# confusion matrix \n\nfig=plt.figure()\nsns.heatmap(confusion_matrix(Ytest,modeldt.predict(Xtest)), annot= True, cmap='Reds')\ndt_f1=f1_score(Ytest,modeldt.predict(Xtest))\nplt.title('F1 Score = {}'.format(dt_f1))","d1e84c8f":"modelsvc=SVC(C=0.2,probability=True,kernel='rbf',gamma=0.1)\nscore_k=CrossVal(Xtrain,Ytrain,modelsvc)\nprint(\"Accuracy is : \",score_k)\nmodelsvc.fit(Xtrain,Ytrain)\ncr = classification_report(Ytest, modelsvc.predict(Xtest))\nprint(cr)\n\n# confusion matrix \n\nfig=plt.figure()\nsns.heatmap(confusion_matrix(Ytest,modelsvc.predict(Xtest)), annot= True, cmap='Reds')\nsvc_f1=f1_score(Ytest,modelsvc.predict(Xtest))\nplt.title('F1 Score = {}'.format(svc_f1))","186e465f":"modelrt=RandomForestClassifier(n_estimators=200, n_jobs=-1, random_state=97)\nscore_k=CrossVal(Xtrain,Ytrain,modelrt)\nprint(\"Accuracy is : \",score_k)\nmodelrt.fit(Xtrain,Ytrain)\ncr = classification_report(Ytest, modelrt.predict(Xtest))\nprint(cr)\n\n# confusion matrix \n\nfig=plt.figure()\nsns.heatmap(confusion_matrix(Ytest,modelrt.predict(Xtest)), annot= True, cmap='Reds')\nrt_f1=f1_score(Ytest,modelrt.predict(Xtest))\nplt.title('F1 Score = {}'.format(rt_f1))","593eb0a4":"modelext=ExtraTreesClassifier(n_estimators=200, n_jobs=-1, random_state=2)\nscore_k=CrossVal(Xtrain,Ytrain,modelext)\nprint(\"Accuracy is : \",score_k)\nmodelext.fit(Xtrain,Ytrain)\ncr = classification_report(Ytest, modelext.predict(Xtest))\nprint(cr)\n\n# confusion matrix \n\nfig=plt.figure()\nsns.heatmap(confusion_matrix(Ytest,modelext.predict(Xtest)), annot= True, cmap='Reds')\next_f1=f1_score(Ytest,modelext.predict(Xtest))\nplt.title('F1 Score = {}'.format(ext_f1))","cb5c230a":"modelada=AdaBoostClassifier(modellog,n_estimators=100, random_state=343, learning_rate=0.012)\n\nscore_k=CrossVal(Xtrain,Ytrain,modelada)\nprint(\"Accuracy is : \",score_k)\nmodelada.fit(Xtrain,Ytrain)\ncr = classification_report(Ytest, modelada.predict(Xtest))\nprint(cr)\n\n# confusion matrix \n\nfig=plt.figure()\nsns.heatmap(confusion_matrix(Ytest,modelada.predict(Xtest)), annot= True, cmap='Reds')\nada_f1=f1_score(Ytest,modelada.predict(Xtest))\nplt.title('F1 Score = {}'.format(ada_f1))","74d85799":"modelgbc=GradientBoostingClassifier(n_estimators=100, random_state=43, learning_rate = 0.01)\n\nscore_k=CrossVal(Xtrain,Ytrain,modelgbc)\nprint(\"Accuracy is : \",score_k)\nmodelgbc.fit(Xtrain,Ytrain)\ncr = classification_report(Ytest, modelgbc.predict(Xtest))\nprint(cr)\n\n# confusion matrix \n\nfig=plt.figure()\nsns.heatmap(confusion_matrix(Ytest,modelgbc.predict(Xtest)), annot= True, cmap='Reds')\ngbc_f1=f1_score(Ytest,modelgbc.predict(Xtest))\nplt.title('F1 Score = {}'.format(gbc_f1))","eda75458":"fig= plt.figure(figsize=(10,10))\nimportant=pd.Series(modelrt.feature_importances_, index=Xtrain.columns)\nsns.set_style('whitegrid')\nimportant.sort_values().plot.bar()\nplt.title('Feature Importance for Random Forest Classifier')","0c5035ea":"model_f1_score = pd.Series(data=[k_f1, log_f1, dt_f1, svc_f1, rt_f1, ext_f1, ada_f1, \n                           gbc_f1], \n                           index=['KNN','logistic Regression','decision tree', 'SVM', 'Random Forest',\n                                'Extra Tree', 'Ada Boost' , 'Gradient Boost'])\nfig= plt.figure(figsize=(8,8))\nmodel_f1_score.sort_values().plot.bar()\nplt.title('Model F1 Score Comparison')","2935ba68":"modelvc=VotingClassifier(estimators=[('knn',modelk),('SGD',modelsvc),('lr',modellog)],\n                    voting='soft')\n\nscore_k=CrossVal(Xtrain,Ytrain,modelada)\nprint(\"Accuracy is : \",score_k)\nmodelvc.fit(Xtrain,Ytrain)\ncr = classification_report(Ytest, modelvc.predict(Xtest))\nprint(cr)\n\n# confusion matrix \n\nfig=plt.figure()\nsns.heatmap(confusion_matrix(Ytest,modelvc.predict(Xtest)), annot= True, cmap='Reds')\nmodel_vc_f1=f1_score(Ytest,modelvc.predict(Xtest))\nplt.title('F1 Score = {}'.format(model_vc_f1))","8ad92333":"<b> More Predictive Analysis in Pipeline. And don't Hesitate to give an upvote if you like it <\/b>","3ae297f7":"<img src = \"https:\/\/scx1.b-cdn.net\/csz\/news\/800\/2017\/memory.jpg\"\/>","2ee70eb9":"# 2.Data Preprocessing","2f3757e0":"# Memory Test on Drugged Islanders Data\n## Classification of Anti-Anxiety Medicine on Novel Islanders grouped by Happy or Sad Memory Priming\n#### Drugs of interest (known-as) [Dosage 1, 2, 3]:\n\n* A - Alprazolam (Xanax, Long-term) [1mg\/3mg\/5mg]\n\n* T - Triazolam (Halcion, Short-term) [0.25mg\/0.5mg\/0.75mg]\n\n* S- Sugar Tablet (Placebo) [1 tab\/2tabs\/3tabs]\n\n* Dosages follow a 1:1 ratio to ensure validity\n* Happy or Sad memories were primed 10 minutes prior to testing\n* Participants tested every day for 1 week to mimic addiction","3636f0c5":"# 3.Predictive Analysis","d8ab37fe":"## 1.Exploratory Data Analysis"}}