{"cell_type":{"138d9443":"code","f165b2f0":"code","03792d94":"code","c54eaa04":"markdown"},"source":{"138d9443":"import pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nimport matplotlib.pylab as plt\nimport plotly\nimport plotly.graph_objs as go\nfrom plotly.offline import download_plotlyjs, init_notebook_mode, plot, iplot\nfrom sklearn.linear_model import LinearRegression\nimport datetime\nimport colorlover as cl\nimport numpy as np\nplt.style.use('ggplot')\ncolor_pal = [x['color'] for x in plt.rcParams['axes.prop_cycle']]\n\n# Format the data\ndf = pd.read_csv('..\/input\/santaworkshoplb\/01072020-santa-workshop-tour-2019-publicleaderboard.csv')\ndf['SubmissionDate'] = pd.to_datetime(df['SubmissionDate'])\ndf = df.set_index(['TeamName','SubmissionDate'])['Score'].unstack(-1).T\ndf.columns = [name for name in df.columns]\n\nFIFTEENTH_SCORE = df.min().sort_values(ascending=True)[15]\nFIFTYTH_SCORE = df.min().sort_values(ascending=True)[50]\nTOP_SCORE = df.min().sort_values(ascending=True)[0]","f165b2f0":"plt.style.use('bmh')\nplt.rcParams[\"font.size\"] = \"12\"\nALL_TEAMS = df.columns.values\ndf_ffill = df[ALL_TEAMS[1:]].ffill()\n\n# This is broken\ndf_ffill.plot(figsize=(20, 10),\n              color=color_pal[0],\n              legend=False,\n              alpha=0.05,\n              ylim=(68850-1000, 80850),\n              title='All Teams Public LB Scores over Time')\n\ndf.ffill().min(axis=1).plot(color=color_pal[1], label='1st Place Public LB', legend=True)\nplt.show()","03792d94":"plt.style.use('bmh')\nplt.rcParams[\"font.size\"] = \"25\"\nteam_over_time = df.ffill() \\\n    .count(axis=1)\n\nlr = LinearRegression()\n_ = lr.fit(np.array(pd.to_numeric(team_over_time.index).tolist()).reshape(-1, 1),\n           team_over_time.values)\n\nteamcount_df = pd.DataFrame(team_over_time)\n\nteamcount_pred_df = pd.DataFrame(index=pd.date_range('11-20-2019','01-20-2020'))\n\nlr = LinearRegression()\n_ = lr.fit(np.array(pd.to_numeric(team_over_time[-100:].index).tolist()).reshape(-1, 1),\n           team_over_time[-100:].values)\n\nteamcount_pred_df['Forecast Using Recent Data'] = lr.predict(np.array(pd.to_numeric(teamcount_pred_df.index).tolist()).reshape(-1, 1))\n\nplt.rcParams[\"font.size\"] = \"12\"\nax =df.ffill() \\\n    .count(axis=1) \\\n    .plot(figsize=(20, 8),\n          title='Forecasting the Final Number of Teams',\n         color=color_pal[5], lw=5,\n         xlim=('11-01-2019','01-20-2020'))\nteamcount_pred_df['Forecast Using Recent Data'].plot(ax=ax, style='.-.', alpha=0.5, label='Regression Using last 1000 observations')\nax.set_ylabel('Number of Teams')\nteamcount_pred_df.plot(ax=ax, style='.-.', alpha=0.5)\nplt.axvline('1-8-2020', color='orange', linestyle='-.')\nplt.text('1-8-2020', 900,'Merger Deadline',rotation=-90)\nplt.axvline('1-15-2020', color='orange', linestyle='-.')\nplt.text('1-15-2020', 500,'Deadline',rotation=-90)\nplt.show()","c54eaa04":"# Tracking Santas Helpers"}}