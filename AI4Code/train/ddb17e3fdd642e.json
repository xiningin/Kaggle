{"cell_type":{"6163035f":"code","0f7d30fd":"code","d2ca1fc0":"code","ec70e259":"code","af3bd83f":"code","2309f1ea":"code","0329197f":"code","99d753db":"code","88a8be4c":"code","278fee92":"code","e3db3d6e":"code","c5936049":"code","4345c75e":"code","e9c508ca":"code","f279b08d":"code","08ec3762":"code","0a7f0850":"code","a4f72d9b":"code","1888c8c2":"code","7b1d28f3":"code","b1bcd139":"code","73819030":"code","05715905":"code","53157353":"code","6ea50d30":"code","b1f4b9a3":"code","c2956421":"code","3c5965c0":"code","64f31fb6":"code","820d67fe":"code","4c308f7f":"code","1d36d633":"code","a35beffe":"code","d2ece18e":"code","4e595fd9":"code","a04480b7":"code","e392ed70":"code","020ed38f":"code","1163f1a2":"code","f912444d":"code","137d76f5":"code","9110a420":"markdown","1ad0c392":"markdown","df98fdd6":"markdown","d560c816":"markdown","03cacef9":"markdown","0dbbf8c7":"markdown","acdb37c9":"markdown","0781ed90":"markdown","abbc700d":"markdown","742f4a0d":"markdown","2111f4f1":"markdown","385a028c":"markdown","90c5a0d7":"markdown","7633e805":"markdown","35ec01df":"markdown","78c36af2":"markdown","836148f2":"markdown","f41bf3f8":"markdown","b459be2f":"markdown","e4fa74af":"markdown","06e57b85":"markdown","92a5f10c":"markdown","f21136d6":"markdown","391060d5":"markdown","d2229360":"markdown"},"source":{"6163035f":"import numpy as np\nimport keras\nfrom keras.models import Sequential\nfrom keras.layers import Dense,Conv2D,MaxPool2D,Dropout,BatchNormalization,Flatten,Activation\nfrom keras.preprocessing import image \nfrom keras.preprocessing.image import ImageDataGenerator\nimport matplotlib.pyplot as plt\nfrom keras.utils import plot_model\nimport seaborn as sns","0f7d30fd":"train_directory='..\/input\/100-bird-species\/train'\nval_directory='..\/input\/100-bird-species\/valid'\ntest_directory='..\/input\/100-bird-species\/test'","d2ca1fc0":"train_datagen=ImageDataGenerator(rescale=1\/255)\nval_datagen=ImageDataGenerator(rescale=1\/255)\ntest_datagen=ImageDataGenerator(rescale=1\/255)","ec70e259":"train_generator=train_datagen.flow_from_directory(train_directory,\n                                                 target_size=(224,224),\n                                                 color_mode='rgb',\n                                                  batch_size=256,\n                                                 class_mode='sparse')\nval_generator=val_datagen.flow_from_directory(val_directory,\n                                                 target_size=(224,224),\n                                                 batch_size=256,\n                                                 color_mode='rgb',\n                                                 class_mode='sparse')\ntest_generator=test_datagen.flow_from_directory(test_directory,\n                                                batch_size=256,\n                                                 target_size=(224,224),\n                                                 color_mode='rgb',\n                                                 class_mode='sparse')","af3bd83f":"num_classes=(len(train_generator.class_indices))","2309f1ea":"train_generator.class_indices","0329197f":"breeds=list(train_generator.class_indices.keys())","99d753db":"x=list(train_generator.classes)","88a8be4c":"label=[]\nfor i in range (0,225):\n    label.append(x.count(i))\n","278fee92":"fig_dims = (15, 4)\nfig, ax = plt.subplots(figsize=fig_dims)\nsns.barplot(x=breeds[:60],y=label[:60])\nplt.xticks(rotation=90)\nplt.show()","e3db3d6e":"fig_dims = (15, 4)\nfig, ax = plt.subplots(figsize=fig_dims)\nsns.barplot(x=breeds[61:120],y=label[61:120])\nplt.xticks(rotation=90)\nplt.show()","c5936049":"fig_dims = (17, 5)\nfig, ax = plt.subplots(figsize=fig_dims)\nsns.barplot(x=breeds[121:200],y=label[121:200])\nplt.xticks(rotation=90)\nplt.show()","4345c75e":"fig_dims = (10, 4)\nfig, ax = plt.subplots(figsize=fig_dims)\nsns.barplot(x=breeds[201:],y=label[201:])\nplt.xticks(rotation=90)\nplt.show()","e9c508ca":"image.load_img('..\/input\/edges-birds\/american cootedges.jpg')","f279b08d":"image.load_img('..\/input\/edges-birds\/antbirdedges.jpg',target_size=(360,480))","08ec3762":"image.load_img('..\/input\/edges-birds\/bald eagle edges.jpg',target_size=(360,480))","0a7f0850":"image.load_img('..\/input\/edges-birds\/kookaburra edges.jpg',target_size=(360,480))","a4f72d9b":"image.load_img('..\/input\/edges-birds\/razor billedges.jpg',target_size=(360,480))","1888c8c2":"from keras.applications import ResNet50V2","7b1d28f3":"convlayer=ResNet50V2(input_shape=(224,224,3),weights='imagenet',include_top=False)\nfor layer in convlayer.layers:\n    layer.trainable=False","b1bcd139":"plot_model(convlayer)","73819030":"model=Sequential()\nmodel.add(convlayer)\nmodel.add(Dropout(0.5))\nmodel.add(Flatten())\nmodel.add(BatchNormalization())\nmodel.add(Dense(2048,kernel_initializer='he_uniform'))\nmodel.add(BatchNormalization())\nmodel.add(Activation('relu'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(1024,kernel_initializer='he_uniform'))\nmodel.add(BatchNormalization())\nmodel.add(Activation('relu'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(num_classes,activation='softmax',kernel_initializer='glorot_uniform'))\nprint(model.summary())","05715905":"plot_model(model)","53157353":"optimizer=keras.optimizers.RMSprop(lr=0.0001)\nmodel.compile(optimizer=optimizer,loss='sparse_categorical_crossentropy',metrics=['accuracy'])","6ea50d30":"history=model.fit(train_generator,epochs=7,validation_data=val_generator)","b1f4b9a3":"plt.plot(history.history['accuracy'],c='b',label='train')\nplt.plot(history.history['val_accuracy'],c='r',label='validation')\nplt.legend(loc='lower right')\nplt.show()","c2956421":"plt.plot(history.history['loss'],c='b',label='train')\nplt.plot(history.history['val_loss'],c='r',label='validation')\nplt.legend(loc='upper right')\nplt.show()","3c5965c0":"model.evaluate(test_generator)","64f31fb6":"def predict(dir):\n    img=image.load_img(dir,target_size=(224,224))\n    img1=image.img_to_array(img)\n    img1=img1\/255\n    img1=np.expand_dims(img1,[0])\n    plt.imshow(img)\n    pred=int((model.predict_classes(img1)))\n    for key,values in train_generator.class_indices.items():\n        if pred==values:\n            print(\"The predicted image of the bird is: \"+str(key)+\" with a probability of \"+str(round(np.max(model.predict_proba(img1))*100,2))+\"%\")\n    \n    ","820d67fe":"predict('..\/input\/bird-custom-check-data\/AmericanKestrel.jpg')","4c308f7f":"predict('..\/input\/bird-custom-check-data\/american coot.jpg')","1d36d633":"predict('..\/input\/bird-custom-check-data\/anhinga.jpg')","a35beffe":"predict('..\/input\/bird-custom-check-data\/antbird.jpg')","d2ece18e":"predict('..\/input\/bird-custom-check-data\/bald eagle.jpg')","4e595fd9":"predict('..\/input\/bird-custom-check-data\/baltimore oriole.jpg')","a04480b7":"predict('..\/input\/bird-custom-check-data\/cassowary.jpg')","e392ed70":"predict('..\/input\/bird-custom-check-data\/golden winged warber.jpg')","020ed38f":"predict('..\/input\/bird-custom-check-data\/kookaburra.jpg')","1163f1a2":"predict('..\/input\/bird-custom-check-data\/osprey.jpg')","f912444d":"predict('..\/input\/bird-custom-check-data\/woodduck.jpg')","137d76f5":"predict('..\/input\/bird-custom-check-data\/incatern.jpg')","9110a420":"# Check your Accuracy on the Test set","1ad0c392":"# Using Resnet50v2 with imagenet weights","df98fdd6":"# Example 8","d560c816":"# Understanding the Data","03cacef9":"# Rescaling the Images","0dbbf8c7":"# Example 7","acdb37c9":"# Using the flow from directory function for reading the images","0781ed90":"# Example 10","abbc700d":"# Adding the layer to the Dense Layers","742f4a0d":"# Example 3","2111f4f1":"# Example 9","385a028c":"# Import Necessary Libraries and modules","90c5a0d7":"# Example2","7633e805":"# Example 12","35ec01df":"# Example 4","78c36af2":"# Use a small learning rate for better accuracy","836148f2":"# The Dictionary","f41bf3f8":"# Example 6","b459be2f":"# Example 11","e4fa74af":"# Example 5","06e57b85":"# Plotting the Distribution Graphs","92a5f10c":"# Check for Your Own Image","f21136d6":"# Plotting Edges using ImageJ","391060d5":"# Example1","d2229360":"# Directories of the datasets\n"}}