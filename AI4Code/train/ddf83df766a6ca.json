{"cell_type":{"982707ab":"code","29a09fc8":"code","b1ba6ca9":"code","147e1869":"code","4cc18658":"code","8c47d7a4":"code","d87e9ac6":"code","c168f26c":"code","94d2e6a3":"code","d1bfcac1":"code","c3b70a73":"code","5fdf870e":"code","15300570":"code","8e091fb0":"code","aedfd458":"code","b9cffbc1":"code","be58df82":"code","e81d78d5":"code","c39cce32":"code","8dfa2533":"code","272bc4fa":"code","42ed80e8":"code","b3052d1e":"code","7ca100e0":"code","9dc6976c":"code","566fee8e":"code","2ef69c54":"code","6827ee6e":"code","44553e8f":"code","d71d0fb5":"code","aee5cd3f":"code","21327bd1":"code","8c9b6938":"code","e2a2cdb2":"code","f7fba493":"code","8949f1c1":"code","694800df":"code","7c9c7954":"code","6cafad15":"code","f690ac08":"code","3afc1d49":"code","0695a664":"code","61efe175":"code","a69c6344":"code","da49b484":"code","2615dd7b":"code","4b82b252":"code","1a50791c":"code","cfe04264":"code","7f0c41e6":"code","93533ee1":"code","980ca10e":"code","3239f3b8":"code","72158358":"markdown","881789a4":"markdown","e0306a09":"markdown","b3b6556a":"markdown","5611a444":"markdown","6a1b44a4":"markdown","43a39201":"markdown","c095778b":"markdown","4a440aab":"markdown","086cdd7a":"markdown","4f04c198":"markdown"},"source":{"982707ab":"import numpy as np\nimport pandas as pd","29a09fc8":"import matplotlib.pyplot as plt\nimport seaborn as sns","b1ba6ca9":"df = pd.read_csv('..\/input\/phenotype-genotype-integrator\/PheGenI.csv')","147e1869":"df.sample(5)","4cc18658":"df.info()","8c47d7a4":"df['P-Value']","d87e9ac6":"pv = df['P-Value'][df['P-Value'].apply(lambda x: isinstance(x, str))]","c168f26c":"pv = pv.str.split('-')","94d2e6a3":"pv = pd.to_numeric(pv.apply(lambda x: x[0][:-1])) * 10 ** (-pd.to_numeric(pv.apply(lambda x: x[1]), downcast='float'))","d1bfcac1":"pv","c3b70a73":"df['P-Value'][pv.index] = pv.values","5fdf870e":"df['P-Value']","15300570":"pd.to_numeric(df['P-Value'])","8e091fb0":"df['P-Value'][df['P-Value'].apply(lambda x: isinstance(x, str))]","aedfd458":"df['P-Value'].sort_values()","b9cffbc1":"df['P-Value'].sort_values().reset_index()['P-Value'][:].plot(figsize=(15,7))","be58df82":"df['P-Value'].sort_values().reset_index()['P-Value'][:134000].plot(figsize=(15,7))","e81d78d5":"df['Trait'].unique().size","c39cce32":"df.groupby('Context').count().sort_values('Gene', ascending=False)","8dfa2533":"plt.figure(figsize=(15,5))\nsns.countplot(x='Context', data=df, order=df['Context'].value_counts().index)","272bc4fa":"df[(df['Gene'] == df['Gene 2'])].groupby('Context').count().sort_values('Gene', ascending=False)","42ed80e8":"(df['Gene'] == df['Gene 2']).sum()","b3052d1e":"plt.figure(figsize=(15,5))\nsns.countplot(x='Context', data=df[(df['Gene'] == df['Gene 2'])], order=df['Context'].value_counts().index)","7ca100e0":"df[(df['Gene'] != df['Gene 2'])].groupby('Context').count().sort_values('Gene', ascending=False)","9dc6976c":"df[(df['P-Value']>0) & (df['P-Value']<10**-300)].sort_values(by='P-Value')","566fee8e":"df_p = df[df['P-Value'] < 5 * 10 ** -8]","2ef69c54":"df_p.groupby('Trait').count().sort_values('P-Value', ascending=False).head(10)","6827ee6e":"df_p.groupby('Trait').count().sort_values('P-Value', ascending=False)['Gene'].plot(figsize=(18,7))","44553e8f":"df_p['Trait'].unique().size","d71d0fb5":"traits = df_p.groupby('Trait').count().sort_values('P-Value', ascending=False).index","aee5cd3f":"traits[:50]","21327bd1":"import difflib","8c9b6938":"matches = difflib.get_close_matches('atherosclerosis', traits, n=15, cutoff=.4)\nmatches","e2a2cdb2":"def genes_by_trait(trait):\n    temp = df_p[df_p['Trait']==trait]\n    return set(temp['Gene']).union(set(temp['Gene 2']))","f7fba493":"len(genes_by_trait('Body Mass Index'))","8949f1c1":"list_1 = ['Blood Pressure', 'Stroke', 'Diabetes Mellitus','Diabetes Mellitus, Type 2','Diabetes Mellitus, Type 1', 'Myocardial Infarction', 'Atherosclerosis', 'Plaque, Atherosclerotic']","694800df":"factors_paired = [(i,j) for i in list_1 for j in list_1]","7c9c7954":"common_genes = []\n\nfor i,j in factors_paired:\n    common_genes.append(len(genes_by_trait(i).intersection(genes_by_trait(j))))","6cafad15":"common_genes = np.array(common_genes).reshape(len(list_1),len(list_1))","f690ac08":"common_genes = pd.DataFrame(common_genes, index=list_1, columns=list_1)","3afc1d49":"common_genes","0695a664":"plt.figure(figsize=(15,5))\ncommon_genes.style.background_gradient(cmap='YlOrRd', axis=0)","61efe175":"common_genes = genes_by_trait('Stroke').intersection(genes_by_trait('Diabetes Mellitus')).intersection(genes_by_trait('Blood Pressure'))\nprint(len(common_genes))\ncommon_genes","a69c6344":"matches = difflib.get_close_matches('inflammatory bowel', traits, n=15, cutoff=.4)\nmatches","da49b484":"list_2 = ['Multiple Sclerosis', 'Psoriasis', 'Lupus Erythematosus, Systemic', 'Crohn Disease', 'Inflammatory Bowel Diseases', 'Diabetes Mellitus, Type 1']","2615dd7b":"factors_paired = [(i,j) for i in list_2 for j in list_2]","4b82b252":"common_genes = []\n\nfor i,j in factors_paired:\n    common_genes.append(len(genes_by_trait(i).intersection(genes_by_trait(j))))","1a50791c":"common_genes = np.array(common_genes).reshape(len(list_2),len(list_2))","cfe04264":"common_genes = pd.DataFrame(common_genes, index=list_2, columns=list_2)","7f0c41e6":"common_genes","93533ee1":"plt.figure(figsize=(15,5))\ncommon_genes.style.background_gradient(cmap='YlOrRd', axis=0)","980ca10e":"import requests, sys\nimport pprint","3239f3b8":"\nserver = \"https:\/\/rest.ensembl.org\"\next = \"\/phenotype\/gene\/homo_sapiens\/GCKR?include_associated=0\"\n     \nr = requests.get(server+ext, headers={ \"Content-Type\" : \"application\/json\"})\n     \nif not r.ok:\n    r.raise_for_status()\n    sys.exit()\n     \ndecoded = r.json()\npprint.pprint(decoded)","72158358":"Below is the diagram describing various SNP types.","881789a4":"# Converting P-Value column","e0306a09":"<img src=\"SNP types.jpg\"\/>","b3b6556a":"Gene information from https:\/\/www.ensembl.org\/index.html","5611a444":"Function to search traits","6a1b44a4":"# Genes by Trait","43a39201":"If Gene and Gene 2 names are same then SNP is not between two genes.","c095778b":"P-Values have both float and object types","4a440aab":"1. The \u201cNear Gene\u201d region includes the mRNA region of the gene as well as arbitrary regions of 2K nucleotides upstream and 0.5K nucleotides down stream to allow for potential regulatory regions. (https:\/\/www.ncbi.nlm.nih.gov\/books\/NBK44455\/)\n2. UTR-5 is the region that is directly upstream from the initiation codon which is transcribed to mRNA but not translated to Protein. UTR-3 is similar at downstream.\n3. A SNP will be classified as \u201csplice-site\u201d if the SNP\u2019s position is one or two bases before the start of an exon or If the SNP is located one or two bases following the end of an exon.\n","086cdd7a":"P value less than 5x10^-8 is commonly accepted as threshold. (https:\/\/en.wikipedia.org\/wiki\/Genome-wide_significance)","4f04c198":"# Analysis"}}