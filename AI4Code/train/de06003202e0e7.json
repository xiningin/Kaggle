{"cell_type":{"8b6e407a":"code","fdc43aeb":"code","2aee5b6d":"code","df053ce3":"code","7eab2c79":"code","4871c781":"code","39c2b94d":"code","7db93ee9":"code","544aafbe":"code","9ed3aae5":"code","8e70bc2a":"code","97d200fc":"code","4f67d8d0":"code","d08438fb":"code","662c97b8":"code","40023680":"code","f6ae272a":"code","4e183488":"code","038477a1":"code","e0a8daed":"markdown"},"source":{"8b6e407a":"import numpy as np\nimport pandas as pd\nimport zipfile\nimport scikitplot\n\nfrom tensorflow import keras\nfrom sklearn.metrics import classification_report","fdc43aeb":"test = pd.read_csv('..\/input\/challenges-in-representation-learning-facial-expression-recognition-challenge\/test.csv')\nprint(test.shape)","2aee5b6d":"test.head()","df053ce3":"test['pixels'] = [np.fromstring(x, dtype=int, sep=' ').reshape(-1,48,48,1) for x in test['pixels']]","7eab2c79":"pixels = np.concatenate(test['pixels'])\n\nprint(pixels.shape)","4871c781":"pixels = pixels \/ 255","39c2b94d":"from tensorflow.keras.models import load_model\n\nmodel_1 = load_model('..\/input\/model-num-1\/fer_v05_BZ.h5')\nmodel_2 = load_model('..\/input\/model-num-2\/fer_model_v03.h5')\nmodel_3 = load_model('..\/input\/model-num-3\/fer_model_v01.h5')\n\n#model.summary()","7db93ee9":"test_probs_1 = model_1.predict(pixels)\nprint(test_probs_1.shape)\n\ntest_probs_2 = model_2.predict(pixels)\nprint(test_probs_2.shape)\n\ntest_probs_3 = model_3.predict(pixels)\nprint(test_probs_3.shape)","544aafbe":"print(test_probs_1[:10,].round(2))\nprint(test_probs_2[:10,].round(2))\nprint(test_probs_3[:10,].round(2))","9ed3aae5":"test_pred_1 = np.argmax(test_probs_1, axis=1)\nprint(test_pred_1[:10])\n\ntest_pred_2 = np.argmax(test_probs_2, axis=1)\nprint(test_pred_2[:10])\n\ntest_pred_3 = np.argmax(test_probs_3, axis=1)\nprint(test_pred_3[:10])","8e70bc2a":"test_pred = (test_pred_1 + test_pred_1 + test_pred_1)\/3","97d200fc":"test_labels = pd.read_csv('..\/input\/challenges-in-representation-learning-facial-expression-recognition-challenge\/icml_face_data.csv')\ntest_labels.columns = ['emotion', 'Usage', 'pixels']\nprint(test_labels.shape)","4f67d8d0":"test_labels = test_labels.loc[test_labels['Usage'].isin(['PublicTest', 'PrivateTest'])]","d08438fb":"test_labels.drop(columns='Usage', inplace=True)\ntest_labels.head()","662c97b8":"test_labels.shape","40023680":"test_labels['predictions'] = test_pred\ntest_labels.head()","f6ae272a":"my_classification_report = classification_report(test_labels['emotion'], test_labels['predictions'])\nprint(my_classification_report)","4e183488":"print('Total Wrong Predictions:', np.sum(test_labels['emotion'] != test_labels['predictions']))","038477a1":"scikitplot.metrics.plot_confusion_matrix(test_labels['emotion'], test_labels['predictions'], figsize=(7,7))    ","e0a8daed":"# Week 6\n### Alejandro Alemany, Sara Manrriquez, and Benjamin Zaretzky"}}