{"cell_type":{"2d06f7a5":"code","048bcf6e":"code","fd26d86c":"code","2e516586":"code","74ac1c86":"code","4481df6a":"code","d67a984b":"code","f2b44014":"code","c36b6e2c":"code","221f3baa":"code","f9f86d4d":"code","099bc96b":"code","83d08a48":"code","f98fca6c":"code","46f4680d":"code","8896b3bf":"code","ea535eff":"code","ae6e573d":"code","b77f035b":"code","aeb6816e":"code","406dc5bd":"code","ffa1458b":"code","f35df6a3":"code","6293f238":"code","daa2283e":"code","1c60ae2d":"code","931ec7f0":"code","2ebcd1d9":"code","10047576":"code","ac339066":"code","cb1e6883":"code","82553b9e":"code","5f51ef90":"code","5ea77cf8":"code","e7bc1f0a":"code","b6573e48":"code","d8e4ed60":"code","6402c27c":"code","d4a5f32b":"code","cc319398":"code","14dd590d":"code","2bc4dde0":"code","6130f8e9":"code","429f023c":"code","94767b52":"code","b7d44c1d":"code","2585b27b":"code","4e6f501c":"code","fbdcbfe0":"markdown","1db98127":"markdown","527c36bc":"markdown","fa61f12d":"markdown","8b7a183e":"markdown","68374e6b":"markdown","57da6a76":"markdown","97e7df39":"markdown","57c5c5a0":"markdown","c0a145d3":"markdown","d8b993e9":"markdown","0746eeb1":"markdown","e2e09b73":"markdown"},"source":{"2d06f7a5":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","048bcf6e":"df=pd.read_csv('..\/input\/titanic\/train.csv')","fd26d86c":"df.head()","2e516586":"df.shape","74ac1c86":"df.info()","4481df6a":"df.describe()","d67a984b":"df.corr()['Survived'].sort_values()","f2b44014":"sns.pairplot(df,hue='Survived')","c36b6e2c":"sns.scatterplot(data=df, x='Survived', y='Fare',color='y')\nplt.axhline(y=300,color='r')","221f3baa":"index_drop=df[(df['Fare']>300)].index\ndf=df.drop(index_drop, axis=0)","f9f86d4d":"sns.scatterplot(data=df, x='Survived', y='Parch',color='g')","099bc96b":"sns.scatterplot(data=df, x='Survived', y='SibSp',color='b')\nplt.axhline(y=5,color='r')","83d08a48":"index_drop=df[(df['SibSp']>5)].index\ndf=df.drop(index_drop, axis=0)","f98fca6c":"sns.scatterplot(data=df, x='Survived', y='Age',color='#03fce3')\nplt.axhline(y=75,color='r')","46f4680d":"index_drop=df[(df['Age']>75)].index\ndf=df.drop(index_drop, axis=0)","8896b3bf":"sns.scatterplot(data=df, x='Survived', y='Pclass',color='#d119cb')","ea535eff":"sns.scatterplot(data=df, x='Survived', y='PassengerId',color='#19d166')","ae6e573d":"def missing_percent(df):\n    nan_percent=(df.isnull().sum()\/len(df))*100\n    nan_percent=nan_percent[nan_percent>0].sort_values()\n    return nan_percent\nnan_percent=missing_percent(df)\nsns.barplot(x=nan_percent.index,y=nan_percent)","b77f035b":"df[df['Embarked'].isnull()]","aeb6816e":"df= df.dropna(axis=0, subset=['Embarked'])","406dc5bd":"df=df.drop('Cabin',axis=1 )","ffa1458b":"df.corr()['Age'].sort_values()","f35df6a3":"df.groupby('Pclass')['Age'].mean()","6293f238":"df['Age']=df.groupby('Pclass')['Age'].transform(lambda val: val.fillna(val.mean()))","daa2283e":"df.columns","1c60ae2d":"df_num= df[['Survived','Pclass','Age','SibSp','Parch','Fare']]\ndf_obj= df[['Sex','Embarked']]","931ec7f0":"df_obj= pd.get_dummies(df_obj, drop_first=True)","2ebcd1d9":"Final_df= pd.concat([df_num, df_obj], axis=1)\nFinal_df.shape","10047576":"Final_df.isnull()","ac339066":"df=Final_df","cb1e6883":"df.head()","82553b9e":"X= df.drop('Survived', axis=1)\ny= df['Survived']","5f51ef90":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.1, random_state=101)","5ea77cf8":"from sklearn.tree import DecisionTreeClassifier\nmodel = DecisionTreeClassifier()\nmodel.fit(X_train,y_train)","e7bc1f0a":"y_pred = model.predict(X_test)","b6573e48":"from sklearn.metrics import confusion_matrix,classification_report\nconfusion_matrix(y_test,y_pred)","d8e4ed60":"print(classification_report(y_test,y_pred))","6402c27c":"model.feature_importances_","d4a5f32b":"pd.DataFrame(index=X.columns,data=model.feature_importances_,columns=['Feature Importance'])","cc319398":"from sklearn.tree import plot_tree\nplt.figure(figsize=(15,12))\nplot_tree(model);","14dd590d":"plt.figure(figsize=(15,12),dpi=150)\nplot_tree(model,filled=True,feature_names=X.columns);","2bc4dde0":"def report_model(model):\n    model_preds = model.predict(X_test)\n    print(classification_report(y_test,model_preds))\n    print('\\n')\n    plt.figure(figsize=(15,12),dpi=150)\n    plot_tree(model,filled=True,feature_names=X.columns);","6130f8e9":"pruned_tree = DecisionTreeClassifier(max_depth=2)\npruned_tree.fit(X_train,y_train)","429f023c":"report_model(pruned_tree)","94767b52":"pruned_tree = DecisionTreeClassifier(max_leaf_nodes=3)\npruned_tree.fit(X_train,y_train)","b7d44c1d":"report_model(pruned_tree)","2585b27b":"entropy_tree = DecisionTreeClassifier(criterion='entropy')\nentropy_tree.fit(X_train,y_train)","4e6f501c":"report_model(entropy_tree)","fbdcbfe0":"**10-3:Criterion**","1db98127":"# **Step8:Train\/Predicting\/Evaluating**","527c36bc":"# **Step5: Data Preperation**","fa61f12d":"# **Step7:Split to Train & test**","8b7a183e":"**10-1: Max Depth**","68374e6b":"# **Step6:Features&Label**","57da6a76":"**10-2:Max Leaf Nodes**","97e7df39":"# **Step10: Hyperparameters**","57c5c5a0":"# Step4: EDA","c0a145d3":"# Step2:Read  Dataset","d8b993e9":"# Step1:Import Libraries ","0746eeb1":"# Step3:Data Overview ","e2e09b73":"# **Step9: Visualize The Tree**"}}