{"cell_type":{"7987a664":"code","b4482179":"code","724e45f1":"code","765c00c8":"code","d80a0302":"code","8f1115d2":"code","ad7d41ce":"code","1fc65179":"code","6fdc37b1":"code","f25af712":"code","fcd10eab":"code","f8d07642":"code","0a03ebeb":"code","f0f211e5":"code","a030665b":"code","1af4cbb0":"code","fba2439d":"code","ce0afde0":"code","0d4f04ea":"code","1b11b69a":"code","0aa918ee":"code","a378237c":"code","56816a9b":"code","77bcf44d":"code","cf903b77":"code","bacb6ff5":"code","b4622ed6":"code","d97f5235":"code","753a5aff":"code","ac307ef2":"code","883d5623":"code","d44c460f":"code","12f4e720":"code","ff9b1d31":"markdown","b8e79579":"markdown","c29aa120":"markdown","fa561a15":"markdown","674e69bd":"markdown","9ae5b05e":"markdown","96e2d0ee":"markdown","ae74ca22":"markdown","b689056d":"markdown","b049125a":"markdown","e173c9e6":"markdown","9edb2d49":"markdown","3b5f86ef":"markdown","cf5dd0c3":"markdown","a5f01e2f":"markdown","1d686f88":"markdown","c0fba56b":"markdown","928fe8f2":"markdown","0dcfbe4a":"markdown","31f11e7f":"markdown","279cebb1":"markdown","eba97ccc":"markdown","46690e86":"markdown","471a5f87":"markdown","8c0283f6":"markdown","4d2b5052":"markdown","3f9f2c7e":"markdown","ced914b6":"markdown","903308ad":"markdown","7b3b8352":"markdown","cd300448":"markdown","3a23bcf2":"markdown","a8c7b56c":"markdown","a674979c":"markdown","65346bdf":"markdown","f4377a35":"markdown","5a05f139":"markdown","2216f6c5":"markdown","704971e7":"markdown","df6bfc9f":"markdown","dc04f3a1":"markdown","d62227a8":"markdown","3eb2c2fa":"markdown","aa24bf84":"markdown","d2aed6f5":"markdown","5b029410":"markdown","eca11b95":"markdown","f5c8fb49":"markdown"},"source":{"7987a664":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set()\nfrom plotly.offline import init_notebook_mode, iplot \nimport plotly.graph_objects as go\nimport plotly.offline as py\nimport plotly.express as px\nimport pycountry\npy.init_notebook_mode(connected=True)\nimport folium \nfrom folium import plugins\n%config InlineBackend.figure_format = 'retina' \nplt.rcParams['figure.figsize'] = 8, 5\npd.options.mode.chained_assignment = None \npd.set_option('display.max_columns',None)\nimport warnings\nwarnings.filterwarnings('ignore')","b4482179":"df = pd.read_csv('\/kaggle\/input\/indian-candidates-for-general-election-2019\/LS_2.0.csv')\ndf.head()","724e45f1":"print('Number of rows and columns :',df.shape) # Number of rows and columns","765c00c8":"df.columns = df.columns.str.replace('\\n',' ') # To rename columns","d80a0302":"df.describe()","8f1115d2":"df1 = df[df['PARTY']!= 'NOTA']\npercentage_missing_values = round(df1.isnull().sum()*100\/len(df1),2).reset_index()\npercentage_missing_values.columns = ['column_name','percentage_missing_values']\npercentage_missing_values = percentage_missing_values.sort_values('percentage_missing_values',ascending = False)\npercentage_missing_values","ad7d41ce":"constituencies_per_state = df.groupby('STATE')['CONSTITUENCY'].nunique().reset_index().sort_values('CONSTITUENCY',ascending = False)\nfig = px.bar(constituencies_per_state, x='STATE', y='CONSTITUENCY', color='CONSTITUENCY', height=600)\nfig.show()","1fc65179":"candidates_per_party = df.PARTY.value_counts().reset_index().rename(columns = {'index':'Party','PARTY':'Total Candidates'}).head(50)\ncandidates_per_party = candidates_per_party[candidates_per_party['Party'] != 'NOTA']\nfig = px.bar(candidates_per_party, x='Party', y='Total Candidates', color='Total Candidates', height=500)\nfig.show()","6fdc37b1":"vote_share_top5 = df.groupby('PARTY')['TOTAL VOTES'].sum().nlargest(5).index.tolist()\ndef vote_share(row):\n    if row['PARTY'] not in vote_share_top5:\n        return 'Other'\n    else:\n        return row['PARTY']\ndf['Party New'] = df.apply(vote_share,axis =1)\ncounts = df.groupby('Party New')['TOTAL VOTES'].sum(sort=True)\nlabels = counts.index\nvalues = counts.values\npie = go.Pie(labels=labels, values=values, marker=dict(line=dict(color='#000000', width=1)))\nlayout = go.Layout(title='Partywise Vote Share')\nfig = go.Figure(data=[pie], layout=layout)\npy.iplot(fig)","f25af712":"winning_candidates_per_party = df.groupby(['PARTY','SYMBOL'])['WINNER'].sum().reset_index().sort_values('WINNER',ascending = False)\nwinning_candidates_per_party = winning_candidates_per_party[winning_candidates_per_party['WINNER'] > 0]\nfig = px.bar(winning_candidates_per_party, x='PARTY', y='WINNER',hover_data =['SYMBOL'], color='WINNER', height=500)\nfig.show()","fcd10eab":"fig = px.histogram(df, x=\"AGE\")\nfig.show()","f8d07642":"fig = px.histogram(df.dropna(), x=\"AGE\", y=\"WINNER\", color=\"GENDER\", marginal=\"violin\",hover_data=df.columns)\nfig.show()","0a03ebeb":"df_winners = df[df['WINNER']==1]\ndf_winners = df_winners.sort_values('AGE').head(10)\nfig = px.bar(df_winners, x='NAME', y='AGE', color='AGE', height=500, hover_data=['PARTY','SYMBOL','CONSTITUENCY','STATE'])\nfig.show()","f0f211e5":"df_winners = df[df['WINNER']==1]\ndf_winners = df_winners.sort_values('AGE',ascending=False).head(10)\nfig = px.bar(df_winners, x='NAME', y='AGE', color='AGE', height=500, hover_data=['PARTY','SYMBOL','CONSTITUENCY','STATE'])\nfig.show()","a030665b":"df['CRIMINAL CASES'] = df['CRIMINAL CASES'].str.replace('Not Available','0')\ndf['CRIMINAL CASES'] = df['CRIMINAL CASES'].fillna(0)\ndf['CRIMINAL CASES'] = df['CRIMINAL CASES'].astype(int)\ncriminal_cases = df[(df['CRIMINAL CASES'] != 'Not Available') & (df['CRIMINAL CASES'].notnull())]\ncriminal_cases = criminal_cases.groupby('PARTY')['CRIMINAL CASES'].sum().reset_index().sort_values('CRIMINAL CASES',ascending=False).head(30)\nfig = px.bar(criminal_cases, x='PARTY', y='CRIMINAL CASES', color='CRIMINAL CASES', height=500)\nfig.show()","1af4cbb0":"df['EDUCATION'] = df['EDUCATION'].str.replace('Post Graduate\\n','Post Graduate')\ndf['EDUCATION'] = df['EDUCATION'].fillna('Others') \neducation = df[df['EDUCATION'] != 'Not Available']\neducation = education['EDUCATION'].value_counts().reset_index()\neducation.columns = ['EDUCATION','COUNT']\nfig = px.bar(education, x='EDUCATION', y='COUNT', color='COUNT', height=500)\nfig.show()","fba2439d":"won_educated_candidates = df[df['WINNER']==1]\nfig = px.bar(won_educated_candidates, x='EDUCATION', y='WINNER', color='EDUCATION', height=500).update_xaxes(categoryorder = \"total descending\")\nfig.show()","ce0afde0":"fig = px.histogram(df.dropna(), x=\"AGE\", y=\"PARTY\", color=\"WINNER\", marginal=\"violin\",hover_data=df.columns)\nfig.show()","0d4f04ea":"df_criminal_cases = df.loc[(df['CRIMINAL CASES'].notnull()) & (df['CRIMINAL CASES'] != 'Not Available')]\ndef criminal_cases(row):\n    if row['CRIMINAL CASES'] == 0:\n        return 'No'\n    else:\n        return 'Yes'\ndf_criminal_cases['HAS CRIMINAL CASE'] = df_criminal_cases.apply(criminal_cases,axis = 1)\ndf_criminal_cases_count = df_criminal_cases.groupby(['HAS CRIMINAL CASE','WINNER']).size().reset_index()\ndf_criminal_cases_count.columns = ['HAS CRIMINAL CASE','WINNER','COUNT']\n# pivot_df_criminal_cases_count = df_criminal_cases_count.pivot(index='HAS CRIMINAL CASE', columns='WINNER', values='COUNT')\n# pivot_df_criminal_cases_count.plot.bar(stacked=True,figsize=(10,7))\n# plt.xticks(rotation=0)\n# plt.show()\nfig = px.bar(df_criminal_cases_count, x=\"HAS CRIMINAL CASE\", y=\"COUNT\", color='WINNER')\nfig.show()","1b11b69a":"df_votes_perct_constituency = df.groupby(['STATE','CONSTITUENCY','TOTAL ELECTORS'])['TOTAL VOTES'].sum().reset_index()\ndf_votes_perct_constituency['% VOTED IN CONSTITUENCY'] = round(df_votes_perct_constituency['TOTAL VOTES']*100\/df_votes_perct_constituency['TOTAL ELECTORS'],2)\ndf_voters_state = df[['STATE','CONSTITUENCY','TOTAL ELECTORS']].drop_duplicates()\ndf_voters_state = df_voters_state.groupby('STATE')['TOTAL ELECTORS'].sum().reset_index()\ndf_votes_state = df.groupby('STATE')['TOTAL VOTES'].sum().reset_index().sort_values('TOTAL VOTES',ascending = False)\ndf_votes_perct_state = pd.merge(df_votes_state,df_voters_state, on ='STATE',how = 'left')\ndf_votes_perct_state['% VOTED IN STATE'] = round(df_votes_perct_state['TOTAL VOTES']*100\/df_votes_perct_state['TOTAL ELECTORS'],2)\ndf_votes_perct_state = df_votes_perct_state.sort_values('% VOTED IN STATE',ascending = False)\nfig = px.bar(df_votes_perct_state, x='STATE', y='% VOTED IN STATE', color='% VOTED IN STATE', height=500)\nfig.show()","0aa918ee":"fig = px.bar(df_votes_state, x='STATE', y='TOTAL VOTES', color='TOTAL VOTES', height=500)\nfig.show()","a378237c":"df_assets = df.copy()\ndf_assets[['ASSETS2','ASSETS_VALUE']] = df_assets['ASSETS'].str.split('~',expand=True)\ndf_assets.drop(['ASSETS2'],axis =1,inplace=True)\ndf_assets = df_assets[df_assets['ASSETS_VALUE'].notnull()]\ndef asset_range(row):\n    if row['ASSETS_VALUE'].endswith('Crore+'):\n        return 'Crore+'\n    elif row['ASSETS_VALUE'].endswith('Lacs+'):\n        return 'Lakh+'\n    elif row['ASSETS_VALUE'].endswith('Thou+'):\n        return 'Thousand+'\n    else:\n        return 'NAN'\n\ndf_assets['ASSETS_RANGE'] = df_assets.apply(asset_range,axis =1)\ndf_assets['COUNT'] = 1\ndf_assets = df_assets[df_assets['ASSETS_RANGE'] != 'NAN']\ncounts = df_assets.groupby('ASSETS_RANGE')['COUNT'].sum(sort=True)\nlabels = counts.index\nvalues = counts.values\npie = go.Pie(labels=labels, values=values, marker=dict(line=dict(color='#000000', width=1)))\nlayout = go.Layout(title='Assests of Candidates')\nfig = go.Figure(data=[pie], layout=layout)\npy.iplot(fig)","56816a9b":"df_category = df['CATEGORY'].value_counts().reset_index()\ndf_category.columns = ['CATEGORY','COUNT']\nfig = px.bar(df_category, x='CATEGORY', y='COUNT', color='CATEGORY', height=500)\nfig.show()","77bcf44d":"df_gender = df['GENDER'].value_counts().reset_index()\ndf_gender.columns = ['GENDER','COUNT']\npie = go.Pie(labels=df_gender['GENDER'], values=df_gender['COUNT'], marker=dict(line=dict(color='black', width=1)))\nlayout = go.Layout(title='Male vs Female Ratio - All Candidates')\nfig = go.Figure(data=[pie], layout=layout)\npy.iplot(fig)","cf903b77":"df_gender_won =df[df['WINNER'] == 1]\ndf_gender_won = df_gender_won['GENDER'].value_counts().reset_index()\ndf_gender_won.columns = ['GENDER','COUNT']\npie = go.Pie(labels=df_gender_won['GENDER'], values=df_gender_won['COUNT'], marker=dict(line=dict(color='black', width=1)))\nlayout = go.Layout(title='Male vs Female Ratio - Winners')\nfig = go.Figure(data=[pie], layout=layout)\npy.iplot(fig)","bacb6ff5":"df = df[df['PARTY']!= 'NOTA']\ndf[['ASSETS2','ASSETS_VALUE']] = df['ASSETS'].str.split('~',expand=True)\ndf.drop(['ASSETS2'],axis =1,inplace=True)\ndf = df[df['ASSETS_VALUE'].notnull()]\ndf['ASSETS_RANGE'] = df.apply(asset_range,axis =1)\n\ndf[['LIABILITY2','LIABILITY_VALUE']] = df['LIABILITIES'].str.split('~',expand=True)\ndf.drop(['LIABILITY2'],axis =1,inplace=True)\ndf = df[df['LIABILITY_VALUE'].notnull()]\n\ndef liability_range(row):\n    if row['LIABILITY_VALUE'].endswith('Crore+'):\n        return 'Crore+'\n    elif row['LIABILITY_VALUE'].endswith('Lacs+'):\n        return 'Lakh+'\n    elif row['LIABILITY_VALUE'].endswith('Thou+'):\n        return 'Thousand+'\n    else:\n        return 'NAN'\ndf['LIABILITY_RANGE'] = df.apply(liability_range,axis =1)","b4622ed6":"df1 = df[['STATE','CONSTITUENCY','WINNER','Party New','SYMBOL','GENDER','CRIMINAL CASES','AGE','CATEGORY','EDUCATION','TOTAL VOTES','TOTAL ELECTORS','ASSETS_RANGE','LIABILITY_RANGE']]\ncat_cols = ['STATE','CONSTITUENCY','Party New','SYMBOL','GENDER','CATEGORY','EDUCATION','ASSETS_RANGE','LIABILITY_RANGE']\nnum_cols = ['CRIMINAL CASES','AGE','TOTAL VOTES','TOTAL ELECTORS']","d97f5235":"df_winner = df1['WINNER'].value_counts().reset_index()\ndf_winner.columns = ['RESULT','COUNT']\npie = go.Pie(labels=df_winner['RESULT'], values=df_winner['COUNT'], marker=dict(line=dict(color='black', width=1)))\nlayout = go.Layout(title='Total Candidates vs Winners')\nfig = go.Figure(data=[pie], layout=layout)\npy.iplot(fig)","753a5aff":"dataset = pd.get_dummies(df1, columns = cat_cols)\nfrom sklearn.preprocessing import StandardScaler\nstandardScaler = StandardScaler()\ncolumns_to_scale = num_cols\ndataset[columns_to_scale] = standardScaler.fit_transform(dataset[columns_to_scale])\ndataset.head()","ac307ef2":"from sklearn.utils import resample\ndf_majority = dataset[dataset.WINNER == 0]\ndf_minority = dataset[dataset.WINNER == 1]\ndf_minority_upsampled = resample(df_minority, replace = True,n_samples = 1452, random_state = 0) \ndf_upsampled = pd.concat([df_majority, df_minority_upsampled])\ndf_upsampled.WINNER.value_counts()\n","883d5623":"y = df_upsampled['WINNER']\nX = df_upsampled.drop(['WINNER'], axis = 1)","d44c460f":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import cross_val_score\nrfc_scores = []\nfor k in range(1,21):\n    randomforest_classifier= RandomForestClassifier(n_estimators=k,random_state=0)\n    score=cross_val_score(randomforest_classifier,X,y,cv=10)\n    rfc_scores.append(score.mean())\nplt.figure(figsize =(20,7))\nplt.plot([k for k in range(1, 21)], rfc_scores, color = 'red')\nfor i in range(1,21):\n    plt.text(i, rfc_scores[i-1], (i, round(rfc_scores[i-1],3)))\nplt.xticks([i for i in range(1, 21)])\nplt.xlabel('Number of Estimators (K)')\nplt.ylabel('Scores')\nplt.title('Random Forest Classifier scores for different K values')","12f4e720":"randomforest_classifier= RandomForestClassifier(n_estimators=14,random_state=0)\nscore=cross_val_score(randomforest_classifier,X,y,cv=10)\nprint('% Accuracy :', round(score.mean()*100,4))","ff9b1d31":"Lakshadweep witnessed highest percentage of voting whereas voting was least in Jammu & Kashmir.","b8e79579":"### Random Forest Classifier","c29aa120":"By looking at the above graph, we can clearly see that this dataset is imbalanced. So, in order to balance the dataset, we need to either upsample or down sample the dataset. Down sampling of majority class might result in loss of some important information. So, we will be up-sampling the minority class using **resample**. Before doing that we need to scale the categorical columns using **get_dummies** and the numerical columns using **StandardScaler** library.","fa561a15":"### Percentage of missing values","674e69bd":"### Educational Qualification of Candidates","9ae5b05e":"In order to predict the target variable \"WINNER\", first we need to select the columns necessary for prediction and exclude all the redundant columns. Also we nedd to categorize the columns into categorical & numerical columns.","96e2d0ee":"### Gender of Winning Candidates","ae74ca22":"### Criminal Cases against Candidates","b689056d":"Utatr Pradesh has highest number of people who are eligible for voting.","b049125a":"Almost 70% of the candidates who contested election in 2019 had assets worth more than a crore!!!","e173c9e6":"### Seats Won by Party","9edb2d49":"Now as we can see the dataset is balanced.So we can divide the dataset now into dependant & Independant variables.","3b5f86ef":"As we can see from the graph accuracy is maximum at k =14. Hence we will be selecting **n_estimators**=14.","cf5dd0c3":"# Winner Prediction Using Random Forest","a5f01e2f":"![](https:\/\/pragativadi.com\/wp-content\/uploads\/2019\/03\/Cabinet-approves-issue-of-notifications-for-General-Elections.jpg)","1d686f88":"There is very clear gap between number of male & female representatives in the assembly.","c0fba56b":"### Up-Sampling of Minority Class","928fe8f2":"## Please do upvote if you like my work. Happy Learning!","0dcfbe4a":"### Reservations","31f11e7f":"### Gender of Candidates","279cebb1":"### Age of Candidates","eba97ccc":"We will be using **Random Forest Classifier** to predict the winners of the election. In order to know the optimum number of trees required to predict the result with highest accuracy, we will be plotting the accuracy score for various values of k and will be selecting k value that gives highest accuracy.","46690e86":"BJP got the highest vote share of 38.5% whereas INC was the distant second with 20.1% votes.","471a5f87":"If we exclude NOTA(None Of The Above) rows, there are no missing values.","8c0283f6":"Everything about Indian general elections is colossal - the Economist magazine once compared it to a \"lumbering elephant embarking on an epic trek\".The number of voters is bigger than the population of Europe and Australia combined.India's Centre for Media Studies estimated parties and candidates spent some $5bn (\u00a33.8bn) for the 2014 elections. A total of 10 lakh polling stations were  set up in 2019 as compared to around nine lakh in 2014. Looking at all these stats it is only going to get bigger in future. Now let's just jump into the analysis of 2019 Loksabha election data.","4d2b5052":"### Partywise Vote Share","3f9f2c7e":"### Total Voters by State","ced914b6":"### Educational Qualification of Winning Candidates","903308ad":"### Assests of Candidates","7b3b8352":"Uttar Pradesh has the highest of 80 constituencies.","cd300448":"### Age of Candidates by Gender","3a23bcf2":"### Classification of Winning & Losing Candidates based on Age","a8c7b56c":"BJP achieved a landslide victory winning 300 seats whereas INC won only 52 seats.","a674979c":"Average age females who contested election was slightly less than all the males who contested election.","65346bdf":"### Data Scaling","f4377a35":"In India, reservations exist in almost every field. Entire political game runs on the basis of religion,caste and all other forms of reservations.","5a05f139":"BJP had fielded the highest of 420 candidates whereas INC had 413 candidates.","2216f6c5":"### Youngest MP's in India","704971e7":"### Candidates by Party","df6bfc9f":"BJP Candidates had highest number of criminal cases against them. INC cnadidates were not too far behind.","dc04f3a1":"### Percentage of Voting by State","d62227a8":"We have achieved an accuracy of about **96.3%** using Random Forest Classifier. Using Hyper Parameter Tuning we can try to achieve better accuracy.","3eb2c2fa":"#### Observations:\n* There were 2018 candidates who contested 2019 LokSabha Election.\n* Minimum age of the candidates was 25 whereas maximum age was 86.\n* Average age of all the candidates who contested election was 52.\n* 19367 postal votes were casted in the election.","aa24bf84":"Age of all the candidates who contested election follows normal distribution with mean 52.","d2aed6f5":"### Candidates with Criminal Cases","5b029410":"### Oldest MP's in India","eca11b95":"### Total Constituencies per State","f5c8fb49":"It looks like having criminal cases has no effect on election result!!"}}