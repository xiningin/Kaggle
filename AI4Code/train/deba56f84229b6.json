{"cell_type":{"6cfdb93e":"code","f3d5d0c7":"code","71337bfd":"code","fb3ca8d2":"code","66a5f5a9":"code","8bb0cf1b":"code","af9df10c":"code","c5eb73a6":"code","d96604f3":"markdown","8a8589bf":"markdown","9262d2c8":"markdown","4edbd2fd":"markdown"},"source":{"6cfdb93e":"from operator import invert\nimport pandas as pd\n\ndata_long = pd.read_csv(\"..\/input\/tourists\/(1).csv\")","f3d5d0c7":"# \u5c07\u8cc7\u6599\u683c\u5f0f\u7d71\u4e00\ndata_long.loc[:, \"\u985e\u578b\"] = data_long[\"\u985e\u578b\"].str.replace(\" -\", \"-\")\ndata_long.loc[:, \"\u89c0\u5149\u904a\u61a9\u5340\"] = data_long[\"\u89c0\u5149\u904a\u61a9\u5340\"].str.replace(\" -\", \"-\")\n\n# \u9577\u683c\u5f0f\u8f49\u70ba\u5bec\u683c\u5f0f\nt = data_long.melt(id_vars=[\"\u5e74\u5225\", \"\u985e\u578b\", \"\u89c0\u5149\u904a\u61a9\u5340\", \"\u7d30\u5206\", \"\u7e23\u5e02\u5225\"], value_vars=[\"1\u6708\", \"2\u6708\", \"3\u6708\", \"4\u6708\", \"5\u6708\", \"6\u6708\", \"7\u6708\", \"8\u6708\", \"9\u6708\", \"10\u6708\", \"11\u6708\", \"12\u6708\", \"\u5408\u8a08\"])\ndata_wide = t.pivot_table(values=\"value\", index=[\"\u985e\u578b\", \"\u89c0\u5149\u904a\u61a9\u5340\", \"\u7d30\u5206\", \"\u7e23\u5e02\u5225\"], columns=[\"\u5e74\u5225\", \"variable\"], fill_value=0)\n\ndef keys(x):\n    try:\n        return int(x[0]) * 100 + int(x[1][:-1])\n    except ValueError:\n        return int(x[0]) * 100 + 13\n\n# \u91cd\u65b0\u6392\u5e8f\u6708\u4efd\ndata_wide = data_wide.reindex(sorted(data_wide.columns, key=keys), axis=1)\n\n# \u79fb\u9664\u904e\u591a\u7a7a\u7f3a\u503c\u7684\u8cc7\u6599\ndata_wide = data_wide.loc[(data_wide == 0).astype(int).sum(axis=1) < 12]\ndata_wide.columns.names = [\"\u5e74\u5225\", None]\n\ndata_wide","71337bfd":"# \u5bec\u683c\u5f0f\u8f49\u70ba\u9577\u683c\u5f0f\ndata_long = data_wide.stack(0)\ndata_long = data_long.reindex(sorted(data_long.columns, key=lambda x: int(x[:-1]) if x[:-1].isdigit() else 13), axis=1)\ndata_long = data_long.fillna(0).astype(int).reset_index()\n\ndata_long","fb3ca8d2":"# 2021\u5e7410\u6708 \u524d\u4e94\u5927\u71b1\u9580\u89c0\u5149\u666f\u9ede\n\ntop5 = data_long.loc[data_long[\"\u5e74\u5225\"] == 2021].loc[:, [\"\u7d30\u5206\", \"10\u6708\"]].sort_values(by=[\"10\u6708\"], ascending=False)\ntop5 = top5.head(5).set_index(\"\u7d30\u5206\").squeeze()\ntop5.index.names = [None]\n\ntop5","66a5f5a9":"# 2012\u5e74\u81f32021\u5e74\u6210\u9577\u6700\u591a\u7684\u89c0\u5149\u666f\u9ede (percentage)\n\ngrowth = data_wide[(2021, \"\u5408\u8a08\")] \/ data_wide[(2012, \"\u5408\u8a08\")] * 100 - 100\ngrowth = growth.sort_values(ascending=False).to_frame()\ngrowth = growth.reset_index().set_index(\"\u7d30\u5206\").loc[:, 0]\ngrowth_top5 = growth.head(5).squeeze()\ngrowth_top5.index.names = [None]\n\ngrowth_top5","8bb0cf1b":"# 2012\u5e74\u81f32021\u5e74\u4e0b\u964d\u6700\u591a\u7684\u89c0\u5149\u666f\u9ede (percentage)\n\ndecline_top5 = growth.tail(5).sort_values().squeeze()\ndecline_top5.index.names = [None]\n\ndecline_top5","af9df10c":"# 2021\u5e741\u6708\u523010\u6708\uff0c\u5404\u6708\u4efd\u7684\u7e3d\u89c0\u5149\u4eba\u6578\n\ntotal_tourists = []\nfor i in range(1, 11):\n    total_tourists.append(data_wide[(2021, str(i) + \"\u6708\")].sum())\n\ntotal_tourists","c5eb73a6":"# 2021\u5e74\u6700\u591a\u89c0\u5149\u4eba\u6578\u7684\u6708\u4efd\uff0c\u53ca\u6700\u5c11\u89c0\u5149\u4eba\u6578\u7684\u6708\u4efd\n\nmax_mo = total_tourists.index(max(total_tourists))\nmin_mo = total_tourists.index(min(total_tourists))\nprint(str(max_mo + 1) + \"\u6708\", total_tourists[max_mo], \"\u4eba\u6b21\")\nprint(str(min_mo + 1) + \"\u6708\", total_tourists[min_mo], \"\u4eba\u6b21\")","d96604f3":"# 3. \u7b54\u6848\n* 2021\u5e7410\u6708 \u524d\u4e94\u5927\u71b1\u9580\u89c0\u5149\u666f\u9ede\n    * \u9e97\u5bf6\u6a02\u5712\n    * \u6de1\u6c34\u91d1\u8272\u6c34\u5cb8\n    * \u7345\u982d\u5c71\u98a8\u666f\u5340\n    * \u77f3\u9580\u6c34\u5eab\u98a8\u666f\u5340\n    * \u65d7\u6d25\u98a8\u666f\u5340\n* 2012\u5e74\u81f32021\u5e74\u6210\u9577\u6700\u591a\u7684\u89c0\u5149\u666f\u9ede (percentage)\n    * \u65b0\u7af9\u6f01\u6e2f      649.902636\n    * \u9e97\u5bf6\u6a02\u5712      426.337980\n    * \u9727\u81fa\u904a\u61a9\u5340     388.519208\n    * \u8302\u6797\u904a\u61a9\u5340     293.183631\n    * \u95dc\u5b50\u5dba\u6eab\u6cc9\u5340    278.228643\n* 2012\u5e74\u81f32021\u5e74\u4e0b\u964d\u6700\u591a\u7684\u89c0\u5149\u666f\u9ede (percentage)\n    * \u967d\u660e\u6d77\u6d0b\u6587\u5316\u85dd\u8853\u9928     -99.244822\n    * \u570b\u6c11\u9769\u547d\u5fe0\u70c8\u7960       -99.163080\n    * \u4e2d\u81fa\u79aa\u5bfa          -98.661424\n    * \u6253\u72d7\u82f1\u570b\u9818\u4e8b\u9928\u6587\u5316\u5712\u5340   -96.745699\n    * \u8c93\u9f3b\u982d\u516c\u5712         -96.306848\n* 2021\u5e741\u6708\u523010\u6708\uff0c\u5404\u6708\u4efd\u7684\u7e3d\u89c0\u5149\u4eba\u6578\n    * ans: [13063233, 21222617, 14667919, 16145766, 6915726, 1260957, 2493803, 5698194, 7840319, 10288448]\n* 2021\u5e74\u6700\u591a\u89c0\u5149\u4eba\u6578\u7684\u6708\u4efd\uff0c\u53ca\u6700\u5c11\u89c0\u5149\u4eba\u6578\u7684\u6708\u4efd\n    * \u6700\u591a: 2\u6708 21222617 \u4eba\u6b21\n    * \u6700\u5c11: 6\u6708 1260957 \u4eba\u6b21","8a8589bf":"# 1. \u524d\u7f6e\u8655\u7406\n* \u5c07\u8cc7\u6599\u683c\u5f0f\u7d71\u4e00\n* \u9577\u683c\u5f0f\u8f49\u70ba\u5bec\u683c\u5f0f\n* \u91cd\u65b0\u6392\u5e8f\u6708\u4efd\n* \u79fb\u9664\u904e\u591a\u7a7a\u7f3a\u503c\u7684\u8cc7\u6599\n* \u5bec\u683c\u5f0f\u8f49\u70ba\u9577\u683c\u5f0f","9262d2c8":"# 410923021 \u5de6\u5176\u53f3 \u671f\u672b\u5831\u544a\n\u8cc7\u6599: \u6b77\u5e74\u570b\u5167\u4e3b\u8981\u89c0\u5149\u904a\u61a9\u64da\u9ede\u904a\u5ba2\u4eba\u6578\u6708\u5225\u7d71\u8a08 https:\/\/data.gov.tw\/dataset\/8116\n","4edbd2fd":"# 2. \u984c\u76ee\n* 2021\u5e7410\u6708 \u524d\u4e94\u5927\u71b1\u9580\u89c0\u5149\u666f\u9ede\n* 2012\u5e74\u81f32021\u5e74\u6210\u9577\u6700\u591a\u7684\u89c0\u5149\u666f\u9ede (percentage)\n* 2012\u5e74\u81f32021\u5e74\u4e0b\u964d\u6700\u591a\u7684\u89c0\u5149\u666f\u9ede (percentage)\n* 2021\u5e741\u6708\u523010\u6708\uff0c\u5404\u6708\u4efd\u7684\u7e3d\u89c0\u5149\u4eba\u6578\n* 2021\u5e74\u6700\u591a\u89c0\u5149\u4eba\u6578\u7684\u6708\u4efd\uff0c\u53ca\u6700\u5c11\u89c0\u5149\u4eba\u6578\u7684\u6708\u4efd"}}