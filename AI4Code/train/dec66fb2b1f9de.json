{"cell_type":{"d969fb68":"code","d149c2e2":"code","75cecb6c":"code","27d9b7e7":"code","16e7d6b7":"code","ceb7d851":"code","2bdb0719":"code","fbffb81a":"code","a8615800":"code","93231188":"code","92d98e0e":"code","fbec49f7":"code","54ea4496":"code","77911f06":"code","1463478b":"code","8bc6a2f7":"code","2743d442":"code","66f0cec6":"code","5645c5d3":"code","9552642a":"code","40c5776f":"code","9c9439fb":"code","c14cd45b":"code","fe07d94a":"markdown"},"source":{"d969fb68":"import pandas as pd\nimport numpy as np\nimport os\nimport seaborn as sns\nimport matplotlib.pyplot as plt","d149c2e2":"train=pd.read_csv(\"..\/input\/stayalert\/fordTrain.csv\",index_col=1)","75cecb6c":"test=pd.read_csv(\"..\/input\/stayalert\/fordTest.csv\")","27d9b7e7":"train.isna().sum()","16e7d6b7":"test.isna().sum()","ceb7d851":"pd.set_option(\"display.max_columns\",500)","2bdb0719":"train.describe()","fbffb81a":"'''\nSince V7,V9  and P8 have all values zero, Trial ID not required.\nwe will drop these variables'''\n\ntrain=train.drop(columns=[\"TrialID\",\"V7\",\"V9\",\"P8\"])","a8615800":"train.info()\n#check RAM uses","93231188":"#Reducing RAM uses\n\nx=['P3','P6','E3','E4','E6','E7','E8','E9','E10','V3','V5','V6','V10','IsAlert']\nfor i in x:\n    train[i]=train[i].astype('int16')\n\ny=['P1','P2','P4','P5','P7','E1','E2','E5','E11','V1','V2','V4','V8','V11']\nfor i in y:\n    train[i]=train[i].astype('float16')","92d98e0e":"train.info()","fbec49f7":"#model building\n\nfrom sklearn.model_selection import train_test_split\n\nx = train.drop(['IsAlert'], axis='columns')\n\ny=train['IsAlert']\n\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.3)\n\n\nfrom sklearn.linear_model import LogisticRegression","54ea4496":"#initiate the model\n\nlogreg=LogisticRegression()\n\n#fit the model with data\n\nlogreg.fit(x_train,y_train)\n\n#predicting y_test\n\ny_pred=logreg.predict(x_test)\n\n#import metrics class\n\nfrom sklearn import metrics\n\ncnf_matrix=metrics.confusion_matrix(y_test,y_pred)\n\ncnf_matrix\n\nmetrics.precision_score(y_test,y_pred)\nmetrics.recall_score(y_test,y_pred)","77911f06":"#randomeforestclassifier\n\nfrom sklearn.ensemble import RandomForestClassifier\n\nrfc=RandomForestClassifier()\nrfc.fit(x_train,y_train)\n\n\ny_pred=rfc.predict(x_test)\n\n\n\n","1463478b":"cnf_matrix1=metrics.confusion_matrix(y_pred,y_test)\nprint(y_test.value_counts())\nprint(cnf_matrix1)","8bc6a2f7":"import seaborn as sns \nsns.heatmap(cnf_matrix1,annot=True,fmt=\"d\")","2743d442":"metrics.f1_score(y_test,y_pred)\n","66f0cec6":"report=metrics.classification_report(y_test,y_pred)\nprint(report)","5645c5d3":"from sklearn import tree\n\n\nclf=tree.DecisionTreeClassifier()\nclf.fit(x_train,y_train)\ny_pred=clf.predict(x_test)\ncnf_matrix1=metrics.confusion_matrix(y_pred,y_test)\nprint(metrics.classification_report(y_test,y_pred))","9552642a":"solution=pd.read_csv(\"..\/input\/stayalert\/Solution.csv\")","40c5776f":"test=test.drop(columns=[\"TrialID\",\"V7\",\"V9\",\"P8\",\"IsAlert\",\"ObsNum\"])\ntest.info()","9c9439fb":"test_pred=rfc.predict(test)","c14cd45b":"print(metrics.classification_report(test_pred,solution[\"Prediction\"]))","fe07d94a":"#counting missing values"}}