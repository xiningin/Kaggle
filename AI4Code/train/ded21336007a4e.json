{"cell_type":{"94c35bcb":"code","6d079d0e":"code","4a16da0d":"code","a32b5460":"code","af4a701c":"code","f026645b":"code","f64d19c7":"code","52b3a06e":"code","06e5333f":"code","680082ae":"code","356cd23e":"code","3fa2f768":"code","0b1fd8b4":"code","b958fb4a":"code","ec537758":"code","fb74d3d4":"code","534d8028":"markdown"},"source":{"94c35bcb":"# Import Library\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport pandas_profiling as pp\nimport matplotlib.pyplot as plt \nimport seaborn as sns \nimport plotly as py\nimport plotly.express as px\nimport plotly.graph_objs as go\nfrom sklearn.cluster import KMeans, AgglomerativeClustering\nfrom sklearn.preprocessing import StandardScaler\nfrom scipy.cluster import hierarchy\nfrom sklearn.decomposition import PCA\nimport warnings\nimport os\nfrom yellowbrick.cluster import KElbowVisualizer, SilhouetteVisualizer\nwarnings.filterwarnings(\"ignore\")\npy.offline.init_notebook_mode(connected = True)","6d079d0e":"for dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","4a16da0d":"df = pd.read_csv('\/kaggle\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')\nprint(df.shape)\ndf.head()","a32b5460":"# Basic Exploratory Analysis\nprint(df.dtypes)\nprint('---------------------------')\nprint(df.isnull().sum())","af4a701c":"# Basic Exploratory Data Analysis\ndf.describe()","f026645b":"# In Depth Exploratory Data Analysis\npp.ProfileReport(df)","f64d19c7":"df.columns.tolist()","52b3a06e":"print(plt.style.available)","06e5333f":"# Basic Exploratory Analysis : Data Visualization\n# Understand the distribution of Age, Income, Spending score\nplt.style.use('ggplot')\nplt.figure(1 , figsize = (15 , 6), clear=True)\nn = 0 \nfor x in df.columns[2:]:\n    n += 1\n    plt.subplot(1 , 3 , n)\n    plt.subplots_adjust(hspace =0.5 , wspace = 0.5)\n    sns.distplot(df[x] , bins = 10)\n    plt.title('Distplot of {}'.format(x))\nplt.show()","680082ae":"plt.figure(1 , figsize = (15 , 4))\nsns.countplot(x = 'Gender' , data = df)\nplt.show()","356cd23e":"sns.pairplot(df,hue='Gender')","3fa2f768":"# Remove Customer ID column\ndf = df.drop(columns=['CustomerID'], axis=1)\n# Dummy Variable Creation \n# df = pd.concat([df, pd.get_dummies(df['Gender'])], axis=1).drop(columns=['Gender'], axis=1)\n# Standardization of data\n# ss = StandardScaler()\n# df[df.columns] = ss.fit_transform(df[df.columns])\n\n#Changing the gender column from categorical to numerical\ndf.loc[df.Gender == 'Male' ,'Gender'] = 1\ndf.loc[df.Gender == 'Female' ,'Gender'] = 0\n\ndf.Gender= df.Gender.astype(int)","0b1fd8b4":"model = KMeans()\n# k is range of number of clusters.\nvisualizer = KElbowVisualizer(model, k=(2,20), timings= True)\nvisualizer.fit(df)        # Fit the data to the visualizer\nvisualizer.show()    ","b958fb4a":"for n in range(2,10):\n    model = KMeans(n_clusters = n)\n    # k is range of number of clusters.\n    visualizer = SilhouetteVisualizer(model)\n    visualizer.fit(df)        # Fit the data to the visualizer\n    visualizer.show()        # Finalize and render the figure","ec537758":"X3 = df[['Age' , 'Annual Income (k$)' ,'Spending Score (1-100)']].iloc[: , :].values\nalgorithm = (KMeans(n_clusters = 6 ,init='k-means++', n_init = 10 ,max_iter=300, \n                        tol=0.0001,  random_state= 111  , algorithm='elkan') )\nalgorithm.fit(X3)\nlabels3 = algorithm.labels_\ncentroids3 = algorithm.cluster_centers_\ndf['label3'] =  labels3","fb74d3d4":"fig = px.scatter_3d(df, x=df['Age'], y=df['Spending Score (1-100)'], z=df['Annual Income (k$)'],\n              color=df['label3'])\nfig.show()","534d8028":"Insights:\n\n1. No significant correlation between variables\n2. Annual income more than 100 can only found in age range 30-50\n3. Annual income vs spending score scatter plot illustrate that 5 cluster may produced"}}