{"cell_type":{"06efe6eb":"code","67ec54d2":"code","fc6cd563":"code","a2810169":"code","17602ab6":"code","893befdf":"code","d0b4bde9":"code","4a6bf1d6":"code","cdb2e268":"markdown"},"source":{"06efe6eb":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport librosa\nimport os","67ec54d2":"BASE_TEST_DIR = '..\/input\/birdsong-recognition' if os.path.exists('..\/input\/birdsong-recognition\/test_audio') else '..\/input\/birdcall-check'","fc6cd563":"df_test = pd.read_csv(f'{BASE_TEST_DIR}\/test.csv')\ndf_train = pd.read_csv('..\/input\/birdsong-recognition\/train.csv')\nsub_test_12 = df_test[df_test.site.isin(['site_1', 'site_2'])]\nsub_test_3 = df_test[df_test.site.isin(['site_3'])]","a2810169":"%%capture\nsubmission = {'row_id': [], 'birds': []}\nst=set()\nfor audio_id, data in sub_test_12.groupby('audio_id'):\n    wav,sr=librosa.load(BASE_TEST_DIR+'\/test_audio\/'+ audio_id+'.mp3',sr=None,duration=1)\n    st.add(sr)\n    submission['row_id'].extend(data['row_id'].values)\n    submission['birds'].extend(['nocall' for i in range(data.shape[0])])\n    del wav,sr\nfor _, row in sub_test_3.iterrows():\n    row_id, audio_id = row['row_id'], row['audio_id']\n    wav,sr=librosa.load(BASE_TEST_DIR+'\/test_audio\/'+ audio_id+'.mp3',sr=None,duration=1)\n    st.add(sr)\n    submission['row_id'].append(row_id)\n    submission['birds'].append('nocall')\n    del wav,sr","17602ab6":"submission = pd.DataFrame(submission)\nsubmission.head()","893befdf":"if len(st)==2 : pass\nelif len(st)==3 : submission.birds='amecro'                 \nelif len(st)==4 : submission.birds='amebit'\nelif len(st)==5 : submission.birds='nocall amecro'\nelse : submission.birds='redhea'","d0b4bde9":"submission.to_csv('submission.csv', index=False)","4a6bf1d6":"submission","cdb2e268":"### Code for probing test set as discussed [here](https:\/\/www.kaggle.com\/c\/birdsong-recognition\/discussion\/177584)."}}