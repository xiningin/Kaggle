{"cell_type":{"a73b4696":"code","47edf0d6":"code","faffae0c":"code","a74ad4f1":"code","5602399b":"code","bc02d70a":"markdown","791a25b5":"markdown","a3161174":"markdown","9b7c19cd":"markdown","fb95f1e6":"markdown","7aee69e2":"markdown"},"source":{"a73b4696":"import pandas as pd\nimport numpy as np","47edf0d6":"df_train = pd.read_csv('..\/input\/X_train.csv', encoding='cp949')\ndf_test = pd.read_csv('..\/input\/X_test.csv', encoding='cp949')\ny_train = pd.read_csv('..\/input\/y_train.csv').gender\nIDtest = df_test.custid.unique()\n\ndf_train.head()","faffae0c":"df_all = pd.concat([df_train, df_test])\ndf_all['sales_hour'] = df_all['sales_time']\/\/100;\ndf_all['sales_wkday'] = pd.to_datetime(df_all.sales_date).dt.weekday\n\ndef makeBOW(col):\n    f = lambda x: np.where(len(x) >=1, 1, 0)\n\n    train = pd.pivot_table(df_all, index='custid', columns=col, values='tot_amt',\n                             aggfunc=f, fill_value=0).reset_index(). \\\n                             query('custid not in @IDtest').drop(columns=['custid'])\n    test = pd.pivot_table(df_all, index='custid', columns=col, values='tot_amt',\n                             aggfunc=f, fill_value=0).reset_index(). \\\n                             query('custid in @IDtest').drop(columns=['custid'])\n    return train, test\ntrain1, test1 = makeBOW('corner_nm')\ntrain2, test2 = makeBOW('sales_hour')\ntrain3, test3 = makeBOW('sales_wkday')\n\nX_train = pd.concat([train1, train2, train3], axis=1).values\nX_test = pd.concat([test1, test2, test3], axis=1).values","a74ad4f1":"from sklearn.linear_model import LogisticRegression\nmodel = LogisticRegression()\nmodel.fit(X_train, y_train)","5602399b":"pred = model.predict_proba(X_test)[:,1]\nfname = 'submissions.csv'\nsubmissions = pd.concat([pd.Series(IDtest, name=\"custid\"), pd.Series(pred, name=\"gender\")] ,axis=1)\nsubmissions.to_csv(fname, index=False)\nprint(\"'{}' is ready to submit.\" .format(fname))","bc02d70a":"### Extract features using BOW","791a25b5":"### Read Data","a3161174":"## End","9b7c19cd":"## This model has the following characteristics:\n* No feature engineering\n* Extracting features from raw transactions through BOW(Bag of Words)","fb95f1e6":"### Make Submissions","7aee69e2":"### Build Models"}}