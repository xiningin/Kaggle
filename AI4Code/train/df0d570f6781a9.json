{"cell_type":{"cb3eac6a":"code","428b97b3":"code","4cd5da82":"code","c5d2b6d8":"code","0cbf5525":"code","fc45be3b":"code","b27c9805":"code","66d89141":"code","70046bda":"code","a1d42d46":"code","59381140":"code","e894b7e3":"code","cca5a68b":"code","e465f389":"code","7802f966":"code","afedf664":"code","6cc77618":"code","20feb151":"code","3619bc39":"code","b0ed807f":"code","cc175dc0":"code","ec61a499":"code","9a32e77a":"code","8b74203a":"code","e05e00ba":"code","078729c4":"code","1e508359":"code","18357a50":"code","986da391":"code","7784ac8e":"code","b62c2c81":"code","df63295b":"code","b3065f6e":"code","0f7fb8db":"code","2a9cf751":"code","8ad0bc17":"code","359e1031":"code","8646fcd3":"code","b0fabaef":"code","ce0ba005":"code","54405d4c":"code","55e04318":"code","80bf78f2":"code","ce4d1793":"code","01deadfe":"code","d5b07b68":"code","7e1bebf5":"code","7875de24":"code","b740316b":"code","06495833":"code","8421c079":"code","469d4d7d":"code","f411c71d":"code","d6d97c14":"code","428c96ee":"code","4f791468":"code","61fc713b":"code","a6809174":"code","4bed963f":"code","b130236b":"markdown","652d80ca":"markdown","86f8c1d9":"markdown","431c92f6":"markdown","e5dacf8a":"markdown","66c138e2":"markdown","7d001a76":"markdown","bbb02652":"markdown","e97ef3a7":"markdown","bca0ad59":"markdown","d6bd3e26":"markdown","80b22bd2":"markdown","4c152d51":"markdown","11a0e996":"markdown"},"source":{"cb3eac6a":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n%matplotlib inline","428b97b3":"df = pd.read_csv('..\/input\/housesalesprediction\/kc_house_data.csv')","4cd5da82":"df.isnull().sum()","c5d2b6d8":"df.describe().transpose()","0cbf5525":"plt.figure(figsize=(10,6))\nsns.distplot(df['price'])","fc45be3b":"sns.countplot(df['bedrooms'])","b27c9805":"df.corr()['price'].sort_values()","66d89141":"plt.figure(figsize=(10,5))\nsns.scatterplot(x='price',y='sqft_living',data=df)","70046bda":"plt.figure(figsize=(10,6))\nsns.boxplot(x='bedrooms',y='price',data=df)","a1d42d46":"df.corr()['bedrooms'].sort_values()","59381140":"df.corr()['zipcode'].sort_values()","e894b7e3":"plt.figure(figsize=(12,8))\nsns.scatterplot(x='price',y='long',data=df)","cca5a68b":"plt.figure(figsize=(12,8))\nsns.scatterplot(x='long',y='lat',data=df,hue='price')","e465f389":"df.sort_values('price',ascending=False).head(20)","7802f966":"len(df)*0.01","afedf664":"non_top_1_perc = df.sort_values('price',ascending=False).iloc[216:]","6cc77618":"plt.figure(figsize=(12,8))\nsns.scatterplot(x='long',y='lat',data=non_top_1_perc,\n                edgecolor=None,alpha=0.2,palette='RdYlGn',hue='price')","20feb151":"sns.boxplot(x='waterfront',y='price',data=df)","3619bc39":"df= df.drop('id',axis=1)","b0ed807f":"df['date']= pd.to_datetime(df['date'])","cc175dc0":"df['date']","ec61a499":"df['year']= df['date'].apply(lambda date: date.year)\ndf['month']= df['date'].apply(lambda date: date.month)","9a32e77a":"df.head()","8b74203a":"plt.figure(figsize=(10,6))\nsns.boxplot(x='month',y='price',data=df)","e05e00ba":"df.groupby('month').mean()['price'].plot()","078729c4":"df.groupby('year').mean()['price'].plot()","1e508359":"df = df.drop('date',axis=1)","18357a50":"df.columns","986da391":"df.head()","7784ac8e":"# df['zipcode'].value_counts()","b62c2c81":"df = df.drop('zipcode',axis=1)","df63295b":"df['yr_renovated'].value_counts()","b3065f6e":"df['sqft_basement'].value_counts()","0f7fb8db":"X= df.drop(\"price\",axis=1).values\ny = df['price'].values","2a9cf751":"from sklearn.model_selection import train_test_split","8ad0bc17":"train_test_split","359e1031":"X_train, X_test, y_train, y_test = train_test_split( X, y, test_size=0.3, random_state=101)\n","8646fcd3":"from sklearn.preprocessing import MinMaxScaler","b0fabaef":"scaler = MinMaxScaler()","ce0ba005":"X_train = scaler.fit_transform(X_train)","54405d4c":"X_test = scaler.transform(X_test)","55e04318":"from tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense","80bf78f2":"X_train.shape","ce4d1793":"model = Sequential()\n\nmodel.add(Dense(19,activation='relu'))\nmodel.add(Dense(19,activation='relu'))\nmodel.add(Dense(19,activation='relu'))\nmodel.add(Dense(19,activation='relu'))\n\nmodel.add(Dense(1))\n\nmodel.compile(optimizer='adam',loss='mse')","01deadfe":"model.fit(x=X_train,y=y_train,\n          validation_data=(X_test,y_test), \n         batch_size=128,epochs=400)","d5b07b68":"losses = pd.DataFrame(model.history.history)","7e1bebf5":"losses.plot()","7875de24":"from sklearn.metrics import mean_squared_error, mean_absolute_error,explained_variance_score","b740316b":"predictions= model.predict(X_test)","06495833":"mean_squared_error(y_test, predictions)","8421c079":"np.sqrt(mean_squared_error(y_test,predictions))","469d4d7d":"mean_absolute_error(y_test,predictions)","f411c71d":"df['price'].describe()","d6d97c14":"5.402966e+05","428c96ee":"explained_variance_score(y_test,predictions)","4f791468":"plt.figure(figsize=(12,6))\nplt.scatter(y_test,predictions)\nplt.plot(y_test,y_test,'r')","61fc713b":"single_house = df.drop('price',axis=1).iloc[0]","a6809174":"single_house = scaler.transform(single_house.values.reshape(-1,19))","4bed963f":"model.predict(single_house)","b130236b":"## The Data\n\nWe will be using data from a Kaggle data set:\n\nhttps:\/\/www.kaggle.com\/harlfoxem\/housesalesprediction\n\nIt is historical housing data for King County, USA.\n\n#### Feature Columns\n    \n* id - Unique ID for each home sold\n* date - Date of the home sale\n* price - Price of each home sold\n* bedrooms - Number of bedrooms\n* bathrooms - Number of bathrooms, where .5 accounts for a room with a toilet but no shower\n* sqft_living - Square footage of the apartments interior living space\n* sqft_lot - Square footage of the land space\n* floors - Number of floors\n* waterfront - A dummy variable for whether the apartment was overlooking the waterfront or not\n* view - An index from 0 to 4 of how good the view of the property was\n* condition - An index from 1 to 5 on the condition of the apartment,\n* grade - An index from 1 to 13, where 1-3 falls short of building construction and design, 7 has an average level of construction and design, and 11-13 have a high quality level of construction and design.\n* sqft_above - The square footage of the interior housing space that is above ground level\n* sqft_basement - The square footage of the interior housing space that is below ground level\n* yr_built - The year the house was initially built\n* yr_renovated - The year of the house\u2019s last renovation\n* zipcode - What zipcode area the house is in\n* lat - Lattitude\n* long - Longitude\n* sqft_living15 - The square footage of interior housing living space for the nearest 15 neighbors\n* sqft_lot15 - The square footage of the land lots of the nearest 15 neighbors","652d80ca":"sqft_living has a high correlation with price","86f8c1d9":"There arent't really any correlations between bedrooms and zipcodes here. Let's keep visualizing our data ","431c92f6":"# Exploratory Data Analysis","e5dacf8a":"It looks like there may be some differences between months. The range is about 510k to 560k.","66c138e2":"our models are trained on scaled versions of features so we can't do it raw","7d001a76":"## Working with feature data","bbb02652":"## Scaling and Train Test Split","e97ef3a7":"Most of our houses fall between 0 and 1.5 million dollars. It probably makes sense to drop our extreme outliers.","bca0ad59":"### Geographical properties","d6bd3e26":"#### Feature engineering from Date","80b22bd2":"Predicting we will sell at $288,413, but it may be overshooting due to our outliers.","4c152d51":"Majority of houses have 2-5 bedrooms.","11a0e996":"# Keras Regression Project "}}