{"cell_type":{"695eb385":"code","2cedf758":"code","1126fa85":"code","b6ab55dc":"code","cf8ff8ce":"code","a04b05fb":"code","8465cde6":"code","64dd1cfb":"code","d2a6b6f5":"code","8747871a":"code","41fa8ad4":"code","3feb5661":"code","e6dca697":"code","bdd3c543":"code","cf33bc00":"code","d7e484e0":"code","d773d888":"code","71348ade":"code","ed02c83b":"code","407b219c":"code","00251f93":"code","22783a63":"code","b590469a":"code","040e3cb4":"code","e3f5a67b":"markdown","52d73ded":"markdown","57f3cf7b":"markdown","c8ee9171":"markdown","3f301715":"markdown","73cb283f":"markdown","9a4d93dc":"markdown","72bc9611":"markdown","a4c5838a":"markdown","8ad4fb8d":"markdown","dbf7f4c0":"markdown","6c3033ca":"markdown","fd5264be":"markdown","93271a0d":"markdown","a0d332f3":"markdown","8137067a":"markdown","56f9a9dc":"markdown","aebe4a4b":"markdown","24aa9c14":"markdown","c0b4bfff":"markdown","baa4e6cd":"markdown","c770330f":"markdown","3bec0908":"markdown","5fc859a2":"markdown","68564a80":"markdown","68c4e178":"markdown","4c71804b":"markdown","b778c20d":"markdown","ecb529eb":"markdown","21ebb1d7":"markdown","6995c82f":"markdown","7fdc7741":"markdown","49e6ead6":"markdown"},"source":{"695eb385":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\nimport plotly.express as px\nfrom sklearn.cluster import KMeans\nfrom sklearn.preprocessing import LabelEncoder\nimport plotly.io as pio\npio.renderers.default='notebook'","2cedf758":"df=pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')","1126fa85":"df.head(2)","b6ab55dc":"df.shape","cf8ff8ce":"df.info()","a04b05fb":"df.columns=['CustomerID', 'Gender', 'Age', 'Annual Income','Spending Score']","8465cde6":"plt.figure(figsize=(18,6))\n\nplt.subplot(1,3,1)\nsns.distplot(df['Age'], color='royalblue')\nplt.title('Age', fontsize=16)\nplt.xlabel('Age', fontsize=14)\nplt.ylabel('Frequency', fontsize=14)\n\nplt.subplot(1,3,2)\nsns.distplot(df['Annual Income'], color='deeppink')\nplt.title('Income', fontsize=16)\nplt.xlabel('Income', fontsize=14)\n\nplt.subplot(1,3,3)\nsns.distplot(df['Spending Score'], color='forestgreen')\nplt.title('Spending Score', fontsize=16)\nplt.xlabel('Spending Score', fontsize=14)\n\nplt.show()","64dd1cfb":"plt.figure(figsize=(18,6))\n\nplt.subplot(1,3,1)\nsns.violinplot(x='Age', y='Gender', data=df, color='y')\nsns.swarmplot(x='Age', y='Gender', data=df, palette='plasma')\nplt.xlabel('Age', fontsize=14)\nplt.ylabel('Gender', fontsize=14)\nplt.yticks([0,1],['Male','Female'],fontsize=12 )\n\nplt.subplot(1,3,2)\nsns.violinplot(x='Annual Income', y='Gender', data=df,color='g')\nsns.swarmplot(x='Annual Income', y='Gender', data=df,palette='plasma')\nplt.xlabel('Annual Income', fontsize=14)\nplt.ylabel(' ')\nplt.yticks([])\nplt.title('Violinplots and Swarmplots',fontsize=25)\n\nplt.subplot(1,3,3)\nsns.violinplot(x='Spending Score', y='Gender', data=df, color='c')\nsns.swarmplot(x='Spending Score', y='Gender', data=df,palette='plasma')\nplt.xlabel('Spending Score', fontsize=14)\nplt.ylabel(' ')\nplt.yticks([])\n\nplt.show()","d2a6b6f5":"plt.figure(figsize=(8,6))\nsns.countplot(x='Gender', data=df, palette='winter')\nplt.title('Count Plot of Gender', fontsize=16)\nplt.xlabel('Gender', fontsize=14)\nplt.ylabel('Count', fontsize=14)\nplt.xticks([0,1],['Male','Female'],fontsize=12 )\nplt.show()","8747871a":"sns.set_style('white')\nnew=sns.PairGrid(df.drop(['CustomerID', 'Gender'],axis=1))\nnew.map(sns.regplot, color='teal')\nplt.suptitle('Relationship between Age, Annual Income and Spending Score',y=1.05,fontsize=14)\nplt.show()","41fa8ad4":"sns.lmplot(x='Age', y='Annual Income', data=df,fit_reg=False, hue='Gender', height=6, palette='plasma')\nplt.title('Relationship between Age, Annual Income and Gender', fontsize=14)\nplt.xlabel('Age', fontsize=13)\nplt.ylabel('Annual Income', fontsize=13)\nplt.show()","3feb5661":"sns.lmplot(x='Annual Income', y='Spending Score', data=df,fit_reg=False, hue='Gender', height=6, palette='Dark2')\nplt.title('Annual Income vs Spending Score vs Gender', fontsize=14)\nplt.xlabel('Annual Income', fontsize=13)\nplt.ylabel('Spending Score', fontsize=13)\nplt.show()","e6dca697":"X1=df[['Age','Spending Score']]\ninertia1=[]\nfor n in range(1 , 11):\n    model1=KMeans(n_clusters=n, init='k-means++', n_init=10, max_iter=300, tol=0.0001, random_state=111,algorithm='elkan')\n    model1.fit(X1)\n    inertia1.append(model1.inertia_)\nprint(inertia1)","bdd3c543":"plt.figure(figsize=(8,6))\nplt.plot(list(range(1 , 11)), inertia1, color='royalblue', marker='o',linewidth=2, markersize=12, markerfacecolor='m', markeredgecolor='m')\nplt.title('Inertia vs. Number of Clusters',fontsize=18)\nplt.xlabel('Number of Clusters',fontsize=15)\nplt.ylabel('Inertia',fontsize=15)\nplt.show()","cf33bc00":"model1=KMeans(n_clusters=4, init='k-means++', n_init=10, max_iter=300, tol=0.0001, random_state=111,algorithm='elkan')\nmodel1.fit(X1)\nlabels1=model1.labels_\ncentroids1=model1.cluster_centers_","d7e484e0":"plt.figure(figsize=(11,6))\nsns.set_style('white')\nplt.scatter(x=df['Age'], y=df['Spending Score'],c=labels1,cmap='winter')\nplt.scatter(x = centroids1[: , 0] , y =  centroids1[: , 1], s = 300 , c = 'red')\nplt.xlabel('Age',fontsize=15)\nplt.ylabel('Spending Score',fontsize=15)\nplt.title('Customer Segmentation Based on Age and Spending Score',fontsize=18)\nplt.show()","d773d888":"X2=df[['Annual Income','Spending Score']]\ninertia2=[]\nfor n in range(1,11):\n    model2=KMeans(n_clusters=n, init='k-means++', n_init=10, max_iter=300, tol=0.0001, random_state=111, algorithm='elkan')\n    model2.fit(X2)\n    inertia2.append(model2.inertia_)  \nprint(inertia2)","71348ade":"plt.figure(figsize=(8,6))\nsns.set_style('white')\nplt.plot(list(range(1,11)),inertia2,color='black', marker='o',linewidth=2, markersize=12, markerfacecolor='c', markeredgecolor='c')\nplt.xlabel('Number of Clusters',fontsize=15)\nplt.ylabel('Inertia',fontsize=15)\nplt.title('Inertia vs. Number of Clusters',fontsize=18)\nplt.show()","ed02c83b":"model2=KMeans(n_clusters=5, init='k-means++', n_init=10, max_iter=300, tol=0.0001, random_state=111, algorithm='elkan')\nmodel2.fit(X2)\ncentroids2=model2.cluster_centers_\nlabels2=model2.labels_","407b219c":"plt.figure(figsize=(11,6))\nsns.set_style('white')\nplt.scatter(x=df['Annual Income'], y=df['Spending Score'],c=labels2,cmap='winter')\nplt.scatter(centroids2[:,0], centroids2[:,1],c='red',s=200)\nplt.xlabel('Annual Income',fontsize=15)\nplt.ylabel('Spending Score',fontsize=15)\nplt.title('Customer Segmentation Based on Annual Income and Spending Score',fontsize=18)\nplt.show()","00251f93":"X3=df[['Age', 'Annual Income', 'Spending Score']]\ninertia3=[]\nfor n in range (1,10):\n    model3=KMeans(n_clusters=n,init='k-means++', n_init=10, max_iter=300, tol=0.0001, random_state=111,algorithm='elkan')\n    model3.fit(X3)\n    inertia3.append(model3.inertia_)\nprint(inertia3)","22783a63":"plt.figure(figsize=(8,6))\nplt.plot(list(range (1,10)),inertia3, color='indigo',marker='o', linewidth=2, markersize=12, markerfacecolor='violet', markeredgecolor='violet')\nplt.xlabel('Number of Clusters',fontsize=15)\nplt.ylabel('Inertia',fontsize=15)\nplt.title('Inertia vs. Number of Clusters',fontsize=18)\nplt.show()","b590469a":"model3=KMeans(n_clusters=6,init='k-means++', n_init=10, max_iter=300, tol=0.0001, random_state=111,algorithm='elkan')\nmodel3.fit(X3)\ncentroids3=model3.cluster_centers_\nlabels3=model3.labels_","040e3cb4":"fig=px.scatter_3d(data_frame=df,x='Age',y='Annual Income',z='Spending Score',color=labels3, color_continuous_scale='bluered')\nfig.update_layout(\n    title={\n        'text': 'Customer Segmentation Based on Age, Annual Income and Spending Score',\n        'y':0.95,\n        'x':0.5,\n        'xanchor': 'center',\n        'yanchor': 'top'})\nfig.show()","e3f5a67b":"We can see that if the number of clusters is smaller than 4, the inertia has a high value but if the number of clusters is larger than 4, the inertia is relatively constant. So we choose 4 as the optimal number of clusters.","52d73ded":"We analyze the distribution of Age, Annual Income and Spending Score values based on Gender.","57f3cf7b":"# <center> Mall Customer Segmentation by K-Means Clustering <center>","c8ee9171":"# ![3.jpg](attachment:3.jpg)","3f301715":"#### Visualizing the Clusters ","73cb283f":"### Segmentation Based on Age, Annual Income and Spending Score","9a4d93dc":"#### Visualizing the Clusters ","72bc9611":"## Loading Dataset","a4c5838a":"We count the number of male and female customers.","8ad4fb8d":"## KMeans Clustering","dbf7f4c0":"## Conclusion","6c3033ca":"We rename the columns.","fd5264be":"We can see that if the number of clusters is smaller than 6, the inertia has a high value but if the number of clusters is larger than 6, the inertia is relatively constant. So we choose 6 as the optimal number of clusters.","93271a0d":"In the following figures, we visualize the relationship between Age, Annual Income, Spending Score and Gender.","a0d332f3":"#### Finding the Optimal Number of Clusters ","8137067a":"#### Performing Clustering with the Optimal Number of Clusters ","56f9a9dc":"#### Performing Clustering with the Optimal Number of Clusters ","aebe4a4b":"- In this notebook, we used a dataset of mall customers and performed exploratory data analysis to visualize the relationship between columns.\n\n- We implemented three different segmentation strategies by K-Means Clustering based on:\n    - Age and Spending Score\n    - Annual Income and Spending Score\n    - Age, Annual Income and Spending Score\n\n- The number of clusters were different in different strategies, varying between 4 and 6 groups of customers.","24aa9c14":"We visualize the distribution of Age, Annual Income and Spending Score values.","c0b4bfff":"### Segmentation Based on Annual Income and Spending Score","baa4e6cd":"Segmentation is the practice of dividing a database into groups of observations that are similar in specific ways relevant to marketing. Each groups contain individuals that are similar in-between themselves, and different from individuals from the other groups. Segmentation is widely used as a marketing tool to create clusters of clients and adapt a relevant strategy for each of them.\n\nIn this notebook, we will be illustrating how to apply K Means algorithm to a dataset. Here we have a dataset of customers who purchase stuff in a mall. This dataset contains information such as Gender, Age,\tAnnual Income, Spending Score. \n\nFirst, we will perform exploratory data analysis and then work on customer segmentation by implementing K-Means Clustering based on the characteristics of customers. In this way, we can find the main clusters which are the most representative types of customers.","c770330f":"## Introduction","3bec0908":"We can see that if the number of clusters is smaller than 5, the inertia has a high value but if the number of clusters is larger than 5, the inertia is relatively constant. So we choose 5 as the optimal number of clusters.","5fc859a2":"#### Visualizing the Clusters ","68564a80":"<h1>Table of Contents<span class=\"tocSkip\"><\/span><\/h1>\n<div class=\"toc\"><ul class=\"toc-item\"><li><span><a href=\"#Introduction\" data-toc-modified-id=\"Introduction-1\"><span class=\"toc-item-num\">1&nbsp;&nbsp;<\/span>Introduction<\/a><\/span><\/li><li><span><a href=\"#Importing-Libraries\" data-toc-modified-id=\"Importing-Libraries-2\"><span class=\"toc-item-num\">2&nbsp;&nbsp;<\/span>Importing Libraries<\/a><\/span><\/li><li><span><a href=\"#Loading-Dataset\" data-toc-modified-id=\"Loading-Dataset-3\"><span class=\"toc-item-num\">3&nbsp;&nbsp;<\/span>Loading Dataset<\/a><\/span><\/li><li><span><a href=\"#Exploratory-Data-Analysis\" data-toc-modified-id=\"Exploratory-Data-Analysis-4\"><span class=\"toc-item-num\">4&nbsp;&nbsp;<\/span>Exploratory Data Analysis<\/a><\/span><\/li><li><span><a href=\"#KMeans-Clustering\" data-toc-modified-id=\"KMeans-Clustering-5\"><span class=\"toc-item-num\">5&nbsp;&nbsp;<\/span>KMeans Clustering<\/a><\/span><ul class=\"toc-item\"><li><span><a href=\"#Segmentation-Based-on-Age-and-Spending-Score\" data-toc-modified-id=\"Segmentation-Based-on-Age-and-Spending-Score-5.1\"><span class=\"toc-item-num\">5.1&nbsp;&nbsp;<\/span>Segmentation Based on Age and Spending Score<\/a><\/span><ul class=\"toc-item\"><li><span><a href=\"#Finding-the-Optimal-Number-of-Clusters\" data-toc-modified-id=\"Finding-the-Optimal-Number-of-Clusters-5.1.1\"><span class=\"toc-item-num\">5.1.1&nbsp;&nbsp;<\/span>Finding the Optimal Number of Clusters<\/a><\/span><\/li><li><span><a href=\"#Performing-Clustering-with-the-Optimal-Number-of-Clusters\" data-toc-modified-id=\"Performing-Clustering-with-the-Optimal-Number-of-Clusters-5.1.2\"><span class=\"toc-item-num\">5.1.2&nbsp;&nbsp;<\/span>Performing Clustering with the Optimal Number of Clusters<\/a><\/span><\/li><li><span><a href=\"#Visualizing-the-Clusters\" data-toc-modified-id=\"Visualizing-the-Clusters-5.1.3\"><span class=\"toc-item-num\">5.1.3&nbsp;&nbsp;<\/span>Visualizing the Clusters<\/a><\/span><\/li><\/ul><\/li><li><span><a href=\"#Segmentation-Based-on-Annual-Income-and-Spending-Score\" data-toc-modified-id=\"Segmentation-Based-on-Annual-Income-and-Spending-Score-5.2\"><span class=\"toc-item-num\">5.2&nbsp;&nbsp;<\/span>Segmentation Based on Annual Income and Spending Score<\/a><\/span><ul class=\"toc-item\"><li><span><a href=\"#Finding-the-Optimal-Number-of-Clusters\" data-toc-modified-id=\"Finding-the-Optimal-Number-of-Clusters-5.2.1\"><span class=\"toc-item-num\">5.2.1&nbsp;&nbsp;<\/span>Finding the Optimal Number of Clusters<\/a><\/span><\/li><li><span><a href=\"#Performing-Clustering-with-the-Optimal-Number-of-Clusters\" data-toc-modified-id=\"Performing-Clustering-with-the-Optimal-Number-of-Clusters-5.2.2\"><span class=\"toc-item-num\">5.2.2&nbsp;&nbsp;<\/span>Performing Clustering with the Optimal Number of Clusters<\/a><\/span><\/li><li><span><a href=\"#Visualizing-the-Clusters\" data-toc-modified-id=\"Visualizing-the-Clusters-5.2.3\"><span class=\"toc-item-num\">5.2.3&nbsp;&nbsp;<\/span>Visualizing the Clusters<\/a><\/span><\/li><\/ul><\/li><li><span><a href=\"#Segmentation-Based-on-Age,-Annual-Income-and-Spending-Score\" data-toc-modified-id=\"Segmentation-Based-on-Age,-Annual-Income-and-Spending-Score-5.3\"><span class=\"toc-item-num\">5.3&nbsp;&nbsp;<\/span>Segmentation Based on Age, Annual Income and Spending Score<\/a><\/span><ul class=\"toc-item\"><li><span><a href=\"#Finding-the-Optimal-Number-of-Clusters\" data-toc-modified-id=\"Finding-the-Optimal-Number-of-Clusters-5.3.1\"><span class=\"toc-item-num\">5.3.1&nbsp;&nbsp;<\/span>Finding the Optimal Number of Clusters<\/a><\/span><\/li><li><span><a href=\"#Performing-Clustering-with-the-Optimal-Number-of-Clusters\" data-toc-modified-id=\"Performing-Clustering-with-the-Optimal-Number-of-Clusters-5.3.2\"><span class=\"toc-item-num\">5.3.2&nbsp;&nbsp;<\/span>Performing Clustering with the Optimal Number of Clusters<\/a><\/span><\/li><li><span><a href=\"#Visualizing-the-Clusters\" data-toc-modified-id=\"Visualizing-the-Clusters-5.3.3\"><span class=\"toc-item-num\">5.3.3&nbsp;&nbsp;<\/span>Visualizing the Clusters<\/a><\/span><\/li><\/ul><\/li><\/ul><\/li><li><span><a href=\"#Conclusion\" data-toc-modified-id=\"Conclusion-6\"><span class=\"toc-item-num\">6&nbsp;&nbsp;<\/span>Conclusion<\/a><\/span><\/li><\/ul><\/div>","68c4e178":"## Importing Libraries","4c71804b":"#### Finding the Optimal Number of Clusters ","b778c20d":"#### Performing Clustering with the Optimal Number of Clusters ","ecb529eb":"First, we find the optimal number of clusters by elbow method.","21ebb1d7":"The dataset is clean and does not need Data Cleaning.","6995c82f":"## Exploratory Data Analysis","7fdc7741":"#### Finding the Optimal Number of Clusters ","49e6ead6":"### Segmentation Based on Age and Spending Score"}}