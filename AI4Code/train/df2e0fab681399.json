{"cell_type":{"8b2534a0":"code","57cf70c6":"code","e370b5be":"code","2c788f88":"code","3bb85c19":"code","80ff6dd1":"code","891207cd":"code","8fc33a98":"code","2d04abb0":"code","2b81c75f":"code","96f6fd6f":"code","529f091d":"code","92414c47":"code","dc559284":"code","fe40df4e":"code","d184c2f7":"code","dd44456c":"code","4a5a095f":"code","e5b98c94":"code","1ceb3d8b":"code","49ee6751":"code","16f6d7c7":"code","4ff30d0c":"code","f9c288c5":"code","7369e97c":"code","1d4773be":"markdown","10db6266":"markdown","bd5757db":"markdown","07bea68c":"markdown"},"source":{"8b2534a0":"#imports\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.model_selection import cross_val_score,train_test_split\nfrom sklearn.metrics import accuracy_score, confusion_matrix\nfrom tqdm import tqdm ","57cf70c6":"df = pd.read_csv('\/kaggle\/input\/heart-failure-clinical-data\/heart_failure_clinical_records_dataset.csv')","e370b5be":"df.head()","2c788f88":"df.info()","3bb85c19":"df.describe()","80ff6dd1":"#having a glance at multivariate analysis\nplt.figure(figsize = (30,30))\nsns.pairplot(df,hue = 'DEATH_EVENT')","891207cd":"#Since its a medical data it will be useful to see imbalancement\ndf_positive = df[df['DEATH_EVENT'] == 1]\ndf_negative = df[df['DEATH_EVENT'] == 0]\nprint('percantage positive deaths are {}%'.format((df_positive.shape[0]\/df.shape[0])*100))\nprint('percantage negative deaths are {}%'.format((df_negative.shape[0]\/df.shape[0])*100))","8fc33a98":"label = df['DEATH_EVENT']\ndf.drop('DEATH_EVENT',axis = 1,inplace = True)\ncol_names = df.columns\n#scaling the features\nscaler = StandardScaler()\nscaled = scaler.fit_transform(df)\nscaled_df = pd.DataFrame(scaled, columns = col_names)\nscaled_df.head()","2d04abb0":"#splitting the data\nX_train,X_test,y_train,y_test = train_test_split(scaled_df, label,test_size = 0.3,random_state = 42)\n\n#just seeing which neighbour will fit best\nacc = []\nfor i in tqdm(range(1,50)):\n    model = KNeighborsClassifier(n_neighbors = i)\n    model.fit(X_train,y_train)\n    pred = model.predict(X_test)\n    acc.append(accuracy_score(y_test,pred))\nplt.figure(figsize = (10,10))\nplt.plot(range(1,50),acc, marker = 'o')\nplt.xlabel('n_neighbor')\nplt.ylabel('accuracy')\nplt.title('accuracy graph')\n","2b81c75f":"(acc)","96f6fd6f":"#Just predicting accuracy through cross-validation\nmodel = KNeighborsClassifier(n_neighbors = 16)\ncv_score = cross_val_score(model,scaled_df,label,cv = 10)\nprint(cv_score)\nprint(min(cv_score))\nprint(max(cv_score))\nprint(cv_score.mean())","529f091d":"df.head()","92414c47":"#seeing distribution for age\nplt.figure(figsize=(15,5))\nplt.hist(df['age'],bins = 50,edgecolor = 'black')\nplt.xlabel('Age range')\nplt.ylabel('Frequency')\nplt.title('Age Distribution Graph')","dc559284":"#seeing distribution for blood pressure\nplt.figure(figsize=(15, 5))\nplt.bar(df['high_blood_pressure'].unique(), df['high_blood_pressure'].value_counts())\nplt.xlabel('NO\/Yes high blood pressure')\nplt.ylabel('Frequency')\nplt.title('Graph for blood pressure')","fe40df4e":"plt.figure(figsize=(15, 5))\nplt.bar(df['smoking'].unique(), df['smoking'].value_counts())\nplt.xlabel('NO\/Yes smoking')\nplt.ylabel('Frequency')\nplt.title('Graph for Smoking')","d184c2f7":"plt.figure(figsize=(15, 5))\nplt.bar(df['sex'].unique(), df['sex'].value_counts())\nplt.xlabel('female\/male for sex')\nplt.ylabel('Frequency')\nplt.title('Graph for sex distribution')","dd44456c":"#checking confusion matrix\nmodel.fit(X_train,y_train)\npred = model.predict(X_test)\ncm = confusion_matrix(y_test,pred)\ncm","4a5a095f":"scaled_df.shape,label.shape","e5b98c94":"#upsampling our dataset\nfrom imblearn.over_sampling import RandomOverSampler\nos = RandomOverSampler(random_state = 42)\nX_train_res,y_train_res = os.fit_sample(scaled_df, label)\nX_train_res.shape,y_train_res.shape","1ceb3d8b":"model = KNeighborsClassifier(n_neighbors = 16)\ncv_score = cross_val_score(model,X_train_res,y_train_res,cv = 10)\nprint(cv_score)\nprint(min(cv_score))\nprint(max(cv_score))\nprint(cv_score.mean())","49ee6751":"#checking outliers\nplt.figure(figsize=(15,15))\nfor i,col in enumerate(['age','creatinine_phosphokinase','ejection_fraction','platelets','serum_sodium','time']):\n    plt.subplot(2,3,i+1)\n    plt.boxplot(scaled_df[col])\n    plt.title(col)","16f6d7c7":"#Removing outliers\nper_25 = np.percentile(scaled_df['platelets'],25)\nper_75 = np.percentile(scaled_df['platelets'],75)\nIQR = (per_75 - per_25)*1.5\nmin_value = per_25 -IQR\nmax_value = per_75 + IQR\navg_value = scaled_df['platelets'].mean()\ndef treat_outliers(col):\n    if col < min_value or col > max_value:\n        col = avg_value\n    return col\nscaled_df['platelets'] = scaled_df['platelets'].apply(treat_outliers)","4ff30d0c":"plt.figure(figsize=(15,15))\nfor i,col in enumerate(['age','creatinine_phosphokinase','ejection_fraction','platelets','serum_sodium','time']):\n    plt.subplot(2,3,i+1)\n    plt.boxplot(scaled_df[col])\n    plt.title(col)","f9c288c5":"scaled_df.drop(['creatinine_phosphokinase','ejection_fraction','platelets'],axis = 1, inplace = True)\nmodel = KNeighborsClassifier(n_neighbors = 6)\ncv_score = cross_val_score(model,scaled_df,label,cv = 10)\nprint(cv_score)\nprint(min(cv_score))\nprint(max(cv_score))\nprint(cv_score.mean())","7369e97c":"#checking confusion matrix\nX_train, X_test, y_train, y_test = train_test_split(X_train_res,y_train_res, test_size = 0.2)\nmodel.fit(X_train, y_train)\npred = model.predict(X_test)\ncm = confusion_matrix(y_test,pred)\ncm","1d4773be":"false negative rate is high which is not good because it means that a person is having a disease but model is showing that he's not having which can be fatal for man this is due to imbalanced dataset Now we are going to upsample it.","10db6266":"# One more dataset that will teach you alot\n\n- Main thing in this datset is that you will develop a habit of seeing confusion matrix since you can't trust on accuracy when data is imabalanced.\n\n- You will see how easy is this to up-sample a data.\n\n- Not much informative thing is done by me in this but its a good dataset to make your hands dirty.","bd5757db":"some fault happened in outlier treatment you have to identify it by using notebook titled remove outlier with one function.","07bea68c":"See the false negative decreased but the false positives increased it happens that if you will reduce one other will increase."}}