{"cell_type":{"80f471ca":"code","72604d4b":"code","777e26df":"code","056e761a":"code","379a2c89":"code","92f59a19":"code","7f93d5a3":"code","f1c9c2d3":"code","b0ab111a":"code","10f1bac3":"code","abf3f1fa":"code","457db091":"code","5230ad27":"code","d7a8c1de":"code","3e1b95ce":"code","defaf421":"code","ff887a0c":"code","17ff1245":"code","d110ad06":"code","89c93106":"code","7d41e89a":"code","9ec64415":"code","b2fa5041":"code","d3d50303":"code","81c623a8":"code","b2dca9b6":"code","270f69fd":"code","2a005ad5":"code","190617ed":"markdown","8f2d2770":"markdown","294b5807":"markdown","ad09290c":"markdown","b63be35a":"markdown","5e64acb2":"markdown","b311a004":"markdown","834932fa":"markdown","9e629cc2":"markdown","fc4d3f0e":"markdown","af122fb1":"markdown","6b00163f":"markdown","a18cbdea":"markdown","1e96e777":"markdown","6b7b5e36":"markdown","39391d60":"markdown","28131a0b":"markdown","3c109f05":"markdown","5e1637a9":"markdown","d41a56cc":"markdown","c07e35db":"markdown"},"source":{"80f471ca":"import numpy as np \nimport pandas as pd\nimport geopandas as gpd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom scipy.stats import pearsonr\nfrom sklearn.model_selection import LeaveOneOut\nimport statsmodels.api as sm\nimport sklearn.metrics as sklm\npd.options.mode.chained_assignment = None\npd.options.display.float_format = '{:.4f}'.format","72604d4b":"data = pd.read_csv('..\/input\/worldbank-economicsdemographics-data\/final_demographics_data.csv')","777e26df":"data['log GDP per worker'] = np.log(data['GDP (constant 2010 US$)']\/data['Labor force, total'])\ndata['Urban population (%)'] = (data['Urban population']\/data['Population, total']) * 100\ndata['log population'] = np.log(data['Population, total'])\ndata = data[data['log GDP per worker'].notna()]\ngdp_per_worker = data['GDP (constant 2010 US$)']\/data['Labor force, total']","056e761a":"fig = plt.subplots(figsize=(15,15))\nplt.title('Heatmap of Missing Values')\nsns.heatmap(data.isna())\nplt.show()","379a2c89":"# only considerng features with less than 10 missing values and a sensible relationship with the producitivity\nfeatures = ['country', 'log GDP per worker', 'Urban population (%)', 'Domestic credit to private sector by banks (% of GDP)', \n            'Fixed broadband subscriptions (per 100 people)', 'Age dependency ratio, old (% of working-age population)', \n            'Age dependency ratio, young (% of working-age population)', 'Unemployment, total (% of total labor force) (modeled ILO estimate)', \n            'Final consumption expenditure (% of GDP)'] \n\n# Filling nan with last available data from https:\/\/data.worldbank.org\/\n\n# Domestic credit to private sector by banks (% of GDP) \ndata['Domestic credit to private sector by banks (% of GDP)'].iloc[data['country'] == 'Argentina'] = 15.4 # 2017\ndata['Domestic credit to private sector by banks (% of GDP)'].iloc[data['country'] == 'Ethiopia'] = 17.6 # 2008\ndata['Domestic credit to private sector by banks (% of GDP)'].iloc[data['country'] == 'Canada'] = 124.1 # 2008\ndata['Domestic credit to private sector by banks (% of GDP)'].iloc[data['country'] == 'Iraq'] = 9.2 # 2018\ndata['Domestic credit to private sector by banks (% of GDP)'].iloc[data['country'] == 'Saudi Arabia'] = 54.0 # 2018\ndata['Domestic credit to private sector by banks (% of GDP)'].iloc[data['country'] == 'Switzerland'] = 168.5 # 2016\ndata['Domestic credit to private sector by banks (% of GDP)'].iloc[data['country'] == 'Viet Nam'] = 137.9 #2019\n\n# fixed broadband\ndata['Fixed broadband subscriptions (per 100 people)'].iloc[data['country'] == 'Peru'] = 7.93 # 2018\ndata['Fixed broadband subscriptions (per 100 people)'].iloc[data['country'] == 'Philippines'] = 5.48 # 2019\ndata['Fixed broadband subscriptions (per 100 people)'].iloc[data['country'] == 'Ethiopia'] = 0.06 # 2017\ndata['Fixed broadband subscriptions (per 100 people)'].iloc[data['country'] == 'Nepal'] = 2.82 # 2018\n\n# final consumption\ndata['Final consumption expenditure (% of GDP)'].iloc[data['country'] == 'China'] = 56.0 # 2019\ndata['Final consumption expenditure (% of GDP)'].iloc[data['country'] == 'Ghana'] = 77.6 # 2019\ndata['Final consumption expenditure (% of GDP)'].iloc[data['country'] == 'Iraq'] = 65.4 # 2019\ndata['Final consumption expenditure (% of GDP)'].iloc[data['country'] == 'Kazakhstan'] = 61.4 # 2019\ndata['Final consumption expenditure (% of GDP)'].iloc[data['country'] == 'Kenya'] = 95.5 # 2019\ndata['Final consumption expenditure (% of GDP)'].iloc[data['country'] == 'Tunisia'] = 92.9 # 2019\ndata['Final consumption expenditure (% of GDP)'].iloc[data['country'] == 'United States of America'] = 81.8 # 2020\n\ndata = data[features]\ndata = data.dropna()","92f59a19":"data","7f93d5a3":"fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14,6))\nsns.histplot(gdp_per_worker, ax=ax1, color='salmon')\nax1.set_title('GDP per worker')\nsns.histplot(data['log GDP per worker'], ax=ax2, color='salmon')\nax2.set_title('Log GDP per worker')\nplt.show()","f1c9c2d3":"fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14,6))\nsns.regplot(ax=ax1, x='Urban population (%)', y='log GDP per worker', data=data, color = 'salmon')\nsns.histplot(data['Urban population (%)'], ax=ax2, color='salmon')\nplt.show()","b0ab111a":"print('Pearson-r and P-Value: ' + str(pearsonr(data['Urban population (%)'], data['log GDP per worker'])))","10f1bac3":"fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14,6))\nsns.regplot(ax=ax1, x='Domestic credit to private sector by banks (% of GDP)', y='log GDP per worker', data=data, color = 'salmon')\nsns.histplot(data['Domestic credit to private sector by banks (% of GDP)'], ax=ax2, color='salmon')\nplt.show()","abf3f1fa":"print('Pearson-r and P-Value: ' + str(pearsonr(data['Domestic credit to private sector by banks (% of GDP)'], data['log GDP per worker'])))","457db091":"fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14,6))\nsns.regplot(ax=ax1, x='Fixed broadband subscriptions (per 100 people)', y='log GDP per worker', data=data, color = 'salmon')\nsns.histplot(data['Fixed broadband subscriptions (per 100 people)'], ax=ax2, color='salmon')\nplt.show()","5230ad27":"print('Pearson-r and P-Value: ' + str(pearsonr(data['Fixed broadband subscriptions (per 100 people)'], data['log GDP per worker'])))","d7a8c1de":"fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14,6))\nsns.regplot(ax=ax1, x='Age dependency ratio, old (% of working-age population)', y='log GDP per worker', data=data, color = 'salmon')\nsns.histplot(data['Age dependency ratio, old (% of working-age population)'], ax=ax2, color='salmon')\nplt.show()","3e1b95ce":"print('Pearson-r and P-Value: ' + str(pearsonr(data['Age dependency ratio, old (% of working-age population)'], data['log GDP per worker'])))","defaf421":"fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14,6))\nsns.regplot(ax=ax1, x='Age dependency ratio, young (% of working-age population)', y='log GDP per worker', data=data, color = 'salmon')\nsns.histplot(data['Age dependency ratio, young (% of working-age population)'], ax=ax2, color='salmon')\nplt.show()","ff887a0c":"print('Pearson-r and P-Value: ' + str(pearsonr(data['Age dependency ratio, young (% of working-age population)'], data['log GDP per worker'])))","17ff1245":"fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14,6))\nsns.regplot(ax=ax1, x='Unemployment, total (% of total labor force) (modeled ILO estimate)', y='log GDP per worker', data=data, color = 'salmon')\nsns.histplot(data['Unemployment, total (% of total labor force) (modeled ILO estimate)'], ax=ax2, color='salmon')\nplt.show()","d110ad06":"print('Pearson-r and P-Value: ' + str(pearsonr(data['Unemployment, total (% of total labor force) (modeled ILO estimate)'], data['log GDP per worker'])))","89c93106":"fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14,6))\nsns.regplot(ax=ax1, x='Final consumption expenditure (% of GDP)', y='log GDP per worker', data=data, color = 'salmon')\nsns.histplot(data['Final consumption expenditure (% of GDP)'], ax=ax2, color='salmon')\nplt.show()","7d41e89a":"print('Pearson-r and P-Value: ' + str(pearsonr(data['Final consumption expenditure (% of GDP)'], data['log GDP per worker'])))","9ec64415":"data.corr().style.background_gradient(cmap='coolwarm')","b2fa5041":"X = data.drop(['country'], axis = 1)\ny = X.pop('log GDP per worker')\n\n# columns for model 2\nmodel2_l = ['const','Urban population (%)', 'Domestic credit to private sector by banks (% of GDP)', \n            'Fixed broadband subscriptions (per 100 people)', 'Final consumption expenditure (% of GDP)',\n            'Age dependency ratio, young (% of working-age population)', 'Unemployment, total (% of total labor force) (modeled ILO estimate)']\n\n# columns for model 3\nmodel3_l = ['const', 'Urban population (%)', 'Domestic credit to private sector by banks (% of GDP)', \n          'Age dependency ratio, old (% of working-age population)', 'Final consumption expenditure (% of GDP)',\n          'Age dependency ratio, young (% of working-age population)', 'Unemployment, total (% of total labor force) (modeled ILO estimate)']","d3d50303":"X_lin = sm.tools.add_constant(X)\nmodel1 = sm.OLS(y, X_lin.astype('float')).fit()\nmodel2 = sm.OLS(y, X_lin[model2_l].astype('float')).fit()\nmodel3 = sm.OLS(y, X_lin[model3_l].astype('float')).fit()","81c623a8":"def return_results(model, model_list):\n    return [model.pvalues[i] for i in model_list]\n\nresults = pd.DataFrame(index=X_lin.columns)\nresults['Model 1 Coeff.'] = pd.Series(model1.params)\nresults['Model 1 P-Values'] = pd.Series(return_results(model1, X_lin.columns), index = X_lin.columns)\nresults['Model 2 Coeff.'] = pd.Series(model2.params)\nresults['Model 2 P-Values'] = pd.Series(return_results(model2, model2_l), index = model2_l)\nresults['Model 3 Coeff.'] = pd.Series(model3.params)\nresults['Model 3 P-Values'] = pd.Series(return_results(model3, model3_l), index = model3_l)\nresults = results.fillna('---')","b2dca9b6":"results","270f69fd":"loo = LeaveOneOut()\nm1_score = []\nm2_score = []\nm3_score = []\nfor train_index, test_index in loo.split(X_lin, gdp_per_worker[X_lin.index]):\n    X_train, X_test = X_lin.iloc[train_index], X_lin.iloc[test_index]\n    y_train, y_test = gdp_per_worker.iloc[train_index], gdp_per_worker.iloc[test_index]\n    model1 = sm.OLS(list(y_train), X_train.astype('float')).fit()\n    model2 = sm.OLS(list(y_train), X_train[model2_l].astype('float')).fit()\n    model3 = sm.OLS(list(y_train), X_train[model3_l].astype('float')).fit()\n    m1_score.append(np.sqrt(sklm.mean_squared_error(y_test, model1.predict(X_test.astype('float')))))\n    m2_score.append(np.sqrt(sklm.mean_squared_error(y_test, model2.predict(X_test[model2_l].astype('float')))))\n    m3_score.append(np.sqrt(sklm.mean_squared_error(y_test, model3.predict(X_test[model3_l].astype('float')))))","2a005ad5":"print('GDP per worker std.:        ' + str(np.std(gdp_per_worker[X_lin.index])))\nprint('Model 1 LOOCV Error (RMSE): ' + str(np.mean(m1_score)))\nprint('Model 2 LOOCV Error (RMSE): ' + str(np.mean(m2_score)))\nprint('Model 3 LOOCV Error (RMSE): ' + str(np.mean(m3_score)))","190617ed":"This feature describes the amount of financial resources provided to the private sector by banks realtive to the GDP.","8f2d2770":"# GDP per Worker","294b5807":"GDP per capita is a useful measurement when we want to assess a country\u2019s wealth. However I wanted to identify predictors for a country\u2019s productivity. A better measurement would be in this case GDP per worker as it only takes the working population into account. The ideal measurement would be GDP per hours worked, but this dataset doesn\u2019t include the necessary information to construct this feature and GDP per worker is also already sufficient.","ad09290c":"# Final consumption expenditure (% of GDP)","b63be35a":"The feature 'Urban population (%)' describes what percantage of the population lives in cities.","5e64acb2":"# Age dependency ratio, young (% of working-age population)","b311a004":"# Preprocessing","834932fa":"# Age dependency ratio, old (% of working-age population)","9e629cc2":"# Unemployment, total (% of total labor force) (modeled ILO estimate)","fc4d3f0e":"# Fixed broadband subscriptions (per 100 people)","af122fb1":"# Domestic credit to private sector by banks (% of GDP)","6b00163f":"Number of people who are younger than 15 in relation to the number of people between 15 and 64.","a18cbdea":"There is a strong correlation between \"Age dependency ratio, old (% of working-age population)\" and \"Fixed broadband subscriptions (per 100 people)\" as the pearson correlation coefficient is 0.897830. This may cause issues when interpreting the regression model. I try to work around this issue by building 3 models. The first one will take all features into account, for the second model I will leave \"Age dependency ratio, old (% of working-age population)\" out and model three won't include \"Fixed broadband subscriptions (per 100 people)\".","1e96e777":"Unemployment estimate modeled by the Iternational Labor Organization.","6b7b5e36":"# Regression Analyisis","39391d60":"# Urban Population","28131a0b":"Number of people who are older than 64 in relation to the number of people between 15 and 64.","3c109f05":"Final household and government consumption expenditure relative to the GDP.","5e1637a9":"I only considered features with less than 10 missing values. I filled the rest of the missing values with the last available data from https:\/\/data.worldbank.org\/. The values for Canada and Ethiopia for the feature 'Domestic credit to private sector by banks (% of GDP)' are by far the oldest. They're from 2008.","d41a56cc":"The coefficient for \"Urban population (%)\" is positve and the effect is significant in all three models. The effect of \"Domestic credit to private sector by banks (% of GDP)\" isn't significant in any of the models. \"Fixed broadband subscriptions (per 100 people)\" was only included in model 1 and 2 and the effect is postive and significant in both of them. \"Age dependency ratio, old (% of working-age population)\" has a significant positive effect in model 1 and model 3, whereas \"Age dependency ratio, young (% of working-age population)\" doesn't have a significant effect in any model. The same can be said for \"Unemployment, total (% of total labor force) (modeled ILO estimate)\". However the \"Final consumption expenditure (% of GDP)\" shows a negative and highly significant effect in all models. The lacking significance of some of the variables can be caused by multicolinearity, especially with regards to \"Age dependency, young\".\n\nFinally we will have a look at how well each model predicts a country's GDP per worker. The small sample size isn't ideal for building a predictive model but it allows for Leave-one-out-cross-validation, which would be very time consuming for large datasets.","c07e35db":"Subscriptions for high-speed access to the public internet."}}