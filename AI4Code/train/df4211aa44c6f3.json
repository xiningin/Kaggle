{"cell_type":{"f2754da9":"code","ec950e63":"code","4bb4ecf2":"markdown"},"source":{"f2754da9":"import pandas as pd\nfrom IPython.display import Image\nimport json\nimport os\nfrom tqdm import tqdm","ec950e63":"d = pd.read_csv('..\/input\/global-wheat-detection\/train.csv')\nd['image_id'].unique()[0]\nfor image_id in tqdm(list(d['image_id'].unique())):\n    shapes = []\n    for _, row in d[d['image_id']==image_id].iterrows():\n        x, y, w, h = json.loads(row['bbox'])\n        shapes.append({\n          \"label\": \"wheat\",\n          \"points\": [[x, y], [x+w, y+h]],\n          \"group_id\": None,\n          \"shape_type\": \"rectangle\",\n          \"flags\": {}\n        })\n    img_filename = \"{}.jpg\".format(image_id)\n    labelme = json.dumps({\n      \"version\": \"4.0.0\",\n      \"flags\": {},\n      \"shapes\": shapes,\n      \"imagePath\": img_filename,\n      \"imageData\": None,\n      \"imageHeight\": 1024,\n      \"imageWidth\": 1024\n    }, indent=2)\n    annot_filename = \"labelme\/{}.json\".format(image_id)\n    os.makedirs(os.path.dirname(annot_filename), exist_ok=True)\n    with open(annot_filename, \"w\") as f:\n        f.write(labelme)","4bb4ecf2":"Convert [Global Wheat Detection DS](https:\/\/www.kaggle.com\/c\/global-wheat-detection) the train.csv to per image [labelme json files](https:\/\/github.com\/wkentaro\/labelme\/tree\/master\/examples\/bbox_detection)"}}