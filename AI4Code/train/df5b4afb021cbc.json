{"cell_type":{"e40ef277":"code","1bfb46cf":"code","d4d4f2e7":"code","fb3d0986":"code","c45d04d3":"code","8bd3d8b7":"code","d5e6bad3":"code","10f0fa0c":"code","dd0348f6":"code","d12f67b3":"code","2f91481c":"code","3ff67c8b":"code","087e03fc":"code","a14e4ef8":"code","cff8a019":"code","6499a1d1":"code","75a116e3":"code","3d4a6f6e":"code","96fa712e":"code","eb8c570e":"code","5262d295":"code","84111860":"code","b063ec58":"code","0455eaaa":"code","2375c63b":"code","5cac4044":"code","adfc989e":"code","94217d55":"code","f5085ffc":"code","f23f9c1f":"code","2ab677a2":"code","1d874a6e":"code","96d9058c":"code","8e913ed3":"code","e00efca4":"code","c8363122":"code","63de93fb":"code","f83c7e0a":"code","e31f6c83":"code","70389a15":"code","fb15ae14":"code","8507772e":"code","61b6b99a":"code","85e5f403":"code","cb346242":"code","bc4ecbf7":"code","7cbe3806":"code","1e34791e":"code","7ed617eb":"markdown","63ebdf66":"markdown","3068be39":"markdown","e3314949":"markdown","7b804c21":"markdown","ef5270ef":"markdown","45a63e4c":"markdown","c79caa68":"markdown","36213b07":"markdown","269886d7":"markdown","2480ce0c":"markdown","9f5fd45d":"markdown","ecbf51bd":"markdown","4d180aa2":"markdown","a57d45e5":"markdown","e6140bdb":"markdown","5103f51a":"markdown","6e3ac1fa":"markdown","67ab25ba":"markdown","316c462a":"markdown","55e96f63":"markdown","c2910f9b":"markdown","c1526131":"markdown","ba3315a1":"markdown","05c1e7e8":"markdown","687ddf38":"markdown","c8661192":"markdown","1f7b8613":"markdown","da63c45c":"markdown","b582a2ee":"markdown","9bd085ff":"markdown","76940d78":"markdown","c3a94e3c":"markdown","e628375e":"markdown","2fe617c8":"markdown","3fc25547":"markdown","c10822cb":"markdown","bb0b3c5f":"markdown"},"source":{"e40ef277":"import kaggle\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport json\n%matplotlib inline","1bfb46cf":"sns.set_style(\"darkgrid\")\nsns.set_context(\"paper\",font_scale=1)\nplt.rcParams['figure.figsize'] = (10, 10)","d4d4f2e7":"data = pd.read_csv(\"..\/input\/USvideos.csv\")","fb3d0986":"data.head()","c45d04d3":"# Infomation about the data\ndata.info()","8bd3d8b7":"# Unique objects?\n\ndata[\"video_id\"].nunique()","d5e6bad3":"type(data[\"trending_date\"][0])","10f0fa0c":"data[\"trending_date\"] = pd.to_datetime(data[\"trending_date\"],format=\"%y.%d.%m\")\ndata[\"trending_date\"].head()","dd0348f6":"type(data[\"publish_time\"][0])","d12f67b3":"data[\"publish_time\"] = pd.to_datetime(data[\"publish_time\"],format=\"%Y-%m-%dT%H:%M:%S.%fZ\")\ndata[\"publish_time\"].head()","2f91481c":"# Separate date from time for publish\n\ndata[\"publish_date\"] = pd.DatetimeIndex(data[\"publish_time\"]).date\ndata[\"publish_date\"] = pd.to_datetime(data[\"publish_date\"],format=\"%Y-%m-%d\")\ndata[\"publish_date\"].head()","3ff67c8b":"data[\"publish_time_of_day\"] = pd.DatetimeIndex(data[\"publish_time\"]).time\ndata[\"publish_time_of_day\"].head()","087e03fc":"# Hour published\ndata[\"publish_hour\"] = data[\"publish_time_of_day\"].apply(lambda x: x.hour)","a14e4ef8":"data[\"publish_hour\"].head()","cff8a019":"# Add column of days between published and trended\n\n# How about just videos that trended the day of\/after they were published\n\n# Pull days trended for each\n# Remember, can be zero, if it trends on the day it was published\ndata[\"days_trended_after_publish\"] = data[\"trending_date\"] - data[\"publish_date\"]","6499a1d1":"# Change days_trended_after_publish to an integer\ndata[\"days_trended_after_publish\"] = data[\"days_trended_after_publish\"].dt.days","75a116e3":"# Add column with sum of total days trended per video\ntrended_count = data.groupby(\"video_id\").count()[\"days_trended_after_publish\"].reset_index()\ntrended_count.columns = [\"video_id\",\"trended_count\"]","3d4a6f6e":"data = data.merge(trended_count,on=\"video_id\")","96fa712e":"# Pull category ID data\n\nid_to_category = {}\n\nwith open(\"..\/input\/US_category_id.json\",\"r\") as f:\n    id_data = json.load(f)\n    for category in id_data[\"items\"]:\n        id_to_category[category[\"id\"]] = category[\"snippet\"][\"title\"]\n\nid_to_category","eb8c570e":"type(data[\"category_id\"][0])","5262d295":"data[\"category_id\"] = data[\"category_id\"].astype(str)","84111860":"# Map that data onto the dataset\ndata.insert(4, \"category\",data[\"category_id\"].map(id_to_category))","b063ec58":"# Ok, let's check out the data with the changes we made\ndata[data[\"video_id\"] == \"2kyS6SvSYSE\"]","0455eaaa":"sns.heatmap(data.corr(),cmap=\"Blues\",annot=True)\n# Note, this might not be a good proxy of much, since some videos are in the dataset multiple times","2375c63b":"# Correlation matrix for only videos on the last day trended\nsns.heatmap(data[data[\"trended_count\"] == data[\"days_trended_after_publish\"]].corr(),cmap=\"Blues\",annot=True)","5cac4044":"# Sum of views per video by hour published\nsns.barplot(data = data[data[\"trended_count\"] == data[\"days_trended_after_publish\"]].groupby(\"publish_hour\").sum()[\"views\"].reset_index(),x=\"publish_hour\",y=\"views\",palette=\"coolwarm\")","adfc989e":"# Total days trended by hour published\nsns.barplot(x=\"publish_hour\",y=\"trended_count\",data=data[data[\"trended_count\"] == data[\"days_trended_after_publish\"]].groupby(\"publish_hour\").sum()[\"trended_count\"].reset_index(),palette=\"coolwarm\")","94217d55":"sns.barplot(data=data[data[\"trended_count\"] == data[\"days_trended_after_publish\"]].groupby(\"publish_hour\").mean()[\"trended_count\"].reset_index(),\n            x=\"publish_hour\",y=\"trended_count\",palette=\"coolwarm\")","f5085ffc":"sns.boxplot(data=data[data[\"trended_count\"] == data[\"days_trended_after_publish\"]],\n            x=\"publish_hour\",y=\"trended_count\",palette=\"coolwarm\")","f23f9c1f":"# Add column for day of week that each video was published\ndata[\"publish_day\"] = data[\"publish_date\"].apply(lambda x: x.strftime('%A'))","2ab677a2":"sns.barplot(data=data.groupby(\"publish_day\").sum()[\"trended_count\"].sort_values(ascending=False).reset_index(),x=\"publish_day\",y=\"trended_count\",palette=\"coolwarm\")","1d874a6e":"sns.barplot(data=data.groupby(\"publish_day\").mean()[\"trended_count\"].sort_values(ascending=False).reset_index(),x=\"publish_day\",y=\"trended_count\",palette=\"coolwarm\")","96d9058c":"# Unique videos\nunique_videos = data[data[\"trended_count\"] == data[\"days_trended_after_publish\"]].groupby(\"channel_title\").nunique()[\"video_id\"].reset_index()\nunique_videos.sort_values(by=\"video_id\",ascending=False).head()","8e913ed3":"# Total days between first and last published date\nlast_published = data[data[\"trended_count\"] == data[\"days_trended_after_publish\"]].groupby(\"channel_title\").max()[\"publish_date\"].reset_index()\nlast_published.head()","e00efca4":"first_published = data[data[\"trended_count\"] == data[\"days_trended_after_publish\"]].groupby(\"channel_title\").min()[\"publish_date\"].reset_index()\nfirst_published.head()","c8363122":"consistency = first_published.merge(last_published,on=\"channel_title\")\nconsistency.columns = [\"channel_title\",\"first_published\",\"last_published\"]\nconsistency[\"total_days\"] = consistency[\"last_published\"] - consistency[\"first_published\"]\nconsistency[\"total_days\"] = consistency[\"total_days\"].dt.days\nconsistency = consistency.merge(unique_videos,on=\"channel_title\")\nconsistency[\"average_days_between_videos\"] = consistency[\"total_days\"]\/consistency[\"video_id\"]","63de93fb":"consistency = consistency.merge(data[[\"video_id\",\"channel_title\",\"trended_count\"]].drop_duplicates().groupby(by=\"channel_title\").sum()[\"trended_count\"].reset_index(),on=\"channel_title\")\nconsistency.head()","f83c7e0a":"sns.lmplot(data=consistency,x=\"average_days_between_videos\",y=\"trended_count\")","e31f6c83":"x=5\nsns.lmplot(data=consistency[consistency[\"video_id\"] >=x],x=\"average_days_between_videos\",y=\"trended_count\")","70389a15":"consistency[\"average_days_trended\"] = consistency[\"trended_count\"]\/consistency[\"video_id\"]\nconsistency.head()","fb15ae14":"sns.lmplot(data=consistency,x=\"average_days_between_videos\",y=\"average_days_trended\")","8507772e":"sns.lmplot(data=consistency[consistency[\"video_id\"] >=2],x=\"average_days_between_videos\",y=\"average_days_trended\")","61b6b99a":"data[\"likes-to-dislikes\"] = data[\"likes\"]\/data[\"dislikes\"]","85e5f403":"sns.heatmap(data[[\"views\",\"likes\",\"dislikes\",\"comment_count\",\"likes-to-dislikes\",\"trended_count\"]].corr(),cmap=\"Blues\",annot=True)","cb346242":"# Note: correlations taking into account only the last day a video trended doesn't do much to correlations\nsns.heatmap(data[data[\"days_trended_after_publish\"] == data[\"trended_count\"]].corr(),cmap=\"Blues\",annot=True)","bc4ecbf7":"sns.barplot(data=data.groupby(\"category\").count()[\"views\"].reset_index().sort_values(by=\"views\",ascending=False),x=\"views\",y=\"category\",palette=\"coolwarm\")","7cbe3806":"sns.barplot(data=data[data[\"trended_count\"] == data[\"days_trended_after_publish\"]].groupby(by=\"category\").sum()[\"trended_count\"].reset_index().sort_values(by=\"trended_count\",ascending=False),y=\"category\",x=\"trended_count\",palette=\"coolwarm\")","1e34791e":"sns.barplot(data=data[data[\"trended_count\"] == data[\"days_trended_after_publish\"]].groupby(by=\"category\").mean()[\"trended_count\"].reset_index().sort_values(by=\"trended_count\",ascending=True),x=\"trended_count\",y=\"category\",palette=\"coolwarm\")","7ed617eb":"Are videos in some categories more likely to trend? Are they likely to trend for longer than videos in other categories?","63ebdf66":"I limited the output to videos with at least two videos published (otherwise, there is a giant clump of one-off videos skewing the data).","3068be39":"## A quick look at correlations between video metrics (more on this later)","e3314949":"Total trended days by category","7b804c21":"What is the best measure of quality?\n\nBased on our correlation matrix above, likes had the highest correlation to views.\n\nLet's try likes-to-dislikes - Is there a relationship between the like-to-dislike ratio and views?","ef5270ef":"But the reults are interesting. This suggests that the longer between videos, the more days a video trends on average.","45a63e4c":"# Relationship between time published and views, days trended","c79caa68":"# Measuring quality of videos","36213b07":"In all, this suggests two things:\n\n* First, you can cannibalize your own videos. The channels that post every two or three days trend for fewer days on average, because that channel's new videos replace the old ones. Fewer days trended on average, BUT in total, you trend for more days (as we saw in the average days between videos vs. total days trended chart).\n* Second, if a channel doesn't post that often, some other factor (quality of the video?) outweighs the consistency of posting.","269886d7":"### Process the dates - currently in strings","2480ce0c":"## Publish hour","9f5fd45d":"Need to go deeper than that - the number of views is probably impacted by outliers, like that 4am hour. How about days trended, rather than just views?","ecbf51bd":"# EDA","4d180aa2":"What about day of the week? Are videos that are published certain days of the week more likely to trend?","a57d45e5":"## How about day of the week? Does it matter what  day you publish?","e6140bdb":"That makes more sense. It probably doesn't matter when you publish.","5103f51a":"Total views:","6e3ac1fa":"### Takeaway: It probably doesn't matter what time or what day you publish, because it probably doesn't impact the number of days you trend","67ab25ba":"It looks like there might just be more videos published in the afternoon, so the total days trended is higher. How about we look at average days trended by publish hour?","316c462a":"Hmmm... The regression line is upward sloping, which suggests that longer intervals between videos means the total days trended is higher. But the data itself looks like the fewer days between videos published (the lower the average, the fewer days between videos published), the more total days trended","55e96f63":"We have heard though that the YouTube algorithm rewards consistency. If you publish more consistently, you are more likely to trend.","c2910f9b":"Is the fact that we're counting videos multiple times (if it trended multiple days) impacting the data?\nHow about correlations for only the last day a video trended?","c1526131":"Videos published on the weekends have the lowest trend count, by a lot. But what about days trended on average by day?","ba3315a1":"Ok, that doesn't make a huge difference in correlations. Good to know.","05c1e7e8":"# Question: Do YouTubers who post more often trend more days?","687ddf38":"That makes more sense. If you have fewer days between videos, the more likely you are to trend. But to make sure, let's normalize the data by taking the average days trended by average days between videos","c8661192":"Questions to answer:\n\n* When should I publish my video? If I publish at a certain time, am I more likely to trend?\n* Do users interact more with videos that are published at a certain time? Because we know that there's a high correlation of views\/comments to trending\n\n**Hyphothesis:** It doesn't matter. The correlations between publish hour and everything else is low.","1f7b8613":"# Introduction:\n\nHello, and thanks for browsing my EDA of US YouTube Data.\n\nHere are some questions we'll explore:\n\n* **Does it matter when you publish?** Relationship between time published and views\/days trended\n* **Do YouTubers who post more often trend more days?** Relationship between how often videos are published and days trended\n* **What qualities matter?** Correlations between some qualities of the data\n* **Are videos of certain categories more likely to trend, or do some types of videos trend longer?** Relationship between category of video and views\/days trended","da63c45c":"### Change category_id into a string first","b582a2ee":"This also doesn't look like there is enough variation to make a difference. That is, it probably doesn't matter what day you publish.","9bd085ff":"Let's strip out channels that had fewer than some number of videos.","76940d78":"That \"likes-to-dislikes\" ratio doesn't tell us much. Likes still seem to be the best predictor of views. But interestingly, trended count isn't really correlated to the quality metrics either. That suggests that the algorithm ","c3a94e3c":"I'm not convinced that is meaningful. Let's try to see something that strips out the outliers","e628375e":"Average days trended by category","2fe617c8":"# Cleaning and preparing the data","3fc25547":"There seems to be a lot of competition in \"Sports\" and \"News & Politics\" - those categories have a shorter trending shelf-life, probably because the algorithm rewards recency in those categories.","c10822cb":"# Videos by category","bb0b3c5f":"**Next step:** Run test to calculate statistical significance."}}