{"cell_type":{"1b2ba113":"code","9aea5516":"code","21095170":"code","4e2ed9c7":"code","5ef6c054":"code","a3600298":"markdown"},"source":{"1b2ba113":"import glob\nimport pyarrow\nimport numpy as np\nimport pandas as pd\nfrom tqdm import tqdm","9aea5516":"BASE = '..\/input\/optiver-realized-volatility-prediction'","21095170":"def ffill(data_df): \n    data_df=data_df.set_index(['time_id', 'seconds_in_bucket'])\n    data_df = data_df.reindex(pd.MultiIndex.from_product([data_df.index.levels[0], np.arange(0,600)], names = ['time_id', 'seconds_in_bucket']), method='ffill')\n    return data_df.reset_index()","4e2ed9c7":"!mkdir book_train_ffill.parquet","5ef6c054":"book_files = glob.glob(f'{BASE}\/book_train.parquet\/stock_id=*\/*.parquet')\n\nfor file in tqdm(book_files):\n    book_df = pd.read_parquet(file)\n    ffill_df = ffill(book_df)\n    \n    file_name = f'.\/book_train_ffill.parquet\/' + file.split('\/')[-2]\n    save_df = pyarrow.Table.from_pandas(ffill_df)\n    pyarrow.parquet.write_to_dataset(save_df, root_path=file_name)","a3600298":"Done with the functions discussed here\n\nhttps:\/\/www.kaggle.com\/c\/optiver-realized-volatility-prediction\/discussion\/251277"}}