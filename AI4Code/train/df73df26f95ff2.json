{"cell_type":{"02f34d98":"code","23a2701f":"code","b25ad787":"code","995e7173":"code","9fcc6c5e":"code","ea0e1e36":"code","4ea7c425":"code","f70797f1":"code","f62311ed":"code","5f63fc44":"code","4eb05241":"code","24754125":"code","2bb5e9f9":"code","74b66516":"code","83112929":"code","d7c54f41":"code","66911a6a":"code","7382b766":"code","54804e1e":"code","ee59eadc":"code","48071749":"code","98aa6b89":"code","aba948cd":"code","2fbd4805":"code","c8bc5713":"code","31f9f28d":"code","6cd25d92":"code","750787c8":"code","3ccb9e19":"code","a804bc6f":"code","48a4f0ff":"code","3b8d8703":"code","bb1a19fb":"code","b842c8b7":"code","0ecdbfa4":"code","47357482":"code","d58ba885":"code","54a063bc":"code","31e97365":"code","60514f6c":"code","660f8ead":"code","ac85373b":"code","4fe55264":"code","316705bd":"code","c54e1db1":"markdown","c309dcd8":"markdown","29aae219":"markdown","9013f162":"markdown","c54a05fd":"markdown","bcf4edc2":"markdown","7ee0f7ab":"markdown","c448720a":"markdown","cbe2b5bf":"markdown","71749162":"markdown","963c0dcb":"markdown","888fe897":"markdown","1cab5142":"markdown","08e01ab9":"markdown","1e386285":"markdown","752521e2":"markdown","fa01d495":"markdown","040ac48a":"markdown","2da0e242":"markdown","fad434c3":"markdown","8c379119":"markdown","cfd5347b":"markdown","f92732c1":"markdown","49a22ca1":"markdown","8356c72c":"markdown","d16a1504":"markdown","a19f0a4a":"markdown","31f2d35c":"markdown","c6fc69b8":"markdown","86042a81":"markdown","88ed8ba5":"markdown","d0a4feaa":"markdown","9161b6c2":"markdown","b5793db7":"markdown","d11e9f90":"markdown","233a7fdf":"markdown","a665aab7":"markdown","63a6dd27":"markdown"},"source":{"02f34d98":"!pip install pyforest","23a2701f":"from pyforest import *\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport os\nimport warnings\nwarnings.filterwarnings('ignore')","b25ad787":"data = pd.read_csv('..\/input\/insurance.csv')\ndata.head()","995e7173":"data.describe()","9fcc6c5e":"data.info()","ea0e1e36":"data.isnull().sum()","4ea7c425":"data.shape","f70797f1":"data.duplicated().sum() ","f62311ed":"data.sort_values(['age'])","5f63fc44":"data[data.region == 'southeast']","4eb05241":"data.mean()","24754125":"data.info(memory_usage='deep')","2bb5e9f9":"data.memory_usage(deep=True)","74b66516":"from sklearn.preprocessing import LabelEncoder\nle = LabelEncoder()\nle.fit(data.sex.drop_duplicates())\ndata.sex = le.transform(data.sex)\nle.fit(data.smoker.drop_duplicates())\ndata.smoker = le.transform(data.smoker)\nle.fit(data.region.drop_duplicates())\ndata.region = le.transform(data.region)","83112929":"data.memory_usage(deep=True)","d7c54f41":"f, ax = plt.subplots(figsize=(10,8))\ncorr = data.corr()\nsns.heatmap(corr, mask=np.zeros_like(corr, dtype=np.bool), cmap=sns.diverging_palette(240, 10, as_cmap=True), square=True, ax=ax)","66911a6a":"f = plt.figure(figsize=(12,5))\nax = f.add_subplot(121)\nsns.distplot(data[(data.smoker == 1)]['charges'], color='c', ax=ax)\nax.set_title('Distribution of charges for smokers')\n\nax = f.add_subplot(122)\nsns.distplot(data[(data.smoker == 0)]['charges'], color='b', ax=ax)\nax.set_title('Distribution of charges for non-smokers')","7382b766":"data.smoker.value_counts() #0 means non-smokers and 1 means smokers","54804e1e":"sns.countplot(x='smoker', hue='sex', palette='pink', data=data)","ee59eadc":"sns.catplot(x='sex', y='charges', kind='violin', hue='smoker', palette='magma', data=data)","48071749":"plt.figure(figsize=(12, 5))\nplt.title('Box plot for charges of women')\nsns.boxplot(x='smoker', y='charges', data=data[(data.sex == 1)])","98aa6b89":"plt.figure(figsize=(12, 5))\nplt.title('Box plot for charges of men')\nsns.boxplot(x='smoker', y='charges', data=data[(data.sex == 0)])","aba948cd":"plt.figure(figsize=(12, 5))\nplt.title('Distribution of Age')\nax = sns.distplot(data['age'], color='b')","2fbd4805":"pd.set_option('display.max_rows', None)","c8bc5713":"data","31f9f28d":"data.loc[(data.age == 18) & (data.smoker == 1)]","6cd25d92":"data.dtypes","750787c8":"data.charges.mean()","3ccb9e19":"data.charges.min()","a804bc6f":"data.charges.max()","48a4f0ff":"data.loc[(data.charges >= 13270) & (data.smoker == 1)]","3b8d8703":"data.loc[(data.charges == 63770.42801), :]","bb1a19fb":"data.loc[(data.sex == 0) & (data.smoker == 1)]","b842c8b7":"data.loc[(data.smoker == 1) & (data.region == 0)]","0ecdbfa4":"g = sns.jointplot(x = 'age', y = 'charges', data=data[(data.smoker == 0)], kind = 'kde', color='b')\ng.plot_joint(plt.scatter, c='w', s=30, linewidth=1, marker='+')\ng.ax_joint.collections[0].set_alpha(0)\ng.set_axis_labels('$X$', '$Y$')\nax.set_title('Distribution of charges and age for non-smokers')","47357482":"sns.lmplot(x='age',y='charges', hue='smoker', data=data, palette='inferno_r', size=7)\nplt.title('Smokers and Non-Smokers')","d58ba885":"plt.figure(figsize=(12,5))\nplt.title('Distribution of BMI')\nax = sns.distplot(data['bmi'], color = 'y')","54a063bc":"data.loc[(data.bmi <=18.5)]   #Here, <=18.5 means the person is under weight.","31e97365":"data[data.bmi >= 30]   #If the BMI exceeds the value of 30 means, person has obesity.","60514f6c":"data.loc[(data.bmi >= 30) & (data.age == 18)] ","660f8ead":"data.loc[(data.bmi <= 18.5) & (data.age == 18)] ","ac85373b":"from sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\n\nX = data.iloc[:,:6].values\ny = data.iloc[:,6].values\nX_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.25)\nregressor = LinearRegression()\nregressor.fit(X_train, y_train)\nprint(regressor.score(X_test, y_test))","4fe55264":"X1 = data.iloc[:,[0,1,2,3,4]].values\ny1 = data.iloc[:,6].values\nX_train, X_test,y_train, y_test = train_test_split(X1, y1, test_size=0.25)\nregressor = LinearRegression()\nregressor.fit(X_train, y_train)\nprint(regressor.score(X_test, y_test))","316705bd":"from sklearn.preprocessing import PolynomialFeatures\npoly_reg = PolynomialFeatures(degree=2)\nX_poly = poly_reg.fit_transform(X)\nX_train, X_test, y_train, y_test = train_test_split(X_poly, y, test_size=0.25)\nlin_reg = LinearRegression()\nlin_reg = lin_reg.fit(X_train, y_train)\nprint(lin_reg.score(X_test, y_test))","c54e1db1":"We can see the data of charges > than mean and one who smokes. ","c309dcd8":"Let's check which person of age 18 has obesity.","29aae219":"We will generate the countplot of smokers vs sex to see the number of smokers and non-smokers.","9013f162":"Let's have a look at the mean() of the data","c54a05fd":"So, let's have a look at the summary of our dataset.","bcf4edc2":"We should have a look at the duplicates","7ee0f7ab":"Applying machine learning algorithms to see the results.","c448720a":"Now, let's upload the downloaded csv file 'insurance.csv'","cbe2b5bf":"Let's see the children who are of 18 years and who smoke.","71749162":"Now, we should have a look at the total memory usage by all features  ","963c0dcb":"Linear plot for smokers and non-smokers.","888fe897":"Now, we shall have a look at the attributes data types, memory usage, null and non-null features,etc","1cab5142":"Let's look at the mean, minimum and maximum of the charges.","08e01ab9":"In addition, we can also get the data of smokers according to the particular region. ","1e386285":"Accordingly, we can also have a look at which attribute uses how much bytes ","752521e2":"Similarly, we can also generate the plot to see the charges of smokers and non-smokers.","fa01d495":"Now, we can have a look if the usage of memory has been decreased or not","040ac48a":"We will generate the boxplot of smokers and non-smokers vs the charges of men.","2da0e242":"Let's begin our project by importing the libraries","fad434c3":"It can be clearly observed that there has been some decline in the amount of memory usage. Now, let's generate heatmap to see the correlation between the features.","8c379119":"Distribution of BMI.","cfd5347b":"Suppose, we want to observe whole dataset, then we need to write the below code.","f92732c1":"By writing the above code, we will get the data of all the rows and columns.","49a22ca1":"Similarly, we can also get the output of person of age 18 who are underweight.","8356c72c":"We can also get the data about the sex who smokes. (male and female)","d16a1504":"Generating the plot of distribution of age.","a19f0a4a":"We will generate the boxplot of smokers and non-smokers vs the charges of women.","31f2d35c":"After observing, that there are no null values we should have a look at our dataset's shape","c6fc69b8":"Sorting the values of age attribute to see the min and max age. You can also try data.age.min() and data.age.max()","86042a81":"As we can see that the usage of memory is very high, we need to convert all the categorical columns into numeric by LabelEncoding.","88ed8ba5":"Check if there is any null data or not.","d0a4feaa":"Now, we can see that all the rows are in numeric.","9161b6c2":"We can also observe who has the maximum charge.","b5793db7":"Now, let's perform EDA by generating the plot of charges for smokers and non-smokers.","d11e9f90":"We can also have a look at the total number of smokers and non-smokers.","233a7fdf":"By generating joint plot we can see the charges distribution and age for smokers and non-smokers","a665aab7":"Let's see how many rows has southeast region. Accordingly, you can try with all regions.","63a6dd27":"Calculating the BMI of underweight persons."}}