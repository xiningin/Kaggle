{"cell_type":{"5cbf71a2":"code","a102e796":"code","a69c3674":"code","c224e0e9":"code","2fcc753f":"code","ead154e8":"code","97edb58a":"code","d08bbf28":"code","3bfcfad8":"code","ae24fcb6":"markdown","40f9fae4":"markdown","a3e0436e":"markdown","eaea56f0":"markdown","8ef5f07c":"markdown","4b40a408":"markdown"},"source":{"5cbf71a2":"import datatable as dt\nimport numpy as np\nimport pandas as pd\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import cross_val_score, RepeatedStratifiedKFold\nfrom sklearn.preprocessing import LabelBinarizer","a102e796":"# Use this line to install Intel's update to library if needed\n!pip install scikit-learn-intelex --progress-bar off >> \/tmp\/pip_sklearnex.log\n\nfrom sklearnex import patch_sklearn\npatch_sklearn()","a69c3674":"df = dt.fread('\/kaggle\/input\/tabular-playground-series-nov-2021\/train.csv').to_pandas()","c224e0e9":"y = df['target'] # Target vector\nX = df.drop(columns=['target'])\n\nlb = LabelBinarizer() # Need to turn target (true and false) into 1's and 0's\ny = np.ravel(lb.fit_transform(y)) # ravel makes y a 1d vector instead of a column vector","2fcc753f":"def evaluate_model(X, y, model):\n    cv_method = RepeatedStratifiedKFold(n_splits=5, n_repeats=2)\n    \n    scores = cross_val_score(model, X, y, scoring='roc_auc', cv=cv_method, error_score='raise')\n    return scores","ead154e8":"model_1 = RandomForestClassifier(n_estimators=500, max_samples=0.95, max_depth=5, n_jobs=-1)","97edb58a":"%%time\nscores_1 = evaluate_model(X, y, model_1)\nprint(\"Average Score: \", np.mean(scores_1))","d08bbf28":"model_1.fit(X, y)","3bfcfad8":"test_df = pd.read_csv('\/kaggle\/input\/tabular-playground-series-nov-2021\/test.csv')\npd.DataFrame({'id': test_df.id, 'target': model_1.predict_proba(test_df)[:,1]}).to_csv('submission.csv', index=False)","ae24fcb6":"### Making predictions and creating submission","40f9fae4":"## Data Handling","a3e0436e":"## November TPS - Random Forest Baseline","eaea56f0":"#### Cross Validation","8ef5f07c":"#### Add Intel patch to increase sklearn's speed\nThe dataset is large enough that this patch could increase the speed of the RandomForestClassifier.","4b40a408":"## Establish a Baseline with a Random Forest Classifier\n\nWe are choosing a classifier model since the targets for this dataset are True\/False values."}}