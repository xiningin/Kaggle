{"cell_type":{"362d3b97":"code","81a160d9":"code","c94ce3f9":"code","c49e4702":"code","88661ab4":"code","92608459":"code","43c8e9da":"code","f853f627":"code","94ca93b0":"code","38119dc5":"code","86e4cbc2":"code","e5c2496c":"code","af67037f":"code","cd2a217a":"code","aaa49d5b":"code","98bb512a":"code","2f87f068":"code","e232cc3a":"code","19d49f33":"code","a9d032be":"code","d9c07f02":"code","8f2b58cb":"code","f9a3966e":"code","aead90e6":"code","b0bf13fb":"code","fe67dbbd":"code","6469c510":"code","49be2abc":"code","623d5bca":"code","094c6dac":"code","662dd41b":"code","5163e5e1":"code","60800c64":"code","02574d72":"code","bc909674":"code","dfa5cb35":"code","792b6dba":"code","b31d7258":"code","f6b889b3":"code","be8bcfc7":"code","774fd436":"code","df60f1c5":"code","d7695109":"code","facc1e36":"code","a7cf2fee":"code","149caeac":"markdown"},"source":{"362d3b97":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","81a160d9":"train = pd.read_csv(\"\/kaggle\/input\/facebook-recruiting-iv-human-or-bot\/train.csv.zip\")\ntrain.head()","c94ce3f9":"test = pd.read_csv(\"\/kaggle\/input\/facebook-recruiting-iv-human-or-bot\/test.csv.zip\")\ntest.head()","c49e4702":"bids = pd.read_csv(\"\/kaggle\/input\/facebook-recruiting-iv-human-or-bot\/bids.csv.zip\")","88661ab4":"bids.head(50)","92608459":"bids.sort_values(by='bidder_id' ,ascending = True)","43c8e9da":"bids[\"bidder_id\"].value_counts()","f853f627":"alldata = pd.concat([train,test])\nalldata.shape","94ca93b0":"alldata[\"payment_account\"] = alldata[\"payment_account\"].apply(lambda x:x[:5])","38119dc5":"alldata.head()","86e4cbc2":"alldata[\"payment_account\"].value_counts()","e5c2496c":"alldata[\"address\"].sort_values().head(30)","af67037f":"alldata[\"address\"] = alldata[\"address\"].apply(lambda x:x[:5])","cd2a217a":"alldata.head()","aaa49d5b":"alldata[\"address\"].value_counts()","98bb512a":"x = bids.groupby(\"bidder_id\")[\"bid_id\"].count().reset_index()  # bidder_id\ub97c \uae30\uc900\uc73c\ub85c bid_id\uac00 \uba87\ubc88 \ub098\uc654\ub294\uc9c0 \uce74\uc6b4\ud2b8\nx","2f87f068":"alldata = alldata.merge(x,on = \"bidder_id\",how = \"left\")","e232cc3a":"alldata","19d49f33":"alldata[\"bid_id\"] = alldata[\"bid_id\"].fillna(0)\nalldata","a9d032be":"alldata.isna().sum()","d9c07f02":"alldata3 = alldata[alldata[\"bid_id\"]<20000]","8f2b58cb":"import matplotlib.pyplot as plt\nimport seaborn as sns\n\nplt.figure(figsize = (20,12))\nsns.boxplot(alldata3[\"outcome\"],alldata3[\"bid_id\"])","f9a3966e":"plt.figure(figsize = (20,12))\nsns.boxplot(alldata3[\"outcome\"],alldata3[\"device\"])","aead90e6":"n_unique = bids.groupby(\"bidder_id\")[\"auction\",\"device\",\"country\"].nunique().reset_index()","b0bf13fb":"alldata = alldata.merge(n_unique,on = \"bidder_id\",how = \"left\")\nalldata.head()","fe67dbbd":"from sklearn.preprocessing import LabelEncoder\nle = LabelEncoder()\nalldata[\"payment_account\"] = le.fit_transform(alldata[\"payment_account\"])","6469c510":"alldata.head()","49be2abc":"alldata[\"address\"] = le.fit_transform(alldata[\"address\"])","623d5bca":"alldata.head()","094c6dac":"from datetime import datetime\nbids[\"datetime\"] = bids[\"time\"].apply(lambda x: datetime.fromtimestamp(x\/7000000))","662dd41b":"bids[\"year\"] = bids[\"datetime\"].dt.year\nbids[\"month\"] = bids[\"datetime\"].dt.month\nbids[\"day\"] = bids[\"datetime\"].dt.day","5163e5e1":"year_mean = bids.groupby(\"bidder_id\")[\"year\"].mean().reset_index()\nmonth_mean = bids.groupby(\"bidder_id\")[\"month\"].mean().reset_index()\nday = bids.groupby(\"bidder_id\")[\"day\"].mean().reset_index()","60800c64":"alldata = alldata.merge(year_mean, on = \"bidder_id\", how = \"left\")\nalldata = alldata.merge(month_mean, on = \"bidder_id\", how = \"left\")\nalldata = alldata.merge(day, on = \"bidder_id\", how = \"left\")\nalldata.head()","02574d72":"time_diff = bids.groupby(\"bidder_id\")[\"time\"].apply(lambda x : x.max() - x.min()).reset_index()\nalldata = alldata.merge(time_diff, on = \"bidder_id\",how = \"left\")\nalldata.head()","bc909674":"alldata[\"time\"] = alldata[\"time\"]\/alldata[\"bid_id\"]","dfa5cb35":"alldata2 = alldata.drop([\"bidder_id\",\"outcome\"],axis = 1)","792b6dba":"alldata2.head()","b31d7258":"alldata2 = alldata2.fillna(-1)\n","f6b889b3":"train2 = alldata2[:len(train)]\ntrain2.shape","be8bcfc7":"test2 = alldata2[len(train):]\ntest2.shape","774fd436":"from sklearn.ensemble import RandomForestClassifier\nrf = RandomForestClassifier(n_estimators = 170, max_depth = 7)      # n_estimators : \ud2b8\ub9ac\uc758 \uac2f\uc218 \uc9c0\uc815\nrf.fit(train2,train[\"outcome\"])                       # train2 \ub370\uc774\ud130\uc5d0\uc11c count\uc5f4\uc744 \uae30\uc900\uc73c\ub85c \ubaa8\ub378 \ud559\uc2b5  \nresult = rf.predict_proba(test2)          ","df60f1c5":"result = result[:,1]","d7695109":"train[\"outcome\"].value_counts()","facc1e36":"sub = pd.read_csv(\"\/kaggle\/input\/facebook-recruiting-iv-human-or-bot\/sampleSubmission.csv\")\nsub.head()","a7cf2fee":"sub[\"prediction\"] = result\nsub.to_csv(\"sub.csv\",index = False)","149caeac":"# Data import"}}