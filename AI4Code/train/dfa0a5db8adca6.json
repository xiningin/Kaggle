{"cell_type":{"d84879bb":"code","5b79dfb7":"code","05820c22":"code","b7a67c19":"code","8099833a":"code","6ceb3be3":"code","46579426":"code","1e543746":"code","4f6b1fe2":"code","c7034fd2":"code","f8d67859":"code","4b20e947":"code","e7ea9243":"code","48017ae7":"code","ead996d0":"markdown","28e89406":"markdown","ecee46e0":"markdown","bd6d88d7":"markdown","759b1438":"markdown","30dffd9f":"markdown","c09aa2aa":"markdown","03e8c648":"markdown","4fe2b135":"markdown","a6fedbe0":"markdown","5afa283b":"markdown","79580cbf":"markdown","3ddec4d0":"markdown","c3f9343c":"markdown"},"source":{"d84879bb":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport plotly as py\nimport plotly_express as px\nimport plotly.graph_objects as go\nfrom matplotlib import pyplot as plt\nimport folium\nfrom folium import plugins\nfrom plotly.offline import init_notebook_mode, iplot\ninit_notebook_mode()\n\nxls = pd.ExcelFile(\"\/kaggle\/input\/civilian-complaints-against-nyc-police-officers\/CCRB Data Layout Table.xlsx\")\ndf_command = pd.read_excel(xls, 'Command Abbrevs')\ndf_disposition = pd.read_excel(xls, 'Dispositions')\ndf_fado = pd.read_excel(xls, 'FADO')\ndf_layout = pd.read_excel(xls, 'Layout')\ndf_rank = pd.read_excel(xls, 'Rank Abbrevs')\n\ndf = pd.read_csv(\"\/kaggle\/input\/civilian-complaints-against-nyc-police-officers\/allegations_202007271729.csv\")\n\n","5b79dfb7":"df","05820c22":"df_layout","b7a67c19":"df.info()","8099833a":"df_disposition","6ceb3be3":"df.board_disposition.unique()","46579426":"df_fado.sample(n=20)","1e543746":"df_command","4f6b1fe2":"df_rank","c7034fd2":"df_year = pd.DataFrame(df.year_received.value_counts()).reset_index()\ndf_year.rename(columns = {'index':'year', 'year_received':'number of civilian complaints'}, inplace=True)\ndf_year.sort_values(by = ['year'], inplace=True)\n\nfig = px.scatter(df_year, x='year', y='number of civilian complaints')\nfig.show()\n\ndf['day_received'] = 15\ndf['date_received'] = pd.to_datetime((df.year_received*10000+df.month_received*100+df.day_received).apply(str),format='%Y%m%d')\ndf_month = pd.DataFrame(df.date_received.value_counts()).reset_index()\ndf_month.rename(columns = {'index':'month', 'date_received':'number of civilian complaints'}, inplace=True)\ndf_month.sort_values(by = ['month'], inplace=True)\n\nfig = px.scatter(df_month, x='month', y='number of civilian complaints')\nfig.show()\n","f8d67859":"df_recent = df[(df.year_received >= 2008) & (df.year_received < 2020)]","4b20e947":"df_year = pd.DataFrame(df_recent.year_received.value_counts()).reset_index()\ndf_year.rename(columns = {'index':'year', 'year_received':'number of civilian complaints'}, inplace=True)\ndf_year.sort_values(by = ['year'], inplace=True)\n\nfig = px.scatter(df_year, x='year', y='number of civilian complaints')\nfig.show()\n\ndf_month = pd.DataFrame(df_recent.date_received.value_counts()).reset_index()\ndf_month.rename(columns = {'index':'month', 'date_received':'number of civilian complaints'}, inplace=True)\ndf_month.sort_values(by = ['month'], inplace=True)\n\nfig = px.scatter(df_month, x='month', y='number of civilian complaints')\nfig.show()","e7ea9243":"import calendar\n\ndf_month = pd.DataFrame(df_recent.month_received.value_counts()).reset_index().rename(columns={'index':'month', 'month_received':'number of civilian complaints'})\ndf_month.sort_values(by=['month'], inplace=True)\ndf_month['month'] = df_month['month'].apply(lambda x: calendar.month_abbr[x])\nfig = px.bar(df_month, x = 'month', y = 'number of civilian complaints', color='number of civilian complaints', hover_name = 'month')\nfig.update_layout(xaxis_title='')\nfig.update_layout(coloraxis_colorbar=dict(\n    title=\"\"\n))\nfig.show()","48017ae7":"def strip_specific(text):\n    if '(' in text:\n        text, _ = text.split('(')\n        text = text.strip()\n    return text\n\ndf_recent['board_disposition_general'] = df_recent['board_disposition'].apply(lambda x: strip_specific(x))\n\ndf_board_result = pd.DataFrame(df_recent.groupby(['year_received', 'board_disposition_general']).size()).reset_index()\ndf_board_result.rename(columns={'year_received':'year', 'board_disposition_general':'board_disposition', 0:'number of civilian complaints'}, inplace=True)\n\nfig = px.bar(df_board_result, x='year', y='number of civilian complaints', color='board_disposition')\nfig.show()\n\nfor i in range(df_board_result.shape[0]):\n    year = df_board_result.loc[i, 'year']\n    num = df_board_result.loc[i, 'number of civilian complaints']\n    tot = df_board_result[df_board_result['year'] == year]['number of civilian complaints'].sum()\n    df_board_result.loc[i, 'percentage of civilian complaints'] = num\/tot\n\nfig = px.line(df_board_result, x='year', y ='percentage of civilian complaints', color='board_disposition')\n\nfig.add_trace(px.scatter(df_board_result, x ='year', y='percentage of civilian complaints', color='board_disposition').data[0])\nfig.add_trace(px.scatter(df_board_result, x ='year', y='percentage of civilian complaints', color='board_disposition').data[1])\nfig.add_trace(px.scatter(df_board_result, x ='year', y='percentage of civilian complaints', color='board_disposition').data[2])\nfig['data'][0]['showlegend']=False\nfig['data'][1]['showlegend']=False\nfig['data'][2]['showlegend']=False\nfig.layout.yaxis.tickformat = ',.0%' \nfig.show()\n\n","ead996d0":"Let's take a look at the number of complaints recieved over the years.","28e89406":"So, df_layout clarifies a few things that are not self-evident in the allegations data:\n1. mos stands for \"Member of Service\" and refers to the officer, not the complainant\n2. FADO (which stands for Force, Abuse of Authority, Discourtesy, and Offensive Language, collectively known as \u201cFADO\u201d) refers to the content of the complaint\n3. board_disposition refers to the findings by the CCRB, which is the Civilian Complaint Review Board (CCRB), an independent municipal agency that investigates complaints of NYPD misconduct\n\n","ecee46e0":"![](https:\/\/images.unsplash.com\/photo-1591103797093-b4dd75d4b547?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80)\n\nProtests against police brutality and racially motivated violence towards African-American people have swept United States and the rest of the world. Communities have risen up to take a stand against such gross and pervasive injustice; an injustice that is codified into the very DNA of the policing system. As such, many protestors are calling to defund the police and redefine law enforcement as we know it. Although as data scientists we are used to dealing with numbers and unicode characters, it is important to acknowledge the magnitude of this data; each data point is a person who has, against all odds, stood up for their rights and the rights of their community.\n\nFurthermore, it is incumbent upon us to be aware of and take active steps to rectify the explicit and implicit racism that pervades our country and world. Black Lives Matter.\n\nI encoruage everyone reading (yes, that includes you) to donate in support of black lives and communities of color: https:\/\/nymag.com\/strategist\/article\/where-to-donate-for-black-lives-matter.html\n\nI personally have donated to the National Police Accountability Project, considering the topic of this notebook. https:\/\/www.nlg-npap.org\/donate-to-npap\/\n\n","bd6d88d7":"Most of our allegations data isn't NaN. The most likely columns to be NaN are the complainant age at incedent, complainant ethnicity, and complainant gender. Let's check out the different dispositions (the findings of the CCRB regarding the incident).","759b1438":"Let's see how many complaints there are by month (perhaps complaints spike at a certain time of year?)","30dffd9f":"Clearly, there is a lot of different data and features here, so let's take some time to sort it all out.\n\ndf_layout seems like a good starting point, since it describes the contents of the main allegations dataframe, df","c09aa2aa":"We see that total complaints trended upwards until about 2016, then there was a stark decline. Keep in mind that there might be a delay in terms of data entry and also 2020 is not over yet. \n\nAlso, complaints really started to skyrocket around 2000. A likely factor is the rise of the internet and other technologies, enabling complaints to be filed much more easily. Considering this, it might be prudent to only look at recent data. 2008 and beyond captures roughly 71% of all complaints recorded. I'll also be dropping 2020 data since it is incomplete. From here on out we will be using this recent data, unless otherwise stated.","03e8c648":"# Basic Data Inspection","4fe2b135":"Let's also take a sample of the different types of FADO complaints.","a6fedbe0":"# What's at Stake","5afa283b":"Now let's see how the board disposition results have changed over time.","79580cbf":"There are three main types of disposition, but the main allegations data goes into a little more detail regarding the outcome.","3ddec4d0":"The only data we've yet to look at are the Command and Rank Abbreviations.","c3f9343c":"# Exploratory Data Analysis"}}