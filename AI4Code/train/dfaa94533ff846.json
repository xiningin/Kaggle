{"cell_type":{"fa5e2e87":"code","2a3f7b8f":"code","949c49f2":"code","429eaf69":"code","7f99b95d":"code","bdc7310a":"code","b26f6420":"code","8bac6375":"code","4705c017":"code","cca50edc":"code","3a8f10e1":"code","fd8c9921":"code","fded5739":"code","b8a4c869":"code","484084a1":"code","16805e66":"code","e9c15dea":"code","628c5601":"code","cd6c2195":"code","bd764969":"code","1143f632":"code","6db32d5f":"code","4057a39b":"code","bb838df4":"code","b323dade":"code","74385947":"code","c790e539":"code","fcd80da3":"code","3ec04a13":"code","389a160e":"code","4159dd0e":"code","bed6110a":"code","cb61fd2a":"markdown","c8a7a752":"markdown","86b6b09f":"markdown","855409e1":"markdown","bf3e27ab":"markdown","1b6b970e":"markdown","162a71c1":"markdown","d971b71c":"markdown","18000eab":"markdown"},"source":{"fa5e2e87":"pip install missingno","2a3f7b8f":"pip install mglearn","949c49f2":"import warnings\nwarnings.simplefilter(action='ignore', category=FutureWarning)\n\nimport mglearn\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport plotly.express as px\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.model_selection import cross_val_score\nfrom xgboost import XGBClassifier,XGBRFClassifier\nfrom sklearn.neural_network import MLPClassifier\nfrom sklearn.ensemble import RandomForestClassifier, GradientBoostingClassifier\nimport missingno as msno","429eaf69":"plt.style.use(\"ggplot\")","7f99b95d":"df_train = pd.read_csv(\"\/kaggle\/input\/titanic\/train.csv\")\ndf_test  = pd.read_csv(\"\/kaggle\/input\/titanic\/test.csv\")\nId = df_test[\"PassengerId\"]","bdc7310a":"df_train.head()","b26f6420":"msno.matrix(df_train)\nplt.title(\"Train Data\",fontsize=25)\nplt.show()","8bac6375":"msno.matrix(df_test)\nplt.title(\"Test Data\",fontsize=25)\nplt.show()","4705c017":"plt.figure(figsize=(14,10))\nplt.subplot(2,2,1)\ndf_train.groupby([\"Embarked\"])[\"Survived\"].mean().plot(lw=2.7, marker=\"s\", color=\"teal\", markerfacecolor='maroon', markersize=7)\nplt.ylabel(\"Average of Survived\")\nplt.subplot(2,2,2)\ndf_train.groupby([\"Pclass\"])[\"Survived\"].mean().plot(lw=2.7, marker=\"s\", color=\"teal\", markerfacecolor='maroon', markersize=7)\nplt.ylabel(\"Average of Survived\")\nplt.xticks([1,2,3])\nplt.subplot(2,2,3)\ndf_train.groupby([\"SibSp\"])[\"Survived\"].mean().plot(lw=2.7, marker=\"s\", color=\"teal\", markerfacecolor='maroon', markersize=7)\nplt.ylabel(\"Average of Survived\")\nplt.subplot(2,2,4)\ndf_train.groupby([\"Parch\"])[\"Survived\"].mean().plot(lw=2.7, marker=\"s\", color=\"teal\", markerfacecolor='maroon', markersize=7)\nplt.ylabel(\"Average of Survived\")\nplt.show()","cca50edc":"plt.figure(figsize=(14,6))\nplt.subplot(1,2,1)\nsns.countplot(data=df_train, x=\"Embarked\", hue=\"Sex\", palette=[\"royalblue\",\"magenta\"], edgecolor=\"black\")\nplt.title(\"Train Data\")\nplt.subplot(1,2,2)\nsns.countplot(data=df_test, x=\"Embarked\", hue=\"Sex\", palette=[\"royalblue\",\"magenta\"], edgecolor=\"black\")\nplt.title(\"Test Data\")\nplt.show()","3a8f10e1":"plt.figure(figsize=(14,6))\nplt.subplot(1,2,1)\nsns.countplot(data=df_train, x=\"Pclass\", hue=\"Sex\", palette=[\"royalblue\",\"magenta\"], edgecolor=\"black\")\nplt.title(\"Train Data\")\nplt.subplot(1,2,2)\nsns.countplot(data=df_test, x=\"Pclass\", hue=\"Sex\", palette=[\"royalblue\",\"magenta\"], edgecolor=\"black\")\nplt.title(\"Test Data\")\nplt.show()","fd8c9921":"plt.figure(figsize=(14,6))\nplt.subplot(1,2,1)\nsns.countplot(data=df_train, x=\"SibSp\", palette=\"cubehelix_r\", edgecolor=\"black\")\nplt.title(\"Train Data\")\nplt.subplot(1,2,2)\nsns.countplot(data=df_test, x=\"SibSp\", palette=\"cubehelix_r\", edgecolor=\"black\")\nplt.title(\"Test Data\")\nplt.show()","fded5739":"plt.figure(figsize=(14,6))\nplt.subplot(1,2,1)\nsns.countplot(data=df_train, x=\"Parch\", palette=\"cubehelix_r\", edgecolor=\"black\")\nplt.title(\"Train Data\")\nplt.subplot(1,2,2)\nsns.countplot(data=df_test, x=\"Parch\", palette=\"cubehelix_r\", edgecolor=\"black\")\nplt.title(\"Test Data\")\nplt.show()","b8a4c869":"plt.figure(figsize=(14,6))\nplt.subplot(1,2,1)\nsns.swarmplot(data=df_train, x=\"Pclass\", y=\"Fare\")\nplt.subplot(1,2,2)\nsns.swarmplot(data=df_train, x=\"Embarked\", y=\"Fare\")\nplt.show()","484084a1":"plt.figure(figsize=(14,10))\nplt.subplot(2,2,1)\nsns.kdeplot(df_train.loc[df_train[\"Survived\"]==1][\"Age\"],color=\"green\",shade=True)\nsns.kdeplot(df_train.loc[df_train[\"Survived\"]==0][\"Age\"],color=\"red\",shade=True)\nplt.legend([\"Survived\",\"Not Survived\"])\nplt.subplot(2,2,2)\nsns.kdeplot(df_train.loc[df_train[\"Survived\"]==1][\"Fare\"],color=\"green\",shade=True)\nsns.kdeplot(df_train.loc[df_train[\"Survived\"]==0][\"Fare\"],color=\"red\",shade=True)\nplt.legend([\"Survived\",\"Not Survived\"])\nplt.subplot(2,2,(3,4))\nsns.scatterplot(data=df_train, x=\"Age\", y=\"Fare\", hue=\"Survived\", palette=[\"red\",\"green\"])\nplt.show()","16805e66":"df_train.drop([\"PassengerId\",\"Name\",\"Ticket\",\"Cabin\"],axis=1,inplace=True)\ndf_test.drop([\"PassengerId\",\"Name\",\"Ticket\",\"Cabin\"],axis=1,inplace=True)\n\ndf_train[\"Sex\"].replace([\"male\",\"female\"],[0,1],inplace=True)\ndf_test[\"Sex\"].replace([\"male\",\"female\"],[0,1],inplace=True)\n\ndf_train[\"Embarked\"].replace([\"S\",\"C\",\"Q\"],[0,1,2],inplace=True)\ndf_test[\"Embarked\"].replace([\"S\",\"C\",\"Q\"],[0,1,2],inplace=True)","e9c15dea":"dftrain_int = df_train.interpolate() \ndftest_int  = df_test.interpolate()","628c5601":"fig = px.parallel_coordinates(dftrain_int, color=\"Survived\",\n                              color_continuous_scale=px.colors.diverging.Tealrose, color_continuous_midpoint=0.5)\nfig.show()","cd6c2195":"mglearn.plots.plot_grid_search_overview();\nplt.show()","bd764969":"classes = [\"Not Survived\",\"Survived\"]","1143f632":"X = dftrain_int.drop(\"Survived\",axis=1)\ny = dftrain_int[\"Survived\"]","6db32d5f":"from sklearn.preprocessing import MinMaxScaler\nscaler = MinMaxScaler()\nscaler.fit(X)\nscaler.fit(dftest_int)\n\nX_scaled=scaler.transform(X)\nX_test_scaled=scaler.transform(dftest_int)","4057a39b":"X_train,X_test,y_train,y_test = train_test_split(X_scaled,y,test_size=0.20,random_state=0)","bb838df4":"import warnings\nwarnings.simplefilter(action='ignore', category=FutureWarning)\n\nfrom yellowbrick.classifier import ROCAUC,ConfusionMatrix\n\ndef Performance(model):\n    global X,y,X_train,y_train,X_test,X_train,classes\n    \n    print(\"Accuracy score:\",accuracy_score(y_test,model.predict(X_test)))\n    \n    visualizer = ROCAUC(model, classes=classes)\n    visualizer.fit(X_train, y_train)      \n    visualizer.score(X_test, y_test)        \n    visualizer.show();\n\n    plt.figure(figsize=(4,3))\n    cm = ConfusionMatrix(model, classes=classes)\n    cm.fit(X_train, y_train)\n    cm.score(X_test, y_test)\n    plt.xticks(rotation=0)\n    cm.show();","b323dade":"def CrossValidationScore(model_list):\n    global X,y\n    \n    mean_cross_val_score = []\n    model_name           = []\n    \n    for model in model_list:\n        model_name.append(type(model).__name__)\n        \n    for i in model_list:\n        scores = cross_val_score(i, X, y, cv=5)\n        mean_cross_val_score.append(scores.mean())\n        \n    cvs = pd.DataFrame({\"Model Name\":model_name,\"CVS\":mean_cross_val_score})\n    return cvs.style.background_gradient(\"Greens\")","74385947":"mlp = MLPClassifier(hidden_layer_sizes=(64,128,64),activation=\"relu\",max_iter=500,solver=\"adam\")\nmlp.fit(X_train,y_train)\n\nPerformance(mlp)","c790e539":"rfc = RandomForestClassifier(n_estimators=150)\nrfc.fit(X_train,y_train)\n\nPerformance(rfc)","fcd80da3":"gbc = GradientBoostingClassifier()\ngbc.fit(X_train,y_train)\n\nPerformance(gbc)","3ec04a13":"xrfc = XGBRFClassifier()\nxrfc.fit(X_train,y_train)\n\nPerformance(xrfc)","389a160e":"xgbc = XGBClassifier()\nxgbc.fit(X_train,y_train)\n\nPerformance(xgbc)","4159dd0e":"mglearn.plots.plot_cross_validation();\nplt.show()","bed6110a":"model_list = [mlp, gbc, rfc, xrfc, xgbc]\nCrossValidationScore(model_list)","cb61fd2a":"# **Introduction**\nRMS Titanic was a British passenger liner operated by the White Star Line that sank in the North Atlantic Ocean in the early morning hours of 15 April 1912, after striking an iceberg during her maiden voyage from Southampton to New York City. Of the estimated 2,224 passengers and crew aboard, more than 1,500 died, making the sinking one of modern history's deadliest peacetime commercial marine disasters. RMS Titanic was the largest ship afloat at the time she entered service and was the second of three Olympic-class ocean liners operated by the White Star Line. She was built by the Harland and Wolff shipyard in Belfast. Thomas Andrews, chief naval architect of the shipyard at the time, died in the disaster.\n\n## Description\nInformation on the survival status, sex, age, and passenger class of 1309 passengers in the Titanic disaster of 1912.\n\n## Contents\n\n1. [Import data and python packages](#t1.)\n\n2. [Data visualization](#t2.)\n\n3. [Classification](#t3.)\n\n    3.1 [Split data for train and test](#t3.1)\n    \n    3.2 [Functions for models](#t3.2)\n    \n    3.3 [Models](#t3.3)\n\n4. [Result](#t4.)","c8a7a752":"<a id=\"t3.2\"><\/a>\n## 3.2 Functions for models","86b6b09f":"<a id=\"t4.\"><\/a>\n# 4. Result","855409e1":"<a id=\"t3.1\"><\/a>\n## 3.1 Split data for train and test","bf3e27ab":"<a id=\"t3.\"><\/a>\n# 3. Classification","1b6b970e":"<h1><center>Titanic: Data Analysis and Classification<\/center><\/h1>\n\n<center><img src=\"https:\/\/icdn.ensonhaber.com\/resimler\/diger\/kok\/2020\/11\/04\/k_1469.jpg\"><\/center>","162a71c1":"<a id=\"t3.3\"><\/a>\n## 3.3 Models","d971b71c":"<a id=\"t1.\"><\/a>\n# 1. Import data and python packages","18000eab":"<a id=\"t2.\"><\/a>\n# 2. Data visualization"}}