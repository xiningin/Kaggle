{"cell_type":{"440e22f3":"code","36104fdb":"code","b1aedfff":"code","a6288461":"code","56f0b7ae":"code","31ef3744":"code","36a485ac":"code","496d7865":"code","9fb70d35":"code","1cea5e41":"code","311dc15d":"code","d97d2b3e":"code","87446641":"code","7f948086":"code","6dc8f0c8":"code","7076993c":"code","2644c401":"code","7f916fb2":"code","2e4bc67c":"code","b31d9beb":"code","115f8f0b":"code","0624acc4":"code","bc35445f":"code","3930f59c":"code","f10622a4":"code","06e532ed":"code","ea5c8d29":"code","b826b2a8":"code","672f4e94":"code","50dfc51f":"code","a855bb1e":"code","eafc4ea3":"code","48860764":"code","2f6b8258":"markdown","491e8468":"markdown","34c8b887":"markdown","b2a5a4d6":"markdown","798a5094":"markdown","851e81fc":"markdown","9eba1e4e":"markdown","f66389a0":"markdown"},"source":{"440e22f3":"# \uc544\ub798 url\uc744 \ucc38\uace0 \ud588\ub2e4.\n# https:\/\/www.kaggle.com\/hely333\/eda-regression\/data","36104fdb":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","b1aedfff":"import numpy as np \nimport pandas as pd \nimport os\nimport matplotlib.pyplot as pl\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings('ignore')","a6288461":"!pwd\n\n!ls","56f0b7ae":"#\/kaggle\/working\nos.getcwd() #'\/kaggle\/input'\n\nos.chdir('\/kaggle\/working')\n# os.chdir('..\/input')","31ef3744":"data = pd.read_csv('..\/input\/insurance.csv')","36a485ac":"data.isnull().sum()","496d7865":"data.head()","9fb70d35":"from sklearn.preprocessing import LabelEncoder\n#sex\nle = LabelEncoder()\nle.fit(data.sex.drop_duplicates()) \ndata.sex = le.transform(data.sex)\n# smoker or not\nle.fit(data.smoker.drop_duplicates()) \ndata.smoker = le.transform(data.smoker)\n#region\nle.fit(data.region.drop_duplicates()) \ndata.region = le.transform(data.region)","1cea5e41":"data.corr()['charges'].sort_values()","311dc15d":"f, ax = pl.subplots(figsize=(10, 8))\ncorr = data.corr()\nsns.heatmap(corr, mask=np.zeros_like(corr, dtype=np.bool), cmap=sns.diverging_palette(240,10,as_cmap=True),\n            square=True, ax=ax)","d97d2b3e":"# \uc544\ub798\ub294 \uc548\ub41c\ub2e4\n\"\"\"\nfrom bokeh.io import output_notebook, show\nfrom bokeh.plotting import figure\noutput_notebook()\nimport scipy.special\nfrom bokeh.layouts import gridplot\nfrom bokeh.plotting import figure, show, output_file\np = figure(title=\"Distribution of charges\",tools=\"save\",\n            background_fill_color=\"#E8DDCB\")\nhist, edges = np.histogram(data.charges)\np.quad(top=hist, bottom=0, left=edges[:-1], right=edges[1:],\n        fill_color=\"#036564\", line_color=\"#033649\")\np.xaxis.axis_label = 'x'\np.yaxis.axis_label = 'Pr(x)'\n\nshow(gridplot(p,ncols = 2, plot_width=400, plot_height=400, toolbar_location=None)) \n\"\"\"","87446641":"f= pl.figure(figsize=(12,5))\n\nax=f.add_subplot(121)\nsns.distplot(data[(data.smoker == 1)][\"charges\"],color='c',ax=ax)\nax.set_title('Distribution of charges for smokers')\n\nax=f.add_subplot(122)\nsns.distplot(data[(data.smoker == 0)]['charges'],color='b',ax=ax)\nax.set_title('Distribution of charges for non-smokers')","7f948086":"sns.catplot(x=\"smoker\", kind=\"count\",hue = 'sex', palette=\"pink\", data=data)","6dc8f0c8":"sns.catplot(x=\"sex\", y=\"charges\", hue=\"smoker\",\n            kind=\"violin\", data=data, palette = 'magma')","7076993c":"pl.figure(figsize=(12,5))\npl.title(\"Box plot for charges of women\")\nsns.boxplot(y=\"smoker\", x=\"charges\", data =  data[(data.sex == 1)] , orient=\"h\", palette = 'magma') # sex == 1(women) ","2644c401":"pl.figure(figsize=(12,5))\npl.title(\"Box plot for charges of men\")\nsns.boxplot(y=\"smoker\", x=\"charges\", data =  data[(data.sex == 0)] , orient=\"h\", palette = 'rainbow')","7f916fb2":"pl.figure(figsize=(12,5))\npl.title(\"Distribution of age\")\nax = sns.distplot(data[\"age\"], color = 'g')","2e4bc67c":"sns.catplot(x=\"smoker\", kind=\"count\",hue = 'sex', palette=\"rainbow\", data=data[(data.age == 18)])\npl.title(\"The number of smokers and non-smokers (18 years old)\")","b31d9beb":"pl.figure(figsize=(12,5))\npl.title(\"Box plot for charges 18 years old smokers\")\nsns.boxplot(y=\"smoker\", x=\"charges\", data = data[(data.age == 18)] , orient=\"h\", palette = 'pink')","115f8f0b":"g = sns.jointplot(x=\"age\", y=\"charges\", data = data[(data.smoker == 0)],kind=\"kde\", color=\"m\")\ng.plot_joint(pl.scatter, c=\"w\", s=30, linewidth=1, marker=\"+\")\ng.ax_joint.collections[0].set_alpha(0)\ng.set_axis_labels(\"$X$\", \"$Y$\")\nax.set_title('Distribution of charges and age for non-smokers')","0624acc4":"g = sns.jointplot(x=\"age\", y=\"charges\", data = data[(data.smoker == 1)],kind=\"kde\", color=\"c\")\ng.plot_joint(pl.scatter, c=\"w\", s=30, linewidth=1, marker=\"+\")\ng.ax_joint.collections[0].set_alpha(0)\ng.set_axis_labels(\"$X$\", \"$Y$\")\nax.set_title('Distribution of charges and age for smokers')","bc35445f":"#non - smokers\np = figure(plot_width=500, plot_height=450)\np.circle(x=data[(data.smoker == 0)].age,y=data[(data.smoker == 0)].charges, size=7, line_color=\"navy\", fill_color=\"pink\", fill_alpha=0.9)\n\nshow(p)","3930f59c":"#smokers\np = figure(plot_width=500, plot_height=450)\np.circle(x=data[(data.smoker == 1)].age,y=data[(data.smoker == 1)].charges, size=7, line_color=\"navy\", fill_color=\"red\", fill_alpha=0.9)\nshow(p)","f10622a4":"sns.lmplot(x=\"age\", y=\"charges\", hue=\"smoker\", data=data, palette = 'inferno_r', size = 7)\nax.set_title('Smokers and non-smokers')","06e532ed":"pl.figure(figsize=(12,5))\npl.title(\"Distribution of bmi\")\nax = sns.distplot(data[\"bmi\"], color = 'm')","ea5c8d29":"There's something insanely beautiful about this distribution, isn't there?\nThe average BMI in patients is 30. I think I should go to the great Google with a question about this indicator.","b826b2a8":"pl.figure(figsize=(12,5))\npl.title(\"Distribution of charges for patients with BMI greater than 30\")\nax = sns.distplot(data[(data.bmi >= 30)]['charges'], color = 'm')","672f4e94":"pl.figure(figsize=(12,5))\npl.title(\"Distribution of charges for patients with BMI less than 30\")\nax = sns.distplot(data[(data.bmi < 30)]['charges'], color = 'b')","50dfc51f":"g = sns.jointplot(x=\"bmi\", y=\"charges\", data = data,kind=\"kde\", color=\"r\")\ng.plot_joint(pl.scatter, c=\"w\", s=30, linewidth=1, marker=\"+\")\ng.ax_joint.collections[0].set_alpha(0)\ng.set_axis_labels(\"$X$\", \"$Y$\")\nax.set_title('Distribution of bmi and charges')","a855bb1e":"pl.figure(figsize=(10,6))\nax = sns.scatterplot(x='bmi',y='charges',data=data,palette='magma',hue='smoker')\nax.set_title('Scatter plot of charges and bmi')\n\nsns.lmplot(x=\"bmi\", y=\"charges\", hue=\"smoker\", data=data, palette = 'magma', size = 8)","eafc4ea3":"sns.catplot(x=\"children\", kind=\"count\", palette=\"ch:.25\", data=data, size = 6)","48860764":"sns.catplot(x=\"smoker\", kind=\"count\", palette=\"rainbow\",hue = \"sex\",\n            data=data[(data.children > 0)], size = 6)\nax.set_title('Smokers and non-smokers who have childrens')","2f6b8258":"With a value equal to 30 starts obesity. I also calculated my BMI and now I can safely eat a sandwich. Let's start to explore! First, let's look at the distribution of costs in patients with BMI greater than 30 and less than 30.","491e8468":"We have patients under 20 in our data set. Im 18 years old. This is the minimum age of patients in our set. The maximum age is 64 years. My personal interest is whether there are smokers among patients 18 years.b","34c8b887":"Oh. I was hoping the result would be different. 18 years old - a very young age. Does smoking affect the cost of treatment at this age?","b2a5a4d6":"Most patients do not have children. Perfectly that some have 5 children! Children are happiness:) I wonder if people who have children smoke.","798a5094":"In non-smokers, the cost of treatment increases with age. That makes sense. So take care of your health, friends! In smoking people, we do not see such dependence. I think that it is not only in smoking but also in the peculiarities of the dataset. Such a strong effect of Smoking on the cost of treatment would be more logical to judge having a set of data with a large number of records and signs. But we work with what we have! Let's pay attention to bmi. I am surprised that this figure but affects the cost of treatment in patients. Or are we on a diet for nothing?","851e81fc":"Now let's pay attention to the age of the patients. \nFirst, let's look at how age affects the cost of treatment, and also look at patients of what age more in our data set.\n","9eba1e4e":"But I am glad that non-smoking parents are much more!\n\nI have a few more ideas for exploring this dataset. I will soon implement them. And now we are going to predict the cost of treatment. Let's start with the usual linear regression.","f66389a0":"Oh. As we can see, even at the age of 18 smokers spend much more on treatment than non-smokers. Among non-smokers we are seeing some \" tails.\" I can assume that this is due to serious diseases or accidents. Now let's see how the cost of treatment depends on the age of smokers and non-smokers patients."}}