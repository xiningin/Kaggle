{"cell_type":{"2d65f514":"code","416c6c6a":"code","2477b440":"code","4d102a0b":"code","b856a348":"code","9aaab1b4":"code","52d91d45":"code","c3af27c9":"code","932e4f8b":"code","ef1b4a3f":"code","40495689":"code","fffe232d":"code","c2c43a85":"code","1a092ee7":"code","d1f08e6c":"code","ec3707a8":"code","91578d8c":"code","4939059c":"code","cc422148":"code","717070a7":"code","be46b72c":"code","6abdc3ba":"code","231cacbb":"code","2457772d":"code","f6e5ff54":"markdown","bbd64a8d":"markdown","8f97a028":"markdown","9ce81706":"markdown","44dfb01e":"markdown","4a7cbca9":"markdown","37d7491a":"markdown","f875c9d3":"markdown","6a47c073":"markdown","003610b1":"markdown","c34f65ce":"markdown","b0ea467f":"markdown","d54a9dca":"markdown","907251d5":"markdown"},"source":{"2d65f514":"#import basic python libraries\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n#read in a dataframe from remote url\ngit_hub_url=\"https:\/\/raw.githubusercontent.com\/pcm-dpc\/COVID-19\/master\/dati-andamento-nazionale\/dpc-covid19-ita-andamento-nazionale.csv\"\ndf = pd.read_csv(git_hub_url,  parse_dates=True, index_col='data',sep=',')","416c6c6a":"df.plot(figsize=(18,8))","2477b440":"df.drop(columns=[\"ricoverati_con_sintomi\",\"tamponi\"]).plot(figsize=(18,8))","4d102a0b":"#remove not useful column and show last 3 days\ndf=df.drop(columns=[\"stato\",\"note_it\",\"note_en\"])\ndf_delta=df.drop(df.columns,axis=1)\n","b856a348":"df.tail(6)","9aaab1b4":"#let's define a couple of python functions useful for next steps\ndef delta(dfxx,df1):\n  for c in dfxx.columns:\n    new_name=\"delta_\"+c\n    df1[new_name]=(dfxx[c]-dfxx[c].shift()).fillna(0)\n  return df1\ndef plot(dfx,cols=None,sizex=(18,8)):\n    dff=dfx\n    if cols:  \n      dff=dfx[cols]\n    dff.plot(figsize=sizex)","52d91d45":"plot(df,[\"deceduti\",\"dimessi_guariti\",\"terapia_intensiva\"])","c3af27c9":"plot(df,[\"totale_positivi\",\"totale_casi\"])","932e4f8b":"df_delta=delta(df,df_delta)","ef1b4a3f":"df_delta.tail(6)","40495689":"plot(df_delta,[\"delta_deceduti\",\"delta_dimessi_guariti\",\"delta_terapia_intensiva\",\"delta_totale_positivi\",\"delta_totale_casi\"])","fffe232d":"#df_delta=df_delta.drop(columns=[\"delta_tamponi\"],axis=1)\nplot(df_delta,[\"delta_deceduti\",\"delta_dimessi_guariti\",\"delta_terapia_intensiva\"])\n#df_delta.plot(figsize=(18,8))","c2c43a85":"plot(df_delta,[\"delta_totale_positivi\",\"delta_totale_casi\"])","1a092ee7":"from fbprophet import Prophet\npdf=df_delta.reset_index()\npdf[\"ds\"]=pdf[\"data\"]","d1f08e6c":"#pdf.tail(5)","ec3707a8":"def forecast(ds_forecast,column,days=7):\n    ds_forecast[\"y\"]=ds_forecast[column]\n    pro_df=ds_forecast[[\"ds\",\"y\"]]\n    my_model = Prophet()\n    my_model.fit(pro_df)\n    future_dates = my_model.make_future_dataframe(periods=days, freq='D')\n    forecast = my_model.predict(future_dates)\n    return my_model,forecast \n","91578d8c":"model,fc=forecast(pdf,\"delta_deceduti\")\nmodel.plot(fc,uncertainty=True);","4939059c":"pdf_tmp=pdf[pdf[\"ds\"]>'2020-03-21'].copy()\nmodel,fc=forecast(pdf_tmp,\"delta_deceduti\")\nmodel.plot(fc,uncertainty=True);","cc422148":"model,fc=forecast(pdf,\"delta_dimessi_guariti\")\nmodel.plot(fc,uncertainty=True);","717070a7":"model,fc=forecast(pdf,\"delta_terapia_intensiva\")\nmodel.plot(fc,uncertainty=True);","be46b72c":"model,fc=forecast(pdf,\"delta_totale_positivi\")\nmodel.plot(fc,uncertainty=True);","6abdc3ba":"model,fc=forecast(pdf_tmp,\"delta_totale_positivi\")\nmodel.plot(fc,uncertainty=True);","231cacbb":"model,fc=forecast(pdf,\"delta_totale_casi\")\nmodel.plot(fc,uncertainty=True);","2457772d":"model,fc=forecast(pdf_tmp,\"delta_totale_casi\")\nmodel.plot(fc,uncertainty=True);","f6e5ff54":"# Overall forecasting of daily healed for next 7 days\n","bbd64a8d":"# Overall forecasting of daily intensive care for next 7 days","8f97a028":"# From 21\/3 forecasting of daily increment of new positve cases for next 7 days","9ce81706":"<h1> Italy Coronavirus trend and forecasting <\/h1>\n<p> This notebook wants to show Coronavirus trend in Italy; data are retrieved from official site of \"Protezione Civile\" (Italian Emergency Agency). These data are published every day at 6 PM at this link <\/p>\nhttps:\/\/raw.githubusercontent.com\/pcm-dpc\/COVID-19\/master\/dati-andamento-nazionale\/dpc-covid19-ita-andamento-nazionale.csv \n\nAt the end of this notebook a future projection of some trend is provided using Facebook Prophet library; **please, consider that ML predictions are based on trend retrieved from the past. It means that, if past data show a growing trend, it implies that even in the future you will see similar trend. This kind of analysis will be useful when, due to current restrictions recomended by Italian governemt, trends will begin to decline**. In that case, a correct timeseries forecast of the trend will help to figure out how many days it will require to come back to \"normality\".\n\n[National data of last 6 days](#National-data-of-last-6-days)\n\nHere below forecasting trends\n\n[Overall forecasting of daily deaths for next 7 days](#Overall-forecasting-of-daily-deaths-for-next-7-days)\n\n[From 21\/3 forecasting of daily deaths for next 7 days](#From-21\/3-forecasting-of-daily-deaths-for-next-7-days)\n\n[Overall forecasting of daily healed for next 7 days](#Overall-forecasting-of-daily-healed-for-next-7-days)\n\n[Overall forecasting of daily intensive care for next 7 days](#Overall-forecasting-of-daily-intensive-care-for-next-7-days)\n\n[Overall forecasting of daily increment of new positve cases for next 7 days](#Overall-forecasting-of-daily-increment-of-new-positve-cases-for-next-7-days)\n\n[From 21\/3 forecasting of daily increment of new positve cases for next 7 days](#From-21\/3-forecasting-of-daily-increment-of-new-positve-cases-for-next-7-days)\n\n[Overall forecasting of daily increment of new total positve cases for next 7 days](#Overall-forecasting-of-daily-increment-of-new-total-positve-cases-for-next-7-days)\n\n[From 21\/3 forecasting of daily increment of new total positve cases for next 7 days](#From-21\/3-forecasting-of-daily-increment-of-new-total-positve-cases-for-next-7-days)","44dfb01e":"# From 21\/3 forecasting of daily increment of new total positve cases for next 7 days","4a7cbca9":"# Overall forecasting of daily increment of new positve cases for next 7 days","37d7491a":"## National data increments of last 6 days","f875c9d3":"# National data of last 6 days","6a47c073":"# Day by day analysis #","003610b1":"## Let's define a forecast function on daily base,it is able to forecast values for a given column belonging to the dataframe","c34f65ce":"# Overall forecasting of daily increment of new total positve cases for next 7 days","b0ea467f":"# Timeseries forecasting #\nLet's assume (it's a strong but optimistic assumption) that max values for \"deltas\" have been reached on 21\/03, then we can consider two kinds of prediction:\n1. **Overall prediction**, we use in our model all data. For sure in this case we will see a still growing trend due to the fact that until 21 data were growing.\n2. **From delta peak prediction,** we use in our model only data from 21\/03. In this case we are excluding growing trend and assuming that (I hope) from 21\/3 data will reach the peak point (pay attention the delta peak point is 21\/3 but data were still growing) but delta data will tend to zero.  \n\nLet's prepare data accordingly with Facebook Prophet conventions","d54a9dca":"# From 21\/3 forecasting of daily deaths for next 7 days","907251d5":"# Overall forecasting of daily deaths for next 7 days\nBlack dots are observed past true values, blue line is forecast for next 7 days"}}