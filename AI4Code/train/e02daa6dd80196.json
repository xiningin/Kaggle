{"cell_type":{"991bf995":"code","0343b62e":"code","8a5fcf5f":"code","3345b8bb":"code","b399e786":"code","4c93f28d":"code","f6b17a0a":"code","e948c1de":"code","30baf0d5":"code","ff3845d5":"code","d16d45ca":"code","316b27c2":"code","1b46cbe6":"code","8f10b779":"code","50bc536d":"code","a1ab60c1":"code","dba3ff9c":"code","9c4d44f3":"markdown","70806907":"markdown","373f811c":"markdown","780fd944":"markdown","de517bdf":"markdown","d678fe29":"markdown"},"source":{"991bf995":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport tensorflow as tf","0343b62e":"ds = pd.read_csv('..\/input\/heart-attack-analysis-prediction-dataset\/heart.csv')\nds.head()","8a5fcf5f":"ds.isnull().sum()","3345b8bb":"ds.info()","b399e786":"sns.countplot(x = 'output', data =ds)","4c93f28d":"ds.columns","f6b17a0a":"plt.figure(figsize=(18,10))\ncol = ['sex', 'cp', 'fbs', 'restecg','exng', 'slp', 'caa', 'thall',]\nc = 1\nfor i in col:\n    if c < 9:\n        plt.subplot(2,4,c)\n        sns.countplot(x = i,data =ds,hue = 'output')\n        plt.xlabel(i)\n    c += 1\n    plt.tight_layout()","e948c1de":"plt.figure(figsize=(18,10))\ncol = ['age','trtbps', 'chol','thalachh','oldpeak']\nc = 1\nfor i in col:\n    if c < 6:\n        plt.subplot(2,3,c)\n        sns.violinplot(y = i,x = 'output', data =ds)\n    c += 1\n    plt.tight_layout()","30baf0d5":"plt.figure(figsize=(16,4))\n\n#RELATION BETWEEN AGE AND CHOLESTROL\nplt.subplot(1,3,1)\nsns.scatterplot(x = 'age', y = 'chol', data =ds,hue = 'output')\nplt.title('AGE V\/S CHOLESTROL')\n\n#RELATION BETWEEN AGE AND MAXIMUM HEART RATE\nplt.subplot(1,3,2)\nsns.scatterplot(x = 'age', y = 'thalachh', data =ds,hue = 'output')\nplt.title('AGE V\/S MAXIMUM HEART RATE')\n\n#RELATION BETWEEN AGE AND OLDPEAK\nplt.subplot(1,3,3)\nsns.scatterplot(x = 'age', y = 'oldpeak', data =ds,hue = 'output')\nplt.title('AGE V\/S OLDPEAK')\n\nplt.tight_layout()","ff3845d5":"plt.figure(figsize=(12,10))\nsns.heatmap(ds.corr() ,annot = True)","d16d45ca":"from numpy.random import seed\nseed(0)\ntf.random.set_seed(0)","316b27c2":"#defining dependent and independent variables\nx = ds.drop('output', axis=1)\ny = ds['output']","1b46cbe6":"#splitting data into training and testing set\nfrom sklearn.model_selection import train_test_split\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size = 0.2, random_state = 0)","8f10b779":"#applying feature scaling\nfrom sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\nx_train = sc.fit_transform(x_train)\nx_test = sc.fit_transform(x_test)","50bc536d":"#CREATING THE ANN AS SEQUENCE OF LAYERS\nann = tf.keras.models.Sequential()\n\n#ADDING FIRST HIDDEN LAYER WITH 24 NEURONS, THE INPUT LAYER WILL BE ADDED AUTOMATICALLY,\nann.add(tf.keras.layers.Dense(units = 24,activation = 'relu'))\n\n#ADDING 2ND HIDDEN LAYER WITH 24 NEURONS\nann.add(tf.keras.layers.Dense(units = 24,activation = 'relu'))\n\n#ADDING 3RD HIDDEN LAYER WITH 12 NEURONS\nann.add(tf.keras.layers.Dense(units = 12,activation = 'relu'))\n\n\n#ADDING OUTPUT LAYER WITH 1 NEURON , AS THIS IS A BINARY CLASSIFICATION\nann.add(tf.keras.layers.Dense(units = 1,activation = 'sigmoid'))\n\n#COMPILING THE ANN USING STOCHASTIC GRADIENT DESCENT (optimizer = 'adam')\nann.compile(optimizer = 'adam', loss = 'binary_crossentropy', metrics = ['accuracy'])\n\n\n#TRAINING THE ANN WITH BATCH SIZE OF 32 (THIS IS A BATCH LEARNING)\nann.fit(x_train, y_train,batch_size = 32, epochs = 50)","a1ab60c1":"losses = pd.DataFrame(ann.history.history)\nlosses.plot()","dba3ff9c":"#GETTING ACCURACY AND CONFUSION MATRIX\nfrom sklearn.metrics import confusion_matrix,accuracy_score\ny_pred = ann.predict(x_test)\ny_pred  = y_pred > 0.5\ncm = confusion_matrix(y_pred,y_test)\nac = accuracy_score(y_pred,y_test)\n\nsns.heatmap(cm,annot = True)\nplt.title('CONFUSION MATRIX')\nprint('Accuracy - {0:.2f}%'.format(ac*100))","9c4d44f3":"**ASSUMPTIONS -**\n* **sex 1 has more patients than 0 , but percentile of high risk patients is more in gender 0.**\n* **cp stand for chest pain and there are 4 type of chest pain, cp 0 has the most patients but cp 2 has the most with high risks.**\n* **fps stands for fasting blood sugar (fps > 120 mg\/dl , 1 = true, 0 = false) patients with high risk have fps < 120 mg\/dl.**\n* **resting electrocardiographic results with value 1 have highest risk.**\n* **exng is exercise enduced argina (1 = yes, 0 = no ) exng = 0 have more patients.**\n* **slp with value 2 have highest risk.**\n* **caa = 0 has highest patients with heart risks.**\n* **thall with value 2 have highest patients.**\n","70806907":"**IT IS NOT SPECIFIED WHETHER 0 IS MALE OR FEMALE, THEREFORE WE'LL ASSUME GENDERS AS 0 AND 1**\n* AROUND 160 PATIENTS HAVE RISKS OF HEART DISEASE","373f811c":"**NO MISSING VALUES**","780fd944":"**NO SIGNIFICANT CORRELATION**","de517bdf":"**CHECKING WHETHER THE PATIENT HAVE HEART RISKS OR NOT USING ARTIFICIAL NEURAL NETWORKS.**\n\n**About this dataset**\n* Age : Age of the patient\n* Sex : Sex of the patient\n* exang: exercise induced angina (1 = yes; 0 = no)\n* ca: number of major vessels (0-3)\n* cp : Chest Pain type chest pain type\n       Value 1: typical angina\n   \n       Value 2: atypical angina\n\n       Value 3: non-anginal pain\n\n       Value 4: asymptomatic\n\n* trtbps : resting blood pressure (in mm Hg)\n* chol : cholestoral in mg\/dl fetched via BMI sensor\n* fbs : (fasting blood sugar > 120 mg\/dl) (1 = true; 0 = false)\n* rest_ecg : resting electrocardiographic results\n            Value 0: normal\n\n            Value 1: having ST-T wave abnormality (T wave inversions and\/or ST elevation or depression of > 0.05 mV)\n\n            Value 2: showing probable or definite left ventricular hypertrophy by Estes' criteria\n\n* thalach : maximum heart rate achieved\n* target : 0= less chance of heart attack 1= more chance of heart attack","d678fe29":"**ASSUMPTIONS-**\n* **ages between 50-60 have highest chance of heart risks**\n* **trtbps (resting blood pressure) have equal distributions, hence it has very less effect in health risks.**\n* **average cholestrol around 250 has risks but cholestrol values of 400-600 have highly likeness of heart risks.**\n* **heart rate of 140 - 180 have high risks.**\n* **patients with high risk have oldpeak values between 0-1.**"}}