{"cell_type":{"def62ac6":"code","6e51c43b":"code","9e2e489e":"code","b8e91ee9":"code","3c35ef35":"code","9f568b07":"code","f7039985":"markdown"},"source":{"def62ac6":"import pandas as pd\nimport numpy as np\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.model_selection import StratifiedKFold","6e51c43b":"train_df = pd.read_csv('..\/input\/tabular-playground-series-oct-2021\/train.csv')","9e2e489e":"features = [col for col in train_df.columns if col.startswith('f')]\ntarget = ['target']","b8e91ee9":"def generate_n_splits(n=10):\n    \n    # Get Folds\n    skf = StratifiedKFold(n_splits=n,random_state=42,shuffle=True)\n    skf.get_n_splits(train_df[features],train_df[target])\n    for idx,(train_index,val_index) in enumerate(skf.split(train_df[features],train_df[target])):\n        train_df.loc[val_index ,'Fold'] = idx\n    \n    # Check Folds\n    for i in range(n):\n        print(f'*****Fold {i}*****')\n        print(train_df[train_df['Fold'] == i][target].value_counts(normalize=True))\n        print(f'******************')\n        \n    # Save Folds\n    train_df.to_csv(f'Stratified{n}Fold_OCT2021_TPS.csv',index=False)","3c35ef35":"#Generate 5 Folds\ngenerate_n_splits(n=5)","9f568b07":"#Generate 10 Folds\ngenerate_n_splits(n=10)","f7039985":"# Cross Validation Splits\n\nThis notebooks generates 5 and 10 folds (stratified) for the dataset.\n\nA new column Fold is added to train.csv. This can be used during training for 5\/10 fold cross validation"}}