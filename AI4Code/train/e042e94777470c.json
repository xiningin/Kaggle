{"cell_type":{"44afd186":"code","abc9a18f":"code","f1eac4c2":"code","736136e2":"code","ef72f1c9":"code","0ac7f20d":"code","07df76de":"code","ba2454a6":"code","d0ca0fd8":"code","a64648a5":"code","750a3670":"code","9a1ab03c":"code","9dbda508":"code","4d3f3cdc":"code","c11adc5c":"code","2640d640":"code","b7ec7632":"code","7530ab02":"code","0bc96bf7":"code","ead87acb":"code","f7378739":"code","70712703":"code","144de43c":"markdown","5762f25e":"markdown","6703f872":"markdown","a5a56a48":"markdown","ddbacbb6":"markdown","4ff88100":"markdown","963d173e":"markdown"},"source":{"44afd186":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom statistics import *\n","abc9a18f":"df=pd.read_csv(\"..\/input\/water-potability\/water_potability.csv\")","f1eac4c2":"df.head()","736136e2":"for i in df.columns:\n  print(df[i].isna().sum())","ef72f1c9":"df_dropped=df.dropna()","0ac7f20d":"df_dropped.info()","07df76de":"df_dropped[[\"Potability\",\"ph\",\"Hardness\",\"Solids\",\"Chloramines\",\"Sulfate\",\"Conductivity\",\"Organic_carbon\",\"Trihalomethanes\",\"Turbidity\"]].corr()","ba2454a6":"df_dropped.Potability.value_counts()","d0ca0fd8":"from sklearn.model_selection import train_test_split as tp\ntrain,test=tp(df_dropped,test_size=0.2,stratify=df_dropped[\"Potability\"])","a64648a5":"train.Potability.value_counts()\/len(train)","750a3670":"test.Potability.value_counts()\/len(test)","9a1ab03c":"X_labels=[\"ph\",\"Hardness\",\"Solids\",\"Chloramines\",\"Sulfate\",\"Conductivity\",\"Organic_carbon\",\"Trihalomethanes\",\"Turbidity\"]\ny_label=[\"Potability\"]","9dbda508":"x_data_train=pd.DataFrame(train[X_labels])\ny_data_train=pd.DataFrame(train[y_label])\nprint(type(x_data_train))\nprint(type(y_data_train))","4d3f3cdc":"#cross validation performance of models below\n# SGDClassifier\nfrom sklearn.linear_model import SGDClassifier as SG\nfrom sklearn.model_selection import cross_val_score\nmodel=SG(random_state=42)\ncross_val_score(model,x_data_train,y_data_train,cv=10,scoring='accuracy')\n","c11adc5c":"#Support Vector Machines\nfrom sklearn import svm\nmodel1=svm.SVC(kernel='linear')\ncross_val_score(model1,x_data_train,y_data_train,cv=10,scoring='accuracy')","2640d640":"#Logistic Regression\nfrom sklearn.linear_model import LogisticRegression as lg\nmodel2=lg()\ncross_val_score(model2,x_data_train,y_data_train,cv=10,scoring='accuracy')","b7ec7632":"#Decision Tree\nfrom sklearn.tree import DecisionTreeClassifier as dt\nmodel3=dt(max_depth=3,random_state=42)\ncross_val_score(model3,x_data_train,y_data_train,cv=10,scoring='accuracy')\n","7530ab02":"x_data_test=pd.DataFrame(test[X_labels])\ny_data_test=pd.DataFrame(test[y_label])\n","0bc96bf7":"#Decision Tree\nmodel3.fit(x_data_train,y_data_train)\nl=model3.predict(x_data_test)\ncheck=y_data_test['Potability'].to_numpy()\ncorrect=sum(l==check)\nprint(correct\/len(check))","ead87acb":"#Logistic Regression\nmodel2.fit(x_data_train,y_data_train)\nl=model2.predict(x_data_test)\ncheck=y_data_test['Potability'].to_numpy()\ncorrect=sum(l==check)\nprint(correct\/len(check))","f7378739":"#Support Vector Machine\nmodel1.fit(x_data_train,y_data_train)\nl=model1.predict(x_data_test)\ncheck=y_data_test['Potability'].to_numpy()\ncorrect=sum(l==check)\nprint(correct\/len(check))","70712703":"#Sgd Classifier\nmodel.fit(x_data_train,y_data_train)\nl=model.predict(x_data_test)\ncheck=y_data_test['Potability'].to_numpy()\ncorrect=sum(l==check)\nprint(correct\/len(check))","144de43c":"**Lots of Null values so will fix that**","5762f25e":"**I have evaluated the performance of 4 algorithms namely: Stochastic Gradient Descent, Logistic Regression, Decision Trees and Support Vector Machines**","6703f872":"****","a5a56a48":"**As we can see the decision tree model beats every other model with an accuracy of 63%**","ddbacbb6":"**Just checking above whether the stratified split works well or not. I am learning along too**","4ff88100":"**Splitting into train and test sets and keeping the test set aside**","963d173e":"**Fiting the data and performance of the data on test sets**"}}