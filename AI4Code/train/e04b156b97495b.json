{"cell_type":{"542feab2":"code","ae31093e":"code","e2a1cf44":"code","80aa06d4":"code","9f846e8b":"code","c96a3cc9":"code","176f6c80":"code","fc3d3686":"code","e4b1b484":"code","5bb76797":"code","13afa4d9":"code","e3581bb5":"code","d05eb4fd":"code","d413c0ee":"code","482baf3d":"code","d33ff74e":"code","13209ebf":"code","eb19b076":"code","644d8355":"code","b1b496dc":"code","61a75e30":"code","110eb8ad":"code","cbbf23e2":"code","a54fd491":"code","3ad62601":"code","49126a9d":"code","3458e59b":"code","fab14f57":"code","a71c0e8c":"markdown","b252125a":"markdown","85bbd076":"markdown","74eac334":"markdown","e3bc6f72":"markdown","f146dae5":"markdown","e1aa8ac8":"markdown","60aab9cb":"markdown","90c838b7":"markdown","2279d2b8":"markdown","e047a2d3":"markdown","2eff9c43":"markdown","2f0535ae":"markdown","78fa4721":"markdown","2ae9555b":"markdown","d559d0ba":"markdown","5a5f3910":"markdown","033b3f70":"markdown","2fcaa5b1":"markdown","431d40f5":"markdown","9869887d":"markdown","b7697da7":"markdown","142e77ba":"markdown","a425ce92":"markdown","11dc167e":"markdown","e1ca5f94":"markdown"},"source":{"542feab2":"import pandas as pd\n%matplotlib inline\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport seaborn as sns","ae31093e":"#Read the data\nairplane =pd.read_csv('..\/input\/Airplane_Crashes_and_Fatalities_Since_1908.csv', parse_dates=['Date'], index_col='Date' )\nairplane.head(2)","e2a1cf44":"# Add another column in airplane dataframe for survivors \nairplane['Survivor']=airplane['Aboard']-airplane['Fatalities']\nairplane.head(2)","80aa06d4":"# plot using pandas plot\nsurvior=airplane.resample('YS').agg({'Survivor':'sum',\n                                    'Ground':'sum',\n                                    'Fatalities':'sum',\n                                    'Aboard':'sum'})\nsx=survior.plot(kind='line',figsize=(15,5))","9f846e8b":"#Find % of Total ground fatalities and % of total \nag=airplane.resample('YS').agg({'Ground':['sum',lambda x: x.sum()\/airplane['Ground'].sum()]})\n\n#Label the columns\nag.columns = ag.columns.map('_'.join).str.replace('<lambda>','% of Total')\n\n#Find the year when maximun ground fatalities happened\nag.sort_values(by=['Ground_% of Total'],ascending=False).head()","c96a3cc9":"aa=airplane.resample('YS').agg({'Fatalities':'sum'}).sort_values(by=['Fatalities'], ascending =False)\naa.rename(columns={'Fatalities':'Total Fatalities per year'}).head(10)\n","176f6c80":"# Find sum and % of Total fatalities by Operator\ngp=airplane.groupby('Operator').agg({'Fatalities':['sum',lambda x: x.sum()\/airplane['Fatalities'].sum()]})\n\n#Flatten the multiindex \ngp.columns=gp.columns.map('_'.join)\n\n#Rename Columns\ngp.rename(columns={'Fatalities_sum':'Total Fatalities',\n                   'Fatalities_<lambda>':'% of Total Fatalities'},inplace=True)\n\n#Sort by Total Fatalities\ngp.sort_values(by='Total Fatalities', ascending=False).head()\n","fc3d3686":"filt=airplane['Operator']=='Aeroflot'\nairplane2=airplane[filt]\nairplane2.resample('YS').agg({'Fatalities':'sum'}).plot(kind='line',figsize=(15,5));","e4b1b484":"gp.reset_index(inplace=True)","5bb76797":"#List of all operators with word aeroflot \nfilt=gp['Operator'].str.contains('Aeroflot')\naeroflot=gp[filt]\naeroflot.head()\n","13afa4d9":"#aeroflot['Operator'].unique()\n\n#no. of uniques operators with word 'Aeroflot' in it\naeroflot['Operator'].nunique()","e3581bb5":"aeroflot.groupby('Operator').agg({'Total Fatalities':sum}).sort_values(by='Total Fatalities', ascending=True).plot.barh();","d05eb4fd":"filt=airplane['Operator']=='Aeroflot'\naerotype=airplane.loc[filt,['Operator','Type','Fatalities']]\naerotype.head()","d413c0ee":"aerotype.groupby('Type').agg({'Fatalities':'sum'}).sort_values('Fatalities',ascending=False).head(10)","482baf3d":"gp=airplane.groupby('Location').agg({'Fatalities':['sum',lambda x: x.sum()\/airplane['Fatalities'].sum()]})\n\n#Flatten the multiindex \ngp.columns=gp.columns.map('_'.join)\n\n#Rename Columns\ngp.rename(columns={'Fatalities_sum':'Total Fatalities',\n                   'Fatalities_<lambda>':'% of Total Fatalities'},inplace=True)\n\n#Sort by Total Fatalities\ngp.sort_values(by='Total Fatalities', ascending=False).head()","d33ff74e":"tg=pd.Grouper(freq='YS')\nairplane.groupby([tg,'Registration']).agg({'Fatalities':'sum'}).sort_values(by=['Fatalities'],ascending=False).head(10)","13209ebf":"#tg=pd.Grouper(freq='YS')\nairplane.groupby(['Type']).agg({'Fatalities':'sum'}).sort_values(by=['Fatalities'],ascending=False).head(10).plot.bar()","eb19b076":"filt=airplane['Type']=='Douglas DC-3'\ndoug=airplane.loc[filt,['Operator','Fatalities']].sort_values('Fatalities', ascending=False)\ndoug.head(10)","644d8355":"airplane['Route'].isna().count()","b1b496dc":"airplane['Route'].notna().count()","61a75e30":"#No. of plane crashes per route\nroute=airplane.groupby('Route').agg({'Fatalities':['sum',lambda x:x.sum() \/ airplane['Fatalities'].sum()]})\nroute.head()","110eb8ad":"route.columns=route.columns.map(''.join)\nroute.head()","cbbf23e2":"route.reset_index(inplace=True)\nroute.head()","a54fd491":"route.rename(columns={'Fatalitiessum':'Total Fatalities',\n                      'Fatalities<lambda>':'% of Total Fatalities'}, inplace=True)\nroute.head()","3ad62601":"#Sort by desc\nroute.sort_values(by='Total Fatalities', ascending=False).head()","49126a9d":"route=airplane.loc[airplane['Route']=='Training',['Route','Aboard','Fatalities']]\nroute.head()","3458e59b":"# No. of Trainig flights per year\nroute.resample('YS').size().plot(kind='line', figsize=(10,5));","fab14f57":"route.resample('YS').agg({'Fatalities':['sum'],\n                         'Aboard':'sum'}).plot(kind='line', figsize=(10,5));","a71c0e8c":"### Multiple operators with word 'Aeroflot' in the name\nThere are multiple operators with word 'Aeroflot' in them. Let's find out more about them to see if all such Operators need to be combined together or not.","b252125a":"### Which was the worst year to fly ?\n","85bbd076":"Aerofloat is not among top 10 users of Douglas DC-3. So we can conclude that it's not the combination of Aerofloat and Douglas DC-3 that has been fatal.","74eac334":"### Does Registartion No. has anything to do with the crashes?","e3bc6f72":"### Did things become better over time for Aeroflot?","f146dae5":"Douglas DC-3 is atleast 5 times more probable to crash than any other type of aircraft\n","e1aa8ac8":"Russia is at 3rd and 4th place but Tenerife, Canary Islands and Japan are the top 2 location of crash. \nIt is interesting to notice how small islands are the leading location of crashes. \n\nIt would have been interesting to check how my total flight flew over these islands and what percentange of flights ended up crashing. There is not enough data to complete this analysis but we can look into the summary field to find out if there was any particular reason of crashes. I'll create another kernel to do text analysis on the summary filed but for now I'll leave it at this point.","60aab9cb":"Top 2 routes are same as we found with Location. Canary Islands and Japan have the highest no. of fatalities. But it is interesting to notice that 'Training' is the 3rd highest Route for crash.\n\nLets see a sample of records for 'Training'","90c838b7":"There are 7 unique Operators under the name of Aerofloat.","2279d2b8":"There isn't any trend evident from the chart above.","e047a2d3":"70s and 80s are among the worst years for airline industry. \n1972 is the worst so far, causing maximum no. of fatalities.\n","2eff9c43":"### Find details about when maximum ground fatalities happened","2f0535ae":" Registration no. doesn't looks like a culprit here","78fa4721":"There is huge difference between Aeroflot and all the other operators combined together. We can combine top 2 together but it will not make any difference in the analysis whether we choose to combine rest of the operator or not.","2ae9555b":"### There is no one Type stands out as the reason. Can it be the location of crash? Let's find out.","d559d0ba":"### Lets dig more on why Aerofloat is performing so bad. Is it using a particular type of aircraft that is causing crashes?","5a5f3910":"### Conclusion:\n1. Don't fly with Aeroflot, there is 68% chance of you dying.\n2. Don't fly in a Douglas DC-3, you are 5 times more probale to die.\n3. And finally, don't take any flight that flies over canary Islands or Japan.","033b3f70":"Route field is only 50% filled. There is not enough information available to impute the values as well. We can't rely much on this field but let's see if there is anything that stands out in 50% of the data where the route is filled in.","2fcaa5b1":"Early 70s was exceptionally bad period for Aeroflot but things started getting better by later half of 70s.\n\nFatalities reduced after 1977-1978 but did things really get better or Aeroflot just decided to fly less and thus less no. of fatalites? There is not enough data to find it out so I'll leave this analysis here.","431d40f5":"### What are the operators that use Douglas DC-3?","9869887d":"### Let's find out if there is any pointer in Route information","b7697da7":"### Who has turned out to be worst operator?","142e77ba":"### Can it be Type No. ?","a425ce92":"2001 has the maximum ground fatalities, 67% of the total ground fatalities happened in just 1 year.\nWTC attack hapenned in year 2001 and this explains the reason of sudden spike.","11dc167e":"We see that from early 40s till early 70s the fatalities were on rise. The rate started reducing by the late 90s. We can assume that by this time the technology was lot better than it was ever before which might have helped reduce no. of crashes and hence no. of fatalities.\n \nFrom the above chart, we can see that no. of people Aboard, Fatalities and Survivor lines follow appromaximately the same trend. Ground fatalities have been consistently lowest through out but there is an abrupt spike. Let's find out more about it.","e1ca5f94":"Aeroflot is by far the most dangerous operator. People have 68% chances of dying if they flew with Aeroflot than any other operator."}}