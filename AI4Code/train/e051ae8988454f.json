{"cell_type":{"e62a5947":"code","b876b155":"code","62785898":"code","3d5a03a7":"code","1a74af8e":"code","9737ce48":"code","70445fd2":"code","065eccf3":"code","8838e6bd":"code","117193ca":"code","8651351c":"code","d1cae51f":"code","7832ada1":"code","165873d7":"code","63efd271":"code","630e5725":"code","32aca906":"code","fd073ca6":"code","890f36cd":"code","17875d0c":"code","be48f4e5":"code","2e917130":"code","c73cc9f6":"markdown","649791cb":"markdown","4fbd6fa4":"markdown","2adfde8f":"markdown","6167f904":"markdown","d7aa59ce":"markdown","1b670de3":"markdown","ec76424a":"markdown","2437ccaa":"markdown","d4522024":"markdown","f3d98028":"markdown"},"source":{"e62a5947":"# loading Required Libraries\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","b876b155":"df = pd.read_csv(\"https:\/\/raw.githubusercontent.com\/anilak1978\/customer-churn\/master\/WA_Fn-UseC_-Telco-Customer-Churn.csv\")\ndf.head()","62785898":"# check for missing values\ndf.isnull().sum()","3d5a03a7":"# Total Charges have empty values that needs to be handled\nspaced_values = df[\"TotalCharges\"].str.contains(' ')\nspaced_values.value_counts()","1a74af8e":"# replace these 11 values to np.nan, drop them and update the data type\ndf[\"TotalCharges\"]=df[\"TotalCharges\"].replace(\" \", np.nan)\ndf.dropna(subset=[\"TotalCharges\"], inplace=True)\ndf.reset_index(drop=True, inplace=True)\ndf[[\"TotalCharges\"]]=df[[\"TotalCharges\"]].astype(\"float\")","9737ce48":"# check the data types to make sure they are correct\ndf.dtypes","70445fd2":"# check unique values for each column\nfor column in df.columns.values.tolist():\n    print(column)\n    print(df[column].unique())\n    print(\"\")","065eccf3":"# some of the column values needs to be updated\nupdate_col = [\"OnlineSecurity\", \"OnlineBackup\", \"DeviceProtection\", \"TechSupport\", \"StreamingTV\", \"StreamingMovies\"]\nfor i in update_col:\n    df[i]=df[i].replace({\"No internet service\": \"No\"})","8838e6bd":"# For the sake of analysis update Churn to numerical variables\ndf[\"Churn\"]=df[\"Churn\"].replace({\"No\": 0, \"Yes\": 1})\ndf[[\"Churn\"]]=df[[\"Churn\"]].astype(\"float\")\ndf[\"Churn\"].dtypes","117193ca":"# Look at the categorical variables distribution\ncategorical_variables = [\"gender\", \"SeniorCitizen\", \"Partner\", \"Dependents\", \"PhoneService\", \"MultipleLines\", \"InternetService\",\n                        \"OnlineSecurity\", \"OnlineBackup\", \"DeviceProtection\", \"TechSupport\", \"StreamingTV\", \"Contract\", \"PaperlessBilling\",\n                        \"PaymentMethod\"]\n\nfor i in categorical_variables:\n    plt.figure(figsize=(10,5))\n    sns.countplot(x=df[i], data=df)\n    plt.title(\"Categorical Variable Distribution\")","8651351c":"# Looking at the churn rate for each categorical variable\nfor i in categorical_variables:\n    plt.figure(figsize=(10,5))\n    data=df.groupby(i)[\"Churn\"].mean().reset_index()\n    sns.barplot(x=data[i], y=\"Churn\", data=data)","d1cae51f":"# looking at distribution on numerical variables\nnumerical_variables = [\"TotalCharges\", \"tenure\", \"MonthlyCharges\"]\nfor i in numerical_variables:\n    plt.figure(figsize=(10,5))\n    sns.distplot(df[i])","7832ada1":"# Looking at the correlation between numerical variables\ncorr=df.corr()\nplt.figure(figsize=(10,5))\nsns.heatmap(corr, annot=True)","165873d7":"# looking at linear relationship on numerical variables\nfor i in numerical_variables:\n    plt.figure(figsize=(10,5))\n    data=df.groupby(i)[\"Churn\"].mean().reset_index()\n    sns.regplot(x=data[i], y=\"Churn\", data=data)","63efd271":"df.columns","630e5725":"# creating feature set and target\nX = df[[\"Partner\", \"tenure\", \"InternetService\", \"Contract\", \"PaperlessBilling\", \"MonthlyCharges\"]].values\ny=df[[\"Churn\"]]\nX[0:5]","32aca906":"df[\"PaymentMethod\"].unique()","fd073ca6":"# preprocessing using LabelEncoder()\nfrom sklearn import preprocessing\n\npartner=preprocessing.LabelEncoder()\npartner.fit([\"No\", \"Yes\"])\nX[:,0]=partner.transform(X[:,0])\n\ninternetservice=preprocessing.LabelEncoder()\ninternetservice.fit([\"DSL\", \"Fiber optic\", \"No\"])\nX[:,2]=internetservice.transform(X[:,2])\n\ncontract=preprocessing.LabelEncoder()\ncontract.fit([\"Month-to-month\", \"One year\", \"Two year\"])\nX[:,3]=contract.transform(X[:,3])\n\npaperlessbilling=preprocessing.LabelEncoder()\npaperlessbilling.fit([\"No\", \"Yes\"])\nX[:,4]=paperlessbilling.transform(X[:,4])\n\nX[0:5]","890f36cd":"# split the dataset to train and test for fitting and model creation\nfrom sklearn.model_selection import train_test_split\nX_trainset, X_testset, y_trainset, y_testset = train_test_split(X, y, test_size=0.2, random_state=3)","17875d0c":"from sklearn.ensemble import RandomForestClassifier\nrf_model = RandomForestClassifier(n_estimators=100)\nrf_model.fit(X_trainset, y_trainset.values.ravel())","be48f4e5":"# create prediction\nrf_pred=rf_model.predict(X_testset)\nrf_pred[0:5]","2e917130":"# use metrics accuracy score for model evaluation\nfrom sklearn import metrics\nmetrics.accuracy_score(y_testset, rf_pred)","c73cc9f6":"## Data Collection and Cleaning","649791cb":"## Conclusion\n\nWe can predict 77% of the time if an individual will leave or stay as a customer. We can try different classification methods such as support vector machines or logistic regression to improve this accuracy. We can also see if we can select better variables as part of the feature set. I will continue to work on different data sets as part of solving a customer churn problem for a business.","4fbd6fa4":"## Model Development","2adfde8f":"# Customer Churn Prediction for Telecom Services \n\n## Introduction\n\nThis is another example of a customer churn problem for a business, and this time I will be looking at a dataset for a telecommunication company. The business problem is straight forward. \"Can we define the customers that are leaving us and which ones potentially will leave us in the future?\" Solving this problem statement will help the telecommunication company take neccessary measures to keep these individuals as customers. \n\nThe dataset is publicly available and being used for educational purposes within Data Science programs. It doesnt have the neccessary features to define the exact cause of the churn such as contractual, voluntary or involuntary, however it might give us an idea of features to improve for the benefit of the business.","6167f904":"## Data Exploration","d7aa59ce":"## Model Evaluation","1b670de3":"## Analytical Approach\n\nBased on the business problem and objective around identifying customers that are likely to stay or leave the services, I can use classification method where i can define \"Churn\" variable as the target (response variable) and select feature set within the customer attributes. From the classification methods, for this particular data set, I will use Decision Trees, particularly Random Forest.\n\nAddition to the data exploration, the domain expertise and knowledge is really important when it comes to feature selection and engineering. I wont be performing any feature engineering in this instance however my selection will be based on the analysis performed above. I will look at each variable and decide if i will include to my feature set.\n\n**customerID: Unique identifier and wont be in the feature set**\n\n**gender: When we look at the gender churn rate, it is around the same for both female and male customers. It doesnt provide any value and wont be in the feature set.**\n\n**SeniorCitizen: Churn rate provides us some direction however the distribution is not normal and wont be included in the feature set.**\n\n**Partner: It is normally distributed and churn rate provides value. will be included in the feature set.**\n\n**Dependents: Churn rate provides us some direction however the distribution is not normal and wont be included in the feature set.**\n\n**tenure: There is linear relationship with churn rate and will be included in the feature set.**\n\n**PhoneService: Churn rate provides us some direction however the distribution is not normal and wont be included in the feature set.**\n\n**MultipleLines: Churn rate provides us some direction however the distribution is not normal and wont be included in the feature set.**\n\n**InternetService: It is normally distributed and churn rate provides value. will be included in the feature set.**\n\n**OnlineSecurity: Churn rate provides us some direction however the distribution is not normal and wont be included in the feature set.**\n\n**OnlineBackup: Churn rate provides us some direction however the distribution is not normal and wont be included in the feature set.**\n\n**DeviceProtection: Churn rate provides us some direction however the distribution is not normal and wont be included in the feature set.**\n\n**TechSupport: Churn rate provides us some direction however the distribution is not normal and wont be included in the feature set.**\n\n**StreamingTV: Churn rate provides us some direction however the distribution is not normal and wont be included in the feature set.**\n\n**StreamingMovies: Churn rate provides us some direction however the distribution is not normal and wont be included in the feature set.**\n\n**Contract: It is normally distributed and churn rate provides value. will be included in the feature set.**\n\n**PaperlessBilling: It is normally distributed and churn rate provides value. will be included in the feature set.**\n\n**PaymentMethod: Churn rate provides us some direction however the distribution is not normal and wont be included in the feature set.**\n\n**MonthlyCharges: There is linear relationship with churn rate and will be included in the feature set.**\n\n**TotalCharges: It is highly correlated with Monhtly Charges and wont be inclduded in the feature set.**\n\n\nThere are multiple factors that impact the feature selection. The feature set needs to be normally distributed for machine learning algorithm's to properly perform predictions, unique identifiers and numerical variables that are highly correlated are useless. ","ec76424a":"Based on the Churn Rate for each categorival variable:\n\n**The Churn rate for female and male customers are around the same**\n\n**Senior Citizens customers leave the Telecom company much more than Non-Senior Citizens.**\n\n**Customers without partners leave more than the ones with partners**\n\n**Customers without dependents leave more than the ones with partners**\n\n**Churn rate for Phone Service subsricers and non subscribers are around the same**\n\n**Churn rate for MulitpleLines subscription is around the same**\n\n**Churn rate for Fiber Optic Internet Service subsribers is significantly higher**\n\n**Non subsricbers for Device Protection, Online Security, Online Back up and Tech Support is higher**\n\n**Churn Rate for Month to Month Subsribers and Streaming TV subscribers are higher**\n\n**Churn Rate for Paperless Billing is higher**\n\n**Churn Rate for Electronic Check subscribers are higher**","2437ccaa":"Based on the distribution of the categorical variables:\n\n**The count of male and female customers are around the same**\n\n**There are significantly less Senior Citizens in our dataset**\n\n**The count of partner distribution is around the same**\n\n**There are significantly more customers that doesnt have dependents**\n\n**Majority of the customers have phone service**\n\n**The customers that have phone service; the distribution of multiple lines around the same**\n\n**The distribution of the internet service is normal**\n\n**Most of the customers dont have Online Security, Online Backup and dont have Device Protection, Streaming TV and Tech Support**\n\n**Majority of the customers prefer Month to Month Subsription**\n\n**The distribution of payment method is normal**","d4522024":"I didnt have any missing values in the data set, however, I found empty values in TotalCharges column. I replaced them with np.nan and dropped them from the dataset as part of the cleaning process. When I look at the categorical variables, I realized that one particular level \"No internet service\", did not make sense as there is a separate level called \"No\", so I updated those values for each of those columns. Finally, I updated the Churn variable from categorical variable to numeric to help with our analysis further. \n\nAt this point, the data set is collected, cleaned and ready for analysis.","f3d98028":"## About the Data\n\nEach row of the data represents a customer , each column represents customers' attribute. Below provides full description of each attribute for future reference:\n\n*customerID: Customer ID*\n\n*gender: Whether the customer is a male or a female*\n\n*SeniorCitizen: Whether the customer is a senior citizen or not (1, 0)*\n\n*Partner: Whether the customer has a partner or not (Yes, No)*\n\n*Dependents: Whether the customer has dependents or not (Yes, No)*\n\n*tenure: Number of months the customer has stayed with the company*\n\n*PhoneService: Whether the customer has a phone service or not (Yes, No)*\n\n*MultipleLines: Whether the customer has multiple lines or not (Yes, No, No phone service)*\n\n*InternetService: Customer\u2019s internet service provider (DSL, Fiber optic, No)*\n\n*OnlineSecurity: Whether the customer has online security or not (Yes, No, No internet service)*\n\n*OnlineBackup: Whether the customer has online backup or not (Yes, No, No internet service)*\n\n*DeviceProtection: Whether the customer has device protection or not (Yes, No, No internet service)*\n\n*TechSupport: Whether the customer has tech support or not (Yes, No, No internet service)*\n\n*StreamingTV: Whether the customer has streaming TV or not (Yes, No, No internet service)*\n\n*StreamingMovies: Whether the customer has streaming movies or not (Yes, No, No internet service)*\n\n*Contract: The contract term of the customer (Month-to-month, One year, Two year)*\n\n*PaperlessBilling: Whether the customer has paperless billing or not (Yes, No)*\n\n*PaymentMethod: The customer\u2019s payment method (Electronic check, Mailed check, Bank transfer (automatic), Credit card (automatic))*\n\n*MonthlyCharges: The amount charged to the customer monthly*\n\n*TotalCharges: The total amount charged to the customer*\n\n*Churn: Whether the customer churned or not (Yes or No)*"}}