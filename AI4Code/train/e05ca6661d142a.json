{"cell_type":{"36bb4717":"code","f5e8c31c":"code","31a132f0":"code","60b3594f":"code","1bf01a17":"code","03167b8d":"code","1b9f04e5":"code","e87c62c5":"code","cee75642":"code","76666e24":"code","8e036ec8":"code","be4f27a3":"code","89ca678d":"code","1007019e":"code","15a9ab3b":"code","b3a16a37":"code","5ba0ac56":"code","79fadb66":"code","70cc498e":"code","58a1904c":"code","c4671490":"code","e53a6f74":"code","8c120a6c":"code","8de360d6":"code","24c92ee5":"code","8cfd92c0":"code","fe2c53e2":"code","b12f30b7":"code","907b28b3":"code","dfc22dd8":"code","d08771e5":"code","f920c80f":"code","623f4dad":"code","951ec98c":"code","4de90e2b":"code","17f72fc9":"code","aa7dd94b":"code","27e7486d":"code","899e4264":"code","1e1ed333":"code","d9a429d1":"code","6a536db2":"code","42d7797e":"code","d67128d8":"code","e2a7df66":"code","0f676e2e":"code","d12c795a":"code","b7c64405":"code","dd6d8324":"code","89eb0a93":"code","48546dac":"code","c2aa80ec":"code","ebcdb311":"code","42a105c0":"code","b40fe28e":"code","bcfd0095":"code","4ad80b99":"code","b338e2dc":"code","7531985f":"code","4e1f1b93":"code","2651bb01":"code","c60b82de":"markdown","c26dd221":"markdown","fba3e533":"markdown","904de832":"markdown","4ed63afd":"markdown","02a5a814":"markdown","41e1a80c":"markdown","b85a859d":"markdown","6a4cf5ad":"markdown","905a0346":"markdown","7c69a9d8":"markdown","99dcf85e":"markdown","b98bbfc6":"markdown","c4775385":"markdown","ed8c5ec2":"markdown","6d9f460e":"markdown"},"source":{"36bb4717":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","f5e8c31c":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport plotly as pl\nimport plotly.offline as of\nimport cufflinks as cf\nimport datetime as dt\n%matplotlib inline","31a132f0":"of.init_notebook_mode(connected = True)\ncf.go_offline()","60b3594f":"donation = pd.read_csv('\/kaggle\/input\/school-donations\/Donations.csv')\ndonors = pd.read_csv('\/kaggle\/input\/school-donations\/Donors.csv')\nprojects = pd.read_csv('\/kaggle\/input\/school-donations\/Projects.csv')\nresources = pd.read_csv('\/kaggle\/input\/school-donations\/Resources.csv')\nschools = pd.read_csv('\/kaggle\/input\/school-donations\/Schools.csv')\nteachers = pd.read_csv('\/kaggle\/input\/school-donations\/Teachers.csv')","1bf01a17":"print('Shape of donations dataframe is:' , donation.shape)\nprint('Shape of donors dataframe is:' , donors.shape)\nprint('Shape of projects dataframe is:' , projects.shape)\nprint('Shape of resources dataframe is:' , resources.shape)\nprint('Shape of schools dataframe is:' , schools.shape)\nprint('Shape of teachers dataframe is:' , teachers.shape)","03167b8d":"donation.head()","1b9f04e5":"donors.head()","e87c62c5":"projects.head(2)","cee75642":"resources.head()","76666e24":"schools.head()","8e036ec8":"teachers.head()","be4f27a3":"donation.describe()","89ca678d":"donors.describe()","1007019e":"projects.describe()","15a9ab3b":"resources.describe()","b3a16a37":"schools.describe()","5ba0ac56":"teachers.describe()","79fadb66":"data = pd.merge(donation, projects, how = 'inner', on = 'Project ID')","70cc498e":"data2 = pd.merge(data , donors , how='inner' , on='Donor ID')\n","58a1904c":"data3 = pd.merge(data2 , schools , how='inner' , on='School ID')","c4671490":"data4 = pd.merge(data3, teachers , how='inner' , on='Teacher ID')","e53a6f74":"data4.head()","8c120a6c":"a = data4.columns.tolist()\na","8de360d6":"school_data = schools['School State'].value_counts().sort_values(ascending = False).head(10)\nschool_data","24c92ee5":"school_data.iplot(kind='bar' , xTitle='States' , yTitle='Number of schools' , title='Number of schools involved in projects by states')","8cfd92c0":"donation_cost = data4.groupby('School State')['Donation Amount'].mean().sort_values(ascending = False).head(10)\ndonation_cost","fe2c53e2":"donation_cost.iplot(kind='bar' , xTitle='States' , yTitle='Averrage donation per project' , title='top 10 state')","b12f30b7":"mean = np.mean(data4['Donation Amount'].dropna())\nmedian = np.median(data4['Donation Amount'].dropna())\npercentiles = np.percentile(data4['Donation Amount'].dropna() ,[25,75])\nminimum = data4['Donation Amount'].dropna().min()\nmaximum = data4['Donation Amount'].dropna().max()\n\nprint('mean donation amount is:' ,np.round(mean,2))\nprint('median donation amount is:' ,median)\nprint('25% and 75% donation amount is:' ,percentiles)\nprint('minimum donation amount is:' ,minimum)\nprint('maximum donation amount is:' ,maximum)","907b28b3":"x = np.sort(data4['Donation Amount'].dropna())\ny = np.arange(1,len(x)+1)\/len(x)\nplt.plot(x,y,marker = '.')","dfc22dd8":"s3 = data4.groupby('Donor State')['Donation ID'].count().sort_values(ascending = False).head(15)\ns3","d08771e5":"s3.iplot(kind='bar' , xTitle='State',yTitle='Number of donations',title='Donations count',colorscale='paired')","f920c80f":"s4 = schools['School State'].value_counts()\ns5 = data4.groupby('Donor State')['Donation ID'].count()\ndf = pd.concat([s4,s5],axis=1,keys=['Projects','Donations'])","623f4dad":"df","951ec98c":"df = df.dropna()\ndf","4de90e2b":"df.iplot(kind='scatter',xTitle='Projects',\n         yTitle='Donations',title='Projects vs Donations',\n         symbol='x',colorscale='paired',mode='markers')","17f72fc9":"slope,intercept = np.polyfit(df.Projects,df.Donations,1)\nx = np.array([df.Projects.min(),df.Projects.max()])\ny = slope*x + intercept\nplt.plot(x,y)","aa7dd94b":"df.plot.scatter(x='Projects' , y='Donations')\nslope,intercept = np.polyfit(df.Projects,df.Donations,1)\nx = np.array([df.Projects.min(),df.Projects.max()])\ny = slope*x + intercept\nplt.plot(x,y)\nplt.tight_layout()\nplt.margins(0.05)","27e7486d":"data4.head(2)","899e4264":"s6 = data4[\"Project Type\"].value_counts()\ns6","1e1ed333":"s7 = data4.groupby('Project Type')['Donation Amount'].sum().astype(int)\ns7","d9a429d1":"plt.subplot(2,1,1)\nplt.pie(s6 , startangle=90)\nplt.subplot(2,1,2)\nplt.pie(s7 , startangle=90)\nplt.tight_layout()\nplt.margins(0.05)\nfig = plt.gcf()\nfig.set_size_inches(25,15)","6a536db2":"data4['Project Subject Category Tree'].nunique()","42d7797e":"s8 = data4.groupby('Project Subject Category Tree')['Donation Amount'].sum().astype(int).sort_values(ascending = False).head(15)\ns8","d67128d8":"s9 = s8\/1000000\ns9.iplot(kind=\"bar\" , xTitle='Project sub category' , yTitle='Donation amount in millions',\n        title='Donation amount by project subject' , colorscale='paired')","e2a7df66":"data4[['Project Posted Date' , 'Project Fully Funded Date']].isnull().sum()","0f676e2e":"data4[['Project Posted Date' , 'Project Fully Funded Date']].head()","d12c795a":"data4['Project Posted Date'] = pd.to_datetime(data4['Project Posted Date'])","b7c64405":"data4['Project Fully Funded Date'] = pd.to_datetime(data4['Project Fully Funded Date'])","dd6d8324":"data4['Funding Time'] = data4['Project Fully Funded Date'] - data4['Project Posted Date'] \ndata4[['Funding Time','Project Posted Date' , 'Project Fully Funded Date']].head()","89eb0a93":"data4[['Funding Time','Project Posted Date' , 'Project Fully Funded Date']].isnull().sum()","48546dac":"data5 = data4[pd.notnull(data4['Funding Time'])]\ndata5[['Funding Time','Project Posted Date' , 'Project Fully Funded Date']].isnull().sum()","c2aa80ec":"import datetime as dt\ndata5['Funding Time'] = data5['Funding Time'].dt.days","ebcdb311":"data5[['Funding Time','Project Posted Date' , 'Project Fully Funded Date']].head()","42a105c0":"wrong_overall_mean_time = data5['Funding Time'].mean()\nwrong_overall_mean_time","b40fe28e":"overall_mean_time = data5.groupby('Project ID')['Funding Time'].mean()\noutput = overall_mean_time.mean()\noutput","bcfd0095":"#Average funding time for each state\n\nstate_project_funding_time = data5.groupby(['School State' , 'Project ID'])['Funding Time'].mean()\nstate_project_funding_time","4ad80b99":"state_average_project_funding_time = state_project_funding_time.groupby('School State').mean()\nstate_average_project_funding_time.round(0)","b338e2dc":"fast = state_average_project_funding_time.round(0)\nfast[fast<32].sort_values().head(10)","7531985f":"fast_funding = fast[fast<32].sort_values().head(10)\nfast_funding.iplot(kind='bar' , xTitle='States' , yTitle='fully funding time(in days)',\n                  title='states that fund projects earlier than others',\n                  colorscale='paired')","4e1f1b93":"slow = state_average_project_funding_time.round(0)\nslow[slow>32].sort_values(ascending = False).head(10)","2651bb01":"slow_funding = slow[slow>32].sort_values(ascending = False).head(10)\nslow_funding.iplot(kind='bar' , xTitle='States' , yTitle='fully funding time(in days)',\n                  title='states that fund projects earlier than others'\n                  )","c60b82de":"How mant project subject category trees exists ? Which ones attracted the most donations ?","c26dd221":"**analysing data**\n","fba3e533":"Which states are the best and which are the worst performing in terms of this criteria ( mean project fully funded time) ??","904de832":"**fit a linear model which will basically indicate the relationship between projects and donations.**","4ed63afd":"Thank you\n","02a5a814":"**Analyse the Maximum , minimum , mean ,meadian and 25 and 75% percentiles of Donations?**","41e1a80c":"**merging data**","b85a859d":"How mant different project types exists ? What is the total donation amount for each of them ?","6a4cf5ad":"**In which states there are more donations done by donors.**","905a0346":"**Which 10 states have the most number of schools that opened projects to gather donations ? Plot the data using bar plot.**","7c69a9d8":"**What are the top 10 states in which schools gathered most amount of AVERAGE donations for their projects ?**","99dcf85e":"**Now, it is time for a more advanced question ? Is there a relationship between the number of projects offered and number of donations made by the donors. Which states performing better in this case ? How many of them responding project requests below average and which states are performing best in terms of donations per project ? In order to answer this question we must first get the number of projects per state and then number of donations made per state. Then we should merge this two and plot a scatter plot to visualize it . Lets do it !**","b98bbfc6":"**Load datasets**","c4775385":"We can immediately observe from above statistics that our Donations Amount column have lots of outliers since mean is 60 whereas median is 25 which shows that there are plenty of outliers causing mean to rise, second indicator is that we have 25th and 75th percentiles both below than mean. In other words although %75 percent of our data smaller than 50 we have a mean values which is 60.66 which is also a good indicator of outliers. Lastly we can easily say that maximum value is a huge outlier too.\n\n**In which percent the data has points greater or smaller than the value shown in the x axis.**","ed8c5ec2":"combine the plot","6d9f460e":"Lets move to the timings now\nWhat is the mean time that takes a project to be fully funded after posted and how it varies between states ?"}}