{"cell_type":{"36974641":"code","44d2b857":"code","b985a859":"code","9cb17238":"code","94ddf86f":"code","1a0d91fa":"code","0d9e4a92":"code","b0b501cd":"code","4359c8c5":"code","67e80a59":"markdown","de9321a7":"markdown","8c98368e":"markdown","bec1d073":"markdown","2154f9f6":"markdown","c9a6d3fc":"markdown","8645b633":"markdown","7bb729d6":"markdown"},"source":{"36974641":"import statistics\nimport scipy.io\nimport numpy as np\nimport pandas as pd\n%matplotlib inline\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set(style=\"darkgrid\")\npd.set_option('display.max_columns', None)\n\nimport os\nfrom datetime import date, timedelta, datetime\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\nfrom scipy.fft import fft, ifft, fftfreq","44d2b857":"data_path = '\/kaggle\/input\/BloodPressureDataset\/'","b985a859":"test_part = scipy.io.loadmat(''.join([data_path, f'part_{12}.mat']))['p'][0]","9cb17238":"test_sample = test_part[0]\nprint(test_sample.shape)","94ddf86f":"ppg, abp, ecg = test_sample\nprint(ppg.shape, abp.shape, ecg.shape)","1a0d91fa":"def array_fft(signal, sample_rate, zoom_ratio=1):\n\n    sample_signal = signal\n    sample_size = sample_signal.size\n    print(f\"sample_size {sample_size}\")\n    \n    # no matter even or odd\n    med_ind = (sample_size \/\/ 2)\n    print(f\"med_ind {med_ind}\")\n    sampling_rate = sample_rate\n    sample_space = 1 \/ sampling_rate\n    t = np.linspace(0, 0+(sample_size*sample_space), sample_size)\n    xf = fftfreq(t.size, sample_space)\n    yf = (fft(sample_signal) \/ sample_size)[1:]\n    yfm = np.abs(yf)\n\n    zoom_freq = int(med_ind * zoom_ratio)\n    xfr = xf[:med_ind][:zoom_freq]\n    yfmr = yfm[:med_ind][:zoom_freq] \n    print(f\"xfr_length {xfr.size}\")\n    max_ind = np.argmax(yfmr)\n    print(f\"max_freq {xfr[max_ind]}, minute_freq {xfr[max_ind] * 60}, max_amp {yfmr[max_ind]}\")\n    \n    \n    plt.figure(figsize=[18,12])\n    plt.subplot(211)\n    plt.plot(sample_signal[:3*sample_rate])\n\n    plt.subplot(212)\n    plt.plot(xfr, yfmr)\n    \n\n\n    plt.show()","0d9e4a92":"array_fft(ppg, sample_rate=125, zoom_ratio=0.7)","b0b501cd":"array_fft(abp, sample_rate=125, zoom_ratio=0.7)","4359c8c5":"array_fft(ecg, sample_rate=125, zoom_ratio=0.7)","67e80a59":"# Load Data","de9321a7":"* - ppg freq is 1.67hz, is it means 1.67* 60 = 100.38 beats per minute? ","8c98368e":"## abp fft","bec1d073":"- 2021-3-31 18:09:56\n- study scipy fft on time series","2154f9f6":"## ppg fft","c9a6d3fc":"ecg need to further analysis, maybe add filters?","8645b633":"# FFT","7bb729d6":"similar to ppg"}}