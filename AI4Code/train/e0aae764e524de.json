{"cell_type":{"827fedd7":"code","a5a5ab1e":"code","04ae2e00":"code","b925566d":"code","28954959":"code","0bd78204":"code","3a6f6676":"code","fc938933":"code","fb593434":"code","02a5bbea":"code","0d21fdb3":"code","51a837c7":"code","bc8a64ea":"code","acae70ea":"code","52a89ed0":"code","a8d16925":"code","727bb117":"code","dc0e8296":"code","e9842372":"code","8e208582":"code","2d0ecf59":"code","b2e43e96":"code","916dc83b":"code","435ec092":"markdown"},"source":{"827fedd7":"import pandas as pd \nimport numpy as np\nfrom sklearn.linear_model import SGDClassifier as SGD\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression as LR\nfrom sklearn.ensemble import RandomForestClassifier as RFC\nfrom sklearn.naive_bayes import GaussianNB as GNB\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.feature_selection import SelectFromModel\nfrom sklearn.svm import SVC\nfrom sklearn.preprocessing import PolynomialFeatures\nfrom sklearn.pipeline import make_pipeline\nfrom sklearn.neighbors import KNeighborsClassifier as knn\nfrom sklearn.model_selection import GridSearchCV, cross_val_score\nfrom sklearn.decomposition import PCA\n#from sklearn.feature_selection import SequentialFeatureSelector as SFS","a5a5ab1e":"numerical = ['raisedhands','AnnouncementsView','Discussion']\nx_features = ['gender','NationalITy','PlaceofBirth','StageID','GradeID','SectionID','Topic','Semester','Relation','ParentAnsweringSurvey','StudentAbsenceDays','Class','ParentschoolSatisfaction','raisedhands','AnnouncementsView','Discussion']\nlabel = \"VisITedResources\"\ninput_csv = \"..\/input\/xAPI-Edu-Data\/xAPI-Edu-Data.csv\"","04ae2e00":"df = pd.read_csv(input_csv)","b925566d":"df","28954959":"df.describe()","0bd78204":"def visited_categorizing(x):\n    if(x>=75):\n        return \"A\"\n    if(x>=30):\n        return \"B\"\n    if(x>=0):\n        return \"C\"","3a6f6676":"df[label]  = df[label].apply(visited_categorizing)","fc938933":"from sklearn import preprocessing\ncategorical = ['gender',\"VisITedResources\",'NationalITy','PlaceofBirth','StageID','GradeID','SectionID','Topic','Semester','Relation','ParentAnsweringSurvey','StudentAbsenceDays','Class','ParentschoolSatisfaction']\n\nle = preprocessing.LabelEncoder()\nfor x in categorical:\n    le.fit(df[x])\n    df[x] = le.transform(df[x])\n","fb593434":"df","02a5bbea":"X = df[x_features]\ny = df[label]","0d21fdb3":"X.keys()","51a837c7":"X_train, X_test, y_train, y_test = train_test_split( X, y, test_size=0.25, random_state=42)","bc8a64ea":"clf = make_pipeline(SelectFromModel(RFC()), RFC())","acae70ea":"clf","52a89ed0":"grid_param = [{\n     'randomforestclassifier' : [RFC()],\n     'randomforestclassifier__n_estimators' : [2000],\n#     'randomforestclassifier__max_depth' : [11],#removed 5,8,\n#     'randomforestclassifier__min_samples_leaf' : [5],#removed 1,2,5\n#    'randomforestclassifier__max_leaf_nodes' : [41,42,43,45,47]#removed 2,5\n}]","a8d16925":"grid_search = GridSearchCV(clf,grid_param,cv=2,verbose = 5 , n_jobs = -1 )","727bb117":"model = grid_search.fit(X_train,y_train)","dc0e8296":"model.best_estimator_","e9842372":"model.score(X_test,y_test)","8e208582":"model.score(X_train,y_train)","2d0ecf59":"import pickle\nfilename = 'H4_model.sav'\npickle.dump(model, open(filename, 'wb'))","b2e43e96":"loaded_model = pickle.load(open(filename, 'rb'))\nresult = loaded_model.score(X_test, y_test)","916dc83b":"print(result)","435ec092":"Feel free to change params. I've already tested the parameters and found these to be ideal"}}