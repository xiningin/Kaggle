{"cell_type":{"2a53c221":"code","ba6d9975":"code","d9f91d8f":"code","f08f6ed0":"code","d5eda6c3":"code","d7181f68":"code","f4dd13a3":"code","468a8263":"code","7d104ef1":"code","7ede1c5e":"code","65536f87":"code","ba464969":"code","61856283":"code","31b4fa0d":"code","e4bdaaca":"code","3de8026c":"markdown","3aa1832c":"markdown","34766f9f":"markdown","d5bee38a":"markdown","e40d5cf3":"markdown","dc41c390":"markdown","122c8799":"markdown","60f056ea":"markdown","d3fe6e1f":"markdown","c14f2a38":"markdown","5940f351":"markdown","65bec71d":"markdown","0b71d735":"markdown","347d66be":"markdown"},"source":{"2a53c221":"%matplotlib inline\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport plotly.express as px\nfrom sklearn.linear_model import LinearRegression","ba6d9975":"medical_df = pd.read_csv('..\/input\/insurance\/insurance.csv')\nmedical_df","d9f91d8f":"medical_df.info()","f08f6ed0":"print('SEX:',medical_df['sex'].unique())\nprint('SMOKER:',medical_df['smoker'].unique())\nprint('REGION:',medical_df['region'].unique())","d5eda6c3":"medical_df=pd.get_dummies(medical_df, columns=['region'])\nmedical_df","d7181f68":"medical_df['sex_code']=medical_df.sex.map({'female':0,'male':1})\nmedical_df['smoker_code']=medical_df.smoker.map({'no':0,'yes':1})\nmedical_df","f4dd13a3":"plt.hist(medical_df['age'],bins=(medical_df['age'].max()-medical_df['age'].min()),rwidth=0.9,alpha=0.7)\nplt.title('Distribution of Age')\nplt.xlabel('Age',)\nplt.ylabel('count')\n\nplt.show()","468a8263":"plt.hist(medical_df['bmi'],bins=int(medical_df['bmi'].max()-medical_df['bmi'].min()),rwidth=0.9,color='r')\nplt.title('Distribution of BMI(Body Mass Index)')\nplt.xlabel('BMI')\nplt.ylabel('count')\n\nplt.show()","7d104ef1":"fig = px.histogram(medical_df, \n                   x='charges',  \n                   color='smoker', \n                   color_discrete_sequence=['green', 'grey'],\n                   title='Annual Medical Charges')\nfig.update_layout(bargap=0.1)\n\nfig.show()","7ede1c5e":"fig = px.scatter(medical_df, \n                 x='age', \n                 y='charges', \n                 color='smoker', \n                 opacity=0.8, \n                 hover_data=['sex'], \n                 title='Age vs. Charges')\nfig.update_traces(marker_size=5)\nfig.show()","65536f87":"# split input\/output data\ninput_columns = ['age', 'sex_code','bmi', 'children', 'smoker_code','region_northeast', 'region_northwest', 'region_southeast', 'region_southwest']\ninputs,targets=medical_df[input_columns],medical_df['charges']","ba464969":"#create the model\nmodel = LinearRegression()\n#train the model\nmodel.fit(inputs,targets)\n#generate predictions\npredictions=model.predict(inputs)\n\n","61856283":"def rmse(targets,predictions):\n    return np.sqrt(np.mean([val**2 for val in (targets-predictions)]))","31b4fa0d":"#compute loss to evaluate the model\nloss=rmse(targets,predictions)\nr2_score=model.score(inputs,targets)\n\nprint('Loss:',loss,' R^2 score:',r2_score)","e4bdaaca":"weights_df = pd.DataFrame({\n    'feature': np.append(['age', 'bmi', 'children','smoker_code', 'sex_code', 'region_northeast', 'region_northwest', 'region_southeast', 'region_southwest'], 1),\n    'weight': np.append(model.coef_, model.intercept_)\n})\nweights_df.sort_values('weight', ascending=False)","3de8026c":"#### In this dataset, 'sex','smoker' & 'region' columns contains categorical data.","3aa1832c":"####  the linear regression model.\n\n### $charges = w_1 \\times age + w_2 \\times sex + w_3 \\times bmi + w_4 \\times children + w_5 \\times smoker + w_6 \\times region + b$","34766f9f":"## The Regression Model","d5bee38a":"### Body Mass Index\n\nLet's look at the distribution of BMI (Body Mass Index) of customers, using a histogram and box plot.","e40d5cf3":"### Charges\n\nvisualization of the distribution of \"charges\" i.e. the annual medical charges for for smoker and non-smoker customers,  to distinguish the charges .","dc41c390":"## Data Handling","122c8799":"- 'Sex' & 'Smoker' columns can be encoded to binary data .\n- 'Region' column can be  one hot encoded.","60f056ea":"#### Binary Encoding of 'Sex' & 'Smoker' columns using **map** function","d3fe6e1f":"### Loss\/Cost Function\n\nWe can compare our model's predictions with the actual targets using the **root mean squared error** (RMSE).  \nit can be stated mathematically as follows: \n\n\n\n$$\nrmse=\\sqrt{\\frac{1}{n}\\left(\\sum^n_{i=1}(y_i-y_{predicted}~)^2 \\right)}\n$$ \n  \n  ","c14f2a38":"## Predicting Medical Expenses using Linear Regression\n\nACME Insurance Inc. offers affordable health insurance to thousands of customer all over the United States. As the lead data scientist at ACME, you're tasked with creating an automated system to estimate the annual medical expenditure for new customers, using information such as their age, sex, BMI, children, smoking habits and region of residence.\n  \nEstimates from your system will be used to determine the annual insurance premium (amount paid every month) offered to the customer.\n  \nYou're given a CSV file containing verified historical data, consisting of the aforementioned information and the actual medical charges incurred by over 1300 customers.","5940f351":"$$\nR^2=\\frac{\\sum(y_{predicted}-y_{mean})^2}{\\sum(y_{actual}-y_{mean})^2}\n$$\n","65bec71d":"### Age and Charges\n\nVisualization of the relationship between \"age\" and \"charges\" using a scatter plot. Each point in the scatter plot represents one customer.Values in the \"smoker\" column is used to color the points. Hover Data shows \"sex\".","0b71d735":"## Data Visualization","347d66be":"### AGE\n The minimum age in the dataset is 18 and the maximum age is 64.  "}}