{"cell_type":{"a367ac27":"code","61a36dd4":"code","86942a0f":"code","bf757e00":"code","97e99659":"code","188dc1cf":"code","152c08bb":"code","15514910":"code","589a3951":"code","f425d92a":"code","146514c7":"code","a65ead9d":"code","9eb52ece":"code","6fa852a6":"code","5d35261c":"code","f194c293":"code","86b86860":"code","e37866a4":"code","04d5e759":"code","783c8a55":"code","4caa1b32":"code","59f4c6e2":"code","532b1f7e":"code","1d5e4cb5":"code","de51f6a8":"code","dc1496dd":"code","61fea00b":"code","c294ff7b":"code","c872494d":"code","20eecef6":"code","9f78cb63":"code","6be2f19c":"code","6ab2b64a":"code","abea8011":"code","eeefad46":"code","fdf1e101":"code","427e166d":"code","cb0328e5":"code","3fad8478":"code","ad4fc0fd":"code","8374411c":"code","482439c4":"code","0230f665":"code","9e60f914":"code","5c4576ff":"code","c082dd54":"code","01611b62":"markdown","a12316fb":"markdown","7a4cd426":"markdown","5789daad":"markdown","41b79003":"markdown","17a5c1df":"markdown","326b467c":"markdown","3c0aff9b":"markdown","52efe6de":"markdown","8a621044":"markdown","69f92498":"markdown","3485bb77":"markdown","6de7d055":"markdown","1e3aaee7":"markdown","9964f806":"markdown","2338b1f9":"markdown","3df09317":"markdown","e950e88d":"markdown","b158bf1c":"markdown","20acfa2c":"markdown","80d27b53":"markdown","4cfccdc4":"markdown","e30ec7ce":"markdown","a3be469f":"markdown","8950ca69":"markdown","0fb68658":"markdown","a3b98e85":"markdown","11a15b02":"markdown","a895dfc5":"markdown","06e2d013":"markdown","93de3e23":"markdown","8f72cd48":"markdown","62956c16":"markdown","331b1518":"markdown","6053a3fe":"markdown","55ddd493":"markdown","99cce7d0":"markdown","7a322d8a":"markdown","3214ed01":"markdown","aa8e8c8b":"markdown","1ca8b3aa":"markdown","2c331232":"markdown","7128209e":"markdown","98fedcc7":"markdown","f584b044":"markdown","b9fad76f":"markdown","abc19bbe":"markdown","c00c68fc":"markdown"},"source":{"a367ac27":"import pandas as pd\nimport numpy as np\nimport sqlite3","61a36dd4":"df = pd.read_csv('..\/input\/nba-players-data\/all_seasons.csv')\ndf.drop(df.filter(regex=\"Unname\"),axis=1, inplace=True)\nconn = sqlite3.connect(\"..\/input\/nbasql\/data.sqlite\")","86942a0f":"tables = pd.read_sql(\"\"\"select *\n                        from sqlite_master\n                        where type='table';\"\"\",conn)\ntables","bf757e00":"df.info()","97e99659":"df.head()","188dc1cf":"nbastats = pd.read_sql(\"\"\"select * \n                            from all_seasons\n                            limit 5;\"\"\",conn)\nnbastats","152c08bb":"tr_players = pd.read_sql(\"\"\"select distinct(player_name) \"Player\" \n                            from all_seasons\n                            where country='Turkey';\"\"\",conn)\ntr_players","15514910":"df[\"player_name\"][df[\"country\"]==\"Turkey\"].unique()","589a3951":"tr_total_games = pd.read_sql(\"\"\"select player_name \"Player\",sum(gp) \"Total Games Played\"\n                            from all_seasons\n                            where country=\"Turkey\"\n                            group by player_name\n                            order by 2 desc;\"\"\",conn)\ntr_total_games","f425d92a":"df[\"gp\"][df[\"country\"]==\"Turkey\"].groupby(df[\"player_name\"]).sum().sort_values(ascending=False).to_frame()","146514c7":"tr_avg_stats = pd.read_sql(\"\"\"select player_name \"Player\",round(sum(gp*pts)\/sum(gp),1)\"Avg Points\",\n                            round(sum(gp*reb)\/sum(gp),1)\"Avg Rebs\",\n                            round(sum(gp*ast)\/sum(gp),1)\"Avg Assists\"\n                            from all_seasons\n                            where country=\"Turkey\"\n                            group by player_name\n                            order by 2 desc;\"\"\",conn)\ntr_avg_stats","a65ead9d":"tr_points = round((((df[\"gp\"]*df[\"pts\"])[df[\"country\"]==\"Turkey\"].groupby(df[\"player_name\"]).sum())\/\n (df[\"gp\"][df[\"country\"]==\"Turkey\"].groupby(df[\"player_name\"]).sum())),1).sort_values(ascending=False)\n\ntr_rebs = round((((df[\"gp\"]*df[\"reb\"])[df[\"country\"]==\"Turkey\"].groupby(df[\"player_name\"]).sum())\/\n (df[\"gp\"][df[\"country\"]==\"Turkey\"].groupby(df[\"player_name\"]).sum())),1).sort_values(ascending=False)\n\ntr_assists = round((((df[\"gp\"]*df[\"ast\"])[df[\"country\"]==\"Turkey\"].groupby(df[\"player_name\"]).sum())\/\n (df[\"gp\"][df[\"country\"]==\"Turkey\"].groupby(df[\"player_name\"]).sum())),1).sort_values(ascending=False)\n\ntr_stats = pd.concat([tr_points.rename(\"Avg Points\"),tr_rebs.rename(\"Avg Rebs\"),tr_assists.rename(\"Avg Assists\")],axis=1)\ntr_stats","9eb52ece":"pd.read_sql(\"\"\"select player_name \"Player\",round(sum(pts*gp)\/sum(gp),1) \"Average Points\",sum(gp) \"Games Played\"\n                from all_seasons\n                group by player_name\n                having sum(gp)>=500\n                order by 2 desc\n                limit 10;\"\"\",conn)","6fa852a6":"%%HTML\n<div class='tableauPlaceholder' id='viz1622710017946' style='position: relative'><noscript><a href='#'><img alt='Points Ranking ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NB&#47;NBA1_16227099315990&#47;Sheet1&#47;1_rss.png' style='border: none' \/><\/a><\/noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' \/> <param name='embed_code_version' value='3' \/> <param name='site_root' value='' \/><param name='name' value='NBA1_16227099315990&#47;Sheet1' \/><param name='tabs' value='no' \/><param name='toolbar' value='yes' \/><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NB&#47;NBA1_16227099315990&#47;Sheet1&#47;1.png' \/> <param name='animate_transition' value='yes' \/><param name='display_static_image' value='yes' \/><param name='display_spinner' value='yes' \/><param name='display_overlay' value='yes' \/><param name='display_count' value='yes' \/><param name='language' value='en-US' \/><\/object><\/div>                <script type='text\/javascript'>                    var divElement = document.getElementById('viz1622710017946');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.50)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https:\/\/public.tableau.com\/javascripts\/api\/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                <\/script>","5d35261c":"all_points = round((((df[\"gp\"]*df[\"pts\"]).groupby(df[\"player_name\"]).sum())\/\n (df[\"gp\"].groupby(df[\"player_name\"]).sum())),1).sort_values(ascending=False)\n\nall_games = (df[\"gp\"]).groupby(df[\"player_name\"]).sum().sort_values(ascending=False)\n\npoints_games = pd.concat([all_points.rename(\"Average Points\"),all_games.rename(\"Games Played\")],axis=1)\n\npoints_games[points_games[\"Games Played\"]>=500].head(10)","f194c293":"pd.read_sql(\"\"\"with top3scorer as(select player_name \"player\",season,pts,row_number() \n                over(partition by season order by cast(pts as numeric)desc) \"rank\",gp \"games\"\n                from all_seasons\n                where cast(gp as numeric)>=(\n                case when season='1998-99' then 40\n                else 70 end))\n                select *\n                from top3scorer\n                where rank<4\n                limit 12\n            ;\"\"\",conn)\n# During the 1998-1999 NBA season, each team played only 50 games(due to a lock-out).\n# 1998-1999 Sezonunda, lokavt sebebiyle tak\u0131mlar sadece 50 ma\u00e7 oynam\u0131\u015flard\u0131r.","86b86860":"%%HTML\n<div class='tableauPlaceholder' id='viz1622711618881' style='position: relative'><noscript><a href='#'><img alt='Top 3 Scorers Each Season ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NB&#47;NBA2_16227109222830&#47;Sheet2&#47;1_rss.png' style='border: none' \/><\/a><\/noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' \/> <param name='embed_code_version' value='3' \/> <param name='site_root' value='' \/><param name='name' value='NBA2_16227109222830&#47;Sheet2' \/><param name='tabs' value='no' \/><param name='toolbar' value='yes' \/><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NB&#47;NBA2_16227109222830&#47;Sheet2&#47;1.png' \/> <param name='animate_transition' value='yes' \/><param name='display_static_image' value='yes' \/><param name='display_spinner' value='yes' \/><param name='display_overlay' value='yes' \/><param name='display_count' value='yes' \/><param name='language' value='en-US' \/><\/object><\/div>                <script type='text\/javascript'>                    var divElement = document.getElementById('viz1622711618881');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.50)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https:\/\/public.tableau.com\/javascripts\/api\/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                <\/script>","e37866a4":"df[\"rank\"] = df[(df[\"season\"]==\"1998-99\") & (df[\"gp\"]>=40) | (df[\"gp\"]>=70)].groupby(\"season\")[\"pts\"].rank(method=\"first\",ascending=False)\ndf[[\"player_name\",\"season\",\"pts\",\"rank\",\"gp\"]][df[\"rank\"]<=3].sort_values(by=[\"season\",\"rank\"]).head(12).reset_index(drop=True)","04d5e759":"pd.read_sql(\"\"\"with pts_ranking as(select player_name \"player\",pts,team_abbreviation \"team\",country,row_number() \n            over(partition by team_abbreviation,season order by cast(pts as numeric)desc)\"rank\",season\n            from all_seasons)\n            select *\n            from pts_ranking\n            where country='Turkey'\n            and rank<=3\n            order by 5,2 desc\n            ;\"\"\",conn)","783c8a55":"%%HTML\n<div class='tableauPlaceholder' id='viz1622720523198' style='position: relative'><noscript><a href='#'><img alt='Turkish Players Points Ranking In Their Respective Teams ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NB&#47;NBA3_16227204301000&#47;Sheet2&#47;1_rss.png' style='border: none' \/><\/a><\/noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' \/> <param name='embed_code_version' value='3' \/> <param name='site_root' value='' \/><param name='name' value='NBA3_16227204301000&#47;Sheet2' \/><param name='tabs' value='no' \/><param name='toolbar' value='yes' \/><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NB&#47;NBA3_16227204301000&#47;Sheet2&#47;1.png' \/> <param name='animate_transition' value='yes' \/><param name='display_static_image' value='yes' \/><param name='display_spinner' value='yes' \/><param name='display_overlay' value='yes' \/><param name='display_count' value='yes' \/><param name='language' value='en-US' \/><\/object><\/div>                <script type='text\/javascript'>                    var divElement = document.getElementById('viz1622720523198');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.50)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https:\/\/public.tableau.com\/javascripts\/api\/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                <\/script>","4caa1b32":"df[\"rank\"] = df.groupby([\"team_abbreviation\",\"season\"])[\"pts\"].rank(method=\"first\",ascending=False)\ndf.rename(columns={\"player_name\":\"player\",\"team_abbreviation\":\"team\"})[[\"player\",\"pts\",\"team\",\"country\",\"rank\",\"season\"]][(df[\"country\"]==\"Turkey\") & (df[\"rank\"]<=3)].sort_values(by=[\"rank\",\"pts\"],ascending=[True,False]).reset_index(drop=True)\n# \".rename\" done to give each column an alias. inplace=False","59f4c6e2":"pd.read_sql(\"\"\"with ptspercentage as (select player_name as Player,(\n                select round(sum(gp*pts))\n                from all_seasons as2\n                where as1.player_name=as2.player_name) as PlayerPoints,round(sum((\n                select sum(gp*pts)\n                from all_seasons as3\n                where team_abbreviation in (\n                select as1.team_abbreviation)\n                and season in(\n                select as1.season)))) as TeamPoints\n                from all_seasons as1\n                group by player_name)\nselect Player,cast(PlayerPoints as int)\"PlayerPoints\",cast(TeamPoints as int)\"TeamPoints\",\nround((PlayerPoints\/TeamPoints)*100,1)|| ' ' || '%' as Percentage\nfrom ptspercentage\nwhere TeamPoints>=30000\norder by cast(Percentage as numeric) desc\nlimit 10\n            ;\"\"\",conn)","532b1f7e":"%%HTML\n<div class='tableauPlaceholder' id='viz1622741575147' style='position: relative'><noscript><a href='#'><img alt='Percentage of team points scored by players ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NB&#47;NBA4_16227409259460&#47;Sheet2&#47;1_rss.png' style='border: none' \/><\/a><\/noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' \/> <param name='embed_code_version' value='3' \/> <param name='site_root' value='' \/><param name='name' value='NBA4_16227409259460&#47;Sheet2' \/><param name='tabs' value='no' \/><param name='toolbar' value='yes' \/><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NB&#47;NBA4_16227409259460&#47;Sheet2&#47;1.png' \/> <param name='animate_transition' value='yes' \/><param name='display_static_image' value='yes' \/><param name='display_spinner' value='yes' \/><param name='display_overlay' value='yes' \/><param name='display_count' value='yes' \/><param name='language' value='en-US' \/><\/object><\/div>                <script type='text\/javascript'>                    var divElement = document.getElementById('viz1622741575147');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.50)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https:\/\/public.tableau.com\/javascripts\/api\/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                <\/script>","1d5e4cb5":"player_table = df[[\"player_name\", \"team_abbreviation\", \"season\"]].drop_duplicates()\nteam_points = df.groupby([\"team_abbreviation\", \"season\"]).apply(lambda x: np.sum(x.pts * x.gp)).rename(\"pts\").reset_index()\ndf2 = player_table.merge(team_points, on=[\"team_abbreviation\", \"season\"])\nfinal = round(df2.groupby(\"player_name\")[\"pts\"].sum()).astype(int).sort_values(ascending=False)\n# Note that, unlike SQLite, Pandas does NOT round 0.5 up to 1, hence the different(60841,60840)Team Points values for Malone.\n\nplayer_points = round(((df[\"gp\"]*df[\"pts\"]).groupby(df[\"player_name\"]).sum())).astype(int)\npoints_players_teams = pd.concat([player_points.rename(\"Player Points\"),final.rename(\"Team Points\")],axis=1)\npoints_players_teams[\"Percentage\"] = round((points_players_teams[\"Player Points\"]\/points_players_teams[\"Team Points\"])*100,1)\npoints_players_teams = points_players_teams.sort_values(by=\"Percentage\",ascending=False)\npoints_players_teams[\"Percentage\"] = points_players_teams[\"Percentage\"].astype(str) + \" %\"\npoints_players_teams[points_players_teams[\"Team Points\"]>30000].head(10)","de51f6a8":"pd.read_sql(\"\"\"with ptspercentage as (select player_name as Player,(\n                select round(sum(gp*pts))\n                from all_seasons as2\n                where as1.player_name=as2.player_name) as PlayerPoints,round(sum((\n                select sum(gp*pts)\n                from all_seasons as3\n                where team_abbreviation in (\n                select as1.team_abbreviation)\n                and season in(\n                select as1.season)))) as TeamPoints,country\n                from all_seasons as1\n                group by player_name)\nselect Player,cast(PlayerPoints as int)\"PlayerPoints\",cast(TeamPoints as int)\"TeamPoints\",\nround((PlayerPoints\/TeamPoints)*100,1)|| ' ' || '%' as Percentage\nfrom ptspercentage\nwhere country='Turkey'\norder by cast(Percentage as numeric) desc\n            ;\"\"\",conn)","dc1496dd":"%%HTML\n<div class='tableauPlaceholder' id='viz1622741346364' style='position: relative'><noscript><a href='#'><img alt='Percentage of team points scored by players ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NB&#47;NBA5_16227412065210&#47;Sheet2&#47;1_rss.png' style='border: none' \/><\/a><\/noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' \/> <param name='embed_code_version' value='3' \/> <param name='site_root' value='' \/><param name='name' value='NBA5_16227412065210&#47;Sheet2' \/><param name='tabs' value='no' \/><param name='toolbar' value='yes' \/><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NB&#47;NBA5_16227412065210&#47;Sheet2&#47;1.png' \/> <param name='animate_transition' value='yes' \/><param name='display_static_image' value='yes' \/><param name='display_spinner' value='yes' \/><param name='display_overlay' value='yes' \/><param name='display_count' value='yes' \/><param name='language' value='en-US' \/><\/object><\/div>                <script type='text\/javascript'>                    var divElement = document.getElementById('viz1622741346364');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.50)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https:\/\/public.tableau.com\/javascripts\/api\/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                <\/script>","61fea00b":"player_table = df[[\"player_name\",\"country\",\"team_abbreviation\", \"season\"]].drop_duplicates()\nteam_points = df.groupby([\"team_abbreviation\", \"season\"]).apply(lambda x: np.sum(x.pts * x.gp)).rename(\"pts\").reset_index()\ndf2 = player_table.merge(team_points, on=[\"team_abbreviation\", \"season\"])\nfinal = round(df2[df2[\"country\"]==\"Turkey\"].groupby(\"player_name\")[\"pts\"].sum()).astype(int).sort_values(ascending=False)\n\nplayer_points = round(((df[\"gp\"]*df[\"pts\"])[df[\"country\"]==\"Turkey\"].groupby(df[\"player_name\"]).sum())).astype(int)\npoints_players_teams = pd.concat([player_points.rename(\"Player Points\"),final.rename(\"Team Points\")],axis=1)\npoints_players_teams[\"Percentage\"] = round((points_players_teams[\"Player Points\"]\/points_players_teams[\"Team Points\"])*100,1)\npoints_players_teams = points_players_teams.sort_values(by=\"Percentage\",ascending=False)\npoints_players_teams[\"Percentage\"] = points_players_teams[\"Percentage\"].astype(str) + \" %\"\npoints_players_teams","c294ff7b":"pd.read_sql(\"\"\"with runningtotals as(select player_name \"Player\",gp \"SeasonGames\",pts \"SeasonAvg\",row_number()\nover(partition by player_name order by season)\"SeasonNo\",gp*pts \"SeasonPts\",\nsum(sum(gp*pts)) over(partition by player_name rows between unbounded preceding and current row)\"RunningTotalPts\",\nsum(sum(gp)) over(partition by player_name rows between unbounded preceding and current row)\"RunningTotalGames\",season\nfrom all_seasons\nwhere player_name in ('Kobe Bryant','LeBron James')\ngroup by season,player_name)\nselect Player,cast(round(SeasonPts)as int)\"SeasonPts\",SeasonGames,SeasonAvg,SeasonNo,cast(round(RunningTotalPts)as int)\n\"RunningTotalPts\",RunningTotalGames,round((RunningTotalPts\/RunningTotalGames),1)\"RunningAverage\",season\nfrom runningtotals\n            ;\"\"\",conn)","c872494d":"%%HTML\n<div class='tableauPlaceholder' id='viz1622743596138' style='position: relative'><noscript><a href='#'><img alt='Career developments of Kobe and Lebron ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NB&#47;NBA6_16227421838990&#47;Sheet2&#47;1_rss.png' style='border: none' \/><\/a><\/noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' \/> <param name='embed_code_version' value='3' \/> <param name='site_root' value='' \/><param name='name' value='NBA6_16227421838990&#47;Sheet2' \/><param name='tabs' value='no' \/><param name='toolbar' value='yes' \/><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NB&#47;NBA6_16227421838990&#47;Sheet2&#47;1.png' \/> <param name='animate_transition' value='yes' \/><param name='display_static_image' value='yes' \/><param name='display_spinner' value='yes' \/><param name='display_overlay' value='yes' \/><param name='display_count' value='yes' \/><param name='language' value='en-US' \/><\/object><\/div>                <script type='text\/javascript'>                    var divElement = document.getElementById('viz1622743596138');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.50)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https:\/\/public.tableau.com\/javascripts\/api\/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                <\/script>","20eecef6":"pd.read_sql(\"\"\"with improved as(select player_name \"player\",team_abbreviation,gp,pts,\n                lag(pts) over(partition by player_name order by season)\"prev pts\",\n                lag(gp) over(partition by player_name order by season)\"prev gp\",season \n                from all_seasons)\n                select player,team_abbreviation \"team\",pts,\"prev pts\",(pts-\"prev pts\")\"diff\",season\n                from improved\n                where cast(\"prev pts\" as numeric)>=10\n                and cast(gp as numeric)>=60\n                and cast(\"prev gp\" as numeric)>=60\n                order by diff desc\n                limit 15\n            ;\"\"\",conn)","9f78cb63":"%%HTML\n<div class='tableauPlaceholder' id='viz1622878256853' style='position: relative'><noscript><a href='#'><img alt='Most Improved Players ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NB&#47;NBA7&#47;Sheet2&#47;1_rss.png' style='border: none' \/><\/a><\/noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' \/> <param name='embed_code_version' value='3' \/> <param name='site_root' value='' \/><param name='name' value='NBA7&#47;Sheet2' \/><param name='tabs' value='no' \/><param name='toolbar' value='yes' \/><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NB&#47;NBA7&#47;Sheet2&#47;1.png' \/> <param name='animate_transition' value='yes' \/><param name='display_static_image' value='yes' \/><param name='display_spinner' value='yes' \/><param name='display_overlay' value='yes' \/><param name='display_count' value='yes' \/><param name='language' value='en-US' \/><\/object><\/div>                <script type='text\/javascript'>                    var divElement = document.getElementById('viz1622878256853');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.50)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https:\/\/public.tableau.com\/javascripts\/api\/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                <\/script>","6be2f19c":"df[\"prev pts\"] = df.groupby(\"player_name\")[\"pts\"].shift(1)\ndf[\"prev gp\"] = df.groupby(\"player_name\")[\"gp\"].shift(1)\ndf[\"diff\"] = df[\"pts\"] - df[\"prev pts\"]\ndf[[\"player_name\",\"team_abbreviation\",\"pts\",\"prev pts\",\"diff\",\"gp\",\"season\"]][(df[\"gp\"]>=60) & (df[\"prev gp\"]>=60) & \n(df[\"prev pts\"]>=10)].sort_values(by=\"diff\",ascending=False).reset_index(drop=True).head(15)","6ab2b64a":"pd.read_sql(\"\"\"with net_rating_order as(select player_name \"player\",team_abbreviation \"team\",net_rating,\n                row_number() over(partition by season,team_abbreviation order by cast(net_rating as numeric) desc) \"rank\",\n                season\n                from all_seasons\n                where cast(gp as numeric)>=60\n                order by cast(net_rating as numeric) desc),\n                top5rating as(select *\n                from net_rating_order\n                where rank<=5)\n                select team,season,round(avg(net_rating),2)\"avg net rating\"\n                from top5rating\n                group by season,team\n                order by 3 desc\n                limit 15\n            ;\"\"\",conn)","abea8011":"%%HTML\n<div class='tableauPlaceholder' id='viz1622879920406' style='position: relative'><noscript><a href='#'><img alt='Teams with the highest average net ratings ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NB&#47;NBA8&#47;Sheet2&#47;1_rss.png' style='border: none' \/><\/a><\/noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' \/> <param name='embed_code_version' value='3' \/> <param name='site_root' value='' \/><param name='name' value='NBA8&#47;Sheet2' \/><param name='tabs' value='no' \/><param name='toolbar' value='yes' \/><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NB&#47;NBA8&#47;Sheet2&#47;1.png' \/> <param name='animate_transition' value='yes' \/><param name='display_static_image' value='yes' \/><param name='display_spinner' value='yes' \/><param name='display_overlay' value='yes' \/><param name='display_count' value='yes' \/><param name='language' value='en-US' \/><\/object><\/div>                <script type='text\/javascript'>                    var divElement = document.getElementById('viz1622879920406');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.50)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https:\/\/public.tableau.com\/javascripts\/api\/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                <\/script>","eeefad46":"team_rating = df.loc[df[\"gp\"]>=60].copy()\nteam_rating[\"rank\"] = team_rating.groupby([\"season\",\"team_abbreviation\"])[\"net_rating\"].rank(method=\"first\",ascending=False)\ntop5_rating = team_rating[team_rating[\"rank\"]<=5]\ntop5_rating.groupby([\"team_abbreviation\",\"season\"])[\"net_rating\"].mean().round(2).sort_values(ascending=False).to_frame().reset_index().head(15)","fdf1e101":"pd.read_sql(\"\"\"select player_name \"player\",team_abbreviation \"team\",net_rating \"net rating\",season\n            from all_seasons\n            where cast(gp as numeric)>=60\n            order by cast(net_rating as numeric) desc\n            limit 15\n            ;\"\"\",conn)","427e166d":"%%HTML\n<div class='tableauPlaceholder' id='viz1622886366327' style='position: relative'><noscript><a href='#'><img alt='Players with the highest average net ratings in a season ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NB&#47;NBA9&#47;Sheet2&#47;1_rss.png' style='border: none' \/><\/a><\/noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' \/> <param name='embed_code_version' value='3' \/> <param name='site_root' value='' \/><param name='name' value='NBA9&#47;Sheet2' \/><param name='tabs' value='no' \/><param name='toolbar' value='yes' \/><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NB&#47;NBA9&#47;Sheet2&#47;1.png' \/> <param name='animate_transition' value='yes' \/><param name='display_static_image' value='yes' \/><param name='display_spinner' value='yes' \/><param name='display_overlay' value='yes' \/><param name='display_count' value='yes' \/><param name='language' value='en-US' \/><\/object><\/div>                <script type='text\/javascript'>                    var divElement = document.getElementById('viz1622886366327');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.50)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https:\/\/public.tableau.com\/javascripts\/api\/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                <\/script>","cb0328e5":"df[[\"player_name\",\"team_abbreviation\",\"net_rating\",\"season\"]][df[\"gp\"]>=60].sort_values(by=\"net_rating\",ascending=False).reset_index(drop=True).head(15)","3fad8478":"pd.read_sql(\"\"\"select draft_year \"draft year\",cast(round(sum(gp*pts))as int)\"total pts\"\n                from all_seasons\n                where draft_year!=\"Undrafted\"\n                group by draft_year\n                order by 2 desc\n                limit 10\n            ;\"\"\",conn)","ad4fc0fd":"(df[\"gp\"]*df[\"pts\"])[df[\"draft_year\"]!=\"Undrafted\"].groupby(df[\"draft_year\"]).sum().rename(\"pts\").sort_values(ascending=False).round().astype(\"int\").to_frame().head(10)","8374411c":"pd.read_sql(\"\"\"with rankeddraftyear as(select player_name \"player\", draft_year \"draft year\", \n                draft_round\"round\",draft_number \"draft no\",\n                round(sum(gp*pts)\/sum(gp),1)\"avg pts\",\n                row_number()over(partition by draft_year order by sum(gp*pts)\/sum(gp)desc )\"rank\"\n                from all_seasons\n                where draft_year >= \"2012\" and draft_year != \"Undrafted\"\n                group by player_name,draft_year)\n                select * from\n                rankeddraftyear\n                where rank<=3\n            ;\"\"\",conn)","482439c4":"draft_info = round((df.groupby([\"player_name\",\"draft_year\",\"draft_round\",\"draft_number\"]).apply(lambda x: np.sum(x.pts * x.gp)))\/(df.groupby(\"player_name\").apply(lambda x: np.sum(x.gp))),1).rename(\"pts\").to_frame()\n\ndraft_info = draft_info.reset_index()\n\ndraft_info[\"rank\"] = draft_info.groupby(\"draft_year\")[\"pts\"].rank(method=\"first\",ascending=False)\n\ndraft_info[(draft_info[\"draft_year\"] != \"Undrafted\") & (draft_info[\"draft_year\"] >= \"2012\") & (draft_info[\"rank\"] <= 3)].sort_values(by=[\"draft_year\",\"pts\"],ascending=[True,False]).reset_index(drop=True)","0230f665":"pd.read_sql(\"\"\"select country,count(distinct(player_name))\"players\"\n                from all_seasons\n                where country not in (\"USA\",\"US Virgin Islands\",\"Bahamas\")\n                group by country\n                order by \"players\" desc\n                limit 15\n            ;\"\"\",conn)","9e60f914":"df[~df[\"country\"].isin([\"USA\",\"US Virgin Islands\",\"Bahamas\"])].groupby(\"country\")[\"player_name\"].nunique().sort_values(ascending=False).head(15).to_frame()\n# ~df[\"country\"].isin = not in, nunique = count(distinct)","5c4576ff":"pd.read_sql(\"\"\"select player_name \"player\",country,round(sum(gp*pts)\/sum(gp),1)\"avg pts\",sum(gp)\"games\"\n                from all_seasons\n                where country not in (\"USA\",\"US Virgin Islands\",\"Bahamas\")\n                group by player_name,country\n                order by \"avg pts\" desc\n                limit 15\n            ;\"\"\",conn)","c082dd54":"country_games = df.groupby([\"player_name\",\"country\"])[\"gp\"].sum()\n\ncountry_points = round((df.groupby([\"player_name\",\"country\"]).apply(lambda x: np.sum(x.pts * x.gp)))\/(df.groupby([\"country\",\"player_name\"]).apply(lambda x: np.sum(x.gp))),1)\n\nfinal = pd.concat([country_points.rename(\"pts\"),country_games],axis=1)\n\nfinal = final.reset_index()\n\nfinal[~final[\"country\"].isin([\"USA\",\"US Virgin Islands\",\"Bahamas\"])].sort_values(by=\"pts\",ascending=False).reset_index(drop=True).head(15)","01611b62":"### Python","a12316fb":"## Top 3 Scorers Each Season\n#### Her sezonun say\u0131 s\u0131ralamas\u0131ndaki ilk 3 isim","7a4cd426":"## Career developments of Kobe and Lebron\n#### Kobe ve Lebron'un Kariyer Geli\u015fimleri","5789daad":"### SQLite","41b79003":"### SQLite","17a5c1df":"### SQLite","326b467c":"### Python","3c0aff9b":"### SQLite","52efe6de":"## Players with the highest average net ratings in a season","8a621044":"### SQLite","69f92498":"## Total combined points per draft year ranking","3485bb77":"## Most represented countries in the NBA","6de7d055":"### SQLite","1e3aaee7":"### Python","9964f806":"## List of Turkish players who have played in the NBA\n#### T\u00fcrk oyuncu listesi","2338b1f9":"### Python","3df09317":"### SQLite","e950e88d":"## Total number of appearances made by Turkish players\n#### T\u00fcrk oyuncular\u0131n toplam ma\u00e7 say\u0131lar\u0131","b158bf1c":"### Python","20acfa2c":"### Python","80d27b53":"## SQLite","4cfccdc4":"### SQLite","e30ec7ce":"## Turkish players who were among top 3 scorers in their respective teams in a season\n#### Tak\u0131mlar\u0131nda say\u0131 s\u0131ralamas\u0131nda ilk 3'e girmeyi ba\u015farm\u0131\u015f T\u00fcrk oyuncular","a3be469f":"### Python","8950ca69":"### SQLite","0fb68658":"### Python","a3b98e85":"### Python","11a15b02":"### Python","a895dfc5":"### SQLite","06e2d013":"### SQLite","93de3e23":"### Python","8f72cd48":"### SQLite","62956c16":"## Top 3 Scorers of Draft Years starting from 2012","331b1518":"### SQLite","6053a3fe":"## Points Ranking\n#### Say\u0131 Krall\u0131\u011f\u0131","55ddd493":"## Percentage of team points scored by Turkish players\n#### T\u00fcrk oyuncular\u0131n, oynad\u0131\u011f\u0131 tak\u0131mlar\u0131n toplam say\u0131s\u0131na y\u00fczdesel katk\u0131s\u0131","99cce7d0":"## Most Improved Players","7a322d8a":"### SQLite","3214ed01":"## Best international scorers","aa8e8c8b":"## Teams with the highest average net ratings in a season(only top 5 players included)","1ca8b3aa":"### Python","2c331232":"## Percentage of team points scored by players\n#### Oyuncular\u0131n, oynad\u0131\u011f\u0131 tak\u0131mlar\u0131n toplam say\u0131s\u0131na y\u00fczdesel katk\u0131s\u0131","7128209e":"## Career stats of Turkish players\n#### T\u00fcrk oyuncular\u0131n kariyer istatistikleri","98fedcc7":"### Python","f584b044":"#### En \u00e7ok geli\u015fme g\u00f6steren oyuncular","b9fad76f":"### Python","abc19bbe":"### Python","c00c68fc":"### SQLite"}}