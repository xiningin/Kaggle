{"cell_type":{"96775645":"code","24efc006":"code","017aa560":"code","38e8e3ed":"code","d6847a05":"code","7df01eba":"code","be99acf4":"code","568e54aa":"code","0d2b2c43":"code","3488f724":"code","89852c70":"code","674baec6":"code","d6dbb26b":"code","11e6ed25":"code","34bc8d0c":"code","6a22f339":"code","30b33a9e":"code","8ec8cb45":"code","2a7ce817":"code","3812c24b":"code","6c0ca89f":"code","8c03c901":"code","94b081d7":"code","cf0bd969":"code","591603f7":"code","ff396f26":"code","4b24fbfd":"code","d966f6cb":"code","b2bac72c":"code","e6e293fc":"code","f20346d6":"code","993cde82":"code","2bf87161":"code","35f7a4da":"code","da2350be":"code","0526b8f0":"code","76137345":"code","ba2408ed":"code","f5533d97":"code","7003ce10":"code","2f89e4ea":"code","29e1634f":"code","9229e00c":"code","1fb738ca":"code","69f064ff":"markdown","dba10dd7":"markdown","181014be":"markdown","0eef7dfa":"markdown","44c6bf03":"markdown","ea9c084c":"markdown","23c98a15":"markdown","5db50f23":"markdown","dc02ec76":"markdown","ebb2f39d":"markdown","1ce9e2a6":"markdown","7d373eba":"markdown","4d86e1f2":"markdown","807fd2ce":"markdown","78adc6de":"markdown","177e13b6":"markdown","6bbd5e5e":"markdown","797ae525":"markdown","c29534cb":"markdown","0e4c333a":"markdown","7612dc47":"markdown","8a5b64c4":"markdown","eeb90cf8":"markdown","48a79e6e":"markdown","d87aa09b":"markdown"},"source":{"96775645":"import warnings\nwarnings.filterwarnings('ignore')","24efc006":"import pandas as pd\nimport numpy as np","017aa560":"df = pd.read_csv(\"..\/input\/drug-classification\/drug200.csv\")","38e8e3ed":"df.head()","d6847a05":"df.dtypes","7df01eba":"df.describe().T","be99acf4":"df.isnull().sum()","568e54aa":"len(df)","0d2b2c43":"df.duplicated().sum()","3488f724":"df['Sex'].unique()","89852c70":"df['BP'].unique()","674baec6":"df['Cholesterol'].unique()","d6dbb26b":"df['Drug'].unique()","11e6ed25":"import matplotlib.pyplot as plt\nimport seaborn as sns\nplt.title(\"AGE DISTRIBUTION\")\ndf['Age'].plot(kind='kde')","34bc8d0c":"print(\"Mean Patient Age is: \"+str(df['Age'].mean()))","6a22f339":"plt.title(\"MALE & FEMALE COUNT\")\nsns.countplot(df['Sex'],palette='flare')","30b33a9e":"print(\"% of male & female\")\n(df.Sex.value_counts()\/200)*100","8ec8cb45":"sns.countplot(df['BP'],palette='crest')","2a7ce817":"(df['BP'].value_counts())*100\/200","3812c24b":"sns.countplot(df['Cholesterol'],palette='crest')","6c0ca89f":"(df['Cholesterol'].value_counts())*100\/200","8c03c901":"plt.title(\"Na to K ratio distribution\")\ndf['Na_to_K'].plot(kind='kde')","94b081d7":"sns.countplot(df['Drug'],palette='magma')","cf0bd969":"sns.catplot(x=\"Drug\", y=\"Age\",hue=\"Sex\",data=df,palette='viridis')","591603f7":"sns.countplot(data=df,x='Drug',hue='Sex',palette='magma')","ff396f26":"sns.countplot(data=df,x='Drug',hue='BP',palette='magma')","4b24fbfd":"sns.countplot(data=df,x='Drug',hue='Cholesterol',palette='magma')","d966f6cb":"sns.catplot(x=\"Drug\", y=\"Na_to_K\",data=df,palette='viridis')","b2bac72c":"plt.title(\"Correlation Matrix\")\nsns.heatmap(df.corr(),cmap='binary')","e6e293fc":"sns.boxplot(df['Age'])","f20346d6":"sns.boxplot(df['Na_to_K'])","993cde82":"df['NAK'] = df['Na_to_K'].apply(lambda x: 1 if x >= 15 else 0)","2bf87161":"df.columns","35f7a4da":"###Categorical Variables\ncols = ['Sex','BP','Cholesterol','Drug','NAK']","da2350be":"###label encoding\nfrom sklearn.preprocessing import LabelEncoder\nfor col in cols:\n    le = LabelEncoder()\n    df[col] = le.fit_transform(df[col])","0526b8f0":"df.head()","76137345":"###scaling\nfrom sklearn.preprocessing import MinMaxScaler\nms = MinMaxScaler()\nncols = ['Age','Na_to_K']\ndf[ncols] = ms.fit_transform(df[ncols])","ba2408ed":"df.head()","f5533d97":"y = df['Drug']\nX = df.drop('Drug',axis=1)","7003ce10":"scores = {}","2f89e4ea":"from sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.model_selection import cross_val_score\nknn_cv = KNeighborsClassifier(n_neighbors=3)\ncv_scores = cross_val_score(knn_cv, X, y, cv=5)\nscores['Knn'] = np.mean(cv_scores)\nprint(f\"KNN SCORE : {np.mean(cv_scores)}\")","29e1634f":"from sklearn.ensemble import RandomForestClassifier\nrfc = RandomForestClassifier(random_state = 42)\ncv_scores = cross_val_score(rfc, X, y, cv=5)\nscores['RandomForest'] = np.mean(cv_scores)\nprint(f\"Random Forest Score : {np.mean(cv_scores)}\")","9229e00c":"from sklearn.ensemble import ExtraTreesClassifier\netc = ExtraTreesClassifier(random_state = 42)\ncv_scores = cross_val_score(etc, X, y, cv=5)\nscores['ExtraTree'] =  np.mean(cv_scores)\nprint(f\"ExtraTrees Score : {np.mean(cv_scores)}\")","1fb738ca":"plt.title(\"SCORES\")\nplt.hist(scores)","69f064ff":"# DRUG CLASSIFICATION\n!['DRUG'](https:\/\/images.unsplash.com\/photo-1584362917137-56406a73241c?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=914&q=80)","dba10dd7":"CHECK FOR DUPLICATE ROWS","181014be":"* Na to K can be used to create a new feature<br>\n* Use Na to K >= 15 to create new feature","0eef7dfa":"* Drug C is only taken by people with HIGH cholestrol","44c6bf03":"2.Random Forest","ea9c084c":"# **Feature Engineering**","23c98a15":"* Drug Y is only used by patients with Na to k ratio > 15","5db50f23":"There are some outliers","dc02ec76":"* Age is Not related to Na to K ratio","ebb2f39d":"* Almost half of the patients have high cholestrol","1ce9e2a6":"Checking for Null Values","7d373eba":"Dataset contains only male and female data","4d86e1f2":"# **MODELLING**","807fd2ce":"1.KNN using kfold cross validation","78adc6de":"* Drug B is only used by patients of Age > 50\n* Drug A is only used by patients of Age < 50","177e13b6":"Column descriptions\n* 1.Age->Age of patient\n* 2.Sex->Gender of Patient\n* 3.BP->Blood Pressure\n* 4.Cholesterol\n* 5.Na_to_K->Sodium to Potassium ratio\n* 6.Drug->Drug type(Target Variable)","6bbd5e5e":"* Drug Y is the most used among patient\n* Drug used is unbalanced","797ae525":"* All most equal number of Females and males present in Data","c29534cb":"* Only about 30 percent of the patients have normal BP ","0e4c333a":"# **BASIC EDA**","7612dc47":"3.Extra Tress","8a5b64c4":"Drug Y is used more by Females while some others are used more by males ","eeb90cf8":" READING THE DATA","48a79e6e":"# **Preparing data for modelling**","d87aa09b":"* Drug Y are mostly used by people with HIGH bp\n* Drug C is only used by people with LOW bp\n* Drug X is not used by people with HIGH bp\n* Drug A & B is only used by people with HIGH bp"}}