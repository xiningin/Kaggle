{"cell_type":{"64bf0182":"code","6d16bbec":"code","1436f4bc":"code","f47f93be":"code","2d48b70c":"code","84e6bd22":"code","49e729ac":"code","da8446fb":"code","5e5febec":"code","536d030f":"code","04d91e51":"code","30fa872c":"code","1cab8c30":"code","76dd81b9":"code","5454775c":"code","7286e73f":"code","b5786d57":"code","4454b356":"code","5df2578c":"code","f733665d":"code","8790049e":"code","21852b6c":"code","f6d6c42f":"code","2970a19b":"code","12a3d6ae":"code","4c2eb116":"code","f4eeeb23":"code","9ba43ca7":"code","f2d56f08":"code","dd5f9501":"code","27c50bdb":"code","7955070e":"code","ce363b75":"code","adb3c071":"code","89d0d554":"code","7300c928":"code","307efc89":"code","b69b8713":"code","a7b7e05f":"code","b48b15a5":"code","e4769602":"code","5a413172":"code","0455e433":"code","f4320879":"code","a48a4697":"code","53ca0475":"markdown","c036c7a7":"markdown","a0154778":"markdown","a9b3b938":"markdown","0ea8cca7":"markdown","85ae6ff3":"markdown","4edec34a":"markdown","249de837":"markdown","fe56ae87":"markdown","67549445":"markdown","ecd007e1":"markdown","fd2521ec":"markdown","20dc210e":"markdown","fc9bf8ad":"markdown","daba954f":"markdown","adfa509f":"markdown","07042b1f":"markdown","22ae73bf":"markdown","f80b13cf":"markdown","3cef43db":"markdown","a1f1ffe4":"markdown","0bc6172c":"markdown","61166423":"markdown","4b1f3989":"markdown","cdaa06a7":"markdown","266137ba":"markdown","f9f6cd85":"markdown","e206bd16":"markdown","220b09cd":"markdown"},"source":{"64bf0182":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\nimport warnings\nfrom sklearn.tree import DecisionTreeClassifier, export_graphviz\nfrom sklearn import tree\nfrom lightgbm import LGBMClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.tree import export_graphviz\nfrom xgboost import XGBClassifier\nfrom sklearn.metrics import confusion_matrix, accuracy_score, classification_report\nfrom sklearn.model_selection import train_test_split, GridSearchCV, cross_val_score\nfrom sklearn.preprocessing import StandardScaler\nwarnings.filterwarnings('ignore')","6d16bbec":"df = pd.read_csv('..\/input\/heart-disease-uci\/heart.csv')","1436f4bc":"df.head()","f47f93be":"df.info()","2d48b70c":"df.isnull().values.any()","84e6bd22":"df.shape","49e729ac":"df.describe().T","da8446fb":"# sex: The person's sex (1 = male, 0 = female)\n\ndf['sex'][df['sex'] == 0] = 'female'\ndf['sex'][df['sex'] == 1] = 'male'","5e5febec":"df[\"sex\"].value_counts()","536d030f":"df[\"age_group\"] = pd.cut(x=df['age'], bins=[28, 48, 56,62,78], labels=[\"28-48\", \"49-56\", \"57-62\",\"63-78\" ])","04d91e51":"df[\"age_group\"].value_counts()","30fa872c":"df[\"new_chol\"] = pd.cut(x=df['chol'], bins=[0, 200, 239,565], labels=[\"Desirable\", \"Borderline high\", \"High\"])","1cab8c30":"df[\"new_chol\"].value_counts()","76dd81b9":"# Angina is described as  pressure,squeezing, heaviness, tightness or pain in chest.\n# exang: Exercise induced angina (1 = yes; 0 = no)\ndf[\"exang\"].value_counts()","5454775c":"df['exang'][df['exang'] == 0] = 'no'\ndf['exang'][df['exang'] == 1] = 'yes'","7286e73f":"df.exang.value_counts()","b5786d57":"df[\"cp\"].value_counts()","4454b356":"# cp: The chest pain experienced (Value 1: typical angina, Value 2: atypical angina, Value 3: non-anginal pain, Value 4: asymptomatic)\ndf['cp'][df['cp'] == 0] = 'typical angina'\ndf['cp'][df['cp'] == 1] = 'atypical angina'\ndf['cp'][df['cp'] == 2] = 'non-anginal pain'\ndf['cp'][df['cp'] == 3] = 'asymptomatic'","5df2578c":"df[\"cp\"].value_counts()","f733665d":"# The ST segment\/heart rate slope can be a predictor of coronary artery disease\n# slope: the slope of the peak exercise ST segment (Value 1: upsloping, Value 2: flat, Value 3: downsloping)\ndf[\"slope\"].value_counts()","8790049e":"df['slope'][df['slope'] == 0] = 'upsloping'\ndf['slope'][df['slope'] == 1] = 'flat'\ndf['slope'][df['slope'] == 2] = 'downsloping'\ndf[\"slope\"].value_counts()","21852b6c":"# thal: A blood disorder called thalassemia (3 = normal; 6 = fixed defect; 7 = reversable defect)\ndf[\"thal\"].value_counts()","f6d6c42f":"df.info()","2970a19b":"older=df['age']>65\ndf[older].count().sum()","12a3d6ae":"df[\"target\"].value_counts()","4c2eb116":"# Visualization\ncorr = df.corr()\nplt.figure(figsize=(18,10))\nsns.heatmap(corr, annot=True)\nplt.show()","f4eeeb23":"fig, axes = plt.subplots(5, 2, figsize=(16,16))\nfs = ['sex','age_group','cp', 'new_chol','restecg','exang', 'slope', 'ca', 'exang', 'slope']\nfor i, axi in enumerate(axes.flat):\n    sns.countplot(x=fs[i], hue='target', data=df, palette='prism', ax=axi) \n    axi.set(ylabel='Frequency')\n    axi.legend([\"Not Disease\", \"Disease\"])","9ba43ca7":"df.info()","f2d56f08":"more_cat_cols = [col for col in df.columns if len(df[col].unique()) < 10]\nprint('Number of Categorical Variables : ', len(more_cat_cols))\nprint(more_cat_cols)","dd5f9501":"# changes them ('fbs', 'restecg', 'ca', 'thal', 'age_group', 'new_chol')into categorical variables,\ndf['fbs'] = df['fbs'].astype('object')\ndf['fbs'] = df['fbs'].astype('object')\ndf['restecg'] = df['restecg'].astype('object')\ndf['ca'] = df['ca'].astype('object')\ndf['thal'] = df['thal'].astype('object')\ndf['age_group'] = df['age_group'].astype('object')\ndf['new_chol'] = df['new_chol'].astype('object')","27c50bdb":"df.info()","7955070e":"df.drop(['age', 'chol'], axis=1, inplace=True)","ce363b75":"num_cols = [col for col in df.columns if df[col].dtypes != 'O' and col not in \"Id\"]\nprint('Number of Numerical Variables: ', len(num_cols))\nnum_cols","adb3c071":"numeric_cols1= ['trestbps', 'thalach', 'oldpeak']\ndef hist_for_nums(data, numeric_cols1):\n    col_counter = 0\n    data = data.copy()\n    for col in numeric_cols1:\n        data[col].hist(bins=20)\n        plt.xlabel(col)\n        plt.title(col)\n        plt.show()\n        col_counter += 1\n    print(col_counter, \"variables have been plotted\")\nhist_for_nums(df, numeric_cols1)","89d0d554":"df[\"target\"].value_counts()","7300c928":"fig1, ax1 = plt.subplots()\nax1.pie(df[\"target\"].value_counts(),  labels=['Heart Disease','no Heart Disease'], autopct='%1.1f%%',\n        shadow=True, startangle=90)\nax1.axis('equal')\nplt.show()","307efc89":"cat_cols = [col for col in df.columns if df[col].dtypes == 'O']\nprint('Number of Categorical Variables : ', len(cat_cols))\ncat_cols","b69b8713":"def one_hot_encoder(df, nan_as_category = True):\n    original_columns = list(df.columns)\n    categorical_columns = [col for col in df.columns if df[col].dtype == 'object']\n    df= pd.get_dummies(df, columns= categorical_columns, dummy_na= nan_as_category)\n    new_columns = [c for c in df.columns if c not in original_columns]\n    return df, new_columns\ndf, cat_cols = one_hot_encoder(df, nan_as_category= True)","a7b7e05f":"df.head()","b48b15a5":"X = df.drop('target', axis=1)\ny = df[[\"target\"]]\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20, random_state=46)","e4769602":"scaler = StandardScaler()\nX_train_scaled = scaler.fit_transform(X_train)\nX_train = pd.DataFrame(X_train_scaled)\nX_test_scaled = scaler.transform(X_test)\nX_test = pd.DataFrame(X_test_scaled)","5a413172":"lgbm = LGBMClassifier(random_state=46)\nlgbm.fit(X_train, y_train)\nLgbm_pred = lgbm.predict(X_test)\nacc_lgbm = round(lgbm.score(X_train, y_train) * 100, 2)\nacc_lgbm","0455e433":"xgboost = XGBClassifier(random_state=46)\nxgboost.fit(X_train, y_train)\nxgboost_pred = xgboost.predict(X_test)\nacc_xgboost = round(xgboost.score(X_train, y_train) * 100, 2)\nacc_xgboost","f4320879":"DecisionTree = XGBClassifier(random_state=46)\nDecisionTree.fit(X_train, y_train)\nDecisionTree_pred = DecisionTree.predict(X_test)\nacc_DecisionTree = round(DecisionTree.score(X_train, y_train) * 100, 2)\nacc_DecisionTree","a48a4697":"models = pd.DataFrame({\n    'Model': [\"LightGBM\",'Decision Tree', \"XGBOOST\"],\n    'Score': [acc_lgbm,acc_DecisionTree, acc_xgboost]})\nmodels.sort_values(by='Score', ascending=False)","53ca0475":"# 2. UNDERSTANDING THE DATA-SET","c036c7a7":"****Data Summary****:\nThis database contains 76 attributes, but all published experiments refer to using a subset of 14 of them. In particular, the Cleveland database is the only one that has been used by ML researchers to this date. The \"goal\" field refers to the presence of heart disease in the patient. It is integer valued from 0 (no presence) to 4.","a0154778":"# DecisionTree","a9b3b938":"I split the data set: 80% of the data is train, and 20% of it is test data.","0ea8cca7":"# 5. ANALYSIS of DEPENDENT VARIABLE (TARGET ANALYSIS)","85ae6ff3":"**Objective**\n* The main purpose of this study is to raise awareness about how fatal heart disease is. To do this,I try  to create a model to predict if a patient has this disease or not in the dataset. ","4edec34a":"* There is no high correlation among the features in data set.","249de837":"# 7. MODELING","fe56ae87":"chol: The person's cholesterol measurement in mg\/dl\n* < 200\tDesirable\n* 200 to 239\tBorderline high\n* > 240\tHigh","67549445":"# xgboost","ecd007e1":"# 4. ANALYSIS of NUMERICAL VARIABLE","fd2521ec":"**Model**","20dc210e":"**Model**","fc9bf8ad":"The description of variables in this data as follows:\n\n**Dependent Variable**:\n\n**target**: Heart disease (0 = no, 1 = yes)\n\n**Independent Variable**:\n1. **age:** The person's age in years\n2. **sex**: The person's sex (1 = male, 0 = female)\n3. **cp**: The chest pain experienced (Value 1: typical angina, Value 2: atypical angina, Value 3: non-anginal pain, Value 4: asymptomatic)\n4. **trestbps**: The person's resting blood pressure (mm Hg on admission to the hospital)\n5. **chol**: The person's cholesterol measurement in mg\/dl\n6. **fbs**: The person's fasting blood sugar (> 120 mg\/dl, 1 = true; 0 = false)\n7. **restecg**: Resting electrocardiographic measurement (0 = normal, 1 = having ST-T wave abnormality, 2 = showing probable or definite left ventricular hypertrophy by Estes' criteria)\n8. **thalach**: The person's maximum heart rate achieved\n9. **exang**: Exercise induced angina (1 = yes; 0 = no)\n10. **oldpeak**: ST depression induced by exercise relative to rest ('ST' relates to positions on the ECG plot. See more here)\n11. **slope**: the slope of the peak exercise ST segment (Value 1: upsloping, Value 2: flat, Value 3: downsloping)\n12. **ca**: The number of major vessels (0-3)\n13. **thal**: A blood disorder called thalassemia (3 = normal; 6 = fixed defect; 7 = reversable defect)\n","daba954f":"# 6. ONE-HOT ENCODING","adfa509f":"**Scaling the features**","07042b1f":"# Heart disease\n* Heart disease refers to a range of conditions affecting the heart. \"Heart disease\" and \"cardiovascular disease\" are is often used instead of each other. According to world health organization, heart disease is leading causes of death in the world. That is to say, heart disease is the world\u2019s biggest killer.\n![image.png](attachment:image.png)\n","22ae73bf":"# 3. EXPLORATORY DATA ANALYSIS ON CATEGORICAL DATA","f80b13cf":"**Model**","3cef43db":"There are no missing values in the dataset","a1f1ffe4":"**Types of heart disease**\n* There are many different types of heart disease such as Heart rhythm disorders, Atherosclerosis, Cardiomyopathy, Congenital heart defects, Coronary artery disease (CAD), Structural heart disease, and Heart infections. \n![image.png](attachment:image.png)\nSource: https:\/\/www.verywellhealth.com\/\n","0bc6172c":"# LightGBM","61166423":"# 1. IMPORT SOME NECESSARY LIBRARIES","4b1f3989":"**Symptoms of heart disease**\n* Some symptoms of heart disease includes: Angina, heart palpitations, nausea, swollen ankles, dizziness, irregular heartbeat, slow pulse, difficulty breathing, fainting spells, fatigue and lightheadedness, swelling due to fluid retention, fluttering heart or racing heartbeat, lightheadedness, leg, arm, jaw, or back pain. \n![image.png](attachment:image.png)\nSource:https:\/\/myheartsisters.org\/","cdaa06a7":"* As seen from the values above, there is no imbalance between the classes of the dependent variable.","266137ba":"'fbs', 'restecg', 'ca', 'thal', 'target', 'age_group', 'new_chol'","f9f6cd85":"# Load Data","e206bd16":"****Visualization of numeric variables****","220b09cd":"* Finding the number of values in the target column\n* **target**: Heart disease (0 = no, 1 = yes)"}}