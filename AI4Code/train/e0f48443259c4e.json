{"cell_type":{"1b3ed6f8":"code","d3f41ce4":"code","b708e872":"code","ec11a23f":"code","cbb6af5f":"code","f38be339":"code","3c379a5b":"code","be42d3e4":"code","888023da":"code","b3af45ba":"code","820858f0":"code","0e6a801b":"code","9c9af5ec":"code","3f36966a":"code","f44cc7c5":"markdown","ca3376f3":"markdown","556e08da":"markdown","ec033a11":"markdown"},"source":{"1b3ed6f8":"import numpy as np","d3f41ce4":"def F1(t):\n    noise = np.random.normal(loc=0, scale=1)\n    a1 = 0.063\n    a2 = 5.284\n    a3 = 4.887\n    a4 = 10.34\n    a5 = 105\n    return a1*(t**4) - a2*(t**3) + a3*(t**2) + a4*(t**1) + a5 + noise","b708e872":"# number of simulation\nn = 1000\n\n# A (matrix) * x (vector with 5 dimensions) = b (vector with 5 dimensions)\nA = np.zeros((n, 5))\nb = np.zeros((n, 1))\n\nfor i in range(n):\n    # t wll be a number between 0 and 100\n    t = np.random.random()*100\n    \n    b[i] = F1(t)\n    A[i, 0] = t**4\n    A[i, 1] = t**3\n    A[i, 2] = t**2\n    A[i, 3] = t**1\n    A[i, 4] = t**0\n\n# Ax = b\nx = np.linalg.lstsq(A, b)[0]","ec11a23f":"x","cbb6af5f":"def F2(t, A, B, C, D):\n    return A*(t**B) + C*np.cos(D*t) + np.random.normal(0, 1, t.shape[0])","f38be339":"n = 1000\nT = np.random.random((n, 1))*100\nb2 = F2(T, 0.6, 1.2, 100, 0.4)","3c379a5b":"# genetic algo: first step => encoding\n# each row represents a person, gene or solution\npopulation = np.random.randint(0, 2, (10000, 40))","be42d3e4":"population","888023da":"# a function to covert gene into parameter\ndef gene2para(gene):\n    A = (np.sum(2**np.arange(10)*gene[0:10]) - 511) \/ 100\n    B = (np.sum(2**np.arange(10)*gene[10:20]) - 511) \/ 100\n    C = (np.sum(2**np.arange(10)*gene[20:30]) - 511)\n    D = (np.sum(2**np.arange(10)*gene[30:40]) - 511) \/ 100\n    \n    '''\n    Because we have known the range of each parameter, and the solution should locate in this range\n    A: -5.11 ~ 5.12\n    \n    '''\n    return A, B, C, D","b3af45ba":"# \"error\" matrix will store how good the gene is \nerror = np.zeros((10000, 1))","820858f0":"for generation in range(10):\n    print(\"#{} Gneartion\".format(generation+1))\n    for i in range(10000):\n        A, B, C, D = gene2para(population[i, :])\n        error[i] = np.mean(abs(F2(T, A, B, C, D) - b2))\n    \n    # sort index of person based on its error\n    sort_idx = np.argsort(error[:, 0])\n    population = population[sort_idx, :]\n    \n    # genetic algo: second & third step => Survival of the Fittest\n    for i in range(100, 10000):\n        father = np.random.randint(0, 100)\n        mother = np.random.randint(0, 100)\n        while father == mother:\n            mother = np.random.randint(0, 100)\n        \n        mask = np.random.randint(low=0, high=2, size=(1, 40))\n        son_gene = np.zeros((40))\n        \n        mother_gene = population[mother, :]\n        father_gene = population[father, :]\n        son_gene[mask[0, :] == 1] = father_gene[mask[0, :] == 1]\n        son_gene[mask[0, :] == 0] = mother_gene[mask[0, :] == 0]\n        population[i, :] = son_gene\n        \n    \n    # genetic algo: forth step => Mutation\n    for i in range(1000):\n        mutation_person = np.random.randint(0, 10000)\n        mutation_gene = np.random.randint(0, 40)\n        population[mutation_person, mutation_gene] = 1 - population[mutation_person, mutation_gene]","0e6a801b":"for i in range(10000):\n    A, B, C, D = gene2para(population[i, :])\n    error[i] = np.mean(abs(F2(T, A, B, C, D) - b2))\n    \n# sort index of person based on its error\nsort_idx = np.argsort(error[:, 0])\npopulation = population[sort_idx, :]","9c9af5ec":"gene2para(population[0])","3f36966a":"# possible improvement\n# we should choose better parent (maybe based on its error)\n# every person should have probability to live (person who has big error should have small probability instead of 0)\n# adaptive mutation rate (high at first, low at final)","f44cc7c5":"## Import Package","ca3376f3":"## Linear Equation","556e08da":"### Using genetic algorithm to estimate four parameter we have defined: 0.6, 1.2, 100, 0.4","ec033a11":"## Non-Linear Equation"}}