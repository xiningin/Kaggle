{"cell_type":{"5eb088db":"code","bec5966e":"code","a845d1ac":"code","cd72e301":"code","88ff7845":"code","2f79e0ed":"code","24e07ee3":"code","e51dad6a":"code","e3b4e441":"code","2387de88":"code","99527158":"code","d0780abe":"markdown","becaeb52":"markdown","54a6e2db":"markdown"},"source":{"5eb088db":"import pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score","bec5966e":"data = pd.read_csv(\"..\/input\/mushrooms.csv\")\ndata.head()","a845d1ac":"features = data.iloc[:,1:]\nfeatures = pd.get_dummies(features).astype(float)  #one hot encoding\ntarget = data.iloc[:,0]\nfeatures.head()","cd72e301":"X = features.values\ny = target.values","88ff7845":"x_train, x_test, y_train, y_test = train_test_split(X, y, test_size = 0.30)","2f79e0ed":"from sklearn import tree\nclf = tree.DecisionTreeClassifier()","24e07ee3":"clf.fit(x_train, y_train)","e51dad6a":"predictions = clf.predict(x_test)\nprint(accuracy_score(y_test,predictions))  # raw score","e3b4e441":"sample = data.iloc[-1,:]\nsample","2387de88":"sample_x = features.iloc[-1]\nsample_y = target.iloc[-1]","99527158":"sample_pred = clf.predict(sample_x.values.reshape(1,-1))\nprint(\"Model Prediction: \", sample_pred)\nprint(\"Sample Value: \", sample_y)","d0780abe":"![](http:\/\/blogs.discovermagazine.com\/crux\/files\/2018\/10\/amanita-muscaria.jpg)\n\nProblem:\n\"I harvested sum 'shrooms mate. That was some gnarly shroomin'! Oh crikey, I seem'd to have forgotten to mark 'em if they r' bloody edible! No problems, mate! We just gotta use machine learning and predict 'em from the wiley ones!\" - some Australian 'shroom dealer (totally certified to sell 'shrooms).\n\nThere is a dataset we can train our machine learning model below that takes into account multiple features. Try to see if you can develop a model that can predict if a mushroom is edible or is poisonous and help our Australian mate.\n\n* please try to do the model by yourself first (try different algorithms as well) and then compare it with the code below.\n\n* Categorical data (Strings) are generally not handled by scikit-learn models as *features*. Please convert them to numerical floating point values. Hint: use pd.get_dummies() function to convert into [one hot encoding format](https:\/\/www.kaggle.com\/dansbecker\/using-categorical-data-with-one-hot-encoding).\n\n['Shroom dataset](https:\/\/www.kaggle.com\/uciml\/mushroom-classification)\n![](https:\/\/i.imgur.com\/mtimFxh.png)","becaeb52":"Let's test it out individually: we are going to pick out the last mushroom in the dataset.","54a6e2db":"Now because we are dealing with bunch of categorical data, many of which are binary data (true or false), decision trees will suffice as a well-rounded model for this problem."}}