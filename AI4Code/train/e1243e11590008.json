{"cell_type":{"02225de3":"code","413b3709":"code","64ff9845":"code","343795f6":"code","641329fe":"code","fe6798eb":"code","ca2ae5c8":"code","291551cd":"code","b989387d":"code","c63b698c":"code","ffc4a08b":"code","c9728fbe":"code","b906983b":"code","0a4c6390":"code","41436235":"code","f2741079":"code","717e0184":"markdown","23d045b1":"markdown","b3240ff6":"markdown","a32f2626":"markdown","4964df37":"markdown","4db304f7":"markdown","64e1514e":"markdown","74e8d984":"markdown","0ec479ca":"markdown","23bce23f":"markdown","a0721613":"markdown","f8c2c6d7":"markdown","f831e717":"markdown","c48dbe06":"markdown","7b49c693":"markdown","050382e6":"markdown","1109e7e3":"markdown"},"source":{"02225de3":"import pandas as pd\nimport numpy as np\nimport os\nimport pandas_profiling\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import train_test_split","413b3709":"RAW_DATA_FILE = 'melb_data.csv'\n# Check if notebook is run on Kaggle or locally\ncwd = os.getcwd()\nif cwd == '\/kaggle\/working':\n    RAW_DATA_PATH = '..\/input'\nelse:\n    RAW_DATA_PATH = os.path.join('..\/data','raw')","64ff9845":"def load_data(raw_data_path, raw_data_file):\n    cols_to_use = ['Rooms','Price','Method','Date','Distance','Propertycount','Bedroom2','Bathroom','Car','Landsize','BuildingArea','YearBuilt','Lattitude','Longtitude']\n    df = pd.read_csv(os.path.join(raw_data_path, raw_data_file), usecols =[i for i in cols_to_use])\n    df['Date'] = pd.to_datetime(df['Date'])\n    return df\n\ndf = load_data(RAW_DATA_PATH, RAW_DATA_FILE)","343795f6":"df.head()","641329fe":"df.info()","fe6798eb":"df.Method.value_counts()","ca2ae5c8":"df.describe()","291551cd":"df.hist(bins=50, figsize=(20,15))","b989387d":"train_set, test_set = train_test_split(df, test_size=0.2, random_state=38, shuffle=True)\nprint(train_set.shape)\nprint(test_set.shape)","c63b698c":"housing = train_set.copy()","ffc4a08b":"bottom_99p = housing.Price < np.percentile(housing.Price, 99)\nhousing[bottom_99p].plot(kind='scatter', x='Longtitude', y='Lattitude', alpha=0.3, figsize=(12,10)\n             , c='Price', cmap=plt.get_cmap('jet'), colorbar=True)","c9728fbe":"corr_matrix = housing.corr()\ncorr_matrix['Price'].sort_values(ascending=False)","b906983b":"corr_matrix['Rooms'].sort_values(ascending=False)","0a4c6390":"def feature_extraction(df):\n    df['other_rooms'] = df.Rooms - df.Bathroom\n    df['surface_per_room'] = df.BuildingArea\/df.Rooms\n    df['perc_built'] = df.BuildingArea\/df.Landsize\n    df['house_age'] = df.Date.dt.year - df.YearBuilt\n    \nfeature_extraction(housing)","41436235":"housing.corr()['Price'].sort_values(ascending=False)","f2741079":"pandas_profiling.ProfileReport(housing)","717e0184":"Let's have a look at the correlation of Rooms with other variables. In particularly, we are interested to see how this correlates with other room variables.\n\nThere is an almost perfect correlation with Bedroom2. The data description mentioned that this variable was extracted from another source. But it seems that both variables measure the same thing, the number of bedrooms. The more rooms a house has, the more bathrooms and parking lots. Houses further away from the CBD, have more rooms.","23d045b1":"Most variables seem to have normal values. However, some variables are worth having a look at.\n\n- The price range of a house is rather large, between 85000 and 9 million dollars.\n- The distance to the city centre is sometimes 0\n- Some houses do not have a bedroom or a bathroom\n- The landsize and buildingarea are zero for some houses (perhaps these are appartments?). There appear to be some outliers in these variables.\n- The minimum YearBuilt is 1196, probably a data entry error","b3240ff6":"### First look at the data","a32f2626":"### Load the data","4964df37":"## 2. Get the data\nOn the website of Kaggle, we can download one [data set](https:\/\/www.kaggle.com\/anthonypino\/melbourne-housing-market) containing the attributes and a target variable. The data is provided under a Attribution-NonCommercial-ShareAlike 4.0 International [(CC BY-NC-SA 4.0](https:\/\/creativecommons.org\/licenses\/by-nc-sa\/4.0\/).\n\nThe variables in the data set on Kaggle are:\n* Suburb\n* Address\n* Rooms: Number of rooms\n* Price: Price in Australian dollars, target variable\n* Method: S - property sold; SP - property sold prior; PI - property passed in; PN - sold prior not disclosed; SN - sold not disclosed; NB - no bid; VB - vendor bid; W - withdrawn prior to auction; SA - sold after auction; SS - sold after auction price not disclosed. N\/A - price or highest bid not available.\n* Type: br - bedroom(s); h - house,cottage,villa, semi,terrace; u - unit, duplex; t - townhouse; dev site - development site; o res - other residential.\n* SellerG: Real Estate Agent\n* Date: Date sold\n* Distance: Distance from CBD in Kilometres\n* Regionname: General Region (West, North West, North, North east ...etc)\n* Propertycount: Number of properties that exist in the suburb.\n* Bedroom2 : Scraped # of Bedrooms (from different source)\n* Bathroom: Number of Bathrooms\n* Car: Number of carspots\n* Landsize: Land Size in Metres\n* BuildingArea: Building Size in Metres\n* YearBuilt: Year the house was built\n* CouncilArea: Governing council for the area\n* Lattitude\n* Longtitude\n\nAs you can see, there are a number of variables that contain information that could be linked to a person, like the address and the name of the estate agent. For privacy reasons, we will not use these variables. Additionally, we will remove all geographical data, except the longitude and latitude.","4db304f7":"The data set is small and contains a mixture of categorical and numeric variables. A few variables have missing values. The target variable price is a float and does not contain any missing values. Let's have a look at the categorical variable Method.","64e1514e":"# Melbourne Housing Market\nhttps:\/\/www.kaggle.com\/dansbecker\/melbourne-housing-snapshot","74e8d984":"A few things to note from the histograms:\n- the building area is zero for many houses (about 50%)\n- most houses seem to be within a range of 20 kilometres of the city centre\n- land size is zero for almost all houses\n- the house price is a bit skewed","0ec479ca":"## 1. Framing the problem\nAccording to the [dataset description](https:\/\/www.kaggle.com\/dansbecker\/melbourne-housing-snapshot) on Kaggle, the housing prices in Melbourne reached a peak in 2017. As [this article on theguardian.com](https:\/\/www.theguardian.com\/australia-news\/2019\/jan\/02\/australian-house-prices-falling-at-fastest-rate-in-a-decade-data-shows) describes, the prices are dropping rapidly in 2019. Was it a price bubble for which the market is making a correction now?\n\nThis notebook will try to predict the price of a house based on the different attributes. As the training data contains a continuous target variable, this is a supervised regression problem.\n\nThe performance is measured with Root Mean Squared Error [(RMSE)](https:\/\/en.wikipedia.org\/wiki\/Root-mean-square_deviation). The goal is to minimize the RMSE of the predictions. \n\nI created this notebook to learn more about regression. Hopefully it can be a help for others in their career or studies! I based this notebook heavily on the chapter on regression from the excellent book [Hands-On Machine Learning with Scikit-Learn and TensorFlow by Aur\u00e9lien G\u00e9ron (O'Reilly). Copyright 2017 Aur\u00e9lien G\u00e9ron, 978-1-491-96229-9](http:\/\/shop.oreilly.com\/product\/0636920052289.do)","23bce23f":"### Study the variables\nThe pandas_profiling package is a great package for more insights on the data.","a0721613":"### Correlations\nWith the standard correlation coefficient we can analyze if there is a linear relationship between the Price and the other variables. \n\nAs we can see, there is a fair linear relationship between Price and the number of Rooms. Bedroom2 and Bathroom are also correlated with Price, but most likely they are also correlated to Rooms. The number of parking lots also has a positive impact on the Price. As we've seen in the scatterplot of the geographical coordinates, houses in the East of Melbourne (i.e. higher longitude) are more expensive.\n\nHouses closer to the Central Business District (i.e. smaller Distance) are more expensive. Secondly, the older the house (i.e. smaller YearBuilt), the higher the Price.","f8c2c6d7":"### Importing packages","f831e717":"### Create a test set","c48dbe06":"## 3. Data Exploration\nIn this section we will have a deeper look at the data. To avoid data snooping bias, we will work with the train_set data from here on.","7b49c693":"### Geographical data\nWe have the latitude and longitude in the data, so we can plot that in a scatter plot. Because of a few outliers, there is not much variation in the color of the houses on the map. For that reason we omit the top 1% from the data to build the plot. This gives more insight in where the more expensive houses are located.\n\nWhen we look on a [Google Map](https:\/\/www.google.com\/maps\/@-37.8684198,144.8378456,10.54z), we see that the more expensive houses are located in the bay area of Melbourne and the Southern and Eastern Metropolitan Regions. It might be useful to make clusters based on the location and determine the distance to the cluster centers. ","050382e6":"Only other_rooms seems to have some correlation with Price. Perhaps we can create other variables when we gather new insights in the data.","1109e7e3":"### Feature extraction\nWith the variables present in the data set, we can construct new variables by making combinations. For example:\n\n- other_rooms: number of other rooms than bathroom\n- surface_per_room: we can get a rough estimate of the room surface by dividing the total building area with the number of rooms\n- perc_built: how much of the land is taken by the building. This might be a proxy of the surface of the garden.\n- house_age: age of the house"}}