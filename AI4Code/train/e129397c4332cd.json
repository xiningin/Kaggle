{"cell_type":{"c9bcb935":"code","fb342e47":"code","19c91a9c":"code","936e7405":"code","3a4e1641":"code","9038b225":"code","25b2915d":"code","b0162993":"code","93915fe6":"code","ce73c0dc":"code","29109167":"code","dd432f4d":"code","20e508a5":"code","fd199e99":"code","6e222e9c":"code","b7784fb6":"code","19275505":"code","3c0deaa2":"code","e80ab22d":"code","3e0a06a3":"code","46728004":"code","0cf3efa4":"code","4a9627c8":"markdown","394cf10c":"markdown","09705353":"markdown","890062fe":"markdown","0887ee47":"markdown","56f90b81":"markdown","a58ac309":"markdown","1f7a9cb2":"markdown","61911217":"markdown","1ba26751":"markdown","1a969382":"markdown","e268d786":"markdown","0fda0a93":"markdown","90f748ee":"markdown","4068d007":"markdown","f4cf210e":"markdown","678038c6":"markdown","ef9a01ce":"markdown","25cc6d98":"markdown","7c52859e":"markdown","06ac89f2":"markdown","057f5174":"markdown","ae0e44c5":"markdown","c64b401e":"markdown","c5d51cd2":"markdown","ac625b2b":"markdown","d288bd9f":"markdown","22ccc7ce":"markdown"},"source":{"c9bcb935":"# Import libraries\n\nimport pandas as pd # For data manipulation\nimport numpy as np # For various mathematical computations, array manipulations\nimport matplotlib.pyplot as plt # Visualization\nimport seaborn as sns #Visualization","fb342e47":"# Ignore warnings\n\nimport warnings\nwarnings.filterwarnings('ignore')","19c91a9c":"df = pd.read_csv('..\/input\/PGA_Data_Historical.csv')\ndf.head(10)","936e7405":"df[df['Player Name'] == 'Tiger Woods'][df['Statistic'] == 'SG: Putting']","3a4e1641":"df[df['Player Name'] == 'Tiger Woods'][df['Statistic'] == 'Official World Golf Ranking']","9038b225":"keep_vars = [\n    'SG: Off-the-Tee - (AVERAGE)',\n    'SG: Approach-the-Green - (AVERAGE)',\n    'SG: Around-the-Green - (AVERAGE)',\n    'SG: Putting - (AVERAGE)',\n    'Official World Golf Ranking - (AVG POINTS)'\n]","25b2915d":"data = df[df['Variable'].apply(lambda x: x in keep_vars)] # Define our main dataframe to work with as data","b0162993":"data['Value'] = data['Value'].astype('float64') # All values are given as strings, change to float64","93915fe6":"data = pd.pivot_table(data=data, index=['Player Name', 'Season'], columns=['Statistic'], values='Value')","ce73c0dc":"# Reorder and rename OWGR column\n\ndata['OWGR Avg Pts'] = data['Official World Golf Ranking'] # Put this column at the end\ndata = data.drop('Official World Golf Ranking', axis=1)","29109167":"data.head(15)","dd432f4d":"data = data.dropna() # Drop NaN's","20e508a5":"sns.pairplot(data=data)\nplt.show()","fd199e99":"# Import linear regression libraries\n\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\n\n# Split features and target\n\nX = data.iloc[: ,:-1]\ny = data.iloc[:,-1:]\n\n# Train test split\n\nX_train, X_test, y_train, y_test = train_test_split(X,y, random_state=12)\n","6e222e9c":"# Fit the model\n\nlr = LinearRegression()\nlr.fit(X_train, y_train)","b7784fb6":"print('training set r^2 score = ' + str(lr.score(X_train, y_train)))\n\nprint('testing set r^2 score = ' + str(lr.score(X_test, y_test)))","19275505":"# Create list of predictions\n\nlin_reg_preds = pd.DataFrame(lr.predict(X), columns=['OWGR Avg Pts - Prediction'], index=y.index)","3c0deaa2":"# Plot and compare with the line y=x\n\nsns.scatterplot(data=pd.concat([y,lin_reg_preds], axis=1), x='OWGR Avg Pts', y='OWGR Avg Pts - Prediction', label='Pred vs True') # scatter plot of prediction vs true\nsns.lineplot(np.linspace(0,15,20),np.linspace(0,15,20), color='r', label='y=x') # plot the line y=x\nplt.show()","e80ab22d":"# Import polynomial libraries\n\nfrom sklearn.preprocessing import PolynomialFeatures\n\n# Create polynomial features\n\ndegree = 2 # Start with 2\npoly = PolynomialFeatures(degree, include_bias=False)\n\nX_poly = poly.fit_transform(X) # No longer a pandas dataframe\ny_poly = y # Still a pandas dataframe\n\nX_poly_train, X_poly_test, y_poly_train, y_poly_test = train_test_split(X_poly, y_poly, random_state=12)","3e0a06a3":"# Fit the model\n\nlr_poly = LinearRegression()\nlr_poly.fit(X_poly_train, y_poly_train)","46728004":"print('training set r^2 score = ' + str(lr_poly.score(X_poly_train, y_poly_train)))\n\nprint('testing set r^2 score = ' + str(lr_poly.score(X_poly_test, y_poly_test)))","0cf3efa4":"# Create list of predictions\nlin_poly_reg_preds = pd.DataFrame(lr_poly.predict(X_poly), columns=['OWGR Avg Pts - Poly_Prediction'], index=y.index) \n\n# Plot and compare with the line y=x\nsns.scatterplot(data=pd.concat([y_poly,lin_poly_reg_preds], axis=1), x='OWGR Avg Pts', y='OWGR Avg Pts - Poly_Prediction', label='Pred vs True') # scatter plot of prediction vs true\nsns.lineplot(np.linspace(0,15,20),np.linspace(0,15,20), color='r', label='y=x') # plot the line y=x\nplt.show()","4a9627c8":"The data used comes from the great dataset provided by Brad Klassen on Kaggle, covering many different player statistics over the years 2010-2018. Big thanks to Brad for doing the work in scraping all of the data.","394cf10c":"# Data Preprocessing and Quick EDA","09705353":"Here we study and analyze the power of the four main strokes gained statistics on the PGA Tour: \nSG: Off-the-Tee, \nSG: Approach-the-Green, \nSG: Around-the-Green and \nSG: Putting. \nThese four main stats are designed to measure a golfers relative skill in each of the corresponding aspects of the game. We will refer to these four strokes gained stats as the \"strokes gained metrics\".\n\nOur goal is to somehow see how strong of predictors these measurements are in terms of the overall quality of the golfer. Of course there are many ways to measure \"overall quality of a golfer\", but for us we take it to mean their average Official World Golf Ranking points gained per event (This is the quantity on which the true Official World Golf Rankings are based). We will refer to this quantity as \"average world golf ranking points\".\n\nWe will ask: Given a golfer's yearly strokes gained metrics how well can we predict their average world golf ranking points?\n\n","890062fe":"We see that on top of the r^2 score not being great, we seem to have the problem of consistantly underestimating better golfers and also predicting some values to be negative.","0887ee47":"Nonetheless, we start with standard linear regresssion.","56f90b81":"Before applying linear regression, let's take a look at a pairplot of all the features.","a58ac309":"(One thing to note is that there are more seasons worth of data for the Official World Golf Ranking stat compared to the strokes gained metrics. We will see that we drop the NaNs that appear because of this.)\n\nHere we are only interested in the \" - (AVG POINTS)\" variable.","1f7a9cb2":"## Conclusion:\n\nAlthough, it is obvious that the better a golfers strokes gained statistics, the higher they will be in the Official World Golf Rankings, it is interesting to see just how much the model improves by adding some non-linearity.","61911217":"The pair of r^2 scores are relatively close which is a good sign, but the values themeselves are not that great.\n\nWe can visualize how our predictions differed from what they should be","1ba26751":"# Linear Regression (Fitting a Higher Degree Polynomial)","1a969382":"We use pd.pivot_table to reorganize the dataframe into one where linear regression is easier, along with some renaming of the columns.","e268d786":"Load the data and take a quick look","0fda0a93":"# Linear Regression (Fitting a Linear Model)","90f748ee":"To subselect the relevant rows for us, we will first filter by the \"Variable\" column enforcing that the value is one of the elements of the list keep_vars","4068d007":"## Problems:\n\nThere are some obvious problems with this, most notably coming from the official definition of \"OWGR Avg Pts\". The official number is computed for a given golfer over a rolling period of two years, as the average total OWGR points earned over all of their events in that 2 year period. However, if a golfer has played fewer than 40 events the divisor in the average is still taken to be 40. So, it would be better to consider feature vectors that include the previous two years of strokes gained metrics (possibly weighted).","f4cf210e":"There are many rows for which the strokes gained metrics are not available, for now will will simply drop them.","678038c6":"This notebook is written with the purpose being to act as an excuse for myself to become more fluent in various aspects of data science including data cleaning, modelling and machine learning.\n\n\nOur technique will be to first apply a simple linear regression model but then notice the inherent non-linear behavior of our problem and find more sucess fitting a higher degree polynomial.","ef9a01ce":"We will not preprocess the data any further as the relative size of all of the features and target values are approximately the same.","25cc6d98":"Let us try and improve the model by adding some non-linearity.","7c52859e":"## Evaluate the Model: \nLooking at the r^2 score on both the train and test sets we get","06ac89f2":"# On the Strokes Gained Statistics on the PGA Tour","057f5174":"## Evaluate the Model:","ae0e44c5":"We see that we get a significant improvement compared to standard linear regression.\n\nPlotting and comparing to the line y=x as above:","c64b401e":"Here we see that within each season, the \"SG: Putting\" stat has 4 variables. We are only interested in the \" - (AVERAGE)\" variable. \n\nThe format for the other stokes gained metrics are similar.","c5d51cd2":"Filtering by \"Tiger Woods\" and \"Official World Golf Ranking\" gives:","ac625b2b":"Looking at the unique values in the \"Statistic\" column (of which there are many), we are only interested in 5 statistics corresponding to our 4 strokes gained metrics and average world golf ranking points. The exact format they appear in under the \"Statistic\" column is \"SG: Off-the-Tee\", \n\"SG: Approach-the-Green\", \n\"SG: Around-the-Green\",\n\"SG: Putting\" and\n\"Official World Golf Ranking\".\n\nTo see better what the structure of the dataset looks like, lets filter by \"Tiger Woods\" and \"SG: Putting\".","d288bd9f":"Visually there does not seem to be any relationship among the 4 strokes gained stats. However, \"OWGR Avg Pts\" as a function of the other stats seems like there is some relationship we can exploit. Furthermore, it (visually) seems like this relationship is non-linear, so fitting a higher degree polynomial for our model might prove useful.","22ccc7ce":"After playing around with the degree, it doesn't look like we can do much better than this."}}