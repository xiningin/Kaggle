{"cell_type":{"1b94e67e":"code","9aef3079":"code","7ba22279":"code","59522517":"code","00218da1":"code","7bdeab7f":"code","4ad175ce":"code","5d80883b":"code","c14a6d40":"code","81005053":"code","58c0ba76":"code","43e26ade":"code","cd134201":"code","35a26efb":"code","8b016a87":"code","3b3cf731":"code","e74de31c":"code","f8defc1a":"code","f73c0801":"code","64160f26":"code","ab6e0aae":"code","d63297bf":"code","19690a4c":"code","a74f95ea":"code","fd1946e7":"code","bbe88dc6":"code","ed570485":"code","62241a6b":"code","2f3f1b76":"markdown","5cd96d99":"markdown","a9f12919":"markdown","9aaabbdd":"markdown","7d7366f8":"markdown","cc85d29b":"markdown","8b5b8913":"markdown","a4b20f43":"markdown","f4c43e41":"markdown","ebd5aa3c":"markdown","b1cd4e0c":"markdown","04a41b04":"markdown","1ed47271":"markdown","b83af440":"markdown","1ebd508e":"markdown","25ac3495":"markdown","edae4c1f":"markdown","68eb6efc":"markdown","ae11eb01":"markdown","80086566":"markdown","7d09b571":"markdown","b14ecbf3":"markdown"},"source":{"1b94e67e":"import warnings\nwarnings.filterwarnings('ignore')","9aef3079":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n%matplotlib inline","7ba22279":"df = pd.read_csv('..\/input\/heart.csv')\ndf.head(3)","59522517":"print('Number of rows in the dataset: ',df.shape[0])\nprint('Number of columns in the dataset: ',df.shape[1])","00218da1":"df.isnull().sum()","7bdeab7f":"df.describe()","4ad175ce":"male =len(df[df['sex'] == 1])\nfemale = len(df[df['sex']== 0])\n\nplt.figure(figsize=(8,6))\n\n# Data to plot\nlabels = 'Male','Female'\nsizes = [male,female]\ncolors = ['skyblue', 'yellowgreen']\nexplode = (0, 0)  # explode 1st slice\n \n# Plot\nplt.pie(sizes, explode=explode, labels=labels, colors=colors,\nautopct='%1.1f%%', shadow=True, startangle=90)\n \nplt.axis('equal')\nplt.show()","5d80883b":"plt.figure(figsize=(8,6))\n\n# Data to plot\nlabels = 'fasting blood sugar < 110 mg\/dl','fasting blood sugar > 110 mg\/dl'\nsizes = [len(df[df['fbs'] == 0]),len(df[df['cp'] == 1])]\ncolors = ['skyblue', 'yellowgreen','orange','gold']\nexplode = (0.1, 0)  # explode 1st slice\n \n# Plot\nplt.pie(sizes, explode=explode, labels=labels, colors=colors,\nautopct='%1.1f%%', shadow=True, startangle=180)\n \nplt.axis('equal')\nplt.show()","c14a6d40":"plt.figure(figsize=(8,6))\n\n# Data to plot\nlabels = 'No','Yes'\nsizes = [len(df[df['exang'] == 0]),len(df[df['exang'] == 1])]\ncolors = ['skyblue', 'yellowgreen']\nexplode = (0.1, 0)  # explode 1st slice\n \n# Plot\nplt.pie(sizes, explode=explode, labels=labels, colors=colors,\nautopct='%1.1f%%', shadow=True, startangle=90)\n \nplt.axis('equal')\nplt.show()","81005053":"sns.set_style('whitegrid')","58c0ba76":"plt.figure(figsize=(14,8))\nsns.heatmap(df.corr(), annot = True, cmap='coolwarm',linewidths=.1)\nplt.show()","43e26ade":"sns.distplot(df['thalach'],kde=False,bins=30)","cd134201":"sns.distplot(df['chol'],kde=False,bins=30)\nplt.show()","35a26efb":"sns.distplot(df['trestbps'],kde=False,bins=30,color='blue')\nplt.show()","8b016a87":"plt.figure(figsize=(15,6))\nsns.countplot(x='age',data = df, hue = 'target',palette='GnBu')\nplt.show()","3b3cf731":"plt.figure(figsize=(8,6))\nsns.scatterplot(x='chol',y='thalach',data=df,hue='target')\nplt.show()","e74de31c":"plt.figure(figsize=(8,6))\nsns.scatterplot(x='trestbps',y='thalach',data=df,hue='target')\nplt.show()","f8defc1a":"X= df.drop('target',axis=1)\ny=df['target']","f73c0801":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test = train_test_split(X,y,test_size=.3,random_state=42)","64160f26":"from sklearn.preprocessing import MinMaxScaler","ab6e0aae":"scaler = MinMaxScaler()\n\nX_train_scaled = scaler.fit_transform(X_train)\nX_train = pd.DataFrame(X_train_scaled)\n\nX_test_scaled = scaler.fit_transform(X_test)\nX_test = pd.DataFrame(X_test_scaled)","d63297bf":"from sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.model_selection import GridSearchCV\nknn =KNeighborsClassifier()\nparams = {'n_neighbors':[i for i in range(1,33,2)]}","19690a4c":"model = GridSearchCV(knn,params,cv=10)","a74f95ea":"model.fit(X_train,y_train)\nmodel.best_params_           #print's parameters best values","fd1946e7":"predict = model.predict(X_test)","bbe88dc6":"from sklearn.metrics import accuracy_score,confusion_matrix\nprint('Accuracy Score: ',accuracy_score(y_test,predict))\nprint('Using k-NN we get an accuracy score of: ',\n      round(accuracy_score(y_test,predict),5)*100,'%')","ed570485":"\ncnf_matrix = confusion_matrix(y_test,predict)\ncnf_matrix","62241a6b":"class_names = [0,1]\nfig,ax = plt.subplots()\ntick_marks = np.arange(len(class_names))\nplt.xticks(tick_marks,class_names)\nplt.yticks(tick_marks,class_names)\n\n#create a heat map\nsns.heatmap(pd.DataFrame(cnf_matrix), annot = True, cmap = 'YlGnBu',\n           fmt = 'g')\nax.xaxis.set_label_position('top')\nplt.tight_layout()\nplt.title('Confusion matrix', y = 1.1)\nplt.ylabel('Actual label')\nplt.xlabel('Predicted label')\nplt.show()","2f3f1b76":"#### **Plotting the distribution of various attribures**","5cd96d99":"#### **3. fbs: (fasting blood sugar > 110 mg\/dl) (1 = true; 0 = false)**\nbecause it is used threshold value 110mg\/dl","a9f12919":"#### **4.exang: exercise induced angina (1 = yes; 0 = no)**","9aaabbdd":"#### **3. trestbps: resting blood pressure (in mm Hg on admission to the hospital)**","7d7366f8":"#### **6.Scatterplot for thalach vs. trestbps **","cc85d29b":"### **Exploratory Data Analysis**","8b5b8913":"There are no null values in the dataset","a4b20f43":"**Checking accuracy**","f4c43e41":"**Implementing GridSearchCv to select best parameters and applying k-NN Algorithm**","ebd5aa3c":"#### **1. thalach: maximum heart rate achieved**","b1cd4e0c":"**Splitting the dataset into training and test set**","04a41b04":"**Confusion Matrix**","1ed47271":"### **Making Predictions**","b83af440":"#### **1. Heatmap**","1ebd508e":"**Making predictions**","25ac3495":"**Preprocessing - Scaling the features**","edae4c1f":"### **Checking features of various attributes**","68eb6efc":"#### **5.Scatterplot for thalach vs. chol **","ae11eb01":"#### **4. Number of people who have heart disease according to age **","80086566":"**Dimensions of the dataset**","7d09b571":"#### **2.chol: serum cholestoral in mg\/dl **","b14ecbf3":"**Checking for null values in the dataset**"}}