{"cell_type":{"03efbb3f":"code","fd580133":"code","bbf8a4da":"code","f7d23cfd":"code","ed44eaca":"code","9d57d77b":"code","742a484e":"code","d0fb6b93":"code","e1d8a0ca":"code","6beed5e4":"code","0192ed19":"code","41f50c27":"code","674e7c09":"code","3b09cfc1":"code","196e73eb":"code","c183275e":"code","579ab0fb":"code","d04fd2b0":"code","a4e00da2":"code","19827111":"code","c8bbbb32":"code","f9bc014b":"code","06ccea7f":"code","43c35844":"code","fb96b30c":"code","0fcf09ba":"code","55e133fb":"code","fc914646":"code","34078682":"code","840d5079":"code","9ec10064":"code","eaa34a6a":"code","0f372e58":"code","799925bb":"code","ed43806b":"code","42dd7c8f":"code","6573d2a4":"code","cf649aa2":"code","8dcae111":"code","45cd4041":"code","f43b8ce0":"code","29d61250":"code","35339e2f":"code","368f25c1":"code","b4477443":"code","9b759ec0":"code","3089e0b6":"code","e18102be":"code","7455810d":"code","80344604":"code","cd01cc0b":"code","0f2f4aaf":"code","bfb2e0d6":"code","0e389512":"code","998db281":"code","17e088e0":"code","8db62158":"code","a1ae1b77":"code","196c15b4":"code","137e60f6":"code","7db1e778":"code","cb5c33d5":"code","53e08e88":"code","d8d31299":"code","dd2b3031":"code","ba08de6a":"markdown","d1f8b5da":"markdown","8527eb11":"markdown","e7d58f56":"markdown","a325ce65":"markdown","e022d8a6":"markdown","0e83537c":"markdown","4a87deea":"markdown","4c2211a4":"markdown","00734ae9":"markdown","fbc94c34":"markdown","7849434f":"markdown"},"source":{"03efbb3f":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","fd580133":"df=pd.read_csv('..\/input\/titanic\/train.csv')","bbf8a4da":"df.head()","f7d23cfd":"df.info()","ed44eaca":"df.describe()","9d57d77b":"df.shape","742a484e":"df.drop(['PassengerId','Name','Ticket','Fare','Embarked'],axis=1, inplace=True)","d0fb6b93":"df.loc[df['Sex']=='male','Sex']=1\ndf.loc[df['Sex']=='female','Sex']=0","e1d8a0ca":"df['Survived'].value_counts()","6beed5e4":"sns.countplot(data=df,x='Survived')","0192ed19":"df.corr()['Survived'].sort_values()","41f50c27":"sns.pairplot(data=df)","674e7c09":"sns.heatmap(df.corr(), annot=True,cmap='Reds')","3b09cfc1":"df.isnull().sum()","196e73eb":"100*(df.isnull().sum()\/len(df))","c183275e":"def missing_percent(df):\n    nan_percent= 100*(df.isnull().sum()\/len(df))\n    nan_percent= nan_percent[nan_percent>0].sort_values()\n    return nan_percent","579ab0fb":"nan_percent= missing_percent(df)","d04fd2b0":"nan_percent","a4e00da2":"plt.figure(figsize=(12,6))\nsns.barplot(x=nan_percent.index, y=nan_percent)\nplt.xticks(rotation=90)","19827111":"df.drop(\"Cabin\", axis = 1, inplace = True)","c8bbbb32":"df[\"Age\"].fillna(df[\"Age\"].mean(), inplace = True)","f9bc014b":"df.isnull().sum()","06ccea7f":"X=df.drop('Survived',axis=1)\ny=df['Survived']","43c35844":"from sklearn.model_selection import train_test_split\n","fb96b30c":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.1, random_state=101)","0fcf09ba":"from sklearn.preprocessing import StandardScaler","55e133fb":"scaler= StandardScaler()","fc914646":"scaler.fit(X_train)","34078682":"scaled_X_train= scaler.transform(X_train)\nscaled_X_test= scaler.transform(X_test)","840d5079":"from sklearn.neighbors import KNeighborsClassifier","9ec10064":"knn_model=KNeighborsClassifier(n_neighbors=1)","eaa34a6a":"knn_model.fit(scaled_X_train,y_train)","0f372e58":"y_pred=knn_model.predict(scaled_X_test)","799925bb":"#the prediction value vs actual value of test data\npd.DataFrame({'Y_Test':y_test,'Y_pred':y_pred})","ed43806b":"from sklearn.metrics import classification_report,confusion_matrix,accuracy_score","42dd7c8f":"accuracy_score(y_test,y_pred)","6573d2a4":"confusion_matrix(y_test,y_pred)","cf649aa2":"print(classification_report(y_test, y_pred))","8dcae111":"test_error_rate=[]\n\n\nfor k in range (1, 30):\n    knn_model=KNeighborsClassifier(n_neighbors=k)\n    knn_model.fit(scaled_X_train, y_train)\n    \n    y_pred_test= knn_model.predict(scaled_X_test)\n    \n    test_error=1-accuracy_score(y_test , y_pred_test)\n    test_error_rate.append(test_error)","45cd4041":"test_error_rate","f43b8ce0":"plt.figure(figsize=(10, 6))\nplt.plot(range(1, 30), test_error_rate, label='Test Error')\nplt.legend()\nplt.ylabel('Error Rate')\nplt.xlabel('K Value')","29d61250":"scaler= StandardScaler()","35339e2f":"knn= KNeighborsClassifier()","368f25c1":"knn.get_params().keys()","b4477443":"operations= [('scaler', scaler), ('knn', knn)]","9b759ec0":"from sklearn.pipeline import Pipeline","3089e0b6":"pipe= Pipeline(operations)","e18102be":"from sklearn.model_selection import GridSearchCV","7455810d":"k_values= list(range(1, 20))","80344604":"param_grid= {'knn__n_neighbors': k_values}","cd01cc0b":"full_cv_classifier= GridSearchCV(pipe, param_grid, cv=5, scoring='accuracy')","0f2f4aaf":"full_cv_classifier.fit(X_train, y_train)","bfb2e0d6":"full_cv_classifier.best_estimator_.get_params()","0e389512":"full_cv_classifier.cv_results_.keys()","998db281":"scaler=StandardScaler()\nknn14=KNeighborsClassifier(n_neighbors=14)\noperations=[('scaler',scaler),('knn14',knn14)]","17e088e0":"pipe= Pipeline(operations)","8db62158":"pipe.fit(X_train , y_train)","a1ae1b77":"pipe_pred=pipe.predict(X_test)","196c15b4":"print(classification_report(y_test,pipe_pred))","137e60f6":"sample= X_test.iloc[44]","7db1e778":"sample","cb5c33d5":"sample.values","53e08e88":"sample.values.reshape(1, -1)","d8d31299":"pipe.predict(sample.values.reshape(1, -1))","dd2b3031":"pipe.predict_proba(sample.values.reshape(1, -1))","ba08de6a":"# Predicting Test Data","d1f8b5da":"# Import the Dataset","8527eb11":"# Final Model","e7d58f56":"# Creating a Pipeline to find K value","a325ce65":"# Import all Necessary Libraries","e022d8a6":"# Missing Data","0e83537c":"# Features & Label","4a87deea":"# Train the Model","4c2211a4":"# Data Overview","00734ae9":"# Scalling The Features","fbc94c34":"# Evaluating the Model","7849434f":"# EDA"}}