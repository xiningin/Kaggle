{"cell_type":{"88263991":"code","a5400f2a":"code","09a76a2b":"code","7f642afb":"code","78d88947":"code","ce8cf835":"code","0d7629b0":"code","029921c3":"code","2247a71e":"code","08cde809":"code","8b4edd90":"code","a5529dec":"code","61cfe4e5":"code","c8308ef6":"code","ec0aeffd":"code","327d42e5":"code","4123140e":"code","c85858bc":"code","ed1c6bcd":"code","da6f7437":"code","626f164e":"code","f2b67949":"code","2531582e":"code","cc0db4ff":"code","fe0588ff":"code","17883e09":"code","492441f0":"code","089162f5":"code","0b760493":"code","112de524":"code","2630190e":"code","2329e04f":"code","33fc419d":"code","c8a2d84d":"code","11919341":"code","4edf6014":"code","aba539c0":"code","83b6c27c":"code","09c587ee":"code","9623fe16":"markdown","4581364b":"markdown","2a7c935a":"markdown","e9d04f5f":"markdown","19513cd6":"markdown","8db7ce81":"markdown","39392222":"markdown","3b7a1f4c":"markdown"},"source":{"88263991":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","a5400f2a":"df=pd.read_csv('..\/input\/titanic\/train.csv')","09a76a2b":"df.head()","7f642afb":"df.shape","78d88947":"df.info()","ce8cf835":"df.describe()","0d7629b0":"df.corr()['Survived'].sort_values()","029921c3":"sns.pairplot(df,hue='Survived')","2247a71e":"sns.scatterplot(data=df, x='Survived', y='Fare',color='y')\nplt.axhline(y=300,color='r')","08cde809":"index_drop=df[(df['Fare']>300)].index\ndf=df.drop(index_drop, axis=0)","8b4edd90":"sns.scatterplot(data=df, x='Survived', y='Parch',color='g')","a5529dec":"sns.scatterplot(data=df, x='Survived', y='SibSp',color='b')\nplt.axhline(y=5,color='r')","61cfe4e5":"index_drop=df[(df['SibSp']>5)].index\ndf=df.drop(index_drop, axis=0)","c8308ef6":"sns.scatterplot(data=df, x='Survived', y='Age',color='#03fce3')\nplt.axhline(y=75,color='r')","ec0aeffd":"index_drop=df[(df['Age']>75)].index\ndf=df.drop(index_drop, axis=0)","327d42e5":"sns.scatterplot(data=df, x='Survived', y='Pclass',color='#d119cb')","4123140e":"sns.scatterplot(data=df, x='Survived', y='PassengerId',color='#19d166')","c85858bc":"def missing_percent(df):\n    nan_percent=(df.isnull().sum()\/len(df))*100\n    nan_percent=nan_percent[nan_percent>0].sort_values()\n    return nan_percent\nnan_percent=missing_percent(df)\nsns.barplot(x=nan_percent.index,y=nan_percent)","ed1c6bcd":"df[df['Embarked'].isnull()]","da6f7437":"df= df.dropna(axis=0, subset=['Embarked'])","626f164e":"df=df.drop('Cabin',axis=1 )","f2b67949":"df.corr()['Age'].sort_values()","2531582e":"df.groupby('Pclass')['Age'].mean()","cc0db4ff":"df['Age']=df.groupby('Pclass')['Age'].transform(lambda val: val.fillna(val.mean()))","fe0588ff":"df.columns","17883e09":"df_num= df[['Survived','Pclass','Age','SibSp','Parch','Fare']]\ndf_obj= df[['Sex','Embarked']]","492441f0":"df_obj= pd.get_dummies(df_obj, drop_first=True)","089162f5":"Final_df= pd.concat([df_num, df_obj], axis=1)\nFinal_df.shape","0b760493":"Final_df.isnull()","112de524":"df=Final_df","2630190e":"df.head()","2329e04f":"X= df.drop('Survived', axis=1)\ny= df['Survived']","33fc419d":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.1, random_state=101)","c8a2d84d":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import GridSearchCV\n\nn_estimators=[64, 100, 128, 200]\nmax_features=[3, 4,5,6,7,8]\nbootstrap=[True, False]\nparam_grid= {'n_estimators':n_estimators,\n            'max_features':max_features,\n            'bootstrap':bootstrap}\n\n\nRF_model= RandomForestClassifier()\ngrid=GridSearchCV(RF_model, param_grid, cv=5 )\ngrid.fit(X_train, y_train)","11919341":"grid.best_params_","4edf6014":"y_pred= grid.predict(X_test)","aba539c0":"RF_model_OOB= RandomForestClassifier(max_features=3, n_estimators=128, oob_score=True)","83b6c27c":"RF_model_OOB.fit(X_train, y_train)","09c587ee":"RF_model_OOB.oob_score_","9623fe16":"# Step4: EDA","4581364b":"# **Step7:Split to Train & test**","2a7c935a":"# Step1:Import Libraries ","e9d04f5f":"# **Step6:Features&Label**","19513cd6":"# Step3:Data Overview ","8db7ce81":"# **Step8:Train\/Test\/Evaluating**","39392222":"# **Step5: Data Preperation**","3b7a1f4c":"# Step2:Read  Dataset"}}