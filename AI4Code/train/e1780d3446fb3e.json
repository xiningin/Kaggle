{"cell_type":{"368b8d70":"code","08705921":"code","7c459a99":"code","2634feb5":"code","2da5ffd3":"code","0a27c31b":"code","3aef642a":"code","0c521f13":"code","75c8ebb6":"code","8ce44015":"code","ee34bf41":"code","725e7fa4":"code","e29c8740":"code","fb478517":"code","4af2a7d8":"code","dd438034":"code","549e65c4":"code","6437b611":"markdown","bce8a457":"markdown","433322ff":"markdown","a34fb833":"markdown"},"source":{"368b8d70":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import train_test_split, cross_val_score\nfrom sklearn import metrics","08705921":"data = pd.read_csv(\"..\/input\/HR_comma_sep.csv\")\nprint(data.head())","7c459a99":"data.columns","2634feb5":"data.dtypes","2da5ffd3":"data.describe()","0a27c31b":"pd.crosstab(data.salary, data.left).plot(kind='bar')\nplt.show()","3aef642a":"q = pd.crosstab(data.salary, data.left)\nprint(q)\nprint('\\n')\nprint(q.sum(1))\nq.div(q.sum(1), axis = 0).plot(kind='bar', stacked = True)\nplt.show()","0c521f13":"p1 = data[data.left==0].satisfaction_level.hist()\np2 = data[data.left==1].satisfaction_level.hist()\nplt.show()","75c8ebb6":"p = pd.crosstab(data.promotion_last_5years, data.left)\np.div(q.sum(0), axis = 0).plot(kind='bar', stacked = True)\nplt.show()","8ce44015":"from patsy import dmatrices  # dummy variable\n\ny, X = dmatrices('left~satisfaction_level+last_evaluation+number_project+average_montly_hours+time_spend_company+Work_accident+promotion_last_5years+C(sales)+C(salary)', data, return_type='dataframe')\n# X.head()\nX = X.rename(columns = {\n    'C(sales)[T.RandD]': 'Department: Random',\n    'C(sales)[T.accounting]': 'Department: Accounting',\n    'C(sales)[T.hr]': 'Department: HR',\n    'C(sales)[T.management]': 'Department: Management',\n    'C(sales)[T.marketing]': 'Department: Marketing',\n    'C(sales)[T.product_mng]': 'Department: Product_Management',\n    'C(sales)[T.sales]': 'Department: Sales',\n    'C(sales)[T.support]': 'Department: Support',\n    'C(sales)[T.technical]': 'Department: Technical',\n    'C(salary)[T.low]': 'Salary: Low',\n    'C(salary)[T.medium]': 'Salary: Medium'}) \ny = np.ravel(y)","ee34bf41":"model = LogisticRegression()\n\nmodel.fit(X, y)\nprint(pd.DataFrame(list(zip(X.columns, np.transpose(model.coef_)))))","725e7fa4":"print(model.score(X,y))","e29c8740":"# use trained model to predict an example\nmodel.predict_proba([[1,0,0,1,0,0,0,0,0,0,0,0, 0.5, 0.7, 4.0, 160, 3.0, 0, 0]])","fb478517":"pred = model.predict(X)\n(abs(pred-y)).sum() \/ len(y)","4af2a7d8":"Xtrain,Xtest,ytrain,ytest=train_test_split(X, y, test_size=0.2, random_state=0)\nmodel2 = LogisticRegression()\nmodel2.fit(Xtrain, ytrain)","dd438034":"model2 = LogisticRegression(C=10000)\nmodel2.fit(Xtrain, ytrain)\npred = model2.predict(Xtest)\nmetrics.accuracy_score(ytest, pred)","549e65c4":"#sklearn.metrics.classification_report(y_true, y_pred)\nprint(metrics.classification_report(ytest, pred))\nprint(cross_val_score(LogisticRegression(), X, y, scoring='accuracy', cv=10))","6437b611":"**Observe the data**","bce8a457":"**Train model**","433322ff":"**Using dmatrices to generate dummy variables**","a34fb833":"**Cross validation**"}}