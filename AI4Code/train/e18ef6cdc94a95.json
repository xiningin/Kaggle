{"cell_type":{"ddd81d08":"code","c6d1bc46":"code","5ed3cfaa":"code","17e0377d":"code","9baa1eda":"code","de95ef17":"code","0c0899cc":"code","60a97658":"code","9d9b6aaa":"code","b9ed71d1":"code","99fb20a8":"code","ca627153":"code","d0d94c5e":"code","4faf44dc":"code","86a93618":"code","a61f7b6d":"code","c6d76668":"code","7d959383":"code","b6202f43":"code","363a266c":"code","4dbc4f86":"code","465fc1fe":"code","5eca005b":"code","894310b4":"code","38d320fc":"code","ce098b14":"code","f17b0b9d":"code","e36574be":"code","8c2f0170":"markdown","d4571c03":"markdown","da512cf5":"markdown","7b9687d3":"markdown","b67e38d5":"markdown","58067dff":"markdown","36656911":"markdown","f6fb67ac":"markdown","32863702":"markdown","1f7a78c3":"markdown","8f4fda2e":"markdown","8d6f335d":"markdown","0837b471":"markdown","665100a3":"markdown","b8fa48f3":"markdown","a4f862da":"markdown"},"source":{"ddd81d08":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","c6d1bc46":"table1=pd.read_csv('\/kaggle\/input\/gufhtugu-publications-dataset-challenge\/GP Orders - 2.csv')\ntable1","5ed3cfaa":"table2=pd.read_csv('\/kaggle\/input\/gufhtugu-publications-dataset-challenge\/GP Orders - 4.csv')\ntable2","17e0377d":"table3=pd.read_csv('\/kaggle\/input\/gufhtugu-publications-dataset-challenge\/GP Orders - 5.csv')\ntable3","9baa1eda":"tables=table1.append(table2,ignore_index=True)\ntables","de95ef17":"tables.isna().sum()","0c0899cc":"tables.rename(columns={'City (Billing)':'City'},inplace=True)\ntables","60a97658":"tables1=tables.append(table3,ignore_index=True)\ntable_csv=tables1.to_csv('table.csv')\nTable=pd.read_csv('table.csv')\nTable","9d9b6aaa":"Table['Book Name']=Table['Book Name'].str.split(\"\/\")\nTable=Table.explode(\"Book Name\",ignore_index=True)\nTable['Book Name']=Table['Book Name'].str.split(\"- \")\nTable=Table.explode(\"Book Name\",ignore_index=True)\nTable['Book Name']=Table['Book Name'].str.split(\"?\")\nTable=Table.explode(\"Book Name\",ignore_index=True)\nTable= Table.replace(to_replace=r\"^\\s*$\", value=np.NAN, regex=True)\nTable=Table.replace(to_replace=r\"^[!(-. \\d]*$\", value=np.NAN, regex=True)\nTable= Table.replace(to_replace=r\"^Release Date$\", value=np.NAN, regex=True)\nTable=Table.dropna(subset=[\"Book Name\"])\nTable","b9ed71d1":"Table['City']=Table['City'].str.split(\"?\")\nTable=Table.explode('City',ignore_index=True)\nTable=Table.replace(to_replace=\"^[? ]*$\",value=np.NAN,regex=True)\nchangename={\n    \"karachi\":\"Karachi\",\n    \"KARACHI\":\"Karachi\",\n    \"lahore\":\"Lahore\",\n    \"LAHORE\":\"Lahore\",\n    \"Mailsi, district\":\"Vehari\",\n    \"Clifton \/ Karachi\":\"Karachi\",\n    \"tehsil Bhalwal District \":\"Sargodha\",\n    \" faisalabad\":\" Faisalabad\",\n    \" \u062c\u06be\u0646\u06af\":\"Jhang\",\n    \" Wah Cantt, Taxila, Rawalpindi\":\"Rawalpindi\",\n    \"Jauharabad , Distt Khushab\":\"Khushab\",\n    \" Midel town lahore\":\"Lahore\",\n    \"Gagoo Mandi tehsil Burewala district vehari\":\"Vehari\",\n    \" Mustufa Town, Wahdat Road, Lahore.\":\"Lahore\",\n    \" Rahim Yar Khan\":\"Rahim yar Khan\",\n    \"islamabad\":\"Islamabad\",\n    \"Agrics Town, Raiwand Road Lahore\":\"Lahore\",\n    \"Kallar Syedan dist Rawalpindi\":\"Rawalpindi\",\n    \" Lahore, Pakistan\":\" Lahore\",\n    \"Ahmed pur sial Jhang\":\"Jhang\",\n    \" Lyari, Karachi\":\"Karachi\",\n    \" Rawal pindi\":\" Rawalpindi\",\n    \" Academy Town, peshawar\":\"Peshawar\",\n    \" Peshawar Gulbahar no.1\":\" Peshawar\",\n    \"North Nazimabad Karachi\":\"Karachi\",\n    \" Khurrianwla faisalabad\":\"Faisalabad\",\n    \"Ali town adyala road rawalpindi.\":\"Rawalpindi\",\n    \" North Karachi\":\"Karachi\",\n    \"Khi\":\"Karachi\",\n    \"\u0644\u0627\u06c1\u0648\u0631\":\"Lahore\",\n    \" Madina town, Faisalabad\":\"Faisalabad\",\n    \"Ahmed pur sial Jhang\":\"Jhang\",\n    \"multan\":\"Multan\",\n    \"\u0645\u0627\u0646\u0633\u06c1\u0631\u06c1\":\"Mansehra\",\n    \" mansehra\":\"Mansehra\",\n    \"Rawalpindi cant\":\"Rawalpindi\"\n    \n}\nTable['City']=Table['City'].replace(changename)","99fb20a8":"Top_10_books=Table.groupby(\"Book Name\")[\"Order Number\"].agg([\"count\"]).reset_index().sort_values(by=\"count\",ascending=False).head(10)\nTop_10_books","ca627153":"import matplotlib.pyplot as plt\nimport seaborn as sns\nplt.figure(figsize=(10,5))\ngraph=sns.barplot(x='Book Name',y='count',data=Top_10_books)\ngraph.set_title('Top 10 Selling Books')\nplt.xticks(rotation=90)\nplt.show()","d0d94c5e":"Topleastbook=Table.groupby('Book Name')['Order Number'].agg(['count']).reset_index().sort_values(by='count',ascending=False).tail(10)\nprint(Topleastbook)","4faf44dc":"plt.figure(figsize=(15,5))\ngraph=sns.barplot(x='Book Name',y='count',data=Topleastbook)\ngraph.set_title('Top 10 Least Book Sold Out')\nplt.xticks(rotation=90)\nplt.show()","86a93618":"Top_10_city=Table.groupby(\"City\")[\"Order Number\"].agg([\"count\"]).reset_index().sort_values(by=\"count\",ascending=False).head(10)\nTop_10_city","a61f7b6d":"plt.figure(figsize=(12,5))\ngraph=sns.barplot(x=\"City\",y=\"count\",data=Top_10_city)\ngraph.set_title(\"Top 10 Cities In whcih Book Sold Out\")\nplt.xticks(rotation=90)\nplt.show()","c6d76668":"Change={\"Canceled\":\"Cancelled\"}\nTable[\"Order Status\"]=Table[\"Order Status\"].replace(Change)\norderstatus=Table.groupby('Order Status')['Order Number'].agg(['count']).reset_index()\nprint(orderstatus)","7d959383":"graph=sns.barplot(x=\"Order Status\",y=\"count\",data=orderstatus)\ngraph.set_title(\"Order Status\")\nplt.show()","b6202f43":"Changepay={\"Cash on Delivery (COD)\":\"Cash on delivery\"}\nTable['Payment Method']=Table['Payment Method'].replace(Changepay)\npaymethod=Table.groupby('Payment Method')['Order Number'].agg(['count']).reset_index()\nprint(paymethod)","363a266c":"plt.figure(figsize=(10,5))\ngraph=sns.barplot(x=\"Payment Method\",y=\"count\",data=paymethod)\ngraph.set_title(\"Payment Method\")\nplt.show()","4dbc4f86":"Table['Order Date']=pd.to_datetime(Table['Order Date'])\nTable['Year']=Table['Order Date'].dt.year\nOrderreceive=Table.groupby(\"Year\")['Order Number'].agg(['count']).reset_index().sort_values(by='count',ascending=False)\nprint(Orderreceive)","465fc1fe":"graph=sns.barplot(x='Year',y='count',data=Orderreceive,hue=\"Year\")\ngraph.set_title(\"Most Orders in a Year\")\nplt.show()","5eca005b":"Completeorder=Table[Table['Order Status']=='Completed']\nCompletedorder=Completeorder.groupby('City')['Order Number'].agg(['count']).reset_index().sort_values(by='count',ascending=False).head(10)\nprint(Completedorder)","894310b4":"plt.figure(figsize=(15,5))\ngraph=sns.barplot(x='City',y='count',data=Completedorder)\ngraph.set_title('Top 10 City Which Completed Order')\nplt.show()","38d320fc":"cancelorder=Table[Table['Order Status']=='Cancelled']\nCancelOrder=Table.groupby('City')['Order Number'].agg(['count']).reset_index().sort_values(by='count',ascending=False).head(10)\nprint(CancelOrder)","ce098b14":"plt.figure(figsize=(15,5))\ngraph=sns.barplot(x='City',y='count',data=CancelOrder)\ngraph.set_title(\"Top 10 Cities Which Cancelled Order\")\nplt.show()","f17b0b9d":"returnorder=Table[Table['Order Status']=='Returned']\nReturnOrder=returnorder.groupby('City')['Order Number'].agg(['count']).reset_index().sort_values(by='count',ascending=False).head(10)\nprint(ReturnOrder)","e36574be":"plt.figure(figsize=(18,5))\ngraph=sns.barplot(x='City',y='count',data=ReturnOrder)\ngraph.set_title('Top 10 Cities Which Returned Order ')\nplt.show()","8c2f0170":"# Top 10 Books Most Selling Books By Publisher ","d4571c03":"# Analyzation of Data of Order Status of Books\nHere analyse which top 10 cities Returned Order Status of Books","da512cf5":"# Data Munging of Book Name Column","7b9687d3":"# **First of all Read 3 Csv files**","b67e38d5":"#  Top 10 Cities Buy Most Books","58067dff":"# Analyzation of Data of Order Status of Books\nHere analyse which top 10 cities Cancelled Order Status of Books","36656911":"# Analyzation of Data of Order Status of Books\nHere analyse which top 10 cities complete Order Status of Books","f6fb67ac":"# Order Status Of a Books","32863702":"# Analyse Order data in the year","1f7a78c3":"# Check Null Value","8f4fda2e":"# Change the Name of Coulmn City(Billing) to City","8d6f335d":"# Payment Methods","0837b471":"# Now Join the 3rd Table using apppend() function","665100a3":"# **Now Join Table 1 and Table 2 using append() Function**","b8fa48f3":"# Here Data Munging of City Column","a4f862da":"# Top 10 least Selling Books"}}