{"cell_type":{"fc503049":"code","c229d6ab":"code","99dd523c":"code","a2a2558f":"code","7442e805":"code","4d017c5a":"code","3162c169":"code","1b7741b1":"code","6acd4918":"code","6f4ee9b1":"code","2536e9a2":"code","bead9908":"code","2b95435a":"code","93ecfce1":"code","b224611b":"code","8a5f6310":"code","6276c780":"code","1fa3420f":"code","dfa322da":"code","d4b37728":"code","0230a445":"markdown","e6196df4":"markdown","0fdb5cb4":"markdown","134f1720":"markdown","9e4da5f7":"markdown","2bbf2c93":"markdown","cde7ccb3":"markdown","1f549bf8":"markdown","8c40c387":"markdown","32cebf6a":"markdown","9f1f634f":"markdown","211b10f5":"markdown","27a42998":"markdown","818b53e3":"markdown","9c56574f":"markdown","8f911fdc":"markdown","80b70ce3":"markdown","06c35d83":"markdown","e1dd67d5":"markdown","b06e5f55":"markdown","68495603":"markdown","3d5dd7a8":"markdown"},"source":{"fc503049":"import numpy as np \nimport pandas as pd\nimport os\n\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import cross_val_score\nfrom tensorflow.keras.optimizers import Adam\n\nimport tensorflow as tf\nfrom tensorflow import keras\nfrom keras import layers\nfrom tensorflow.keras.layers import Dense, Input\nfrom keras.callbacks import ReduceLROnPlateau\nfrom tensorflow.keras.callbacks import EarlyStopping\nfrom tensorflow.keras.utils import to_categorical\n\nfrom tensorflow.keras.models import Model\nfrom tensorflow.keras.callbacks import ModelCheckpoint\n\n# XGBoost\nimport xgboost as xgb\nfrom xgboost import XGBClassifier\n\n# matplotlib and seaborn for plotting\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nimport optuna\n","c229d6ab":"df_train = pd.read_csv('\/kaggle\/input\/tabular-playground-series-may-2021\/train.csv', index_col='id')\ndf_test = pd.read_csv('\/kaggle\/input\/tabular-playground-series-may-2021\/test.csv', index_col='id')\nsample_submission = pd.read_csv('..\/input\/tabular-playground-series-may-2021\/sample_submission.csv')","99dd523c":"print(df_train.shape)\nprint(df_test.shape)","a2a2558f":"df_train.head()","7442e805":"print(df_train.info())","4d017c5a":"df_train.isnull().sum()","3162c169":"df_test.isnull().sum()","1b7741b1":"df_train.describe()","6acd4918":"df_test.describe()","6f4ee9b1":"df_train['target'].value_counts()","2536e9a2":"sns.barplot(df_train['target'].value_counts().index,df_train['target'].value_counts(),palette='rocket')","bead9908":"target = df_train['target']\ndf_train.drop(['target'], inplace=True, axis=1)","2b95435a":"label = {var:index for index, var in enumerate(sorted(target.unique()))}\ntarget = target.map(label)\n\ntarget =  to_categorical(target)\ntarget","93ecfce1":"#X_train, X_val, y_train, y_val = train_test_split(df_train, target, test_size = 0.1, random_state = 2, stratify=target)","b224611b":"learning_rate_reduction = ReduceLROnPlateau(monitor='val_categorical_accuracy', \n                                            patience=3, \n                                            verbose=1, \n                                            factor=0.5, \n                                            min_lr=0.00001)\n\n\nearly_stopping = EarlyStopping(\n    min_delta=0.001, # minimium amount of change to count as an improvement\n    patience=7, # how many epochs to wait before stopping\n    restore_best_weights=True,\n)","8a5f6310":"#  Neural Network\nnn = keras.Sequential([\n    layers.Dense(256, activation='relu', input_shape=[50]),\n    layers.Dropout(0.2),\n    layers.Dense(64, activation='relu'),\n    layers.Dropout(0.2),\n    layers.Dense(4,activation='softmax')\n])\n\nnn.summary()","6276c780":"nn.compile(loss='categorical_crossentropy',optimizer='adam',metrics=['categorical_accuracy'])\nhistory=nn.fit(\n    df_train,target,\n    validation_split=0.2,\n    batch_size=128,\n    epochs=25,\n    callbacks=[early_stopping,learning_rate_reduction]\n   )","1fa3420f":"# summarizing historical accuracy\nplt.plot(history.history['categorical_accuracy'])\nplt.plot(history.history['val_categorical_accuracy'])\nplt.title('Model Accuracy')\nplt.ylabel('Accuracy')\nplt.xlabel('Epoch')\nplt.legend(['train', 'test'], loc='upper left')\nplt.show()","dfa322da":"# summarize history for loss\nplt.plot(history.history['loss'])\nplt.plot(history.history['val_loss'])\nplt.title('model loss')\nplt.ylabel('loss')\nplt.xlabel('epoch')\nplt.legend(['train', 'test'], loc='upper left')\nplt.show()","d4b37728":"sample_submission[['Class_1','Class_2', 'Class_3', 'Class_4']] = nn.predict(df_test)\nsample_submission.to_csv(f'submission.csv',index=False)\nsample_submission","0230a445":"**Target column**\n\nLet's check target distribution and plot a bar chart:","e6196df4":"Define all the callbacks we will use in Neural Network fit step:\n* ReduceLROnPlateau\n        Reduce learning rate when a metric has stopped improving.\n\n* EarlyStopping\n        Stop training when a monitored metric has stopped improving.","0fdb5cb4":"<a id=\"section-six\"><\/a>\n# Building Models","134f1720":"<a id=\"section-four\"><\/a>\n# Preprocessing the data","9e4da5f7":"<a id=\"section-six-one\"><\/a>\n**Neural Network**","2bbf2c93":"<a id=\"section-two\"><\/a>\n# Load datasets","cde7ccb3":"Checking which all columns contain NaN values(is missing) in both the training and test datasets:-","1f549bf8":"Exploratory Data Analysis refers to the critical process of performing initial investigations on data so as to discover patterns,to spot anomalies,to test hypothesis and to check assumptions with the help of summary statistics and graphical representations.","8c40c387":"We have 50 features with int64 dataType (Counting starting from 0:feature_0)","32cebf6a":"<a id=\"section-nine\"><\/a>\n# Submission","9f1f634f":"To summarize:-\n* There is no missing data\n* No categorical feature","211b10f5":"See data set shape:-","27a42998":"XGB","818b53e3":"<a id=\"section-three\"><\/a>\n# Exploratory Data Analysis (EDA)","9c56574f":"Dropping target column from the dataset","8f911fdc":"> The dataset is used for this competition is synthetic, but based on a real dataset and generated using a CTGAN. The original dataset deals with predicting the category on an eCommerce product given various attributes about the listing. Although the features are anonymized, they have properties relating to real-world features.","80b70ce3":"Let's look at the statistical values for each feature.","06c35d83":"\n\n<a id=\"section-zero\"><\/a>\n\n# TABLE OF CONTENTS\n\n\n* [Library Importations](#section-one)\n* [Loading Datasets](#section-two)\n* [Exploratory Data Analysis](#section-three)\n* [Data Preprocessing](#section-four)\n* [Building Model](#section-six)\n    - [Neural Network](#subsection-six-five)\n* [Submission](#section-nine)","e1dd67d5":"We will use Keras to_categorical function to convert our target column into categorical values","b06e5f55":"loss: 1.0864 - categorical_accuracy: 0.5767 - val_loss: 1.1021 - val_categorical_accuracy: 0.5836","68495603":"See top 5 rows of the dataset:-","3d5dd7a8":"<a id=\"section-one\"><\/a>\n# Import all the required libraries"}}