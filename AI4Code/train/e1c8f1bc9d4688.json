{"cell_type":{"1e48db00":"code","b46477bc":"code","4e3b0820":"code","56d7343d":"code","1adfa5be":"code","b4c27ce5":"code","1d161520":"code","80f1dc22":"code","aaa8b583":"code","54838a7f":"code","f83e2240":"code","dc00c85e":"code","9c2ad8be":"code","8c5c2131":"code","c32a77aa":"code","067f679b":"code","a6cf0ebb":"code","b8288c78":"code","47744aaf":"code","4f0a4205":"code","2dff995b":"code","85a03a70":"code","610fed50":"code","a35e88b3":"code","883524f8":"code","14b5376d":"code","f5505892":"code","8d16859c":"code","4747efac":"code","e9046146":"code","e5af874d":"code","7c5399c3":"code","1e744cf8":"code","e7b80b8c":"code","141f3726":"code","e6a0ac84":"code","631354cd":"code","830975c9":"code","e1759c8c":"code","c02f2ec4":"markdown","aa5f80ab":"markdown","c25741f0":"markdown","2112bc02":"markdown","2a0e4186":"markdown","fc3a0e63":"markdown","3f73c979":"markdown","9fd08137":"markdown","226b41a7":"markdown","26148e1a":"markdown","9c6d91f3":"markdown","874a5738":"markdown","651c8b2f":"markdown","e2084c97":"markdown","5aed8532":"markdown","017d46ec":"markdown","8ac77eac":"markdown","0a53d91f":"markdown","dc9989e9":"markdown","691d283c":"markdown","c275ac9a":"markdown","a14477a3":"markdown"},"source":{"1e48db00":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","b46477bc":"df = pd.read_csv('\/kaggle\/input\/credit-card-customers\/BankChurners.csv')","4e3b0820":"df.head()","56d7343d":"df = df.drop(['Naive_Bayes_Classifier_Attrition_Flag_Card_Category_Contacts_Count_12_mon_Dependent_count_Education_Level_Months_Inactive_12_mon_2',\n             'Naive_Bayes_Classifier_Attrition_Flag_Card_Category_Contacts_Count_12_mon_Dependent_count_Education_Level_Months_Inactive_12_mon_1'], axis=1)","1adfa5be":"print(df.shape)\ndf.head()","b4c27ce5":"sns.set(rc={'figure.figsize':(15,7)})\nsns.barplot(x=\"Education_Level\", y=\"Total_Trans_Amt\", hue='Attrition_Flag', data=df)","1d161520":"sns.barplot(x=\"Card_Category\", y=\"Total_Trans_Amt\", hue='Attrition_Flag', data=df)","80f1dc22":"sns.barplot(x=\"Attrition_Flag\", y=\"Dependent_count\", data=df)","aaa8b583":"sns.barplot(x=\"Months_on_book\", y=\"Total_Trans_Amt\", hue='Attrition_Flag', data=df)","54838a7f":"sns.barplot(x=\"Marital_Status\", y=\"Total_Trans_Amt\", hue='Attrition_Flag', data=df)","f83e2240":"sns.set(rc={'figure.figsize':(25,6)})\nsns.barplot(x=\"Customer_Age\", y=\"Total_Trans_Amt\", hue='Attrition_Flag', data=df, palette=[\"C0\", \"C1\", \"k\"])","dc00c85e":"df = df.drop(['CLIENTNUM', 'Dependent_count', 'Education_Level', 'Marital_Status', 'Months_on_book'], axis=1)\ndf.head()","9c2ad8be":"sns.set(rc={'figure.figsize':(5,5)})\nsns.barplot(x=\"Attrition_Flag\", y=\"Months_Inactive_12_mon\", hue='Gender', data=df)","8c5c2131":"sns.barplot(x=\"Attrition_Flag\", y=\"Total_Relationship_Count\", data=df)","c32a77aa":"sns.barplot(x=\"Attrition_Flag\", y=\"Contacts_Count_12_mon\", data=df)","067f679b":"sns.barplot(x=\"Attrition_Flag\", y=\"Total_Revolving_Bal\", data=df)","a6cf0ebb":"sns.barplot(x=\"Attrition_Flag\", y=\"Credit_Limit\", data=df)","b8288c78":"sns.barplot(x=\"Attrition_Flag\", y=\"Avg_Open_To_Buy\", data=df)","47744aaf":"sns.barplot(x=\"Attrition_Flag\", y=\"Total_Amt_Chng_Q4_Q1\", data=df)","4f0a4205":"sns.barplot(x=\"Attrition_Flag\", y=\"Total_Trans_Amt\", hue='Income_Category', data=df)","2dff995b":"sns.barplot(x=\"Attrition_Flag\", y=\"Total_Trans_Ct\", data=df)","85a03a70":"sns.barplot(x=\"Attrition_Flag\", y=\"Avg_Utilization_Ratio\", data=df)","610fed50":"df = df.drop(['Gender', 'Income_Category', 'Credit_Limit', 'Avg_Open_To_Buy', 'Total_Ct_Chng_Q4_Q1'], axis=1)","a35e88b3":"df.head()","883524f8":"customer = pd.get_dummies(df['Attrition_Flag'], drop_first=True)\ncard = pd.get_dummies(df['Card_Category'], drop_first=False)","14b5376d":"df = pd.concat([df, customer, card], axis=1)\ndf = df.drop(['Attrition_Flag', 'Card_Category'], axis=1)","f5505892":"df.head()","8d16859c":"from sklearn.model_selection import train_test_split\nfrom sklearn.metrics import classification_report","4747efac":"x = df.drop(['Existing Customer'], axis=1)\ny = df['Existing Customer']","e9046146":"x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.25, random_state=42)","e5af874d":"from sklearn.linear_model import LogisticRegression\nlogistic = LogisticRegression()\nlogistic.fit(x_train, y_train)\nprediction_lr = logistic.predict(x_test)\nprint(classification_report(y_test,prediction_lr))","7c5399c3":"from sklearn.tree import DecisionTreeClassifier\ntree = DecisionTreeClassifier()\ntree.fit(x_train, y_train)\nprediction_dt = tree.predict(x_test)\nprint(classification_report(y_test, prediction_dt))","1e744cf8":"from sklearn.ensemble import RandomForestClassifier\nforest = RandomForestClassifier()\nforest.fit(x_train, y_train)\nprediction_rf = forest.predict(x_test)\nprint(classification_report(y_test, prediction_rf))","e7b80b8c":"import xgboost\nxgb = xgboost.XGBClassifier()\nxgb.fit(x_train,y_train)\nprediction_xgb = xgb.predict(x_test)\nprint(classification_report(y_test, prediction_xgb))","141f3726":"df.shape","e6a0ac84":"import keras\nfrom keras.layers import Dense\nfrom keras.models import Sequential\nfrom keras.layers import Dropout","631354cd":"model = Sequential([\n    Dense(32, activation='relu', input_dim=13),\n    Dropout(0.5),\n    Dense(32, activation='relu'),\n    Dense(1, activation='sigmoid')\n])\nmodel.compile(optimizer='adam', loss='mean_squared_error', metrics=['accuracy'])\nmodel.summary()","830975c9":"model.fit(x_train, y_train, batch_size=32, epochs=50,verbose=0)","e1759c8c":"prediction_nn = model.predict(x_test)\nprediction_nn = [1 if y>=0.5 else 0 for y in prediction_nn]\nprint(classification_report(y_test, prediction_nn))","c02f2ec4":"**RANDOM FOREST CLASSIFIER**","aa5f80ab":"**Now, we are ready.**","c25741f0":"I divided my analysis because there are many columns on the data. Now, we can continue.","2112bc02":"Before we start with anything, I want to see if I can drop any of the columns that are unnecessary. I will look at how some columns effected the important ones. For me some of the important columns are: *Income, Credit Limit, Amount of change between Q1 and Q4 and Total transaction amount etc.*","2a0e4186":"I have used ***regression, random forest, decision tree and neural network*** approaches with this dataset. I was able to achieve ***%96 accuracy*** with xgboost which is pretty good. Overall, every model performed good but some of them were more suitable for this problem.","fc3a0e63":"**LOGISTIC REGRESSION**","3f73c979":"Every variable except *Attrition Flag* and *Card Category* are numeric. We need to turn non-numeric categories to numeric categories before the process.","9fd08137":"Let see how our data will look after we drop these columns.","226b41a7":"**In this notebook, I tried to analyze the dataset with the help of seaborn to reduce the amount of work my models have to do. Then applied Machine Learning and Deep Learning methods to it. Let's see how it shaped out.**","26148e1a":"We can say that newly members spend more money. But membership length does not effect the churn. I mean it is inconsistent within the length of the membership.","9c6d91f3":"We had very succesful results with Decision Tree, Random Forest and XGBOOST, up to **%96 accuracy**. I want to try Neural Networks just for the fun of it.","874a5738":"Here we see that *Education Level* did not effected *Credit Limit* and *Attrition.*","651c8b2f":"**We have come to an end to our notebook. Thank you for sticking with me this far! I hope it was a good experience for you.**","e2084c97":"<img src=\"https:\/\/media.giphy.com\/media\/3ov9jWgOYIJ9k5Elyw\/giphy.gif\">","5aed8532":"There is an slight difference within the groups but since we have enough variables, *dependent count* is droppable.","017d46ec":"**DNN**","8ac77eac":"**DECISION TREE CLASSIFIER**","0a53d91f":"So far we are dropping: *Client number, Dependent count, Education level, Marital status and Month on book*. Because they did not effected the attrition. In addition, obviously Client number is not important for us, either.","dc9989e9":"**XGBOOST**","691d283c":"<img src=\"https:\/\/media.giphy.com\/media\/xUPOqo6E1XvWXwlCyQ\/giphy.gif\">","c275ac9a":"# **Who is going to leave the bank?**","a14477a3":"*Number of inactive months, total relationship count, contact count, revolving balance, amount of change between quarters, transaction amount&count and average utilization ratio* are valuable information for this problem. The rest, we can drop."}}