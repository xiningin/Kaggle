{"cell_type":{"f826a18d":"code","2480e735":"code","26abed5e":"code","c148ccad":"code","8712fb4b":"markdown","0d63e063":"markdown","3d2c9a61":"markdown"},"source":{"f826a18d":"import matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\nimport imageio\n\nfrom scipy import ndimage\nfrom pathlib import Path\n\nim_dir = Path('..\/input\/train\/')\n\ndf_pred = pd.read_csv('..\/input\/train.csv', index_col=[0])\ndf_pred.fillna('', inplace=True)\ndf_pred['suspicious'] = False\n\nfor index, row in df_pred.iterrows():\n    encoded_mask = row['rle_mask'].split(' ')\n    if len(encoded_mask) > 1 and len(encoded_mask) < 5 and int(encoded_mask[1]) % 101 == 0:\n        df_pred.loc[index,'suspicious'] = True\n\ndef show_plot(rows):\n    idx_images = 0\n    max_images = 60\n    grid_width = 15\n    grid_height = int(max_images \/ grid_width)\n\n    fig, axs = plt.subplots(grid_height, grid_width, figsize=(grid_width, grid_height))\n\n    for index, row in rows.iterrows():\n        im_path = im_dir \/ 'images' \/ '{}.png'.format(index)\n        img = imageio.imread(im_path.as_posix())\n\n        im_path = im_dir \/ 'masks' \/ '{}.png'.format(index)\n        mask = imageio.imread(im_path.as_posix())\n\n        ax = axs[int(idx_images \/ grid_width), idx_images % grid_width]\n        ax.imshow(img, cmap=\"Greys\")\n        ax.imshow(mask, alpha=0.45, cmap=\"Greens\")\n\n        ax.text(1, 1, np.count_nonzero(mask), color=\"black\", ha=\"left\", va=\"top\")\n        ax.set_yticklabels([])\n        ax.set_xticklabels([])\n\n        idx_images = idx_images + 1\n\n        if idx_images > 59:\n            break\n\n    plt.suptitle(\"Grey: training image, Green: training mask, Top-left: # of pixels\")","2480e735":"show_plot(df_pred[df_pred['suspicious'] == False])","26abed5e":"show_plot(df_pred[df_pred['suspicious'] == True])","c148ccad":"ok = len(df_pred[df_pred['suspicious'] == False])\nfake = len(df_pred[df_pred['suspicious'] == True])\n\nprint(\"There are {} suspicious masks ({:.2f}%) in the training set!\".format(fake, fake\/(ok + fake) * 100))","8712fb4b":"## Weird masks","0d63e063":"## Correct mask examples","3d2c9a61":"#### There are some \"interesting\" masks in the training set. What do you think, should we remove these images from the training set?"}}