{"cell_type":{"2ed046eb":"code","894a71f8":"code","9d3a68cb":"code","2a3c2f13":"code","80ab2102":"code","73b0cbb7":"code","324d0339":"markdown","d631d52c":"markdown","79659cce":"markdown","8cfa6510":"markdown","e05d07ef":"markdown","df91ca52":"markdown"},"source":{"2ed046eb":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv\nimport matplotlib as plt\nimport plotly.figure_factory as ff\nimport plotly.express as px","894a71f8":"# 0.81826 - Stacking from https:\/\/www.kaggle.com\/vishwas21\/tps-sep-21-3-level-custom-stacking\nstacking_sub = pd.read_csv('..\/input\/tps-sep-21-3-level-custom-stacking\/submission.csv')\n# 0.81789 - Catboost from https:\/\/www.kaggle.com\/jonigooner\/catboost-classifier\ncb_sub = pd.read_csv('..\/input\/catboost-classifier\/catboost_classifier.csv')\n# 0.81814 - LGBM from https:\/\/www.kaggle.com\/realtimshady\/single-simple-lightgbm\nlgbm_sub = pd.read_csv('..\/input\/single-simple-lightgbm\/submission.csv')","9d3a68cb":"hist_data = [stacking_sub.claim, cb_sub.claim, lgbm_sub.claim]\ngroup_labels = ['stacking', 'catboost', 'lgbm']\nfig = ff.create_distplot(hist_data, group_labels, bin_size=0.3, show_hist=False, show_rug=False)\nfig.show()","2a3c2f13":"# High correlation between all models ~0.998+\ndata = np.corrcoef([stacking_sub.claim, cb_sub.claim, lgbm_sub.claim])\nfig=px.imshow(data,x=group_labels, y=group_labels)\n\nfig.show()","80ab2102":"# Power is arbitrary - refer to blog post for more info to get a better power\nensemble = stacking_sub.copy()\nensemble.loc[:,'claim'] = (stacking_sub**4 + cb_sub**4 + lgbm_sub**4)\/3","73b0cbb7":"ensemble.to_csv('submission.csv', index=False)","324d0339":"## Check for correlations","d631d52c":"## Submission file","79659cce":"## Power Averaging - TPS September 2021","8cfa6510":"## Read in submission files","e05d07ef":"# Import Libraries","df91ca52":"Power Averaging is a form of ensembling to optimize for the AUC metric, being used in TPS Sept.\n\nIt works best on highly correlated models, which are in abundance in this competition.\n\nThe formula is **Final Submission = (Submission1^Power + Submission2^Power + Submission3^Power + Submission4^Power) \/ 4**\n\nHere's a detailed post on it - https:\/\/medium.com\/data-design\/reaching-the-depths-of-power-geometric-ensembling-when-targeting-the-auc-metric-2f356ea3250e"}}