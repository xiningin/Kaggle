{"cell_type":{"529e1d5f":"code","343a341f":"code","5684a2f1":"code","b8cf3d62":"code","8879533c":"code","4c0a4986":"code","550a74b1":"code","df291144":"code","ef062a4a":"code","32b17ed9":"code","93fdbda3":"code","8c1d83e9":"code","7ada8404":"code","b3134506":"code","00b0026c":"code","18f890ee":"code","ee193f52":"markdown"},"source":{"529e1d5f":"!pip install pytorchcv","343a341f":"!pip install fastai==1.0.47","5684a2f1":"import time\nstart = time.time()","b8cf3d62":"import numpy as np \nimport pandas as pd \nfrom pytorchcv.model_provider import get_model as ptcv_get_model","8879533c":"from pathlib import Path\nfrom fastai import *\nfrom fastai.vision import *\nimport torch","4c0a4986":"data_folder = Path(\"..\/input\")\n#data_folder.ls()","550a74b1":"train_df = pd.read_csv(\"..\/input\/train.csv\")\ntest_df = pd.read_csv(\"..\/input\/sample_submission.csv\")","df291144":"test_img = ImageList.from_df(test_df, path=data_folder\/'test', folder='test')\ntrfm = get_transforms(do_flip=True, flip_vert=True, max_rotate=10.0, max_zoom=1.1, max_lighting=0.2, max_warp=0.2, p_affine=0.75, p_lighting=0.75)\ntrain_img = (ImageList.from_df(train_df, path=data_folder\/'train', folder='train')\n        .split_by_rand_pct(0.01)\n        .label_from_df()\n        .add_test(test_img)\n        .transform(trfm, size=128)\n        .databunch(path='.', bs=64, device= torch.device('cuda:0'))\n        .normalize(imagenet_stats)\n       )","ef062a4a":"def md(f=None):\n    mdl = ptcv_get_model('condensenet74_c4_g4', pretrained=True)\n    mdl.features.final_pool = nn.AvgPool2d(kernel_size=7, stride=1, padding=3)\n    return mdl","32b17ed9":"learn = cnn_learner(train_img, md, metrics=[error_rate, accuracy])","93fdbda3":"#learn.lr_find()\n#learn.recorder.plot()","8c1d83e9":"lr = 3.5e-02\nlearn.fit_one_cycle(5, slice(lr))","7ada8404":"preds,_ = learn.get_preds(ds_type=DatasetType.Test)","b3134506":"test_df.has_cactus = preds.numpy()[:, 0]","00b0026c":"test_df.to_csv('submission.csv', index=False)","18f890ee":"end = time.time() \nprint(end - start)","ee193f52":"forked from https:\/\/www.kaggle.com\/kenseitrg\/simple-fastai-exercise"}}