{"cell_type":{"65c9dc69":"code","aa96a12d":"code","6c990459":"code","c9326ac3":"code","0a454071":"code","9a807ff8":"code","d4c9dde9":"code","09e79d47":"code","4731b123":"code","1b4b0cc6":"code","1b9448c6":"code","197bff1c":"code","40b8cc16":"code","bfb95efd":"code","97a0fa77":"code","78b4999e":"code","5c0b00d9":"code","44454d3c":"code","02d94a62":"code","1f2c0b31":"code","aefe72d3":"code","40968c44":"code","1f7dd7e6":"code","bc2953b3":"code","bbe62176":"code","c33fe9da":"code","63e22d93":"code","ed60dbe8":"code","f7547be2":"code","7308ebbd":"code","912a5785":"code","30908e7a":"code","d53d0c54":"code","0ab37b69":"code","c509cb35":"code","5bd7d407":"code","a442dcee":"code","2a7406e4":"code","481f1bb6":"code","a8efced5":"code","b315285e":"code","06fd8271":"code","98403de0":"code","a9087c6f":"code","2987552e":"code","1ee773ec":"code","bc142554":"code","762a91ad":"code","17ea7632":"markdown","e34a26cb":"markdown","9ee4d5fe":"markdown","38148ff7":"markdown","9a15cb6a":"markdown","9634938b":"markdown","3e939c07":"markdown","3938ee99":"markdown","cd1fd462":"markdown","59579cf1":"markdown","99945fd1":"markdown","219905b5":"markdown","2c355abe":"markdown","63787491":"markdown","6127b005":"markdown"},"source":{"65c9dc69":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport os\nimport scipy as sp\nimport string\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n%matplotlib inline\n\n\n","aa96a12d":"data=pd.read_csv(\"..\/input\/fake-news-classifier-data\/test.csv\")\n","6c990459":"data","c9326ac3":"data.head()","0a454071":"data.info()","9a807ff8":"data.describe()","d4c9dde9":"data.value_counts","09e79d47":"data.dtypes","4731b123":"data.shape","1b4b0cc6":"data.columns","1b9448c6":"data.isnull().sum()","197bff1c":"data.isnull().any()","40b8cc16":"###Drop Nan Values\ndata=data.dropna()\n","bfb95efd":"data.isnull().sum()","97a0fa77":"## Get the Independent Features\n\nX=data.drop('id',axis=1)\n","78b4999e":"y=data['id']\n","5c0b00d9":"y.value_counts()\n","44454d3c":"X.shape","02d94a62":"y.shape","1f2c0b31":"plt.style.use(\"default\")\nsns.barplot(x=\"id\", y=\"title\",data=data[180:190])\nplt.title(\"ID vs TITLE\",fontsize=15)\nplt.xlabel(\"ID\")\nplt.ylabel(\"TITLE\")\nplt.show()\n\n\n","aefe72d3":"data.columns","40968c44":"sns.set_palette(\"Paired\")\nsns.pairplot(data,hue='text',height=5,palette='colorblind')\nplt.show()\n","1f7dd7e6":"plt.figure(figsize=(14,10))\nsns.set_style(style='whitegrid')\nplt.subplot(2,3,1)\nsns.boxplot(x='id',data=data)\n\n","bc2953b3":"sns.pairplot(data=data)","bbe62176":"import tensorflow as tf\n","c33fe9da":"from tensorflow.keras.layers import Embedding\nfrom tensorflow.keras.preprocessing.sequence import pad_sequences\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.preprocessing.text import one_hot\nfrom tensorflow.keras.layers import LSTM\nfrom tensorflow.keras.layers import Dense\n\n","63e22d93":"### Vocabulary size\nvoc_size=5000\n","ed60dbe8":"messages=X.copy()\n","f7547be2":"messages.reset_index(inplace=True)\n\n","7308ebbd":"import nltk\nimport re\nfrom nltk.corpus import stopwords","912a5785":"nltk.download('stopwords')\n","30908e7a":"### Dataset Preprocessing\nfrom nltk.stem.porter import PorterStemmer\nps = PorterStemmer()\ncorpus = []\nfor i in range(0, len(messages)):\n    print(i)\n    review = re.sub('[^a-zA-Z]', ' ', messages['title'][i])\n    review = review.lower()\n    review = review.split()\n    \n    review = [ps.stem(word) for word in review if not word in stopwords.words('english')]\n    review = ' '.join(review)\n    corpus.append(review)\n","d53d0c54":"corpus","0ab37b69":"onehot_repr=[one_hot(words,voc_size)for words in corpus] \nonehot_repr","c509cb35":"sent_length=20\nembedded_docs=pad_sequences(onehot_repr,padding='pre',maxlen=sent_length)\nprint(embedded_docs)\n","5bd7d407":"embedded_docs[0]\n","a442dcee":"## Creating model\nembedding_vector_features=40\nmodel=Sequential()\nmodel.add(Embedding(voc_size,embedding_vector_features,input_length=sent_length))\nmodel.add(LSTM(100))\nmodel.add(Dense(1,activation='sigmoid'))\nmodel.compile(loss='mae',optimizer='adam',metrics=['accuracy'])\n\n","2a7406e4":"model.summary()","481f1bb6":"import numpy as np\nX_final=np.array(embedded_docs)\ny_final=np.array(y)\n","a8efced5":"X_final.shape,y_final.shape","b315285e":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X_final, y_final, test_size=0.3, random_state=42)\n","06fd8271":"model.fit(X_train,y_train,validation_data=(X_test,y_test),epochs=50,batch_size=256)\n","98403de0":"from tensorflow.keras.layers import Dropout\n## Creating model\nembedding_vector_features=40\nmodel=Sequential()\nmodel.add(Embedding(voc_size,embedding_vector_features,input_length=sent_length))\nmodel.add(Dropout(0.3))\nmodel.add(LSTM(100))\nmodel.add(Dropout(0.3))\nmodel.add(Dense(1,activation='sigmoid'))\nmodel.compile(loss='mae',optimizer='adam',metrics=['accuracy'])","a9087c6f":"y_pred=model.predict(X_test)\n","2987552e":"y_pred","1ee773ec":"print((y_pred > 0.5))\n","bc142554":"from tensorflow.keras.utils import plot_model\nplot_model(model, show_shapes = True)\n","762a91ad":"model.summary()","17ea7632":"# IMPORTING THE LIBRARIES","e34a26cb":"**MODEL CREATION**","9ee4d5fe":"# **Exploratory Data Analysis**","38148ff7":"***So we have to drop the null values .***","9a15cb6a":"# FAKE NEWS CLASSIFIER ","9634938b":"# **Checking Null Values**","3e939c07":"**NLTK**","3938ee99":"**Types of Optimizers:**\n\n**1) Gradient Descent (GD)**\n\n**2) Stochastic Gradient Descent**\n\n**3) Mini-Batch Gradient Descent**\n\n**4) Adagrad**\n\n**5) RMSProp**\n\n\n\n","cd1fd462":"**Stemming and Lemmatization are Text Normalization (or sometimes called Word Normalization) techniques in the field of Natural Language Processing that are used to prepare text, words, and documents for further processing.**","59579cf1":"**Types of Loss Functions:**\n\n**1) Mean Squared Error**\n\n**2) Regression Loss Function**\n\n**3) Mean Absolute Error Loss**\n\n**4) Binary Classification Loss Function**\n\n**5) Binary Cross Entropy Loss**\n","99945fd1":"**With Dense we can also use Dropout and Batch Normalization**","219905b5":"# LOADING THE DATASET","2c355abe":"**Types of Activation Functions:**\n\n**1) Relu**\n\n**2) Sigmoid**\n\n**3) Threshold**\n\n**4) Hyperbolic Tangent**","63787491":"**LSTM**","6127b005":"***So now we can see all the null values have been dropped .***"}}