{"cell_type":{"ecff0329":"code","eef12633":"code","32eb2756":"code","03da7ea1":"code","7df1006d":"code","8e13a950":"code","2f7cf0b0":"code","709439d2":"code","7159a79d":"code","1c958f61":"code","37336e3e":"code","39b3b374":"code","72c7b141":"code","639b7f7c":"code","ee4ee8fd":"code","452262bd":"code","3b50a4d6":"code","b423a658":"code","7276b2f9":"code","b1d3fc4d":"code","313dc840":"code","d861491b":"code","da9173f7":"code","c7d7869d":"code","98c64f50":"code","158be91e":"markdown","8ec5583f":"markdown","da2cf401":"markdown","49f8a076":"markdown","3c545ea9":"markdown","f62bf2b4":"markdown","15561743":"markdown","d5dbf572":"markdown","c8c82bcb":"markdown","a6e45cd9":"markdown","6aa58a4b":"markdown","c2499b59":"markdown","4f386a1f":"markdown","be9e6bf0":"markdown"},"source":{"ecff0329":"import os\nimport json\nimport cv2\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline","eef12633":"df_data = pd.read_csv('..\/input\/plant-pathology-2021-fgvc8\/train.csv')","32eb2756":"df_data.head(1)","03da7ea1":"# removing .jpg from images and storing id in seperate column\ndf_data['image_id'] = df_data['image'].map(lambda x: x.rstrip('.jpg'))\ndf_data.head(1)","7df1006d":"# checking for missing values in new column\ndf_data['image_id'].isnull().unique()","8e13a950":"# creating a column of file location\ndf_data['file_path'] = \"..\/input\/plant-pathology-2021-fgvc8\/train_images\/\"+df_data['image']\ndf_data.head(1)","2f7cf0b0":"# removing unwanted columns\ndf_data = df_data.drop(['image'], axis=1)\n# changing order of column\ndf_data = df_data[['image_id','labels','file_path']]\ndf_data.head(1)","709439d2":"#removing null values\ndf_data = df_data.dropna(how = 'all')\n# cheking for missing data \ndf_data.isnull().sum()","7159a79d":"df_data.shape","1c958f61":"df_data.describe()","37336e3e":"df_data.info()","39b3b374":"len(df_data['labels'].unique())","72c7b141":"df_data['labels'].unique()","639b7f7c":"#Number of images in each label\nplt.figure(figsize=(15, 10))\ndf_data['labels'].value_counts().plot.bar()","ee4ee8fd":"plt.figure(figsize=(15, 15))\ndf_data['labels'].value_counts().plot.pie(autopct='%.2f')","452262bd":"# list of labels\nn = df_data['labels'].unique().tolist()\n# finding number of images in each label\nnumber=[]\nfor i in range(len(n)):\n    number.append(len(df_data.loc[df_data['labels']==n[i]]))\n    \n# creating a dataset with labels and number of images in them    \ntable =pd.DataFrame(df_data['labels'].unique(),columns =['labels'])\ntable['Number_of_images_in_label'] = number\ntable = table.sort_values(by=['Number_of_images_in_label'], ascending=False)\nprint(table.to_markdown())","3b50a4d6":"# plotting image by image id for single image\ndef  visualize(image_id):\n    \n    path = df_data.loc[df_data['image_id'] == image_id, 'file_path'].iloc[0]\n    label = df_data.loc[df_data['image_id'] == image_id, 'labels'].iloc[0]\n    \n    plt.figure(figsize=(10, 10))\n    image = cv2.imread(path)\n    image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)\n    plt.imshow(image)\n    plt.title(f\"Label: {label}\", fontsize=10,)\n    plt.show()","b423a658":"visualize('800113bb65efe69e')","7276b2f9":"#plot image by label . plot 15 random images from label\ndef visualize_label(label):\n    \n     \n    df = df_data.loc[df_data['labels'] == label]\n    \n    x = np.random.choice(df['image_id'], 15, replace=False).tolist()\n    plt.figure(figsize=(18, 18))\n    for i, j in zip(x, range(15)):       \n            plt.subplot(3, 5, j + 1)\n            path = df.loc[df['image_id'] == i, 'file_path'].iloc[0]\n            image = cv2.imread(path)\n            image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)\n            plt.imshow(image)\n           \n            labels = df.loc[df['image_id'] == i, 'labels'].iloc[0]\n            imageid= df.loc[df['image_id'] == i, 'image_id'].iloc[0]\n            plt.title(f\" Label: {labels}\\n Image_id:{imageid}\", fontsize=9,)\n            plt.axis(\"off\")\n            #plt.savefig('saved_figure.png')\n    \n    plt.show()                \n","b1d3fc4d":"visualize_label('healthy')","313dc840":"visualize_label('scab')","d861491b":"visualize_label('complex')","da9173f7":"visualize_label('rust')","c7d7869d":"visualize_label('frog_eye_leaf_spot')","98c64f50":"visualize_label('powdery_mildew')","158be91e":"### EDA","8ec5583f":"# Visualize","da2cf401":"### Cleaning data\n\nAs we can see there is two columns in the dataset. One named images and other named labels. Images give the image id and labels give the diseases in the leaf. Lets make a new colum for image id and path of image.","49f8a076":"# Loading data","3c545ea9":"#### Complex","f62bf2b4":"From the plot we can see that most of the images are concentrated in the five individual diseases labels. Labels with multiple diseases have asmall dataset. This might skew the detection matrix.","15561743":"#### Powdery_mildew","d5dbf572":"#### Rust","c8c82bcb":"#### Frog_eye_leaf_spot","a6e45cd9":"There are total of 18632 images given and a total of 12 diseases labels given. On further inspection we see that there are five individual diseases namely \n- frog_eye_leaf_spot \n- complex\n- rust\n- scab\n- powdery_mildew\n\nOther six labels are the combination of two or more of these diseases. The remining one label is healthy leaf without any diseases","6aa58a4b":"#### Healthy leaf","c2499b59":"#### Creating test dataset","4f386a1f":"# Loading libraries","be9e6bf0":"#### Scab"}}