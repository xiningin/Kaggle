{"cell_type":{"3a1e56cf":"code","56277e6f":"code","c28f1e0f":"code","4f0c8876":"code","cba77979":"code","c70f13a2":"code","1fa9b53b":"code","d6d0db6c":"code","94febf20":"code","fb521f49":"code","411bf738":"code","28f149ef":"code","ea3b3218":"code","31eb6082":"code","4172778f":"code","9d7f8741":"code","661dde00":"code","e2d7555f":"markdown","2d9d603a":"markdown","a823b1d0":"markdown","bf223bb1":"markdown","62aaeeca":"markdown","fefa569f":"markdown","09772782":"markdown","fe769846":"markdown","0e3720e0":"markdown","0854f4f2":"markdown","e7e3a0e8":"markdown","a1863034":"markdown","b4130d3c":"markdown","d790be78":"markdown","82aa6c44":"markdown","742d1a83":"markdown","b1fab47e":"markdown","10bc8171":"markdown","04ee0ec5":"markdown","b0087ea6":"markdown"},"source":{"3a1e56cf":"# import libraries\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nfrom scipy.stats import norm\nimport matplotlib.pyplot as plt\nimport numpy.polynomial.polynomial as poly\n\n_data_set = pd.DataFrame(pd.read_csv('..\/input\/surface-solar-radiation-dataset\/New folder\/DGSR_Data.csv'))","56277e6f":"# helpful functions\n\ndef add_mean_to_data(dataset, group_by):\n    return dataset.groupby([group_by]).agg(Mean=('Estimated DGSR', 'mean')).reset_index()\n\ndef mult_degree(x, y, deg, data_label, col, numm=None):\n    \n    if numm == None:\n        numm = 500\n\n    x = np.array(x)\n    coeff = poly.polyfit(x, y, deg)\n    x_new = np.linspace(x.min(), x.max(), numm)\n    ffit = poly.polyval(x_new, coeff)\n    plt.plot(x_new, ffit, label=data_label, color=col)\n    plt.legend(loc='best')\n    \n    return ffit\n\ndef get_monthly_data(dataset, month):\n    _temp = pd.DataFrame(dataset[dataset['Month'] == month]['Estimated DGSR'].reset_index(drop=True))\n    _temp.columns = ['e_dgsr_%s' %(month)]\n    return _temp\n\ndef get_norm(x, data):\n    return norm.pdf(x, data.mean(), data.std())","c28f1e0f":"print(_data_set.info())\n\nnum_of_entries = _data_set.count()[0]\ndivisibility = round(round(_data_set.count()[0]\/365, 4) - np.floor(_data_set.count()[0]\/365), 4)\n\nprint('The total number of records is {}, the divisibility to full year is {}'.format(\n    num_of_entries, divisibility))","4f0c8876":"_data_set.isnull().sum(axis = 0)","cba77979":"year_list = np.unique(np.array(_data_set['Year']))\n__year_list = {}\nfor i in year_list:\n    __year_list.update({i: len(np.where(np.array(_data_set['Year']) == i)[0])})\n    \nmonth_list = np.unique(np.array(_data_set['Month']))\n__month_list = {}\nfor i in month_list:\n    __month_list.update({i: len(np.where(np.array(_data_set['Month'] == i)[0]))})\n    \nday_list = np.unique(np.array(_data_set['Day']))\n__day_list = {}\nfor i in day_list:\n    __day_list.update({i: len(np.where(np.array(_data_set['Day'] == i)[0]))})","c70f13a2":"print(__year_list)\nprint(__month_list)\nprint(__day_list)","1fa9b53b":"data_set = _data_set[(_data_set['Year'] >= 1990) & (_data_set['Year'] <= 2019)]","d6d0db6c":"data_set['Estimated DGSR'].describe(percentiles=[0.1, 0.25, 0.5, 0.75, 0.99]).T","94febf20":"# distribution of DGSR value and checking for potential outliers\n\nplt.figure(figsize=(8,6))\n\nplt.subplot(211)\ndata_set['Estimated DGSR'].plot.hist(bins=14, ec='k', fc='w')\nlims = plt.gca().get_xlim()\nplt.xlabel('Estimated DGSR')\nplt.ylabel('Count')\nplt.twinx()\n_ = data_set['Estimated DGSR'].plot(kind='kde')\nplt.title('Distribuiton of Estimated DGSR')\nplt.xlim(lims)\n\nplt.subplot(212)\ndata_set['Estimated DGSR'].plot.box(vert=False)\nplt.grid('on')\nplt.tight_layout()","fb521f49":"# yearly boxplot for DGSR\n_ = pd.plotting.boxplot(data_set.drop(['Month', 'Day'], axis=1), by='Year', figsize=(16,5))","411bf738":"# monthly boxplot for DGSR\n_ = pd.plotting.boxplot(data_set.drop(['Year', 'Day'], axis=1), by='Month', figsize=(16,5))","28f149ef":"# daily boxplot for DGSR\n_ = pd.plotting.boxplot(data_set.drop(['Month', 'Year'], axis=1), by='Day', figsize=(16,5))","ea3b3218":"# yearly mean\n\ngby_year = add_mean_to_data(data_set, 'Year')\n\n\n_ = gby_year.plot.scatter('Year', 'Mean', label='Yearly mean [Estimated DGSR]', figsize=(15, 4), grid='on')\n\n#mult_degree(gby_year.Year, gby_year.Mean, 6, 'A', 'r')","31eb6082":"# monthly mean\ngby_month = add_mean_to_data(data_set, 'Month')\n\n_ = gby_month.plot.scatter('Month', 'Mean', label='Monthly mean [Estimated DGSR]', figsize=(15, 4), grid='on')\n_ = plt.legend(loc='upper center')\n\nx, y = gby_month.Month, gby_month.Mean\n\nt = mult_degree(x, y, 2, '2nd order polynomial', 'r')","4172778f":"# Estimate the value for June\nx_new = np.linspace(x.min(), x.max(), 500)\nprint('The number of data points are {} and the number of fitted points are {}.'.format(len(x_new), len(t)))\n\nmean_value_for_june = t[np.where(x_new >= 6)[0][0]]\nprint('The mean Estimated DGSR value for the month of June is {}.'.format(round(mean_value_for_june, 2)))","9d7f8741":"# daily mean\ngby_day = add_mean_to_data(data_set, 'Day')\n\n_ = gby_day.plot.scatter('Day', 'Mean', label='Daily mean [Estimated DGSR]', figsize=(15, 4), grid='on')\n\n# just for fun, let's try and fit the daily mean data using polynomials\n\nx, y = gby_day.Day, gby_day.Mean\n\n_ = mult_degree(x, y, 8, '8th order poly_fit', 'r')\n_ = mult_degree(x, y, 10, '10th order poly_fit', 'g')\n_ = mult_degree(x, y, 12, '12th order poly_fit', 'b')\n_ = mult_degree(x, y, 14, '14th order poly_fit', 'm')\n_ = mult_degree(x, y, 18, '18th order poly_fit', 'orange')","661dde00":"apr, may, jul = get_monthly_data(data_set, 4), get_monthly_data(data_set, 5), get_monthly_data(data_set, 7)\naug, nov, dec = get_monthly_data(data_set, 8), get_monthly_data(data_set, 11), get_monthly_data(data_set, 12)\n\nx = np.linspace(1, 20, 50)\n\ny_apr, y_may, y_jul = get_norm(x, apr), get_norm(x, may), get_norm(x, jul)\ny_aug, y_nov, y_dec = get_norm(x, aug), get_norm(x, nov), get_norm(x, dec)\n\nlabels = ['apr', 'may', 'jul', 'aug', 'nov', 'dec']\nto_plot = [y_apr, y_may, y_jul, y_aug, y_nov, y_dec]\n\nplt.figure(figsize=(10, 6))\nplt.suptitle('scipy.norm.pdf distributions of months with outliers')\n\nfor i in list(range(0, 6)):\n    plt.subplot(int(str('23%s' %(i+1))))\n    plt.plot(x, to_plot[i], label=labels[i])\n    plt.legend(loc='best')\n    plt.tight_layout()","e2d7555f":"## Yearly","2d9d603a":"## Taking a sneak peak at months with outliers","a823b1d0":"There are some major outliers in the months of April\/May\/July\/August and November\/December. We'll come back to these ones later on.","bf223bb1":"## Monthly","62aaeeca":"It means there will be days that either have a 0 value or no recorded value at all.\n\nNow, let's see if there is any null value in the dataset","fefa569f":"## Getting some information about the dataset","09772782":"## Getting complete years","fe769846":"* The year 1989 and 2020 are not complete\n* Month # 6 (June) does not have any recorded DGSR value","0e3720e0":"Data is quite irregular. Also, a 6th order polynomial is poorly conditioned so the shape cannot be determined by complex polynomial functions.","0854f4f2":"## Getting a look at Estimated DGSR data","e7e3a0e8":"There is no outlier in Esimated DGSR value.","a1863034":"So we do not have any null value in the data. However, as we saw previously, we might have incomplete values.","b4130d3c":"## Monthly mean","d790be78":"### Determining the missing average value for the month of June\nData is quite well fitted by a 2nd order polynomial so we can try and determine the average value for the month of June as well.","82aa6c44":"## Daily mean","742d1a83":"## Daily","b1fab47e":"It can be seen that the 14th and 18th order polynomials do fit the shape of the curve better, but they overestimate the fit in the beginning and the end.\n\nThe 10th and 12th order polynomials, on the other hand, are quite okay as compared to the other two higher order polynomials.","10bc8171":"# Scatter plots","04ee0ec5":"## Yearly mean","b0087ea6":"# Boxlplots"}}