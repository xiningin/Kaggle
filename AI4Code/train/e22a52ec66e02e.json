{"cell_type":{"e6a10bf9":"code","12a01760":"code","7beeeb43":"code","cda33ae2":"code","aff20137":"code","176c0816":"code","561ea727":"code","1954f210":"code","1b6e3360":"code","75d400ee":"code","1d4ae936":"code","6b1aa8a4":"code","70763d87":"code","32822950":"code","2bc82222":"code","0bd67ae0":"code","091ff624":"code","68b1387b":"code","40ad0566":"code","1dede6bc":"code","4f92aebb":"code","aba23ee7":"code","f41686b3":"code","5f8d98b5":"code","183ee74f":"code","514a2ef6":"markdown","a42eac00":"markdown","dca180a5":"markdown","58587beb":"markdown","3b24d68b":"markdown","6f9c733b":"markdown","17d2c631":"markdown","f716760f":"markdown","201c9600":"markdown","49f01ae8":"markdown","71622d97":"markdown"},"source":{"e6a10bf9":"# Import libraries\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport matplotlib as mpl\nfrom scipy import stats\nimport statsmodels.api as sm\nimport warnings\nfrom itertools import product\nfrom datetime import datetime\nimport warnings\nwarnings.filterwarnings('ignore')\nwarnings.simplefilter('ignore')\nplt.style.use('seaborn-poster')\nfrom statsmodels.graphics.tsaplots import plot_acf\nfrom statsmodels.tsa.seasonal import seasonal_decompose\nimport statsmodels.api as sm","12a01760":"# Import datetime\nfrom datetime import datetime","7beeeb43":"# Load data\ndf = pd.read_csv('..\/input\/bitcoin-historical-data\/bitstampUSD_1-min_data_2012-01-01_to_2021-03-31.csv')\ndf.head()","cda33ae2":"# Calculation of index-weighted moving average\newm_mean = df['Volume_(BTC)'].ewm(span=90).mean()  \n\n# Display exponentially weighted moving average\nprint(ewm_mean)\n\n# Visualizing Exponentially Weighted Moving Averages\nimport matplotlib.pyplot as plt\nfig, ax = plt.subplots()\nax.plot(df['Volume_(BTC)'], label='original')\nax.plot(ewm_mean, label='ewma')\nax.legend()\nplt.show()","aff20137":"def plot_outlier(ts, ewm_span=90, threshold=3.0):\n\n    fig, ax = plt.subplots()\n    # Calculation of index-weighted moving average\n    ewm_mean = ts.ewm(span=ewm_span).mean()  \n    # Calculation of exponentially weighted moving standard deviation\n    ewm_std = ts.ewm(span=ewm_span).std()  \n    ax.plot(ts, label='original')\n    ax.plot(ewm_mean, label='ewma')\n\n    # Plot data that are more than 3.0 times out of the standard deviation as outliers.\n    ax.fill_between(ts.index,\n                    ewm_mean - ewm_std * threshold,\n                    ewm_mean + ewm_std * threshold,\n                    alpha=0.2)\n    outlier = ts[(ts - ewm_mean).abs() > ewm_std * threshold]\n    ax.scatter(outlier.index, outlier, label='outlier')\n    ax.legend()\n    plt.show()\n    return fig,outlier\n\nfig,out_fil = plot_outlier(df['Volume_(BTC)'],ewm_span=90, threshold=3.0);","176c0816":"df[df.index.isin(out_fil.index)]","561ea727":"# Extract records that do not have outliers\ndf = df[~df.index.isin(out_fil.index)]","1954f210":"# Calculation of index-weighted moving average\newm_mean = df['Volume_(BTC)'].ewm(span=90).mean()  \ndf['ewm_mean'] = ewm_mean","1b6e3360":"# Completing missing values with exponentially weighted moving averages\ndf.loc[df['Volume_(BTC)'].isnull(),'Volume_(BTC)']=df[df['Volume_(BTC)'].isnull()]['ewm_mean']\ndf.loc[df['Weighted_Price'].isnull(),'Weighted_Price']=df[df['Weighted_Price'].isnull()]['ewm_mean']","75d400ee":"# Unix-time to \ndf.Timestamp = pd.to_datetime(df.Timestamp, unit='s')\n\n# Resampling to daily frequency\ndf.index = df.Timestamp\ndf = df.resample('D').mean()\n\n# Resampling to monthly frequency\ndf_month = df.resample('M').mean()\n\n# Resampling to annual frequency\ndf_year = df.resample('A-DEC').mean()\n\n# Resampling to quarterly frequency\ndf_Q = df.resample('Q-DEC').mean()","1d4ae936":"df_month = df.sort_values(\"Timestamp\").reset_index()","6b1aa8a4":"# PLOTS\nfig = plt.figure(figsize=[15, 7])\nplt.suptitle('Bitcoin exchanges, mean USD', fontsize=22)\n\nplt.subplot(221)\nplt.plot(df.Weighted_Price, '-', label='By Days')\nplt.legend()\n\nplt.subplot(222)\nplt.plot(df_month.Weighted_Price, '-', label='By Months')\nplt.legend()\n\nplt.subplot(223)\nplt.plot(df_Q.Weighted_Price, '-', label='By Quarters')\nplt.legend()\n\nplt.subplot(224)\nplt.plot(df_year.Weighted_Price, '-', label='By Years')\nplt.legend()\n\n# plt.tight_layout()\nplt.show()","70763d87":"# Extraction of specific columns\ndf_new = df.loc[:, ['Open', 'High', 'Low', 'Close']]\ndf_close = df.loc[:, ['Close']]","32822950":"plt.subplot(221)\nplt.plot(df_new.Close, '-', label='By Days')\nplt.legend()","2bc82222":"plt.figure(figsize=(10,6))\nsns.lineplot(x=df_new.index, y=\"High\", data=df_new)\nplt.show()","0bd67ae0":"plt.figure(figsize=(10,6))\nsns.lineplot(x=df_new.index, y=\"Low\", data=df_new)\nplt.show()","091ff624":"plt.figure(figsize=(10,6))\nsns.lineplot(x=df_new.index, y=\"Close\", data=df_new)\nplt.show()","68b1387b":"plt.figure(figsize=(10,6))\nsns.lineplot(x=df_new.index, y=\"Close\", data=df_new)\nplt.show()","40ad0566":"print(df_new)","1dede6bc":"# Training data\ntrain = df[df_new.index<'2019-01-01']\n\n# Testing data\ntest = df[df_new.index>='2019-01-01']","4f92aebb":"# Creating a SARIMA Model\nsarima = sm.tsa.statespace.SARIMAX(df['Volume_(BTC)'],order=(2, 1, 3) ,seasonal_order=(0, 2, 2, 12)).fit()\n\n#Model summary display\nprint(sarima.summary())","aba23ee7":"print(sarima.predict('2019-01-01','2021-03-31'))","f41686b3":"# Graphical representation of real data and prediction results\nplt.plot(test['Volume_(BTC)'], label='original')\nplt.plot(sarima.predict('2019-01-01','2021-03-31'), label='predicted', color='red')\nplt.legend(loc='best')\nplt.show()","5f8d98b5":"print(sarima.predict('20\uff12\uff11-04-01','2030-03-31'))","183ee74f":"plt.plot(sarima.predict('20\uff12\uff11-04-01','2030-03-31'), label='predicted', color='black')\nplt.legend(loc='best')\nplt.show()","514a2ef6":"* Assign the value of ewm_mean to the missing record.","a42eac00":"* It looks like it will rise until 2024, but after that it will trend downward. I guess I'd better sell my bitcoin before 2024.","dca180a5":"* We first want to see if there are any outliers and outliers.","58587beb":"* Now that we have identified the outlier, we can use that value to remove the outlier.","3b24d68b":"* The forecasting model is not able to reproduce the price spikes in 2019-04, 2019-07, 2019-10, 2020-04, and 2021-01, but it is able to reproduce the upward and downward price trends.","6f9c733b":"# Building a Predictive Model","17d2c631":"* The exponentially weighted moving standard deviation is also calculated, and data that are more than three times out of the standard deviation are plotted as outliers.","f716760f":"* The missing values are determined, the exponentially weighted moving average is calculated, and then the missing values are supplemented by the exponentially weighted moving average.","201c9600":"# Acknowledgements\n* [Bitcoin Price. Prediction by ARIMA](https:\/\/www.kaggle.com\/myonin\/bitcoin-price-prediction-by-arima)","49f01ae8":"# Preprocessing","71622d97":"* Let's project beyond April 2021."}}