{"cell_type":{"51484cd0":"code","44e51e64":"code","791902c6":"code","7328a698":"code","ba4d7d38":"code","7f1cff28":"code","7837600f":"code","41b249aa":"code","1960c04f":"code","d90381fd":"code","ec364193":"code","6cab6ebc":"code","2227cf8f":"code","662f1261":"code","ca9fb7ba":"code","a557a304":"code","2abedb47":"code","d17a317c":"code","e044b02e":"code","50c208fd":"code","649d29b2":"code","76908113":"code","6654c763":"code","f2e4e697":"code","8335061a":"code","add52695":"code","8614f989":"code","1bcb776e":"code","91015fcb":"code","003418e0":"code","4874b96b":"code","c565f295":"code","c7ef46f4":"code","db8e630e":"code","6caacb4f":"code","c6a9db36":"code","fd1a23ec":"code","0f7cc139":"code","e6a0a4d6":"code","0af8cf8c":"code","69ab6a66":"code","273b72df":"code","29bd929e":"code","0ef3d662":"code","a0506cc3":"code","5d942239":"code","a8826188":"code","63fee6d8":"code","e6d5ce5b":"code","b360d4bf":"code","dd61ce28":"code","48ad22ef":"code","997e68f5":"code","9dd34682":"code","f2c4fd02":"code","33414c44":"code","ce233b8a":"code","e47c1406":"code","f985aef5":"code","48471f43":"code","4b8d9127":"code","d0a68a26":"code","abb71137":"code","d5f6352e":"code","5524ade0":"code","b5e0dd51":"markdown","0d495f38":"markdown","f0619bcf":"markdown","866f776a":"markdown","0fb2ba6b":"markdown","06b80adf":"markdown","6aa97fd8":"markdown","0aea6f12":"markdown","79c834f6":"markdown","e3c0f6e2":"markdown","35c66865":"markdown","b36b59c8":"markdown","06880c31":"markdown","64703934":"markdown","4b6dfb6a":"markdown","d3145f9a":"markdown"},"source":{"51484cd0":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","44e51e64":"df = pd.read_csv(\"..\/input\/hackerearth-carnival-wars-challenge\/train.csv\")\ntf  = pd.read_csv(\"..\/input\/hackerearth-carnival-wars-challenge\/test.csv\")","791902c6":"df.head()","7328a698":"df.columns","ba4d7d38":"df.columns=['Product_id', 'Stall_no', 'Instock_date', 'Market_category',\n            'Customer_name', 'Loyalty_customer', 'Product_category', 'Grade',\n            'Demand', 'Discount', 'Charges_1', 'Charges_2',\n            'Min_price', 'Max_price', 'Selling_price']","7f1cff28":"df.head()","7837600f":"df.sample(frac=0.001)","41b249aa":"df.shape","1960c04f":"df.info()","d90381fd":"df.drop(['Product_id','Customer_name'],axis=1,inplace=True)","ec364193":"df['Instock_date']=pd.to_datetime(df['Instock_date'])","6cab6ebc":"df.isnull().sum()","2227cf8f":"sns.heatmap(df.isnull())","662f1261":"df.describe()","ca9fb7ba":"plt.figure(figsize=(12,4))\nsns.distplot(df['Selling_price'],hist=False,label='Selling_price')\nsns.distplot(df['Min_price'],hist=False,label='Min_price')\nsns.distplot(df['Max_price'],hist=False,label='Max_price')","a557a304":"index_name =df[df['Selling_price']<0].index\ndf.drop(index_name,inplace=True) ","2abedb47":"sns.distplot(df.Selling_price)","d17a317c":"lst=['Discount','Charges_1','Charges_2','Min_price','Max_price','Selling_price']","e044b02e":"for i in lst:\n    df[i].fillna(df[i].median(),inplace=True)\ndf['Stall_no'].fillna(df['Stall_no'].median(),inplace=True)","50c208fd":"df.info()","649d29b2":"df.nunique()","76908113":"sns.countplot('Discount',data=df)","6654c763":"plt.figure(figsize=(16,4))\nplt.subplot(1,3,1)\nsns.distplot(df['Min_price'])\nplt.subplot(1,3,2)\nsns.distplot(df['Selling_price'])\nplt.subplot(1,3,3)\nsns.distplot(df['Max_price'])\n","f2e4e697":"plt.figure(figsize=(16,4))\nplt.subplot(1,3,1)\nsns.boxplot(df['Min_price'])\nplt.subplot(1,3,2)\nsns.boxplot(df['Selling_price'])\nplt.subplot(1,3,3)\nsns.boxplot(df['Max_price'])","8335061a":"df.head()","add52695":"sns.relplot('Selling_price','Min_price',hue='Discount',data=df,style='Loyalty_customer')","8614f989":"sns.relplot('Selling_price','Max_price',hue='Discount',data=df,style='Loyalty_customer')","1bcb776e":"plt.figure(figsize=(14,4))\nsns.boxplot('Product_category','Selling_price',data=df)","91015fcb":"sns.relplot('Selling_price','Max_price',hue='Product_category',data=df)","003418e0":"plt.figure(figsize=(14,4))\nsns.boxplot('Stall_no','Selling_price',data=df)","4874b96b":"plt.figure(figsize=(16,4))\nsns.boxplot('Market_category','Selling_price',data=df)","c565f295":"sns.pairplot(df)","c7ef46f4":"df=pd.get_dummies(df,columns=['Loyalty_customer','Product_category'],drop_first=True)","db8e630e":"corr_matrix=df.corr()","6caacb4f":"sns.heatmap(corr_matrix)","c6a9db36":"corr_matrix['Selling_price'].sort_values(ascending=False)","fd1a23ec":"lst=['Loyalty_customer_Yes','Grade','Charges_1','Product_category_Fashion','Product_category_Technology',\n     'Stall_no','Charges_2','Product_category_Pet_care','Product_category_Repair','Demand','Product_category_Home_decor',\n     'Product_category_Cosmetics','Product_category_Hospitality','Product_category_Organic','Product_category_Educational']","0f7cc139":"df.drop(lst,axis=1,inplace=True)\ndf.drop_duplicates(inplace=True)","e6a0a4d6":"df.head()","0af8cf8c":"lst2=['Market_category','Min_price','Max_price']","69ab6a66":"df.drop('Instock_date',axis=1,inplace=True)","273b72df":"from sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression","29bd929e":"X=df.drop(['Selling_price'],axis=1)\nY=df['Selling_price']","0ef3d662":"X_train,X_test,Y_train,Y_test = train_test_split(X,Y,test_size = 0.2,random_state=42)","a0506cc3":"from sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\nX_train = sc.fit_transform(X_train)\nX_test = sc.transform(X_test)","5d942239":"ls=LinearRegression()","a8826188":"reg=ls.fit(X_train,Y_train)","63fee6d8":"from sklearn.ensemble import RandomForestRegressor\nrf = RandomForestRegressor(n_estimators=3000)\nrf.fit(X_train,Y_train)","e6d5ce5b":"tf.head()","b360d4bf":"tf.drop(['Stall_no','instock_date','Customer_name','Loyalty_customer','Product_Category','Grade','Demand','charges_1','charges_2 (%)'],axis=1,inplace=True)","dd61ce28":"tf.head()","48ad22ef":"tf.isnull().sum()","997e68f5":"plt.figure(figsize=(16,4))\nplt.subplot(1,2,1)\nsns.distplot(tf['Minimum_price'])\nplt.subplot(1,2,2)\nsns.distplot(tf['Maximum_price'])\n","9dd34682":"plt.figure(figsize=(16,4))\nplt.subplot(1,3,1)\nsns.boxplot(tf['Minimum_price'])\nplt.subplot(1,3,2)\nsns.boxplot(tf['Maximum_price'])","f2c4fd02":"tf['Minimum_price'].fillna(tf['Minimum_price'].median(),inplace=True)","33414c44":"tf.head()","ce233b8a":"lst3=['Market_Category','Minimum_price','Maximum_price']","e47c1406":"tf.drop('Product_id',axis=1,inplace=True)","f985aef5":"tf = sc.transform(tf)","48471f43":"predicted_values=rf.predict(tf)","4b8d9127":"for i in predicted_values:\n    if i<0:\n        print(i)","d0a68a26":"tf = pd.read_csv(\"..\/input\/hackerearth-carnival-wars-challenge\/test.csv\")\nsubmit = pd.DataFrame()\nsubmit['Product_id'] = tf.Product_id\nsubmit['Selling_Price'] = predicted_values","abb71137":"submit.to_csv('submit.csv',index=False)","d5f6352e":"sns.distplot(submit['Selling_Price'])","5524ade0":"submit.head()","b5e0dd51":"stall_no. also not much effect on salling_price as median of selling_price of all stall lies nearly about each other","0d495f38":"Here min Selling_price is -ve and lots of difference in mean and median of some features of 1st we see distribution of these ","f0619bcf":"From this, It clear that Discount affect selling Price and feature Loyalty_customer Not affect so.","866f776a":"Fig. is not so clear but from fig. we can conclude market_catogary effect selling_price","0fb2ba6b":"From above info EDA we have:\n1. ['Min_price','Max_price','Discount','Market_category'] These features have more effect on selling price.\n2. ['Satll_no','Loyalty_customer','Product_category'] These feature not affect selling_price.\n3. Now we drop unimportant features by check  correlation and above obeservations","06b80adf":"scalar.fit(tf[lst3])\ntf[lst3]=scalar.transform(tf[lst3])","6aa97fd8":"Rename columns for quick understanding.","0aea6f12":"scalar=StandardScaler()\nscalar.fit(df[lst2])","79c834f6":"Here we see -ve values and outlies present in these features.                                                                   \n1st we remove -ve values in selling_price then fill null values by median","e3c0f6e2":"These Loyalty of customer and product category have much effect on selling_price","35c66865":"df[lst2]=scalar.transform(df[lst2])","b36b59c8":"# Quick View of Dataset","06880c31":"# Read Dataset","64703934":"Not much difference in selling_price of different product","4b6dfb6a":"# Import Libraries","d3145f9a":"from sklearn.preprocessing import StandardScaler"}}