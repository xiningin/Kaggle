{"cell_type":{"0db3b5ca":"code","7aec74ab":"code","48003b2e":"code","1665d984":"code","4e9c534b":"code","2e546165":"markdown","b431128d":"markdown","5f67f317":"markdown","988406f1":"markdown"},"source":{"0db3b5ca":"import os\nfrom PIL import Image\nimport numpy as np\n\nDATA_DIR = \"\/kaggle\/input\/leapgestrecog\/leapGestRecog\"\nIMAGE_SIZE_X = 160\nIMAGE_SIZE_Y = 60\n\nX = []\nY = []\n\nfor root,dirs, files in os.walk(DATA_DIR, topdown=False):\n    print(\".\", end=\"\")\n    for name in files:\n        path = os.path.join(root, name)\n        if path.endswith(\"png\"):\n            \n            # Resize & change into grey scale\n            img = Image.open(path).convert('L')\n            img = img.resize((IMAGE_SIZE_X, IMAGE_SIZE_Y))\n            X.append(np.array(img))\n            \n            # Get gesture type for label\n            category = name.split(\"_\")[2][1]\n            Y.append(int(category))\n\nX = np.array(X, dtype = 'float32')\nY = np.array(Y)\nprint(\"done\")","7aec74ab":"# One-hot encoding\nfrom keras.utils import to_categorical\nY = to_categorical(Y)\n\n# Normalization\nX \/= 255\n\n# Split dataset for train\/validation\/test\nfrom sklearn.model_selection import train_test_split\nx_train, x_further, y_train, y_further = train_test_split(X, Y, test_size = 0.2)\nx_validate, x_test, y_validate, y_test = train_test_split(x_further, y_further, test_size = 0.5)","48003b2e":"from keras import layers\nfrom keras import models\n\nmodel = models.Sequential()\nmodel.add(layers.Flatten())\nmodel.add(layers.Dense(units=10, activation='softmax'))\nmodel.compile(optimizer='rmsprop', loss='categorical_crossentropy', metrics=['accuracy'])","1665d984":"model.fit(x_train, y_train, epochs=3, batch_size=64, verbose=1, validation_data=(x_validate, y_validate))","4e9c534b":"[loss, acc] = model.evaluate(x_test,y_test,verbose=1)\nprint(\"Accuracy: \" + str(acc * 100) + \"%\")","2e546165":"## 4. Test","b431128d":"## 2. Build Network","5f67f317":"## 3. Train","988406f1":"# Hand Gesture Recognition\n## 1. Pre-processing"}}