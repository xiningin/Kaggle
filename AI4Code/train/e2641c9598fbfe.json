{"cell_type":{"bd8d1c6c":"code","083e4ba4":"code","c783b5be":"code","7be255d2":"code","30c73268":"code","313ee052":"code","cbbb1902":"code","9370c760":"code","176526a3":"code","414e7980":"code","ffbca414":"code","9871e9f6":"code","886445d1":"code","d96b8c10":"code","1f6d230d":"code","caf5b6e8":"code","5d6b0010":"code","03180996":"code","6c0e42e0":"code","e2e7b390":"code","f747d43c":"code","4997adf9":"code","8bc49bc9":"code","bc9d6938":"code","3cba1c5e":"code","87ff7452":"code","7185bdf8":"code","5f981161":"code","81914f59":"code","bb8be49b":"code","91de1241":"code","6d7dc668":"code","87209b8a":"code","fb54b779":"code","1a9470ae":"code","edf04dcd":"code","d8ad3ee9":"code","c187f2d9":"code","82814bd3":"code","c23bc3d0":"code","0a570c87":"code","1deff2b3":"code","087ec911":"code","a1b224d2":"code","667bd927":"code","27320b76":"markdown"},"source":{"bd8d1c6c":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","083e4ba4":"df_test = pd.read_csv(\"..\/input\/house-prices-advanced-regression-techniques\/test.csv\")\ndf_train = pd.read_csv(\"..\/input\/house-prices-advanced-regression-techniques\/train.csv\")\ndf_train.head()\n","c783b5be":"# a = df_train.drop(columns=[\"Alley\",\"PoolQC\",\"Fence\",\"MiscFeature\",\"MSZoning\",\"MSSubClass\",\"LotFrontage\",\"Sreet\",\"Lotshape\",\"LandContour\",\"Utilities\"])\n","7be255d2":"df_train.head()","30c73268":"df_train[\"Year_old\"]  = 2021  - df_train[\"YrSold\"]","313ee052":"df_train","cbbb1902":"df_train.drop([\"YrSold\"],axis=1,inplace =True)","9370c760":"df_train.head()","176526a3":"df_train.isnull().sum()","414e7980":"final_dataset = pd.get_dummies(df_train,drop_first= True)\n","ffbca414":"final_dataset=final_dataset.dropna()","9871e9f6":"final_dataset['Id'] = pd.to_numeric(final_dataset['Id'])\nfinal_dataset.set_index('Id',inplace =True)","886445d1":"y = final_dataset['SalePrice']\n","d96b8c10":"X = final_dataset.drop(['SalePrice'],axis =1)","1f6d230d":"X","caf5b6e8":"from sklearn.ensemble import ExtraTreesRegressor","5d6b0010":"ex = ExtraTreesRegressor()\nex.fit(X,y)","03180996":"print(ex.feature_importances_)","6c0e42e0":"feat_importances = pd.Series(ex.feature_importances_,index =X.columns)\nfeat_importances.nlargest(20).plot(kind='barh')\n","e2e7b390":"feat_importances.nlargest(20)","f747d43c":"top_features =  [\"ExterQual_TA\",           \n\"OverallQual\",             \n\"GarageCars\",              \n\"GrLivArea\",             \n\"FullBath\",               \n\"TotRmsAbvGrd\",         \n\"1stFlrSF\",                \n\"BsmtFinSF1\",              \n\"TotalBsmtSF\",             \n\"2ndFlrSF\",               \n\"Fireplaces\",              \n\"Neighborhood_NoRidge\",    \n\"GarageArea\",              \n\"KitchenQual_Gd\",         \n\"BsmtQual_Gd\",            \n\"YearRemodAdd\",            \n\"BsmtFullBath\",           \n\"ExterQual_Gd\",            \n\"KitchenQual_TA\",         \n\"MasVnrArea\"]\nall_features = X.columns\nset(all_features).difference(top_features)\n","4997adf9":"X = X.drop(['3SsnPorch',\n 'Alley_Pave',\n 'BedroomAbvGr',\n 'BldgType_2fmCon',\n 'BldgType_Duplex',\n 'BldgType_Twnhs',\n 'BldgType_TwnhsE',\n 'BsmtCond_Gd',\n 'BsmtCond_Po',\n 'BsmtCond_TA',\n 'BsmtExposure_Gd',\n 'BsmtExposure_Mn',\n 'BsmtExposure_No',\n 'BsmtFinSF2',\n 'BsmtFinType1_BLQ',\n 'BsmtFinType1_GLQ',\n 'BsmtFinType1_LwQ',\n 'BsmtFinType1_Rec',\n 'BsmtFinType1_Unf',\n 'BsmtFinType2_BLQ',\n 'BsmtFinType2_GLQ',\n 'BsmtFinType2_LwQ',\n 'BsmtFinType2_Rec',\n 'BsmtFinType2_Unf',\n 'BsmtHalfBath',\n 'BsmtQual_Fa',\n 'BsmtQual_TA',\n 'BsmtUnfSF',\n 'CentralAir_Y',\n 'Condition1_Feedr',\n 'Condition1_Norm',\n 'Condition1_PosA',\n 'Condition1_PosN',\n 'Condition1_RRAe',\n 'Condition1_RRAn',\n 'Condition1_RRNe',\n 'Condition1_RRNn',\n 'Condition2_Feedr',\n 'Condition2_Norm',\n 'Condition2_PosA',\n 'Condition2_PosN',\n 'Condition2_RRAe',\n 'Condition2_RRAn',\n 'Condition2_RRNn',\n 'Electrical_FuseF',\n 'Electrical_FuseP',\n 'Electrical_Mix',\n 'Electrical_SBrkr',\n 'EnclosedPorch',\n 'ExterCond_Fa',\n 'ExterCond_Gd',\n 'ExterCond_Po',\n 'ExterCond_TA',\n 'ExterQual_Fa',\n 'Exterior1st_AsphShn',\n 'Exterior1st_BrkComm',\n 'Exterior1st_BrkFace',\n 'Exterior1st_CBlock',\n 'Exterior1st_CemntBd',\n 'Exterior1st_HdBoard',\n 'Exterior1st_ImStucc',\n 'Exterior1st_MetalSd',\n 'Exterior1st_Plywood',\n 'Exterior1st_Stone',\n 'Exterior1st_Stucco',\n 'Exterior1st_VinylSd',\n 'Exterior1st_Wd Sdng',\n 'Exterior1st_WdShing',\n 'Exterior2nd_AsphShn',\n 'Exterior2nd_Brk Cmn',\n 'Exterior2nd_BrkFace',\n 'Exterior2nd_CBlock',\n 'Exterior2nd_CmentBd',\n 'Exterior2nd_HdBoard',\n 'Exterior2nd_ImStucc',\n 'Exterior2nd_MetalSd',\n 'Exterior2nd_Other',\n 'Exterior2nd_Plywood',\n 'Exterior2nd_Stone',\n 'Exterior2nd_Stucco',\n 'Exterior2nd_VinylSd',\n 'Exterior2nd_Wd Sdng',\n 'Exterior2nd_Wd Shng',\n 'Fence_GdWo',\n 'Fence_MnPrv',\n 'Fence_MnWw',\n 'FireplaceQu_Fa',\n 'FireplaceQu_Gd',\n 'FireplaceQu_Po',\n 'FireplaceQu_TA',\n 'Foundation_CBlock',\n 'Foundation_PConc',\n 'Foundation_Slab',\n 'Foundation_Stone',\n 'Foundation_Wood',\n 'Functional_Maj2',\n 'Functional_Min1',\n 'Functional_Min2',\n 'Functional_Mod',\n 'Functional_Sev',\n 'Functional_Typ',\n 'GarageCond_Fa',\n 'GarageCond_Gd',\n 'GarageCond_Po',\n 'GarageCond_TA',\n 'GarageFinish_RFn',\n 'GarageFinish_Unf',\n 'GarageQual_Fa',\n 'GarageQual_Gd',\n 'GarageQual_Po',\n 'GarageQual_TA',\n 'GarageType_Attchd',\n 'GarageType_Basment',\n 'GarageType_BuiltIn',\n 'GarageType_CarPort',\n 'GarageType_Detchd',\n 'GarageYrBlt',\n 'HalfBath',\n 'HeatingQC_Fa',\n 'HeatingQC_Gd',\n 'HeatingQC_Po',\n 'HeatingQC_TA',\n 'Heating_GasA',\n 'Heating_GasW',\n 'Heating_Grav',\n 'Heating_OthW',\n 'Heating_Wall',\n 'HouseStyle_1.5Unf',\n 'HouseStyle_1Story',\n 'HouseStyle_2.5Fin',\n 'HouseStyle_2.5Unf',\n 'HouseStyle_2Story',\n 'HouseStyle_SFoyer',\n 'HouseStyle_SLvl',\n 'KitchenAbvGr',\n 'KitchenQual_Fa',\n 'LandContour_HLS',\n 'LandContour_Low',\n 'LandContour_Lvl',\n 'LandSlope_Mod',\n 'LandSlope_Sev',\n 'LotArea',\n 'LotConfig_CulDSac',\n 'LotConfig_FR2',\n 'LotConfig_FR3',\n 'LotConfig_Inside',\n 'LotFrontage',\n 'LotShape_IR2',\n 'LotShape_IR3',\n 'LotShape_Reg',\n 'LowQualFinSF',\n 'MSSubClass',\n 'MSZoning_FV',\n 'MSZoning_RH',\n 'MSZoning_RL',\n 'MSZoning_RM',\n 'MasVnrType_BrkFace',\n 'MasVnrType_None',\n 'MasVnrType_Stone',\n 'MiscFeature_Othr',\n 'MiscFeature_Shed',\n 'MiscFeature_TenC',\n 'MiscVal',\n 'MoSold',\n 'Neighborhood_Blueste',\n 'Neighborhood_BrDale',\n 'Neighborhood_BrkSide',\n 'Neighborhood_ClearCr',\n 'Neighborhood_CollgCr',\n 'Neighborhood_Crawfor',\n 'Neighborhood_Edwards',\n 'Neighborhood_Gilbert',\n 'Neighborhood_IDOTRR',\n 'Neighborhood_MeadowV',\n 'Neighborhood_Mitchel',\n 'Neighborhood_NAmes',\n 'Neighborhood_NPkVill',\n 'Neighborhood_NWAmes',\n 'Neighborhood_NridgHt',\n 'Neighborhood_OldTown',\n 'Neighborhood_SWISU',\n 'Neighborhood_Sawyer',\n 'Neighborhood_SawyerW',\n 'Neighborhood_Somerst',\n 'Neighborhood_StoneBr',\n 'Neighborhood_Timber',\n 'Neighborhood_Veenker',\n 'OpenPorchSF',\n 'OverallCond',\n 'PavedDrive_P',\n 'PavedDrive_Y',\n 'PoolArea',\n 'PoolQC_Fa',\n 'PoolQC_Gd',\n 'RoofMatl_CompShg',\n 'RoofMatl_Membran',\n 'RoofMatl_Metal',\n 'RoofMatl_Roll',\n 'RoofMatl_Tar&Grv',\n 'RoofMatl_WdShake',\n 'RoofMatl_WdShngl',\n 'RoofStyle_Gable',\n 'RoofStyle_Gambrel',\n 'RoofStyle_Hip',\n 'RoofStyle_Mansard',\n 'RoofStyle_Shed',\n 'SaleCondition_AdjLand',\n 'SaleCondition_Alloca',\n 'SaleCondition_Family',\n 'SaleCondition_Normal',\n 'SaleCondition_Partial',\n 'SaleType_CWD',\n 'SaleType_Con',\n 'SaleType_ConLD',\n 'SaleType_ConLI',\n 'SaleType_ConLw',\n 'SaleType_New',\n 'SaleType_Oth',\n 'SaleType_WD',\n 'ScreenPorch',\n 'Street_Pave',\n 'Utilities_NoSeWa',\n 'WoodDeckSF',\n 'YearBuilt',\n 'Year_old'],axis=1)","8bc49bc9":"X","bc9d6938":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test = train_test_split(X,y,test_size =0.2)","3cba1c5e":"X_train.shape\nprint(X_test.shape)","87ff7452":"from sklearn.ensemble import RandomForestRegressor\nrf = RandomForestRegressor()\n","7185bdf8":"#HyperParameters\n\nn_estimators = [int(i) for i in np.linspace(start = 100 ,stop= 1200, num =12)]\nmax_features = ['auto','sqrt']\nmax_depth = [int(i) for i in np.linspace(5,30,num =6) ]\nmin_samples_split = [2,3,10,15,100]\nmin_samples_leaf =[1,2,5,10]","5f981161":"from sklearn.model_selection import RandomizedSearchCV\nrandom_grid = {'n_estimators': n_estimators,\n              'max_features': max_features,\n              'max_depth': max_depth,\n              'min_samples_split': min_samples_split,\n              'min_samples_leaf': min_samples_leaf}\nprint(random_grid)","81914f59":"rf_random = RandomizedSearchCV(estimator=rf,param_distributions=random_grid,\n                              scoring='neg_mean_squared_error',n_iter =10,cv =5,random_state=42,n_jobs =1,verbose =2)","bb8be49b":"rf_random.fit(X_train,y_train)","91de1241":"predictions = rf_random.predict(X_test)","6d7dc668":"import seaborn as sns\nsns.scatterplot(y_test,predictions)","87209b8a":"rf_random.fit(X,y)","fb54b779":"df_test.isnull().sum()","1a9470ae":"final_dataset_test = pd.get_dummies(df_test,drop_first= True)","edf04dcd":"# final_dataset_test =final_dataset_test.dropna()","d8ad3ee9":"# final_dataset_test['Id'] = pd.to_numeric(final_dataset_test['Id'])\n# final_dataset_test.set_index('Id',inplace =True)","c187f2d9":"ids = final_dataset_test.iloc[:,0]\n","82814bd3":"top_features =  [\"ExterQual_TA\",           \n\"OverallQual\",             \n\"GarageCars\",              \n\"GrLivArea\",             \n\"FullBath\",               \n\"TotRmsAbvGrd\",         \n\"1stFlrSF\",                \n\"BsmtFinSF1\",              \n\"TotalBsmtSF\",             \n\"2ndFlrSF\",               \n\"Fireplaces\",              \n\"Neighborhood_NoRidge\",    \n\"GarageArea\",              \n\"KitchenQual_Gd\",         \n\"BsmtQual_Gd\",            \n\"YearRemodAdd\",            \n\"BsmtFullBath\",           \n\"ExterQual_Gd\",            \n\"KitchenQual_TA\",         \n\"MasVnrArea\"]\nall_features = final_dataset_test.columns\nset(all_features).difference(top_features)\n","c23bc3d0":"X_TEST = final_dataset_test.drop(['Id','3SsnPorch',\n 'Alley_Pave',\n 'BedroomAbvGr',\n 'BldgType_2fmCon',\n 'BldgType_Duplex',\n 'BldgType_Twnhs',\n 'BldgType_TwnhsE',\n 'BsmtCond_Gd',\n 'BsmtCond_Po',\n 'BsmtCond_TA',\n 'BsmtExposure_Gd',\n 'BsmtExposure_Mn',\n 'BsmtExposure_No',\n 'BsmtFinSF2',\n 'BsmtFinType1_BLQ',\n 'BsmtFinType1_GLQ',\n 'BsmtFinType1_LwQ',\n 'BsmtFinType1_Rec',\n 'BsmtFinType1_Unf',\n 'BsmtFinType2_BLQ',\n 'BsmtFinType2_GLQ',\n 'BsmtFinType2_LwQ',\n 'BsmtFinType2_Rec',\n 'BsmtFinType2_Unf',\n 'BsmtHalfBath',\n 'BsmtQual_Fa',\n 'BsmtQual_TA',\n 'BsmtUnfSF',\n 'CentralAir_Y',\n 'Condition1_Feedr',\n 'Condition1_Norm',\n 'Condition1_PosA',\n 'Condition1_PosN',\n 'Condition1_RRAe',\n 'Condition1_RRAn',\n 'Condition1_RRNe',\n 'Condition1_RRNn',\n 'Condition2_Feedr',\n 'Condition2_Norm',\n 'Condition2_PosA',\n 'Condition2_PosN',\n 'Electrical_FuseF',\n 'Electrical_FuseP',\n 'Electrical_SBrkr',\n 'EnclosedPorch',\n 'ExterCond_Fa',\n 'ExterCond_Gd',\n 'ExterCond_Po',\n 'ExterCond_TA',\n 'ExterQual_Fa',\n 'Exterior1st_AsphShn',\n 'Exterior1st_BrkComm',\n 'Exterior1st_BrkFace',\n 'Exterior1st_CBlock',\n 'Exterior1st_CemntBd',\n 'Exterior1st_HdBoard',\n 'Exterior1st_MetalSd',\n 'Exterior1st_Plywood',\n 'Exterior1st_Stucco',\n 'Exterior1st_VinylSd',\n 'Exterior1st_Wd Sdng',\n 'Exterior1st_WdShing',\n 'Exterior2nd_AsphShn',\n 'Exterior2nd_Brk Cmn',\n 'Exterior2nd_BrkFace',\n 'Exterior2nd_CBlock',\n 'Exterior2nd_CmentBd',\n 'Exterior2nd_HdBoard',\n 'Exterior2nd_ImStucc',\n 'Exterior2nd_MetalSd',\n 'Exterior2nd_Plywood',\n 'Exterior2nd_Stone',\n 'Exterior2nd_Stucco',\n 'Exterior2nd_VinylSd',\n 'Exterior2nd_Wd Sdng',\n 'Exterior2nd_Wd Shng',\n 'Fence_GdWo',\n 'Fence_MnPrv',\n 'Fence_MnWw',\n 'FireplaceQu_Fa',\n 'FireplaceQu_Gd',\n 'FireplaceQu_Po',\n 'FireplaceQu_TA',\n 'Foundation_CBlock',\n 'Foundation_PConc',\n 'Foundation_Slab',\n 'Foundation_Stone',\n 'Foundation_Wood',\n 'Functional_Maj2',\n 'Functional_Min1',\n 'Functional_Min2',\n 'Functional_Mod',\n 'Functional_Sev',\n 'Functional_Typ',\n 'GarageCond_Fa',\n 'GarageCond_Gd',\n 'GarageCond_Po',\n 'GarageCond_TA',\n 'GarageFinish_RFn',\n 'GarageFinish_Unf',\n 'GarageQual_Gd',\n 'GarageQual_Po',\n 'GarageQual_TA',\n 'GarageType_Attchd',\n 'GarageType_Basment',\n 'GarageType_BuiltIn',\n 'GarageType_CarPort',\n 'GarageType_Detchd',\n 'GarageYrBlt',\n 'HalfBath',\n 'HeatingQC_Fa',\n 'HeatingQC_Gd',\n 'HeatingQC_Po',\n 'HeatingQC_TA',\n 'Heating_GasW',\n 'Heating_Grav',\n 'Heating_Wall',\n 'HouseStyle_1.5Unf',\n 'HouseStyle_1Story',\n 'HouseStyle_2.5Unf',\n 'HouseStyle_2Story',\n 'HouseStyle_SFoyer',\n 'HouseStyle_SLvl',\n 'KitchenAbvGr',\n 'KitchenQual_Fa',\n 'LandContour_HLS',\n 'LandContour_Low',\n 'LandContour_Lvl',\n 'LandSlope_Mod',\n 'LandSlope_Sev',\n 'LotArea',\n 'LotConfig_CulDSac',\n 'LotConfig_FR2',\n 'LotConfig_FR3',\n 'LotConfig_Inside',\n 'LotFrontage',\n 'LotShape_IR2',\n 'LotShape_IR3',\n 'LotShape_Reg',\n 'LowQualFinSF',\n 'MSSubClass',\n 'MSZoning_FV',\n 'MSZoning_RH',\n 'MSZoning_RL',\n 'MSZoning_RM',\n 'MasVnrType_BrkFace',\n 'MasVnrType_None',\n 'MasVnrType_Stone',\n 'MiscFeature_Othr',\n 'MiscFeature_Shed',\n 'MiscVal',\n 'MoSold',\n 'Neighborhood_Blueste',\n 'Neighborhood_BrDale',\n 'Neighborhood_BrkSide',\n 'Neighborhood_ClearCr',\n 'Neighborhood_CollgCr',\n 'Neighborhood_Crawfor',\n 'Neighborhood_Edwards',\n 'Neighborhood_Gilbert',\n 'Neighborhood_IDOTRR',\n 'Neighborhood_MeadowV',\n 'Neighborhood_Mitchel',\n 'Neighborhood_NAmes',\n 'Neighborhood_NPkVill',\n 'Neighborhood_NWAmes',\n 'Neighborhood_NridgHt',\n 'Neighborhood_OldTown',\n 'Neighborhood_SWISU',\n 'Neighborhood_Sawyer',\n 'Neighborhood_SawyerW',\n 'Neighborhood_Somerst',\n 'Neighborhood_StoneBr',\n 'Neighborhood_Timber',\n 'Neighborhood_Veenker',\n 'OpenPorchSF',\n 'OverallCond',\n 'PavedDrive_P',\n 'PavedDrive_Y',\n 'PoolArea',\n 'PoolQC_Gd',\n 'RoofMatl_Tar&Grv',\n 'RoofMatl_WdShake',\n 'RoofMatl_WdShngl',\n 'RoofStyle_Gable',\n 'RoofStyle_Gambrel',\n 'RoofStyle_Hip',\n 'RoofStyle_Mansard',\n 'RoofStyle_Shed',\n 'SaleCondition_AdjLand',\n 'SaleCondition_Alloca',\n 'SaleCondition_Family',\n 'SaleCondition_Normal',\n 'SaleCondition_Partial',\n 'SaleType_CWD',\n 'SaleType_Con',\n 'SaleType_ConLD',\n 'SaleType_ConLI',\n 'SaleType_ConLw',\n 'SaleType_New',\n 'SaleType_Oth',\n 'SaleType_WD',\n 'ScreenPorch',\n 'Street_Pave',\n 'WoodDeckSF',\n 'YearBuilt',\n 'YrSold'],axis =1)","0a570c87":"SalePrice = rf_random.predict(X_TEST.fillna(0))","1deff2b3":"X_TEST","087ec911":"data = {\n  \"Id\": ids,\n  \"SalePrice\": SalePrice\n}\nsubmission = pd.DataFrame(data)","a1b224d2":"submission","667bd927":"submission.to_csv('submission.csv',index =False)","27320b76":"NOW TRAINING ON WHOLE DATA AND TESTING IT ON UNKNOWN"}}