{"cell_type":{"ba7ff380":"code","0d0cd6a8":"code","b6569d89":"code","35e2035a":"code","89d5a96f":"code","036524c9":"code","4c926796":"code","c5fd2e6a":"code","23bce877":"code","1f42b90e":"code","dab6b988":"code","5c47806b":"code","e6d1cd2a":"markdown","e527ab27":"markdown","4c31b982":"markdown","fa3b8a72":"markdown","4c738339":"markdown","be6b31cd":"markdown"},"source":{"ba7ff380":"!pip install openpyxl\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt","0d0cd6a8":"df = pd.read_excel(\"..\/input\/forbes-top-200020172021\/Forbes-2021.xlsx\")","b6569d89":"df.head()","35e2035a":"df['Count_Column'] = df['Country'].map(df['Country'].value_counts())","89d5a96f":"df.head()","036524c9":"#import libraries\n!pip install pyecharts\nfrom pyecharts.charts import Map,Geo\nfrom pyecharts import options as opts\nfrom pyecharts.globals import ThemeType","4c926796":"d = df[['Country','Count_Column']]","c5fd2e6a":"#dropping the duplicates\nd = d.drop_duplicates(subset = 'Country', keep = 'first')","23bce877":"d['Country'][10] = 'Korea'","1f42b90e":"country=list(d['Country'])\ncount=list(d['Count_Column'])","dab6b988":"list1 = [[country[i],count[i]] for i in range(len(country))] \nmap_1 = Map(init_opts=opts.InitOpts(width='1000px', height='460px',theme=ThemeType.ROMANTIC)) \nmap_1.add('Total Confirmed Cases', \n list1, \n maptype='world',\n is_map_symbol_show=False) \nmap_1.set_series_opts(label_opts=opts.LabelOpts(is_show=False)) \nmap_1.set_global_opts(visualmap_opts=opts.VisualMapOpts(max_=611,is_piecewise=True,pieces=[\n {\"max\": 1},\n {\"max\": 0, \"max\":4},\n {\"max\": 1, \"max\": 4},\n {\"max\": 5, \"max\": 9},\n {\"max\": 10, \"max\": 19},\n {\"max\": 20, \"max\": 49},\n {\"max\": 50, \"max\": 99},\n {\"max\": 200, \"max\": 500},\n {\"max\": 500, \"max\":612},]),\n  title_opts=opts.TitleOpts(\n title='Forbes Global 2000 Companies Per Country (2021)',\n pos_left='center',\n padding=0,\n item_gap=2,\n title_textstyle_opts= opts.TextStyleOpts(color='Black',\n font_weight='bold',\n font_family='Courier New',\n font_size=30), \n subtitle_textstyle_opts= opts.TextStyleOpts(color='grey',\n font_weight='bold',\n font_family='Courier New',\n font_size=13)), \n legend_opts=opts.LegendOpts(is_show=False))\nmap_1.render_notebook()","5c47806b":"plt.figure(figsize=(20,8))\nsns.countplot(x=\"Country\", data=df,order=df.Country.value_counts().iloc[:15].index)","e6d1cd2a":"### *Here we are making a Count Column to count the number of times each Country appeared*","e527ab27":"### *Changing South Korea to Korea to match our map*","4c31b982":"# *Using Pyecharts to plot the data*","fa3b8a72":"### Taking the two columns which will be important for us","4c738339":"# *Top 15 Countries with their companies featured in Forbes Global 2000*","be6b31cd":"# *Plotting Forbes Global 2000 Per Country for the year 2021 in World Map*\n![sgESik1mfljz_6aLH2FGzaDEfeRxpcafAke01LBzNfk.jpg](attachment:5be29329-494b-4eb0-a8c4-ccf09703d06c.jpg)"}}