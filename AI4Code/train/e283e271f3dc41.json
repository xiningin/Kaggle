{"cell_type":{"340c85b9":"code","30045c00":"code","f3802567":"code","6e89bdd1":"code","ea942b7d":"code","ad22d284":"code","6a77edbb":"code","07a84a13":"code","5c4221f3":"code","02f32f12":"code","c5e02b20":"code","c262c6ab":"code","6c3a1f09":"code","815f1bd7":"code","30821545":"code","8b21e477":"code","7bfb2cc2":"code","93279a2b":"code","7b46f26e":"code","28512fba":"code","11fea63c":"code","24dba123":"code","c188abfa":"code","7b7b1eb7":"code","68f5900a":"code","764d1efd":"code","e840cbaa":"code","b5e8a34d":"code","1c7d15a7":"code","2526297e":"code","ba3079ce":"code","61c4f00f":"code","2f9d17e7":"code","8bdb3717":"code","0ae50964":"code","57a56f6b":"code","67e45d8e":"code","5f11753a":"code","586a7098":"markdown","865b05fe":"markdown","0233cc9c":"markdown","fd1319ad":"markdown","3c959210":"markdown","a5f76f70":"markdown","40410b6b":"markdown","30b3fd7e":"markdown","e4624242":"markdown","842e1a98":"markdown"},"source":{"340c85b9":"import tensorflow as tf\nimport numpy as np\nimport pandas as pd\nimport os\nimport matplotlib.pyplot as plt\n%matplotlib inline","30045c00":"train_labels = pd.read_csv('..\/input\/game-of-deep-learning-ship-datasets\/train\/train.csv')\ntrain_labels['category'] = train_labels['category'] - 1\ntrain_labels.head()","f3802567":"X = []\ny = []\npath = \"..\/input\/game-of-deep-learning-ship-datasets\/train\/images\/\"\nimg_shape = 128\nfor i in train_labels.iterrows() :\n    img_path = os.path.join(path, i[1]['image'])\n    img = tf.keras.preprocessing.image.load_img(img_path, target_size=(img_shape,img_shape), interpolation='lanczos')\n    img = tf.keras.preprocessing.image.img_to_array(img)\n    X.append(img)\n    y.append(float(i[1]['category']))\nX = np.asarray(X)\ny = np.asarray(y)\nX.shape, y.shape","6e89bdd1":"X = X \/ 255.0","ea942b7d":"plt.imshow(X[1000])\nplt.title(y[1000])","ad22d284":"model = tf.keras.models.Sequential([\n    tf.keras.layers.Input((img_shape,img_shape,3)),\n    tf.keras.applications.MobileNet(include_top=False, weights='imagenet'),\n    tf.keras.layers.Conv2D(3, 3, padding='same', activation='sigmoid'),\n    tf.keras.layers.Flatten(),\n    tf.keras.layers.Dense(5, activation='softmax')\n])\n\nmodel.compile(loss='sparse_categorical_crossentropy', optimizer=tf.keras.optimizers.Adam(1e-4), metrics=['accuracy'])\n\nmodel.summary()","6a77edbb":"model.fit(X, y, epochs=50, batch_size=128, validation_split=0.25, shuffle=True)","07a84a13":"model.evaluate(X,y)","5c4221f3":"labels_inv = {'Cargo': 0,\n              'Military': 1,\n              'Carrier': 2,\n              'Cruise': 3,\n              'Tankers': 4}\nlabels = {v:k for k,v in labels_inv.items()}\nlabels","02f32f12":"def predict(path) :\n    img = tf.keras.preprocessing.image.load_img(path, target_size=(img_shape,img_shape), interpolation='lanczos')\n    img = tf.keras.preprocessing.image.img_to_array(img)\n    img = img \/ 255.0\n    pred = model.predict(np.array([img]))\n    plt.imshow(img)\n    pred_label = np.argsort(pred)\n    for i in pred_label[0][-1:-3:-1] :\n        print(f\"{labels[i]} Ship : {pred[0][i]*100:0.2f} %\")","c5e02b20":"!wget https:\/\/upload.wikimedia.org\/wikipedia\/commons\/thumb\/1\/1c\/MAERSK_MC_KINNEY_M%C3%96LLER_%26_MARSEILLE_MAERSK_%2848694054418%29.jpg\/1200px-MAERSK_MC_KINNEY_M%C3%96LLER_%26_MARSEILLE_MAERSK_%2848694054418%29.jpg","c262c6ab":"predict(\".\/1200px-MAERSK_MC_KINNEY_M\u00d6LLER_&_MARSEILLE_MAERSK_(48694054418).jpg\") # Cargo Ship Example from Internet","6c3a1f09":"!wget https:\/\/media.architecturaldigest.com\/photos\/593829315838160353567328\/master\/pass\/mscworldclass.jpg","815f1bd7":"predict(\".\/mscworldclass.jpg\") # Cruise Ship Example from Internet","30821545":"!wget https:\/\/images.livemint.com\/img\/2020\/07\/06\/600x338\/USaircraftcarriers-k59B--621x414@LiveMint_1594024838759.jpg","8b21e477":"predict(\".\/USaircraftcarriers-k59B--621x414@LiveMint_1594024838759.jpg\") # Military Ship Example from Internet","7bfb2cc2":"!wget https:\/\/www.dnv.com\/Images\/KP_Tan_269_Tanker_vessel_tcm71-192023.jpg","93279a2b":"predict(\".\/KP_Tan_269_Tanker_vessel_tcm71-192023.jpg\") # Tanker Ship Example from Internet","7b46f26e":"!wget https:\/\/images02.military.com\/sites\/default\/files\/2020-02\/uss-independence-eastern-pacific-1800.jpg","28512fba":"predict(\".\/uss-independence-eastern-pacific-1800.jpg\")","11fea63c":"!wget https:\/\/cdn.britannica.com\/34\/94834-050-16DB7EEB\/USS-Carl-Vinson-aircraft-carrier-US-Navy-2005.jpg","24dba123":"predict(\".\/USS-Carl-Vinson-aircraft-carrier-US-Navy-2005.jpg\")","c188abfa":"!wget https:\/\/chantiers-atlantique.com\/wp-content\/uploads\/2021\/05\/Page-Activite%CC%81s-BPC-N33-G-A-NASSER-25-5-1-min-1980x840.jpg","7b7b1eb7":"predict(\".\/Page-Activite\u0301s-BPC-N33-G-A-NASSER-25-5-1-min-1980x840.jpg\")","68f5900a":"!wget https:\/\/img.theweek.in\/content\/dam\/week\/news\/india\/images\/2020\/2\/19\/kavaratti-grse.jpg","764d1efd":"predict(\".\/kavaratti-grse.jpg\")","e840cbaa":"!wget https:\/\/upload.wikimedia.org\/wikipedia\/commons\/7\/75\/INS_Mumbai_%28D62%29_underway.jpg","b5e8a34d":"predict(\".\/INS_Mumbai_(D62)_underway.jpg\")","1c7d15a7":"!wget https:\/\/www.theenterpriseworld.com\/wp-content\/uploads\/2021\/03\/suez-canal-ship-stuck.jpg","2526297e":"predict(\".\/suez-canal-ship-stuck.jpg\")","ba3079ce":"sub = pd.read_csv(\"..\/input\/game-of-deep-learning-ship-datasets\/sample_submission_ns2btKE.csv\")\nsub.head()","61c4f00f":"X_sub = []\npath = \"..\/input\/game-of-deep-learning-ship-datasets\/train\/images\/\"\nimg_shape = 128\nfor i in sub.iterrows() :\n    img_path = os.path.join(path, i[1]['image'])\n    img = tf.keras.preprocessing.image.load_img(img_path, target_size=(img_shape,img_shape), interpolation='lanczos')\n    img = tf.keras.preprocessing.image.img_to_array(img)\n    img = img \/ 255.0\n    X_sub.append(img)\nX_sub = np.asarray(X_sub)\nX_sub.shape","2f9d17e7":"sub.shape","8bdb3717":"y_sub_cat = model.predict(X_sub)\ny_sub = np.argmax(y_sub_cat, axis=1)\ny_sub.shape","0ae50964":"sub['category'] = y_sub + 1","57a56f6b":"sub['category'].value_counts()","67e45d8e":"sub.to_csv('submission.csv', index=False)","5f11753a":"import IPython.display as p\np.FileLink('.\/submission.csv')","586a7098":"# **Defining labels for prediction**","865b05fe":"# **Helper Function for Prediction**","0233cc9c":"# **Loading and Pre Processing the Data**","fd1319ad":"# **Codes for getting Submission File for the Competition**","3c959210":"# **Creating a Deep Learning model using Keras**","a5f76f70":"# **Evaluating the model on whole dataset**","40410b6b":"# **Training the Deep Learning Model**","30b3fd7e":"# **Import Required Libraries**","e4624242":"# **Testing the model on various data obtained from Intrnet**","842e1a98":"# **Viewing Sample Images from the Dataset**"}}