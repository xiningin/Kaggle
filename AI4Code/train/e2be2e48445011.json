{"cell_type":{"74b57ddc":"code","e16aba4a":"code","3dc33994":"code","d984acdf":"code","c541c238":"code","188369b6":"code","60573144":"code","776a51c6":"code","d9614ee9":"code","97ec7d75":"code","3fce920c":"code","1fcda8f9":"markdown"},"source":{"74b57ddc":"# import required libraries\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport random as rnd","e16aba4a":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\nDATASET_PATH = os.path.join(dirname, filename)\ndataset = pd.read_csv(DATASET_PATH)\nprint('\\nData(First 5 rows):')\nprint(dataset.head())\nprint('\\n Summary of Data:')\nprint(dataset.describe())","3dc33994":"# plot the data\nfig, axs = plt.subplots(1, 3)\naxs[0].plot(dataset['TV'], dataset['Sales'], 'rx')\naxs[1].plot(dataset['Radio'], dataset['Sales'], 'rx')\naxs[2].plot(dataset['Newspaper'], dataset['Sales'], 'rx')","d984acdf":"# plot for better understanding\n# Sales and TV vary linearly\nplt.figure()\nplt.plot(dataset['TV'], dataset['Sales'], 'rx')\nplt.xlabel('TV')\nplt.ylabel('Sales')\nplt.show()","c541c238":"# turn dataframe to numpy array for segregation of data\ndata = dataset.values\ndata = np.array([(data[:, 0]), (data[:, 3])])\ndata = np.transpose(data)\ntrain_x = []\ntrain_y = []\ncv_x = []\ncv_y = []\ntest_x = []\ntest_y = []\nfig = plt.figure()","188369b6":"# parameters\ncv_ratio = 0.2\ntest_ratio = 0.2\nalpha = 0.000007\niters = 500\n# weight = 0.054\n# bias = 6.948\nweight = 0.1\nbias = 7\nlambda_r = 1000","60573144":"# split the data into train, cv, test sets\ndef split(data, cv_ratio, test_ratio):\n    # print(np.shape(data))\n    index_list = []\n    for i in range(int(cv_ratio * 100)):\n        index = rnd.randrange(0, len(data))\n        index_list.append(index)\n        cv_x.append(data[index, 0])\n        cv_y.append(data[index, 1])\n    data_n = np.delete(data, index_list, 0)\n    # print(np.shape(data_n))\n    index_list = []\n    for i in range(int(test_ratio * 100)):\n        index = rnd.randrange(0, len(data_n))\n        index_list.append(index)\n        test_x.append(data_n[index, 0])\n        test_y.append(data_n[index, 1])\n    data_nw = np.delete(data_n, index_list, 0)\n    # print(np.shape(data_nw))\n    for i in range(len(data_nw)):\n        train_x.append(data_nw[i, 0])\n        train_y.append(data_nw[i, 1])","776a51c6":"# call split functions and convert the arrays from lists to numpy arrays\nsplit(data, cv_ratio, test_ratio)\ntrain_x = np.array(train_x)\ntrain_y = np.array(train_y)\ncv_x = np.array(cv_x)\ncv_y = np.array(cv_y)\ntest_x = np.array(test_x)\ntest_y = np.array(test_y)","d9614ee9":"# creating model\ndef model(x, y, flag):\n    cost_iter = []\n    m = len(x)\n    global weight\n    global bias\n    for i in range(iters):\n        y_pred = (x * weight) + bias\n        loss = y_pred - y\n        if flag == 1:\n            cost = ((sum(pow(loss, 2)) \/ (2 * m)) +\n                    ((lambda_r * pow(weight, 2)) \/ (2 * m)))\n        else:\n            cost = (sum(pow(loss, 2)) \/ (2 * m))\n        cost_iter.append(cost)\n        w_grad = (sum(np.multiply(loss, x))) \/ m\n        b_grad = (sum(loss)) \/ m\n        weight -= (alpha * w_grad)\n        bias = bias - (alpha * b_grad)\n\n    for i in range(iters):\n        plt.plot(i, cost_iter[i], 'rx')\n    plt.xlabel(\"No of iterations\")\n    plt.ylabel(\"Cost\")\n    plt.show()\n    # if m == 20:\n    #     print(sum(cost_iter)\/iters)","97ec7d75":"def model_test(x, y):\n    m = len(x)\n    global weight\n    global bias\n    y_pred = (x * weight) + bias\n    loss = y_pred - y\n    cost = (sum(pow(loss, 2)) \/ (2 * m))\n    print('\\n Cost of test Set:', cost)\n    plt.plot(x, y, 'rx')\n    plt.plot(x, y_pred)\n    plt.show()\n    # print('Accuracy of model:', accuracy)","3fce920c":"# traning model\nmodel(train_x, train_y, 0)\nmodel(cv_x, cv_y, 1)\n\n# test model\nmodel_test(test_x, test_y)","1fcda8f9":"# Linear Regression on Advertising Dataset\n**A simple Linear Regression (LR) ML algorithm on the Advertising dataset from Kaggle. Made with numpy and pandas library from scratch with LR algorithms**"}}