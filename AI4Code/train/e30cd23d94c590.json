{"cell_type":{"05205392":"code","fe94ba9b":"code","af8d4aea":"code","65a4b21d":"code","05f67520":"code","41d88219":"code","280d6eb9":"code","cc138bd9":"code","b9f9d2d2":"code","4755974a":"code","5d040caa":"code","601e4135":"code","53030560":"code","a604ebff":"code","14c57f8b":"code","1a9428a2":"code","cef47d25":"code","aff77afa":"code","70219db1":"code","86375450":"markdown","9bfd5d8b":"markdown","b8bce8d0":"markdown","0119438b":"markdown","57d62447":"markdown"},"source":{"05205392":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport plotly.express as px\nimport plotly.graph_objs as go\n\n#Ignore warnings\nimport warnings\nwarnings.filterwarnings('ignore')\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","fe94ba9b":"!pip install dabl","af8d4aea":"#Code by Usharengaraju  https:\/\/www.kaggle.com\/usharengaraju\/widsdatathon2021-catboost-starter\n\nimport dabl\nfrom pandas_profiling import ProfileReport\nfrom catboost import Pool, cv, CatBoostClassifier, CatBoostRegressor\n\nfrom sklearn.metrics import mean_squared_error, classification_report\nfrom sklearn.preprocessing import LabelEncoder\n\nfrom sklearn.model_selection import train_test_split\n\n       \nimport gc\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn import metrics\npd.set_option('max_rows', 300)\nimport re\n\npd.set_option('display.max_columns', 300)\nnp.random.seed(566)\npd.set_option('display.max_rows', 200)\npd.set_option('display.width', 1000)\npd.set_option('display.float_format', '{:20,.2f}'.format)\npd.set_option('display.max_colwidth', -1)","65a4b21d":"#Code by Usharengaraju  https:\/\/www.kaggle.com\/usharengaraju\/widsdatathon2021-catboost-starter\n\nTARGET_COL = \"Class\/ASD\"\ntrain = pd.read_csv(\"\/kaggle\/input\/autism-prediction\/Autism-prediction\/train.csv\")\nprint(train.shape)\ntest = pd.read_csv(\"\/kaggle\/input\/autism-prediction\/Autism-prediction\/test.csv\")\nprint(test.shape)","05f67520":"dabl.clean(train)","41d88219":"cols_to_drop=['age_desc', 'relation']\ntrain=train.drop(cols_to_drop,axis=1)\ntrain.columns","280d6eb9":"dabl.plot(train, \"Class\/ASD\")","cc138bd9":"#Code by Usharengaraju  https:\/\/www.kaggle.com\/usharengaraju\/widsdatathon2021-catboost-starter\n\ntrainprofile = ProfileReport(train,'EDA')","b9f9d2d2":"trainprofile","4755974a":"#Code by Usharengaraju  https:\/\/www.kaggle.com\/usharengaraju\/widsdatathon2021-catboost-starter\n\n## Print the categorical columns\nprint([c for c in train.columns if (1<train[c].nunique()) & (train[c].dtype != np.number)& (train[c].dtype != int) ])","5d040caa":"categorical_cols =  ['gender', 'ethnicity', 'jaundice', 'austim', 'contry_of_res', 'used_app_before']","601e4135":"#Code by Usharengaraju  https:\/\/www.kaggle.com\/usharengaraju\/widsdatathon2021-catboost-starter\n\n## Handle na values\ntrain[categorical_cols] = train[categorical_cols].fillna(\"\")\ntest[categorical_cols] = test[categorical_cols].fillna(\"\")\n\ntrain[categorical_cols].isna().sum()","53030560":"#Code by Usharengaraju  https:\/\/www.kaggle.com\/usharengaraju\/widsdatathon2021-catboost-starter\n\n## Train Test split and remove Target values\nX_train = train.drop([TARGET_COL],axis=1)\ny_train = train[TARGET_COL]","a604ebff":"cols_to_drop=['age_desc', 'relation']\ntest=test.drop(cols_to_drop,axis=1)\ntest.columns","14c57f8b":"#Code by Usharengaraju  https:\/\/www.kaggle.com\/usharengaraju\/widsdatathon2021-catboost-starter\n\n## catBoost Pool object\ntrain_pool = Pool(data=X_train,label = y_train,cat_features=categorical_cols)","1a9428a2":"#Code by Usharengaraju  https:\/\/www.kaggle.com\/usharengaraju\/widsdatathon2021-catboost-starter\n\nmodel_basic = CatBoostClassifier(verbose=False,iterations=50)#,learning_rate=0.1, task_type=\"GPU\",)\nmodel_basic.fit(train_pool, plot=True,silent=True)\nprint(model_basic.get_best_score())","cef47d25":"#More than an hour. I'll commment it too Usha.\n#Code by Usharengaraju  https:\/\/www.kaggle.com\/usharengaraju\/widsdatathon2021-catboost-starter\n\n### hyperparameter tuning example grid for catboost : \n#grid = {'learning_rate': [0.04, 0.1],\n#        'depth': [7, 11],\n#         'l2_leaf_reg': [1, 3,9],\n#        \"iterations\": [500],\n#       \"custom_metric\":['Logloss', 'AUC']}\n\n#model = CatBoostClassifier()\n\n## can also do randomized search - more efficient typically, especially for large search space - `randomized_search`\n#grid_search_result = model.grid_search(grid, \n#                                      train_pool,\n#                                      plot=True,\n#                                      refit = True, #  refit best model on all data\n#                                      partition_random_seed=42)\n\n#print(model.get_best_score())","aff77afa":"#Code by Usharengaraju  https:\/\/www.kaggle.com\/usharengaraju\/widsdatathon2021-catboost-starter\n\ntest[TARGET_COL] = model_basic.predict(test,prediction_type='Probability')[:,1]","70219db1":"#Code by Usharengaraju  https:\/\/www.kaggle.com\/usharengaraju\/widsdatathon2021-catboost-starter\n\ntest[[\"ID\",\"Class\/ASD\"]].to_csv(\"sample_submission.csv\",index=False)","86375450":"#Where is the column age_desc After dabl clean??\n\nSince I didn't find out how to deal with that CatBoostError: Bad value for num_feature[non_default_doc_idx=0,feature_idx=20]=\"?\": Cannot convert 'b'?'' to float\n\nI decide to drop the suspicious columns. And will make a Discussion topic.","9bfd5d8b":"#Since I didn't find out how to deal with that CatBoostError: Bad value for num_feature[non_default_doc_idx=0,feature_idx=20]=\"?\": Cannot convert 'b'?'' to float\n\nI decide to drop the suspicious columns. And will make a Discussion topic.","b8bce8d0":"EDA with dabl","0119438b":"#Acknowledgement\n\nUsharengaraju  https:\/\/www.kaggle.com\/usharengaraju\/widsdatathon2021-catboost-starter","57d62447":"![](https:\/\/ichef.bbci.co.uk\/news\/976\/cpsprodpb\/3B4D\/production\/_103918151_autismgfx.png)bbc.com"}}