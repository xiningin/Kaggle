{"cell_type":{"7bb39cae":"code","b58a0818":"code","b04f0c11":"code","76dea974":"code","8fdaf6ac":"code","e1b9df83":"code","b07ae825":"code","855443cc":"code","8b8a9dd2":"code","35abbe7f":"code","0421ba3f":"code","7445e30c":"code","156e018b":"code","097eee75":"code","2191ef3a":"code","57e1ae48":"code","aab7d7e5":"code","b347b5e2":"code","6d210eea":"code","331274eb":"code","63ef09a0":"code","d1415cc5":"code","44821593":"code","92d26111":"code","5d03314f":"code","96791ef0":"code","1c42de4a":"markdown","d1c3e232":"markdown","0d3173fc":"markdown","63155bbd":"markdown","4be8e08a":"markdown","361bdf5a":"markdown","99557305":"markdown","ea320172":"markdown","c06417f9":"markdown","7030d581":"markdown","6fb38288":"markdown","8f0961f0":"markdown","b8bdb318":"markdown","53aa3fdf":"markdown","e6e43441":"markdown"},"source":{"7bb39cae":"#Import all necessary libraries\nimport numpy as np#import all necessary libraries\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","b58a0818":"#Data overview\ndf=pd.read_csv(\"..\/input\/sonar-dataset-suitable-for-classification\/sonar.all-data.csv\")","b04f0c11":"df.head()","76dea974":"df.shape","8fdaf6ac":"df.info()","e1b9df83":"df[\"Label\"].value_counts(normalize=True)","b07ae825":"plt.figure(figsize=(8,5))\nsns.countplot(data=df,x=\"Label\")\nplt.title(\"distribution of label\")","855443cc":"X= df.drop('Label', axis=1)\ny= df['Label']","8b8a9dd2":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.30, random_state=41)","35abbe7f":"from sklearn.preprocessing import StandardScaler\nscaler=StandardScaler()\nscaler.fit(X_train)\nscaled_X_train=scaler.transform(X_train)\nscaled_X_test=scaler.transform(X_test)","0421ba3f":"from sklearn.neighbors import KNeighborsClassifier\nknn_model=KNeighborsClassifier(n_neighbors=1)\nknn_model.fit(scaled_X_train,y_train)","7445e30c":"y_pred=knn_model.predict(scaled_X_test)\npd.DataFrame({\"y_test\":y_test,\"y_pred\":y_pred})","156e018b":"from sklearn.metrics import classification_report,confusion_matrix,accuracy_score","097eee75":"accuracy_score(y_test,y_pred)","2191ef3a":"confusion_matrix(y_test,y_pred)","57e1ae48":"print(classification_report(y_test,y_pred))","aab7d7e5":"test_error_rate=[]\n\nfor k in range(1,40):\n    knn_model=KNeighborsClassifier(n_neighbors=k)\n    knn_model.fit(scaled_X_train,y_train)\n    y_pred_test=knn_model.predict(scaled_X_test)\n    \n    test_error=1-accuracy_score(y_test,y_pred_test)\n    test_error_rate.append(test_error)\n    ","b347b5e2":"test_error_rate","6d210eea":"plt.figure(figsize=(10,6))\nplt.plot(range(1,40),test_error_rate,label=\"Test Error\")\nplt.legend()\nplt.ylabel(\"Error Rate\")\nplt.xlabel(\"K Value\")","331274eb":"scaler=StandardScaler()\nknn=KNeighborsClassifier()\noperations=[(\"scaler\",scaler),(\"knn\",knn)]","63ef09a0":"from sklearn.pipeline import Pipeline\npipe=Pipeline(operations)","d1415cc5":"from sklearn.model_selection import GridSearchCV#use a grid search to find the best k_value\nk_values=list(range(1,30))\nparam_grid={'knn__n_neighbors':k_values}\nfull_cv_classifier=GridSearchCV(pipe,param_grid,cv=10,scoring='accuracy')","44821593":"full_cv_classifier.fit(X_train,y_train)","92d26111":"full_cv_classifier.best_estimator_.get_params()","5d03314f":"scaler=StandardScaler()\nknn1=KNeighborsClassifier(n_neighbors=1)\noperations=[('scaler',scaler),('knn1',knn1)]\npipe=Pipeline(operations)\npipe.fit(X_train, y_train)\npipe_pred= pipe.predict(X_test)","96791ef0":"print(classification_report(y_test, pipe_pred))","1c42de4a":"# Determine the feature and target lable","d1c3e232":"# Final Model","0d3173fc":"# Evaluating the model","63155bbd":"# **EDA**","4be8e08a":"# Choose K Value With Elbow Method","361bdf5a":"# train the model","99557305":"# Creating a pipeline to find optimum k values","ea320172":"### Sonar (sound navigation ranging) is a technique that uses sound propagation(usually underwater, as in submarine navigation) to navigate, communicate with or detect objects on or under the surface of the water, such as other vessels.\n### The data set contains the response metrics for 60 separate sonar frequencies sent out against a known mine field (and known rocks). These frequencies are then labeled with the known object they were beaming the sound at (either a rock or a mine).\n## Our main goal is to create a machine learning model capable of detecting the difference between a rock or a mine based on the response of the 60 separate sonar frequencies.","c06417f9":"# Predicting test data","7030d581":"### as we see k=4 has the least error compared to the other k values.","6fb38288":"# scaling the features","8f0961f0":"# Elbow Method For Choosing Optimum Value For K","b8bdb318":"# Split the dataset to train and test","53aa3fdf":"### according to our model the best knn neighbors=1.","e6e43441":"### As wee see the Lable is balance.alomost 53% of the data is R and 46% of them is M."}}