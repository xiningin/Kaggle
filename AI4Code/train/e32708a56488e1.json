{"cell_type":{"d992b622":"code","7f72bff1":"code","0e38abf7":"code","8db4f972":"code","99a8877b":"code","ce4bcfbb":"code","0d7b7142":"code","3c871fbc":"code","baf1f006":"code","a959b5fe":"code","568aed3d":"code","2953d981":"code","8949fdcc":"code","f200638f":"code","86f38bfc":"code","02b2e283":"code","8dd8c7b8":"code","b518e76b":"code","195b2d58":"markdown","f258cdc0":"markdown","52252366":"markdown","e3a025c6":"markdown","b5e8d356":"markdown","51242c56":"markdown","22a9888c":"markdown","c12cf348":"markdown","d71a5f1c":"markdown","0058df42":"markdown","0b78d721":"markdown","381734f7":"markdown","72408036":"markdown"},"source":{"d992b622":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","7f72bff1":"import matplotlib.pyplot as plt \nimport seaborn as sns\n\nfrom sklearn.preprocessing import MultiLabelBinarizer\n\nfrom datetime import datetime as dt\n\nfrom itertools import compress","0e38abf7":"nf=pd.read_csv(\"..\/input\/netflix-shows\/netflix_titles.csv\")","8db4f972":"nf.head()","99a8877b":"nf.info()","ce4bcfbb":"nf.drop(\"show_id\",axis=1,inplace=True)\nnf.director.fillna(\"Unknown\",inplace=True)\nnf.dropna(inplace=True)\n\nnf.rename({\"listed_in\":\"genre\"},inplace=True,axis=1)\nnf['country']=nf.country.str.split(\", \",expand=True)[0]\n\n\nnf[[\"duration\",\"duration_type\"]]=nf.duration.str.split(\" \",expand=True)\nnf=nf.astype({\"duration\":\"int64\"})\n\n\nnf.genre=nf.genre.apply(lambda x:x.split(\", \"))\n\nmlb=MultiLabelBinarizer()\ngenre_mlb=pd.DataFrame(\n    mlb.fit_transform(nf.genre),\n    columns=mlb.classes_,\n    index=nf.index).add_prefix(\"genre_\")\n\nnf.drop(\"genre\",axis=1,inplace=True)\n\nnf=pd.concat([nf,genre_mlb],axis=1)\n\n\nnf.date_added=nf.date_added.apply(lambda x:dt.strptime(x.strip(),\"%B %d, %Y\"))\nnf['year_added']=nf.date_added.dt.year\nnf['month_added']=nf.date_added.dt.month\nnf['day_added']=nf.date_added.dt.month\nnf['release_added_diff']=abs(nf.release_year-nf.year_added)\n\ngenre_list=nf.loc[:,nf.columns.str.startswith(\"genre\")].columns\ngenre_list=list(genre_list)\n\nmovie_bool=(nf.loc[nf.type==\"Movie\",genre_list].sum()>0).values\ntv_bool=(nf.loc[nf.type==\"TV Show\",genre_list].sum()>0).values\n\ngenre_list_tv=list(compress(genre_list,tv_bool))\ngenre_list_movie=list(compress(genre_list,movie_bool))\n\nstacked_cast=nf.cast.str.split(\", \",expand=True).stack().reset_index(level=1,drop=True)\nstacked_cast_us=nf.loc[\n    nf.country==\"United States\",\"cast\"].str.split(\", \",expand=True).stack().reset_index(level=1,drop=True)\n\ntop_ten_countries=nf.country.value_counts().index[0:10]\ntop_ten_countries=list(top_ten_countries)","0d7b7142":"fig,axes=plt.subplots(figsize=(12,6))\n\nplt.pie(nf.type.value_counts(),explode=(0.05,0.05),colors=['#66c2a5','#fc8d62'],autopct=\"%1.1f%%\",labels=nf.type.value_counts().index)\nplt.title(\"Movies vs TV Shows\")\nplt.show()","3c871fbc":"fig,ax=plt.subplots(1,2,figsize=(16,8))\n\n\nsns.histplot(ax=ax[0],x=\"duration\",data=nf.loc[nf.type==\"Movie\",:],bins=50)\nsns.histplot(ax=ax[1],x=\"duration\",data=nf.loc[nf.type==\"TV Show\",:],bins=50)","baf1f006":"fig,ax=plt.subplots(figsize=(12,7))\n\nsns.countplot(y=\"country\",hue=\"type\",order=nf.country.value_counts().index[0:10],data=nf,palette=\"Set2\")","a959b5fe":"fig,ax=plt.subplots(figsize=(12,7))\n\nsns.scatterplot(x=nf.release_year,y=nf.year_added,hue=nf.type)\n\nplt.show()","568aed3d":"fig,axes=plt.subplots(figsize=(12,6))\nsns.barplot(\n    x=nf.loc[nf.director!=\"Unknown\",\"director\"].value_counts().values[0:15],\n    y=nf.loc[nf.director!=\"Unknown\",\"director\"].value_counts().index[0:15],palette=\"Set2\")\nplt.title(\"Top 15 Directors Worldwide\")\nplt.ylabel(\"Director\")\nplt.xlabel(\"Movies or TV Shows\")\nplt.show()","2953d981":"fig,ax=plt.subplots(2,1,figsize=(14,12))\nsns.countplot(ax=ax[0],y=stacked_cast,order=stacked_cast.value_counts().index[0:15],palette=\"Set2\")\nsns.countplot(ax=ax[1],y=stacked_cast_us,order=stacked_cast_us.value_counts().index[0:15],palette=\"Set2\")\n\nax[0].set_title(\"Top 15 Cast Members Worldwide\")\nax[1].set_title(\"Top 15 US Cast Members\")\n\nax[0].set_xlabel(\"Number of Titles\")\nax[0].set_ylabel(\"Cast Member\")\nax[1].set_xlabel(\"Number of Titles\")\nax[1].set_ylabel(\"Cast Member\")\nplt.show()","8949fdcc":"fig,ax=plt.subplots(figsize=(12,6))\nsns.countplot(y=nf.country,order=nf.country.value_counts().index[0:15],palette=\"Set2\")\n\nplt.title(\"Top 15 Countries for Movies and TV Shows\")\nplt.xlabel(\"Number of Titles\")\nplt.ylabel(\"Country\")\nplt.show()","f200638f":"fig,ax=plt.subplots(figsize=(12,6))\n\nsns.countplot(y=\"year_added\",hue=\"type\",data=nf,palette=\"Set2\")\nplt.show()","86f38bfc":"nf.loc[:,genre_list+[\"rating\"]].groupby(\"rating\").sum().transpose().style.background_gradient()","02b2e283":"fig,ax=plt.subplots(figsize=(12,6))\n\nsns.countplot(y=\"rating\",hue=\"type\",data=nf,palette=\"Set2\")","8dd8c7b8":"pd.crosstab(nf.year_added,nf.month_added).style.background_gradient()","b518e76b":"nf.loc[nf.country.isin(top_ten_countries),\n    genre_list+[\"country\"]].groupby(\"country\").sum().transpose().style.background_gradient()","195b2d58":"# Distribution of Duration","f258cdc0":"# Visualization","52252366":"# Preparation","e3a025c6":"# Top 10 Countries by Movie and TV Genre","b5e8d356":"# Top 15 Countries for Movies and TV Shows","51242c56":"# Movies and TV Shows by Top 10 Countries","22a9888c":"# Content Added by Year and Month","c12cf348":"# Top 15 Cast Members Worldwide and US","d71a5f1c":"# Distribution of Ratings","0058df42":"# Content Added by Year","0b78d721":"# Rating by Genre","381734f7":"# Pie Chart: Movies vs TV Shows","72408036":"# Top 15 Directors Worldwide"}}