{"cell_type":{"8d2897f5":"code","a74fa420":"code","270e4bd2":"code","21b17100":"code","1c7434fc":"code","b4edd0a1":"code","9bd9c6ba":"code","1b18691f":"code","ca0d2c0c":"code","ac2e7d5c":"code","ff803ad0":"code","0a35500f":"code","4130d026":"markdown","f4ec77cb":"markdown","ae2ab126":"markdown","91af470c":"markdown"},"source":{"8d2897f5":"import torch\nimport torch.nn as nn\nimport torch.nn.functional as F\nfrom transformers import pipeline","a74fa420":"from transformers import AutoTokenizer, AutoModelForSequenceClassification","270e4bd2":"model = AutoModelForSequenceClassification.from_pretrained(model_name)\ntokenizer = AutoTokenizer.from_pretrained(model_name)","21b17100":"model_name = \"distilbert-base-uncased-finetuned-sst-2-english\"","1c7434fc":"classifier = pipeline(\"sentiment-analysis\", model=model, tokenizer=tokenizer)","b4edd0a1":"res = classifier([\"I am pleased to show your transformers library\", \"I sure hope you dont hate it\"])","9bd9c6ba":"print(res)","1b18691f":"X_train = [\"I am pleased to show your transformers library\", \"I sure hope you dont hate it\"]\n","ca0d2c0c":"batch = tokenizer(X_train, padding=True, truncation=True, max_length=512, return_tensors=\"pt\")\nbatch","ac2e7d5c":"with torch.no_grad():\n    outputs = model(**batch)\n    print(outputs)\n    \n    predictions = F.softmax(outputs.logits, dim=1)\n    print(predictions)\n    \n    labels = torch.argmax(predictions, dim=1)\n    print(labels)\n    \n    labels = [model.config.id2label[label_id] for label_id in labels.tolist()]\n    print(labels)\n    \n    \n    ","ff803ad0":"save_directory = \"saved\"\ntokenizer.save_pretrained(save_directory)\nmodel.save_pretrained(save_directory)","0a35500f":"tokenizer = AutoTokenizer.from_pretrained(save_directory)\nmodel = AutoModelForSequenceClassification.from_pretrained(save_directory)","4130d026":"# Hugging face \n:hugging: ","f4ec77cb":"from https:\/\/www.youtube.com\/watch?v=GSt00_-0ncQ","ae2ab126":"fine tuning example: https:\/\/colab.research.google.com\/github\/huggingface\/notebooks\/blob\/master\/transformers_doc\/pytorch\/training.ipynb","91af470c":"Checking various hugging face pipelines [here](https:\/\/huggingface.co\/transformers\/main_classes\/pipelines.html)"}}