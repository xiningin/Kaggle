{"cell_type":{"dc004954":"code","06c41ff8":"code","f092d308":"code","bdb0ebeb":"code","df6b7066":"code","06ced745":"code","969f904c":"code","b4f802e9":"code","acd377fe":"code","c2311f9b":"code","b4a6561f":"code","6c3707c8":"code","af0e1388":"code","98e14df7":"code","da7b6ab0":"code","7adfee5e":"markdown","d96746ca":"markdown","9171da6c":"markdown","5317d5f6":"markdown","e98f9ae8":"markdown","b381b582":"markdown","091142b8":"markdown"},"source":{"dc004954":"# Import the necessary libs\nfrom keras.models import Model\nfrom keras.layers import Input, Dense, Activation\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.preprocessing import OneHotEncoder\nimport pandas as pd ","06c41ff8":"# Load the dataset\ngames = pd.read_csv('..\/input\/video-game-sales-with-ratings\/Video_Games_Sales_as_at_22_Dec_2016.csv')\ngames.head()","f092d308":"games = games.drop(['Name', 'Year_of_Release', 'Other_Sales', 'Global_Sales', 'Developer'], 1)\ngames.head()","bdb0ebeb":"# Drop some outliers. I'm not will remove the Japan Sales for the dataset not be too small\ngames = games.loc[games['NA_Sales'] > 1]\ngames = games.loc[games['EU_Sales'] > 1]\ngames.shape","df6b7066":"# Remove NA values\ngames = games.dropna(axis=0)\ngames.shape","06ced745":"games.head()","969f904c":"# The features are 'Platform', 'Genre', 'Publisher','Critic_Score', 'Critic_Count', 'User_Score', 'User_Count', 'Rating'\nX = games.iloc[:, [0, 1, 2, 6, 7, 8, 9, 10]].values\n\n# In this case, there are 3 targets, one for each continent\ny_na = games['NA_Sales'].values\ny_eu = games['EU_Sales'].values\ny_jp = games['JP_Sales'].values","b4f802e9":"# Using OneHotEncoder to transform the features into dummy variables\nohencoder = ColumnTransformer(transformers=[('OneHot', OneHotEncoder(),\n                                            [0, 1, 2, 7])], remainder='passthrough')\nX = ohencoder.fit_transform(X).toarray()","acd377fe":"# Creating the input layer\n# 60 is the number of columns in the X.\nmy_input = Input(shape=(60, ))","c2311f9b":"# Creating first hidden layer\n# (input shape + number of outputs) \/ 2 = (60 + 3) \/ 2 = 32 rounded\n# It's necessary to say which layer the hidden layer is connected to. In that case, the input layer\nmy_hidden_layer_1 = Dense(units=32, activation='sigmoid')(my_input)","b4a6561f":"# Creating second hidden layer\nmy_hidden_layer_2 = Dense(units=32, activation='sigmoid')(my_hidden_layer_1)","6c3707c8":"# Create the output layers, one for each continent\n# The activation function \"linear\" keeps the output values\nmy_output_layer_1 = Dense(units=1, activation='linear')(my_hidden_layer_2)\nmy_output_layer_2 = Dense(units=1, activation='linear')(my_hidden_layer_2)\nmy_output_layer_3 = Dense(units=1, activation='linear')(my_hidden_layer_2)","af0e1388":"# Create the model with the inputs and outputs\nmy_model = Model(inputs=my_input,\n                outputs=[my_output_layer_1, my_output_layer_2, my_output_layer_3])","98e14df7":"#Compile the model\nmy_model.compile(optimizer='adam', loss='mse')","da7b6ab0":"# Fit the model\nmy_model.fit(X, [y_na, y_eu, y_jp], epochs=7000, batch_size=100)","7adfee5e":"## 3. Encoding the features","d96746ca":"## 2. Now, select the features and the targets","9171da6c":"## Preprocessing phase completed. Now, we will construct the neural network","5317d5f6":"### 1. In this part, i will preprocess the data, removing unecessary columns. It's a didatic model, so I drop the Name, Yar_of_Release, Other_Sales and Global_Sales (because we just want the continent sales).","e98f9ae8":"# <div align=\"center\"> Hello people, everything all right?  <\/div>\n#### ** This is a tutorial of how to create a simple neural network with Keras for predict video games sales per continent. I'm NOT focusing in data analysis here, only on the simple preprocess the data and create the model.**\n![](https:\/\/media.giphy.com\/media\/d2Z7NqwF3yImFNHW\/giphy-downsized.gif)","b381b582":"### Neural network done.\n### For more info, consult the Keras Documentation clicking [here](https:\/\/keras.io\/)\n### I hope this tutorial is useful. Reviews are welcome","091142b8":"## The process takes a little time and the code output is great; so, feel free to skip to the end result."}}