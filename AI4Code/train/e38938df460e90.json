{"cell_type":{"8b482c42":"code","0448877b":"code","434d2975":"code","6c59c708":"code","5b2a2bf4":"code","fc450584":"code","a0760a52":"code","9f452f8a":"code","94acbf81":"code","3125db33":"code","a7942de3":"code","5e58a45a":"code","007610f2":"code","0961e156":"code","d713b7f2":"code","7debaf34":"code","4137418d":"code","7f58e4ff":"code","dcbd90b8":"code","7d488e38":"code","7aa6c32e":"code","eef6d2bc":"code","476aa906":"code","006d7b01":"code","4f46eaef":"code","9f19a7ba":"code","d7c7615f":"markdown","23677fbb":"markdown","2ef7c13e":"markdown","6c1c7396":"markdown","96077bf7":"markdown","195a7dac":"markdown","4ea339e5":"markdown","b94208c0":"markdown","c032df08":"markdown","0ec5d93c":"markdown","2e21a261":"markdown","db382770":"markdown","9d88d7c6":"markdown","ba24a316":"markdown","6409f8b6":"markdown","e96414b2":"markdown","f26a39fc":"markdown","98c60929":"markdown","14da9f7b":"markdown","a89386d6":"markdown","d0109b13":"markdown","ec059167":"markdown","1cd00d0b":"markdown","70378279":"markdown","b83a428e":"markdown"},"source":{"8b482c42":"# importing the packages\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\n# loading data and looking at its shape, columns\noriginal_df = pd.read_csv(\"..\/input\/world-foodfeed-production\/FAO.csv\", encoding=\"latin1\")\noriginal_df.shape","0448877b":"original_df.columns","434d2975":"# a few adjustments to the column names for easier future manipulation\nnew_col_names = []\nfor column in original_df.columns:\n    column = column.replace(\"Y\", \"\")\n    column = column.replace(\" \", \"_\")\n    column = column.lower()\n    new_col_names.append(column)\noriginal_df.columns = new_col_names\noriginal_df.columns","6c59c708":"# melting the data to turn it into a long format\n# getting rid of the 'code' columns\nmelted_df = pd.melt(original_df,\n                           id_vars=['area', 'item', 'element'], \n                           value_vars=['1961','1962', '1963', '1964', '1965', '1966', '1967', '1968', '1969', '1970','1971', '1972', '1973', '1974', '1975', \n                                       '1976', '1977', '1978', '1979','1980', '1981', '1982', '1983', '1984', '1985', '1986', '1987', '1988','1989', '1990', \n                                       '1991', '1992', '1993', '1994', '1995', '1996', '1997', '1998', '1999', '2000', '2001', '2002', '2003', '2004', '2005', \n                                       '2006','2007', '2008', '2009', '2010', '2011', '2012', '2013'],\n                           var_name=\"year\", value_name=\"production\"\n                            )\nmelted_df.shape","5b2a2bf4":"print(melted_df.head(3))","fc450584":"melted_df.dtypes","a0760a52":"# grouping the DataFrame by year \nyearly_prod = melted_df.groupby(\"year\", as_index=False).agg({\"production\":\"sum\"})\n\n# plotting\nplt.style.use(\"fivethirtyeight\")\nplt.figure(figsize=(12,6))\nplt.rcParams.update({'font.size': 12})\n\n_ = sns.lineplot(x=\"year\", y=\"production\", data=yearly_prod)\n\nplt.title(\"Evolution of Total Food Items Production in the World\")\nplt.xlabel(\"Year\")\nplt.ylabel(\"Production, billion tonnes\")\nplt.yticks([0, 4000000, 6000000, 8000000, 10000000, 12000000], [\"0\", \"4\", \"6\", \"8\", \"10\", \"12\"])\nplt.xticks(rotation=90)\nplt.grid(b=None)\nplt.show()","9f452f8a":"# creating a grouped DataFrame but this time with an 'element' column\nyearly_prod_element = melted_df.groupby([\"year\", \"element\"], as_index=False).agg({\"production\":\"sum\"})\n\n# plotting\nplt.figure(figsize=(12,6))\n\n_ = sns.lineplot(x=\"year\", y=\"production\", hue=\"element\", data=yearly_prod_element, hue_order=[\"Food\", \"Feed\"])\n\nplt.title(\"Evolution of Total Food and Feed Production in the World\")\nplt.xlabel(\"Year\")\nplt.ylabel(\"Production, billion tonnes\")\nplt.yticks([0, 2000000, 4000000, 6000000, 8000000, 10000000], [\"0\", \"2\", \"4\", \"6\", \"8\", \"10\"])\nplt.xticks(rotation=90)\nplt.grid(b=None)\nplt.show()","94acbf81":"def df_filter(df, column, value):\n    \"\"\"a quick function that filters a data frame based on the values in one of its columns\"\"\"\n    filtered_df = df[df[column]==value]\n    return filtered_df","3125db33":"# checking if there is data under USSR\nussr = df_filter(melted_df, \"area\", \"USSR\")\nussr.shape","a7942de3":"# checking if there was any data under Russian Federation (instead of the USSR name) prior to 1991\nrussia = df_filter(melted_df, \"area\", \"Russian Federation\")\nrussia_1989 = df_filter(russia, \"year\", \"1989\")\nrussia_1992 = df_filter(russia, \"year\", \"1992\")\nprint(russia[\"production\"].values[:4], russia_1989[\"production\"].values[:4], russia_1992[\"production\"].values[:4])","5e58a45a":"poland = df_filter(melted_df, \"area\", \"Poland\")\nprint(df_filter(poland, \"year\", \"1970\").iloc[0, -1])\nprint(df_filter(poland, \"year\", \"1992\").iloc[0, -1])","007610f2":"latvia = df_filter(melted_df, \"area\", \"Latvia\")\nprint(df_filter(latvia, \"year\", \"1970\").iloc[0, -1])\nprint(df_filter(latvia, \"year\", \"1992\").iloc[0, -1])","0961e156":"# creating a by-country DataFrame and taking the top 5 countries\nyearly_prod_country = melted_df.groupby(\"area\", as_index=False).agg({\"production\":\"sum\"}).sort_values(by=\"production\", ascending=False)\nyearly_prod_country_top5 = yearly_prod_country.head(5)\n\n# plotting\nplt.figure(figsize=(6,3))\n\n_ = sns.barplot(x=\"production\", y=\"area\", data=yearly_prod_country_top5, color=\"darkgreen\")\n\nplt.title(\"Five Biggest Food Producers during 1961-2013\")\nplt.ylabel(\"\")\nplt.xlabel(\"Production, million tonnes\")\nplt.grid(b=None, which=\"minor\")\n\nplt.show()","d713b7f2":"# creating a list of top 5 countries\ntop5_names = [\"China, mainland\", \"United States of America\", \"India\", \"Brazil\", \"Germany\"]\ntop5_var = []\n\n# looping over them to create 5 filtered DataFrames\nfor country in top5_names:\n    country_var = df_filter(melted_df, \"area\", country).groupby([\"area\", \"year\"], as_index=False).agg({\"production\":\"sum\"})\n    top5_var.append(country_var)\n    \n# plotting    \nplt.figure(figsize=(12,6))\n\nfor country in top5_var:\n    sns.lineplot(x=\"year\", y=\"production\", data=country, label=country.iloc[0, 0])\n\nplt.legend(loc=\"center left\")\nplt.title(\"Evolution of Food Production for the Top Five\")\nplt.xlabel(\"Year\")\nplt.ylabel(\"Production, million tonnes\")\nplt.yticks([0, 500000, 1000000, 1500000, 2000000, 2500000, 3000000], [\"0\", \"0.5\", \"1\", \"1.5\", \"2\", \"2.5\", \"3\"])\nplt.xticks(rotation=90)\nplt.grid(b=None)\n\nplt.show()","7debaf34":"# reading the dataset and doing some cleaning\npop_df = pd.read_csv(\"..\/input\/faostat-population\/FAO_population.csv\", encoding=\"latin1\")\npop_df.shape","4137418d":"pop_df.columns","7f58e4ff":"# cleaning up column names\npop_df.columns = [column.lower() for column in pop_df.columns]\npop_df = pop_df.loc[:, [\"area\", \"year\", \"value\"]]\npop_df.columns = [\"area\", \"year\", \"population\"]\npop_df.head(2)","dcbd90b8":"pop_df.dtypes","7d488e38":"# transforming the year column into string format to be in line with melted_df\npop_df[\"year\"] = pop_df[\"year\"].astype(str)","7aa6c32e":"# creating a series of values for China's food production and population\n# checking if they have the same shape\nchina_prod = top5_var[0][\"production\"]\nchina_pop = df_filter(pop_df, \"area\", \"China, mainland\")[\"population\"]\nprint(china_prod.shape, china_pop.shape)","eef6d2bc":"# plotting the relationship between food production and population growth\nplt.figure(figsize=(10,6))\n\n_ = sns.regplot(china_prod, china_pop, color=\"darkgreen\", scatter_kws={\"s\": 90}, fit_reg=False)\n\nplt.title(\"Are food production and population growth in China related?\")\nplt.xlabel(\"Food production, million tonnes\")\nplt.ylabel(\"Population, millions\")\nplt.xticks([500000, 1000000, 1500000, 2000000, 2500000, 3000000, 3500000], [\"0.5\", \"1\", \"1.5\", \"2\", \"2.5\", \"3\", \"\"])\nplt.yticks([700000, 800000, 900000, 1000000, 1100000, 1200000, 1300000, 1400000, 1500000], [\"700\", \"800\", \"900\", \"1000\", \"1 100\", \"1 200\", \"1 300\", \"1 400\", \"\"])\nplt.grid(b=None)","476aa906":"corr_china = np.corrcoef(china_prod, china_pop)\nprint(\"The correlation between China's food production and population figures: {}\".format(round(corr_china[0,1],2)))","006d7b01":"# creating a grouped DataFrame on item and element\nby_item_df = melted_df.groupby([\"item\", \"element\"], as_index=False).agg({\"production\":\"sum\"}).sort_values(by=\"production\", ascending=False)\n\n# creating a DataFrame for food element only, extracting the top 10\nby_item_df_food = df_filter(by_item_df, \"element\", \"Food\")\ntop10_food_items= by_item_df_food.iloc[:9, :]\n\n# creating a DataFrame for feed element only, extracting the top 10\nby_item_df_feed = df_filter(by_item_df, \"element\", \"Feed\")\ntop10_feed_items = by_item_df_feed.iloc[:9, :]","4f46eaef":"# plotting the top 10 food items\nfigure = plt.figure(figsize=(10,6))\n\n_ = sns.barplot(x=\"production\", y=\"item\", data=top10_food_items, color=\"darkgreen\")\n\nplt.title(\"Top 10 most produced Food items\")\nplt.ylabel(\"\")\nplt.xlabel(\"Production, million tonnes\")\nplt.grid(b=None, which=\"minor\")\n\nplt.show()","9f19a7ba":"# plotting the top 10 feed items\nfigure = plt.figure(figsize=(10,6))\n\n_ = sns.barplot(x=\"production\", y=\"item\", data=top10_feed_items, color=\"darkred\")\n\nplt.title(\"Top 10 most produced Feed items\")\nplt.ylabel(\"\")\nplt.xlabel(\"Production, million tonnes\")\nplt.grid(b=None, which=\"minor\")\n\nplt.show()","d7c7615f":"The scatter plot shows a linear relationship between the two variables. Let's also quickly calculate the correlation between the two.","23677fbb":"## Which food items are most produced?","2ef7c13e":"Let's look at how the total production of food items changed over the given period of time.","6c1c7396":"## Which countries are the biggest food producers?","96077bf7":"So far, we've only looked at overall food and feed production. Let's now explore the top 10 most produced food and feed items.","195a7dac":"### How has the world food production evolved in the past 50 years?","4ea339e5":"Food data was included for Poland as a separate country even when it was still part of the USSR. How about one of the smaller countries, for example, Latvia?","b94208c0":"## Is food production growth in China related to its population growth?","c032df08":"Cereals, maize and starchy roots are what we feed to lievstock and poultry the most. No surprises here.","0ec5d93c":"After running these quick checks, we already see that data prior to 1992 was missing for some USSR countries. It must have been complicated to gather the data due to the difficult socio-economic climate. This creates some gaps in our dataset that were corrected for in 1992.","2e21a261":"The top five includes China, the US, India, Brazil and Germany. We're also interested in the yearly evolution of their total food production.","db382770":"The Food and Agriculture Organization (FAO) is a specialised agency of the United Nations that leads international efforts to defeat hunger. Food Balance Sheet presents a comprehensive picture of the pattern of a country's food supply during a specified reference period.","9d88d7c6":"## Final note","ba24a316":"It looks like USSR was excluded until its collapse in 1991 and data under Russian Federation appears as of 1992. Could it be that USSR countries were included separately from 1961 to 1991? Let's check an example - Poland.","6409f8b6":"We want to see which countries have produced the most food since 1961. We'll go with a top 5.","e96414b2":"### Preparing the data for analysis","f26a39fc":"Wow, what a growth! We've more than doubled our total food production since 1961. Have both food and feed items been growing this much?","98c60929":"Milk products and cereals are at the top of the list. Vegetables take positions #3 and #4. And meat is only #10!","14da9f7b":"While it's interesting to see how food production evolved around the world, is this growth trend correlated with population growth? To explore this question, we've downloaded population data from the FAOSTAT website. We'll look into China as an example.","a89386d6":"Both food and feed items have been growing indeed. Now, where has that spike in 1992 come from? We know that a number of countries \"were born\" around this time: they broke out from the USSR. Thus, the sudden growth could be related to this historical event. However, if there was data under USSR prior to 1991, this hypothesis would not hold. Let's run a couple of checks.","d0109b13":"We've explored a dataset that captures total food and feed available in a given country from 1961 to 2013. We've discovered a substantial growth in world food production during this period of time, especially in China. It seems to be in line with population growth. We mainly produce milk items, cereals and vegetables.","ec059167":"# How has food production evolved since 1961?","1cd00d0b":"### About the data","70378279":"China's production growth from 1991 is much more rapid than what we observe for the other four countries. Suprisingly, the US total production started declining in 2004 and then picked up some growth in 2012.","b83a428e":"The food balance sheet used in this exercice covers 245 countries and territories, from 1961 to 2013. It is focused on two utilisations of each food item available:\n\n- Food - refers to the total amount of the food item available as human food.\n- Feed - refers to the quantity of the food item available for feeding to the livestock and poultry."}}