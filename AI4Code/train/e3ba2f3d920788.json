{"cell_type":{"72314838":"code","8ff7931b":"code","dce64ee4":"code","aefd413f":"code","c26522a1":"code","7d3370c9":"code","dad3c8f3":"code","2f653b08":"code","2615d31e":"code","3d1c1bac":"code","99b50a47":"code","5032385b":"code","21ca6ac3":"code","dd07291c":"code","ed275aa9":"code","d79b319f":"code","ee69e122":"code","6ee2d0e6":"code","b432ad99":"code","2c5cd3e8":"code","b7164392":"code","c6102845":"code","abdebc3d":"code","22f479e2":"code","e5a1e06d":"code","1303e8cb":"code","bb58bcce":"code","bf0f05e5":"code","53b9d212":"code","1ec1eb85":"code","b93b7d7a":"code","229b4cef":"code","29e34b95":"code","64a2d264":"markdown","c3e79824":"markdown","009bf650":"markdown","6ab54160":"markdown","a97592bb":"markdown"},"source":{"72314838":"import numpy as np\nimport pylab as pl\nimport pandas as pd\nimport matplotlib.pyplot as plt \n%matplotlib inline\nimport seaborn as sns\nfrom sklearn.utils import shuffle\nfrom sklearn.svm import SVC\nfrom sklearn.metrics import confusion_matrix,classification_report\nfrom sklearn.model_selection import cross_val_score, GridSearchCV\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","8ff7931b":"train = pd.read_csv(\"..\/input\/covid19-global-forecasting-week-2\/train.csv\")\ntest = pd.read_csv(\"..\/input\/covid19-global-forecasting-week-2\/test.csv\")","dce64ee4":"train.info()\ntrain[0:10]","aefd413f":"fig = plt.figure(figsize=(16,8))\nax = fig.add_subplot(111)\ntrain.groupby('Date').mean().sort_values(by='ConfirmedCases', ascending=False)['ConfirmedCases'].plot('bar', color='r',width=0.3,title='Date Confirmed Cases', fontsize=10)\nplt.xticks(rotation = 90)\nplt.ylabel('Date')\nax.title.set_fontsize(30)\nax.xaxis.label.set_fontsize(10)\nax.yaxis.label.set_fontsize(10)\nprint(train.groupby('Date').mean().sort_values(by='ConfirmedCases', ascending=False)['ConfirmedCases'][[1,2]])\nprint(train.groupby('Date').mean().sort_values(by='ConfirmedCases', ascending=False)['ConfirmedCases'][[4,5,6]])","c26522a1":"train = train[['Country_Region','Date','ConfirmedCases','Fatalities']]\ntrain.head()","7d3370c9":"#Country_Region top 30\ntrain.Country_Region.value_counts()[0:30].plot(kind='bar')\nplt.show()","dad3c8f3":"fig = plt.figure(figsize=(16,8))\nax = fig.add_subplot(111)\ntrain.groupby('Country_Region').mean().sort_values(by='ConfirmedCases', ascending=False)['ConfirmedCases'].plot('bar', color='r',width=0.3,title='Country Region Confirmed Cases', fontsize=10)\nplt.xticks(rotation = 90)\nplt.ylabel('Confirmed Cases')\nax.title.set_fontsize(30)\nax.xaxis.label.set_fontsize(10)\nax.yaxis.label.set_fontsize(10)\nprint(train.groupby('Country_Region').mean().sort_values(by='ConfirmedCases', ascending=False)['ConfirmedCases'][[1,2]])\nprint(train.groupby('Country_Region').mean().sort_values(by='ConfirmedCases', ascending=False)['ConfirmedCases'][[4,5,6]])","2f653b08":"fig = plt.figure(figsize=(16,8))\nax = fig.add_subplot(111)\ntrain.groupby('Country_Region').mean().sort_values(by='Fatalities', ascending=False)['Fatalities'].plot('bar', color='r',width=0.3,title='Country Region Fatalities', fontsize=8)\nplt.xticks(rotation = 90)\nplt.ylabel('Confirmed Cases')\nax.title.set_fontsize(30)\nax.xaxis.label.set_fontsize(10)\nax.yaxis.label.set_fontsize(10)\nprint(train.groupby('Country_Region').mean().sort_values(by='Fatalities', ascending=False)['Fatalities'][[1,2]])\nprint(train.groupby('Country_Region').mean().sort_values(by='Fatalities', ascending=False)['Fatalities'][[4,5,6]])","2615d31e":"print(\"Any missing sample in training set:\",train.isnull().values.any())\nprint(\"Any missing sample in test set:\",test.isnull().values.any(), \"\\n\")","3d1c1bac":"#US\nConfirmedCases_date_US = train[train['Country_Region']=='US'].groupby(['Date']).agg({'ConfirmedCases':['sum']})\nfatalities_date_US = train[train['Country_Region']=='US'].groupby(['Date']).agg({'Fatalities':['sum']})\ntotal_date_US = ConfirmedCases_date_US.join(fatalities_date_US)\n\n\n#China\nConfirmedCases_date_China = train[train['Country_Region']=='China'].groupby(['Date']).agg({'ConfirmedCases':['sum']})\nfatalities_date_China = train[train['Country_Region']=='China'].groupby(['Date']).agg({'Fatalities':['sum']})\ntotal_date_China = ConfirmedCases_date_China.join(fatalities_date_China)\n\n#Italy\nConfirmedCases_date_Italy = train[train['Country_Region']=='Italy'].groupby(['Date']).agg({'ConfirmedCases':['sum']})\nfatalities_date_Italy = train[train['Country_Region']=='Italy'].groupby(['Date']).agg({'Fatalities':['sum']})\ntotal_date_Italy = ConfirmedCases_date_Italy.join(fatalities_date_Italy)\n\n#Australia\nConfirmedCases_date_Australia = train[train['Country_Region']=='Australia'].groupby(['Date']).agg({'ConfirmedCases':['sum']})\nfatalities_date_Australia = train[train['Country_Region']=='Australia'].groupby(['Date']).agg({'Fatalities':['sum']})\ntotal_date_Australia = ConfirmedCases_date_Australia.join(fatalities_date_Australia)\n\n\n\nplt.figure(figsize=(15,10))\nplt.subplot(2, 2, 1)\ntotal_date_US.plot(ax=plt.gca(), title='US')\nplt.ylabel(\"Confirmed  cases\", size=13)\n\nplt.subplot(2, 2, 2)\ntotal_date_China.plot(ax=plt.gca(), title='China')\n\nplt.subplot(2, 2, 3)\ntotal_date_Italy.plot(ax=plt.gca(), title='Italy')\nplt.ylabel(\"Confirmed cases\", size=13)\n\nplt.subplot(2, 2, 4)\ntotal_date_Australia.plot(ax=plt.gca(), title='Australia')\n","99b50a47":"#Indonesia\nConfirmedCases_date_Indonesia = train[train['Country_Region']=='Indonesia'].groupby(['Date']).agg({'ConfirmedCases':['sum']})\nfatalities_date_Indonesia = train[train['Country_Region']=='Indonesia'].groupby(['Date']).agg({'Fatalities':['sum']})\ntotal_date_Indonesia = ConfirmedCases_date_Indonesia.join(fatalities_date_Indonesia)\n\n\n#Malaysia\nConfirmedCases_date_Malaysia = train[train['Country_Region']=='Malaysia'].groupby(['Date']).agg({'ConfirmedCases':['sum']})\nfatalities_date_Malaysia = train[train['Country_Region']=='Malaysia'].groupby(['Date']).agg({'Fatalities':['sum']})\ntotal_date_Malaysia = ConfirmedCases_date_Malaysia.join(fatalities_date_Malaysia)\n\n#Thailand\nConfirmedCases_date_Thailand = train[train['Country_Region']=='Thailand'].groupby(['Date']).agg({'ConfirmedCases':['sum']})\nfatalities_date_Thailand = train[train['Country_Region']=='Thailand'].groupby(['Date']).agg({'Fatalities':['sum']})\ntotal_date_Thailand = ConfirmedCases_date_Thailand.join(fatalities_date_Thailand)\n\n#Singapore\nConfirmedCases_date_Singapore = train[train['Country_Region']=='Singapore'].groupby(['Date']).agg({'ConfirmedCases':['sum']})\nfatalities_date_Singapore = train[train['Country_Region']=='Singapore'].groupby(['Date']).agg({'Fatalities':['sum']})\ntotal_date_Singapore = ConfirmedCases_date_Singapore.join(fatalities_date_Singapore)\n\n\n\nplt.figure(figsize=(15,10))\nplt.subplot(2, 2, 1)\ntotal_date_Indonesia.plot(ax=plt.gca(), title='Indonesia')\nplt.ylabel(\"Confirmed  cases\", size=13)\n\nplt.subplot(2, 2, 2)\ntotal_date_Malaysia.plot(ax=plt.gca(), title='Malaysia')\n\nplt.subplot(2, 2, 3)\ntotal_date_Thailand.plot(ax=plt.gca(), title='Thailand')\nplt.ylabel(\"Confirmed cases\", size=13)\n\nplt.subplot(2, 2, 4)\ntotal_date_Singapore.plot(ax=plt.gca(), title='Singapore')\n","5032385b":"#Vietnam\nConfirmedCases_date_Vietnam = train[train['Country_Region']=='Vietnam'].groupby(['Date']).agg({'ConfirmedCases':['sum']})\nfatalities_date_Vietnam = train[train['Country_Region']=='Vietnam'].groupby(['Date']).agg({'Fatalities':['sum']})\ntotal_date_Vietnam = ConfirmedCases_date_Vietnam.join(fatalities_date_Vietnam)\n\n\n#Philippines\nConfirmedCases_date_Philippines = train[train['Country_Region']=='Philippines'].groupby(['Date']).agg({'ConfirmedCases':['sum']})\nfatalities_date_Philippines = train[train['Country_Region']=='Philippines'].groupby(['Date']).agg({'Fatalities':['sum']})\ntotal_date_Philippines = ConfirmedCases_date_Philippines.join(fatalities_date_Philippines)\n\n#Cambodia\nConfirmedCases_date_Cambodia = train[train['Country_Region']=='Cambodia'].groupby(['Date']).agg({'ConfirmedCases':['sum']})\nfatalities_date_Cambodia = train[train['Country_Region']=='Cambodia'].groupby(['Date']).agg({'Fatalities':['sum']})\ntotal_date_Cambodia = ConfirmedCases_date_Cambodia.join(fatalities_date_Cambodia)\n\n#Laos\nConfirmedCases_date_Laos = train[train['Country_Region']=='Laos'].groupby(['Date']).agg({'ConfirmedCases':['sum']})\nfatalities_date_Laos = train[train['Country_Region']=='Laos'].groupby(['Date']).agg({'Fatalities':['sum']})\ntotal_date_Laos = ConfirmedCases_date_Laos.join(fatalities_date_Laos)\n\n\n\nplt.figure(figsize=(15,10))\nplt.subplot(2, 2, 1)\ntotal_date_Vietnam.plot(ax=plt.gca(), title='Vietnam')\nplt.ylabel(\"Confirmed  cases\", size=13)\n\nplt.subplot(2, 2, 2)\ntotal_date_Philippines.plot(ax=plt.gca(), title='Philippines')\n\nplt.subplot(2, 2, 3)\ntotal_date_Cambodia.plot(ax=plt.gca(), title='Cambodia')\nplt.ylabel(\"Confirmed cases\", size=13)\n\nplt.subplot(2, 2, 4)\ntotal_date_Laos.plot(ax=plt.gca(), title='Laos')\n\n","21ca6ac3":"#Brunei\nConfirmedCases_date_Brunei = train[train['Country_Region']=='Brunei'].groupby(['Date']).agg({'ConfirmedCases':['sum']})\nfatalities_date_Brunei = train[train['Country_Region']=='Brunei'].groupby(['Date']).agg({'Fatalities':['sum']})\ntotal_date_Brunei = ConfirmedCases_date_Brunei.join(fatalities_date_Brunei)\n\n\n#Myanmar\n#ConfirmedCases_date_Myanmar = train[train['Country_Region']=='Myanmar'].groupby(['Date']).agg({'ConfirmedCases':['sum']})\n#fatalities_date_Myanmar = train[train['Country_Region']=='Myanmar'].groupby(['Date']).agg({'Fatalities':['sum']})\n#total_date_Myanmar = ConfirmedCases_date_Myanmar.join(fatalities_date_Myanmar)\n\n\n\n\nplt.figure(figsize=(15,10))\nplt.subplot(2, 2, 1)\ntotal_date_Brunei.plot(ax=plt.gca(), title='Brunei')\nplt.ylabel(\"Confirmed  cases\", size=13)\n\n#plt.subplot(2, 2, 2)\n#total_date_Myanmar.plot(ax=plt.gca(), title='Myanmar')\n\n\n","dd07291c":"train['Date'] = pd.to_datetime(train['Date'])\ntest['Date'] = pd.to_datetime(test['Date'])\n","ed275aa9":"train.info()","d79b319f":"train['Date'] = train['Date'].astype('int64')\ntest['Date'] = test['Date'].astype('int64')","ee69e122":"train.info()","6ee2d0e6":"from sklearn.preprocessing import LabelEncoder\nle = LabelEncoder()\ndef FunLabelEncoder(df):\n    for c in df.columns:\n        if df.dtypes[c] == object:\n            le.fit(df[c].astype(str))\n            df[c] = le.transform(df[c].astype(str))\n    return df","b432ad99":"train = FunLabelEncoder(train)\ntrain.info()\ntrain.iloc[235:300,:]","2c5cd3e8":"test = FunLabelEncoder(test)\ntest.info()\ntest.iloc[235:300,:]","b7164392":"#Frequency distribution of classes\"\ntrain_outcome = pd.crosstab(index=train[\"ConfirmedCases\"],  # Make a crosstab\n                              columns=\"count\")      # Name the count column\n\ntrain_outcome","c6102845":"#Frequency distribution of classes\"\ntrain_outcome = pd.crosstab(index=train[\"Fatalities\"],  # Make a crosstab\n                              columns=\"count\")      # Name the count column\n\ntrain_outcome","abdebc3d":"#Select feature column names and target variable we are going to use for training\nfeatures=['Date','Country_Region']\ntarget = 'ConfirmedCases'","22f479e2":"#This is input which our classifier will use as an input.\ntrain[features].head(10)","e5a1e06d":"#Display first 10 target variables\ntrain[target].head(100).values","1303e8cb":"from sklearn.ensemble import RandomForestClassifier\n\n# We define the model\nrfcla = RandomForestClassifier(n_estimators=100, random_state=42,n_jobs=-1)\n# We train model\nrfcla.fit(train[features],train[target])","bb58bcce":"#Make predictions using the features from the test data set\npredictions = rfcla.predict(test[features])\n\npredictions","bf0f05e5":"#Select feature column names and target variable we are going to use for training\nfeatures1=['Date','Country_Region']\ntarget1 = 'Fatalities'","53b9d212":"#This is input which our classifier will use as an input.\ntrain[features1].head(10)","1ec1eb85":"from sklearn.ensemble import RandomForestClassifier\n\n# We define the model\nrfcla = RandomForestClassifier(n_estimators=100, random_state=42,n_jobs=-1)\n                             \n                            \n# We train model\nrfcla.fit(train[features1],train[target1])","b93b7d7a":"#Make predictions using the features from the test data set\npredictions1 = rfcla.predict(test[features1])\n\nprint(predictions1[0:50])","229b4cef":"#Create a  DataFrame\nsubmission = pd.DataFrame({'ForecastId':test['ForecastId'],'ConfirmedCases':predictions,'Fatalities':predictions1})\n                        \n\n#Visualize the first 10 rows\nsubmission.head(10)","29e34b95":"#Convert DataFrame to a csv file that can be uploaded\n#This is saved in the same directory as your notebook\nfilename = 'submission.csv'\n\nsubmission.to_csv(filename,index=False)\n\nprint('Saved file: ' + filename)","64a2d264":"data transformation","c3e79824":"COVID-19 cases in US, China, Italy, UK","009bf650":"COVID-19 cases  in ASEAN states","6ab54160":"#Fatalities","a97592bb":"#ConfirmedCases"}}