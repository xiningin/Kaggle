{"cell_type":{"50a0b7ce":"code","e75639de":"code","71aee988":"code","49e54dc7":"code","7c70c6a3":"code","1a173e1e":"code","79cfafd3":"code","5cab80a1":"code","399d9112":"code","6ef3f271":"code","4ec575e2":"markdown","07749cd0":"markdown","dfa7837e":"markdown","89fa1273":"markdown","01e978b4":"markdown","7173feee":"markdown","d4e629b5":"markdown","f124ccf0":"markdown","d3aaed02":"markdown","127f4dc8":"markdown"},"source":{"50a0b7ce":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns \nimport sqlite3","e75639de":"pwd = '..\/input\/ipldatabase\/'\ndatabase = pwd + 'database.sqlite'","71aee988":"conn = sqlite3.connect(database)\n\ntables = pd.read_sql(\"\"\"\n\nSELECT * \nFROM sqlite_master\nWHERE type='table';\n\n\"\"\", conn)\ntables","49e54dc7":"matches = pd.read_sql(\"\"\"\n\nSELECT *\nFROM Match;\n\n\"\"\", conn)\nmatches","7c70c6a3":"table_joined = pd.read_sql(\"\"\"\n\nSELECT a.Match_Id, \n        b.Team_Name Home_Team,\n        c.Team_Name Away_Team,\n        a.Match_Date,\n        d.Season_Year, \n        v.Team_Name Toss_Winner \nFROM Match a\n\nLEFT JOIN Team b\nON a.Team_1 = b.Team_Id\n\nLEFT JOIN Team c\nON a.Team_2 = c.Team_Id\n\nLEFT JOIN Season d\nON a.Season_Id = d.Season_Id\n\nLEFT JOIN Team v\nON a.Toss_Winner = v.Team_Id\n\n;\"\"\", conn)\n\ntable_joined","1a173e1e":"table_joined.dtypes","79cfafd3":"table_joined['Match_Id'] = table_joined['Match_Id'].astype('string') \ntable_joined['Match_Date'] = pd.to_datetime(table_joined['Match_Date'])\ntable_joined.dtypes","5cab80a1":"print('From',table_joined['Match_Date'].min().strftime('%Y'), 'to', table_joined['Match_Date'].max().strftime('%Y'))","399d9112":"most_win = table_joined.groupby('Toss_Winner')['Toss_Winner'].count().sort_values(ascending=False)\npd.DataFrame(most_win).style.background_gradient(cmap='Blues')","6ef3f271":"plt.figure(figsize=(20,8))\n\n# sns.countplot(x='Toss_Winner', data=table_join)\nsns.countplot(x='Toss_Winner', \n              data=table_joined, \n              palette=\"Blues_r\",\n              order=table_joined['Toss_Winner'].value_counts().index)\n\nplt.title('Teams that won the competition the most', fontsize=15)\nplt.xticks(rotation=90, fontsize=12)\nplt.show()","4ec575e2":"<center>\n    <h2 style=\"color:white; background:#252f67\">\n        <br\/>\n        Visualizations\n        <br\/>\n        <br\/>\n    <\/h2>\n<\/center>\n","07749cd0":"<center>\n    <h2 style=\"color:white; background:#252f67\">\n        <br\/>\n        Access SQL Database Tables\n        <br\/>\n        <br\/>\n    <\/h2>\n<\/center>\n","dfa7837e":"![2019-IPL-Final-2 (1).jpg](attachment:8d73ca8d-7f37-4279-97a6-f46aae32eb2f.jpg)","89fa1273":"<div>\n    <br\/>\n    <br\/>\n    <br\/>\n    <br\/>\n    <br\/>\n    <br\/>\n    <br\/>\n    <br\/>\n    <br\/>\n    <br\/>\n    <br\/>\n    <br\/>\n    <center style=\"font-weight:bold;font-size:50px;\">Let's Start<\/center>\n    <br\/>\n    <br\/>\n    <br\/>\n    <br\/>\n    <br\/>\n    <br\/>\n    <br\/>\n    <br\/>\n    <br\/>\n    <br\/>\n    <br\/>\n    <br\/>\n    <br\/>\n    <br\/>\n<\/div>\n","01e978b4":"<div style=\"color:white; background:#252f67\">\n    <center><br\/><br\/><br\/>\n        <div style=\"font-size:30px;font-weight:bold\">\n            Keywords\n            <br\/>\n        <\/div>\n        <span style=\"font-size:20px;font-weight:lighter\">SQL, Python, Cricket, Pandas, Mumbai Indians, Bar plot<\/span>\n    <br\/>\n    <br\/>\n    <br\/>\n    <br\/>\n    <br\/>\n    <\/center>\n<\/div>\n","7173feee":"<center>\n    <h2 style=\"color:white; background:#252f67\">\n        <br\/>\n        Data Types\n        <br\/>\n        <br\/>\n    <\/h2>\n<\/center>\n","d4e629b5":"<center>\n    <h2 style=\"color:white; background:#252f67\">\n        <br\/>\n        The Main Join Query\n        <br\/>        \n        <br\/>\n    <\/h2>\n<\/center>\n","f124ccf0":"![Blue and Red Books Clean Graphic Sales and Promos Business and Retail Back to School Banner-min.jpg](attachment:d8aa622d-5c8d-4e4d-a4e8-5afd312af01d.jpg)","d3aaed02":"<div style=\"color:white; background:#252f67\">\n    <center><br\/><br\/><br\/>\n        <div style=\"font-size:40px;font-weight:bold\">\n            Support Me and Upvote\n            <br\/>\n        <\/div>\n        <span style=\"font-size:20px;\">For More <br\/><span style=font-weight:bold>::One Question Analysis::<\/span><br\/>Check Out My Other Kagglebooks<br\/><br\/>\n        <\/span>\n        <a style=\"font-size:50px;font-family:Oswald;text-decoration:underline;color:white;\" href=\"https:\/\/www.linkedin.com\/in\/taricov\">Taric Ov<br\/><br\/>        \n        <\/a>\n    <\/center>\n<\/div>\n","127f4dc8":"<div style=\"color:white; background:#252f67\">\n    <center><br\/><br\/><br\/>\n        <div style=\"font-size:40px;font-weight:bold\">\n            One Question Analysis\n            <br\/>\n        <\/div>\n        <span style=\"font-size:20px;\">I live by questions and my approach is simple<br\/> I ask a question then swing all the way to find an answer<br\/>Therefore every kagglebook is a case, and every case is a question<br\/><span style=\"background:white;color:#252f67;font-weight:bold;line-height:4;\">&nbsp;So I am clean, I am short, I am to the point&nbsp;<\/span><\/span>\n    <br\/>\n    <br\/>\n    <br\/>\n    <br\/>\n    <br\/>\n    <\/center>\n<\/div>\n"}}