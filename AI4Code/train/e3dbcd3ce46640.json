{"cell_type":{"809891e3":"code","82fb651a":"code","5f1dc7e4":"code","28af5f90":"code","c7d26ab2":"code","93d55a8e":"code","28eecb67":"code","aee54315":"code","e1927545":"code","9d625a2d":"code","0bf9ee5c":"code","16a24e63":"code","9a9e7723":"code","1478031d":"code","b239987d":"code","07986f32":"code","b347f8e8":"code","21effecb":"code","fe52a979":"code","4b08e3e2":"code","5fb1ae13":"code","601b4608":"code","b100113b":"code","aa2d1d50":"code","8545cff1":"code","3628a9c5":"code","3bfa647c":"code","3d17dbb9":"code","62e879fe":"code","3b6291d0":"code","a46b8356":"code","ae52f55b":"code","d64dec31":"code","c5c11b1e":"code","54df6cdf":"code","47c14a66":"code","ffa207b0":"code","9ee003a9":"code","36af725f":"code","2b0d8404":"code","5b0d3594":"code","0fca3afb":"code","c77096da":"code","c8f2f64a":"code","5232806a":"code","38ce224e":"code","b33a107f":"code","851b6b84":"code","0af9ce1d":"code","a4147349":"code","801a825c":"code","71fdc5bd":"code","c5ea6e9c":"code","a5eac410":"code","20614462":"code","52c957d1":"code","20e7eafa":"code","f870dae8":"code","01afb375":"code","f8597d38":"code","ca256d54":"code","6e1827d9":"code","673c97be":"markdown"},"source":{"809891e3":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","82fb651a":"# Sample=pd.read_csv('ParticipantData_BTPC\\Sample Submission.csv')","5f1dc7e4":"# Sample[Sample['time_spent']!=0]","28af5f90":"train=pd.read_csv('..\/input\/buyerss-time-prediction\/Train.csv')","c7d26ab2":"# train=pd.read_csv('ParticipantData_BTPC\\Train.csv')\ntest=pd.read_csv('..\/input\/buyerss-time-prediction\/Test.csv')","93d55a8e":"train.head()","28eecb67":"test","aee54315":"train.columns","e1927545":"train.info()","9d625a2d":"train.describe()","0bf9ee5c":"train.session_number.nunique()\n#clustering factor","16a24e63":"train['client_agent'].nunique()","9a9e7723":"sns.pairplot(train)","1478031d":"train['client_agent'].value_counts().head(10)","b239987d":"train['client_agent']=train['client_agent'].astype(str)\nfrequency= pd.Series(' '.join(train['client_agent']).split()).value_counts()\nfrequency[:10]","07986f32":"train['device_details'].nunique()","b347f8e8":"train['device_details'].value_counts()","21effecb":"train['time_spent']","fe52a979":"device=0\ntrain['device_details']=train['device_details'].astype(str)\ntest['device_details']=test['device_details'].astype(str)\ndef func(dev):\n    if 'Desktop' in dev:\n        device=1\n        #Desktop=1\n    elif 'iPhone' in dev or 'iPad' in dev:\n        device=2\n        #ios=2\n    elif 'Android' in dev:\n        #android=3\n        device=3\n    else:\n        device=4\n    return device\n        #others=4\ntrain['device']=train['device_details'].apply(lambda x: func(x))\ntest['device']=test['device_details'].apply(lambda x: func(x))","4b08e3e2":"time_per_device=train.groupby('device_details').sum()['time_spent']\ntime_per_device","5fb1ae13":"time_per_device=train.groupby('device').sum()['time_spent']\ntime_per_device","601b4608":"#optimize above one create fuction and create such column for test as well.\n# sns.distplot(train['device'])\nplt.hist(train['device'])","b100113b":"train.columns","aa2d1d50":"train.date","8545cff1":"train['date']=pd.to_datetime(train['date'])","3628a9c5":"train['date'].dt.dayofweek.value_counts()","3bfa647c":"train['day']=train['date'].dt.dayofweek","3d17dbb9":"train.columns","62e879fe":"df=train.groupby('session_number').sum()\ntime_by_session=train.groupby('session_number').sum()['time_spent']\ntime_by_session","3b6291d0":"# create a facet grid\nsns.lmplot(x='session_number',y='time_spent',data=train,hue='purchased')","a46b8356":"df[:10] #top 10 purchases","ae52f55b":"df.reset_index().plot(x='session_number',y='time_spent')","d64dec31":"df[df['purchased']==0]","c5c11b1e":"train.groupby('session_number').max()","54df6cdf":"temp=train.corr()\n#so there is not much dependability between time spent and day column\ntemp","47c14a66":"train.drop('day',axis=1,inplace=True)","ffa207b0":"sns.heatmap(temp)","9ee003a9":"#Linear Regression","36af725f":"train.columns","2b0d8404":"train.drop(['session_id','client_agent','device_details','date'],axis=1,inplace=True)\ntrain\nX=train.drop('time_spent',axis=1)\ny=train['time_spent']","5b0d3594":"from sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split","0fca3afb":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=101)","c77096da":"lm=LinearRegression()","c8f2f64a":"lm.fit(X_train,y_train)","5232806a":"print(lm.intercept_,lm.coef_)","38ce224e":"prediction=lm.predict(X_test)","b33a107f":"plt.scatter(y_test,prediction)","851b6b84":"sns.distplot(y_test-prediction)","0af9ce1d":"from sklearn import metrics\nfrom sklearn.metrics import accuracy_score","a4147349":"print('MAE:',(metrics.mean_absolute_error(y_test,prediction)))\nprint('RMSE:',np.sqrt(metrics.mean_squared_error(y_test,prediction)))\nprint('RMSLE:',np.sqrt(metrics.mean_squared_log_error(y_test,prediction)))\n","801a825c":"test_data=test.drop(['session_id','client_agent','device_details','date'],axis=1,inplace=True)","71fdc5bd":"linear_prediction=lm.predict(test)\nmodel1=pd.DataFrame({'time_spent':linear_prediction})\nmodel1","c5ea6e9c":"#Random forest regressor","a5eac410":"from sklearn.ensemble import RandomForestRegressor","20614462":"rfr=RandomForestRegressor(n_estimators =300)","52c957d1":"rfr.fit(X_train,y_train)","20e7eafa":"predict=rfr.predict(X_test)","f870dae8":"sns.distplot(y_test-predict)","01afb375":"rfr.score(X_test,predict)","f8597d38":"print('RMSLE:',np.sqrt(metrics.mean_squared_log_error(y_test,predict)))","ca256d54":"RandomForest_prediction=rfr.predict(test)\nmodel2=pd.DataFrame({'time_spent':RandomForest_prediction})\nmodel2","6e1827d9":"#ThankYou","673c97be":"### Modelling"}}