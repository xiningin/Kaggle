{"cell_type":{"b83a5958":"code","a368ed77":"code","ffa8314c":"code","57de7c5f":"code","88a6f1dd":"code","14694c37":"code","a2886259":"code","8ebcdfe5":"code","6891d90f":"markdown"},"source":{"b83a5958":"import numpy as np\nimport os\nimport matplotlib.pyplot as plt\nimport tensorflow as tf\nimport tensorflow_hub as hub","a368ed77":"model = hub.load('https:\/\/tfhub.dev\/google\/magenta\/arbitrary-image-stylization-v1-256\/2')","ffa8314c":"def load_image(img_path):\n    img = tf.io.read_file(img_path)\n    img = tf.image.decode_image(img, channels = 3)\n    img = tf.image.convert_image_dtype(img, tf.float32)\n    img = img[tf.newaxis ,:]\n    return img","57de7c5f":"content_image = load_image('..\/input\/gan-getting-started\/photo_jpg\/01135e4771.jpg')\nstyle_image = load_image('..\/input\/the-metropolitan-museum-of-art-ukiyoe-dataset\/images\/Katsushika_Hokusai\/MET-39799.jpg')","88a6f1dd":"stylized_image = model(tf.constant(content_image), tf.constant(style_image))[0]","14694c37":"plt.figure(figsize = (18,6))\n\nplt.subplot(1,3,1)\nplt.title(\"content_image\")\nplt.imshow(np.squeeze(content_image))\nplt.axis('off')\n\nplt.subplot(1,3,2)\nplt.title(\"style_image\")\nplt.imshow(np.squeeze(style_image))\nplt.axis('off')\n\nplt.subplot(1,3,3)\nplt.title(\"stylized_image\")\nplt.imshow(np.squeeze(stylized_image))\nplt.axis('off')\nplt.show()\n","a2886259":"data_dir='..\/input\/gan-getting-started\/photo_jpg\/'\npaths=[]\nfor im in os.listdir(data_dir):\n        paths+=[os.path.join(data_dir,im)]","8ebcdfe5":"for i in range(10):\n    content_image = load_image(paths[i])\n    stylized_image = model(tf.constant(content_image), tf.constant(style_image))[0]\n    plt.figure(figsize = (12,6))\n    plt.subplot(1,2,1)\n    plt.title(\"content_image \"+str(i+1))\n    plt.imshow(np.squeeze(content_image))\n    plt.axis('off')\n    plt.subplot(1,2,2)\n    plt.title(\"stylized_image \"+str(i+1))\n    plt.imshow(np.squeeze(stylized_image))\n    plt.axis('off')\n    plt.show()","6891d90f":"https:\/\/colab.research.google.com\/github\/tensorflow\/hub\/blob\/master\/examples\/colab\/tf2_arbitrary_image_stylization.ipynb"}}