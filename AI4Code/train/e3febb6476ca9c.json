{"cell_type":{"7e0d1be3":"code","837bffe2":"code","289732ea":"code","ec91970c":"code","491169a2":"code","7e4f8629":"code","3d9caf3c":"code","d5a22cfe":"code","aaa22412":"code","1bdf8657":"code","823ab1c9":"code","ca16f569":"code","6e3666ec":"code","03dfcc90":"code","2f46cfde":"code","2fdaa970":"code","9a4028e5":"code","12d906bb":"code","118e3657":"code","53dde201":"code","71585f5c":"code","8ecb92e2":"code","8c554d03":"markdown","43241d69":"markdown","af56c9db":"markdown","9d85cdaf":"markdown","3ad09735":"markdown","e031dd17":"markdown","342a7e4c":"markdown","92897e4e":"markdown"},"source":{"7e0d1be3":"# Import necessary libraries\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom scipy import stats\nfrom pandas.plotting import table\nimport datetime as dt\nimport warnings\nwarnings.filterwarnings(\"ignore\")","837bffe2":"# Load the dataset\nData = pd.read_csv(\"..\/input\/msft-dataset\/MSFT.csv\")","289732ea":"Data.head()","ec91970c":"Data.tail()","491169a2":"Data.info()","7e4f8629":"Data.shape","3d9caf3c":"Data.dtypes","d5a22cfe":"Data.columns","aaa22412":"Data['Date'] = pd.to_datetime(Data['Date'])","1bdf8657":"# Get initial descriptive statistics\nData.describe(include=\"all\")","823ab1c9":"plt.plot(Data['Date'], Data['Close'])\nplt.show()","ca16f569":"# Before proceeding, check for NULL values. If found, perform imputation\nData.isnull().values.sum() # In this case, it is 0. So, we can proceed","6e3666ec":"# A glimpse of how the market shares varied over the given time\n\n# Create a list for numerical columns that are to be visualized\nColumn_List = ['Open', 'High', 'Low', 'Close', 'Adj Close', 'Volume']\n\n# Plot to view the same\nData.plot(x = \"Date\", y = Column_List, subplots = True, layout = (3, 3), figsize = (15, 15), sharex = False, title = \"Stock Value Trend from 2010 - 2012\", rot = 90)","03dfcc90":"# Visualize the spread and skweness through the distribution plot\n\n# Use the Column_List : list initialized above in the following steps\nfig, ax = plt.subplots(len(Column_List), figsize = (15, 10))\n\nfor i, col_list in enumerate(Column_List):\n    sns.distplot(Data[col_list], hist = True, ax = ax[i])\n    ax[i].set_title (\"Frequency Distribution of\" + \" \" + col_list, fontsize = 10)\n    ax[i].set_xlabel (col_list, fontsize = 8)\n    ax[i].set_ylabel ('Distribution Value', fontsize = 8)\n    fig.tight_layout (pad = 1.1) # To provide space between plots\n    ax[i].grid('on') # Enabled to view and make markings","2f46cfde":"import seaborn as sns\nplt.figure(figsize=(12,6))\nautoDataColumns = ['Open','High','Low','Close','Adj Close','Volume']\nsns.heatmap(Data[autoDataColumns].corr(), annot=True, fmt='.6f', linewidths=.5)","2fdaa970":"# View the matrix in a table to identify the numerical values of strengths\ncorr_matrix","9a4028e5":"Data.index = Data['Date']\nplt.figure(figsize=(16,8))\nplt.plot(Data['Close'], label='Close Price History',color='r')\nplt.xlabel('Date',size=20)\nplt.ylabel('Stock Price',size=20)\nplt.title('Stock Price of Microsoft over the Years',size=15)","12d906bb":"# Since the data is a time series data, we should be able to predict the future through forecasting techniques\n\n# Delete the index column due to reset\n#del Data['index']\n\n# Decompose the time series year-wise and month-wise to analyse further\nData['Year'] = Data['Date'].dt.year\nData['Month'] = Data['Date'].dt.month\nData['WeekDay'] = Data['Date'].dt.weekday\n\n# Firstly, plot the data year-wise to see the duration of when it hiked and dipped\nfig, ax = plt.subplots(len(Column_List), figsize = (10, 20))\n\n# Group the data by year and plot\nfor i, col_list in enumerate(Column_List):\n    Data.groupby('Year')[col_list].plot(ax = ax[i], legend = True)\n    ax[i].set_title(\"Stock Price Movement Grouped by Year on\" + \" \" + col_list, fontsize = 10)\n    ax[i].set_ylabel(col_list + \" \" + \"Price\", fontsize = 8)\n    fig.tight_layout(pad = 1.1)\n    ax[i].yaxis.grid(True) # To enable grid only on the Y-axis","118e3657":"# Analyse based on Year\nfor i, col_list in enumerate(Column_List):\n    var = Data.groupby('Year')[col_list].sum()\n    \n# Convert the variable into a pandas dataframe\nvar = pd.DataFrame(var)\n\n# Plot to understand the trend\nplt.figure(figsize = (16, 7))\nax1 = plt.subplot(121)\nvar.plot(kind = \"pie\", y = \"Volume\", legend = False, fontsize = 12, sharex = False, title = \"Time Series Influence on Total Volume Trade by Year\", ax = ax1)\n\n# Plot the table to identify numbers\nax2 = plt.subplot(122)\nplt.axis('off') # Since we are plotting the table\ntbl = table(ax2, var, loc = 'center')\ntbl.auto_set_font_size(False)\ntbl.set_fontsize(12)\nplt.show()","53dde201":"# Analyse based on Year\nfor i, col_list in enumerate(Column_List):\n    var = Data.groupby('Month')[col_list].sum()\n    \n# Convert the variable into a pandas dataframe\nvar = pd.DataFrame(var)\n\n# Plot to understand the trend\nplt.figure(figsize = (16, 7))\nax1 = plt.subplot(121)\nvar.plot(kind = \"pie\", y = \"Volume\", legend = False, fontsize = 12, sharex = False, title = \"Time Series Influence on Total Volume Trade by Month\", ax = ax1)\n\n# Plot the table to identify numbers\nax2 = plt.subplot(122)\nplt.axis('off') # Since we are plotting the table\ntbl = table(ax2, var, loc = 'center')\ntbl.auto_set_font_size(False)\ntbl.set_fontsize(12)\nplt.show()","71585f5c":"plt.figure(figsize=(12,8))\nData.groupby([Data.Date.dt.year,Data.Date.dt.month])[\"Volume\"].mean().plot(color=\"#ad4073\",marker=\".\")\nplt.xlabel(\"Date\",color=\"#913653\", size=18)\nplt.ylabel(\"Volumne\",color=\"#913653\", size=18)\nplt.title(\"All Times Monthly Avarage Volume\",size=22)\n\nplt.yscale(\"log\")\nplt.grid(color=\"blue\", linestyle=\"--\", which=\"minor\")\nplt.xticks(fontsize=12) \nplt.yticks(fontsize=12, color=\"#3d8f6e\") \nplt.show()","8ecb92e2":"# Analyse based on Year\nfor i, col_list in enumerate(Column_List):\n    var = Data.groupby('WeekDay')[col_list].sum()\n    \n# Convert the variable into a pandas dataframe\nvar = pd.DataFrame(var)\n\n# Plot to understand the trend\nplt.figure(figsize = (16, 7))\nax1 = plt.subplot(121)\nvar.plot(kind = \"pie\", y = \"Volume\", legend = False, fontsize = 12, sharex = False, title = \"Time Series Influence on Total Volume Trade by WeekDay\", ax = ax1)\n\n# Plot the table to identify numbers\nax2 = plt.subplot(122)\nplt.axis('off') # Since we are plotting the table\ntbl = table(ax2, var, loc = 'center')\ntbl.auto_set_font_size(False)\ntbl.set_fontsize(12)\nplt.show()","8c554d03":"**What is the Stock Market?**\n            \n            The stock market refers to the collection of markets and exchanges where regular activities of buying, selling, and issuance of shares of publicly-held companies take place. Such financial activities are conducted through institutionalized formal exchanges or over-the-counter (OTC) marketplaces which operate under a defined set of regulations. There can be multiple stock trading venues in a country or a region which allow transactions in stocks and other forms of securities.","43241d69":"**Outlier Detection and Removal**","af56c9db":"**Extensive Analysis on Historical Data to Find Patterns**","9d85cdaf":"**Correlation Analysis**","3ad09735":"**Variation of Stock Trade Over Time**","e031dd17":"**Dataset Loading and Processing Segment**","342a7e4c":"**Analysis:**\n\n**Year Information:** 1986 - 2020\n\n**Month Information:** All 12 months (January, February, March, April, May, June, July, August, September, October, November, and December)\n\n**Day Information:** Only 5 working days (Monday, Tuesday, Wednesday, Thursday and Friday)","92897e4e":"**Pie charts to show the extensive influence of time in the overall volume trade**"}}