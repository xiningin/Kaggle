{"cell_type":{"072bbeb2":"code","184ca078":"code","977ea9b2":"code","d3707539":"code","d92cdcfd":"code","60cd2b6b":"code","8d9a9a06":"code","e1856693":"code","bd140538":"code","a70bbcf8":"code","d0bdc8c9":"code","e97452ae":"code","94bb24fe":"markdown"},"source":{"072bbeb2":"%reload_ext autoreload\n%autoreload 2\n%matplotlib inline","184ca078":"from fastai.tabular import * ","977ea9b2":"path = Path('\/kaggle\/input\/mushroom-classification')\npath.ls()","d3707539":"df = pd.read_csv(path\/'mushrooms.csv')\nprint(df.shape)\ndf[:20].T","d92cdcfd":"# Explore the dataset\ndf.describe()","60cd2b6b":"# Preprocessing\nprocs = [FillMissing, Categorify, Normalize]\n\n# Use 1000 data points for validation\nvalid_idx = range(len(df) - 1000, len(df))","8d9a9a06":"# Split our variables into target, categorical and continuous variables\ndep_var = 'class'\n\n# It seems like for this dataset, all columns are categorical data\ncat_names = list(df.columns.values)\ncat_names.remove('class')\nprint(cat_names)","e1856693":"# Create the data source\ndata = TabularDataBunch.from_df(path, df, dep_var, valid_idx=valid_idx, procs=procs, cat_names=cat_names)\nprint(data.train_ds.cont_names)  # `cont_names` defaults to: set(df)-set(cat_names)-{dep_var}","bd140538":"# Define the model\nlearn = tabular_learner(data, layers=[200,100], metrics=accuracy)","a70bbcf8":"learn.model_dir = '\/kaggle\/working'","d0bdc8c9":"learn.lr_find()\nlearn.recorder.plot(suggestion=True)","e97452ae":"min_grad_lr = learn.recorder.min_grad_lr\nlearn.fit_one_cycle(5, min_grad_lr)","94bb24fe":"* So we can easily achieve 100% accuracy with this dataset! :)"}}