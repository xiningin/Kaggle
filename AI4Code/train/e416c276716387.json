{"cell_type":{"fb27d2ed":"code","93656614":"code","20e3937b":"code","37b89754":"code","5b39b276":"code","cff1742d":"code","a6031e2b":"code","8840ff27":"code","a4c6e230":"code","0b447bd8":"code","92fa6cad":"code","724294bc":"code","68d017fe":"code","8307d3ee":"code","8b726942":"code","a11f7374":"code","ace6b184":"code","9f6acabd":"code","2df014c0":"code","e04f3f3c":"code","e487d32e":"code","b68b61fd":"code","6bdf742d":"code","36a71da4":"code","c89b0cd6":"code","942b4a4a":"code","c3cede5e":"code","c6f45f07":"code","45f31c14":"code","a4463119":"code","894a438d":"code","68f1d105":"code","bf7be137":"code","3de40dff":"code","d0fdd3d0":"code","715f8942":"code","66a1979d":"code","6d824ad9":"code","c9f32812":"code","a56b9cb4":"code","df47ac57":"code","b92dd273":"code","10ade4ad":"code","71a8ccec":"code","f40c98ec":"code","b23b34e3":"code","3fc903de":"code","3a569094":"code","a728b910":"code","4cf0b157":"code","f58e313e":"code","966d025f":"code","6424a327":"code","a29326a5":"code","c42808c6":"code","1bec7aa4":"markdown","b67f9d65":"markdown","b496a84d":"markdown","b31cca0a":"markdown","f2be1023":"markdown","8d0ff35d":"markdown","ae3dad80":"markdown","3be40559":"markdown","550167bc":"markdown","d61f3aa9":"markdown","d720b560":"markdown","8000b616":"markdown","4d64c6c7":"markdown","8b667726":"markdown","ea90e622":"markdown","1c16a3eb":"markdown","dabed9fe":"markdown","6046345e":"markdown","b930c5b1":"markdown","581b9d5a":"markdown","83bf36f1":"markdown","340d9c4b":"markdown","268ada6c":"markdown","03f29356":"markdown","05ba8f40":"markdown","e6efc605":"markdown","cbdbd430":"markdown","af42478b":"markdown","a068a8aa":"markdown","a5f5898b":"markdown","88a2d7fa":"markdown","f0a7993b":"markdown","fb5f6135":"markdown","cd7f49f4":"markdown","06ff30e8":"markdown","e105b207":"markdown","d9c88300":"markdown","1ee8be15":"markdown","05bc5665":"markdown","c9d42d2e":"markdown","8a2966e0":"markdown","a38e1f4f":"markdown","7ccbc0bd":"markdown","23f2a5a1":"markdown","03fbaa16":"markdown","0a75dc74":"markdown","1e6f7b49":"markdown","bd5a070e":"markdown","be7f6bc1":"markdown","ec1f5fbe":"markdown"},"source":{"fb27d2ed":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n","93656614":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nfrom matplotlib import pyplot as plt\n","20e3937b":"dataset=pd.read_csv('\/kaggle\/input\/graduate-admissions\/Admission_Predict_Ver1.1.csv')","37b89754":"dataset.columns","5b39b276":"dataset.dtypes","cff1742d":"dataset['Admit_rate']=dataset['Chance of Admit ']","a6031e2b":"dataset=dataset.drop('Chance of Admit ', axis=1)","8840ff27":"sns.set(style=\"whitegrid\")\nsns.distplot(dataset['Admit_rate'])","a4c6e230":"sns.boxplot(dataset['Admit_rate'])","0b447bd8":"sns.lineplot(x=dataset['GRE Score'], y=dataset['Admit_rate'])","92fa6cad":"sns.lineplot(x=dataset['TOEFL Score'], y=dataset['Admit_rate'])","724294bc":"sns.barplot(x=dataset['SOP'], y=dataset['Admit_rate'])","68d017fe":"dataset['LOR']=dataset['LOR ']\ndataset=dataset.drop('LOR ', axis=1)","8307d3ee":"sns.barplot(x=dataset['LOR'], y=dataset['Admit_rate'])","8b726942":"sns.lineplot(x=dataset['CGPA'], y=dataset['Admit_rate'])","a11f7374":"sns.barplot(x=dataset['Research'], y=dataset['Admit_rate'])","ace6b184":"sns.barplot(x=dataset['University Rating'], y=dataset['Admit_rate'])","9f6acabd":"sns.lineplot(x=dataset['GRE Score'], y=dataset['Admit_rate'], hue=dataset['Research'])","2df014c0":"palette = sns.color_palette(\"mako_r\", 5)\nsns.lineplot(x=dataset['GRE Score'], y=dataset['Admit_rate'], hue=dataset['University Rating'],palette=palette, legend=\"full\")","e04f3f3c":"palette = sns.color_palette(\"mako_r\", 9)\nsns.lineplot(x=dataset['GRE Score'], y=dataset['Admit_rate'], hue=dataset['SOP'],  palette=palette,legend=\"full\")","e487d32e":"dataset['CGPA_cat']=0","b68b61fd":"temp = [dataset]","6bdf742d":"for data in temp:\n    data.loc[dataset['CGPA']<=8,'CGPA_cat']=3,\n    data.loc[(dataset['CGPA']>8) & (dataset['CGPA']<=9),'CGPA_cat']=2,\n    data.loc[(dataset['CGPA']>9) & (dataset['CGPA']<=10),'CGPA_cat']=1\n    ","36a71da4":"palette = sns.color_palette(\"mako_r\", 3)\nsns.lineplot(x=dataset['GRE Score'], y=dataset['Admit_rate'], hue=dataset['CGPA_cat'], palette=palette, legend=\"full\")","c89b0cd6":"sns.lineplot(x=dataset['TOEFL Score'], y=dataset['Admit_rate'], hue=dataset['Research'])","942b4a4a":"palette = sns.color_palette(\"mako_r\", 5)\nsns.lineplot(x=dataset['TOEFL Score'], y=dataset['Admit_rate'], hue=dataset['University Rating'],palette=palette, legend=\"full\")","c3cede5e":"palette = sns.color_palette(\"mako_r\", 9)\nsns.lineplot(x=dataset['TOEFL Score'], y=dataset['Admit_rate'], hue=dataset['SOP'],  palette=palette,legend=\"full\")","c6f45f07":"palette = sns.color_palette(\"mako_r\", 3)\nsns.lineplot(x=dataset['TOEFL Score'], y=dataset['Admit_rate'], hue=dataset['CGPA_cat'],palette=palette, legend=\"full\")","45f31c14":"dataset.isnull().sum()","a4463119":"dataset2=dataset.drop(\"Serial No.\", axis=1)","894a438d":"corr=dataset2.corr()\nsns.heatmap(corr, cmap=\"YlGnBu\")","68f1d105":"corr = dataset2.corr()\nfig, ax = plt.subplots(figsize=(8, 8))\ncolormap = sns.diverging_palette(220, 10, as_cmap=True)\ndropSelf = np.zeros_like(corr)\ndropSelf[np.triu_indices_from(dropSelf)] = True\ncolormap = sns.diverging_palette(220, 10, as_cmap=True)\nsns.heatmap(corr, cmap=colormap, linewidths=.5, annot=True, fmt=\".2f\", mask=dropSelf)\nplt.title('Graduate Admissions - Features Correlations')\nplt.show()","bf7be137":"print (corr['Admit_rate'].sort_values(ascending=False)[:10], '\\n') #top 15 values\n\n","3de40dff":"num = [f for f in dataset2.columns if ((dataset2.dtypes[f] != 'object')& (dataset2.dtypes[f]!='bool'))]\n\nnd = pd.melt(dataset2, value_vars = num)\nn1 = sns.FacetGrid (nd, col='variable', col_wrap=4, sharex=False, sharey = False)\nn1 = n1.map(sns.distplot, 'value')","d0fdd3d0":"target=dataset['Admit_rate']","715f8942":"drop=['Serial No.', 'Admit_rate','CGPA_cat']\ntrain = dataset.drop(drop, axis=1)","66a1979d":"#Now we will split the dataset in the ratio of 75:25 for train and test\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(train, target, test_size = 0.25, random_state = 0)","6d824ad9":"from xgboost import XGBRegressor\nfrom sklearn.metrics import mean_absolute_error\n\nmodel = XGBRegressor(n_estimators=1000,learning_rate=0.009,n_jobs=-1)\nmodel.fit(X_train,y_train)","c9f32812":"from sklearn.metrics import mean_squared_error\ndef rmse(y_test,y_pred):\n      return np.sqrt(mean_squared_error(y_test,y_pred))\n    \n\ny_pred = model.predict(X_test)\nprint(\"XGBoost Regressor MSE on testing set: \", mean_squared_error(y_test, y_pred))\nprint(\"XGBoost Regressor RMSE on testing set: \", rmse(y_test, y_pred))\n\nprint(\"XGBoost Regressor Score: {}\".format(100*max(0,1-(rmse(y_test,y_pred)))))","a56b9cb4":"sns.scatterplot(y_test,y_pred)","df47ac57":"x_ax = range(len(y_test))\nplt.plot(x_ax, y_test, label=\"original\")\nplt.plot(x_ax, y_pred, label=\"predicted\")\nplt.title(\"Chance of Admit Test and predicted data\")\nplt.legend()\nplt.show()","b92dd273":"from sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\n  \nX_train = sc.fit_transform(X_train)\nX_test = sc.fit_transform(X_test)","10ade4ad":"from sklearn.linear_model import Lasso\nbest_alpha = 0.0099\n\nregr = Lasso(alpha=best_alpha, max_iter=50000)\nregr.fit(X_train, y_train)","71a8ccec":"from sklearn.metrics import mean_squared_error\ndef rmse(y_test,y_pred):\n      return np.sqrt(mean_squared_error(y_test,y_pred))\ny_pred = regr.predict(X_test)\nprint(\"Lasso Regressor MSE on testing set: \", mean_squared_error(y_test, y_pred))\nprint(\"Lasso Regressor RMSE on testing set: \", rmse(y_test, y_pred))\nprint(\"Lasso Regressor Score: {}\".format(100*max(0,1-(rmse(y_test,y_pred)))))","f40c98ec":"sns.scatterplot(y_test,y_pred)","b23b34e3":"x_ax = range(len(y_test))\nplt.plot(x_ax, y_test, label=\"original\")\nplt.plot(x_ax, y_pred, label=\"predicted\")\nplt.title(\"Chance of Admit Test and predicted data\")\nplt.legend()\nplt.show()","3fc903de":"from sklearn.linear_model import LinearRegression\n\nlr = LinearRegression()\nlr.fit(X_train, y_train)","3a569094":"from sklearn.metrics import mean_squared_error\ndef rmse(y_test,y_pred):\n      return np.sqrt(mean_squared_error(y_test,y_pred))\n\ny_pred = lr.predict(X_test)\nprint(\"Linear Regressor MSE on testing set: \", mean_squared_error(y_test, y_pred))\nprint(\"Linear Regressor RMSE on testing set: \", rmse(y_test, y_pred))\nprint(\"Linear Regressor Score: {}\".format(100*max(0,1-(rmse(y_test,y_pred)))))","a728b910":"sns.scatterplot(y_test,y_pred)","4cf0b157":"x_ax = range(len(y_test))\nplt.plot(x_ax, y_test, label=\"original\")\nplt.plot(x_ax, y_pred, label=\"predicted\")\nplt.title(\"Chance of Admit Test and predicted data\")\nplt.legend()\nplt.show()","f58e313e":"gre = int(input(\"Enter GRE Score - \"))\ntfl = int(input(\"Enter TOEFL Score - \"))\nur = int(input(\"Enter Your University Ratings(1 being lowest and 5 being highest) - \"))\nsop = int(input(\"Enter Your SOP(s) Ratings(1 being lowest and 5 being highest) - \"))\ncgpa = float(input(\"Enter Your CGPA(1-10) - \"))\nrp = int(input(\"Enter number of research publications under your name - \"))\nlor = int(input(\"Enter number of Letter of Recommendations - \"))","966d025f":"check = {'GRE Score': gre, 'TOEFL Score':tfl,'University Rating':ur,'SOP':sop,'CGPA':cgpa,\n         'Research':rp,'LOR':lor}","6424a327":"df = pd.DataFrame(check,columns = ['GRE Score','TOEFL Score','University Rating','SOP','CGPA','Research','LOR'],\n                 index=[1])","a29326a5":"chances = (model.predict(df))*100\nchances = round(chances[0])","c42808c6":"print('Your chances of getting an admit - {}%'.format(chances))","1bec7aa4":"* So this variable shows opposite of our expectations. It is because the University rating is of the University in which the aspirant has done his\/her Undergraduate degree. Obviously, if you have done your Undergrad from some reputed University, then your chance of Admit will also increase.","b67f9d65":"# Prediction on custom input","b496a84d":"Here, we will check for missing values, covert categorical variables(since we have all variables in number for so no need) and do some feature engineering if necessary.","b31cca0a":"* Changing the target variable name","f2be1023":"* Making scatter plot between actual and predicted points to see the model performance visually.","8d0ff35d":"Same is the scenario with TOEFL scores","ae3dad80":"# Score\nTo measure the performance of our model, we will be calculating a score out of 100 using the formula\n#### Score = 100 * (0 , 1 - root_mean_squared_error(actual values, predicted values)","3be40559":"# Feature Scaling","550167bc":"As shown, High GRE scores cannot cover up for high cgpa as the difference between aspirants with same GRE scores but different CGPA is clearly visible.","d61f3aa9":"* Let's check the column names","d720b560":"Sequence will be:\n1. GRE Score\n2. TOEFL Score\n3. University Rating\n4. SOP\n5. LOR\n6. CGPA\n7. Research\n\nI have some initial intuition about this data.\nChances of Admit will increase if we increase the values of following variables:\n1. GRE Score\n2. TOEFL Score\n3. SOP\n4. LOR\n5. CGPA\n6. Research\n\nAs the University rating increases, we can assume that competition will increase between students and hence the chances of Admit will go down. Now we will try to confirm this intuition.","8000b616":"* Aspirant with no research experience is at clear cut disadvantage incomparison to the one having a research background. This insight is useful for those aspirants who are trying to get into universities which do not accept GRE.","4d64c6c7":"So for better understanding, we will be creating bins for CGPA in following manner:\n1. Category 1 for High CGPA\n2. Category 2 for Average CGPA\n3. Category 3 for low CGPA","8b667726":"# Data Pre-processing","ea90e622":"* So far our data has a linear relationship with the target variable. Let's do some complex visualisations to understand the data better","1c16a3eb":"## Lasso Regression","dabed9fe":"Now we will split dataset into train and target variables","6046345e":"* Making scatter plot between actual and predicted points to see the model performance visually.","b930c5b1":"With respect to University Ratings of an aspirant, it affects the chances of admit in following ways:\n1. For aspirants with low GRE score, higher University Ratings are definitely as plus point.\n2. As the GRE score increases, the affect of University ratings on the chances of Admit also decreases.\n\nBased on the insights, it is safe to say that aspirants with lower University ranking should aim for a higher GRE score in order to get an admit.","581b9d5a":"Let's check the relationship of features with target variable","83bf36f1":"Now it is time to build model.","340d9c4b":"1. It has pretty much normal distribution, now what about outliers","268ada6c":"TOEFL Scores","03f29356":"# Conclusion\n\nWith highest score of 93.71, XGBoost is performing the best for this dataset. We can using hyperparameter tuning with the help of GridSearchCV and further use ensemble methods to improve our score.\nApart from this, I have also tried to make it work on a real life problem of getting an admit predict. User can input his\/her details and can see the chances of getting an admit.  ","05ba8f40":"Again, with research experirence, chances are that an aspirant will get an admit from the University.","e6efc605":"Let's see the distribution of the target variable","cbdbd430":"Aspirants with low University ratings will have low chances of admit in comparison to the ones from higher ranking Universities. This gap is less when TOEFL scores are less but it increases significantly when TOEFL score increases.","af42478b":"* Making scatter plot between actual and predicted points to see the model performance visually.","a068a8aa":"We will be doing a similar kind of analysis for TOEFL scores category.","a5f5898b":"# Exploratory Data Analysis","88a2d7fa":"Now an important question. \nCan high GRE scores cover up for low CGPA and vice-versa? \nLet's check it out!","f0a7993b":"# Future Works\nThe dataset used is of very small size and of a very particular university. Upon increasing the size of dataset, we can get even better results which can help us to tackle the problems of Master's degree aspirants. ","fb5f6135":"Let's make a better version of this","cd7f49f4":"# Introduction\nFollowing notebook contains in-depth Exploratory Data Analysis for better understanding of data followed by building and comparing machine learning models. I have also added a custom input section where user can input his\/her details and can see the chances of getting an admit.","06ff30e8":"## Linear Regression","e105b207":"Following insights can be drawn from this:\n1. Low rated SOPs combined with Low GRE scores will definitely affect your chances of Admit.\n2. High GRE scores can cover up for average or even low rated SOPs.\n\nGRE scores are a lot more important for aspirants who have a weak SOP and University rankings.","d9c88300":"# Model Implementation\nWe will be implementing both Tree and non-Tree based models to compare the performance\n\n### Tree Based\n1. XGBoost\n\n### Non-Tree Based\n1. Lasso Regression\n2. Linear Regression","1ee8be15":"There are some outliers, we will handle them during data pre-processing","05bc5665":"Let's check for missing values","c9d42d2e":"So as the quality of Letter of Recommendation increases, chances of Admit also increases. So far our inuition is correct. Let's check for remaining variables.","8a2966e0":"* As the quality of SOP increases, the chances of Admit also increases","a38e1f4f":"CGPA is 88% correlated with Admit chances while CGPA categorical is negatively correlated. It is because I have created bins in reverse order.\nIn case you have questions about correlations, click on this link-\nhttps:\/\/www.displayr.com\/what-is-correlation\/\n","7ccbc0bd":"## XGBoost Regressor","23f2a5a1":"So our intution regrading GRE scores was true! As the scores increase, chances of Admit increases as well.","03fbaa16":"No missing values. Let's check the correlation between variables and plot a heatmap.","0a75dc74":"Overall trend is increasing but there are a lot of fluctuations. It shows that high CGPA does not always mean high chances of Admit.","1e6f7b49":"Even if you have high GRE scores, having no research experience will definitely be a hinder your chances of getting an admit.","bd5a070e":"Higher CGPA students again have a clear cut advantage when compared to aspirants with lower CGPA. Even high TOEFL scores cannot bridge the gap.","be7f6bc1":"TOEFL scores seems to be covering up for low rated SOPs.","ec1f5fbe":"* Also the column types"}}