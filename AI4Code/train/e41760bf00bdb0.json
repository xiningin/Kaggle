{"cell_type":{"3d8cf747":"code","6db2982f":"code","a7fa2f35":"code","93f5077b":"code","8daff76f":"code","be61010b":"code","9073bd74":"code","36c6d14b":"code","1099b139":"code","81418c2c":"code","5b7ab3d2":"code","e52cec4d":"code","0bd1fa87":"code","c60b4ea9":"code","03713885":"code","6f664177":"code","c3fb6d16":"code","5fbbfd8a":"markdown"},"source":{"3d8cf747":"# import libraries\nimport warnings\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn import preprocessing\nfrom keras.models import Sequential\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.impute import SimpleImputer \nfrom keras.layers import Dense,Activation,Dropout\nfrom sklearn.model_selection import train_test_split","6db2982f":"#filter warnings\nwarnings.filterwarnings(\"ignore\")\n# import data \ndata = pd.read_csv('..\/input\/breastcancerwisconsin\/breast-cancer-wisconsin.csv',delimiter=',')\ndata.head()","a7fa2f35":"# Dropped \"ID\" Column cause is unneeded\ndata.drop(['id'], inplace=True, axis=1)\ndata.replace('?', -99999, inplace=True)","93f5077b":"# Visualize Malign and Benign Patient Count\ncount = data.benormal.value_counts()\ncount.plot(kind='bar')\nplt.legend()","8daff76f":"# Last Column is output data. So (2 is benign, 4 is malignant) \ndata['benormal'] = data['benormal'].map(lambda x: 1 if x == 4 else 0)","be61010b":"# First 9 column is input parameters. \nX = data.iloc[:,0:9]\n# Last Column is output data. So (0 is benign, 1 is malignant) \ny = data.iloc[:,-1]","9073bd74":"scaler = preprocessing.MinMaxScaler()\nX = scaler.fit_transform(X)","36c6d14b":"# train test split\nX_train,X_test,y_train,y_test = train_test_split(X, y, test_size=0.2)\n\nprint(X_train.shape, y_train.shape)\nprint(X_test.shape, y_test.shape)\nprint(X_train)","1099b139":"# Create Model with KERAS library\nmodel = Sequential()\nmodel.add(Dense(32, activation='relu', input_shape=(9,))) # FC Fully Connected Layer, input_dimension is dataset input parameters\nmodel.add(Dropout(0.05))\nmodel.add(Dense(64, activation='relu'))\nmodel.add(Dropout(0.10))\nmodel.add(Dense(64, activation='relu'))\nmodel.add(Dropout(0.20))\nmodel.add(Dense(1, activation='sigmoid'))","81418c2c":"# Compile Model\nmodel.compile(\n    optimizer=\"adam\",\n    loss=\"binary_crossentropy\",\n    metrics=[\"accuracy\"])","5b7ab3d2":"# Fit Model\nhistory =  model.fit(X_train,y_train, \n                     epochs=25,\n                     batch_size=8,\n                     validation_data=(X_test, y_test))","e52cec4d":"# model save\nmodel.save_weights(\"example.h5\")","0bd1fa87":"# Visualize Loss and Accuracy Rates\nplt.plot(history.history[\"loss\"],label=\"train_loss\")\nplt.plot(history.history[\"val_loss\"],label=\"val_loss\")\nplt.legend()\nplt.show()\n\nplt.figure()\nplt.plot(history.history[\"accuracy\"],label=\"train_acc\")\nplt.plot(history.history[\"val_accuracy\"],label=\"val_acc\")\nplt.legend()\nplt.show()","c60b4ea9":"Y_pred = model.predict(X_test)\nY_pred = [ 1 if y>=0.5 else 0 for y in Y_pred]","03713885":"from sklearn.metrics import confusion_matrix\ncm = confusion_matrix(y_test, Y_pred)\nprint(cm)","6f664177":"sns.heatmap(cm,annot=True)","c3fb6d16":"from sklearn.metrics import accuracy_score \nfrom sklearn.metrics import classification_report \nprint('Confusion Matrix :')\nprint(cm) \nprint('Accuracy Score :',accuracy_score(y_test, Y_pred))\nprint('Report : ')\nprint(classification_report(y_test, Y_pred))","5fbbfd8a":"<h1 align=\"center\">Breast Cancer Classification using Deep Neural Networks with Keras<\/h1> "}}