{"cell_type":{"4300f2e9":"code","7a306d64":"code","58826266":"code","17c82202":"code","badaefd3":"code","9a38ea39":"code","fee53c38":"code","43d5ba53":"code","3ccf0bcd":"code","3089b503":"code","5a347438":"code","74a63718":"code","094d4e82":"code","1145abd3":"code","a84630a6":"code","c2d59f65":"code","8964320c":"code","bb743a14":"code","fbd1a6cf":"code","65038ce4":"code","774d0091":"code","967cb063":"code","329a77df":"code","bf91447c":"code","6a7e91ca":"markdown","7fc1bb16":"markdown","77ee2255":"markdown","21d5a4e0":"markdown","ac8a889a":"markdown","c772bbe8":"markdown"},"source":{"4300f2e9":"import matplotlib.pyplot as plt \nimport matplotlib.dates as mdates\n# import matplotlib.colors as mcolors\nimport seaborn as sns\nsns.set()  # Set style & figures inline\n\nimport requests\nimport time\nfrom bs4 import BeautifulSoup\nimport numpy as np \nimport pandas as pd \nimport random\nimport math\nimport time\nimport datetime\n# import operator \n\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import GridSearchCV, RandomizedSearchCV, train_test_split\nfrom sklearn.preprocessing import PolynomialFeatures\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.svm import SVR\nfrom sklearn.metrics import mean_squared_error, mean_absolute_error, mean_squared_log_error\nfrom sklearn.preprocessing import OrdinalEncoder\nfrom sklearn.ensemble import RandomForestRegressor\nfrom xgboost import XGBRegressor\n\npd.set_option('display.max_columns', None)\npd.set_option('display.max_rows', None)\n\nplt.style.use('fivethirtyeight')\n%matplotlib inline\n","7a306d64":"# importing datetime formatted training and test dataset that was previously created\ntrain = pd.read_csv('..\/input\/kaggle-train-and-test\/train.csv')\ntest = pd.read_csv('..\/input\/kaggle-train-and-test\/test.csv')","58826266":"train.tail(10)","17c82202":"test.tail()","badaefd3":"train.columns = map(str.lower, train.columns)\ntest.columns = map(str.lower, test.columns)","9a38ea39":"train['date']= pd.to_datetime(train['date'], errors='coerce') \ntest['date']= pd.to_datetime(test['date'], errors='coerce') ","fee53c38":"# feature engineering new columns from datetime format for train set\ntrain['day'] = train['date'].dt.day\ntrain['month'] = train['date'].dt.month\ntrain['dayofweek'] = train['date'].dt.dayofweek\ntrain['dayofyear'] = train['date'].dt.dayofyear\ntrain['quarter'] = train['date'].dt.quarter\ntrain['weekofyear'] = train['date'].dt.weekofyear\n\n# feature engineering new columns from datetime format for test set\ntest['day'] = test['date'].dt.day\ntest['month'] = test['date'].dt.month\ntest['dayofweek'] = test['date'].dt.dayofweek\ntest['dayofyear'] = test['date'].dt.dayofyear\ntest['quarter'] = test['date'].dt.quarter\ntest['weekofyear'] = test['date'].dt.weekofyear\n\ncountries = list(train['country_region'].unique())\nsg_code = countries.index('Singapore')\n# train = train.drop(['date','Lat', 'Long'],1)\n# test =  test.drop(['date','Lat', 'Long'],1)\n\n# fill countries without province\/state data with NaN\ntrain[\"province_state\"].fillna('NaN', inplace=True)\ntest[\"province_state\"].fillna('NaN', inplace=True)\n\n# instantiate ordinal encoder\n# https:\/\/datascience.stackexchange.com\/questions\/39317\/difference-between-ordinalencoder-and-labelencoder\noe = OrdinalEncoder()\n\n# assigning float value to corresponding country and province\/state including NaN (somewhat dummifying for features)\ntrain[['province_state','country_region']] = oe.fit_transform(train.loc[:,['province_state','country_region']])\ntest[['province_state','country_region']] = oe.fit_transform(test.loc[:,['province_state','country_region']])","43d5ba53":"train_columns = ['day','month','dayofweek','dayofyear','quarter','weekofyear','province_state','country_region','confirmedcases', 'fatalities']\ntrain = train[train_columns]\ntest_columns = ['day','month','dayofweek','dayofyear','quarter','weekofyear','province_state','country_region']\ntest_model = test[test_columns]\n\nX = train.drop(['confirmedcases', 'fatalities'], axis=1)\ny = train['confirmedcases']\nX_train, X_test,y_train,y_test=train_test_split(X,y,test_size=0.2,random_state=42)\ntest_sg = test_model[test_model['country_region'] == sg_code]","3ccf0bcd":"models = []\nmse = []\nrmse = []\nrmsle = []","3089b503":"# linear regression model\nlm = LinearRegression(normalize=True, fit_intercept=True)\nlm.fit(X_train, y_train)\n\npred = lm.predict(X_test)\nlm_forecast_cc = lm.predict(test_model)\n\nmodels.append('Linear Regression')\nmse.append(round(mean_squared_error(pred, y_test),2))\nrmse.append(round(np.sqrt(mean_squared_error(pred, y_test)),2))\n# rmsle.append(round(np.sqrt(mean_squared_log_error(pred, y_test)),2))","5a347438":"# random forest regression model\nrf = RandomForestRegressor(n_estimators=100)\nrf.fit(X_train,y_train)\n\npred = rf.predict(X_test)\nrfr_forecast_cc = rf.predict(test_model)\n\nmodels.append('Random Forest')\nmse.append(round(mean_squared_error(pred, y_test),2))\nrmse.append(round(np.sqrt(mean_squared_error(pred, y_test)),2))\n# rmsle.append(round(np.sqrt(mean_squared_log_error(pred, y_test)),2))","74a63718":"xgb_test = test[['day', 'month', 'dayofweek', 'dayofyear', 'quarter', 'weekofyear', 'province_state','country_region']]\n# xgboost regression model\nxgb = XGBRegressor(n_estimators=100)\nxgb.fit(X_train,y_train)\n\npred = xgb.predict(X_test)\nxgb_forecast_cc = xgb.predict(test_model)\n\nmodels.append('XGBoost')\nmse.append(round(mean_squared_error(pred, y_test),2))\nrmse.append(round(np.sqrt(mean_squared_error(pred, y_test)),2))","094d4e82":"plt.figure(figsize= (15,10))\nplt.xticks(rotation = 90 ,fontsize = 11)\nplt.yticks(fontsize = 10)\nplt.xlabel(\"Different Models\",fontsize = 20)\nplt.ylabel('RMSE',fontsize = 20)\nplt.title(\"RMSE Values of different models\" , fontsize = 20)\nsns.barplot(x=models,y=rmse, log=True);","1145abd3":"compare = pd.DataFrame(np.column_stack([models, mse, rmse]), columns=['model', 'mse', 'rmse'])\ncompare","a84630a6":"train_columns = ['day','month','dayofweek','dayofyear','quarter','weekofyear','province_state','country_region','confirmedcases', 'fatalities']\ntrain = train[train_columns]\ntest_columns = ['day','month','dayofweek','dayofyear','quarter','weekofyear','province_state','country_region']\ntest_model = test[test_columns]\n\nX = train.drop(['confirmedcases', 'fatalities'], axis=1)\ny = train['fatalities']\nX_train, X_test,y_train,y_test=train_test_split(X,y,test_size=0.2,random_state=42)\ntest_sg = test_model[test_model['country_region'] == sg_code]","c2d59f65":"models = []\nmse = []\nrmse = []\nrmsle = []","8964320c":"# linear regression model\nlm = LinearRegression(normalize=True, fit_intercept=True)\nlm.fit(X_train, y_train)\n\npred = lm.predict(X_test)\nlm_forecast_f = lm.predict(test_model)\n\nmodels.append('Linear Regression')\nmse.append(round(mean_squared_error(pred, y_test),2))\nrmse.append(round(np.sqrt(mean_squared_error(pred, y_test)),2))\n# rmsle.append(round(np.sqrt(mean_squared_log_error(pred, y_test)),2))","bb743a14":"# random forest regression model\nrf = RandomForestRegressor(n_estimators=100)\nrf.fit(X_train,y_train)\n\npred = rf.predict(X_test)\nrfr_forecast_f = rf.predict(test_model)\n\nmodels.append('Random Forest')\nmse.append(round(mean_squared_error(pred, y_test),2))\nrmse.append(round(np.sqrt(mean_squared_error(pred, y_test)),2))\n# rmsle.append(round(np.sqrt(mean_squared_log_error(pred, y_test)),2))","fbd1a6cf":"xgb_test = test_model[['day', 'month', 'dayofweek', 'dayofyear', 'quarter', 'weekofyear', 'province_state','country_region']]\n# xgboost regression model\nxgb = XGBRegressor(n_estimators=100)\nxgb.fit(X_train,y_train)\n\npred = xgb.predict(X_test)\nxgb_forecast_f = xgb.predict(xgb_test)\n\nmodels.append('XGBoost')\nmse.append(round(mean_squared_error(pred, y_test),2))\nrmse.append(round(np.sqrt(mean_squared_error(pred, y_test)),2))","65038ce4":"plt.figure(figsize= (15,10))\nplt.xticks(rotation = 90 ,fontsize = 11)\nplt.yticks(fontsize = 10)\nplt.xlabel(\"Different Models\",fontsize = 20)\nplt.ylabel('RMSE',fontsize = 20)\nplt.title(\"RMSE Values of different models\" , fontsize = 20)\nsns.barplot(x=models,y=rmse, log=True);","774d0091":"compare = pd.DataFrame(np.column_stack([models, mse, rmse]), columns=['model', 'mse', 'rmse'])\ncompare","967cb063":"test2 = pd.read_csv('..\/input\/kaggle-train-and-test\/test.csv')","329a77df":"# creating dataframe for predicted sales price for kaggle submission\nsubmission = pd.DataFrame({'ConfirmedCases':rfr_forecast_cc, \n                           'Fatalities':rfr_forecast_f}, \n                          columns=['ConfirmedCases', 'Fatalities'])\nsubmission['ForecastId'] = test2['ForecastId']\nsubmission = submission[['ForecastId', 'ConfirmedCases', 'Fatalities']]\nsubmission.head()","bf91447c":"\n# save data\nsubmission.to_csv('submission.csv', index=False)","6a7e91ca":"#### Import Tools & Datasets","7fc1bb16":"---\n#### For Fatalities","77ee2255":"---\n#### For Confirmed Cases","21d5a4e0":"---\n### Training Models\n---\nUsing datetime features","ac8a889a":"---\n#### Kaggle subission","c772bbe8":"# COVID-19 Predictions\n---\n\n---\n"}}