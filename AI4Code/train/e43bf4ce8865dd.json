{"cell_type":{"f589bca8":"code","6269f05f":"code","b3638b22":"code","c244e369":"code","d0c5daa8":"code","06428f2b":"code","470c6a88":"code","44ede871":"code","e2786a36":"code","d9d3f416":"code","d9224bf2":"code","da7f1a23":"markdown","ee29d4e1":"markdown","427d3ee1":"markdown"},"source":{"f589bca8":"import pandas as pd\nimport os\n\nBASE_PATH = \"..\/input\/landmark-recognition-2021\"\n\ntrain_df = pd.read_csv(BASE_PATH + \"\/train.csv\")\nsubmission_df = pd.read_csv(BASE_PATH + \"\/sample_submission.csv\")","6269f05f":"import numpy as np\nimport matplotlib.pyplot as plt\nfrom mpl_toolkits.axes_grid1 import ImageGrid\nfrom PIL import Image\nimport seaborn as sns","b3638b22":"print(train_df.shape)\nprint(submission_df.shape)","c244e369":"print(train_df.head())","d0c5daa8":"print(submission_df.head())","06428f2b":"def image_grid3x3(image_array, landmarks):\n    fig = plt.figure(figsize=(12., 12.))\n    grid = ImageGrid(fig, 111,\n                     nrows_ncols=(3, 3),\n                     axes_pad=1)\n    \n    for idx, (ax, im) in enumerate(zip(grid, image_array)):\n        ax.imshow(im)\n        ax.set_title(landmarks[idx])\n        ax.set_xlabel(f'{im.shape}')\n        \n    plt.show()","470c6a88":"def make_img_path(img_id):\n    return \"\/\".join([char for char in img_id[:3]]) + \"\/\" + img_id + \".jpg\"","44ede871":"def get_img_numpy(img_id, base=\"\/train\"):\n    img_path = make_img_path(img_id)\n    img = Image.open(base + \"\/\" + img_path)\n    return np.asarray(img)","e2786a36":"img_array = [get_img_numpy(img, BASE_PATH + \"\/train\") for img in train_df['id'][1000:1009]]\n\nimage_grid3x3(img_array, [landmark for landmark in train_df['landmark_id'][1000:1009]])","d9d3f416":"img_array = [get_img_numpy(img, BASE_PATH + \"\/train\") for img in train_df['id'][10000:10009]]\n\nimage_grid3x3(img_array, [landmark for landmark in train_df['landmark_id'][10000:10009]])","d9224bf2":"sns.histplot(data=train_df, x=\"landmark_id\", bins=1000)","da7f1a23":"## Plot some samples and see the resolutions","ee29d4e1":"## Get some graphs going about class distributions","427d3ee1":"### Conclusions:\n\n- We need to resize images to some reasonable threshold.\n- We also need augmentation techniques to solve class imbalance.\n  - HIGH_CLASS_SAMPLES=6272\n  - MIN_CLASS_SAMPLES=2"}}