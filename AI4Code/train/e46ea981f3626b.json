{"cell_type":{"e912e824":"code","2258f12b":"code","f6d3efe2":"code","ce4284c3":"code","e7c724c1":"code","e52d4eff":"code","95db8bcd":"code","5866219f":"code","abe89c51":"code","e5a19576":"code","6e67e703":"code","4c42e109":"code","34f4760a":"code","5e066616":"markdown","30cf423c":"markdown"},"source":{"e912e824":"pip install minisom","2258f12b":"import pandas as pd\nimport numpy as np\nfrom minisom import MiniSom\nfrom sklearn.preprocessing import MinMaxScaler","f6d3efe2":"dados = pd.read_csv('..\/input\/credit-fraud\/credit_data.csv')\ndados.head()","ce4284c3":"dados.isnull().sum()","e7c724c1":"dados = dados.dropna()\n\ndados.loc[dados['age'] < 0].head()","e52d4eff":"dados.loc[dados.age < 0, 'age'] = dados['age'].mean()","95db8bcd":"X = dados.iloc[:,0:4].values\nY = dados.iloc[:,4].values","5866219f":"scaler = MinMaxScaler(feature_range=(0,1))\n\nX = scaler.fit_transform(X)","abe89c51":"print(np.sqrt(((np.sqrt(X.shape[0]))*5)))","e5a19576":"som = MiniSom(x=15, y=15, input_len=4, random_seed=0)\nsom.random_weights_init(X)\nsom.train_random(data = X, num_iteration = 100)","6e67e703":"from pylab import plot, pcolor, colorbar\n\npcolor(som.distance_map().T)\ncolorbar()\n\nmarkers = ['o', 's']\ncolors = ['r', 'blue']\n\nfor i, x in enumerate(X):\n  w = som.winner(x)\n  plot(w[0]+0.5, w[1]+0.5, markers[Y[i]],\n       markerfacecolor = 'None', markersize = 10, \n       markeredgecolor = colors[Y[i]], markeredgewidth = 2)","4c42e109":"mapeamento = som.win_map(X)\nsuspeitos = np.concatenate((mapeamento[(4,5)], mapeamento[(11,6)]), axis=0)\nsuspeitos = scaler.inverse_transform(suspeitos)\n\nclasse = []\n\nfor i in range(len(dados)):\n  for j in range(len(suspeitos)):\n    if dados.iloc[i, 0] == int(round(suspeitos[j, 0])):\n      classe.append(dados.iloc[i, 4])\n\nclasse = np.array(classe)\n\nsuspeitos_final = np.column_stack((suspeitos, classe))\nsuspeitos_final = suspeitos_final[suspeitos_final[:, 4].argsort()]","34f4760a":"pd.DataFrame(suspeitos_final, columns=dados.columns)","5e066616":"#### List of potential fraud clients, and if they are aproved or not. ####","30cf423c":"$$  \\sqrt(\\sqrt size*5)  $$"}}