{"cell_type":{"d31f19d2":"code","9bd72767":"code","0256f8f1":"code","3b456ccf":"code","db3c1b33":"code","74e3fed6":"code","a91ee878":"code","1a511c06":"code","5fecb281":"code","dce54f67":"code","b4269ad9":"code","ed8a8892":"code","f8e4116b":"code","3bbdd7a4":"code","3f8d166e":"code","507d833a":"code","4c0a1930":"code","ee1d19cf":"code","2efe99e8":"code","90e58c4d":"code","2382e592":"code","b07a42c8":"code","2a6505a6":"code","79cc923a":"code","cbae8cba":"code","bdf3aa38":"code","75bfae55":"code","7c702302":"code","3362054f":"code","00b2e986":"code","32d5af74":"code","6bf1c4ec":"code","39293016":"code","05f09dd8":"code","336af7d5":"code","d66e2224":"code","49456dc8":"code","c6e47f4d":"code","ff4590d8":"code","ce815b91":"code","612b4813":"code","b100fe09":"code","a979dfe7":"code","c21aaf52":"code","549b1041":"code","86b8c692":"code","22a60891":"code","b4eefe0e":"code","dedc435c":"code","3689c9a9":"code","bdb62a7c":"code","a1992515":"code","708c0950":"code","01fa00e5":"code","1c7a3396":"markdown","55b671b8":"markdown","4e619294":"markdown","52fe740a":"markdown","c40050eb":"markdown","09305ade":"markdown","af4135e3":"markdown","b20fad36":"markdown","3bf6fe9b":"markdown","276ff65a":"markdown","6aa89bae":"markdown","80c4761d":"markdown","bb612cbf":"markdown","a42da518":"markdown","13e7744f":"markdown"},"source":{"d31f19d2":"%matplotlib inline\nimport matplotlib\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set_style(\"dark\")\nplt.rcParams['figure.figsize'] = 16, 12\nimport pandas as pd\npd.set_option('display.max_rows', 200)\npd.set_option('display.max_columns', 50)\npd.set_option('display.max_colwidth', 300)\npd.options.display.float_format = '{:,.6f}'.format\n\nimport itertools as it\n\nfrom scipy.stats import ttest_ind, ttest_ind_from_stats\n\nfrom statsmodels.stats.multitest import multipletests\n\nprint(\"ready2\")","9bd72767":"df_full = pd.read_csv(\n    '..\/input\/survey-academics\/survey_mental_health.csv',\n    usecols=[\n        'How stressed are you because of work?',\n        'Your role is...',\n        'What is your h-index?',\n        'Do you use any reference management tool? ( Mendeley, Zotero, Citationsy, ... )',\n        'SubjectiveHappinessIndex',\n        'At what age did you got tenure? (type 0 if not yet)',\n        'subject_1'\n    ]\n).rename(columns={\n    'How stressed are you because of work?': 'stress',\n    'Your role is...': 'role',\n    'What is your h-index?': 'hindex',\n    'SubjectiveHappinessIndex': 'SHI',\n    'Do you use any reference management tool? ( Mendeley, Zotero, Citationsy, ... )': 'reftools',\n    'At what age did you got tenure? (type 0 if not yet)': 'tenure',\n    'subject_1': 'subject' \n})","0256f8f1":"df_full['SHI'] = df_full['SHI'].apply(pd.to_numeric, errors='coerce')\n","3b456ccf":"df_full.shape","db3c1b33":"df = df_full.dropna(\n    subset=['subject']\n).copy()\n\ndf['subject'] = df['subject'].apply(lambda s: s.split('-')[0].strip())\n\n\ndf.shape","74e3fed6":"df['subject'].value_counts()","a91ee878":"#this version of the dataset does not contain the titles for anonimity\n#import re\n#from collections import Counter\n\n#def words(text): return re.findall(r'\\w+', text.lower())\n#s = words(''.join(df['title'].values))\n#c = Counter(s)\n\n#c.most_common()\n#len(c)","1a511c06":"df","5fecb281":"df = pd.merge(\n    df,\n    df['subject'].value_counts().reset_index().rename(columns={'subject': 'counts', 'index': 'subject'}),\n    on='subject'\n)\ndf.head()\n\n#df.shape","dce54f67":"df.rename(columns={'role': 'old_role'}, inplace=True)","b4269ad9":"df_roles = pd.read_table('..\/input\/survey-academics\/roles - Sheet1.tsv', sep='\\t')\n\ndf['role'] = None\n\nfor c in df_roles.columns:\n    df.loc[df['old_role'].isin(set(df_roles[c].dropna())), 'role'] = c\n    \n#df_roles    ","ed8a8892":"df = df.dropna(subset=['role']).drop(columns=['old_role'])\n\ndf.shape","f8e4116b":"df = df.loc[~df['role'].isin(set(['other', 'retired']))]\n\ndf.shape","3bbdd7a4":"df.loc[df['tenure'] > 0, 'role'] = 'faculty tenured'","3f8d166e":"df['role'].value_counts()","507d833a":"# df['subject'].value_counts()","4c0a1930":"# 100 * df['tenure'].value_counts() \/df['tenure'].value_counts().sum() \n#removoe outliers, exclude 0 \nd = df.loc[df['role']=='faculty tenured' ].loc[df['tenure']>16 ].loc[df['tenure']<75 ]['tenure']\n\nd.value_counts().sum()\n#d.mean()\n#d.std()\n\n#d = df.loc[df['role']=='faculty' ) & ( df['tenure']>1 ]['tenure']\n#d.value_counts()\n\n\n","ee1d19cf":"x = d.plot.hist(bins=12, alpha=0.7,edgecolor='k', figsize=(12,8))\n\nx.set_xlabel(\"Age at tenure\", labelpad=20, weight='bold', size=22)\nx.set_ylabel(\"Respondents\", labelpad=20, weight='bold', size=22)\nx.tick_params(labelsize=20)\n\nx","2efe99e8":"# Is there a relation between age of tenure and stress? Not really.\n#x = d['tenure'].values\n#y = d['stress'].values\n#plt.plot(x, y, 'o')\n#m, b = np.polyfit(x, y, 1)\n#plt.plot(x, m*x + b)","90e58c4d":"#df.corr()","2382e592":"#d = df.loc[df['role']=='faculty' ].loc[df['tenure']>16 ].loc[df['tenure']<75 ][['tenure','stress','reftools','hindex','SHI']]\n#d\n\ng = df.groupby(['role'])[['stress','reftools','hindex','SHI']].mean().reset_index()\ng.sort_values('hindex', ascending=False)\n","b07a42c8":"from plotnine import *\nfrom plotnine.data import mpg\n%matplotlib inline\n\n(ggplot(df)         # defining what data to use\n + aes(x='stress',fill='role')    # defining what variable to use\n + geom_density(alpha=0.5) # defining the type of plot to use\n)\n","2a6505a6":"\n\n(ggplot(df)         # defining what data to use\n + aes(x='stress',fill='role')    # defining what variable to use\n + geom_bar(alpha=0.5,position = \"dodge2\") # defining the type of plot to use\n)\n\n","79cc923a":"\n\n\nd3 = df[df['role'].isin(['faculty', 'phd student','faculty tenured'])].copy()\n\n(ggplot(d3)         # defining what data to use\n + aes(x='stress',fill='role')    # defining what variable to use\n + geom_density(alpha=0.3) \n)","cbae8cba":"d3","bdf3aa38":"\nd3 = df[df['role'].isin(['faculty', 'phd student','faculty tenured'])].copy()\n\n(ggplot(d3)         # defining what data to use\n + aes(x='SHI',fill='role')    # defining what variable to use\n + geom_density(alpha=0.3) \n)","75bfae55":"\n\n(ggplot(d3)         # defining what data to use\n + aes(x='stress',fill='role')    # defining what variable to use\n + geom_bar(alpha=0.5,position = \"dodge2\") # defining the type of plot to use\n)\n","7c702302":"x = g['role']\nx= ['employee','non-tenured','tenured ','phd student','','students']\n","3362054f":"#nn= df.groupby(['role'])[['stress']].count()['stress'].values\n#nn","00b2e986":"#nn= df.groupby(['role'])[['stress']].count()['stress']\n#g['c'] = nn\ng","32d5af74":"\n(\n    ggplot(g)         # defining what data to use\n + aes(x = 'role', y='stress')    # defining what variable to use\n + geom_bar(stat = \"identity\")+ scale_y_reverse()\n)\n","6bf1c4ec":"\n(\n    ggplot(g)         # defining what data to use\n + aes(y='stress',x = 'SHI')    # defining what variable to use\n + geom_point()+geom_text(label=x,nudge_x = +0.06,nudge_y = +0.02)\n + scale_y_reverse() +\n    stat_smooth(method = \"lm\") +labs(x ='Subjective Happiness', y='Stress')\n    # defining the type of plot to use\n)\n","39293016":"\n(ggplot(df)         # defining what data to use\n + aes(x='stress',fill='role')    # defining what variable to use\n + geom_bar(alpha=0.5,position = \"dodge2\") # defining the type of plot to use\n)\n","05f09dd8":"# density plot\nx = d.plot.hist(bins=7, alpha=0.7,edgecolor='k', figsize=(12,8))\n\nx.set_xlabel(\"Age at tenure\", labelpad=20, weight='bold', size=22)\nx.set_ylabel(\"Respondents\", labelpad=20, weight='bold', size=22)\nx.tick_params(labelsize=20)\n\nx","336af7d5":"df.groupby(['role'])[['stress','reftools','hindex','SHI']].count()\n","d66e2224":"df['SHI'].mean()","49456dc8":"df_test = df.groupby(['subject'])['stress','hindex'].agg(['mean', 'std', 'count'])\n\ndf_test","c6e47f4d":"df_test = df.groupby(['subject'])['stress'].agg(['mean', 'std', 'count'])\ndf_test","ff4590d8":"df_res = []\nfor role_a, role_b in it.combinations(df_test.index, 2):\n    res = ttest_ind_from_stats(\n        mean1=df_test.loc[role_a]['mean'],\n        std1=df_test.loc[role_a]['std'],\n        nobs1=df_test.loc[role_a]['count'],\n        mean2=df_test.loc[role_b]['mean'],\n        std2=df_test.loc[role_b]['std'],\n        nobs2=df_test.loc[role_b]['count'],\n        equal_var=False,\n    )\n    df_res.append((\n        role_a,\n        role_b,\n        df_test.loc[role_a]['mean'],\n        df_test.loc[role_b]['mean'],\n        res.pvalue\n    ))\n    \ndf_res = pd.DataFrame(\n    df_res,\n    columns=['role_a', 'role_b', 'mean_a', 'mean_b', 'p']\n)\n\ndf_res","ce815b91":"_, pcorr, _, _ = multipletests(df_res['p'], method='bonferroni')\ndf_res['p_corr'] = pcorr","612b4813":"df_res[df_res['p'] <= 0.05]","b100fe09":"df_res[df_res['p_corr'] <= 0.9]","a979dfe7":"df_test = df.groupby(['subject'])['stress'].agg(['mean', 'std', 'count'])\n\ndf_test","c21aaf52":"df_res = []\nfor subj_a, subj_b in it.combinations(df_test.index, 2):\n    res = ttest_ind_from_stats(\n        mean1=df_test.loc[subj_a]['mean'],\n        std1=df_test.loc[subj_a]['std'],\n        nobs1=df_test.loc[subj_a]['count'],\n        mean2=df_test.loc[subj_b]['mean'],\n        std2=df_test.loc[subj_b]['std'],\n        nobs2=df_test.loc[subj_b]['count'],\n        equal_var=False,\n    )\n    df_res.append((\n        subj_a,\n        subj_b,\n        df_test.loc[subj_a]['mean'],\n        df_test.loc[subj_b]['mean'],\n        res.pvalue\n    ))\n    \ndf_res = pd.DataFrame(\n    df_res,\n    columns=['subj_a', 'subj_b', 'mean_a', 'mean_b', 'p']\n)\n\ndf_res","549b1041":"_, pcorr, _, _ = multipletests(df_res['p'], method='bonferroni')\ndf_res['p_corr'] = pcorr","86b8c692":"df_res[df_res['p'] <= 0.05]","22a60891":"df_res[df_res['p_corr'] <= 0.05]","b4eefe0e":" list(df_roles.columns) \n","dedc435c":"dfc = pd.read_csv('..\/input\/survey-academics\/bycountry.csv')","3689c9a9":"dfc.head()","bdb62a7c":"gg = dfc.groupby(['tenured','country',])['stress','subjective.happyness'].agg(['mean','std','count'])","a1992515":"gg.colnames = ['s.m', 's.SD', 's.c', 'sh.m', 'sh.SD', 'sh.c']\ngg.colnames\n","708c0950":"# gg['sh.c'] = gg['sh.c'].apply(pd.to_numeric, errors='coerce')\n# gg['sh.c'>4]\n\n\n","01fa00e5":"gg.loc[gg['count']>2]","1c7a3396":"Colesce academic roles into 4 main types","55b671b8":"# Stress by discipline","4e619294":"How many of the faculty are tenured?","52fe740a":"## A Survey of H-index, Stress, Tenure & Reference Management software use in Academia\n\n### Companion data set and stats\n\nAbstract - We describe the findings of a  survey that covered the topics of stress, citation tool use habits, subjective happiness, h-index, research topic and tenure among a sample of 2056 authors of a preprint service. PhDs students report the lowest subjective happiness score among all faculty roles, while faculty reports the highest. Faculty reports the lowest levels of stress, undergraduate and graduate students report the highest levels of stress. No association between citation management tool usage and h-index was found. The average age at tenure start is 34.9 years. In addition, no significant difference between stress and the research topic was found.\n\nto cite this data set: J. Berengueres and P. Nesterov, \u201cA Survey of H-index, Stress, Tenure & Reference Management software use in Academia.\u201d  https:\/\/arxiv.org\/abs\/2010.00358\n\n","c40050eb":"First some settings...","09305ade":"Number of responses:","af4135e3":"Count by subject","b20fad36":"Bonferroni test","3bf6fe9b":" Rename some colnames","276ff65a":"but there is correlation between SHI and stress","6aa89bae":"At what age do professors get tenured?","80c4761d":"Overview of h-index, Subjective Happines (SHI) and reft tool usage 7 and 5 point likert scales are used.","bb612cbf":"Number of responses linked to a paper","a42da518":"Responses with role determined","13e7744f":"# by country"}}