{"cell_type":{"56b1c6c1":"code","a4c8a774":"code","6247faba":"code","f495e143":"code","3b55cab4":"code","524f84bb":"code","6d5ff875":"code","713beb88":"code","4b12173a":"code","15ccfb3a":"code","f8c49d92":"code","f55cea3f":"code","8cba05bb":"code","8dc908fe":"markdown","70fd7dd3":"markdown"},"source":{"56b1c6c1":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nimport plotly.express as px\n\ntrain_df = pd.read_csv(\"\/kaggle\/input\/covid19-global-forecasting-week-2\/train.csv\", index_col = 'Id')\ntest_df = pd.read_csv(\"\/kaggle\/input\/covid19-global-forecasting-week-2\/test.csv\", index_col = 'ForecastId')\npd.set_option('display.max_columns', 200)\npd.set_option('display.max_rows', 200)\n\n\ntrain_df.rename(columns={\"Country_Region\": \"country\", \"Province_State\": \"province\"}, inplace=True, errors=\"raise\")\ndf = train_df.fillna('NA').groupby(['country','province','Date'])['ConfirmedCases'].sum() \\\n                          .groupby(['country','province']).max().sort_values() \\\n                          .groupby(['country']).sum().sort_values(ascending = False)\n\ntop10 = pd.DataFrame(df).head(10)\nfig = px.bar(top10, x=top10.index, y='ConfirmedCases', labels={'x':'Country'},\n             color=\"ConfirmedCases\", color_continuous_scale=px.colors.sequential.Brwnyl)\nfig.update_layout(title_text='Confirmed COVID-19 cases by country')\nfig.show()","a4c8a774":"df_by_date = pd.DataFrame(train_df.fillna('NA').groupby(['country','Date'])['ConfirmedCases'].sum().sort_values().reset_index())\n\nfig = px.bar(df_by_date.loc[(df_by_date['country'] == 'Canada') &(df_by_date.Date >= '2020-03-01')].sort_values('ConfirmedCases',ascending = False), \n             x='Date', y='ConfirmedCases', color=\"ConfirmedCases\", color_continuous_scale=px.colors.sequential.BuGn)\nfig.update_layout(title_text='Confirmed COVID-19 cases per day in Canada')\nfig.show()","6247faba":"fig = px.bar(df_by_date.loc[(df_by_date.country == 'Russia') &(df_by_date.Date >= '2020-03-01')].sort_values(['Date','ConfirmedCases'],ascending = False),\n             x='Date', y='ConfirmedCases', color=\"ConfirmedCases\", color_continuous_scale=px.colors.sequential.Blues)\nfig.update_layout(title_text='Confirmed COVID-19 cases per day in Russia')\nfig.show()","f495e143":"fig = px.bar(df_by_date.loc[(df_by_date['country'] == 'US') &(df_by_date.Date >= '2020-03-02')].sort_values('ConfirmedCases',ascending = False), x='Date', \n             y='ConfirmedCases', color=\"ConfirmedCases\", color_continuous_scale=px.colors.sequential.Brwnyl)\nfig.update_layout(title_text='Confirmed COVID-19 cases per day in US')\nfig.show()","3b55cab4":"fig = px.bar(df_by_date.loc[(df_by_date['country'] == 'Italy' ) &(df_by_date.Date >= '2020-03-02')].sort_values('ConfirmedCases',ascending = False), x='Date', y='ConfirmedCases',\n            color=\"ConfirmedCases\", color_continuous_scale=px.colors.sequential.Mint)\nfig.update_layout(title_text='Confirmed COVID-19 cases per day in Italy')\nfig.show()","524f84bb":"fig = px.bar(df_by_date.loc[df_by_date['country'] == 'China'].sort_values('ConfirmedCases',ascending = False), x='Date', y='ConfirmedCases',\n            color=\"ConfirmedCases\", color_continuous_scale=px.colors.sequential.Purples)\nfig.update_layout(title_text='Confirmed COVID-19 cases per day in China')\nfig.show()","6d5ff875":"df = train_df.fillna('NA').groupby(['country','province','Date'])['ConfirmedCases','Fatalities'].sum() \\\n                          .groupby(['country','province']).max().sort_values(by='ConfirmedCases') \\\n                          .groupby(['country']).sum().sort_values(by='ConfirmedCases',ascending = False)\n\ndf = pd.DataFrame(df).reset_index()\n\n\ndf = pd.DataFrame(df)\n\ndf_new_cases = pd.DataFrame(train_df.fillna('NA').groupby(['country','Date'])['ConfirmedCases'].sum() \\\n                            .reset_index()).sort_values(['country','Date'])\ndf_new_cases.ConfirmedCases = df_new_cases.ConfirmedCases.diff().fillna(0)\ndf_new_cases = df_new_cases.loc[df_new_cases['Date'] == max(df_new_cases['Date']),['country','ConfirmedCases']]\ndf_new_cases.rename(columns={\"ConfirmedCases\": \"NewCases\"}, inplace=True, errors=\"raise\")\n\ndf_new_deaths = pd.DataFrame(train_df.fillna('NA').groupby(['country','Date'])['Fatalities'].sum() \\\n                            .reset_index()).sort_values(['country','Date'])\n\ndf_new_deaths.Fatalities = df_new_deaths.Fatalities.diff().fillna(0)\ndf_new_deaths = df_new_deaths.loc[df_new_deaths['Date'] == max(df_new_deaths['Date']),['country','Fatalities']]\n\ndf_new_deaths.rename(columns={\"Fatalities\": \"NewFatalities\"}, inplace=True, errors=\"raise\")\n\nmerged = df.merge(df_new_cases, left_on='country', right_on='country')\\\n            .merge(df_new_deaths, left_on='country', right_on='country')\n\n\nmerged.style.background_gradient(cmap=\"Blues\", subset=['ConfirmedCases'])\\\n            .background_gradient(cmap=\"Reds\", subset=['Fatalities'])\\\n            .background_gradient(cmap=\"Blues\", subset=['NewCases'])\\\n            .background_gradient(cmap=\"Reds\", subset=['NewFatalities'])","713beb88":"df_by_date.ConfirmedCases = df_by_date.ConfirmedCases.diff().fillna(0)\ndf_by_date.index = pd.to_datetime(df_by_date.Date)","4b12173a":"# install calmap\n! pip install calmap","15ccfb3a":"import matplotlib.pyplot as plt\nimport calmap","f8c49d92":"fig = plt.figure(figsize=(20, 3));\nax = fig.add_subplot(111)\ncax = calmap.yearplot(df_by_date.ConfirmedCases, fillcolor='white', cmap='Blues', linewidth=0.5)\nfig.colorbar(cax.get_children()[1], ax=cax, orientation='horizontal')\nplt.title('Number of new confirmed cases per day worldwide');","f55cea3f":"ft_by_date = train_df.fillna('NA').groupby(['country','Date'])['Fatalities'].sum().sort_values().reset_index() \\\n                          .groupby(['Date'])['Fatalities'].sum().sort_values()\n\nft_by_date.index = pd.to_datetime(ft_by_date.index)\nft_by_date = ft_by_date.diff().fillna(0)","8cba05bb":"fig = plt.figure(figsize=(20,3))\n\nax = fig.add_subplot(111)\ncax = calmap.yearplot(ft_by_date, fillcolor='white', cmap='Reds', linewidth=0.5)\nfig.colorbar(cax.get_children()[1], ax=cax, orientation='horizontal')\nplt.title('Number of deaths per day worldwide');","8dc908fe":"Confirmed Cases vs Deaths by Country","70fd7dd3":"## Visualizations using PlotLy\n\n### Please upvote if you like this notebook.\n\n#### I would also appreciate any suggestions you might have."}}