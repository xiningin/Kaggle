{"cell_type":{"45f2954d":"code","84717e98":"code","8cb05bf2":"code","02f55017":"code","8d6198fd":"code","ea9ad272":"code","a1c66ebc":"code","3b1f3f65":"code","f2759d73":"code","a5a37922":"code","42c74f7c":"code","3c84232e":"code","cd97c4a3":"code","248193b6":"code","6f995923":"code","4a5d9840":"code","fe61ed31":"code","72c613f9":"code","339a3326":"code","12d9e0cf":"code","0ad609f9":"code","8592910d":"code","fed4f92a":"code","a89c2fde":"code","03338648":"code","339ef56d":"code","8248811b":"code","888597af":"code","da779a13":"code","18d00c63":"code","6f1e03e6":"code","a4c70157":"code","01a1a5af":"code","316bb65a":"code","11023441":"code","7b11f2ce":"code","549221d2":"code","afa9eabf":"code","b2efd5f6":"code","63534a34":"code","56c27e15":"code","5ee9e07b":"code","f072fdd3":"code","b82304c5":"code","8604b1e6":"code","550b8d7f":"markdown","a60fa48a":"markdown","cdd8cf87":"markdown","bbf09efb":"markdown","5287e62b":"markdown","ca876717":"markdown","e14d73dc":"markdown","221178f6":"markdown","4d20916d":"markdown","28fcb067":"markdown","db250596":"markdown","7eced76b":"markdown","210d719b":"markdown","1aec8c66":"markdown","2627bcde":"markdown"},"source":{"45f2954d":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt","84717e98":"data = pd.read_csv('\/kaggle\/input\/audi-used-car-listings\/audi.csv')","8cb05bf2":"data.head()","02f55017":"data.shape","8d6198fd":"data.describe(include='all')","ea9ad272":"from sklearn.impute import SimpleImputer\n\nimp = SimpleImputer(missing_values=0, strategy ='median')\n\ndata['engineSize'] = imp.fit_transform(data['engineSize'].values.reshape(-1,1))","a1c66ebc":"data.describe(include='all')","3b1f3f65":"data['engineSize'] = data['engineSize'].astype('object')","f2759d73":"data.describe(include='all')","a5a37922":"data.info()","42c74f7c":"data.isnull().sum()","3c84232e":"sns.heatmap(data.corr(), annot=True)","cd97c4a3":"plt.figure(figsize=(10,7))\nsns.barplot(x='model',y='price', data=data)","248193b6":"plt.figure(figsize=(10,7))\nsns.barplot(x='engineSize', y='price', data=data)","6f995923":"plt.figure(figsize=(10,7))\nsns.boxplot(x='year', y='price', data = data)","4a5d9840":"plt.figure(figsize=(5,5))\nsns.barplot(x='fuelType', y='price', data=data)\n","fe61ed31":"data['model'] = data['model'].astype('object')","72c613f9":"data['price1'] = data['price']","339a3326":"data = data.drop(columns=['price'])","12d9e0cf":"data = pd.DataFrame(data)\ndata.head()","0ad609f9":"X = data.iloc[:,:-1]\nX.head()","8592910d":"from sklearn.preprocessing import LabelEncoder\n\nX['model'] = LabelEncoder().fit_transform(X['model'].values.reshape(-1,1))\nX['transmission'] = LabelEncoder().fit_transform(X['transmission'].values.reshape(-1,1))\nX['fuelType'] = LabelEncoder().fit_transform(X['fuelType'].values.reshape(-1,1))\nX['engineSize'] = LabelEncoder().fit_transform(X['engineSize'].values.reshape(-1,1))","fed4f92a":"X","a89c2fde":"from scipy.stats import zscore\nXScaled=X.apply(zscore)","03338648":"XScaled","339ef56d":"y = data.iloc[:,-1]\ny.head()","8248811b":"from sklearn.model_selection import train_test_split\n\nX_train,X_test,y_train,y_test = train_test_split(XScaled,y,test_size=0.3, random_state=1)","888597af":"from sklearn.linear_model import LinearRegression\n\nlr = LinearRegression()\n\nlr.fit(X_train,y_train)","da779a13":"score1 = lr.score(X_train,y_train)\nprint(score1)","18d00c63":"from sklearn.model_selection import cross_val_score\n\nscore2 = cross_val_score(lr, XScaled, y, cv = 10).mean()\nscore2","6f1e03e6":"from sklearn.svm import SVR\n\nsvr_regressor = SVR()\n\nsvr_regressor.fit(X_train,y_train)\n","a4c70157":"score3 = svr_regressor.score(X_train,y_train)\nscore3","01a1a5af":"score4 = cross_val_score(svr_regressor, XScaled, y, cv = 10).mean()\nscore4","316bb65a":"from sklearn.model_selection import GridSearchCV\n","11023441":"from sklearn.tree import DecisionTreeRegressor\n\nregr_1 = DecisionTreeRegressor(max_depth=2)\n\nregr_1.fit(X_train, y_train)\n\nscore5 = regr_1.score(X_train,y_train)\nscore5","7b11f2ce":"regr_2 = DecisionTreeRegressor(max_depth=5)\n\nregr_2.fit(X_train, y_train)\n\nscore6 = regr_2.score(X_train,y_train)\nscore6","549221d2":"score7 = cross_val_score(regr_1, XScaled, y, cv = 10).mean()\nscore7","afa9eabf":"score8 = cross_val_score(regr_2, XScaled, y, cv = 10).mean()\nscore8","b2efd5f6":"data1 = {'Technique' : ['Linear Regression', \"LR with CV \", 'SVR', 'SVR with CV', 'Decision Tree(max_dep=2)',\n                       'Decision Tree(max_dep=2) with CV' ,'Decision Tree(max_dep=5)', 'Decision Tree(max_dep=5) with CV'],\n       'Score' : [score1, score2, score3, score4, score5, score7, score6, score8] }\n\nresult = pd.DataFrame(data1)\nresult","63534a34":"score9 = regr_2.score(X_test,y_test)","56c27e15":"score9","5ee9e07b":"y_pred = regr_2.predict(X_test)","f072fdd3":"y_pred","b82304c5":"data['predicted_price'] = regr_2.predict(XScaled)","8604b1e6":"data","550b8d7f":"### Looks Good!! \n#### Lets start with Data Pre-Processing","a60fa48a":"### We clear that newer cars demand higher price","cdd8cf87":"## Accuracy of 99.59% with Decision Tree Classifier","bbf09efb":"#### Year and mileage is having the highest negative correlation. Older cars has more mileage\n#### Price and mileage is also having negative correlation. More mileage has negative impact on the pricing\n#### mpg and tax is also having negative correlation where more mpg lesser the tax","5287e62b":"#### Lets change the model to category variable and separate the predictors and target variables","ca876717":"#### Diesel and Petrol are more or less same\n#### Hybrids demand more price than the rest","e14d73dc":"### Looks like there are total of 10668 rows and 9 coulmns in the data set","221178f6":"### EDA","4d20916d":"#### There are no null values","28fcb067":"## Data looks good for me based on the initial EDA","db250596":"#### There are 26 unique models of Audi Cars\n#### Average price of a car is at 20200 euros\n#### Average mileage is at 19000\n#### Guess Engine size should be a categorical variable. Lets Change that to category and check.\n#### Also I can see that min(engineSize) = 0.00 which cannot be the case. We might have to impute some values.","7eced76b":"### Import dataset","210d719b":"#### Now Lets do describe and check again","1aec8c66":"#### Looks like audi R8 is having the maximum price\n#### Audi A1 amd A2 are demanding lesser price","2627bcde":"#### We can observe the skewed distribution. More the engine size more the price"}}