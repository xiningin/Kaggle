{"cell_type":{"a11660d6":"code","16dfd247":"code","93eb645b":"code","8882cf91":"code","4a32b9dd":"code","a9807390":"code","b9ee395b":"code","38c3f505":"code","64ad0e52":"code","90e12ef8":"code","6cc1177c":"code","13ae5e91":"code","c0c6b01b":"code","9a2a7ddc":"code","c38d2762":"code","1d0b222b":"code","e7be05ff":"code","e46a3986":"code","81c0dc3f":"code","5d98950c":"code","e84db46d":"code","4abc3f0b":"code","569fee7d":"code","18eeef66":"code","cd291d42":"code","6f2401a2":"code","2711a530":"code","263e8abf":"code","f7118f99":"code","a609e52d":"code","04ccf114":"code","eff96417":"code","5728a597":"code","009860ea":"code","c3610815":"code","078dd0d6":"code","bad08d35":"code","e88fd9a4":"code","b8b1edbc":"code","2a80ee60":"code","842a41c3":"code","b0b25e65":"code","579d90fc":"code","92f9e0eb":"code","9e90b446":"code","722c3723":"code","e2416696":"code","7bd87687":"code","3d9602dc":"code","893d1aa8":"code","892a1a3c":"code","0da909b2":"code","25eca45a":"code","d7eedb10":"code","3d2168c0":"code","6e959c23":"code","51daa686":"code","487779ec":"code","6a6943ae":"code","2b6bcfd4":"code","40e0f92e":"code","ff8bf0dc":"code","9fd34a0a":"code","5ded19cf":"code","5223ad5e":"code","544f3c49":"code","68fc5d55":"code","8e6bc34c":"code","5e409207":"code","a8c50a03":"code","cbb13bc8":"code","3bfac357":"code","c4c21af4":"code","e31313f1":"code","ac34c72f":"code","af3b2034":"code","e1edff88":"code","ba01f359":"code","a9e47727":"code","5c719ed6":"code","94f02b14":"code","c3858f8e":"code","8abdd14d":"code","3f74eac0":"code","17b42c9f":"code","1a522c06":"code","5c978fb7":"code","daed8c99":"code","44548bc2":"code","969252e3":"code","84df7f56":"code","889293e7":"code","881c1e7e":"code","83bf8258":"code","5129da5d":"code","223316be":"code","a15c5e3e":"code","c6551e40":"code","7236d786":"code","c75fd33b":"code","0fb76cc0":"code","393e0c19":"code","7c54debf":"code","990ebe0b":"code","01a7c2a8":"code","63ed1c25":"code","e769a821":"code","53ee8265":"code","b5fc6cf1":"code","9e416951":"code","274fbd66":"code","4f0a97e9":"code","ecaea9aa":"code","34857e0d":"code","b927fafe":"code","c47e34d5":"code","e19818be":"code","91c8b998":"code","9aa304f9":"code","2002fa8d":"code","de05a241":"code","cd1ed3ff":"code","0b2a5eb9":"code","81bbfb01":"code","3154e27c":"code","dfa366fe":"code","e431279a":"code","1e346808":"markdown","dffa9e1f":"markdown","cebd3c04":"markdown","4c7ed0f8":"markdown","69b26fd6":"markdown"},"source":{"a11660d6":"#libraries to use\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\n\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.preprocessing import minmax_scale\n\n# to ignore warnings\nimport warnings\nwarnings.filterwarnings('ignore')\n\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.utils import resample\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import accuracy_score,confusion_matrix,f1_score\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.feature_selection import  SelectFromModel\n","16dfd247":"#data\npd.set_option('display.max_columns', None)\ncensus_data_train = pd.read_csv(\"https:\/\/raw.githubusercontent.com\/dphi-official\/Datasets\/master\/Census_Income\/Training_set_census.csv\" )\ncensus_data_holdout = pd.read_csv('https:\/\/raw.githubusercontent.com\/dphi-official\/Datasets\/master\/Census_Income\/Testing_set_census.csv')\nprint(census_data_train.head())\nout=census_data_train['income_level']\nsns.countplot(x='income_level',data=census_data_train)","93eb645b":"#information about data\nprint(census_data_train.info())\nprint(census_data_holdout.info())","8882cf91":"#Removing the columnsn which has most null values\ncensus_data_train.dropna(thresh=133338,axis=1,inplace=True)\ncensus_data_holdout.dropna(thresh=33278,axis=1,inplace=True)","4a32b9dd":"census_data_train['hispanic_origin'].value_counts(dropna=False)","a9807390":"census_data_train['hispanic_origin']=census_data_train['hispanic_origin'].str.lower().str.strip()\ncensus_data_train['hispanic_origin']=census_data_train['hispanic_origin'].fillna(census_data_train['hispanic_origin'].mode().iloc[0])\ncensus_data_holdout['hispanic_origin']=census_data_holdout['hispanic_origin'].str.lower().str.strip()\ncensus_data_holdout['hispanic_origin']=census_data_holdout['hispanic_origin'].fillna(census_data_holdout['hispanic_origin'].mode().iloc[0])","b9ee395b":"census_data_train['state_of_previous_residence'].value_counts(dropna=False)","38c3f505":"census_data_train['state_of_previous_residence']=census_data_train['state_of_previous_residence'].str.lower().str.strip()\ncensus_data_train['state_of_previous_residence']=census_data_train['state_of_previous_residence'].replace('?',np.nan)\ncensus_data_train['state_of_previous_residence']=census_data_train['state_of_previous_residence'].fillna(census_data_train['state_of_previous_residence'].mode().iloc[0])\n\ncensus_data_holdout['state_of_previous_residence']=census_data_holdout['state_of_previous_residence'].str.lower().str.strip()\ncensus_data_holdout['state_of_previous_residence']=census_data_holdout['state_of_previous_residence'].replace('?',np.nan)\ncensus_data_holdout['state_of_previous_residence']=census_data_holdout['state_of_previous_residence'].fillna(census_data_holdout['state_of_previous_residence'].mode().iloc[0])\n","64ad0e52":"census_data_holdout['country_father'].value_counts(dropna=False)","90e12ef8":"census_data_train['country_father']=census_data_train['country_father'].str.lower().str.strip()\ncensus_data_train['country_father']=census_data_train['country_father'].replace('?',np.nan)\ncensus_data_train['country_father']=census_data_train['country_father'].fillna(census_data_train['country_father'].mode().iloc[0])\n\ncensus_data_holdout['country_father']=census_data_holdout['country_father'].str.lower().str.strip()\ncensus_data_holdout['country_father']=census_data_holdout['country_father'].replace('?',np.nan)\ncensus_data_holdout['country_father']=census_data_holdout['country_father'].fillna(census_data_holdout['country_father'].mode().iloc[0])\n\n\n","6cc1177c":"census_data_holdout['country_mother'].value_counts(dropna=False)","13ae5e91":"census_data_train['country_mother']=census_data_train['country_mother'].str.lower().str.strip()\ncensus_data_train['country_mother']=census_data_train['country_mother'].replace('?',np.nan)\ncensus_data_train['country_mother']=census_data_train['country_mother'].fillna(census_data_train['country_mother'].mode().iloc[0])\n\ncensus_data_holdout['country_mother']=census_data_holdout['country_mother'].str.lower().str.strip()\ncensus_data_holdout['country_mother']=census_data_holdout['country_mother'].replace('?',np.nan)\ncensus_data_holdout['country_mother']=census_data_holdout['country_mother'].fillna(census_data_holdout['country_mother'].mode().iloc[0])\n\n\n","c0c6b01b":"census_data_holdout['country_self'].value_counts(dropna=False)\n\n","9a2a7ddc":"census_data_train['country_self']=census_data_train['country_self'].str.lower().str.strip()\ncensus_data_train['country_self']=census_data_train['country_self'].replace('?',np.nan)\ncensus_data_train['country_self']=census_data_train['country_self'].fillna(census_data_train['country_self'].mode().iloc[0])\n\n\ncensus_data_holdout['country_self']=census_data_holdout['country_self'].str.lower().str.strip()\ncensus_data_holdout['country_self']=census_data_holdout['country_self'].replace('?',np.nan)\ncensus_data_holdout['country_self']=census_data_holdout['country_self'].fillna(census_data_holdout['country_self'].mode().iloc[0])\n","c38d2762":"census_data_holdout.isnull().sum()\n","1d0b222b":"print(census_data_train.info())\nprint(census_data_holdout.info())","e7be05ff":"census_data_holdout['class_of_worker'].value_counts()","e46a3986":"census_data_train['class_of_worker']=census_data_train['class_of_worker'].str.lower().str.strip()\ncensus_data_holdout['class_of_worker']=census_data_holdout['class_of_worker'].str.lower().str.strip()","81c0dc3f":"#Seeing the correlation using catlplot\nsns.catplot(x='class_of_worker',y='income_level',data=census_data_train,kind='bar',height=6,legend=True,legend_out=True)\nplt.xticks(rotation=90)","5d98950c":"sns.countplot(x='class_of_worker',data=census_data_train)\nplt.xticks(rotation=90)","e84db46d":"census_data_holdout['education'].value_counts()","4abc3f0b":"census_data_train['education']=census_data_train['education'].str.lower().str.strip()\ncensus_data_holdout['education']=census_data_holdout['education'].str.lower().str.strip()","569fee7d":"sns.catplot(x='education',y='income_level',data=census_data_train,kind='bar',height=6,legend=True,legend_out=True)\nplt.xticks(rotation=90)","18eeef66":"sns.countplot(x='education',data=census_data_train)\nplt.xticks(rotation=90)","cd291d42":"census_data_holdout['enrolled_in_edu_inst_lastwk'].value_counts()","6f2401a2":"census_data_train['enrolled_in_edu_inst_lastwk']=census_data_train['enrolled_in_edu_inst_lastwk'].str.lower().str.strip()\ncensus_data_holdout['enrolled_in_edu_inst_lastwk']=census_data_holdout['enrolled_in_edu_inst_lastwk'].str.lower().str.strip()","2711a530":"sns.catplot(x='enrolled_in_edu_inst_lastwk',y='income_level',data=census_data_train,kind='bar',height=6,legend=True,legend_out=True)\nplt.xticks(rotation=90)","263e8abf":"census_data_holdout['marital_status'].value_counts()","f7118f99":"census_data_train['marital_status']=census_data_train['marital_status'].str.lower().str.strip()\ncensus_data_holdout['marital_status']=census_data_holdout['marital_status'].str.lower().str.strip()\n#census_data_train['marital_status'].replace('married-a f spouse present','married-civilian spouse present',inplace=True)\n#census_data_holdout['marital_status'].replace('married-a f spouse present','married-civilian spouse present',inplace=True)","a609e52d":"sns.catplot(x='marital_status',y='income_level',data=census_data_train,kind='bar',height=6,legend=True,legend_out=True)\nplt.xticks(rotation=90)","04ccf114":"census_data_holdout['major_industry_code'].value_counts()","eff96417":"census_data_train['major_industry_code']=census_data_train['major_industry_code'].str.lower().str.strip()\ncensus_data_holdout['major_industry_code']=census_data_holdout['major_industry_code'].str.lower().str.strip()","5728a597":"census_data_holdout['major_occupation_code'].value_counts()","009860ea":"census_data_train['major_occupation_code']=census_data_train['major_occupation_code'].str.lower().str.strip()\ncensus_data_holdout['major_occupation_code']=census_data_holdout['major_occupation_code'].str.lower().str.strip()","c3610815":"sns.catplot(x='major_industry_code',y='income_level',data=census_data_train,kind='bar',height=6,legend=True,legend_out=True)\nplt.xticks(rotation=90)","078dd0d6":"sns.catplot(x='major_occupation_code',y='income_level',data=census_data_train,kind='bar',height=6,legend=True,legend_out=True)\nplt.xticks(rotation=90)","bad08d35":"census_data_holdout['race'].value_counts()","e88fd9a4":"census_data_train['race']=census_data_train['race'].str.lower().str.strip()\ncensus_data_holdout['race']=census_data_holdout['race'].str.lower().str.strip()","b8b1edbc":"census_data_holdout['sex'].value_counts()","2a80ee60":"census_data_train['sex']=census_data_train['sex'].str.lower().str.strip()\ncensus_data_holdout['sex']=census_data_holdout['sex'].str.lower().str.strip()","842a41c3":"census_data_train['hispanic_origin'].value_counts()","b0b25e65":"sns.catplot(x='race',y='income_level',data=census_data_train,kind='bar',height=6,legend=True,legend_out=True)\nplt.xticks(rotation=90)","579d90fc":"sns.catplot(x='sex',y='income_level',data=census_data_train,kind='bar',height=6,legend=True,legend_out=True)\nplt.xticks(rotation=90)","92f9e0eb":"sns.catplot(x='hispanic_origin',y='income_level',data=census_data_train,kind='bar',height=6,legend=True,legend_out=True)\nplt.xticks(rotation=90)","9e90b446":"census_data_holdout['member_of_labor_union'].value_counts()","722c3723":"census_data_train['member_of_labor_union']=census_data_train['member_of_labor_union'].str.lower().str.strip()\ncensus_data_holdout['member_of_labor_union']=census_data_holdout['member_of_labor_union'].str.lower().str.strip()","e2416696":"sns.catplot(x='member_of_labor_union',y='income_level',data=census_data_train,kind='bar',height=6,legend=True,legend_out=True)\nplt.xticks(rotation=90)","7bd87687":"grouped = census_data_train.groupby(\"member_of_labor_union\").aggregate(np.mean)\ngrouped['income_level']","3d9602dc":"census_data_train['reason_for_unemployment'].value_counts()","893d1aa8":"census_data_train['reason_for_unemployment']=census_data_train['reason_for_unemployment'].str.lower().str.strip()\ncensus_data_holdout['reason_for_unemployment']=census_data_holdout['reason_for_unemployment'].str.lower().str.strip()","892a1a3c":"sns.catplot(x='reason_for_unemployment',y='income_level',data=census_data_train,kind='bar',height=6,legend=True,legend_out=True)\nplt.xticks(rotation=90)","0da909b2":"census_data_holdout['full_parttime_employment_stat'].value_counts()","25eca45a":"census_data_train['full_parttime_employment_stat']=census_data_train['full_parttime_employment_stat'].str.lower().str.strip()\ncensus_data_holdout['full_parttime_employment_stat']=census_data_holdout['full_parttime_employment_stat'].str.lower().str.strip()","d7eedb10":"sns.catplot(x='full_parttime_employment_stat',y='income_level',data=census_data_train,kind='bar',height=6,legend=True,legend_out=True)\nplt.xticks(rotation=90)","3d2168c0":"census_data_holdout['region_of_previous_residence'].value_counts()","6e959c23":"census_data_train['region_of_previous_residence']=census_data_train['region_of_previous_residence'].str.lower().str.strip()\ncensus_data_holdout['region_of_previous_residence']=census_data_holdout['region_of_previous_residence'].str.lower().str.strip()","51daa686":"census_data_train['state_of_previous_residence'].value_counts()","487779ec":"\nsns.catplot(x='state_of_previous_residence',y='income_level',data=census_data_train,kind='bar',height=6,legend=True,legend_out=True);\nplt.xticks(rotation=90)","6a6943ae":"sns.catplot(x='region_of_previous_residence',y='income_level',data=census_data_train,kind='bar',height=6,legend=True,legend_out=True)\nplt.xticks(rotation=90)","2b6bcfd4":"pd.set_option('display.max_rows', None)\ncensus_data_train['d_household_family_stat'].value_counts().sort_index()","40e0f92e":"census_data_train['d_household_family_stat']=census_data_train['d_household_family_stat'].str.lower().str.strip()\ncensus_data_holdout['d_household_family_stat']=census_data_holdout['d_household_family_stat'].str.lower().str.strip()\ncensus_data_holdout['d_household_family_stat']=census_data_holdout['d_household_family_stat'].replace(\n    'grandchild <18 ever marr not in subfamily','grandchild <18 never marr not in subfamily')","ff8bf0dc":"census_data_holdout['d_household_summary'].value_counts().sort_index()","9fd34a0a":"census_data_train['d_household_summary']=census_data_train['d_household_summary'].str.lower().str.strip()\ncensus_data_holdout['d_household_summary']=census_data_holdout['d_household_summary'].str.lower().str.strip()","5ded19cf":"sns.catplot(x='d_household_summary',y='income_level',data=census_data_train,kind='bar',height=6,legend=True,legend_out=True)\nplt.xticks(rotation=90)","5223ad5e":"\nsns.catplot(x='d_household_family_stat',y='income_level',data=census_data_train,kind='bar',height=6,legend=True,legend_out=True)\n\nplt.xticks(rotation=90)","544f3c49":"census_data_holdout['tax_filer_status'].value_counts()","68fc5d55":"census_data_train['tax_filer_status']=census_data_train['tax_filer_status'].str.lower().str.strip()\ncensus_data_holdout['tax_filer_status']=census_data_holdout['tax_filer_status'].str.lower().str.strip()","8e6bc34c":"sns.catplot(x='tax_filer_status',y='income_level',data=census_data_train,kind='bar',height=6,legend=True,legend_out=True)\nplt.xticks(rotation=90)","5e409207":"census_data_train['live_1_year_ago'].value_counts()","a8c50a03":"census_data_train['live_1_year_ago']=census_data_train['live_1_year_ago'].str.lower().str.strip()\ncensus_data_holdout['live_1_year_ago']=census_data_holdout['live_1_year_ago'].str.lower().str.strip()","cbb13bc8":"sns.catplot(x='live_1_year_ago',y='income_level',data=census_data_train,kind='bar',height=6,legend=True,legend_out=True)\nplt.xticks(rotation=90)","3bfac357":"sns.catplot(x='country_father',y='income_level',data=census_data_train,kind='bar',height=6,legend=True,legend_out=True)\nplt.xticks(rotation=90)","c4c21af4":"sns.catplot(x='country_mother',y='income_level',data=census_data_train,kind='bar',height=6,legend=True,legend_out=True)\nplt.xticks(rotation=90)","e31313f1":"sns.catplot(x='country_self',y='income_level',data=census_data_train,kind='bar',height=6,legend=True,legend_out=True)\nplt.xticks(rotation=90)","ac34c72f":"census_data_holdout['citizenship'].value_counts()","af3b2034":"census_data_train['citizenship']=census_data_train['citizenship'].str.lower().str.strip()\ncensus_data_holdout['citizenship']=census_data_holdout['citizenship'].str.lower().str.strip()\n\n","e1edff88":"census_data_holdout['family_members_under_18'].value_counts()","ba01f359":"census_data_train['family_members_under_18']=census_data_train['family_members_under_18'].str.lower().str.strip()\ncensus_data_holdout['family_members_under_18']=census_data_holdout['family_members_under_18'].str.lower().str.strip()","a9e47727":"sns.catplot(x='family_members_under_18',y='income_level',data=census_data_train,kind='bar',height=6,legend=True,legend_out=True)\nplt.xticks(rotation=90)","5c719ed6":"sns.catplot(x='citizenship',y='income_level',data=census_data_train,kind='bar',height=6,legend=True,legend_out=True)\nplt.xticks(rotation=90)","94f02b14":"census_data_holdout['fill_questionnaire_veteran_admin'].value_counts()","c3858f8e":"census_data_train['fill_questionnaire_veteran_admin']=census_data_train['fill_questionnaire_veteran_admin'].str.lower().str.strip()\ncensus_data_holdout['fill_questionnaire_veteran_admin']=census_data_holdout['fill_questionnaire_veteran_admin'].str.lower().str.strip()","8abdd14d":"sns.catplot(x='fill_questionnaire_veteran_admin',y='income_level',data=census_data_train,kind='bar',height=6,legend=True,legend_out=True)\nplt.xticks(rotation=90)","3f74eac0":"census_data_train.describe(include=[\"int64\"])","17b42c9f":"income_greater=census_data_train[census_data_train['income_level']==1]\nincome_lesser=census_data_train[census_data_train['income_level']==0]\nincome_greater['capital_gains'].plot.hist(alpha=0.8,color='Red',bins=5)\nincome_lesser['capital_gains'].plot.hist(alpha=0.2,color='Blue',bins=5)\nplt.legend(['greater','lesser'])","1a522c06":"income_greater=census_data_train[census_data_train['income_level']==1]\nincome_lesser=census_data_train[census_data_train['income_level']==0]\nincome_greater['industry_code'].plot.hist(alpha=0.8,color='Red',bins=5)\nincome_lesser['industry_code'].plot.hist(alpha=0.2,color='Blue',bins=5)\nplt.legend(['greater','lesser'])","5c978fb7":"f,ax=plt.subplots(figsize=(20,20))\nsns.heatmap(census_data_holdout.corr(),cmap='Blues',square=True,xticklabels='auto',annot=True)","daed8c99":"census_data_train.info()\ncensus_data_holdout.info()","44548bc2":"def create_dummies(df,column_name):\n    dummies=pd.get_dummies(df[column_name],prefix=column_name)\n    df=pd.concat([df,dummies],axis=1)\n    del df[column_name]\n    return df\nfor col in census_data_train.select_dtypes(include=['object']).columns:\n    census_data_train=create_dummies(census_data_train,col)\n    census_data_holdout=create_dummies(census_data_holdout,col)","969252e3":"census_data_train.head()","84df7f56":"X=census_data_train.drop(columns=['income_level'])\nY=census_data_train.income_level\nprint(X.shape)\n","889293e7":"print(Y.shape)","881c1e7e":"#census_data_holdout['d_household_family_stat_grandchild <18 never marr rp of subfamily']\n#census_data_holdout['d_household_family_stat_other rel <18 spouse of subfamily rp']\n#census_data_holdout['d_household_family_stat_other rel <18 ever marr not in subfamily']\n","83bf8258":"X=X.drop(columns=['d_household_family_stat_grandchild <18 never marr rp of subfamily',\n               'd_household_family_stat_other rel <18 spouse of subfamily rp',\n              'd_household_family_stat_other rel <18 ever marr not in subfamily'])","5129da5d":"print(census_data_holdout.shape)","223316be":"X.shape","a15c5e3e":"census_data_holdout.columns==X.columns","c6551e40":"\nscaler = StandardScaler()\n\nX=pd.DataFrame(scaler.fit_transform(X),columns=X.columns)\ncensus_data_holdout=pd.DataFrame(scaler.fit_transform(census_data_holdout),columns=census_data_holdout.columns)\n","7236d786":"X.head()","c75fd33b":"train_X,test_X,train_y,test_y= train_test_split(X,Y,test_size=0.3,random_state=42)","0fb76cc0":"train_data1=pd.concat([train_X,train_y],axis=1)\nnot_greater_income1=train_data1[train_data1.income_level==0]\ngreater_income1=train_data1[train_data1.income_level==1]","393e0c19":"income_downsampled= resample(not_greater_income1,replace=False,n_samples=len(greater_income1),random_state=27)","7c54debf":"downsampled=pd.concat([income_downsampled,greater_income1])","990ebe0b":"downsampled.income_level.value_counts()","01a7c2a8":"downsampled.head()","63ed1c25":"train_data=pd.concat([train_X,train_y],axis=1)\nnot_greater_income=train_data[train_data.income_level==0]\ngreater_income=train_data[train_data.income_level==1]\n","e769a821":"income_upsampled= resample(greater_income,replace=True,n_samples=len(not_greater_income),random_state=27)","53ee8265":"upsampled=pd.concat([not_greater_income,income_upsampled])","b5fc6cf1":"upsampled.income_level.value_counts()","9e416951":"upsampled.head()","274fbd66":"XX=upsampled.drop(columns=['income_level'])\nYY=upsampled['income_level']\nXX.shape","4f0a97e9":"lr=LogisticRegression()\ntrain_X,test_X,train_y,test_y= train_test_split(XX,YY,test_size=0.3,random_state=21)\nlr.fit(train_X,train_y)\npredictions=lr.predict(test_X)\naccuracy=accuracy_score(test_y,predictions)\nprint(\"Accuracy of Logistic Regression\",accuracy)\nprint(confusion_matrix(test_y,predictions))\nprint(f1_score(test_y, predictions))","ecaea9aa":"predictions=lr.predict(census_data_holdout)\nprint(predictions)","34857e0d":"res = pd.DataFrame(predictions) #preditcions are nothing but the final predictions of your model on input features of your new unseen test data\nres.index = census_data_holdout.index # its important for comparison. Here \"test_new\" is your new test dataset\nres.columns = [\"prediction\"]\nres.to_csv(\"prediction_results_HP.csv\",index=False)","b927fafe":"train_X,test_X,train_y,test_y= train_test_split(XX,YY,test_size=0.3,random_state=42)\nclf=RandomForestClassifier(n_estimators=1000,random_state=42,n_jobs=-1)\nclf.fit(train_X,train_y)","c47e34d5":"feat_labels=XX.columns.to_list()\nprint(len(feat_labels))","e19818be":"for feature in zip(feat_labels, clf.feature_importances_):\n    print(feature)","91c8b998":"predictions=clf.predict(test_X)\naccuracy=accuracy_score(test_y,predictions)\nprint(\"Accuracy of Random Forest\",accuracy)\nprint(confusion_matrix(test_y,predictions))\nprint(f1_score(test_y, predictions))","9aa304f9":"predictions=clf.predict(census_data_holdout)\nprint(predictions)\nres = pd.DataFrame(predictions) #preditcions are nothing but the final predictions of your model on input features of your new unseen test data\nres.index = census_data_holdout.index # its important for comparison. Here \"test_new\" is your new test dataset\nres.columns = [\"prediction\"]\nres.to_csv(\"prediction_results_HP1.csv\",index=False)","2002fa8d":"sfm=SelectFromModel(clf,threshold=0.0005)\nsfm.fit(train_X,train_y)","de05a241":"for feature_list_index in sfm.get_support(indices=True):\n    print(feat_labels[feature_list_index])","cd1ed3ff":"census_data_train_important=sfm.transform(train_X)\ncensus_data_holdout_important=sfm.transform(test_X)","0b2a5eb9":"print(census_data_holdout_important.shape)","81bbfb01":"clf_important=RandomForestClassifier(n_estimators=1000,random_state=0,n_jobs=-1)\nclf_important.fit(census_data_train_important,train_y)","3154e27c":"predictions_important=clf_important.predict(census_data_holdout_important)\naccuracy=accuracy_score(test_y,predictions_important)\nprint(\"Accuracy of feature selected Random Forest\",accuracy)\nprint(confusion_matrix(test_y,predictions_important))\nprint(f1_score(test_y, predictions_important))\nprint(predictions_important)\n","dfa366fe":"census_data_holdout_important1=sfm.transform(census_data_holdout)\npredictions=clf_important.predict(census_data_holdout_important1)\nprint(predictions)","e431279a":"res = pd.DataFrame(predictions) #preditcions are nothing but the final predictions of your model on input features of your new unseen test data\nres.index = census_data_holdout.index # its important for comparison. Here \"test_new\" is your new test dataset\nres.columns = [\"prediction\"]\nres.to_csv(\"prediction_results_HP2.csv\",index=False)","1e346808":"F1-Score of around 59.8 in Leaderboard","dffa9e1f":"# Income Prediction","cebd3c04":"# Checking each column values to understand the categories for preprocessing","4c7ed0f8":"# Data Preprocessing","69b26fd6":"# Model Building"}}