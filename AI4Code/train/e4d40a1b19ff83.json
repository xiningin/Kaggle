{"cell_type":{"217f9149":"code","06b66d65":"code","6674c2f3":"code","b73b2b34":"code","b93cd7cb":"code","e3da774b":"code","391255f6":"code","57529319":"markdown","adfa2acf":"markdown","78e39494":"markdown","9f3c56ba":"markdown","6eb6a0cd":"markdown","bba46cf1":"markdown","166473c2":"markdown","864ea548":"markdown","bf59efe5":"markdown","17a12447":"markdown","af151b92":"markdown"},"source":{"217f9149":"from pandas import Series, DataFrame\nimport pandas as pd\nimport numpy as np\nimport os\nimport matplotlib.pylab as plt\nfrom sklearn.model_selection  import train_test_split\nfrom sklearn.linear_model import LinearRegression\nimport sklearn.metrics\n\nraw_data = pd.read_csv(\"..\/input\/history\/history.csv\")\n\nraw_data.dtypes\n","06b66d65":"raw_data.head()","6674c2f3":"#Drop CUST_ID as it is not needed for analysis\ncleaned_data = raw_data.drop(\"CUST_ID\",axis=1)\ncleaned_data.corr()['CLV']","b73b2b34":"predictors = cleaned_data.drop(\"CLV\",axis=1)\ntargets = cleaned_data.CLV\n\npred_train, pred_test, tar_train, tar_test  =   train_test_split(predictors, targets, test_size=.1)\nprint( \"Predictor - Training : \", pred_train.shape, \"Predictor - Testing : \", pred_test.shape )\n","b93cd7cb":"#Build model on training data\nmodel = LinearRegression()\nmodel.fit(pred_train,tar_train)\nprint(\"Coefficients: \\n\", model.coef_)\nprint(\"Intercept:\", model.intercept_)\n\n#Test on testing data\npredictions = model.predict(pred_test)\npredictions\n\nsklearn.metrics.r2_score(tar_test, predictions)","e3da774b":"new_data = np.array([100,0,50,0,0,0]).reshape(1, -1)\nnew_pred=model.predict(new_data) \nprint(\"The CLV for the new customer is : $\",new_pred[0])","391255f6":"new_data = np.array([100,60,50,400,0,0]).reshape(1, -1)\nnew_pred=model.predict(new_data) \nprint(\"The CLV for the new customer is : $\",new_pred[0])","57529319":" #  <p style=\"text-align: center;\">Customer Lifetime Value Prediction<\/p> ","adfa2acf":"## Predicting for a new Customer\nLet us say we have a new customer who in his first 3 months have spend 100,0,50 on your website. Let us use the model to predict his CLV.","78e39494":"We can see that the months do show strong correlation to the target variable (CLV). That should give us confidence that we can build a strong model to predict the CLV","9f3c56ba":"Let us say we have a customer who in his first 4 months have spend 100,60,50,400 on your website. Let us use the model to predict his CLV.","6eb6a0cd":"It shows a 92% accuracy. This is an excellent model for predicting CLV","bba46cf1":"## Do Training and Testing Split\n\nLet us split the data into training and testing datasets in the ratio 90:10.","166473c2":"## Loading and Viewing Data\nWe will load the data file for this example and checkout summary statistics and columns for that file.","864ea548":"The dataset consists of the customer ID, the amount the customer spent on your website for the first months of his relationship with your business and his ultimate life time value ( say 3 years worth)","bf59efe5":"In this example, we will use past purchase history of your customers to build a model that can predict the Customer Lifetime Value (CLV) for new customers","17a12447":"## Build and Test Model\nWe build a Linear Regression equation for predicting CLV and then check its accuracy by predicting against the test dataset","af151b92":"## Do Correlation Analysis"}}