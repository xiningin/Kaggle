{"cell_type":{"184d1040":"code","8ca4517e":"code","24efb792":"code","902ef468":"code","57ea5023":"code","d92e17df":"code","aa357234":"code","ce5a764a":"code","78ded069":"code","3e522ec4":"code","9ff079c2":"code","136aeac8":"code","83baaef1":"code","a032338e":"code","d740b973":"code","41700e5a":"code","6ebe06a2":"code","271dfee6":"code","f507c5b5":"code","901c713a":"code","202001c4":"code","9689d2e4":"markdown","49567af2":"markdown","85c10a2c":"markdown","bbc548e3":"markdown","ff03da29":"markdown","52f4d0bf":"markdown","51e510d8":"markdown","c301c726":"markdown","1f283cab":"markdown","9d16bf2f":"markdown","12f87e06":"markdown","8cbbe8f3":"markdown","e7cff8e6":"markdown","30059739":"markdown"},"source":{"184d1040":"# import libraries\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nfrom plotnine import *\nfrom mizani.formatters import percent_format","8ca4517e":"# Import Data\nbechdel_df = pd.read_csv('..\/input\/movie-bechdel-test-scores\/Bechdel_detailed.csv')\nbechdel_df.rename(columns={'rating': 'bt_score'}, inplace=True) # I find the name rating a little confusing\nbechdel_df","24efb792":"# Check empty values\nbechdel_df.info()","902ef468":"bechdel_df = bechdel_df.dropna().reset_index(drop=True)\nbechdel_df","57ea5023":"# Check descriptive stats\nbechdel_df.describe().T","d92e17df":"(ggplot(bechdel_df, aes(x = 'bt_score')) + \n    geom_bar(fill='skyblue') + \n    geom_text(\n        aes(label=after_stat('count')),\n        stat='count',\n        nudge_y=0.125,\n        va='bottom'\n    ) +\n    labs(\n        title = 'Distribution of Bechdel scores for all movies',\n        x = 'Bechdel Test Score',\n        y = 'Frequency'\n    )\n)","aa357234":"score_count_series = bechdel_df['bt_score'].value_counts()\ngap = [0.1, 0, 0, 0]\nplt.pie(np.array(score_count_series), labels = score_count_series.index, explode = gap, autopct='%.2f%%')\nplt.show() ","ce5a764a":"dubious_count = bechdel_df['dubious'].value_counts()\nprint('Percentage of dubious movie scores:', str('{:.2f}'.format(dubious_count[1.0] \/ (dubious_count[1.0] + dubious_count[0.0]) * 100))+'%')","78ded069":"dubious_movies = bechdel_df[bechdel_df['dubious'] == 1]\ndubious_movies","3e522ec4":"print('Proportion of movies scored 0:', str('{:.2f}'.format(sum(dubious_movies['bt_score'] == 0.0) \/ len(dubious_movies) * 100))+'%')\nprint('Proportion of movies scored 1:', str('{:.2f}'.format(sum(dubious_movies['bt_score'] == 1.0) \/ len(dubious_movies) * 100))+'%')\nprint('Proportion of movies scored 2:', str('{:.2f}'.format(sum(dubious_movies['bt_score'] == 2.0) \/ len(dubious_movies) * 100))+'%')\nprint('Proportion of movies scored 3:', str('{:.2f}'.format(sum(dubious_movies['bt_score'] == 3.0) \/ len(dubious_movies) * 100))+'%')","9ff079c2":"# adding a new column that specifies 0, 1, 2, 3 and dubious in the original dataframe\nfor index, bt_score in bechdel_df['bt_score'].iteritems():\n    if bt_score == 0:\n        if bechdel_df.at[index, 'dubious'] == 1:\n            bechdel_df.at[index, 'category'] = 'Dubious'\n        else:\n            bechdel_df.at[index, 'category'] = '0-Fewer than two female characters'\n    elif bt_score == 1:\n        if bechdel_df.at[index, 'dubious'] == 1:\n            bechdel_df.at[index, 'category'] = 'Dubious'\n        else:\n            bechdel_df.at[index, 'category'] = '1-Female characters do not talk'\n    elif bt_score == 2:\n        if bechdel_df.at[index, 'dubious'] == 1:\n            bechdel_df.at[index, 'category'] = 'Dubious'\n        else:\n            bechdel_df.at[index, 'category'] = '2-Female characters talk about men'\n    else:\n        if bechdel_df.at[index, 'dubious'] == 1:\n            bechdel_df.at[index, 'category'] = 'Dubious'\n        else:\n            bechdel_df.at[index, 'category'] = '3-Passes Bechdel Test'","136aeac8":"bechdel_df.tail(10)","83baaef1":"bechdel_year_mean = bechdel_df.groupby(['year'])['bt_score'].mean().to_frame().reset_index()\nbechdel_year_mean.rename(columns={'bt_score': 'mean_bt_score'}, inplace=True)\nbechdel_year_mean","a032338e":"# geom_smooth() is an estimate of the conditional mean function. \n# It draws a curve and gives you a general trend of the data\n(ggplot(bechdel_year_mean, aes(x = 'year', y = 'mean_bt_score')) + \n    geom_point() + \n    geom_smooth(color='skyblue') + \n    labs(\n        title = 'Mean Bechdel Test Score over the years',\n        x = 'Mean Bechdel Test Score', \n        y = 'Year'\n    )\n)","d740b973":"# Making a new dataframe where the categories are ordered in the way I want. \n# And I really want the Dubious category to be between pass and fail for better vis below\nbechdel_df_ordered = bechdel_df.copy()\nbechdel_df_ordered['category'] = pd.Categorical(bechdel_df_ordered['category'], categories=[\n    '0-Fewer than two female characters', \n    '1-Female characters do not talk',\n    '2-Female characters talk about men', \n    'Dubious',\n    '3-Passes Bechdel Test'\n], ordered=True)","41700e5a":"# fitting all the years in the graph looks terrible\n# Here I selected the data between 1950-2000 to make it a little better, but it is still not good\n(ggplot(bechdel_df_ordered[(bechdel_df_ordered['year'] > 1950) & (bechdel_df_ordered['year'] < 2000)], \n        aes(fill = 'category', x = 'year')) + \n    geom_bar(position = \"fill\") + \n    scale_y_continuous(labels=percent_format()) +\n    scale_fill_manual(values = ['#FF8C42', '#FCAF58', '#F9C784', '#E8E9EB', '#98BF64']) +\n    labs(\n        title = 'Percentage Changes of Movies Passing Bechdel Test over the Years', \n        subtitle = 'Stacked Percentage Bar Chart',\n        x = 'Year', \n        y = 'Proportion'\n    ) + \n    theme_classic()\n)\n# Hope you like the colors because those took me an hour to tune... I am not exactly an experienced designer","6ebe06a2":"# Adding a new column that segment the years in to 10-year intervals\nfor index, year in bechdel_df_ordered['year'].iteritems():\n    interval_start = int(year - year % 10 + 1)\n    interval_end = int(interval_start + 9)\n    bechdel_df_ordered.at[index, 'year_interval'] = str(interval_start) + '-' + str(interval_end)\nbechdel_df_ordered","271dfee6":"(ggplot(bechdel_df_ordered, \n        aes(fill = 'category', x = 'year_interval')) + \n    geom_bar(position = \"fill\") + \n    scale_y_continuous(labels=percent_format()) +\n    scale_fill_manual(values = ['#FF8C42', '#FCAF58', '#F9C784', '#E8E9EB', '#98BF64']) +\n    # geom_text(angle=45) + \n    labs(\n        title = 'Percentage Changes of Movies Passing Bechdel Test over the Years', \n        subtitle = 'Stacked Percentage Bar Chart',\n        x = 'Year', \n        y = 'Proportion'\n    ) + \n    theme_classic() + \n    theme(axis_text_x  = element_text(angle = 45, hjust = 1))\n)","f507c5b5":"from matplotlib.animation import FuncAnimation","901c713a":"bechdel_pie = bechdel_df.groupby(['year'])['bt_score'].count().to_frame().reset_index()\nbechdel_pie.rename(columns={'bt_score': 'total'}, inplace=True)\n# add counts of 0's\nbechdel_pie_0 = bechdel_df[bechdel_df['category'] == '0-Fewer than two female characters'].groupby('year')['bt_score'].count()\nfor index_year, value_count in bechdel_pie_0.items():\n    bechdel_pie.loc[bechdel_pie['year'] == index_year, ['0']] = value_count\n# add counts of 1's\nbechdel_pie_1 = bechdel_df[bechdel_df['category'] == '1-Female characters do not talk'].groupby('year')['bt_score'].count()\nfor index_year, value_count in bechdel_pie_1.items():\n    bechdel_pie.loc[bechdel_pie['year'] == index_year, ['1']] = value_count\n# add counts of 2's\nbechdel_pie_2 = bechdel_df[bechdel_df['category'] == '2-Female characters talk about men'].groupby('year')['bt_score'].count()\nfor index_year, value_count in bechdel_pie_2.items():\n    bechdel_pie.loc[bechdel_pie['year'] == index_year, ['2']] = value_count\n# add counts of Dubious's\nbechdel_pie_d = bechdel_df[bechdel_df['category'] == 'Dubious'].groupby('year')['bt_score'].count()\nfor index_year, value_count in bechdel_pie_d.items():\n    bechdel_pie.loc[bechdel_pie['year'] == index_year, ['Dubious']] = value_count\n# add counts of 3's\nbechdel_pie_3 = bechdel_df[bechdel_df['category'] == '3-Passes Bechdel Test'].groupby('year')['bt_score'].count()\nfor index_year, value_count in bechdel_pie_3.items():\n    bechdel_pie.loc[bechdel_pie['year'] == index_year, ['3']] = value_count\n# fill all the empty values with 0's\nbechdel_pie = bechdel_pie.fillna(0)\n\n# check if counts match up\nfor index, total in bechdel_pie['total'].iteritems():\n    assert bechdel_pie.at[index, '0'] + bechdel_pie.at[index, '1'] + bechdel_pie.at[index, '2'] + bechdel_pie.at[index, 'Dubious'] + bechdel_pie.at[index, '3'] == bechdel_pie.at[index, 'total']\nbechdel_pie","202001c4":"counts_title = np.array(bechdel_pie[['0', '1', '2', 'Dubious', '3', 'year']])\n\ncolors = ['#FF8C42', '#FCAF58', '#F9C784', '#E8E9EB', '#98BF64']\nlabels = [\"0\", \"1\", \"2\", \"Dubious\", \"3\"]\ngap = [0, 0, 0, 0, 0]\n\nfig, ax = plt.subplots(figsize=(11,4))\nfig.subplots_adjust(wspace=None, hspace=None)\n\ndef update(num):\n    z = np.array(counts_title[num][:-1]).astype(float)\n    ax.clear()\n    ax.axis('equal')\n    ax.pie(z, explode=gap, labels=labels, colors=colors, autopct='%1.2f%%', shadow=False, startangle=180)\n    ax.legend(['0-Fewer than two female characters',\n                '1-Female characters do not talk',\n                '2-Female characters talk about men',\n                'Dubious', \n                '3-Passes Bechdel Test'], \n                bbox_to_anchor=(1,0.5), \n                loc=\"center right\", \n                fontsize=10, \n                bbox_transform=plt.gcf().transFigure\n                )\n    ax.set_title('Year ' + str(int(counts_title[num][-1])))\n\nani = FuncAnimation(fig, update, frames=range(len(counts_title)), repeat=False)\nani.save('bechdel.gif', writer='pillow', fps=2)","9689d2e4":"Good news that the avegrage Bechdel score is increasing over the years! The smooth line helps us understand the general trend of the data, but I don't really like it going below 0 in the earlier years. But it has something to do with the mechanism of geom_smooth(), so I am going to let it slide. \n\nIs it because the proportion of movies passing the test is increasing? Let's find out.","49567af2":"This is tricky because nothing is certain... and humans hate uncertainty. But I do not really want to just discard this information. I think it is better to classify movies in to 3 categories: passing, failing the Bechdel test and dubious. ","85c10a2c":"There are a few empty values in dubious. Let's drop them. ","bbc548e3":"Let's investigate this a little further and see what the dubious movies are really like.","ff03da29":"## Analysis & Visualization\n\nArguably, Python graphs are not the prettiest. So I am borrowing some R code to make certain graphs look prettier. Here, I will use a mixture of matplotlib and ggplot2, which is [PlotNine](https:\/\/towardsdatascience.com\/how-to-use-ggplot2-in-python-74ab8adec129) in Python. ","52f4d0bf":"![pieChart](.\/bechdel.gif \"pieChart\")","51e510d8":"## GIF Vis\n\nI don't like the fact that I cannot visualize all years in the bar chart, so I made an animated pie chart to better understand the changes over the years. ","c301c726":"bt_score is negatively screwed, causing a ceiling effect. ","1f283cab":"### Distribution of all bt_score\n\nWe can see that over half of movies in this dataset pass the Bechdel Test, which is great!","9d16bf2f":"I wanted dubious to be in-between so that we can better prepare the passing and failing percentage on either side. \n\nHowever, segmenting yearly seems a little difficult to read. If I try to fit all the years in this graph, it will become difficult to see the trend when the bars have a small width. So, I am going to try segmenting by 10 years.","12f87e06":"### Changes over the years\n\n- Is the average of Bechdel score rising?\n- Is the proportion of movies passing the Bechdel test rising? \n\n**Important Note**: There is no point in checking the NUMBER of movie passing the Bechdel Test over the years because of population affect, aka size affect. A simple example is that we talk about death rate changes over time, not number of deaths of the world, because there is more people on this planet than 100 years ago. The NUMBER is inflated by the growing population, causing the population affect. By checking the ratio, or proportion, we mitigate the population affect.\n\nSame logic here, if there are more movies being released this year than 10 years ago, there would be more movies passing the bechdel test even if the ratio of passing stays the same. There is no point in checking the NUMBER. ","8cbbe8f3":"This output above is not really showing correctly. Here is what you should be able to see if you download the GIF:","e7cff8e6":"Here, I will show you my analysis and how I plotted a percentage stacked bar chart and a GIF pie chart. ","30059739":"### dubious proportion\n\nAbout 9% of the scores are dubious, which is not too small of a proportion to overlook. "}}