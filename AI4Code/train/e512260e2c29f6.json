{"cell_type":{"d4e3edbe":"code","d9269c60":"code","7a96c929":"code","69564e62":"code","35515c8e":"code","656ae109":"code","a9f6eaf0":"code","d1488043":"code","1801689a":"code","321a2188":"code","2b3a0e01":"code","29ec6df7":"code","fdecb886":"code","d1662d46":"code","d079b255":"code","5f156e85":"code","8e1d16b3":"code","e248ae32":"code","c734449b":"code","4b1d1354":"code","42829028":"code","3c961230":"code","90d688cc":"code","ce974f21":"code","e79cf12f":"markdown","90cf0dfe":"markdown","a969f35a":"markdown","99608c34":"markdown","bd6edb19":"markdown","ceff4ca2":"markdown","d8c8171a":"markdown","eb864002":"markdown","f094d80b":"markdown","cabb359a":"markdown","03d7fe46":"markdown","2f880d58":"markdown","8b606cf4":"markdown","56f8900b":"markdown","a9350dee":"markdown","d3f00769":"markdown","09bbc686":"markdown","c89b7950":"markdown","afc7fb5e":"markdown","07704f22":"markdown","6cb86e56":"markdown","018a6da9":"markdown","47ffbda8":"markdown","cb6dcdff":"markdown"},"source":{"d4e3edbe":"import pandas as pd","d9269c60":"test = pd.read_csv(\"..\/input\/adult-pmr3508\/test_data.csv\")\ntrain = pd.read_csv(\"..\/input\/adult-pmr3508\/train_data.csv\", na_values=\"?\")\ntrain.columns.values","7a96c929":"train.shape","69564e62":"train.head()","35515c8e":"e_train = train.dropna()\ne_train.shape","656ae109":"import matplotlib as plt\nimport seaborn as sns","a9f6eaf0":"train['age'].hist()\nplt.pyplot.xlabel(\"Age\")\nplt.pyplot.ylabel(\"Number of people\")","d1488043":"train['workclass'].value_counts()","1801689a":"train['education'].value_counts()","321a2188":"train['marital.status'].value_counts().sort_values().plot(kind = 'barh')\nplt.pyplot.xlabel(\"Number of people\")","2b3a0e01":"train['occupation'].value_counts()","29ec6df7":"train['relationship'].value_counts()","fdecb886":"train['race'].value_counts()","d1662d46":"train['sex'].value_counts()","d079b255":"train['capital.gain'].value_counts()","5f156e85":"train['capital.loss'].value_counts()","8e1d16b3":"print(train['hours.per.week'].value_counts())","e248ae32":"train['native.country'].value_counts()","c734449b":"from sklearn import preprocessing","4b1d1354":"print(e_train['income'])\ne_train = e_train.apply(preprocessing.LabelEncoder().fit_transform)\ne_train.corr()[['income']]","42829028":"target = e_train.loc[:, 'income']\nprint(target)\nfeatures = e_train.loc[:, ['age', 'education.num', 'marital.status', 'relationship', 'occupation', 'sex', 'capital.gain', \n                           'capital.loss']]","3c961230":"from sklearn.model_selection import cross_val_score\nfrom sklearn.neighbors import KNeighborsClassifier","90d688cc":"results = []\nfor k in range(3,19,5):\n    knn = KNeighborsClassifier(n_neighbors=k)\n    scores = cross_val_score(knn, features, target, cv=10)\n    results.append([k,scores.mean()])\nprint(results)","ce974f21":"# e_test = test.apply(preprocessing.LabelEncoder().fit_transform)\n# e_test = e_test.loc[:, ['age', 'education.num', 'marital.status', 'relationship', 'occupation', 'sex', 'capital.gain', \n#                            'capital.loss']]\n# knn.fit(features, target)\n# y_pred = knn.predict(e_test)\n# submi = []\n# for i in range(0,len(y_pred)):\n#     if y_pred[i] == 0:\n#         submi.append(\"<=50K\")\n#     else:\n#         submi.append(\">50K\")\n\n# submi = pd.DataFrame(submi)\n# submi.columns = ['income']\n# submi.index.name = 'Id'\n# submi.to_csv(' PMR3508-2020-82')","e79cf12f":"Aplicando o classificador KNN, para n = 3, n = 8, n = 13 e n = 18. O melhor valor obtido foi para n = 18, com acerto de cerca de 84,32%.","90cf0dfe":"As features 'capital.gain' e 'capital.loss' s\u00e3o relevantes, pois est\u00e3o diretamente relacionadas ao 'income', sendo utilizadas na base de treino","a969f35a":"An\u00e1lise das features","99608c34":"A feature 'fnlwgt', que representa o n\u00famero de indiv\u00edduos que o censo acredita ser contemplado por certa combina\u00e7\u00e3o de dados tamb\u00e9m ser\u00e1 descartada","bd6edb19":"Como pode-se observar, h\u00e1 um espectro consideravelmente amplo de idades na base de treino, sendo esta uma feature importante na hora de se aplicar o m\u00e9todo KNN","ceff4ca2":"Biblioteca utilizada para convers\u00e3o dos dados de texto em dados num\u00e9ricos","d8c8171a":"Bibliotecas para dividir a base de treino e estimar o erro","eb864002":"Biblioteca utilizada no tratamento de dados","f094d80b":"A feature 'workclass' apresenta um desbalanceamento muito grande de dados, sendo desprezada no algoritmo de treino","cabb359a":"N\u00e3o ser\u00e1 utilizada a feature 'race', pois h\u00e1 uma predomin\u00e2ncia exagerada de dados relacionados \u00e0 'race' 'White' em rela\u00e7\u00e3o aos outros dados","03d7fe46":"Convers\u00e3o dos dados de texto em dados num\u00e9ricos e verifica\u00e7\u00e3o da correla\u00e7\u00e3o entre as features e a vari\u00e1vel target","2f880d58":"Submiss\u00e3o de dados","8b606cf4":"Ser\u00e1 utilizada a feature 'sex', pois, apesar de n\u00e3o haver um equil\u00edbrio ideal entre seus dados (50% de homens e 50% de mulheres), o desequil\u00edbrio n\u00e3o \u00e9 t\u00e3o grande (h\u00e1 cerca de 67% de homens e 33% de mulheres) e esta 'feature' representa uma informa\u00e7\u00e3o relevante","56f8900b":"Verifcando o tamanho da base de treino","a9350dee":"Importa\u00e7\u00e3o das bases de treino e de testes e print dos nomes de cada coluna da base de treino","d3f00769":"Criando data frames para as v\u00e1riaveis feature e target","09bbc686":"O estado civil ('marital.status') ser\u00e1 usado como feature de treino, tendo em vista a quantidade significante de pessoas que se casaram e que n\u00e3o se casaram, podendo estes valores indicar alguma correla\u00e7\u00e3o com a renda","c89b7950":"Remo\u00e7\u00e3o de dados faltantes e verifica\u00e7\u00e3o do tamanho desta nova base de treino","afc7fb5e":"O n\u00edvel de educa\u00e7\u00e3o ser\u00e1 utilizado para treino, sendo decartada a feature \"education.num\", tendo em vista que esta passa a ser redundante quando se utiliza a primeira","07704f22":"N\u00e3o ser\u00e1 usado o pa\u00eds nativo para treino, uma vez que ela apresenta desequil\u00edbrio na distribui\u00e7\u00e3o dos dados (muitas pessoas norte-americanas e poucas pessoas de outros pa\u00edses)","6cb86e56":"Como a maioria dos dados da base de treino apontam que o n\u00famero de horas trablhadas \u00e9 igual a 40, esta feature n\u00e3o ser\u00e1 utilizada na base de treino","018a6da9":"A ocupa\u00e7\u00e3o da pessoa tamb\u00e9m ser\u00e1 levada em considera\u00e7\u00e3o no treino, pois existem v\u00e1rias classes diferentes de ocupa\u00e7\u00f5es com uma base de dados bem distribu\u00edda","47ffbda8":"Ser\u00e1 utilizada a feature 'relationship', tendo em vista o certo equil\u00edbrio entre a distribui\u00e7\u00e3o dos dados","cb6dcdff":"Verifica\u00e7\u00e3o dos dados de treino"}}