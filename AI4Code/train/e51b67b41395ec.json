{"cell_type":{"eb8dec1d":"code","e4e47968":"code","941b4be8":"code","943a4c2e":"code","dfd4f88c":"code","de74da2b":"code","691df994":"code","1eb3109b":"code","9d33334f":"code","2ab4a7aa":"code","0b16c37e":"code","3268958f":"code","6b66b165":"code","1c5a6234":"code","6d59d2f8":"code","6a36e7a0":"code","85c62757":"code","dddc4b11":"code","01ea80fe":"code","cb19b217":"markdown","d6bb2963":"markdown","f3eedc71":"markdown","839b5cfb":"markdown","6fde4c71":"markdown","7ab84611":"markdown","ff48284e":"markdown","db3fc9a2":"markdown","fb90b2d4":"markdown","e70961ef":"markdown","c2c5b337":"markdown"},"source":{"eb8dec1d":"import numpy as np\nimport pandas as pd\ntry:\n  from catboost import CatBoostClassifier\nexcept:\n  !pip install catboost\n  from catboost import CatBoostClassifier\nfrom sklearn.model_selection import train_test_split\nimport os\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n","e4e47968":"class Config:\n    is_kaggle_platform = os.path.exists(\"\/kaggle\/input\")\n    dataset_name = \"tabular-playground-series-nov-2021\"\n    data_path = \"\/kaggle\/input\/%s\/\"%(dataset_name) if is_kaggle_platform else \"\"\n    submit_filename = \"submission.csv\"\n    label_name = \"target\"\nconfig = Config()","941b4be8":"if not config.is_kaggle_platform:\n  try:\n    import kaggle\n  except:\n    !pip install kaggle\n  if not os.path.exists(\"\/root\/.kaggle\/kaggle.json\"):\n    !echo \"{\"username\":\"{your username}\",\"key\":\"{your apikey}\"}\" >> \/root\/.kaggle\/kaggle.json\n    !chmod 600 \/root\/.kaggle\/kaggle.json\n  !kaggle competitions download -c $config.dataset_name\n  !unzip test.csv.zip\n  !unzip train.csv.zip\n  !unzip sample_submission.csv.zip","943a4c2e":"train = pd.read_csv(config.data_path + \"train.csv\")\ntest = pd.read_csv(config.data_path + \"test.csv\")\nsample_submission = pd.read_csv(config.data_path + \"sample_submission.csv\")\n","dfd4f88c":"train.head()","de74da2b":"train.info()","691df994":"train.describe()","1eb3109b":"corr = train.corr()\ncorr","9d33334f":"corr.sort_values(ascending=False, inplace=True, by=config.label_name, key= lambda x: abs(x))\ncorr[config.label_name]","2ab4a7aa":"correlated_columns = corr[config.label_name][corr[config.label_name].abs() > 0.05].index\ncorrelated_columns, len(correlated_columns)","0b16c37e":"correlation_score = train.corr()\ncorrelated_features = correlation_score[config.label_name].sort_values(ascending=False).dropna()\ncorrelated_columns = list(correlated_features[correlated_features.abs() > 0.05].index)\ncorrelated_columns.remove(config.label_name)\nprint(correlated_columns)","3268958f":"corr2 = train[correlated_columns].corr()\ncorr2","6b66b165":"plt.figure(figsize=(20, 20))\nsns.heatmap(corr2, annot=True)","1c5a6234":"sns.countplot(x=config.label_name, data=train)","6d59d2f8":"train.pop(\"id\")\n_ = test.pop(\"id\")","6a36e7a0":"train_features, val_features = train_test_split(train, test_size=0.15, random_state=42)\ntrain_targets = train_features.pop(config.label_name)\nval_targets = val_features.pop(config.label_name)\ntrain_features.head()","85c62757":"null_counts = train_features.isnull().sum()\nprint(null_counts[null_counts > 0])\nnull_counts = val_features.isnull().sum()\nprint(null_counts[null_counts > 0])","dddc4b11":"\ncat_params = {\n    'iterations': 15000,\n    'objective': 'CrossEntropy',\n    'bootstrap_type': 'Bernoulli',\n    'od_wait': 1000,\n    'learning_rate': 0.023575206684596582,\n    'reg_lambda': 36.30433203563295,\n    'random_strength': 43.75597655616195,\n    'depth': 7,\n    'min_data_in_leaf': 11,\n    'leaf_estimation_iterations': 1,\n    'subsample': 0.8227911142845009,\n    'task_type' : 'GPU',\n    'devices' : '0',\n    'verbose' : 1000,\n    'eval_metric': 'AUC'\n}\ncat = CatBoostClassifier(**cat_params)\ncat.fit(train_features, train_targets, eval_set=(val_features, val_targets))\n","01ea80fe":"y_pred = cat.predict_proba(test)\nsample_submission[config.label_name] = y_pred[:, 1]\nsample_submission.to_csv(config.submit_filename, index=False)\nif not config.is_kaggle_platform:\n  !kaggle competitions submit $config.dataset_name -m \"Submission\" -f $config.submit_filename","cb19b217":"<a id=\"3.3\"><\/a>\n### 3.3 Distribution of Label","d6bb2963":"\n#  TPS-11-2021: Catboost\n## Table of Contents\n* [1. Overview](#1.)\n* [2. Setup](#2.)\n* [3. Exploratory Data Analysis & Preprocessing](#3.)\n\t* [3.1 Statistic Info](#3.1)\n\t* [3.2 Correlation Score](#3.2)\n\t* [3.3 Distribution of Label](#3.3)\n\t* [3.4 Drop ID column](#3.4)\n\t* [3.5 Train Validation Split](#3.5)\n* [4. Model Development](#4.)\n* [5. Submission](#5.)\n\n<a id=\"1.\"><\/a>\n## 1. Overview\nIn this Notebook, I will build a Tabular Prediciton Model using Catboost.\n<a id=\"2.\"><\/a>\n## 2. Setup","f3eedc71":"There isn't any missing value, not need for Data Wrangling","839b5cfb":"<a id=\"4.\"><\/a>\n## 4. Model Development","6fde4c71":"<a id=\"5.\"><\/a>\n## 5. Submission","7ab84611":"<a id=\"3.4\"><\/a>\n### 3.4 Drop ID column\nID is not needed. So remove this column.","ff48284e":"**If you found my notebook useful, give me an upvote.**\n\nYou may have a look at some of my TPS notebooks before.\n\n- [Tabular Playground Series Prediction(Aug 2021)](https:\/\/www.kaggle.com\/lonnieqin\/tabular-playground-series-prediction)\n- [Tabular Playground Prediction(Sep 2021) with CatBoost](https:\/\/www.kaggle.com\/lonnieqin\/catboost-tabular-playground-prediction-sep-2021)\n- [Tabular Prediction(Oct 2021) with CatBoost](https:\/\/www.kaggle.com\/lonnieqin\/catboost-tabular-prediction-oct-2021)\n- [TPS Prediction with DNN and KerasTuner (Oct 2021)](https:\/\/www.kaggle.com\/lonnieqin\/tps-prediction-with-dnn-and-kerastuner-oct-2021)\n- [TPS-10-21: DNN](https:\/\/www.kaggle.com\/lonnieqin\/tps-10-21-dnn)\n","db3fc9a2":"<a id=\"3.\"><\/a>\n## 3. Exploratory Data Analysis & Preprocessing","fb90b2d4":"<a id=\"3.5\"><\/a>\n### 3.5 Train Validation Split","e70961ef":"<a id=\"3.2\"><\/a>\n### 3.2 Correlation Score","c2c5b337":"<a id=\"3.1\"><\/a>\n### 3.1 Statistic Info"}}