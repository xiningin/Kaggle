{"cell_type":{"9e45fd3a":"code","118f0f1f":"code","a24bf2b2":"code","79fb20cc":"code","e9f4d9a2":"code","8f2614db":"code","995c1214":"code","cc2d158a":"code","cfb842d7":"code","75825f84":"code","ca8ffd76":"code","a4816db2":"code","ea9c6a1a":"code","14c104ba":"code","48973192":"code","f5241c43":"code","ab2dcdd5":"code","13aee944":"code","62cf6118":"code","c676ca54":"code","2cbb4f2c":"code","bbdbddd2":"code","469d9089":"code","4cb293d3":"code","121d45ed":"code","c7ae5f4c":"code","8f73a4fd":"code","5ab64a14":"code","5697ef63":"code","926fc372":"code","cb3c1a06":"code","2d3927cd":"code","f1ab8196":"code","8bc7b640":"code","da51232c":"code","76afa53e":"code","0f64007c":"code","eb7d56ba":"code","d231bfd5":"code","e12f05ea":"code","1d60bc11":"code","2479e4b3":"code","5d1739c9":"code","69bb5c41":"code","724aac8a":"code","4240ace3":"code","b367e6a0":"code","40b01daa":"code","f8dbb63a":"code","6a542f28":"code","735667aa":"code","6adb8bd5":"code","bed0b69d":"code","32b051cb":"code","a39a9626":"markdown","9a48c37a":"markdown","b339c1eb":"markdown","c959b206":"markdown","466ba577":"markdown","cda079e0":"markdown","cd9cf82a":"markdown","73bf6065":"markdown","a898cf49":"markdown","b488056b":"markdown","eebc8719":"markdown","72078867":"markdown","24971f97":"markdown","3c50c4a8":"markdown","3ea9c4b7":"markdown","6fad2ff5":"markdown","3541bd8e":"markdown","72b9fa73":"markdown","eb81e809":"markdown","9a0c3ac9":"markdown","86482457":"markdown","82a0108e":"markdown","d1bc5f69":"markdown","a8f0d59b":"markdown","6432adac":"markdown","4993fbed":"markdown","dc261f41":"markdown","fd7fbef5":"markdown","8f682dc4":"markdown","0d4b2c65":"markdown","e715870a":"markdown","1ed1793e":"markdown","df3ddd96":"markdown","f276cd23":"markdown","76ff80eb":"markdown","6ffe64fe":"markdown","560c920f":"markdown","2dec0619":"markdown","bebd9505":"markdown","298ad26c":"markdown","9b5caf5e":"markdown","fc11f3ac":"markdown","e340f271":"markdown","e93c08ed":"markdown","23f0aace":"markdown","96022a3a":"markdown","0e62a685":"markdown","ca78a4e6":"markdown","fdab4d0e":"markdown","e9f4840b":"markdown"},"source":{"9e45fd3a":"# Using only [pandas, numpy, matplotlib]\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt","118f0f1f":"%matplotlib inline\nDF = pd.read_csv('tmdb-movies.csv', parse_dates=['release_date'])","a24bf2b2":"DF.head()","79fb20cc":"print('Budget: [', 'Mean:', DF['budget'].mean(), '\\tMode:', DF['budget'].mode()[0], '\\tSkew:', DF['budget'].skew(),']')","e9f4d9a2":"print('Revenue: [', 'Mean:', DF['revenue'].mean(), '\\tMode:', DF['revenue'].mode()[0], '\\tSkew:', DF['revenue'].skew(),']')","8f2614db":"print('Runtime: [', 'Mean:', DF['runtime'].mean(), '\\tMode:', DF['runtime'].mode()[0], '\\tSkew:', DF['runtime'].skew(),']')","995c1214":"print('Release Year: [', 'Mean:', DF['release_year'].mean(), '\\tMode:', DF['release_year'].mode()[0], '\\tSkew:', DF['release_year'].skew(),']')","cc2d158a":"fig, axes = plt.subplots(1, 3,figsize=(20, 3))\nDF['budget'].plot(kind='hist',bins = 60, ax=axes[0])\nDF['revenue'].plot(kind='hist',bins = 60, ax=axes[1])\nDF['runtime'].plot(kind='hist',bins = 60, ax=axes[2])\nplt.show()","cfb842d7":"print('Budget Count: ', len(DF[DF['budget'] == 0]['budget']), 'Revenue Count: ', len(DF[DF['revenue'] == 0]['revenue']), 'Runtime Count: ', len(DF[DF['runtime'] == 0]['runtime']))","75825f84":"DF.info()","ca8ffd76":"DF.describe()","a4816db2":"DF.isnull().sum()","ea9c6a1a":"DF.drop(DF.columns[[7, 9, 10]], axis=1, inplace=True)\nprint(DF.columns.tolist())","14c104ba":"DF['genres'].isnull().sum()","48973192":"DF[\"genres\"].fillna(\"No genre\", inplace = True)","f5241c43":"DF['genres'].isnull().sum()","ab2dcdd5":"print('Movie Runtime = 0:\\t\\t\\t', len(DF[DF['runtime'] == 0]))\nprint('Movie Budget = 0:\\t\\t\\t', len(DF[DF['budget'] == 0]))\nprint('Movie Revenue = 0:\\t\\t\\t', len(DF[DF['revenue'] == 0]))\nprint('Movie Budget < 150 and Revenue > 0:\\t', len(DF[(DF['budget'] < 150) & (DF['revenue'] > 0)]))","13aee944":"DF.drop(DF[DF.runtime == 0].index, inplace=True)\nDF.drop(DF[(DF['budget'] < 150) & (DF['revenue'] > 0)].index, inplace=True)\nlen(DF)","62cf6118":"DF.isnull().sum()","c676ca54":"DF.dropna(inplace=True)\nlen(DF), sum(DF.isnull().sum().values)","2cbb4f2c":"# Calculating the Profit\nDF['Profit'] = DF['revenue']-DF['budget']\n# Calculating Profit Percentage\nDF['ProPer'] = DF['Profit']\/DF['budget']*100\n#Replacing [inf,Nulls] with 0\nDF['ProPer'] = DF['ProPer'].replace([np.inf, -np.inf], np.nan).fillna(0).astype(int) ","bbdbddd2":"def Sorting(df,column,order):\n    df = df.sort_values(by=[column], ascending=order)\n    return df\n\ndef Plot(title, ylabel, x, y, c):\n    plt.figure(figsize=(16, 6))\n    plt.title(title, fontsize=18)\n    plt.bar(x, y, color=c, alpha=0.7)\n    plt.ylabel(ylabel); plt.xticks(rotation=90, size=8)\n    plt.show()","469d9089":"DF.corr()","4cb293d3":"plt.figure(figsize=(16, 11))\nplt.matshow(DF.corr(), fignum=0)\nplt.title('Correlation Matrix', fontsize=18)\nplt.xticks(range(DF.select_dtypes(['number']).shape[1]), DF.select_dtypes(['number']).columns, rotation=10)\nplt.yticks(range(DF.select_dtypes(['number']).shape[1]), DF.select_dtypes(['number']).columns)\nplt.colorbar();","121d45ed":"ProDF = Sorting(DF,'Profit',False)\nProDF.head()","c7ae5f4c":"Plot('Top 100 Movies based on Profit', 'Profit in Billions', ProDF['original_title'][:100], ProDF['Profit'][:100], 'seagreen')","8f73a4fd":"PercDF = Sorting(DF,'ProPer',False)\nPercDF.head()","5ab64a14":"Plot('Top 100 Movies based on Profit Percentage', 'Profit %', PercDF['original_title'][:100], PercDF['ProPer'][:100], 'midnightblue')","5697ef63":"# Group by director then summing all movies profit percentages\nDirDF = Sorting(DF.groupby('director').sum(),'ProPer',False)\nDirDF.head()","926fc372":"Plot('Top 100 Directors achived Highest Average Profit Percentage', 'Profit %', DirDF.index[:100], DirDF['ProPer'][:100], 'maroon')","cb3c1a06":"CoDF = DF.copy(deep=True)\n# Splitting ['production_companies'] String into array of values\nCoDF['production_companies'] = CoDF['production_companies'].str.split('|').tolist()","2d3927cd":"CoDF.head()","f1ab8196":"# Exploding each array value into independent row, grouping by 'production_companies' and getting sum of Budget\nBudget = Sorting(CoDF.explode('production_companies').groupby('production_companies').sum(),'budget',False)\nBudget.head()","8bc7b640":"Plot('Top 50 Companies have the Highest Budget', 'Budget', Budget.index[:50], Budget['budget'][:50], 'seagreen')","da51232c":"# Exploding each array value into independent row, grouping by 'production_companies' and getting sum of Revenue\nRevenue = Sorting(CoDF.explode('production_companies').groupby('production_companies').sum(),'revenue',False)\nRevenue.head()","76afa53e":"Plot('Top 50 Companies have the Highest Revenue', 'Revenue', Revenue.index[:50], Revenue['revenue'][:50], 'midnightblue')","0f64007c":"# Exploding each array value into independent row, grouping by 'production_companies' and getting sum of Profit\nProfit = Sorting(CoDF.explode('production_companies').groupby('production_companies').sum(),'Profit',False)\nProfit.head()","eb7d56ba":"Plot('Top 50 Companies have the Highest Profit', 'Profit', Profit.index[:50], Profit['Profit'][:50], 'maroon')","d231bfd5":"plt.figure(figsize=(16, 8))\nexplode = (0.1, 0, 0, 0, 0, 0, 0, 0, 0, 0)\nplt.title('Top 10 Companies have the Highest Profit', fontsize=18)\nplt.pie(Profit.Profit[:10].values, explode=explode, labels=Profit.index[:10].values, autopct='%1.1f%%', startangle=90)\nplt.show()","e12f05ea":"# Exploding each array value into independent row, grouping by 'production_companies' and getting the mean of voteing avarage\nRating = Sorting(CoDF.explode('production_companies').groupby('production_companies').mean(),'vote_average',False)\n# Picking the highest rating based vote_count > 99 vote, as less than 100 will not represent the votes well\nRating = Rating[Rating['vote_count'] > 99]\nRating.head()","1d60bc11":"Rating['vote_average'][:20]","2479e4b3":"Counts = Sorting(DF,'vote_count',True)","5d1739c9":"plt.figure(figsize=(16, 6))\nplt.title('Distripution of Least Counts of Movies Rating', fontsize=18)\nplt.scatter(Counts['vote_count'], Counts['vote_average'], s=15.5, color='maroon', alpha=0.7)\nplt.ylabel('Rating average'); plt.xlabel('Number of votes')\nplt.show()","69bb5c41":"# Splitting the genres column and combined it with release year and popularity cols\nDF_genrs=pd.DataFrame(DF.genres.str.split('|').tolist(),index=[DF['release_year'],DF['popularity']]).stack()","724aac8a":"# Reset and rename the dataframe cols\nDF_genrs=DF_genrs.reset_index([0,1])\nDF_genrs.rename({0:'genres'},axis=1,inplace=True)  #renaming genres column\nDF_sort_genrs=DF_genrs.sort_values(['popularity','release_year','genres'],ascending=False)\nDF_sort_genrs.head()","4240ace3":"## Plotting the data frame\n\nplt.figure(figsize=(16, 6))\nGenres = np.unique(DF_sort_genrs['genres']).tolist()\nfor i in Genres:\n    Plot = DF_sort_genrs[DF_sort_genrs['genres']==i].groupby('release_year').sum()\n    plt.scatter(Plot.index, Plot['popularity'], s=15.5, alpha=0.7, label=i)\n    plt.plot(Plot.index, Plot['popularity'])\nplt.ylabel('Popularity'); plt.xlabel('Years')\nplt.title('Genres Occurances')\nplt.legend()\nplt.show()","b367e6a0":"## Splitting the genres column and combined it with release year and revenue cols\nDF_revn=pd.DataFrame(DF.genres.str.split('|').tolist(),index=[DF['release_year'],DF['revenue']]).stack()","40b01daa":"# Reset and rename the dataframe cols\nDF_revn=DF_revn.reset_index([0,1])\nDF_revn.rename({0:'genres'},axis=1,inplace=True)  #renaming genres column\nDF_sort_revn=DF_revn.sort_values(['revenue','release_year','genres'],ascending=False)\nDF_sort_revn.head()","f8dbb63a":"## Plotting the data frame\n\nplt.figure(figsize=(16, 6))\nGenres = np.unique(DF_sort_revn['genres']).tolist()\nfor i in Genres:\n    Plot = DF_sort_revn[DF_sort_revn['genres']==i].groupby('release_year').sum()\n    plt.scatter(Plot.index, Plot['revenue'], s=15.5, alpha=0.7, label=i)\n    plt.plot(Plot.index, Plot['revenue'])\nplt.ylabel('Revenues'); plt.xlabel('Years')\nplt.title('Genres Occurances')\nplt.legend()\nplt.show()","6a542f28":"DF_budg=pd.DataFrame(DF.genres.str.split('|').tolist(),index=[DF['budget'],DF['revenue']]).stack()","735667aa":"DF_budg=DF_budg.reset_index([0,1])\nDF_budg.rename({0:'genres'},axis=1,inplace=True)  #renaming genres column\nDF_sort_budg=DF_budg.sort_values(['budget','revenue','genres'],ascending=False)\nDF_plt=DF_sort_budg.groupby('genres').sum()\nDF_plt.head()","6adb8bd5":"plt.figure(figsize=(16, 6))\nplt.barh(DF_sort_budg['genres'],DF_sort_budg['revenue'], alpha=0.7,color='seagreen')\nplt.barh(DF_sort_budg['genres'],DF_sort_budg['budget'], alpha=0.7,color='midnightblue')   \nplt.xlabel('Revenue\/Budget')\nplt.ylabel('Genres')\nplt.title('Revenue & Budget')\nplt.show()","bed0b69d":"DF_rate=pd.DataFrame(index=[DF['runtime'],DF['vote_average']])\nDF_rate2=DF_rate.sort_values(['runtime','vote_average'],ascending=False)\nDF_rate2.head()","32b051cb":"plt.figure(figsize=(16, 6))\nDF.groupby(['vote_average'])['runtime'].mean().plot()\nplt.xlabel('Vote'); plt.ylabel('Run Time')\nplt.title('Voting Based on Runtime')\nplt.show()","a39a9626":"\n# TMDB Movies Investigation\n\n## Table of Contents\n<ul>\n<li><a href=\"#intro\">Introduction<\/a><\/li>\n<li><a href=\"#wrangling\">Data Wrangling<\/a><\/li>\n<li><a href=\"#eda\">Exploratory Data Analysis<\/a><\/li>\n<li><a href=\"#conclusions\">Conclusions<\/a><\/li>\n<\/ul>","9a48c37a":"## How Director affect Movies Profit","b339c1eb":"## Searching for Nulls again","c959b206":"<a id='intro'><\/a>\n## Introduction\n\n#### Dataset: TMDB movie dataset, I choosed this dataset especially becase it has a lot of features as it has more than 5000 movies and their rating and basic information, including user ratings and revenue data, which can be easly interpret some insights.\n#### Insights:\n<ul>\n    <li><a href='#Correlated'>Which are the Columns that are highley Correlated<\/a><\/li>\n    <li><a href='#HighestMovies'>Highest Movies Profit Percentage based on (Cost vs Revenue)<\/a><\/li>\n    <li><a href='#Directoraffect'>How Director affect Movies Profit<\/a><\/li>\n    <li><a href='#HighestProduction'>Highest Production Companies in terms of (Budget-Revenue-Profit)<\/a><\/li>\n    <li><a href='#TopCompanies'>Top 10 Companies have the Highest Profit<\/a><\/li>\n    <li><a href='#HighestRated'>Highest Rated Movies Companies<\/a><\/li>\n    <li><a href='#EffectofLeast'>Effect of Least Counts of Movies Rating<\/a><\/li>\n    <li><a href='#most'>Most popular genres year to year<\/a><\/li>\n    <li><a href='#Revenue'>Genres Revenues over years<\/a><\/li>\n    <li><a href='#Budget'>Budget \/ Revenue relationship for each Genre<\/a><\/li>\n    <li><a href='#Runtime'>How Runtime affect the Rating<\/a><\/li>\n<\/ul>","466ba577":"## Highest Production Companies in terms of (Budget-Revenue-Profit)","cda079e0":"    So we can drop rows that has a runtime = 0 but we can't drop the budget or revenue =0, however some of the movies have a budget less than 150 dollars but have high revenues which doesn't make a sense, i googled them and found out most of them have invalid values, so we can drop them too.","cd9cf82a":"## One Dimensional Exploration [Mean, Mode, Skewness]\n\n        Budget, Revenue, Runtime and Release Year Columns","73bf6065":"    Function for Sorting the DataFrame & Plotting Bar Chart","a898cf49":"    1. Budget","b488056b":"<a id='wrangling'><\/a>\n## Data Wrangling","eebc8719":"## Data Cleaning (Nulls - Duplications - Invalid Values)\n### Searching for Nulls","72078867":"### <a id='Budget'><\/a> Budget \/ Revenue relationship for each Genre","24971f97":"this plot shows that most revenue that the moives got was in the last month in 2009","3c50c4a8":"## Replacing Null Values\n\nHere we will replace null values of 'genres' column ","3ea9c4b7":"## Two Dimensional Exploration","6fad2ff5":"    Top 3 directors that achived higest average profit percentage were Oren Peli and Daniel Myrick, and David Lync, Oren and Daniel achived 8x more profit in their movies compared to all the other directors.","3541bd8e":"## Searching for Invalid Values\n\nLooking in Data description, I've noticed some columns have a minimum value of Zeros, which they shouldn't have, let's count those values","72b9fa73":"    Histogram Plotting Budget, Revenue & Runtime","eb81e809":"    On the contrary Paranomal Activity, The Blair, and Eraserhead was on the top of Profit Percentage list, while Avatar is not in this list, maybe it's cost of production was too high too.","9a0c3ac9":"There are too many Nulls in the data, The remaining rows after removing the Nulls will be 1992, which will be too risky so instead, I will not remove the Nulls but i will remove columns like [homepage,tagline,keywords] which have a lot of Nulls as it wouldn't be an issue in our needed insights","86482457":"On Highest Rated Movies Companies list, Alfran Productions came in the first place with average rating of 8.3, while Linson Films on the second place with 8.1 average rate, and Atman Entertainment in the third place with 8.1 average rating, which mean not always the highest profit or revenue companies has much higer average rating.","82a0108e":"## Top 10 Companies have the Highest Profit","d1bc5f69":"This repalcing will help us while exploratory data of 'genres' column\n\nAnd that hepls also in removing duplicated data","a8f0d59b":"## Conclusion\nFirst, the data had a lot of Nulls which made it impossible to drop them all, so i had to remove the unneeded columns which contained most of the Nulls to decreased the number of them, the dataset contained only 1 duplicated row which won't make a diffrence, large subset of the data contained invalid values, which had to be handled either by removing them or putting default value, a little bit of Feature Engineering had to be done at first to create two colums Profit and Profit Percentage to generate further more insights.\n\n- First thing i made a correlation matrix too see which columns has the highest correlation. helped in creating further more insights.\n- Second one i created visualizations to see the highest movies Profit and Profit Percentage based on (Cost vs Revenue).\nExtracting the top 100 Movies shows that:\n\n- Avatar, Star Wars, and Titanic were on the top of Profit list but weren't on Profit Percentage list.\n- On the contrary Paranomal Activity, The Blair, and Eraserhead was on the top of Profit Percentage list.\n- Third one we showed the effect of the director on the movie profits.\nTop 3 directors that achived higest average profit percentage were Oren Peli and Daniel Myrick, and David Lync.\n\n- Fourth, Fifth and Sixth insights made them to see which highest Production Companies in terms of (Budget-Revenue-Profit).\n- Higest production companies in terms of budget-revenue-profit was warner Bros. Universal Pictures and Paramount Pictures.\n- Twentieth Century Fox Film Corporation entered the list of top 3 Profit Companies.\n- The Seventh insight showed the highest rated movie companies.\n    Highest rated movie companies were Alfran Productions, Linson Films and Atman Entertainment.\n\n- The Eighth insight here showed Effect of Least Counts of Movies Rating.\n    There is a slightly correlation between the number of voting and the rate of voting, which makes sense, as the number of voting represent the popularity of that particular movie in most of the cases, which translated to if that particular movie is popular so it has to be good movie.\n    \n- in the Ninth insight we showed the most popular genres from year to year and plotted it to see the relationship\n- in the Tenth one we found out the highest revenue over years based on the genres\n- the 11th insight we showed the relationship between the budget and revenue which showed how the budget impact on revenue\n- last one we created insight showed the movie runtime vs rate of movie show if movie runtime impact on rating\n\n### Limitations\nFirst, the data had a lot of Nulls which made it impossible to drop them all, and made it harder to do the Data Preparation, \nas homepage had about 7930, tagline 2824, keywords 1493, but those 3 columns were not targetet in answering the questions purposed, but on the other side there were a critical issues that needs to be discussed:\n\n- Missing values\nproduction_companies column, it had about 1030 movies didn't labeled for a company, which i think it made a significant impact in the insights.\n\n- Invalid values\nMore than half of the data in some columns have invalid values like budget and revenue, which had 0 value instead of actual values, which made some companies in terms of budget, revenue and profit were not in the list or misplaced it's ranking,\n\n\nas genres column we coiuldn't drop the nulls because it will make some issues in exploration so that: \n\n- we replaced them with (no genres) to be able exploring well\n- as we replaced the nulls the duplicated data are gone \n\nOverall the data did answer most of the questions, but for the most accurate anwer it needs to be enlarged and enhanced.\n\nThanks a lot...","6432adac":" this shows that most popular  genres  are ( Thriller,Science Fiction,Adventure,Action)","4993fbed":"- Half of the data in Budget and Revenue Columns is Zero.","dc261f41":"    Higest production companies in terms of budget were warner Bros. Universal Pictures and Paramount Pictures.\n\n    2. Revenue","fd7fbef5":"    Avatar, Star Wars, and Titanic were on the top of Profit list but weren't on Profit Percentage list, Where Avatar has the highest profit of all time, almost double the profit of all movies in the top 100 list.\n    \n    2- Profit Percentage","8f682dc4":"## Removing Invalid Values","0d4b2c65":"## Highest Movies Profit Percentage based on (Cost vs Revenue)\n\n\n\n    1- Profit","e715870a":"It seems like the histogram is left skewed, to the Zero lets explore more\n   \n   \n   Counting **Zero Values**","1ed1793e":"## Dropping Nulls","df3ddd96":"## Dropping Unneeded Columns","f276cd23":"## <a id='eda'><\/a>Exploratory Data Analysis\n\n\n### Feature Engineering\n    Adding two additional colums for [Profit and Percentage Profit]","76ff80eb":"### <a id='Revenue'><\/a> Genres Revenues over years","6ffe64fe":" that shows that the more the runtime increase the rating is increases.","560c920f":" #### Information about the data including number of values in each column and their types","2dec0619":"### <a id='Runtime'><\/a> How Runtime affect the Rating\nshows the relation between runtime and rating of the movies","bebd9505":"    Top 10 Companies have the Highest Profit, where Warner Bros. in the top of this list, Universal Pictures came on the second place and Twentieth Century Fox Film came on the third place with a profit size over 45% of all other companies in the list.","298ad26c":"####   Statistical information about the data like, count, mean, min and max.","9b5caf5e":"    There is a correlation between budget and popularity, revenue and popularity, revenue and budget, vote count and popularity, vote count and revenue","fc11f3ac":"this shows that the most genres make high revenues are also (science fiction,fantasy,adventure,action) ","e340f271":"There is a slightly correlation between the number of voting and the rate of voting, which makes sense, as the number of voting represent the popularity of that particular movie in most of the cases, which translated to if that particular movie is popular so it has to be good movie.","e93c08ed":"### General Properties\nReading the data and displaying a sample of it as well as some related-info.","23f0aace":"## Highest Rated Movies Companies","96022a3a":"### <a id='most'><\/a>Most popular genres year to year","0e62a685":"    Higest production companies in terms of revenue was warner Bros. Universal Pictures and Paramount Pictures too, so they make the most costly movies and also they earn the higest revenues.\n\n    3. Profit","ca78a4e6":"## Which are the Columns that are highly Correlated","fdab4d0e":"## Effect of Least Counts of Movies Rating","e9f4840b":"    Twentieth Century Fox Film Corporation entered the list of top 3 in Profit Companies, Which mean Twentieth Century Fox Film doesn't make the most costly nor earn the higest revenues but it makes the higest profits."}}