{"cell_type":{"39f8caab":"code","c3803e57":"code","0ac0b689":"code","ef69843b":"code","f8190e57":"code","e41ccbbc":"code","eb58ccee":"code","5afdb1b7":"code","c238941b":"code","a702d983":"markdown"},"source":{"39f8caab":"!pip install mxnet-cu101\n!pip install autogluon","c3803e57":"import pandas as pd\nimport numpy as np\nimport csv\nimport autogluon as ag\nfrom autogluon import TabularPrediction as task","0ac0b689":"dataset = pd.read_csv('..\/input\/bnp-paribas-cardif-claims-management\/train.csv.zip')\ntest_dataset = pd.read_csv('..\/input\/bnp-paribas-cardif-claims-management\/test.csv.zip')","ef69843b":"dataset.head()","f8190e57":"metric=\"log_loss\"\n\n# Evaluation Metric for Classification Below :\n# 'accuracy\u2019, \u2018balanced_accuracy\u2019, \u2018f1\u2019, \u2018f1_macro\u2019, \u2018f1_micro\u2019, \u2018f1_weighted\u2019, \u2018roc_auc\u2019, \u2018average_precision\u2019\n# \u2018precision\u2019, \u2018precision_macro\u2019, \u2018precision_micro\u2019, \u2018precision_weighted\u2019, \u2018recall\u2019, \u2018recall_macro\u2019, \u2018recall_micro\u2019\n# \u2018recall_weighted\u2019, \u2018log_loss\u2019, \u2018pac_score\u2019\n\n# Metric for Regression Below :\n#\u2018root_mean_squared_error\u2019, \u2018mean_squared_error\u2019, \u2018mean_absolute_error\u2019, \u2018median_absolute_error\u2019, \u2018r2\u2019]\n\nquality=\"best_quality\"\n\n# \u2018best_quality\u2019, \u2018best_quality_with_high_quality_refit\u2019, \u2018high_quality_fast_inference_only_refit\u2019\n# \u2018good_quality_faster_inference_only_refit\u2019, \u2018medium_quality_faster_train\u2019, \u2018optimize_for_deployment\u2019, \u2018ignore_text\u2019\n\n# visual='mxboard'\n\n# \u2018mxboard\u2019, \u2018tensorboard\u2019, \u2018none\u2019\n\n# dir = '\/home\/andrew\/Documents\/PropertyPrices' # specifies folder where to store trained models\n\nproblem ='binary'\n#['binary', 'multiclass', 'regression'])","e41ccbbc":"predictor = task.fit(train_data=dataset,\n                     label='target',\n                     presets=quality,\n                     problem_type=problem,\n                     eval_metric= metric,\n                     auto_stack=True,\n                     ngpus_per_trial=1,\n                     verbosity=2)","eb58ccee":"results = predictor.fit_summary()","5afdb1b7":"prediction = predictor.predict_proba(test_dataset)","c238941b":"sub = pd.read_csv('..\/input\/bnp-paribas-cardif-claims-management\/sample_submission.csv.zip')\nsub['PredictedProb'] = prediction\nsub.to_csv('.\/submission.csv', index=False)","a702d983":"Unfortunately, there are erros intalling mxnet and autogluon in Kaggle. It would work in Google Colab or in your local Jupyter Notebook."}}