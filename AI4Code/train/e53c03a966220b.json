{"cell_type":{"fc8e0c4f":"code","4c62690c":"code","2ecb3595":"code","20709572":"code","15556877":"code","7d8da691":"code","3f13cd41":"code","d032b1ba":"code","eac99fb9":"code","7ec260bb":"code","6b975b2f":"code","57777e4f":"code","a522c63d":"code","c0d289cf":"code","2a481472":"code","a3c53ec6":"code","aa2779e3":"code","91cbb6f9":"code","626aeb33":"code","534ec4d5":"markdown","8f05a5d7":"markdown","691ccc53":"markdown","0afcb5c5":"markdown","31857ec4":"markdown","ce9ae499":"markdown","05a0c1e5":"markdown","eeaf510c":"markdown","6a53ff3c":"markdown","123c2f84":"markdown","0da9df52":"markdown"},"source":{"fc8e0c4f":"# Importing essentials\nimport numpy as np\nimport pandas as pd \nimport matplotlib.pyplot as plt\nimport seaborn as sns","4c62690c":"ab = pd.read_csv(\"..\/input\/abalone-dataset\/abalone.csv\")","2ecb3595":"ab.head()","20709572":"ab.info()","15556877":"ab.describe()","7d8da691":"#Adding the Age column and dropping rings column\nab[\"Age\"] = ab[\"Rings\"] + 1.5\nab = ab.drop(\"Rings\",axis=1)\nab.head()","3f13cd41":"# Visualizing the age\nplt.figure(figsize=(12,6))\nsns.boxplot(ab.Age)","d032b1ba":"ab[\"Sex\"].value_counts().plot(kind = 'bar', table = True,figsize=(10,5),xticks = [])","eac99fb9":"plt.figure(figsize=(10,5))\nsns.boxplot(x = \"Sex\", y = \"Age\",data=ab)","7ec260bb":"def one_encode(data,attr):\n    dummies = pd.get_dummies(data[attr])\n    row = pd.concat([data, dummies], axis=1)\n    row = row.drop(attr,axis=1)\n    return(row)","6b975b2f":"ab_one = one_encode(ab,\"Sex\")","57777e4f":"ab_one.dtypes","a522c63d":"# Spliting the dataset\nfrom sklearn.model_selection import train_test_split\n\ntrain_ab, test_ab = train_test_split(ab_one, test_size=0.2, random_state=42)","c0d289cf":"plt.figure(figsize=(5,10))\nplt.title(\"Correlation matrix\")\n\ncorr = train_ab.corr()\nheat = sns.heatmap(corr[[\"Age\"]],annot= True)","2a481472":"train_labels = train_ab[\"Age\"]\ntest_labels = test_ab[\"Age\"]\n\ntrain_ab = train_ab.drop(\"Age\",axis=1)\ntest_ab =  test_ab.drop(\"Age\",axis=1)","a3c53ec6":"from sklearn.svm import SVR\n\nsvr_ab = SVR(kernel=\"rbf\", degree=3, C=100, epsilon=0.1)\nsvr_ab.fit(train_ab, train_labels)","aa2779e3":"from sklearn.metrics import mean_squared_error\n\npredictions = svr_ab.predict(train_ab)\nsvr_mse = mean_squared_error(train_labels, predictions)\nsvr_rmse = np.sqrt(svr_mse)\nprint(f\"The Root Mean Square Error is {svr_rmse:.2f}\")","91cbb6f9":"predictions = svr_ab.predict(test_ab)\nsvr_mse = mean_squared_error(test_labels, predictions)\nsvr_rmse = np.sqrt(svr_mse)\nprint(f\"The Root Mean Square Error is {svr_rmse:.2f}\")","626aeb33":"data = test_ab.iloc[:5]\nlabels = test_labels.iloc[:5]\n\nprint(\"Predictions:\" ,svr_ab.predict(data))\nprint(\"Labels:\", list(labels))","534ec4d5":"Predicting the first five data","8f05a5d7":"Using Support Vector Regression:","691ccc53":"# Determining the age of an Abalone with SVR","0afcb5c5":"There seems to be a positive correlation across all attributes except for Infants category which has a negative correlation and the gender(Male or Female) has the lowest correlation.","31857ec4":" We have one categorical column which is Sex(Male, Female and Infant), let's investigate further into the different Sexes and their correlation with number of rings. ","ce9ae499":"One hot encoding the categorical column:","05a0c1e5":"## Training the Model","eeaf510c":"The age of an abalone can be determined by cutting it's shell and counting the number of rings within the abalone with the help of a microscope, this method is very time consuming.\n\nIn this notebook we will be using Support Vector Regression to determine the age of an abalone from physical measurement.","6a53ff3c":"The are more males and less females. Infants on average have less rings and that makes sense because lower rings means the abalone is younger.","123c2f84":"The age of an abalone is Rings + 1.5","0da9df52":"## Testing the Model"}}