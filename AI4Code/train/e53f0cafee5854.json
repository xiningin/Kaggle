{"cell_type":{"1fa852d3":"code","5f0be7be":"code","0352022a":"code","a71f3c6d":"code","4150efdb":"code","0f7afd7f":"code","813a0650":"code","97214c83":"code","a7c475f8":"code","cd435020":"code","e593f060":"code","0556ed4a":"code","b9f7c332":"code","6c93c393":"code","ddf69d60":"code","4fe1ae95":"code","e997f3f3":"code","4557180f":"code","665cfb61":"code","4148c0ec":"code","8fc9dfdb":"code","cc3b461b":"code","932dd926":"code","b0dbc530":"code","60d0b18f":"code","3dd2d502":"code","ded44cbb":"code","cdb8790e":"code","6b23c61a":"code","9bae44ec":"code","e245f2a2":"code","4cd79f29":"code","86168787":"markdown","c0f39818":"markdown","ccdfd964":"markdown","0dd12df3":"markdown","ef2b509e":"markdown","c28a292a":"markdown","4adcec40":"markdown","2e56eec2":"markdown"},"source":{"1fa852d3":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.ensemble import ExtraTreesRegressor\n%matplotlib inline\n\nfrom sklearn.ensemble import RandomForestRegressor\n\nfrom sklearn.model_selection import RandomizedSearchCV","5f0be7be":"dataset=pd.read_csv('..\/input\/car-data\/car data.csv')","0352022a":"print(dataset['Seller_Type'].unique())\nprint(dataset['Fuel_Type'].unique())\nprint(dataset['Transmission'].unique())\nprint(dataset['Owner'].unique())","a71f3c6d":"#checking missing values\ndataset.isnull().sum()","4150efdb":"dataset.describe","0f7afd7f":"dataset.drop([\"Car_Name\"],axis=1,inplace=True)","813a0650":"dataset['no_year']= 2020- dataset['Year']\ndataset.drop([\"Year\"],axis=1,inplace=True)","97214c83":"#converting categorical values into one hot encoding\ndataset=pd.get_dummies(dataset,drop_first=True)\ndataset.head()","a7c475f8":"pd.get_option(\"display.max_columns\",None)\ndataset.head()   ","cd435020":"dataset.columns.tolist()","e593f060":"corrmat = dataset.corr()\ntop_corr_features = corrmat.index\nplt.figure(figsize=(10,10))\n#plot heat map\ng=sns.heatmap(dataset[top_corr_features].corr(),annot=True,cmap=\"RdYlGn\")","0556ed4a":"X=dataset.iloc[:,1:]\ny=dataset.iloc[:,0]","b9f7c332":"model = ExtraTreesRegressor()\nmodel.fit(X,y)\nprint(model.feature_importances_)","6c93c393":"feat_importances = pd.Series(model.feature_importances_, index=X.columns)\nfeat_importances.plot(kind='barh')\nplt.show()","ddf69d60":"X=X.drop([\"Owner\"],axis=1)","4fe1ae95":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)","e997f3f3":"regressor=RandomForestRegressor()","4557180f":"# Number of trees in random forest\nn_estimators = [int(x) for x in np.linspace(start = 100, stop = 1200, num = 12)]\n# Number of features to consider at every split\nmax_features = ['auto', 'sqrt']\n# Maximum number of levels in tree\nmax_depth = [int(x) for x in np.linspace(5, 30, num = 6)]\n# max_depth.append(None)\n# Minimum number of samples required to split a node\nmin_samples_split = [2, 5, 10, 15, 100]\n# Minimum number of samples required at each leaf node\nmin_samples_leaf = [1, 2, 5, 10]\n","665cfb61":"random_grid = {'n_estimators': n_estimators,\n               'max_features': max_features,\n               'max_depth': max_depth,\n               'min_samples_split': min_samples_split,\n               'min_samples_leaf': min_samples_leaf}","4148c0ec":"rf_random = RandomizedSearchCV(estimator = regressor, param_distributions = random_grid,scoring='neg_mean_squared_error', n_iter = 10, cv = 10, verbose=2, random_state=0, n_jobs = -1)","8fc9dfdb":"rf_random.fit(X_train,y_train)","cc3b461b":"rf_random.best_score_","932dd926":"rf_random.best_params_","b0dbc530":"y_pred=rf_random.predict(X_test)","60d0b18f":"sns.distplot(y_test-y_pred)","3dd2d502":"sns.distplot(y_test-y_pred)","ded44cbb":"plt.scatter(y_test,y_pred)","cdb8790e":"from sklearn.metrics import mean_squared_error as mse\nimport math","6b23c61a":"print(mse(y_test,y_pred))","9bae44ec":"from sklearn.metrics import r2_score","e245f2a2":"print(r2_score(y_test,y_pred))","4cd79f29":"import pickle\nfile=open('random_forest_regression_model.pkl','wb')\npickle.dump(rf_random,file)","86168787":"#### Importing Sklearn","c0f39818":"##### Importing Module","ccdfd964":"# Car Prediction Model ","0dd12df3":"#### By this Model We can easily find or predict the price of used car by analysizing some condition like car purchase year, showroom price etc.This model can be used by car owner and next car buyer and aslo by dealer and Individual  ","ef2b509e":"**Importing Dataset**","c28a292a":"### Auther : Nilesh Kapse","4adcec40":"<img src= \"https:\/\/storage.googleapis.com\/kagglesdsdata\/datasets\/1596865\/2626498\/Car%20Prediction.jpg?X-Goog-Algorithm=GOOG4-RSA-SHA256&X-Goog-Credential=databundle-worker-v2%40kaggle-161607.iam.gserviceaccount.com%2F20210918%2Fauto%2Fstorage%2Fgoog4_request&X-Goog-Date=20210918T083732Z&X-Goog-Expires=345599&X-Goog-SignedHeaders=host&X-Goog-Signature=6a9e611dfd3674fd2216b425f2aa1ab96ccf3a4529bd3b8472fbbac67578b9c6f787d7bb7cb1e5d58ec25718e8eb506808b2c842d031b3865c905f27faf29bee98bf196b7f00a30c6454467eaa8596bac50f9ba279d0ad630ed4853c1601fdc10018500e7127c3fbd303dfdebe838cd1358e2e04aa470da4236aa2885aaeb1cc7c298a3d4d9f43b7b7a514630f7ff392513ffc9afdd3ff36209708faba26b01363d92aa3735dd06670695dd7156166b2fa0d03ce6d0f88a659f11fd315e4ced909cc0aa80bf8e0a56eb7434743d8bce114ae4aa62e78528e0ec13a89eeef6b150d96e45a40ff966dd86447557fd4bbfca9efcabb80f07cb851c4579525645ca9\" alt =\"Titanic\" style='width: 800px;'>","2e56eec2":"**Data Describing**"}}