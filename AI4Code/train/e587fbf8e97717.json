{"cell_type":{"f0e74225":"code","047c9ff0":"code","6aacb456":"code","260bfeb4":"code","067e6943":"code","75b75f3f":"code","14df5939":"code","3f2545f9":"code","e5840e16":"code","8aaaf70e":"code","e9056101":"code","a594e0ce":"code","a5259de8":"code","228adc37":"code","cdf13a16":"code","4b982ee2":"code","7298ad2c":"code","44979ab2":"code","b1294f82":"code","e1d5f00d":"code","bec422cd":"markdown","429ff071":"markdown","5e4573f8":"markdown","423f3ef5":"markdown"},"source":{"f0e74225":"# packages\n\n# standard\nimport numpy as np\nimport pandas as pd\nimport time\n\n# plots\nimport matplotlib.pyplot as plt\nimport matplotlib.ticker as mtick\nimport seaborn as sns","047c9ff0":"# load and preview\ndf = pd.read_csv('..\/input\/life-expectancy-global-trend\/life_expectancy_years.csv')\ndf.head()","6aacb456":"# list of available countries\nall_countries = df.geo.tolist()\nprint(all_countries)","260bfeb4":"# select a few countries for plot\nselect_countries = ['China', 'India', 'France', \n                    'Germany', 'Japan', 'United Kingdom',\n                    'United States']\n\ndf_sel = df[df.geo.isin(select_countries)].reset_index(drop=True)\ndf_sel","067e6943":"# rearrange a little bit\ndf_sel4plot = pd.DataFrame(df_sel.iloc[:,1:].transpose()) # convert rows to columns\ndf_sel4plot.columns = df_sel.geo.values # add columns\ndf_sel4plot.index = df_sel4plot.index.astype(int) # convert index from string to int\ndf_sel4plot.head()","75b75f3f":"# now plot, all years from 1800..2018\nplt_para_save = plt.rcParams['figure.figsize'] # remember plot settings\nplt.rcParams['figure.figsize'] = (16,7)\n\ndf_sel4plot.plot.line()\nplt.title('Development of life expectancy for selected countries')\nplt.grid()\nplt.show()\n\n# reset plot size again\nplt.rcParams['figure.figsize'] = plt_para_save","14df5939":"# plot again, but only years >= 1950\nplt_para_save = plt.rcParams['figure.figsize'] # remember plot settings\nplt.rcParams['figure.figsize'] = (16,7)\n\ndf_sel4plot[df_sel4plot.index>=1950].plot.line()\nplt.title('Development of life expectancy for selected countries - 1950+')\nplt.grid()\nplt.show()\n\n# reset plot size again\nplt.rcParams['figure.figsize'] = plt_para_save","3f2545f9":"# summary stats\ndf_sel4plot['Year'] = df_sel4plot.index # explicitly add year\ndf_sel4plot.describe()","e5840e16":"# rearrange a little bit\ndf_all4plot = pd.DataFrame(df.iloc[:,1:].transpose()) # convert rows to columns\ndf_all4plot.columns = df.geo.values # add columns\ndf_all4plot.index = df_sel4plot.index.astype(int) # convert index from string to int\ndf_all4plot.head()","8aaaf70e":"# add Year explicitly\ndf_all4plot['Year'] = df_all4plot.index","e9056101":"# melt all values into one column\ndf_all4plot_compact = pd.melt(df_all4plot, id_vars='Year', value_vars=all_countries)\ndf_all4plot_compact","a594e0ce":"# create boxplots for each year across all countries\nplt.figure(figsize=(20,6))\nax = sns.boxplot(data=df_all4plot_compact, x='Year', y='value')\nax.xaxis.set_major_locator(plt.MaxNLocator(20)) # reduce number of x-labels\nplt.title('Life Expectancy by Year - All Countries included')\nplt.grid()\nplt.show()","a5259de8":"# create boxplots for each year across all countries; again years >= 1950 only\nplt.figure(figsize=(20,6))\nax = sns.boxplot(data=df_all4plot_compact[df_all4plot_compact.Year>=1950], x='Year', y='value')\nax.xaxis.set_major_locator(plt.MaxNLocator(15)) # reduce number of x-labels\nplt.title('Life Expectancy by Year - All Countries included - 1950+')\nplt.grid()\nplt.show()","228adc37":"# same with violinplots\nplt.figure(figsize=(20,6))\nax = sns.violinplot(data=df_all4plot_compact[df_all4plot_compact.Year>=1950], x='Year', y='value')\nax.xaxis.set_major_locator(plt.MaxNLocator(15)) # reduce number of x-labels\nplt.title('Life Expectancy by Year - All Countries included - 1950+')\nplt.grid()\nplt.show()","cdf13a16":"# select country of interest\nselect_country = 'United States'","4b982ee2":"# filter\ndf_c = df[df.geo==select_country]\n# rearrange again\ndf_c = pd.DataFrame(df_c.iloc[:,1:].transpose()) # convert row to column\ndf_c.columns = ['LifeExp']\ndf_c.index = df_c.index.astype(int) # convert index from string to int\n# add year on year increments\ndf_c['YoY_diff'] = df_c['LifeExp'].diff()\n# ... and year on year percentage change\ndf_c['YoY_rel'] = df_c['LifeExp'].pct_change()\n# show most recent values\ndf_c.tail(10)","7298ad2c":"# plot life expectancy\nplt.figure(figsize=(16,6))\ndf_c.LifeExp.plot()\nplt.title(select_country + ' - Life Expectancy')\nplt.grid()\nplt.show()","44979ab2":"# plot year on year difference\nplt.figure(figsize=(16,6))\ndf_c.YoY_diff.plot()\nplt.title(select_country + ' - Life Expectancy - YoY difference')\nplt.grid()\nplt.show()","b1294f82":"# plot year on year difference, from 1950 on\nplt.figure(figsize=(16,6))\ndf_c[df_c.index>=1950].YoY_diff.plot()\nplt.title(select_country + ' - Life Expectancy - YoY difference - 1950+')\nplt.grid()\nplt.show()","e1d5f00d":"# plot year on year relative change\nplt.figure(figsize=(16,6))\nax = df_c[df_c.index>=1950].YoY_rel.plot()\nax.yaxis.set_major_formatter(mtick.PercentFormatter(xmax=1, decimals=None, symbol='%', is_latex=False))\nplt.title(select_country + ' - Life Expectancy - YoY rel.change - 1950+')\nplt.grid()\nplt.show()","bec422cd":"<a id='1'><\/a>\n# Explore a subset of countries","429ff071":"<a id='2'><\/a>\n# All Countries","5e4573f8":"# Table of Contents\n* [Explore a subset of countries](#1)\n* [All countries](#2)\n* [Analysis of individual country](#3)","423f3ef5":"<a id='3'><\/a>\n# Analysis of individual country"}}