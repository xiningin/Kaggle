{"cell_type":{"e9bae87e":"code","5e1d49d9":"code","080fb999":"code","87ef8355":"code","dca1a2f9":"code","d2304c74":"code","3913e1ca":"code","4e473b03":"code","4402d692":"code","778ecb08":"code","1a44fdc8":"code","7faad74b":"code","667e5c91":"code","c176458e":"code","288b7841":"code","ed66c1d1":"code","8cc1ec40":"code","3eb7a782":"code","08e0c1b4":"code","e9b4bbff":"code","5bb3e61e":"code","e868b152":"code","3d06bc62":"code","21a95602":"code","e9eee237":"code","9e158992":"code","3ad10d4d":"code","b5ae5d57":"code","ba33bf27":"code","269ca430":"code","8d777eee":"code","3496b730":"code","8d61e748":"code","0d3d995a":"code","a935de7a":"code","76701e9b":"markdown","6e1754e8":"markdown","66209704":"markdown","61e3d9bc":"markdown","010737f6":"markdown","343e46c8":"markdown","45da4977":"markdown","c6b15cf8":"markdown","9375df29":"markdown","f4abb842":"markdown","d6160eb5":"markdown","9201d1da":"markdown","3d22e129":"markdown","8d13e255":"markdown","b07d5c8e":"markdown","d959fa5f":"markdown","3274a2ce":"markdown","9fe3a320":"markdown"},"source":{"e9bae87e":"import numpy as np\nimport seaborn as sns\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport plotly.express as px\nimport plotly.graph_objects as go\nimport plotly.figure_factory as ff\nfrom plotly.colors import n_colors\nfrom plotly.subplots import make_subplots\n","5e1d49d9":"df=pd.read_csv('..\/input\/passenger-list-for-the-estonia-ferry-disaster\/estonia-passenger-list.csv')\ndf.head()","080fb999":"df.isna().any()","87ef8355":"unn_cols=['PassengerId','Firstname','Lastname']\n\nfor cols in unn_cols:\n    df.drop(cols,axis=1,inplace=True)","dca1a2f9":"df.head()","d2304c74":"df_temp=df.copy()\ndf_temp['Count']=1\ndf_country=df_temp.groupby('Country')['Count'].sum().reset_index().sort_values(by='Count',ascending=False)\n\nfig1=go.Figure([go.Pie(labels=df_temp['Country'],values=df_temp['Count'])])\n\nfig1.update_traces(textfont_size=15,textinfo='value+percent')\nfig1.update_layout(title='Passenger nationalities',title_x=0.5,height=700,width=700)\nfig1.show()","3913e1ca":"df_temp['Survived']=df_temp['Survived'].replace(0,'Not survived')\ndf_temp['Survived']=df_temp['Survived'].replace(1,'Survived')\n\nsns.catplot('Sex',kind='count',hue='Survived',data=df_temp,height=8,aspect=2,palette='winter')\nplt.xticks(size=15)\nplt.xlabel('Sex',size=15)\nplt.ylabel('Number of passengers',size=15)\nplt.title('Survival of passengers based on sex',size=25)","4e473b03":"df_male=df_temp[df_temp['Sex']=='M']\ndf_female=df_temp[df_temp['Sex']=='F']\n\ncolors=['green','orange']\ndf_survival=df_temp.groupby('Survived')['Count'].sum().reset_index().sort_values(by='Count')\nfig2=go.Figure([go.Pie(labels=df_survival['Survived'],values=df_survival['Count'])])\n\nfig2.update_traces(textfont_size=15,textinfo='value+percent+label',marker=dict(colors=colors))\nfig2.update_layout(title='\\n  \\n Male fatality rate: {0:.2f} % \\n Female fatality rate: {1:.2f} %'.format(100*df_male['Survived'].value_counts()[0]\/ df_male.shape[0],100*df_female['Survived'].value_counts()[0]\/ df_female.shape[0]),title_x=0.5,height=700,width=700)\nfig2.show()","4402d692":"plt.figure(figsize=(10,8))\nsns.distplot(df_temp['Age'])\nplt.title('Passenger age distribution',size=20)\nplt.axvline(df_temp['Age'].median(),color='red',label='Median age')\nplt.legend()","778ecb08":"fig3=plt.figure(figsize=(10,8))\nax1=fig3.add_subplot(111)\nplt.title('Surival with respect to age',size=20)\n\nsns.regplot(df['Age'],df['Survived'],ax=ax1)\nax1.set_xlabel('Age',size=15)\nax1.set_ylabel('Survived',size=15)","1a44fdc8":"df_temp['Category']=df_temp['Category'].replace('C','Crew member')\ndf_temp['Category']=df_temp['Category'].replace('P','Passenger')","7faad74b":"df_cats=df_temp.groupby('Category')['Count'].sum().reset_index()\n\nfig3=go.Figure([go.Pie(labels=df_cats['Category'],values=df_cats['Count'])])\n\nfig3.update_traces(textfont_size=15,textinfo='value+percent')\nfig3.update_layout(title='Passenger categories',title_x=0.5,height=700,width=700)\nfig3.show()","667e5c91":"df_crew=df_temp[df_temp['Category']=='Crew member']\ndf_pass=df_temp[df_temp['Category']=='Passenger']\nsns.catplot('Category',kind='count',data=df_temp,hue='Survived',palette='viridis',aspect=2,height=8)\nplt.xticks(size=15)\nplt.xlabel('Category',size=15)\nplt.ylabel('Number of passengers',size=15)\nplt.title('Category wise fatalities \\n \\n Crew fatality rate:{0:.2f}% \\n \\n Passenger fatality rate:{1:.2f}%'.format(100*df_crew['Survived'].value_counts()[0]\/df_crew.shape[0],\n                                                                                                                     100*df_pass['Survived'].value_counts()[0]\/df_pass['Survived'].shape[0]),size=20)","c176458e":"df.loc[df['Age']<=10,'Age band']=1\ndf.loc[(df['Age']>10) & (df['Age']<21),'Age band']=2\ndf.loc[(df['Age']>20) & (df['Age']<41),'Age band']=3\ndf.loc[(df['Age']>40) & (df['Age']<61),'Age band']=4\ndf.loc[(df['Age']>60),'Age band']=5","288b7841":"df.drop('Age',axis=1,inplace=True)","ed66c1d1":"temp=pd.get_dummies(df['Category'])\ndf=df.merge(temp,on=df.index)","8cc1ec40":"temp_sex=pd.get_dummies(df['Sex'])","3eb7a782":"df.drop('key_0',axis=1,inplace=True)\ndf=df.merge(temp_sex,on=df.index)","08e0c1b4":"df.drop(['key_0','Country','Sex','Category'],axis=1,inplace=True)\ndf.head()","e9b4bbff":"target=df['Survived']\ndf.drop('Survived',axis=1,inplace=True)","5bb3e61e":"from sklearn.model_selection import train_test_split","e868b152":"X=df\ny=target\nX_train,X_test,y_train,y_test=train_test_split(X,y,shuffle=True,test_size=0.2,random_state=0)","3d06bc62":"from sklearn.linear_model import LogisticRegression","21a95602":"reg_log=LogisticRegression()\nreg_log.fit(X_train,y_train)","e9eee237":"y_pred=reg_log.predict(X_test)","9e158992":"reg_log.score(X_train,y_train)","3ad10d4d":"from sklearn.metrics import confusion_matrix\nfig=plt.figure(figsize=(10,8))\nax=fig.add_subplot(111)\nconf_mat_log=confusion_matrix(y_pred,y_test)\nsns.heatmap(conf_mat_log,annot=True,fmt='g',ax=ax)\nax.set_xlabel('Actual')\nax.set_ylabel('Predicted')\nax.xaxis.set_ticklabels(['Not survived', 'Survived'])\nax.yaxis.set_ticklabels(['Not survived', 'Survived'],rotation=0)","b5ae5d57":"from sklearn.tree import DecisionTreeClassifier\n\ndtc=DecisionTreeClassifier(max_depth=4)\ndtc.fit(X_train,y_train)\ny_pred_dtc=dtc.predict(X_test)","ba33bf27":"fig=plt.figure(figsize=(10,8))\nax=fig.add_subplot(111)\nconf_mat_dtc=confusion_matrix(y_pred_dtc,y_test)\nsns.heatmap(conf_mat_dtc,annot=True,fmt='g',ax=ax,cmap='gnuplot')\nax.set_xlabel('Predicted')\nax.set_ylabel('Actual')\nax.xaxis.set_ticklabels(['Not survived', 'Survived'])\nax.yaxis.set_ticklabels(['Not survived', 'Survived'],rotation=0)","269ca430":"from xgboost import XGBClassifier","8d777eee":"xgb=XGBClassifier()\nxgb.fit(X_train,y_train)\nxgb.score(X_train,y_train)","3496b730":"y_pred_xgb=xgb.predict(X_test)\nfig=plt.figure(figsize=(10,8))\nax=fig.add_subplot(111)\nconf_mat_xgb=confusion_matrix(y_pred_xgb,y_test)\nsns.heatmap(conf_mat_xgb,annot=True,fmt='g',ax=ax,cmap='summer')\nax.set_ylabel('Predicted')\nax.set_xlabel('Actual')\nax.xaxis.set_ticklabels(['Not survived', 'Survived'])\nax.yaxis.set_ticklabels(['Not survived', 'Survived'],rotation=0)","8d61e748":"from lightgbm import LGBMClassifier","0d3d995a":"lgb=LGBMClassifier()\nlgb.fit(X_train,y_train)","a935de7a":"\nfig=plt.figure(figsize=(10,8))\nax=fig.add_subplot(111)\ny_pred_lgb=lgb.predict(X_test)\nconf_mat_lgb=confusion_matrix(y_pred_lgb,y_test)\nsns.heatmap(conf_mat_lgb,annot=True,fmt='g',ax=ax,cmap='coolwarm')\nax.set_xlabel('Actual')\nax.set_ylabel('Predicted')\nax.xaxis.set_ticklabels(['Not survived', 'Survived'])\nax.yaxis.set_ticklabels(['Not survived', 'Survived'],rotation=0)","76701e9b":"# If you found the notebook helpful, an upvote would be great ! :)","6e1754e8":"## C) XGBoost","66209704":"# Introduction\n\nThe MS Estonia was a cruise ferry built in the 1980s in Papenburg,Germany. This ship disaster has been the biggest since the RMS Titanic. About 852 souls were lost. The disaster took place on 28th September, 1994 while the ship was crossing the Baltic Sea and enroute to Stockholm, Sweden.\n\nThe disaster was said to happen due to the failure of the bow visor at the front the ship due to extreme strains of the waves constantly hitting the forward most areas. This caused the front section to slowly tear off from the ship causing the front ramp and entry doors to open up leading the seawater gushing into the ship. Eventually, the MS Estonia capsized and sank. For all the mechanical engineers and material\/metallurgy engineers, this particular youtube video will be an interesting watch showing a simulation of what happened that particular night.\n\n\nYoutube simulation link\n\nhttps:\/\/www.youtube.com\/watch?v=IyqlkWZL0ZI\n\n\nThrough this particular notebook, we will try to understand what are the various factors that led to passneger deaths. We will check if there are any factors that helped a passenger to survive the disaster.\n\nAt the same time, we must all pay respects to the families of the all passengers who couldn't make it through the rough night.\n\n![ms-1.jpg](attachment:ms-1.jpg)\n\n\n# Importing libraries and datasets\n\nLet us import all the relevant libraries and datasets\n","61e3d9bc":"## D) LightGBM Classifier","010737f6":"As we can see from the plot above, most of the passnegers were from Sweden or Estonia. The other nationalities were Latvia, Finland, Russia and a few more.\n\n\n## Sex\n\nLet us check the sexes of the passengers and their correlation with survival.\n","343e46c8":"As per my intuition, the country of origin should really have no importance in predicting the survival of the passengers. Hence, we shall drop this feature alongwith the rest of the unimportant features.","45da4977":"# Data Visualisation\n\n\n## Country of origin\n\nLet us try to visualise the data to understand how to better feature engineer our dataframe. Let us start off with passenger country of origin.\n\n","c6b15cf8":"As we can see from the above regplot, as the passenger age increases, survival rate also reduces. This means older people were less likely to survive the disaster.\n\n\n## Category of passenger\n\nLet us see if category of the passenger had any relation to survival of passengers. C stood for crew members while P stood for passengers.","9375df29":"As we can see, there are no null values associated with any of the columns.\n\nLet us try to see how the data has been encoded.\n\n### Sex\n\nM: Male\n\nF:Female\n\n### Category\n\nC: Crew member\n\nP: Passenger\n\n### Survived\n\n0: Could not survive\n\n1: Survived\n\nWe also know that things like PassengerId and First,last name will not help our predictions in any manner. Let us simply drop these particular columns.","f4abb842":"From the above plots, we see that the fatality rate for females were higher than that of male passengers. This is quite opposite to what was observed for the Titanic where male fatality rates were higher.\n\nIn total, 86.1% passengers could sadly not make it alive from the disaster.\n\n## Age\n\nLet us see how the ages of the passengers are distributed first.","d6160eb5":"From the above distplot, we see that most of the passengers were of the ages between 40-60.\n\nLet us see if there is any relation between age and survival using a regplot.","9201d1da":"# Conclusion\n\n* Fatality rate for the disaster was quite high with about 86% people losing their lives.\n* Fatality rate for crew members was slightly better than the passengers.\n* With age, the chances of survival reduced.\n* Female fatality rate was notable higher than male fatality.\n* Due to imabalance in the dataset, number of predictions for survivors could not be captured by the algorithms due to very low survivor data.","3d22e129":"# Machine Learning","8d13e255":"## A) Logistic Regression","b07d5c8e":"# Data Wrangling\n\nLet us first analyse what the data entries exactly mean. We shall try to take care of null values if any and then use some feature engineering to make the data more understandable for the algorithm. ","d959fa5f":"Our dataframe is now ready for Machine Learning algorithm. All we have to do now is to segregate the target columns.","3274a2ce":"From the above plot, we see that the fatality rate for the crew members was slightly lower than passengers. This is opposite to what happened in the RMS titanic where the crew fatality rate was higher than passenger fatality rate. \n\n# Feature engineering\n\nNow that we are done with the data visualisation process, let us do some feature engineering which will benefit us to feed the data into the ML algorithm.\n\n\nFirst, let us categorize the continuous age values into age bands as follows:\n\n\n0-10 : 1\n\n11-20 : 2\n\n20-40 : 3\n\n40-60 : 4\n\n60 and above :5","9fe3a320":"## B) Decision Tree"}}