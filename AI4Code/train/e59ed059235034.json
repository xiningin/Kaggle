{"cell_type":{"23bb5440":"code","1003290a":"code","de2f4a8b":"code","34eb1741":"code","0dfbfc7f":"code","0e39c352":"code","f70c1b96":"code","eec39fc3":"code","3bd16777":"code","73a0bf55":"code","d0f4f7f2":"code","cdf92e81":"code","4a49275f":"code","73e6d49d":"markdown","9d22f6d0":"markdown","f31f3dab":"markdown"},"source":{"23bb5440":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport sklearn\nfrom sklearn.impute import SimpleImputer\nfrom sklearn.decomposition import PCA as PCA\nfrom sklearn.metrics import silhouette_samples\nimport matplotlib.pyplot as plt\nfrom matplotlib import cm\nimport warnings\nwarnings.filterwarnings('ignore')","1003290a":"data = pd.read_csv('..\/input\/prediction-bod-in-river-water\/test.csv')","de2f4a8b":"print('shape = ', data.shape)\nprint(data.columns)","34eb1741":"data = data.drop(['Id',], axis=1)\ndata['2'] = data['3'].factorize()[0]\ndata = data.dropna()\ndata.head(10)\ndata.info()\n\n","0dfbfc7f":"sns.pairplot(data[['2', '3', '4', '5']]);","0e39c352":"g = sns.PairGrid(data[['2', '3', '4', '5']])\ng.map_diag(sns.kdeplot)\ng.map_offdiag(sns.kdeplot, n_levels=8);","f70c1b96":"fig = plt.figure(figsize=(15,15))\nax1 = fig.add_subplot(3,3,1)\nsns.barplot(y='3',x='2', data=data);\nax2 = fig.add_subplot(3,3,2)\nsns.barplot(y='4',x='3', data=data);\nax3 = fig.add_subplot(3,3,3)\nsns.barplot(y='2',x='4', data=data);","eec39fc3":"\npca = PCA(n_components=2)\npca.fit(data)\nXpca = pca.transform(data)\nsns.set()\nplt.figure(figsize=(8,8))\nplt.scatter(Xpca[:,0],Xpca[:,1], c='Red')\nplt.show()","3bd16777":"from sklearn.manifold import TSNE\ntsn = TSNE()\nres_tsne = tsn.fit_transform(data)\nplt.figure(figsize=(8,8))\nplt.scatter(res_tsne[:,0],res_tsne[:,1]);","73a0bf55":"from sklearn.cluster import AgglomerativeClustering as AggClus","d0f4f7f2":"clus_mod = AggClus(n_clusters=3)\nassign = clus_mod.fit_predict(data)\nplt.figure(figsize=(8,8))\nsns.set(style='darkgrid',palette='muted')\ncmap = sns.cubehelix_palette(dark=.3, light=.8, as_cmap=True)\nsns.scatterplot(x=res_tsne[:,0],y=res_tsne[:,1],s=100, hue=assign, palette='Set1');","cdf92e81":"from scipy.cluster.hierarchy import dendrogram, ward\nsns.set(style='white')\nplt.figure(figsize=(10,7))\nlink = ward(res_tsne)\ndendrogram(link)\nax = plt.gca()\nbounds = ax.get_xbound()\nax.plot(bounds, [30,30],'--', c='k')\nax.plot(bounds,'--', c='k')\nplt.show()","4a49275f":"clus_mod = AggClus(n_clusters=3)\nassign = clus_mod.fit_predict(data)\nplt.figure(figsize=(8,8))\nsns.set(style='darkgrid',palette='muted')\ncmap = sns.cubehelix_palette(dark=.3, light=.8, as_cmap=True)\nsns.scatterplot(x=res_tsne[:,0],y=res_tsne[:,1],s=50, hue=assign, palette='copper');","73e6d49d":"Thanks to:\n* https:\/\/www.kaggle.com\/vbmokin\n* https:\/\/scikit-learn.org\/stable\/modules\/generated\/sklearn.cluster.AgglomerativeClustering.html\n* https:\/\/scikit-learn.org\/stable\/auto_examples\/cluster\/plot_agglomerative_dendrogram.html#sphx-glr-auto-examples-cluster-plot-agglomerative-dendrogram-py\n* https:\/\/towardsdatascience.com\/machine-learning-algorithms-part-12-hierarchical-agglomerative-clustering-example-in-python-1e18e0075019","9d22f6d0":"## Clustering","f31f3dab":"Drop non-informative ordinal data - Id"}}