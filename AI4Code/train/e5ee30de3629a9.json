{"cell_type":{"22811aa5":"code","6dbde248":"code","10067081":"code","9c58d99e":"code","c87255c4":"code","05dc1e40":"code","14043a5d":"code","db46cafe":"code","953fbf7f":"code","a63b0f44":"code","c909a323":"code","78b743e7":"code","dc196d6d":"code","dc889195":"code","2aca333a":"code","d675dc79":"code","c06d4a9a":"code","1a9eb5ba":"code","d498418b":"code","ca80173f":"code","6df88b21":"code","ffa9b888":"code","61feb87c":"code","f730cc90":"code","77528bd0":"code","887247bb":"code","94e91473":"code","92af4b5d":"code","ab92f370":"code","441455cc":"code","06c5449b":"code","79942c90":"code","646cb74e":"code","499c8d99":"code","0c79eafa":"markdown","189d3a5b":"markdown","a34db1f9":"markdown","6fcf9a05":"markdown","7d2cfde3":"markdown","bd71e041":"markdown","93e0d77d":"markdown","f957145c":"markdown","70d270ca":"markdown","29513546":"markdown","9a791825":"markdown","0510ae49":"markdown","5ea45984":"markdown","7d1814ee":"markdown","20746c51":"markdown"},"source":{"22811aa5":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","6dbde248":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\nfrom sklearn.preprocessing import LabelEncoder","10067081":"liv_df = pd.read_csv('\/kaggle\/input\/indian-liver-patient-records\/indian_liver_patient.csv')\nliv_df.head()","9c58d99e":"liv_df.info()","c87255c4":"liv_df.describe(include='all')","05dc1e40":"liv_df.isnull().sum()","14043a5d":"sns.countplot(data=liv_df, x = 'Dataset', label='Count')\nLD, NLD = liv_df['Dataset'].value_counts()\nprint('Number of patients diagnosed with liver disease: ',LD)\nprint('Number of patients not diagnosed with liver disease: ',NLD)","db46cafe":"sns.countplot(data=liv_df, x = 'Gender', label='Count')\nM, F = liv_df['Gender'].value_counts()\nprint('Number of patients that are male: ',M)\nprint('Number of patients that are female: ',F)","953fbf7f":"sns.factorplot(x=\"Age\", y=\"Gender\", hue=\"Dataset\", data=liv_df);","a63b0f44":"liv_df[['Gender', 'Dataset','Age']].groupby(['Dataset','Gender'], as_index=False).count().sort_values(by='Dataset', ascending=False)","c909a323":"liv_df[['Gender', 'Dataset','Age']].groupby(['Dataset','Gender'], as_index=False).mean().sort_values(by='Dataset', ascending=False)","78b743e7":"g = sns.FacetGrid(liv_df, col=\"Dataset\", row=\"Gender\", margin_titles=True)\ng.map(plt.hist, \"Age\", color=\"red\")\nplt.subplots_adjust(top=0.9)\ng.fig.suptitle('Disease by Gender and Age');","dc196d6d":"g = sns.FacetGrid(liv_df, col=\"Gender\", row=\"Dataset\", margin_titles=True)\ng.map(plt.scatter,\"Direct_Bilirubin\", \"Total_Bilirubin\", edgecolor=\"w\")\nplt.subplots_adjust(top=0.9)","dc889195":"sns.jointplot(\"Total_Bilirubin\", \"Direct_Bilirubin\", data=liv_df, kind=\"reg\")","2aca333a":"g = sns.FacetGrid(liv_df, col=\"Gender\", row=\"Dataset\", margin_titles=True)\ng.map(plt.scatter,\"Aspartate_Aminotransferase\", \"Alamine_Aminotransferase\",  edgecolor=\"w\")\nplt.subplots_adjust(top=0.9)","d675dc79":"sns.jointplot(\"Aspartate_Aminotransferase\", \"Alamine_Aminotransferase\", data=liv_df, kind=\"reg\")","c06d4a9a":"g = sns.FacetGrid(liv_df, col=\"Gender\", row=\"Dataset\", margin_titles=True)\ng.map(plt.scatter,\"Alkaline_Phosphotase\", \"Alamine_Aminotransferase\",  edgecolor=\"w\")\nplt.subplots_adjust(top=0.9)","1a9eb5ba":"sns.jointplot(\"Alkaline_Phosphotase\", \"Alamine_Aminotransferase\", data=liv_df, kind=\"reg\")","d498418b":"g = sns.FacetGrid(liv_df, col=\"Gender\", row=\"Dataset\", margin_titles=True)\ng.map(plt.scatter,\"Total_Protiens\", \"Albumin\",  edgecolor=\"w\")\nplt.subplots_adjust(top=0.9)","ca80173f":"sns.jointplot(\"Total_Protiens\", \"Albumin\", data=liv_df, kind=\"reg\")","6df88b21":"g = sns.FacetGrid(liv_df, col=\"Gender\", row=\"Dataset\", margin_titles=True)\ng.map(plt.scatter,\"Albumin\", \"Albumin_and_Globulin_Ratio\",  edgecolor=\"w\")\nplt.subplots_adjust(top=0.9)","ffa9b888":"sns.jointplot(\"Albumin_and_Globulin_Ratio\", \"Albumin\", data=liv_df, kind=\"reg\")","61feb87c":"g = sns.FacetGrid(liv_df, col=\"Gender\", row=\"Dataset\", margin_titles=True)\ng.map(plt.scatter,\"Albumin_and_Globulin_Ratio\", \"Total_Protiens\",  edgecolor=\"w\")\nplt.subplots_adjust(top=0.9)","f730cc90":"liv_df = pd.concat([liv_df,pd.get_dummies(liv_df['Gender'], prefix = 'Gender')], axis=1)\nliv_df.head()","77528bd0":"liv_df[liv_df['Albumin_and_Globulin_Ratio'].isnull()] #the columns having null values","887247bb":"liv_df[\"Albumin_and_Globulin_Ratio\"] = liv_df.Albumin_and_Globulin_Ratio.fillna(liv_df['Albumin_and_Globulin_Ratio'].mean())","94e91473":"from sklearn.model_selection import train_test_split\nDroop_gender = liv_df.drop(labels=['Gender' ],axis=1 )\nX = Droop_gender\ny = liv_df['Dataset']","92af4b5d":"# split data\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.3, random_state = 101)","ab92f370":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import classification_report,confusion_matrix\nfrom sklearn import linear_model","441455cc":"random_forest = RandomForestClassifier(n_estimators=100)\nrandom_forest.fit(X_train, y_train)\n#Predicting Output\nrf_predicted = random_forest.predict(X_test)\nrandom_forest_score = round(random_forest.score(X_train, y_train) * 100, 2)\nrandom_forest_score_test = round(random_forest.score(X_test, y_test) * 100, 2)\n\nprint('Random Forest Score: \\n', random_forest_score)\nprint('Random Forest Test Score: \\n', random_forest_score_test)\nprint('Accuracy: \\n', accuracy_score(y_test,rf_predicted))\nprint(confusion_matrix(y_test,rf_predicted))\nprint(classification_report(y_test,rf_predicted))","06c5449b":"from sklearn.linear_model import LogisticRegression","79942c90":"logreg = LogisticRegression()\n# Train the model using the training sets and check score\nlogreg.fit(X_train, y_train)\n#Predict Output\nlog_predicted= logreg.predict(X_test)\n\nlogreg_score = round(logreg.score(X_train, y_train) * 100, 2)\nlogreg_score_test = round(logreg.score(X_test, y_test) * 100, 2)\n#Equation coefficient and Intercept\nprint('Logistic Regression Training Score: \\n', logreg_score)\nprint('Logistic Regression Test Score: \\n', logreg_score_test)\nprint('Coefficient: \\n', logreg.coef_)\nprint('Intercept: \\n', logreg.intercept_)\nprint('Accuracy: \\n', accuracy_score(y_test,log_predicted))\nprint('Confusion Matrix: \\n', confusion_matrix(y_test,log_predicted))\nprint('Classification Report: \\n', classification_report(y_test,log_predicted))","646cb74e":"plt.figure(figsize=(10, 10))\nsns.heatmap(X.corr(), cbar = True,  square = True, annot=True, fmt= '.2f',annot_kws={'size': 8},\n           cmap= 'coolwarm')\nplt.title('Correlation between features')","499c8d99":"models = pd.DataFrame({\n    'Model': [ 'Logistic Regression','Random Forest'],\n    'Score': [ logreg_score, random_forest_score],\n    'Test Score': [ logreg_score_test, random_forest_score_test]})\nmodels.sort_values(by='Test Score', ascending=False)","0c79eafa":"### This introduces you to an approach to get maximum accuracy on this dataset. I have used @sanjames approach for feature selection and then used Random Forest and Logistic regression to compute the predictions.","189d3a5b":"*Hence we can see the important features from this correlation heat maps which are*:\n*   Total_Bilirubin\n*   Alamine_Aminotransferase\n*   Total_Protiens\n*   Albumin_and_Globulin_Ratio\n*   Albumin\n*   Age \n*   Gender","a34db1f9":"Selected Features\nHence from the aforementioned information we will only use the following features:\n*   Total_Bilirubin\n*   Alamine_Aminotransferase\n*   Total_Protiens\n*   Albumin_and_Globulin_Ratio\n*   Albumin\n*   Age \n*   Gender\n*   Dataset\n\n\n\n\n","6fcf9a05":"*The above correlation also indicates the following correlation\n Total_Protiens & Albumin\n Alamine_Aminotransferase & Aspartate_Aminotransferase\n Direct_Bilirubin & Total_Bilirubin\n There is some correlation between Albumin_and_Globulin_Ratio and Albumin. But its not as high as Total_Protiens & Albumin* ","7d2cfde3":"# Part 3\n## Building the ML model","bd71e041":"*As there is no correlation between these two we need to consider both of them for the classification.*","93e0d77d":"## Output","f957145c":"# Part 2\n## Data visualization","70d270ca":"# Part 1\n## Analysing the Dataset\n","29513546":"*As there is linear dependency we can remove one of the features from the model prediction part*","9a791825":"Hence age is crucial factor here, which decides the prediction.","0510ae49":"*We can remove one of the columns from Direct bilirubin and Total bilirubin as they are linearly dependent.*","5ea45984":"*We can see the gender is the only non numeric column and the column named 'Dataset' has values 1(s) and 0(s) and which is simple boolean value it tell us about whether the patient is diseased or not.*","7d1814ee":"*Similarly for Aspartate_Aminotransferase and Alamine_Aminotransferase*","20746c51":"We have to make all the rows same and as Albumin and Globulin ration only has 579 rows we must use some preprocessing technique to get it done."}}