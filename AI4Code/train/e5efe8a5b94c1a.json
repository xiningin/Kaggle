{"cell_type":{"a8668a73":"code","72fe8373":"code","b490f1aa":"code","65be36b3":"code","545f826c":"code","41d9e71c":"code","ed340da6":"code","502ffe05":"code","28fbdd3f":"code","ca6a4d50":"code","87fea604":"code","29d55d3b":"code","d990a298":"code","760dd3c5":"code","298aeaac":"code","d5d18b67":"code","8475548a":"code","4ceaad77":"code","aa22ed2b":"code","35674dfc":"code","a4901528":"code","c151a520":"code","166c571e":"code","85b050b4":"code","ee9ac96f":"code","a037e32c":"code","067005ca":"code","72fc0b94":"code","05c8bde2":"code","e7d67f86":"code","9e15ef6e":"code","2e96ed42":"code","fa219893":"code","cbaa23cf":"code","25096a59":"code","9eb421ed":"code","66afa8f7":"code","f02b5bee":"code","f76312fe":"code","943fbfd9":"code","dfb86c15":"code","08234ee4":"code","a84d04a1":"code","06abed18":"code","4d7307e7":"code","3cd70c87":"code","87f3b6e1":"code","a588ab1f":"code","7b27dfc5":"code","687307f5":"code","cc95bdbe":"code","40724763":"code","631da7ce":"code","39a4782c":"code","005ade39":"code","42600521":"markdown"},"source":{"a8668a73":"import pandas as pd\nimport numpy as np\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","72fe8373":"\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport string\nimport nltk\n","b490f1aa":"train=pd.read_csv(\"\/kaggle\/input\/nlp-getting-started\/train.csv\")\ntest = pd.read_csv(\"\/kaggle\/input\/nlp-getting-started\/test.csv\")","65be36b3":"train.head()","545f826c":"test.head()","41d9e71c":"print(train.shape)\nprint(test.shape)","ed340da6":"comb=train.append(test,ignore_index=True,sort=True)","502ffe05":"comb.shape","28fbdd3f":"comb.head","ca6a4d50":"comb.drop('keyword',inplace=True,axis=1)","87fea604":"comb.drop('location',inplace=True,axis=1)","29d55d3b":"comb","d990a298":"comb.text=comb.text.apply(lambda x : x.lower())","760dd3c5":"#Removing puntuation,numbers,special characters\nimport re\ndef remove_pun(data):\n    pattern='[^A-Za-z0-9\\s]'\n    data=re.sub(pattern,'',data)\n    return data\n\ncomb.text=comb.text.apply(remove_pun)","298aeaac":"comb.text","d5d18b67":"nltk.download('punkt')\nfrom nltk.tokenize import word_tokenize,sent_tokenize\nfrom nltk import tokenize\ncomb['text']=comb.text.apply(word_tokenize)\ncomb['text'][0]","8475548a":"from nltk.stem import WordNetLemmatizer\nnltk.download('wordnet')\nlemmatizer=WordNetLemmatizer()\ncomb['text']=comb.text.apply(lambda x:[lemmatizer.lemmatize(word) for word in x])\ncomb.text","4ceaad77":"from sklearn.feature_extraction.text import TfidfVectorizer\ntfidf=TfidfVectorizer()\ncombine_tfidf = tfidf.fit_transform(comb)","aa22ed2b":"comb","35674dfc":"text_data= comb['text']","a4901528":"for i in range(len(text_data)):\n    text_data[i] = ' '.join(text_data[i])\ncomb['text']=text_data","c151a520":"comb","166c571e":"test = comb.iloc[7613:,:]","85b050b4":"train","ee9ac96f":"test","a037e32c":"test.drop('target',inplace=True,axis=1)","067005ca":"test","72fc0b94":"from sklearn.model_selection import train_test_split\nX=train['text']\nY=train['target']","05c8bde2":"X_train, X_val, y_train, y_val = train_test_split(X, Y, test_size=0.33, random_state=42)","e7d67f86":"X_train.shape","9e15ef6e":"from sklearn.feature_extraction.text import TfidfVectorizer\ntfidf=TfidfVectorizer()\nX_train_tfidf = tfidf.fit_transform(X_train)\nprint(X_train_tfidf)","2e96ed42":"from sklearn.svm import LinearSVC\nclf = LinearSVC()\nclf.fit(X_train_tfidf, y_train)\n","fa219893":"clf=LinearSVC()","cbaa23cf":"from sklearn.pipeline import Pipeline\ntext_clf = Pipeline([('tfidf', TfidfVectorizer()), ('clf', LinearSVC())])\n","25096a59":"text_clf.fit(X_train, y_train)\n","9eb421ed":"predictions = text_clf.predict(X_val)\n","66afa8f7":"from sklearn.metrics import confusion_matrix, classification_report\nprint(confusion_matrix(y_val, predictions))\n","f02b5bee":"print(classification_report(y_val, predictions))\n","f76312fe":"from sklearn import metrics\nmetrics.accuracy_score(y_val, predictions)","943fbfd9":"target = text_clf.predict(test['text'])\n","dfb86c15":"submission = pd.DataFrame()\nsubmission['id'] = test['id']\nsubmission['target'] = target","08234ee4":"submission\n","a84d04a1":"submission.set_index('id')\n","06abed18":"submission.to_csv('.\/submission.csv')\n","4d7307e7":"text_clf = Pipeline([('tfidf', TfidfVectorizer()), ('clf', LinearSVC())])\n","3cd70c87":"text_clf.fit(X_train, y_train)\n","87f3b6e1":"predictions = text_clf.predict(X_val)\n","a588ab1f":"from sklearn.metrics import classification_report\n","7b27dfc5":"print(classification_report(y_val, predictions))\n","687307f5":"from sklearn.metrics import accuracy_score\n","cc95bdbe":"text_clf.fit(X_train, y_train)\npredictions = text_clf.predict(X_val)\naccuracy = accuracy_score(y_val, predictions)","40724763":"print(accuracy)\n","631da7ce":"from sklearn.linear_model import LogisticRegression\ntext_clf = Pipeline([('tfidf', TfidfVectorizer()), ('clf', LogisticRegression())])\ntext_clf.fit(X_train, y_train)\npredictions = text_clf.predict(X_val)\naccuracy = accuracy_score(y_val, predictions)","39a4782c":"print(accuracy)\n","005ade39":"submission.to_csv('.\/submission.csv')\n","42600521":"train = comb.iloc[:7613,:]\n"}}