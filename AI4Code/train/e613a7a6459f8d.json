{"cell_type":{"aafffc95":"code","2724de2c":"code","fb2b5530":"code","19c17ee3":"code","8695564f":"code","69917cee":"code","de262918":"code","4c064908":"code","fdbbfc34":"code","340a61dd":"code","0efbca2f":"code","65a34676":"code","7df75c4e":"code","6b47dd4d":"code","32725948":"code","29e323a7":"code","4cf798c2":"code","d521cd0f":"code","74ccca4a":"code","08e13113":"code","1524f996":"code","13386e97":"markdown","462365c5":"markdown","9ab68d91":"markdown","77607e4b":"markdown"},"source":{"aafffc95":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings(\"ignore\")","2724de2c":"df = pd.read_csv('..\/input\/creditcardfraud\/creditcard.csv')\ndf.head()","fb2b5530":"df.describe()","19c17ee3":"df.isnull().sum()","8695564f":"sns.set(style='darkgrid')\nsns.countplot(x='Class', data=df, palette='Set3')\nprint('Non-fraud transactions: {}%'.format(round(df.Class.value_counts()[0]\/len(df)*100.0,2)))\nprint('Fraud transactions: {}%'.format(round(df.Class.value_counts()[1]\/len(df)*100.0,2)))","69917cee":"sns.set(style='whitegrid')\nf, (ax1, ax2) = plt.subplots(1, 2, figsize=(15, 6))\nax1 = sns.distplot(df['Time'], ax=ax1, color='y')\nax2 = sns.distplot(df['Amount'], ax=ax2, color='k')\nax1.set_title('Distribution of Time', fontsize=13)\nax2.set_title('Distribution of Amount', fontsize=13)","de262918":"from sklearn.preprocessing import RobustScaler\nrs = RobustScaler()\ndf['scaled_amount'] = rs.fit_transform(df['Amount'].values.reshape(-1,1))\ndf['scaled_time'] = rs.fit_transform(df['Time'].values.reshape(-1,1))\ndf.drop(['Time', 'Amount'], axis=1, inplace=True)","4c064908":"scaled_amount = df['scaled_amount']\nscaled_time = df['scaled_time']\ndf.drop(['scaled_amount', 'scaled_time'], axis=1, inplace=True)\ndf.insert(0, 'scaled_amount', scaled_amount)\ndf.insert(0, 'scaled_time', scaled_time)\ndf.head()","fdbbfc34":"from sklearn.model_selection import train_test_split\nx = np.array(df.iloc[:, df.columns != 'Class'])\ny = np.array(df.iloc[:, df.columns == 'Class'])","340a61dd":"X_train,X_test,y_train,y_test=train_test_split(x,y,test_size=0.2,stratify=y)","0efbca2f":"X_train.shape,X_test.shape","65a34676":"from sklearn.preprocessing import StandardScaler\n\nscaler=StandardScaler()\nX_train=scaler.fit_transform(X_train)\nX_test=scaler.transform(X_test)","7df75c4e":"X_train=X_train.reshape(X_train.shape[0],X_train.shape[1],1)\nX_test=X_test.reshape(X_test.shape[0],X_test.shape[1],1)","6b47dd4d":"from tensorflow.keras import Sequential\nfrom tensorflow.keras.layers import Conv1D, BatchNormalization, Dropout, Flatten, Dense","32725948":"model=Sequential([\n    Conv1D(32,2,activation='relu',input_shape=X_train[0].shape),\n    BatchNormalization(),\n    Dropout(0.2),\n    Conv1D(64,2,activation='relu'),\n    BatchNormalization(),\n    Dropout(0.5),\n    Flatten(),\n    Dense(64,activation='relu'),\n    Dropout(0.5),\n    Dense(1,activation='sigmoid')\n    \n])","29e323a7":"model.summary()","4cf798c2":"from tensorflow.keras.optimizers import Adam","d521cd0f":"model.compile(optimizer=Adam(learning_rate=0.0001),loss='binary_crossentropy',metrics=['accuracy'])","74ccca4a":"history = model.fit(X_train,y_train,epochs=5,batch_size=32,validation_data=(X_test,y_test))","08e13113":"pred = model.predict_classes(X_test)","1524f996":"from sklearn.metrics import confusion_matrix\n\ncnf_matrix = confusion_matrix(y_test, pred)\n\nsns.heatmap(pd.DataFrame(cnf_matrix), annot=True, cmap=\"YlGnBu\", fmt='g')","13386e97":"# Applying StandardScaler to normalize the data","462365c5":"* Use Feature Scaling to Normalize the Data\n","9ab68d91":"* The dataset is highly imbalanced(most of the transactions are non-fraud)\n","77607e4b":"# Plotting"}}