{"cell_type":{"54b06e64":"code","a821434f":"code","58a6a139":"code","823615f9":"code","edc95d33":"code","0023e84b":"code","59491194":"code","f23cc0a7":"code","a2b7a9fb":"code","7fe27095":"code","3be5773a":"code","339b2660":"code","f3acc515":"code","07bcd701":"code","a88635c0":"code","50d766ed":"code","01c0abf4":"code","30fa6125":"code","cf267e50":"code","13ba964b":"code","bc6c03aa":"code","f45b9666":"code","78c13c6a":"code","dba74837":"code","7e031c27":"code","5c86662e":"code","f5c245f0":"code","bd56fb2e":"code","3ba1e6a4":"code","4acd91c4":"code","433f381f":"code","b6cae544":"code","6fb7ee32":"code","abef32e2":"code","693e252f":"code","5f966f15":"code","615af756":"code","f934d273":"code","d679d1f9":"code","1bf41eaa":"code","f939ba50":"code","fc2f4821":"code","e9cabb61":"code","6e1a979c":"code","722782c5":"code","43ac7ec4":"code","62f4a352":"code","040c7fa2":"code","b599507b":"code","d47ef971":"code","a2cf4e94":"code","bae7794b":"code","91361eb8":"code","55407807":"code","b8bd7620":"code","b2d17127":"code","5ac150d5":"code","aeaabd12":"code","d3c29d52":"code","21e4c4b7":"code","ea5ff45e":"code","c494d7cb":"code","0f95b3da":"code","e13f55b2":"code","a3c66b47":"code","21efbdcc":"code","69906c39":"code","7db97688":"code","891bd405":"code","8a39ee01":"code","c5560b9c":"code","dfcea458":"code","f3ec5677":"code","a357e97e":"code","4684ee68":"code","f1de87d2":"code","704af5ae":"code","010b2cdc":"code","6f8735f9":"code","0c9b758a":"code","bd98addc":"code","9a1f259b":"code","342b462d":"code","cd3dbfc5":"code","ddc6558c":"code","f28a3924":"code","50b848b4":"code","263c0753":"code","f7255f96":"code","af3667cd":"code","c2afd85e":"code","f4120163":"code","6f81855c":"code","9fb01766":"code","781f1d1e":"code","03685a9d":"code","6f7b8cd2":"code","4037c6b3":"code","1885605f":"code","4980d32f":"code","c0d58a2c":"code","66fc3a93":"code","82f24ca5":"code","31f740f8":"code","f204ad0e":"code","ecbcb7b4":"code","b1040edb":"code","8c56947c":"code","bf02172c":"code","bdfe9f3c":"code","7351b6cb":"code","4b9f88ad":"code","05cfd12f":"code","5cb7be0b":"code","cd145a6a":"code","5c15c601":"code","eb6a403e":"code","107663d8":"code","85d2011b":"code","48fe70e9":"code","c4f90458":"code","121a8444":"code","1326d8a0":"code","3a842ad9":"code","6a3d1a81":"code","8be92fe4":"code","774643fc":"code","d13f4ac9":"code","872e0658":"code","c80abc24":"code","520b3229":"code","617bbd25":"code","c0da62e1":"code","d438ed48":"code","6a1b3439":"code","ff47f949":"code","546febca":"code","a1a2e099":"code","0a2ed38d":"code","95d077a7":"code","b5dc6111":"code","a8958a2b":"code","0b362852":"code","f0d401a7":"code","2091014e":"code","13cbbe67":"code","f8726dec":"code","cab5632a":"code","884d9874":"code","2bf1f13f":"code","0315fc8d":"code","a5ddd4e4":"code","cfb40ed1":"code","fd99caea":"code","e6246af1":"code","9c39bec4":"code","df41ecfd":"code","92c3e8f8":"code","234e762f":"code","5bf57e6f":"code","3a61baeb":"code","5c45da36":"code","2947c31d":"code","b9d61a7b":"code","fa3d21d7":"code","e1330223":"code","56beeb1b":"code","7181d953":"code","633a9641":"code","7665d294":"code","f05a654f":"code","0f40912c":"code","824053cb":"code","25c1b45e":"code","e6afa0a5":"code","0e9967ad":"code","9f374521":"code","aa0b6678":"code","5e164dc3":"code","fb74c355":"code","bf089ae7":"code","3f4831dd":"code","5deea98e":"code","abba25c8":"code","aa91866c":"code","77c76fe6":"code","925f72b5":"code","dcab8cb7":"code","687a9d27":"code","5ce448a8":"code","7a7a919a":"code","c18f9fdd":"code","ed69db67":"code","3529f1b0":"code","03cc23c0":"code","e0795794":"code","1281dc5c":"code","11ab6fdb":"code","ef75354e":"code","f83e594d":"code","36643a6d":"code","c1a1aa6a":"code","9cfbff16":"code","6eeb39b5":"code","f36972bd":"code","0a250a25":"code","1ecdb321":"code","777c8117":"code","8870227a":"code","57fc3a98":"code","0b3574a6":"code","25b0954a":"code","eabbdb47":"code","d0a489c1":"markdown","9779c986":"markdown","4114bc4d":"markdown","d9ccd98e":"markdown","d91d94c9":"markdown","bc5e6798":"markdown","e6fc5081":"markdown","b00113fe":"markdown","6b507d67":"markdown","a1f715a3":"markdown","ada14d4d":"markdown","66d353f6":"markdown","c8255244":"markdown","0780537f":"markdown","41f9b0e2":"markdown","509eedcc":"markdown","6260cec8":"markdown","ec3df5e2":"markdown","5f8082f3":"markdown","8e1c4724":"markdown","ac284e10":"markdown","9db3abe7":"markdown","53888652":"markdown"},"source":{"54b06e64":"# supress warnings \nfrom warnings import filterwarnings\nfilterwarnings('ignore')\n\n# 'Os' module provides functions for interacting with the operating system \nimport os\n\n# 'Pandas' is used for data manipulation and analysis\nimport pandas as pd \n\n# 'Numpy' is used for mathematical operations on large, multi-dimensional arrays and matrices\nimport numpy as np\n\n# 'Matplotlib' is a data visualization library for 2D and 3D plots, built on numpy\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\n# 'Seaborn' is based on matplotlib; used for plotting statistical graphics\nimport seaborn as sns\n\n# 'Scikit-learn' (sklearn) emphasizes various regression, classification and clustering algorithms\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_squared_error, mean_absolute_error, r2_score\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.linear_model import ElasticNet\n\n# 'Statsmodels' is used to build and analyze various statistical models\nimport statsmodels\nimport statsmodels.api as sm\nimport statsmodels.stats.api as sms\nfrom statsmodels.tools.eval_measures import rmse\nfrom statsmodels.compat import lzip\nfrom statsmodels.graphics.gofplots import ProbPlot\n\n# 'SciPy' is used to perform scientific computations\nfrom scipy.stats import f_oneway\nfrom scipy.stats import jarque_bera\nfrom scipy import stats","a821434f":"data = pd.read_csv('..\/input\/seoul-bike-rental-prediction\/train.csv',engine='python')","58a6a139":"data.head(4)","823615f9":"data.info()","edc95d33":"data.shape","0023e84b":"data[(data['Bikes_Rented']==0)].head()","59491194":"index=data.index[data['IsFunctioningDay']=='No']  # fiding the poisition if non-functioning days","f23cc0a7":"data=data.drop(index)","a2b7a9fb":"data=data.reset_index(drop=True)","7fe27095":"data['IsFunctioningDay'].value_counts()                # checking the count of functioning day","3be5773a":"data['IsHoliday'].value_counts()                   # checking the count of Holiday","339b2660":"data.head(1)","f3acc515":"data.corr() # checking the correlation","07bcd701":"num_data=data.select_dtypes(include=np.number)\ncat_data=data.select_dtypes(exclude=np.number)","a88635c0":"num_data.head(1)","50d766ed":"cat_data.head(1)","01c0abf4":"hr=data.groupby(['Season','Hour'])['Bikes_Rented'].mean()","30fa6125":"sr=data.groupby(['Season'])['Bikes_Rented'].mean()\nsr","cf267e50":"hr=pd.DataFrame([hr])\nhr.head()","13ba964b":"\nhr1=hr.T","bc6c03aa":"hr1.head()","f45b9666":"data['Bikes_Rented'].plot(kind='kde')","78c13c6a":"num_data.head(1)","dba74837":"num_data.plot(kind='kde',subplots=True,layout=(5,3),sharex=False,figsize=(30,30))\nplt.show()","7e031c27":"sns.countplot(cat_data['Season'])","5c86662e":"sns.countplot(cat_data['IsHoliday'])","f5c245f0":"plt.hist(data['Rented Bike Count'],bins=10)","bd56fb2e":"sns.distplot(data['Rented Bike Count'])","3ba1e6a4":"plt.boxplot(data['Rented Bike Count'],vert=False)","4acd91c4":"sns.violinplot(data['Rented Bike Count'])","433f381f":"plt.figure(figsize=(15, 8))           # plotting a heatmap to see correlation\ncorr=num_data.corr()\nsns.heatmap(corr,annot=True,fmt='0.2f',vmax=1,vmin=-1)","b6cae544":"plt.figure(figsize=(15, 8))        # checking the number of bikes plotted every hou\nsns.boxplot(data['Hour'],data['Rented Bike Count']).set_title('Rented Bike Count distribution across hour')","6fb7ee32":"plt.figure(figsize=(15, 8))         #Represntation of the rented bike count based on seasons\nsns.boxplot(data['Seasons'],data['Rented Bike Count'],order=['Autumn','Spring','Summer','Winter']).set_title('Rented Bike Count distribution across Seasons')","abef32e2":"plt.figure(figsize=(15, 8))\nsns.boxplot(data['Holiday'],data['Rented Bike Count']).set_title('Rented Bike Count distribution across Holidays')","693e252f":"plt.figure(figsize=(15, 8))\nsns.boxplot(x=data['Hour'],y=data['Rented Bike Count'],hue=data['Seasons'],hue_order=['Autumn','Spring','Summer','Winter'])","5f966f15":"plt.figure(figsize=(15, 8))\nsns.countplot(data['Wind speed (m\/s)']) \nplt.xticks(rotation=90)","615af756":"from scipy.stats import f_oneway\nf_oneway(data['Rented Bike Count'][data['Holiday'] == 'Holiday'], \n             data['Rented Bike Count'][data['Holiday'] == 'No Holiday'])","f934d273":"tab=pd.crosstab(data['Holiday'],data['Seasons'])\/data['Seasons'].value_counts()*100","d679d1f9":"\n(tab.T).plot(kind='bar',stacked=True,figsize=(10,5))\nplt.legend(framealpha=0.2,bbox_to_anchor=(1,0,0.2,0.5))","1bf41eaa":"cat_data.head(1)","f939ba50":"cat_data=cat_data.drop('Date',1)          # dropping date as it is insignificant ","fc2f4821":"data1=pd.concat([num_data,cat_data],1)","e9cabb61":"data1.head(1)","6e1a979c":"\nplt.figure(figsize=(15, 8))\nplt.title('Box Plot for Numerical Variable')\ndata1.boxplot()","722782c5":"plt.figure(figsize=(15, 8))\nplt.title('Box Plot for Numerical Variable by dropping Rented Bike Count and Visibilty')\ndata1.drop(['Rented Bike Count','Visibility (10m)'],1).boxplot()","43ac7ec4":"plt.figure(figsize=(15,8))\nplt.title('Box Plot for Rented Bike Count ')\nsns.boxplot(data1['Rented Bike Count'])","62f4a352":"plt.figure(figsize=(15,8))\nplt.title('Box Plot for visibilty ')\nsns.boxplot(data['Visibility (10m)'])","040c7fa2":"#Capping to remove outliers\nQ1 = data1.quantile(0.25)\nQ3 = data1.quantile(0.75)\n# calculate of interquartile range \nIQR = Q3 - Q1\ndata1=data1[~((data1<(Q1-1.5*IQR))|(data1>(Q3+1.5*IQR))).any(axis=1)]","b599507b":"data1.shape","d47ef971":"plt.figure(figsize=(15,8))\ndata1.boxplot(column=[  'Temperature(\ufffdC)', 'Humidity(%)',\n       'Wind speed (m\/s)',\n       'Solar Radiation (MJ\/m2)', 'Rainfall(mm)', 'Snowfall (cm)'])\nplt.xticks(rotation=90)","a2cf4e94":"plt.figure(figsize=(15,8))\nplt.title('Box Plot for Rented Bike Count after capping')\nsns.boxplot(data1['Rented Bike Count'])","bae7794b":"data1=data1.drop(['Rainfall(mm)', 'Snowfall (cm)'],1)","91361eb8":"plt.figure(figsize=(15,8))\ncorr=data1.corr()\ncorr\nsns.heatmap(corr,annot=True,fmt='0.2f',vmax=1,vmin=-1)\n","55407807":"data1.corr()","b8bd7620":"data1.head(1)","b2d17127":"data1.shape\n","5ac150d5":"num_data1=data1.select_dtypes(include=np.number)\ncat_data1=data1.select_dtypes(exclude=np.number)","aeaabd12":"cat_data1=pd.get_dummies(cat_data1,columns=['Holiday','Seasons'],drop_first=True)  #using one-hot encoding technique","d3c29d52":"cat_data1=pd.get_dummies(cat_data1,columns=['Functioning Day'])","21e4c4b7":"cat_data1.head()","ea5ff45e":"num_data1.head(1)","c494d7cb":"data2=pd.concat([num_data1,cat_data1],1)        #combining both categorical and numerical variables\ndata2.head()","0f95b3da":"datav1=data2.copy()\ndatav1.head()","e13f55b2":"out=pd.DataFrame(np.power(datav1['Rented Bike Count'],0.3))","a3c66b47":"datav1['pow_rbc']=out\ndatav1['pow_rbc'].skew()           # data is slightly left skewed","21efbdcc":"data2=pd.concat([num_data1,cat_data1],1)        #combining both categorical and numerical variables\ndata2.head()","69906c39":"datav1=data2.copy()\ndatav1.head()","7db97688":"out=pd.DataFrame(np.power(datav1['Rented Bike Count'],0.3))","891bd405":"datav1['pow_rbc']=out\ndatav1['pow_rbc'].skew()           # data is slightly left skewed","8a39ee01":"data_ols1=datav1.copy()","c5560b9c":"from sklearn.preprocessing import StandardScaler       \nsc=StandardScaler()\nnum_two_col_sc=sc.fit_transform(num_data1.drop('Rented Bike Count',1))\nnum_two_col_sc=pd.DataFrame(num_two_col_sc,columns=num_data1.iloc[:,1:].columns)\nnum_two_col_sc.head(2)","dfcea458":"num_sc=num_two_col_sc.reset_index(drop=True)","f3ec5677":"cat_data1=cat_data1.reset_index(drop=True)","a357e97e":"final_data=pd.concat([num_two_col_sc,cat_data1],axis=1)\nfinal_data.head(2)","4684ee68":"final_data.shape","f1de87d2":"##Base model-1 using ols packag","704af5ae":"#Load the independent and dependent features\ninp=final_data\nout=num_data1['Rented Bike Count']","010b2cdc":"#Load required libraries\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import r2_score,mean_squared_error","6f8735f9":"#Split the dataset into train and test \nxtrain,xtest,ytrain,ytest= train_test_split(inp,out,test_size=.3,random_state=48)","0c9b758a":"#check the dimensions\nprint('Dimensions of x_train:',xtrain.shape)\nprint('Dimensions of y_train:',ytrain.shape)\nprint('Dimensions of x_test:',xtest.shape)\nprint('Dimensions of y_test:',ytest.shape)","bd98addc":"##Base model-2 using sklearn package","9a1f259b":"Lr=LinearRegression()\nLr.fit(xtrain,ytrain) \nypred=Lr.predict(xtest)\nprint('predicted values:',ypred,'\\n')\nintercept=Lr.intercept_\nprint('Intercept:',intercept,'\\n')\nCoeff=Lr.coef_\nprint('Coefficents :',Coeff)","342b462d":"#find Performance\nfrom sklearn.metrics import r2_score,mean_squared_error\nfrom statsmodels.tools.eval_measures import rmse\n\n#rmse\nlr_rmse=rmse(ytest,ypred)\n#r2_score\nlr_r2=r2_score(ytest,ypred)\n#adj_r2_score\nlr_adj_r2=1-(((1-lr_r2)*(len(xtest)-1))\/(len(xtest)-len(xtest.columns)-1))\n\nprint('rmse:',lr_rmse,'\\n','r2_score:',lr_r2,'\\n','adj_r2:',lr_adj_r2)","cd3dbfc5":"linreg_full_base_model_using_sklearn = pd.Series({\n                     'Model_Name': \"LRM_using_sklearn \",\n                     'RMSE':lr_rmse,\n                     'R-Squared':lr_r2 ,\n                     'Adj. R-Squared': lr_adj_r2     \n                   })\n\nscore_card = score_card.append(linreg_full_base_model_using_sklearn , ignore_index=True)\n\n#call scorecard\nscore_card","ddc6558c":"#model-3 output transformation model","f28a3924":"# Build a model with the output transformation\n\n\n#As we know that dependent variable is not normal distributed so transform it\nimport scipy.stats as stats\nbox_out,lam=stats.boxcox(num_data1['Rented Bike Count'])\nbox_out=pd.DataFrame(box_out)\nprint('skewness of price:',box_out.skew()[0])    #equal to zero so normal distributed now\n\n","50b848b4":"#split the  input and output variables \nxtrain,xtest,ytrain,ytest= train_test_split(inp,box_out,test_size=.3,random_state=48)\n\n\n#build a model using Sklearn package\nLr=LinearRegression()\nLr.fit(xtrain,ytrain) \nypred=Lr.predict(xtest)\nprint('predicted values:',ypred,'\\n')\nintercept=Lr.intercept_\nprint('Intercept:',intercept,'\\n')\nCoeff=Lr.coef_\nprint('Coefficents :',Coeff)\n#check","263c0753":"#find performance\n#rmse\nlr_box_cox_rmse=rmse(ytest,ypred)\n#r2_score\nlr_box_cox_r2=r2_score(ytest,ypred)\n#adj_r2_score\nlr_box_cox_adj_r2=1-(((1-lr_box_cox_r2)*(len(xtest)-1))\/(len(xtest)-len(xtest.columns)-1))\n\nprint('rmse:',lr_box_cox_rmse,'\\n','r2_score:',lr_box_cox_r2,'\\n','adj_r2:',lr_box_cox_adj_r2)","f7255f96":"linreg_full_model_with_transformed_Rented_bike_Count = pd.Series({\n                     'Model_Name': \"LRM_full_with_transformed_Rented_bike_Count\",\n                     'RMSE':lr_box_cox_rmse,\n                     'R-Squared':lr_box_cox_r2 ,\n                     'Adj. R-Squared': lr_box_cox_adj_r2     \n                   })\n\nscore_card = score_card.append(linreg_full_model_with_transformed_Rented_bike_Count, ignore_index=True)\n\n#call scorecard\nscore_card","af3667cd":" #Assumptions","c2afd85e":"#a) Multicolinearity","f4120163":"#import library\nfrom statsmodels.stats.outliers_influence import variance_inflation_factor\n\nvif=pd.DataFrame()\nvif['VIF']=[variance_inflation_factor(xtrain.values,i) for i in range(xtrain.shape[1])]          #dataframe to np array\nvif['features']=xtrain.columns\nvif.sort_values('VIF',ascending=False)","6f81855c":"inpv1=xtrain.drop(['Dew point temperature(\ufffdC)','Holiday_No Holiday'],1)\nvif=pd.DataFrame()\nvif['VIF']=[variance_inflation_factor(inpv1.values,i) for i in range(inpv1.shape[1])]          \nvif['features']=inpv1.columns\nvif.sort_values('VIF',ascending=False)","9fb01766":"#model=4 significant features with transformed output# check","781f1d1e":"#inp=inpv1             have only signficant features   (these two are train set)\n#out=ytrain           transformed output","03685a9d":"#Build a model \nimport statsmodels.api as sm\n\ninpc1=sm.add_constant(inpv1)\nols=sm.OLS(ytrain,inpc1)\nlinear_model_using_ols=ols.fit() \nprint(linear_model_using_ols.summary())","6f7b8cd2":"#Autocollinearity","4037c6b3":"#Statistical test to check the linearity\nfrom statsmodels.stats.diagnostic import linear_rainbow \nprint('% of Linearity:',linear_rainbow(res=linear_model_using_ols,frac=0.5)[1]*100)","1885605f":"#Normality","4980d32f":"#plot the distribution of residual\nsns.distplot(linear_model_using_ols.resid,color='orange')\nplt.show()","c0d58a2c":"#Check skewness\nprint('Skewness of residual is :',linear_model_using_ols.resid.skew())","66fc3a93":"#Using qqplot\nfrom statsmodels.graphics.gofplots import qqplot\nqqplot(linear_model_using_ols.resid,line='r')   #r=regression line\n#check","82f24ca5":"#Find the Homascadasticity\nsns.residplot(linear_model_using_ols.predict(),linear_model_using_ols.resid)\nplt.show()","31f740f8":"#statsitic test for homascadsticity\nfrom statsmodels.stats.api import het_goldfeldquandt\n\n#H0: model is homascadsticity\nprint('Pvalue is :',het_goldfeldquandt(linear_model_using_ols.resid,linear_model_using_ols.model.exog)[1])","f204ad0e":"#Feature selection","ecbcb7b4":"inpv1.head(2)","b1040edb":"inpv_1=inpv1.copy()","8c56947c":"#import library\nfrom mlxtend.feature_selection import SequentialFeatureSelector as sfs","bf02172c":"#a) Backward elimination method","bdfe9f3c":"lr=LinearRegression()\nlr_back=sfs(estimator=lr,k_features='best',forward=False) #k_features='best' gives significant features among all the features\nsfs_back=lr_back.fit(inpv_1,ytrain)\nback_feat=sfs_back.k_feature_names_\nback_feat=list(back_feat)\nprint('These are the significant features for best model by considering backward_elimin :','\\n',back_feat)","7351b6cb":"#Check score\nprint('Score of backward elimination :',sfs_back.k_score_)","4b9f88ad":" #Forward selection method","05cfd12f":"lr=LinearRegression()\nlr_forw=sfs(estimator=lr,k_features='best',forward=True)   \nsfs_forw=lr_forw.fit(inpv_1,ytrain)\nforw_feat=sfs_forw.k_feature_names_\nforw_feat=list(forw_feat)\nprint('These are the significant features for best model by considering forward_selec :','\\n',forw_feat)","5cb7be0b":"#Check score\nprint('Score of forward selection :',sfs_forw.k_score_)","cd145a6a":"#RFE-Recursive feature elimination","5c15c601":"lr=LinearRegression()\nfrom sklearn.feature_selection import RFECV       #its gives possible features so thats why we dont need to write n_features_to_select\nrfe_mod=RFECV(estimator=lr)\nrfe_feat=rfe_mod.fit(inpv_1,ytrain)\n\nrank=pd.DataFrame()\nrank['Rank']=rfe_feat.ranking_\nrank['Feature']=inpv_1.columns\n\nr_feat=rank[rank['Rank']==1]","eb6a403e":"#print features\nrfe_featu=r_feat['Feature']\nprint('These are the significant features for best model by considering RFE :','\\n',rfe_featu)","107663d8":"#Check score\nprint('Score of RFECV method :',np.mean(rfe_feat.grid_scores_))","85d2011b":"#model-5 model with best features using backward elimination\n","48fe70e9":"import statsmodels.api as sm\n\ninpc2=sm.add_constant(inpv_1[back_feat])\nols=sm.OLS(ytrain,inpc2)\nlinear_model_using_ols_best_feat=ols.fit() \nprint(linear_model_using_ols_best_feat.summary())","c4f90458":"#model-6 model with best features using RFE method","121a8444":"#Build a model\ninpc3=sm.add_constant(inpv_1[rfe_featu])\nols=sm.OLS(ytrain,inpc3)\nlinear_model_using_ols_best_feat_RFE=ols.fit() \nprint(linear_model_using_ols_best_feat_RFE.summary())","1326d8a0":"sign_feat=list(inpv_1[rfe_featu].columns)  #bcoz we need to consider only best features obtained from RFE method\n\n\nfrom statsmodels.api import add_constant\nxtest_with_constant=add_constant(xtest[sign_feat],has_constant='add')\nypred_ols=linear_model_using_ols_best_feat_RFE.predict(xtest_with_constant)\nypred_ols.shape","3a842ad9":"#find Performance\nfrom sklearn.metrics import r2_score,mean_squared_error\nfrom statsmodels.tools.eval_measures import rmse\n\n#rmse\nols_rmse=np.sqrt(mean_squared_error(ytest,ypred_ols))\n#r2_score\nols_r2=r2_score(ytest,ypred_ols)\n#adj_r2_score\nols_adj_r2=1-(((1-ols_r2)*(len(xtest[sign_feat])-1))\/(len(xtest[sign_feat])-len(xtest[sign_feat].columns)-1))\n\nprint('rmse:',ols_rmse,'\\n','r2_score:',ols_r2,'\\n','adj_r2:',ols_adj_r2)","6a3d1a81":"linreg_model_with_signifi_feat_using_RFECV_method = pd.Series({\n                     'Model_Name': \"LRM_with_signif_feat_using_RFECV\",\n                     'RMSE':ols_rmse,\n                     'R-Squared':ols_r2 ,\n                     'Adj. R-Squared': ols_adj_r2     \n                   })\n\nscore_card = score_card.append(linreg_model_with_signifi_feat_using_RFECV_method , ignore_index=True)\n\n#call scorecard\nscore_card","8be92fe4":"\n\n#Interaction effect (Joint effect)","774643fc":"# Interaction effect with backward elimination","d13f4ac9":"inpv_1_back=inpv_1[back_feat]\ninpv_1_back.head(2)","872e0658":"#concatenate ytrain and inpv_1_back[back_feat]\ninpv_1_back=pd.concat([inpv_1_back,ytrain],axis=1)\ninpv_1_back.rename({0: 'Rented Bike Count'}, axis=1, inplace=True)\ninpv_1_back.head(2)\n#check","c80abc24":"#bring to one scale form\nfrom sklearn.preprocessing import StandardScaler\nsc=StandardScaler()\ninpv_1_back['Rented Bike Count']=sc.fit_transform(inpv_1_back['Rented Bike Count'].values.reshape(-1,1))\ninpv_1_back.head(2)","520b3229":"inpv_2_back=inpv_1_back.copy()","617bbd25":"inpv_2_back['Hour*Temp']=inpv_2_back['Temperature(\ufffdC)']*inpv_2_back['Hour']","c0da62e1":"inpv_2_back.head(2)","d438ed48":"inpv_2_back_d=inpv_2_back.drop(['Rented Bike Count'],1)","6a1b3439":"inpv_2_back_d.head()","ff47f949":"#Build a model \nimport statsmodels.api as sm\n\ninpc4=sm.add_constant(inpv_2_back_d)\nols=sm.OLS(ytrain,inpc4)\nlinear_model_using_ols_best_feat_backward_with_interaction=ols.fit() \nprint(linear_model_using_ols_best_feat_backward_with_interaction.summary())","546febca":"#same we need for test also#check\nxtest[back_feat].head(2)","a1a2e099":"xtest_backward=pd.concat([xtest[back_feat],ytest],axis=1)\nxtest_backward.rename({0: 'Rented Bike Count'}, axis=1, inplace=True)\nxtest_backward.head(2)\n","0a2ed38d":"#bring to one scale form\nfrom sklearn.preprocessing import StandardScaler\nsc=StandardScaler()\nxtest_backward['Rented Bike Count']=sc.fit_transform(xtest_backward['Rented Bike Count'].values.reshape(-1,1))\nxtest_backward.head(2)","95d077a7":"xtest_backward_1=xtest_backward.copy()","b5dc6111":"xtest_backward_1['Hour*Temp']=xtest_backward['Temperature(\ufffdC)']*xtest_backward['Hour']","a8958a2b":"xtest_backward_1.head(2)","0b362852":"xtest_backward_2=xtest_backward_1.drop('Rented Bike Count',1)","f0d401a7":"#find Performance\nfrom sklearn.metrics import r2_score,mean_squared_error\nfrom statsmodels.tools.eval_measures import rmse\n\n#rmse\nols_rmse=np.sqrt(mean_squared_error(ytest,ypred_ols))\n#r2_score\nols_r2=r2_score(ytest,ypred_ols)\n#adj_r2_score\nols_adj_r2=1-(((1-ols_r2)*(len(xtest_backward)-1))\/(len(xtest_backward)-len(xtest_backward.columns)-1))\n\nprint('rmse:',ols_rmse,'\\n','r2_score:',ols_r2,'\\n','adj_r2:',ols_adj_r2)","2091014e":"linreg_model_with_signifi_feat_backwrd_interaction = pd.Series({\n                     'Model_Name': \"LRM_with_signif_feat_Backwrd_Intrctn\",\n                     'RMSE':ols_rmse,\n                     'R-Squared':ols_r2 ,\n                     'Adj. R-Squared': ols_adj_r2     \n                   })\n\nscore_card = score_card.append(linreg_model_with_signifi_feat_backwrd_interaction , ignore_index=True)\n\n#call scorecard\nscore_card","13cbbe67":"#Interaction effect with RFECV method","f8726dec":"inpv_1_rfe=inpv_1[rfe_featu]\ninpv_1_rfe.head(2)","cab5632a":"#concatenate ytrain and inpv_1_rfe[back_feat]\ninpv_1_rfe=pd.concat([inpv_1_rfe,ytrain],axis=1)\ninpv_1_rfe.rename({0: 'Rented Bike Count'}, axis=1, inplace=True)\ninpv_1_rfe.head(2)","884d9874":"#bring to one scale form\nfrom sklearn.preprocessing import StandardScaler\nsc=StandardScaler()\ninpv_1_rfe['Rented Bike Count']=sc.fit_transform(inpv_1_rfe['Rented Bike Count'].values.reshape(-1,1))\ninpv_1_rfe.head(2)","2bf1f13f":"inpv_2_rfe=inpv_1_rfe.copy()","0315fc8d":"inpv_2_rfe['Hour*Temp']=inpv_2_rfe['Temperature(\ufffdC)']*inpv_2_rfe['Hour']","a5ddd4e4":"inpv_2_rfe=inpv_2_rfe.drop('Rented Bike Count',1)\ninpv_2_rfe.head(2)","cfb40ed1":"#model-8 interaction effect of price difference with rfe method","fd99caea":"#Build a model \nimport statsmodels.api as sm\n\ninpc5=sm.add_constant(inpv_2_rfe)\nols=sm.OLS(ytrain,inpc5)\nlinear_model_using_ols_best_feat_RFECV_with_interaction=ols.fit() \nprint(linear_model_using_ols_best_feat_RFECV_with_interaction.summary())","e6246af1":"#same we need for test also\nxtest[rfe_featu].head(2)","9c39bec4":"#concatenate\nxtest_rfe=pd.concat([xtest[rfe_featu],ytest],axis=1)\nxtest_rfe.rename({0: 'Rented Bike Count'}, axis=1, inplace=True)\nxtest_rfe.head(2)","df41ecfd":"#bring to one scale form\nfrom sklearn.preprocessing import StandardScaler\nsc=StandardScaler()\nxtest_rfe['Rented Bike Count']=sc.fit_transform(xtest_rfe['Rented Bike Count'].values.reshape(-1,1))\nxtest_rfe.head(2)","92c3e8f8":"xtest_rfe_1=xtest_rfe.copy()\nxtest_rfe_1['Hour*Temperature']=xtest_rfe['Hour']*xtest_rfe['Temperature(\ufffdC)']\nxtest_rfe_1=xtest_rfe_1.drop('Rented Bike Count',1)\nxtest_rfe_1.head(2)","234e762f":"from statsmodels.api import add_constant\nxtest_with_constant=add_constant(xtest_rfe_1)\nypred_ols=linear_model_using_ols_best_feat_RFECV_with_interaction.predict(xtest_with_constant)\nypred_ols.shape","5bf57e6f":"#find Performance\nfrom sklearn.metrics import r2_score,mean_squared_error\nfrom statsmodels.tools.eval_measures import rmse\n\n#rmse\nols_rmse=np.sqrt(mean_squared_error(ytest,ypred_ols))\n#r2_score\nols_r2=r2_score(ytest,ypred_ols)\n#adj_r2_score\nols_adj_r2=1-(((1-ols_r2)*(len(xtest_backward)-1))\/(len(xtest_backward)-len(xtest_backward.columns)-1))\n\nprint('rmse:',ols_rmse,'\\n','r2_score:',ols_r2,'\\n','adj_r2:',ols_adj_r2)","3a61baeb":"linreg_model_with_signifi_feat_RFECV_interaction = pd.Series({\n                     'Model_Name': \"LRM_with_signif_feat_RFECV_intrctn\",\n                     'RMSE':ols_rmse,\n                     'R-Squared':ols_r2 ,\n                     'Adj. R-Squared': ols_adj_r2     \n                   })\n\nscore_card = score_card.append(linreg_model_with_signifi_feat_RFECV_interaction , ignore_index=True)\n\n#call scorecard\nscore_card","5c45da36":"#Optimisation","2947c31d":"#Cross Validation","b9d61a7b":"inp=final_data\nout=box_out","fa3d21d7":"#import library\nfrom sklearn.model_selection import cross_val_score,KFold\n\nkf=KFold(n_splits=5,shuffle=True,random_state=48)\n\n\n#use r2 score\nfrom sklearn.linear_model import LinearRegression     #split the dataset into 5 groups\nlr=LinearRegression()\nres=cross_val_score(lr,inp,out,cv=kf,scoring='r2')\nprint('R2 values for 5sets of dataset :',res ) ","e1330223":"#bias error\nbe=1-np.mean(res)\n\n#variance error\nve=np.std(res)\n\nprint('Bias error interms of R2:',be)\nprint('Varaince error interms of R2:',ve)      #std(res)=0 model if free of overfitting ","56beeb1b":"# Dataset is having overfitting problem... to overcome this we can use regualarization ","7181d953":" #Regularization with Hyperparameter","633a9641":"#import hyperparameter library\nfrom sklearn.model_selection import GridSearchCV \n#import regularization library\nfrom sklearn.linear_model import Lasso,Ridge,ElasticNet","7665d294":"#Lasso Regularization","f05a654f":"loss=Lasso()     #hyper paramater of lasso is alpha\nparam={'alpha':[0.000001,0.00001,0.0001,0.001,0.01,0.1,1,2,5,8,10,50,60,70,90,100]}\n\ngrid=GridSearchCV(loss,param_grid=param,cv=5,scoring='r2') \n\nhyp_rid=grid.fit(inpv_2_rfe,ytrain)\n\nprint('Best hyperparameter is :',hyp_rid.best_params_ )\nprint('Score :',hyp_rid.best_score_ )","0f40912c":"#Ridge Regularization","824053cb":"rid=Ridge()     #hyper paramater of ridge is alpha\nparam={'alpha':[0.000001,0.00001,0.0001,0.001,0.01,0.1,1,2,5,8,10,50,60,70,90,100]}\n\ngrid=GridSearchCV(rid,param_grid=param,cv=5,scoring='r2')\n\nhyp_rid=grid.fit(inpv_2_rfe,ytrain)\n\nprint('Best hyperparameter is :',hyp_rid.best_params_ )\nprint('Score :',hyp_rid.best_score_ )\n","25c1b45e":"#ElasticNet Regularization","e6afa0a5":"enet=ElasticNet()     #hyper paramater of elastic  is alpha and l1_ratio\nparam={'alpha':[0.000001,0.00001,0.0001,0.001,0.01,0.1,1,2,5,8,10,50,60,70,90,100],'l1_ratio':[0.1,.2,0.3,0.4,.5,0.6,0.7,0.8,0.9]}\n\ngrid=GridSearchCV(enet,param_grid=param,cv=5,scoring='r2')\n\nhyp_rid=grid.fit(inpv_2_rfe,ytrain)\n\nprint('Best hyperparameter is :',hyp_rid.best_params_ )\nprint('Score :',hyp_rid.best_score_ )","0e9967ad":"#model-9  building a model using Ridge regularization","9f374521":"rid=Ridge(alpha=8)                 \nrid.fit(inpv_2_rfe,ytrain)\n\nypred_train=rid.predict(inpv_2_rfe)\nypred_test=rid.predict(xtest_rfe)\n\nrmse_train=np.sqrt(mean_squared_error(ytrain,ypred_train))\nrmse_test=np.sqrt(mean_squared_error(ytest,ypred_test))\n\nr2_train=r2_score(ytrain,ypred_train)\nr2_test=r2_score(ytest,ypred_test)\n\nadj_r2_train=1-(((1-r2_train)*(len(inpv_2_rfe)-1))\/(len(inpv_2_rfe)-len(inpv_2_rfe.columns)-1))\nadj_r2_test=1-(((1-r2_test)*(len(xtest_rfe)-1))\/(len(xtest_rfe)-len(xtest_rfe.columns)-1))\n\nprint('rmse_train:',rmse_train,'\\n','rmse_test:',rmse_test,'\\n','r2_score_train:',r2_train,'\\n','r2_score_test:',r2_test,'\\n','adj_r2_train:',adj_r2_train,'\\n','adj_r2_test:',adj_r2_test)","aa0b6678":"linreg_model_with_signifi_feat_RFECV_interaction_ridge = pd.Series({\n                     'Model_Name': \"LRM_with_signif_feat_RFECV_interctn_Ridge\",\n                     'RMSE':rmse_test,\n                     'R-Squared':r2_test ,\n                     'Adj. R-Squared': adj_r2_test     \n                   })\n\nscore_card = score_card.append(linreg_model_with_signifi_feat_RFECV_interaction_ridge , ignore_index=True)\n\n#call scorecard\nscore_card","5e164dc3":"#Stochastic Gradient Descent","fb74c355":"#import library\nfrom sklearn.linear_model import SGDRegressor","bf089ae7":"sgd=SGDRegressor()\nsgd.fit(inpv_2_rfe,ytrain)\n\n\nypred_train=sgd.predict(inpv_2_rfe)\nypred_test=sgd.predict(xtest_rfe)\n\nrmse_train=np.sqrt(mean_squared_error(ytrain,ypred_train))\nrmse_test=np.sqrt(mean_squared_error(ytest,ypred_test))\n\nr2_train=r2_score(ytrain,ypred_train)\nr2_test=r2_score(ytest,ypred_test)\n\nadj_r2_train=1-(((1-r2_train)*(len(inpv_2_rfe)-1))\/(len(inpv_2_rfe)-len(inpv_2_rfe.columns)-1))\nadj_r2_test=1-(((1-r2_test)*(len(xtest_rfe)-1))\/(len(xtest_rfe)-len(xtest_rfe.columns)-1))\n\nprint('rmse_train:',rmse_train,'\\n','rmse_test:',rmse_test,'\\n','r2_score_train:',r2_train,'\\n','r2_score_test:',r2_test,'\\n','adj_r2_train:',adj_r2_train,'\\n','adj_r2_test:',adj_r2_test)","3f4831dd":"linreg_model_with_signifi_feat_RFECV_interaction_sgd = pd.Series({\n                     'Model_Name': \"LRM_with_signif_feat_RFECV_intrctn_SGD\",\n                     'RMSE':rmse_test,\n                     'R-Squared':r2_test ,\n                     'Adj. R-Squared': adj_r2_test     \n                   })\n\nscore_card = score_card.append(linreg_model_with_signifi_feat_RFECV_interaction_sgd  , ignore_index=True)\n\n#call scorecard\nscore_card","5deea98e":"#SVM Algorithm","abba25c8":"from sklearn import svm\nmodel=svm.SVR()\nmodel.fit(inpv_2_rfe,ytrain)\n\n\nypred_train=model.predict(inpv_2_rfe)\nypred_test=model.predict(xtest_rfe)\n\nrmse_train=np.sqrt(mean_squared_error(ytrain,ypred_train))\nrmse_test=np.sqrt(mean_squared_error(ytest,ypred_test))\n\nr2_train=r2_score(ytrain,ypred_train)\nr2_test=r2_score(ytest,ypred_test)\n\nadj_r2_train=1-(((1-r2_train)*(len(inpv_2_rfe)-1))\/(len(inpv_2_rfe)-len(inpv_2_rfe.columns)-1))\nadj_r2_test=1-(((1-r2_test)*(len(xtest_rfe)-1))\/(len(xtest_rfe)-len(xtest_rfe.columns)-1))\n\nprint('rmse_train:',rmse_train,'\\n','rmse_test:',rmse_test,'\\n','r2_score_train:',r2_train,'\\n','r2_score_test:',r2_test,'\\n','adj_r2_train:',adj_r2_train,'\\n','adj_r2_test:',adj_r2_test)\n\n\n","aa91866c":"linreg_model_with_signifi_feat_RFECV_interaction_SVM = pd.Series({\n                     'Model_Name': \"LRM_with_signif_feat_RFECV_intrctn_SVM\",\n                     'RMSE':rmse_test,\n                     'R-Squared':r2_test ,\n                     'Adj. R-Squared': adj_r2_test     \n                   })\n\nscore_card = score_card.append(linreg_model_with_signifi_feat_RFECV_interaction_SVM  , ignore_index=True)\n\n#call scorecard\nscore_card","77c76fe6":"#Automatic Relevance Determination Regression (ARD) Algorithm","925f72b5":"from sklearn.linear_model import ARDRegression","dcab8cb7":"model=ARDRegression()\nmodel.fit(inpv_2_rfe,ytrain)","687a9d27":"ypred_train=model.predict(inpv_2_rfe)\nypred_test=model.predict(xtest_rfe)\n\nrmse_train=np.sqrt(mean_squared_error(ytrain,ypred_train))\nrmse_test=np.sqrt(mean_squared_error(ytest,ypred_test))\n\nr2_train=r2_score(ytrain,ypred_train)\nr2_test=r2_score(ytest,ypred_test)\n\nadj_r2_train=1-(((1-r2_train)*(len(inpv_2_rfe)-1))\/(len(inpv_2_rfe)-len(inpv_2_rfe.columns)-1))\nadj_r2_test=1-(((1-r2_test)*(len(xtest_rfe)-1))\/(len(xtest_rfe)-len(xtest_rfe.columns)-1))\n\nprint('rmse_train:',rmse_train,'\\n','rmse_test:',rmse_test,'\\n','r2_score_train:',r2_train,'\\n','r2_score_test:',r2_test,'\\n','adj_r2_train:',adj_r2_train,'\\n','adj_r2_test:',adj_r2_test)","5ce448a8":"linreg_model_with_signifi_feat_RFECV_interaction_ARD = pd.Series({\n                     'Model_Name': \"LRM_with_signif_feat_RFECV_intrctn_ARD\",\n                     'RMSE':rmse_test,\n                     'R-Squared':r2_test ,\n                     'Adj. R-Squared': adj_r2_test     \n                   })\n\nscore_card = score_card.append(linreg_model_with_signifi_feat_RFECV_interaction_ARD  , ignore_index=True)\n\n#call scorecard\nscore_card","7a7a919a":"#Bayesian Ridge Regression Algorithm","c18f9fdd":"from sklearn.linear_model import BayesianRidge","ed69db67":"model=BayesianRidge()\nmodel.fit(inpv_2_rfe,ytrain)\n\nypred_train=model.predict(inpv_2_rfe)\nypred_test=model.predict(xtest_rfe)\n\nrmse_train=np.sqrt(mean_squared_error(ytrain,ypred_train))\nrmse_test=np.sqrt(mean_squared_error(ytest,ypred_test))\n\nr2_train=r2_score(ytrain,ypred_train)\nr2_test=r2_score(ytest,ypred_test)\n\nadj_r2_train=1-(((1-r2_train)*(len(inpv_2_rfe)-1))\/(len(inpv_2_rfe)-len(inpv_2_rfe.columns)-1))\nadj_r2_test=1-(((1-r2_test)*(len(xtest_rfe)-1))\/(len(xtest_rfe)-len(xtest_rfe.columns)-1))\n\nprint('rmse_train:',rmse_train,'\\n','rmse_test:',rmse_test,'\\n','r2_score_train:',r2_train,'\\n','r2_score_test:',r2_test,'\\n','adj_r2_train:',adj_r2_train,'\\n','adj_r2_test:',adj_r2_test)","3529f1b0":"linreg_model_with_signifi_feat_RFECV_interaction_BR = pd.Series({\n                     'Model_Name': \"LRM_with_signif_feat_RFECV_intrctn_BR\",\n                     'RMSE':rmse_test,\n                     'R-Squared':r2_test ,\n                     'Adj. R-Squared': adj_r2_test     \n                   })\n\nscore_card = score_card.append(linreg_model_with_signifi_feat_RFECV_interaction_BR  , ignore_index=True)\n\n#call scorecard\nscore_card","03cc23c0":"#Passive Aggressive Algorithms","e0795794":"from sklearn.linear_model import PassiveAggressiveRegressor","1281dc5c":"model=PassiveAggressiveRegressor()\nmodel.fit(inpv_2_rfe,ytrain)\n\nypred_train=model.predict(inpv_2_rfe)\nypred_test=model.predict(xtest_rfe)\n\nrmse_train=np.sqrt(mean_squared_error(ytrain,ypred_train))\nrmse_test=np.sqrt(mean_squared_error(ytest,ypred_test))\n\nr2_train=r2_score(ytrain,ypred_train)\nr2_test=r2_score(ytest,ypred_test)\n\nadj_r2_train=1-(((1-r2_train)*(len(inpv_2_rfe)-1))\/(len(inpv_2_rfe)-len(inpv_2_rfe.columns)-1))\nadj_r2_test=1-(((1-r2_test)*(len(xtest_rfe)-1))\/(len(xtest_rfe)-len(xtest_rfe.columns)-1))\n\nprint('rmse_train:',rmse_train,'\\n','rmse_test:',rmse_test,'\\n','r2_score_train:',r2_train,'\\n','r2_score_test:',r2_test,'\\n','adj_r2_train:',adj_r2_train,'\\n','adj_r2_test:',adj_r2_test)","11ab6fdb":"linreg_model_with_signifi_feat_RFECV_interaction_PAR = pd.Series({\n                     'Model_Name': \"LRM_with_signif_feat_RFECV_intrctn_PAR\",\n                     'RMSE':rmse_test,\n                     'R-Squared':r2_test ,\n                     'Adj. R-Squared': adj_r2_test     \n                   })\n\nscore_card = score_card.append(linreg_model_with_signifi_feat_RFECV_interaction_PAR  , ignore_index=True)\n\n#call scorecard\nscore_card","ef75354e":"#Robust Multivariate Regression Algorithms(TheilSenRegressor","f83e594d":"from sklearn.linear_model import TheilSenRegressor","36643a6d":"model=TheilSenRegressor()\nmodel.fit(inpv_2_rfe,ytrain)\n\nypred_train=model.predict(inpv_2_rfe)\nypred_test=model.predict(xtest_rfe)\n\nrmse_train=np.sqrt(mean_squared_error(ytrain,ypred_train))\nrmse_test=np.sqrt(mean_squared_error(ytest,ypred_test))\n\nr2_train=r2_score(ytrain,ypred_train)\nr2_test=r2_score(ytest,ypred_test)\n\nadj_r2_train=1-(((1-r2_train)*(len(inpv_2_rfe)-1))\/(len(inpv_2_rfe)-len(inpv_2_rfe.columns)-1))\nadj_r2_test=1-(((1-r2_test)*(len(xtest_rfe)-1))\/(len(xtest_rfe)-len(xtest_rfe.columns)-1))\n\nprint('rmse_train:',rmse_train,'\\n','rmse_test:',rmse_test,'\\n','r2_score_train:',r2_train,'\\n','r2_score_test:',r2_test,'\\n','adj_r2_train:',adj_r2_train,'\\n','adj_r2_test:',adj_r2_test)","c1a1aa6a":"linreg_model_with_signifi_feat_RFECV_interaction_TSR = pd.Series({\n                     'Model_Name': \"LRM_with_signif_feat_RFECV_intrctn_TSR\",\n                     'RMSE':rmse_test,\n                     'R-Squared':r2_test ,\n                     'Adj. R-Squared': adj_r2_test     \n                   })\n\nscore_card = score_card.append(linreg_model_with_signifi_feat_RFECV_interaction_TSR  , ignore_index=True)\n\n#call scorecard\nscore_card","9cfbff16":"#Random Fprest ","6eeb39b5":"from sklearn.ensemble import RandomForestRegressor","f36972bd":"inpv_2_rfe","0a250a25":"regressor=RandomForestRegressor(n_estimators=10,random_state=2)\nregressor.fit(inpv_2_rfe,ytrain)\nypred_train=regressor.predict(inpv_2_rfe)\nypred_test=regressor.predict(xtest_rfe)\n\nrmse_train=np.sqrt(mean_squared_error(ytrain,ypred_train))\nrmse_test=np.sqrt(mean_squared_error(ytest,ypred_test))\n\nr2_train=r2_score(ytrain,ypred_train)\nr2_test=r2_score(ytest,ypred_test)\n\nadj_r2_train=1-(((1-r2_train)*(len(inpv_2_rfe)-1))\/(len(inpv_2_rfe)-len(inpv_2_rfe.columns)-1))\nadj_r2_test=1-(((1-r2_test)*(len(xtest_rfe)-1))\/(len(xtest_rfe)-len(xtest_rfe.columns)-1))\n\nprint('rmse_train:',rmse_train,'\\n','rmse_test:',rmse_test,'\\n','r2_score_train:',r2_train,'\\n','r2_score_test:',r2_test,'\\n','adj_r2_train:',adj_r2_train,'\\n','adj_r2_test:',adj_r2_test)","1ecdb321":"linreg_model_with_RandomForestRegressor = pd.Series({\n                     'Model_Name': \"LRM_with_RandomForestRegressor\",\n                     'RMSE':rmse_test,\n                     'R-Squared':r2_test ,\n                     'Adj. R-Squared': adj_r2_test     \n                   })\n\nscore_card = score_card.append(linreg_model_with_RandomForestRegressor  , ignore_index=True)\n\n#call scorecard\nscore_card","777c8117":"#Selecting best model","8870227a":"score_card['RMSE']=score_card['RMSE'].astype('float')","57fc3a98":"score_card.plot(secondary_y=['R-Squared','Adj. R-Squared'])\n\n# display just the plot\nplt.axvline(x=15, color='black',label='BEST model')\nplt.title('Selecting best model',fontsize=20)\nplt.show()","0b3574a6":"xtrain.head(1)","25b0954a":"linreg_model_with_RandomForestRegressor_2 = pd.Series({\n                     'Model_Name': \"LRM_with_RandomForestRegressor_2\",\n                     'RMSE':rmse_test,\n                     'R-Squared':r2_test ,\n                     'Adj. R-Squared': adj_r2_test     \n                   })\n\nscore_card = score_card.append(linreg_model_with_RandomForestRegressor_2  , ignore_index=True)\n\n#call scorecard\nscore_card","eabbdb47":"score_card.plot(secondary_y=['R-Squared','Adj. R-Squared'])\n\n# display just the plot\nplt.axvline(x=16, color='black',label='BEST model')\nplt.title('Selecting best model',fontsize=20)\nplt.show()","d0a489c1":"We can see snowfall and rainfall is 0 so we will remove them","9779c986":"As per the above boxplot , we can see that more number of bikes have been hired on a working day instead of a holiday.","4114bc4d":"As per the above plot we can say that winter has maximum holidays(for christmas) and we can see that maximum days are working days.","d9ccd98e":"the bike count is comparitively lot more on 'No Holiday' than during a holiday","d91d94c9":"there are a lot of outliers in the data","bc5e6798":"As per the above plot, we can there are 2 peaks one is during the 8 am and the second and the maximum one is during 5pm to 7pm.","e6fc5081":"1)Linear Regression Model","b00113fe":"The f_statistic =41.75 and the p-value <0.05 which indicates that there is significant difference in the mean of the rented bike count across Holiday. We may consider buliding consider bulliding separat model for each Holiday and No holiday but we go ahead and bulid a single model for both Holiday and No-Holiday.","6b507d67":"Missing Value","a1f715a3":"so here we can see that the dew point temperature and the Tempereature have a very high positive correlation.","ada14d4d":"# Graph","66d353f6":"Power Transformation","c8255244":"# One Way Annova","0780537f":"\nAfter dropping now the other variables are clearly visible and we can see that Temperature , Dew point temperature and humidity are significant variables.","41f9b0e2":"Date is unique so we will drop it late","509eedcc":"On grouping the Hour,Seasons and Rented bike count we found the average bikes required every hour.","6260cec8":"No outliers seen in visibility","ec3df5e2":"so as per the above graph the maximum outliers are present in the Rented bike count and for windspeed,rainfall,snowfall are equal to 0","5f8082f3":"Rented bike count is 0 for the above rows when the day is not functioning day","8e1c4724":"based on the above plot we can say that the data is right skewed also maximum values lie between 0 and 1000.","ac284e10":"Power Transformation","9db3abe7":"# Outliers Treatment","53888652":"1)Linear Regression Model"}}