{"cell_type":{"6f6b9ad6":"code","450ed3f8":"code","2eb9eed3":"code","ba93be7f":"code","525fa87e":"code","a4b48bf5":"code","55fc5163":"code","6fa48114":"code","53636c83":"code","f0931b7f":"code","6ba5731d":"code","3f1d2bbb":"code","7994aa15":"markdown"},"source":{"6f6b9ad6":"%reload_ext autoreload\n%autoreload 2\n%matplotlib inline","450ed3f8":"from fastai.tabular import *","2eb9eed3":"path = Path('\/kaggle\/input\/diamonds')\npath.ls()","ba93be7f":"df = pd.read_csv(path\/'diamonds.csv')\ndf.head()","525fa87e":"# As we can see from the \"count\" row, there is no missing data in the dataset\ndf.describe()","a4b48bf5":"# Preprocessing \nprocs = [FillMissing, Categorify, Normalize]","55fc5163":"# Split our variables into target, categorical and continuous variables\ndep_var = 'price'\n\n# There were too many missing \"Cabin\" values, so we will ignore that\n# The \"Name\" column has already been replaced by the \"Title\" column\ncat_names = df.select_dtypes(exclude='number').columns.tolist()\n\ncont_names = df.drop(['price', 'Unnamed: 0'], axis=1).select_dtypes(include='number').columns.tolist()\n\nprint(dep_var)\nprint(cat_names)\nprint(cont_names)","6fa48114":"# Remember to add \"label_cls=FloatList\" to tell the model that we are doing regression\ndata = (TabularList.from_df(df=df, cat_names=cat_names, cont_names=cont_names, procs=procs)\n                   .split_by_rand_pct(seed=42)\n                   .label_from_df(cols=dep_var, label_cls=FloatList)\n                   .databunch())","53636c83":"data.show_batch(10)","f0931b7f":"learn = tabular_learner(data, layers=[200, 100], metrics=mse)","6ba5731d":"learn.fit_one_cycle(10)","3f1d2bbb":"learn.recorder.plot_losses()","7994aa15":"* Let's build a model that can predict the **price** of a diamond given its **characteristics**"}}