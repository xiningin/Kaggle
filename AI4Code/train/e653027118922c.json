{"cell_type":{"a287b7e8":"code","96a6043f":"code","a0b7d03e":"code","94ffdca2":"code","560ab016":"code","1cb5a2aa":"code","b74b317d":"code","91625faf":"code","71d39dd6":"code","6ad9351b":"code","72698da6":"code","c15a3592":"code","61faaeb1":"markdown","b037cdcb":"markdown"},"source":{"a287b7e8":"import numpy as np\nimport pandas as pd\nimport xarray as xr\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_squared_error, r2_score\n\nimport tensorflow as tf\nfrom tensorflow import keras\ntf.__version__, keras.__version__","96a6043f":"ls -lh ..\/input\/galaxy-zoo-cleaned\/","a0b7d03e":"model = keras.models.load_model('..\/input\/galaxy-zoo-cleaned\/trained_simple_cnn_galaxy.h5')\nmodel.summary()","94ffdca2":"df_id = pd.read_csv('..\/input\/galaxy-zoo-cleaned\/galaxy_id_test.csv', \n                    header=None, index_col=0, names=['GalaxyID'])\ndf_id.head()","560ab016":"%time ds_test = xr.load_dataset('..\/input\/galaxy-zoo-cleaned\/galaxy_test.nc')\nds_test","1cb5a2aa":"X_test = ds_test['image_test'].values\nX_test.shape","b74b317d":"%time y_test_pred = model.predict(X_test)","91625faf":"y_test_pred.shape","71d39dd6":"# copied from sample submission csv\nclass_header_str = 'Class1.1,Class1.2,Class1.3,Class2.1,Class2.2,Class3.1,Class3.2,Class4.1,Class4.2,Class5.1,Class5.2,Class5.3,Class5.4,Class6.1,Class6.2,Class7.1,Class7.2,Class7.3,Class8.1,Class8.2,Class8.3,Class8.4,Class8.5,Class8.6,Class8.7,Class9.1,Class9.2,Class9.3,Class10.1,Class10.2,Class10.3,Class11.1,Class11.2,Class11.3,Class11.4,Class11.5,Class11.6'\n\nclass_header = class_header_str.split(',')\nlen(class_header), class_header[:5]","6ad9351b":"df_value = pd.DataFrame(y_test_pred, columns=class_header)\n\nsubmission_df = pd.concat([df_id, df_value], axis=1)\nsubmission_df","72698da6":"%time submission_df.to_csv('test_submission_simple_cnn.csv', index=False)","c15a3592":"!head -n 2 test_submission_simple_cnn.csv","61faaeb1":"# Load model","b037cdcb":"# Load test data"}}