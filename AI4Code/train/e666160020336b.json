{"cell_type":{"0d14549c":"code","82d5a7f7":"code","357080e0":"code","c53e39be":"code","2bc05ac8":"code","dfd9f3c1":"code","4fdccab9":"code","3b7acdd4":"markdown","76c16bc5":"markdown"},"source":{"0d14549c":"from fastai.vision import *\nfrom fastai.metrics import error_rate","82d5a7f7":"PATH = \"..\/input\"\nSEED = 42\nsz = 224\nbs = 64\n\nsub_df = pd.read_csv(f\"{PATH}\/sample_submission.csv\")\ntest_df = pd.read_csv(f\"{PATH}\/sample_submission.csv\")","357080e0":"data = ImageDataBunch.from_folder(PATH, valid_pct=0.1, ds_tfms=get_transforms(), size=sz, bs=bs, seed=SEED)\ndata.add_test(ImageList.from_df(test_df, PATH, folder=\"test\/test\"))\n\nlearn = cnn_learner(data, models.resnet50, metrics=error_rate)","c53e39be":"learn.fit_one_cycle(1)","2bc05ac8":"test_probs, _ = learn.get_preds(ds_type=DatasetType.Test)\ntest_preds = [data.classes[pred] for pred in np.argmax(test_probs.numpy(), axis=-1)]","dfd9f3c1":"sub_df.predicted_class = test_preds\nsub_df.to_csv(\"submission.csv\", index=False)","4fdccab9":"sub_df.head()","3b7acdd4":"## Generate Predictions","76c16bc5":"## Train Model"}}