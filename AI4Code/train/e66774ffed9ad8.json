{"cell_type":{"71db4057":"code","b26613aa":"code","e350547c":"code","c0b14d33":"code","4bbd66d1":"code","bcf4bfc3":"code","52fd07f2":"code","6ebae6ce":"code","6f413d08":"markdown","00292274":"markdown"},"source":{"71db4057":"\n!pip install -Uqq fastbook\nimport fastbook\nfastbook.setup_book()\n \nfrom fastai.vision.all import *\nfrom fastbook import *\nfrom IPython.display import clear_output\n\nmatplotlib.rc('image', cmap='Greys')\nclear_output(wait=False)\n# https:\/\/github.com\/mmichelli\/CV_2_Fast_AI","b26613aa":"#Get Data\npath = Path('..\/input\/understanding_cloud_organization')\nimages = Path(path\/'train_images')\ntrain_CSV = path\/'train.csv'","e350547c":"#Prep DataFrame\ntrain  = pd.read_csv(train_CSV)\n#Transform the csv file to Image name and label\ntrain['Image_name'] = train['Image_Label'].apply(lambda x: x.split('_')[0])\ntrain['Label_name'] = train['Image_Label'].apply(lambda x: x.split('_')[1])\ntrain.drop('Image_Label',axis=1,inplace=True)\ntrain = train.pivot('Image_name','Label_name','EncodedPixels')\n","c0b14d33":"img = Image.open(images\/'0011165.jpg') ","4bbd66d1":"def rleToMask(rleString,height,width):\n  rows,cols = height,width\n  rleNumbers = [int(numstring) for numstring in rleString.split(' ')]\n  rlePairs = np.array(rleNumbers).reshape(-1,2)\n  img = np.zeros(rows*cols,dtype=np.uint8)\n  mask_one_dim = torch.zeros(height*width)\n  for start_pixel, num_pixels in rlePairs:\n    mask_one_dim[start_pixel-1: start_pixel-1 + num_pixels] = 1\n  img = mask_one_dim.reshape(rows,cols).T\n  return img\n  \n  \n","bcf4bfc3":"train.loc[train.index[55]]","52fd07f2":"h,w = img.shape\nimg = Image.open(images\/train.index[55]) \nt_image = tensor(img)\nmask = ","6ebae6ce":"t_image = TensorImage(t_image)\n\n_, ax = plt.subplots(1, 1, figsize=(15, 10))\nt_image.show(ctx=ax)\nTensorMask(rleToMask(train.loc[train.index[55]]['Fish'], w, h )).show(  ctx=ax)\nTensorMask(rleToMask(train.loc[train.index[55]]['Sugar'], w, h )).show(  ctx=ax)\n","6f413d08":"We can share code here:\n#### https:\/\/github.com\/mmichelli\/CV_2_Fast_AI","00292274":"### Load data"}}