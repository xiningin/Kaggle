{"cell_type":{"8db7a660":"code","77ec88ca":"code","e449f28f":"code","189070cb":"code","73b0cd8d":"code","0143200e":"code","c2fb093f":"code","0c8eefb1":"code","033de294":"code","a0ed1cfd":"code","43e8de12":"code","f742dd76":"code","f24e706d":"code","564e5fa8":"code","333a35da":"code","3bb12de2":"code","301572b1":"code","1fde8a01":"code","aede2ebf":"code","ce0c295b":"code","7ee87174":"code","deac061e":"code","53354f66":"code","97624a05":"code","04d1ea16":"code","3e4a7d01":"code","35914aad":"markdown","590f3f4d":"markdown","3ae184f0":"markdown","8c2b57e3":"markdown","7ec373a2":"markdown","ac9422cb":"markdown","c0586ac8":"markdown","ed343a4b":"markdown","080363a2":"markdown","6ae65361":"markdown","7322c7bd":"markdown","eb64209d":"markdown","ac8deddd":"markdown","305525be":"markdown","fb66fa57":"markdown","862a3b15":"markdown","ff42da00":"markdown","9600c05e":"markdown"},"source":{"8db7a660":"import pandas as pd\nimport numpy as np\nfrom sklearn import model_selection\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.preprocessing import LabelEncoder","77ec88ca":"df = pd.read_csv(\"..\/input\/titanic\/train.csv\")\ndf.head()","e449f28f":"# Let's check the distribution of Survived\ndf[\"Survived\"].value_counts()","189070cb":"# adding a kfold column\ndf = pd.read_csv(\"..\/input\/titanic\/train.csv\")\ndf[\"kfold\"] = -1\ndf = df.sample(frac=1).reset_index(drop=True)\ny = df[\"Survived\"].values\nkf = model_selection.StratifiedKFold(n_splits=5)\n\nfor fold, (t, v) in enumerate(kf.split(X=df, y=y)):\n    df.loc[v, \"kfold\"] = fold\n\n# save the csv\ndf.to_csv(f\"titanic_folds.csv\", index=False)","73b0cd8d":"df = pd.read_csv(\".\/titanic_folds.csv\")\ndf.head()","0143200e":"df.info()","c2fb093f":"y = df[\"Survived\"].values\nprint(y.shape)","0c8eefb1":"# 216 + 184 + 491 = 891\n# Hence no null values\n# This feature will be considered\nprint(np.unique(df[\"Pclass\"], return_counts=True))","033de294":"# This feature will be considered\nprint(np.unique(df[\"Sex\"], return_counts = True))","a0ed1cfd":"lbl = LabelEncoder()\ndf[\"Sex\"] = lbl.fit_transform(df[\"Sex\"])\ndf[(df[\"Survived\"] == 1)][\"Sex\"].hist(bins=10, edgecolor='white')","43e8de12":"df[(df[\"Survived\"] == 1)][\"Age\"].hist(bins=10, edgecolor='white')\nplt.show()","f742dd76":"df[df[\"Survived\"] == 0][\"Age\"].hist(bins=10, edgecolor='white')\nplt.show()","f24e706d":"# This feature will be considered\nprint(np.unique(df[\"SibSp\"], return_counts = True))","564e5fa8":"# This feature will be considered\nprint(np.unique(df[\"Parch\"], return_counts = True))","333a35da":"plt.style.use('seaborn')\nplt.hist(df[\"Fare\"], bins=40, edgecolor='white')\nplt.show()","3bb12de2":"cabin_dict = {}\n\nfor cbn in df[\"Cabin\"]:\n    \n    if cbn in cabin_dict:\n        cabin_dict[cbn] += 1\n        \n    else:\n        cabin_dict[cbn] = 1\n        \nprint(cabin_dict)","301572b1":"cabin_df = pd.DataFrame(columns=[\"Cabin_name\", \"Count\"])\ncabin_df[\"Cabin_name\"] = cabin_dict.keys()\ncabin_df[\"Count\"] = cabin_dict.values()\n\ncabin_df.head()","1fde8a01":"cabin_df.sort_values(by=\"Count\").reset_index(drop=True)","aede2ebf":"df[df[\"Cabin\"].isnull()][\"Survived\"].value_counts()","ce0c295b":"df[df[\"Cabin\"].isnull() == False][\"Survived\"].value_counts()","7ee87174":"df = pd.read_csv(\"..\/input\/titanic\/train.csv\").copy()\n# df.Cabin.fillna(\"NONE\")\ndf[\"Cabin\"] = df[\"Cabin\"].astype(str)\nfor i, cbn in enumerate(df[\"Cabin\"]):\n  \n    # if the passenger has a cabin assign A\n    if cbn != \"nan\":\n        df.loc[i, \"Cabin\"] = \"A\"\n        \n    else:\n        df.loc[i, \"Cabin\"] = \"NONE\"","deac061e":"df[\"Cabin\"]","53354f66":"temp = df.groupby(\n    [\n        \"Sex\",\n        \"Cabin\",\n        \"Survived\"\n    ]\n)[\"Survived\"].count().reset_index(name=\"Survived_count\")","97624a05":"temp.head(n=8)","04d1ea16":"df.Embarked.fillna(\"NONE\")\nprint(df[df[\"Embarked\"].isnull()])\n\ndf[\"Embarked\"] = df[\"Embarked\"].astype(str)\n# Embarked is not a very informative feature I see\n# Gonna ignore it in the model initially","3e4a7d01":"df.info()","35914aad":"## 1. Passenger ID\n- is unique for every passenger\n- therefore, of no use","590f3f4d":"# Analysing features\n","3ae184f0":"## 12. Embarked","8c2b57e3":"## 9. Ticket\n- is (almost) unique for every passenger\n- ignored","7ec373a2":"## More Females survived than Males","ac9422cb":"## 10. Fare","c0586ac8":"### out of 891 passengers, 687 cabin names are unknown\/missing","ed343a4b":"## 4. Name\n- may be not as important\n- will not consider for now","080363a2":"## 3. Pclass","6ae65361":"## Some Conclusions\n- Males without a Cabin didn't survive (mostly)\n- Females with a cabin have survived (mostly)","7322c7bd":"## 6. Age","eb64209d":"## 7. Sibsp","ac8deddd":"## 5. Sex","305525be":"## We'll use Stratified KFold as cross validation","fb66fa57":"## 11. Cabin","862a3b15":"## 8. Parch","ff42da00":"## 2. Survived\n- target variable","9600c05e":"### More Children survived"}}