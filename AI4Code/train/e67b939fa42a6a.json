{"cell_type":{"ee122ed1":"code","8de90e89":"code","368ff912":"code","b980a8d9":"code","4d4c6f2d":"code","0077618f":"code","05289196":"markdown","c2f6c86c":"markdown","c26479f5":"markdown","52a67643":"markdown"},"source":{"ee122ed1":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nimport gc\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\n\npal = sns.color_palette()\n\nimport plotly.offline as py\npy.init_notebook_mode(connected=True)\nimport plotly.graph_objs as go\nimport plotly.tools as tls\n\nprint('# File sizes')\nfor f in os.listdir('..\/input'):\n    if not os.path.isdir('..\/input\/' + f):\n        print(f.ljust(30) + str(round(os.path.getsize('..\/input\/' + f) \/ (1000000*1000), 7)) + 'GB')\n    else:\n        sizes = [os.path.getsize('..\/input\/'+f+'\/'+x)\/(1000000*1000) for x in os.listdir('..\/input\/' + f)]\n        print(f.ljust(30) + str(round(sum(sizes), 7)) + 'GB' + ' ({} files)'.format(len(sizes)))","8de90e89":"df_train = pd.read_csv('..\/input\/train.csv')\ndf_train.head()","368ff912":"dicts={\n0:  \"Nucleoplasm\", \n1:  \"Nuclear membrane\",   \n2:  \"Nucleoli\",   \n3:  \"Nucleoli fibrillar center\" ,  \n4:  \"Nuclear speckles\"   ,\n5:  \"Nuclear bodies\"   ,\n6:  \"Endoplasmic reticulum\",   \n7:  \"Golgi apparatus\"   ,\n8:  \"Peroxisomes\"   ,\n9:  \"Endosomes\"   ,\n10:  \"Lysosomes\"   ,\n11:  \"Intermediate filaments\",   \n12:  \"Actin filaments\"   ,\n13:  \"Focal adhesion sites\",   \n14:  \"Microtubules\"   ,\n15:  \"Microtubule ends\",   \n16:  \"Cytokinetic bridge\",   \n17:  \"Mitotic spindle\"   ,\n18:  \"Microtubule organizing center\" ,  \n19:  \"Centrosome\"   ,\n20:  \"Lipid droplets\",   \n21:  \"Plasma membrane\",   \n22:  \"Cell junctions\"  , \n23:  \"Mitochondria\"   ,\n24:  \"Aggresome\"   ,\n25:  \"Cytosol\",\n26:  \"Cytoplasmic bodies\",   \n27:  \"Rods & rings\" \n}","b980a8d9":"labels = df_train['Target'].apply(lambda x: x.split(' '))\nfrom collections import Counter, defaultdict\ncounts = defaultdict(int)\nfor l in labels:\n    for l2 in l:\n        counts[l2] += 1\nstrs=[]\nfor count in counts.keys(): strs.append(dicts[int(count)])\n\ndata=[go.Bar(x=list(strs), y=list(counts.values()))]\nlayout=dict(height=800, width=800, title='Distribution of training labels')\nfig=dict(data=data, layout=layout)\npy.iplot(data, filename='train-label-dist')","4d4c6f2d":"# Co-occurence Matrix\ncom = np.zeros([len(counts)]*2)\nfor i, l in enumerate(list(counts.keys())):\n    for i2, l2 in enumerate(list(counts.keys())):\n        c = 0\n        cy = 0\n        for row in labels.values:\n            if l in row:\n                c += 1\n                if l2 in row: cy += 1\n        com[i, i2] = cy \/ c\n\ndata=[go.Heatmap(z=com, x=list(strs), y=list(strs))]\nlayout=go.Layout(height=800, width=800, title='Co-occurence matrix of training labels')\nfig=dict(data=data, layout=layout)\npy.iplot(data, filename='train-com')","0077618f":"import cv2\nfrom PIL import Image\n\n\nnew_style = {'grid': False}\nplt.rc('axes', **new_style)\n_, ax = plt.subplots(2, 2, sharex='col', sharey='row', figsize=(20, 20))\ni = 0\nfor f, l in df_train[:4].values:\n    img = cv2.imread('..\/input\/train\/{}_green.png'.format(f)) + cv2.imread('..\/input\/train\/{}_red.png'.format(f)) + cv2.imread('..\/input\/train\/{}_blue.png'.format(f))\n    im = Image.fromarray(img)\n    \n    ax[i \/\/ 2, i % 2].imshow(im)\n    arr = l.split(\" \")\n    str = \"\"\n    for ind in arr:\n        str=str+dicts[int(ind)]+\", \"\n    ax[i \/\/ 2, i % 2].set_title('{} - {}'.format(f, str))\n    #ax[i \/\/ 4, i % 4].show()\n    i += 1\n    \nplt.show()","05289196":"## A Useful Dictionary....","c2f6c86c":"# Training Data","c26479f5":"Credit: [@anokas](https:\/\/www.kaggle.com\/anokas)","52a67643":"# Images"}}