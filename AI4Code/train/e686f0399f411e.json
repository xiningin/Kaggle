{"cell_type":{"e227bd12":"code","da3a4b16":"code","d943d5c9":"code","0c40a6ea":"code","f2aaa832":"code","f181a26e":"code","a5641ac9":"code","8befee8b":"code","c66073bb":"code","16ae8923":"code","d1239541":"code","1901e1f7":"code","42852678":"code","b08f1d1c":"code","8e71d3d1":"code","e4612d96":"code","7215cdb5":"markdown","b9918800":"markdown"},"source":{"e227bd12":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom sklearn import preprocessing\nfrom sklearn.model_selection import train_test_split\n%matplotlib inline","da3a4b16":"penguin_df=pd.read_csv('\/kaggle\/input\/palmer-archipelago-antarctica-penguin-data\/penguins_size.csv')\npenguin_df","d943d5c9":"penguin_df.isnull().sum()","0c40a6ea":"penguin_df=penguin_df.dropna().reset_index(drop=True)","f2aaa832":"penguin_df.dtypes","f181a26e":"penguin_df['sex'].value_counts()","a5641ac9":"penguin_df['sex'].replace(to_replace=['MALE','FEMALE','.'],value=[0,1,2],inplace=True)\npenguin_df['island'].replace(to_replace=['Biscoe','Dream','Torgersen'],value=[0,1,2],inplace=True)\npenguin_df","8befee8b":"import seaborn as sns\nsns.pairplot(penguin_df,hue='species',diag_kws={\"hue\": None, \"color\": \".2\"})","c66073bb":"penguin_df.columns","16ae8923":"X=penguin_df[['island', 'culmen_length_mm', 'culmen_depth_mm',\n       'flipper_length_mm', 'body_mass_g', 'sex']].values\nX[0:5]","d1239541":"y=penguin_df['species'].values\ny[0:5]","1901e1f7":"X=preprocessing.StandardScaler().fit(X).transform(X.astype(float))","42852678":"X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.2,random_state=4)\nprint(f'Train Set: {X_train.shape,y_train.shape}')\nprint(f' Test Set: {X_test.shape,y_test.shape}')","b08f1d1c":"from sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.metrics import accuracy_score\n\nKs=10\n\nmean_acc=np.zeros((Ks-1))\n\nfor n in range(1,Ks):\n    knn=KNeighborsClassifier(n_neighbors=n).fit(X_train,y_train)\n    y_hat=knn.predict(X_test)\n    mean_acc[n-1]=accuracy_score(y_hat,y_test)\n\nplt.plot(range(1,Ks),mean_acc)\nplt.xlabel('K')\nplt.ylabel('Accuracy Score')\nplt.show()\n\nprint(f'The best accuracy {mean_acc.max()} is achieved at K = {mean_acc.argmax()+1}')","8e71d3d1":"best_k=mean_acc.argmax()+1\nknn=KNeighborsClassifier(n_neighbors=best_k).fit(X_train,y_train)\ny_hat=knn.predict(X_test)","e4612d96":"from sklearn.metrics import confusion_matrix\n\nconf_mat=confusion_matrix(y_hat,y_test)\nsns.heatmap(conf_mat.T,annot=True,fmt='d',cbar=False,square=True)\nplt.title('Confusion Matrix')\nplt.xlabel('True Classes')\nplt.ylabel('Predicted Classes')\nplt.show()","7215cdb5":"![penguin_img](https:\/\/allisonhorst.github.io\/palmerpenguins\/reference\/figures\/lter_penguins.png)","b9918800":"# Penguins Classification\nusing KNN model."}}