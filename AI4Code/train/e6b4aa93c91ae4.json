{"cell_type":{"2a410894":"code","def57c1f":"code","1bf4ac08":"code","9ee59fe9":"code","d20af7f3":"code","5ee98471":"code","4d138b6d":"code","3fcf6b0e":"code","f5b18579":"code","1fbb495f":"code","f81f8e64":"code","129161fb":"code","47bc3b57":"code","6719e721":"code","669c49a0":"code","3d4ee523":"code","24c8b959":"code","a66c183b":"code","bda50696":"code","d09cb652":"code","55bae8be":"code","604518f4":"code","0a202363":"code","61563e29":"code","7899fb32":"code","10ed79f7":"code","69c7ae25":"code","2fb85740":"code","19730200":"code","6adf8be8":"code","0ff1f0a6":"code","cead5b0f":"code","b2108957":"code","76aea50c":"code","f214a8c2":"code","814aa50b":"code","9a0ce848":"markdown","da8334e3":"markdown","6a78534a":"markdown","ecbb20a7":"markdown","f4b1f0a9":"markdown","aa1004f4":"markdown","49d7e9e4":"markdown","ef883711":"markdown","155e007b":"markdown","9f378aff":"markdown","1d78ef7e":"markdown","5b5ff363":"markdown","e4007597":"markdown"},"source":{"2a410894":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","def57c1f":"df = pd.read_csv(\"\/kaggle\/input\/used-car-dataset-ford-and-mercedes\/audi.csv\")\ndf.head(n=5)","1bf4ac08":"df.describe()","9ee59fe9":"df.info()","d20af7f3":"df.isnull().sum()","5ee98471":"df.shape","4d138b6d":"df.duplicated().sum()","3fcf6b0e":"df.drop_duplicates(keep=False, inplace=True)\ndf.shape","f5b18579":"data = df[['model','mileage','price','year']].sort_values(by ='price',ascending=False )\ndata.head(n=10)","1fbb495f":"data = df[['model','tax','price','year']].sort_values(by ='tax',ascending=False )\ndata.head(n=10)","f81f8e64":"data = df[['model','tax','price','year','mileage']].sort_values(by ='mileage',ascending=False )\ndata.head(n=10)","129161fb":"from sklearn.preprocessing import LabelEncoder\nle = LabelEncoder()\ncol=['model','transmission','fuelType']\ndf[col]=df[col].apply(le.fit_transform)\ndf.head(n=5)","47bc3b57":"plt.style.use('ggplot')\nsns.countplot(x='transmission',data=df)\nplt.show()","6719e721":"sns.countplot(x='fuelType',data=df)\nplt.show()","669c49a0":"plt.figure(figsize=(10,8))\ndf['model'].value_counts().plot(kind = 'barh')\nplt.show()","3d4ee523":"sns.distplot(df['price'],hist=False)\nplt.show()","24c8b959":"plt.figure(figsize=(10,8))\nsns.boxplot(data=df,orient='h')\nplt.show()","a66c183b":"from scipy import stats\nzscore = np.abs(stats.zscore(df))\nprint(zscore)","bda50696":"threshold = 3\nprint(np.where(zscore > 3))","d09cb652":"df_clean=df\ndf_clean = df_clean[(zscore<2).all(axis=1)]","55bae8be":"df.shape,df_clean.shape","604518f4":"plt.figure(figsize=(10,8))\nsns.boxplot(data=df_clean,orient='h')\nplt.show()","0a202363":"plt.figure(figsize=(10,8))\nsns.heatmap(df_clean.corr(),annot=True,cmap='coolwarm')\nplt.show()","61563e29":"x = df_clean.drop(['mpg','engineSize','price'],axis=1)\ny = df_clean['price']","7899fb32":"from sklearn.model_selection import train_test_split\nx_train,x_test,y_train,y_test = train_test_split(x,y,test_size=0.2,random_state=42)","10ed79f7":"from sklearn.tree import DecisionTreeRegressor\nd_reg = DecisionTreeRegressor()\nd_reg.fit(x_train,y_train)","69c7ae25":"print(d_reg.score(x_train,y_train),':Train Prediction')\ny_pred = d_reg.predict(x_test)\nprint(d_reg.score(x_test,y_pred),':test prediction')","2fb85740":"from sklearn.model_selection import cross_val_score\ntrain_scores = cross_val_score(d_reg, x_train, y_train, cv=10).mean()\ntrain_scores","19730200":"test_scores = cross_val_score(d_reg, x_test, y_test, cv=10).mean()\ntest_scores","6adf8be8":"cal = pd.DataFrame(np.c_[y_test,y_pred],columns = ['orginal','predicted'])\ncal","0ff1f0a6":"print(d_reg.get_depth())\nprint(d_reg.get_n_leaves())","cead5b0f":"from sklearn.ensemble import RandomForestRegressor\nr_reg = RandomForestRegressor()\nr_reg.fit(x_train,y_train)","b2108957":"from sklearn.model_selection import cross_val_score\ntrain_scores = cross_val_score(r_reg, x_train, y_train, cv=10).mean()\nprint('Train Scores',train_scores)\ntest_scores = cross_val_score(r_reg, x_test, y_test, cv=10).mean()\nprint('Test scores',test_scores)","76aea50c":"from sklearn.model_selection import GridSearchCV\nparams = {'max_depth': [2,4,6,8,10,12,14,16,18,20,22],\n          'min_samples_split': [2,3,4,5],\n          'min_samples_leaf': [1,2]}\np_reg = DecisionTreeRegressor()\ngcv = GridSearchCV(estimator=p_reg,param_grid=params)\ngcv.fit(x_train,y_train)","f214a8c2":"model = gcv.best_estimator_\nmodel.fit(x_train,y_train)","814aa50b":"from sklearn.model_selection import cross_val_score\ntrain_scores = cross_val_score(model, x_train, y_train, cv=10).mean()\nprint('Train Scores',train_scores)\ntest_scores = cross_val_score(model, x_test, y_test, cv=10).mean()\nprint('Test scores',test_scores)","9a0ce848":"**Decision Tree Pre Pruning**","da8334e3":"Highest mileage of an audi car is model(A6) with 200 tax and price 2490","6a78534a":"Highest tax of an audi car is model(R8) with 33950 price and tax 580","ecbb20a7":"# Data Cleaning\n**Removing null values and duplicates**","f4b1f0a9":"# Data visualisation","aa1004f4":"Many outliers. so using z_score to remove Outliers\n\nOutliers are extreme values that deviate from other observations on data , they may indicate a variability in\na measurement, experimental errors or a novelty. In other words, an outlier is an observation that diverges\nfrom an overall pattern on a sample.\n\nZ score is an important concept in statistics. Z score is also called standard score. This score helps to\nunderstand if a data value is greater or smaller than mean and how far away it is from the mean. More\nspecifically, Z score tells how many standard deviations away a data point is from the mean.","49d7e9e4":"**Statistical Insights**","ef883711":"**RandomForestRegression**","155e007b":"![image.png](attachment:d9d82c54-7067-4110-8077-4e8566556d43.png)","9f378aff":"# <center> <div class=\"alert alert-block alert-info\"> <span style=\"color:crimson;\"> Exploratory Data Analysis  <\/center>","1d78ef7e":"# <center> <div class=\"alert alert-block alert-info\"> <span style=\"color:crimson;\">Audi Car Price Prediction <\/center>","5b5ff363":"Highest Price of an audi car is model(R8) with 2000 mileage and price 145000","e4007597":"* 1997 to 2020 car price data\n* minimum car price 1490 and maximum 145000"}}