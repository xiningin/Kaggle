{"cell_type":{"7d4eedcc":"code","0e7bb43f":"code","f8cfba5e":"code","9b21b1d1":"code","ea578863":"code","d83b2827":"code","bd0ca1b6":"code","5262edb6":"code","bf5066d5":"markdown","5325989c":"markdown","252c1be9":"markdown","117a01b9":"markdown","c4d411cc":"markdown","1f91fc7b":"markdown","6bf3882e":"markdown","363356e3":"markdown","2244d330":"markdown"},"source":{"7d4eedcc":"!pip install gym \n!pip install 'gym[box2d]'\n!pip install atari_py","0e7bb43f":"import gym\nfrom gym import wrappers\nfrom gym import envs\nimport numpy as np \n#import datetime\nimport matplotlib.pyplot as plt\n%matplotlib inline\n#import time\nimport os","f8cfba5e":"env = gym.make(\"BreakoutNoFrameskip-v4\")\nplt.imshow(env.render('rgb_array'))\nplt.grid(False)\nprint(\"Observation space:\", env.observation_space)\nprint(\"Action space:\", env.action_space)\n","9b21b1d1":"env = gym.make(\"MsPacmanNoFrameskip-v4\")\nplt.imshow(env.render('rgb_array'))\nplt.grid(False)\nprint(\"Observation space:\", env.observation_space)\nprint(\"Action space:\", env.action_space)","ea578863":"env = gym.make(\"SpaceInvadersNoFrameskip-v4\")\nplt.imshow(env.render('rgb_array'))\nplt.grid(False)\nprint(\"Observation space:\", env.observation_space)\nprint(\"Action space:\", env.action_space)","d83b2827":"# Set-up the virtual display environment\n!apt-get update\n!apt-get install python-opengl -y\n!apt install xvfb -y\n!pip install pyvirtualdisplay\n!pip install piglet\n!apt-get install ffmpeg -y","bd0ca1b6":"# Start the virtual monitor\nfrom pyvirtualdisplay import Display\ndisplay = Display(visible=0, size=(1400, 900))\ndisplay.start()","5262edb6":"# play a random game and create video\nenv = gym.make(\"MsPacmanNoFrameskip-v4\")\nmonitor_dir = os.getcwd()\n\n#Setup a wrapper to be able to record a video of the game\nrecord_video = True\nshould_record = lambda i: record_video\nenv = wrappers.Monitor(env, monitor_dir, video_callable=should_record, force=True)\n\n#Play a random game\nstate = env.reset()\ndone = False\nwhile not done:\n  action = env.action_space.sample() #random action, replace by the prediction of the model\n  state, reward, done, _ = env.step(action)\n\nrecord_video = False\nenv.close() \n\n# download videos\n#from google.colab import files\n#import glob\nos.chdir(monitor_dir) # change directory to get the files\n!pwd #show file path\n!ls # show directory content\n\n","bf5066d5":"## Reinforcement learning training\nAfter the first publication of DQN many deeplearning Reinforcement Learning algorithms have been invented\/tried, Some main ones in chronological order: DQN, Double DQN, Duelling DQN, Deep Deterministic Policy Gradient, Continuous DQN (CDQN or NAF) , A2C\/A3C, Proximal Policy Optimization Algorithms, ARS, etc, etc. \n\nFor the actual (long, millions of game screens) training I would like to recommend [colaboratory](https:\/\/colab.research.google.com\/notebooks\/welcome.ipynb) solutions, since Kaggle is owned by Alphabet I presume they don't mind I refer to Google colab solutions. Will keep posting some links over here:\n\nBipedal walker  with Augmented Random Search: \n* Colab: https:\/\/colab.research.google.com\/drive\/1NxvslFQ6RDLBirlOYH4b77zabSW_x5DM   \n* Video: \thttps:\/\/www.youtube.com\/watch?v=NJBgeOF5CnM  \n\nMs Pacman with Proximal Policy Optimization:   \n* Colab: https:\/\/colab.research.google.com\/drive\/1aSoqbO_wysvciYfDv4hJbL6ZS7lXFnMN   \n* video after training 20 Million game screens:  https:\/\/youtu.be\/um2XX5bktMA  )  \n\n\nHoped you liked my notebook (upvote top right), my way to conribute back to this fantastic Kaggle platform and community.","5325989c":"## Show game screens\nLet's show some game screens of these iconic games","252c1be9":"## Play video\n\nThe MP4 file is already generated and is part of the output files. Go to your navigation bar at the top\/left of the screen to the tab Output and click on the .mp4 file. \n","117a01b9":"## Pacman\n\n![alt text](http:\/\/www.atarimania.com\/2600\/boxes\/hi_res\/ms_pac_man_silver_1987_cart_7.jpg)\n\n\nSource: [Atari mania](http:\/\/www.atarimania.com\/game-atari-2600-vcs-ms-pac-man_7391.html)\n","c4d411cc":"# Setup Gym with Atari games on Kaggle\nWelcome to my notebook on Kaggle. I did record my notes so it might help others in their journey to understand Neural Networks by examples (in this case Reinforcement Learning with Gym for Atari games from OpenAI). \n\nThis notebook is to show how to set-up gym including the gym[atari] environments in Kaggle so you can get to work and try to beat all those Atari 2600 games like Pong, Pacman, Spaceinvaders, etc\n\nIf you are interested in Reinforcement Learning you might be interested in some of my other notebooks:  \nhttps:\/\/www.kaggle.com\/charel\/learn-by-example-reinforcement-learning-with-gym  \nIf you are new to Neural Networks you might want to have a look at my notebooks below:    \nhttps:\/\/www.kaggle.com\/charel\/learn-neural-networks-by-example-mnist-digits  \nhttps:\/\/www.kaggle.com\/charel\/learn-by-example-rnn-lstm-gru-time-series  ","1f91fc7b":"## Capture a video\nBelow the code to set-up a virtual monitor and capture a movie","6bf3882e":"## Spaceinvaders\n\n![alt text](http:\/\/www.atarimania.com\/2600\/boxes\/hi_res\/space_invaders_silver_1986_cart_2.jpg)\n\n\nSource: [Atari mania](http:\/\/www.atarimania.com\/game-atari-2600-vcs-space-invaders_8102.html\/)\n","363356e3":"## Breakout\n\n![alt text](http:\/\/www.atarimania.com\/2600\/boxes\/hi_res\/breakout_color_cart_4.jpg)\n\n\nSource: [Atari mania](http:\/\/www.atarimania.com\/game-atari-2600-vcs-breakout_18135.html)\n","2244d330":"# Gym  \nIn 2014 Google DeepMind published a paper titled \"Playing Atari with Deep Reinforcement Learning\" that can play Atari 2600 games at expert human levels. This was the first breakthrough in applying deep neural networks for reinforcement learning.\n![alt text](https:\/\/cdn-images-1.medium.com\/max\/800\/1*3ZgGbUpEyAZb9POWijRq4Q.png)\n\n\nGym is released by Open AI in 2016 (http:\/\/gym.openai.com\/docs\/). It is a toolkit for developing and comparing reinforcement learning algorithms.\n<img src=\"https:\/\/i.imgur.com\/ria9HOm.jpg%20\" width=800>\n\nSource: [OpenAI](https:\/\/openai.com\/)\n\nIn 2018 Gym-retro was released as its successor: https:\/\/blog.openai.com\/gym-retro\/\n\nThere are many many games made available. and you need to install the gym[atari] environment to make the Atari games available. In Kaggle you have to enable the Internet-beta feature available to make it internet connected (see to the left of the screen in the settings) and to be able to install the required packages\n![alt text](https:\/\/cdn-images-1.medium.com\/max\/800\/1*vUMIoHkl-PuIjbTqbtn8dA.png)\n\n"}}