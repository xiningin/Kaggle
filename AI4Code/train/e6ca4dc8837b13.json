{"cell_type":{"e821868b":"code","499a6e28":"code","9d41ad06":"code","2e57a453":"code","daf5f930":"code","cf8d5353":"code","dce02cf0":"code","4b78c4b3":"code","99af6eb4":"code","44718a34":"code","4b3eed7b":"code","f0e393cb":"code","06c55475":"code","6a19e3a0":"code","e18bc412":"code","ad1534bc":"code","6b3e9556":"code","2e447834":"code","1c9d1426":"code","7f7753ab":"markdown"},"source":{"e821868b":"import numpy as np\nimport pandas as pd\nfrom pandas import DataFrame\nimport matplotlib.pyplot as plt\nplt.style.use('ggplot')\n%matplotlib inline\n\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.manifold import TSNE\n\nfrom sklearn.preprocessing import LabelEncoder, MinMaxScaler","499a6e28":"#import os\n#for dirname, _, filenames in os.walk('\/kaggle\/input'):\n#    for filename in filenames:\n#        print(os.path.join(dirname, filename))","9d41ad06":"df_train = pd.read_csv('\/kaggle\/input\/data-science-spring-osaka-2021\/train.csv')\ndf_test = pd.read_csv('\/kaggle\/input\/data-science-spring-osaka-2021\/test.csv')\ndf_action = pd.read_csv('\/kaggle\/input\/data-science-spring-osaka-2021\/actions.csv')","2e57a453":"df_train.head(2)","daf5f930":"df_action.head(20)","cf8d5353":"df = pd.read_csv('\/kaggle\/input\/data-science-spring-osaka-2021\/train\/train_0000.csv')","dce02cf0":"df.tail(2)","4b78c4b3":"#scaler = MinMaxScaler()\n#df.iloc[:] = scaler.fit_transform(df)","99af6eb4":"#df.tail(2)","44718a34":"DataFrame(df.mean()).T","4b3eed7b":"def add_mean_as_feature(df):\n    df_temp = DataFrame()\n    for path in df.file_path:\n        df_sensor = pd.read_csv('..\/input\/data-science-spring-osaka-2021'+path)\n        df_sensor = DataFrame(df_sensor.mean()).T\n        df_temp = pd.concat([df_temp, df_sensor])\n    df_temp.columns = [col+'_mean' for col in df_temp.columns]\n    df_temp.index = df.index\n    df = pd.concat([df, df_temp], axis=1)\n    return df","f0e393cb":"df_train = add_mean_as_feature(df_train)","06c55475":"y_action = df_train.action_seq\nX_train = df_train\nX_train.drop(['file_path','action_seq'],axis=1,inplace=True)","6a19e3a0":"le = LabelEncoder()\ny_action = le.fit_transform(y_action)\ny_action = DataFrame(y_action, index=range(355), columns=['action_no'])","e18bc412":"X_train.tail(2)","ad1534bc":"y_action.action_no.tail(2)","6b3e9556":"n_components = 2\nperplexity=50\n\ntsne = TSNE(n_components=n_components, init='random', random_state=10, perplexity=perplexity)\n\ny_train = tsne.fit_transform(X_train)\n","2e447834":"#y_action['action_no']","1c9d1426":"colors =  [\"b\", \"g\", \"r\", \"c\", \"m\", \"yellow\", \"k\", \"orange\",\"pink\",\"cyan\",\"lime\",\"olive\"]\nfor i in range(len(y_train)):\n    plt.scatter(y_train[i,0],y_train[i,1],color=colors[y_action.action_no[i]])","7f7753ab":"t-SNE\u306f\u9ad8\u6b21\u5143\u30c7\u30fc\u30bf\u30922\u6b21\u5143\u53c8\u306f3\u6b21\u5143\u306b\u5909\u63db\u3057\u3066\u53ef\u8996\u5316\u3059\u308b\u305f\u3081\u306e\u6b21\u5143\u524a\u6e1b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3067\u3001\u30c7\u30a3\u30fc\u30d7\u30e9\u30fc\u30cb\u30f3\u30b0\u306e\u7236\u3068\u3082\u547c\u3070\u308c\u308b\u30d2\u30f3\u30c8\u30f3\u6559\u6388\u304c\u958b\u767a\u3057\u307e\u3057\u305f\u3002\n\u3053\u308c\u3092\u7528\u3044\u3066\u3001\u4eca\u56de\u306e trainning data \u3092\uff12\u6b21\u5143\u306b\u53ef\u8996\u5316\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u4f7f\u7528\u3057\u305f\u30c7\u30fc\u30bf\u306f\u3001mean baseline \u306e\u5e73\u5747\u5024\u3067\u3059\u3002\n\uff12\u6b21\u5143\u306e\u6563\u5e03\u56f3\u304c\u3001\u6700\u5f8c\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\u4f8b\u3048\u3070\u30010\u756a\u306e jab-straight-hook-upper \u304c\u3001blue \u306e\u70b9\u3067\u8868\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u6bd4\u8f03\u7684\u72ec\u7acb\u3057\u3066\u3044\u308b\u30a2\u30af\u30b7\u30e7\u30f3\u3082\u3042\u308c\u3070\u3001\u6df7\u5728\u3057\u3066\u3044\u308b\u7b87\u6240\u3082\u898b\u3089\u308c\u307e\u3059\u3002"}}