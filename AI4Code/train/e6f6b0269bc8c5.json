{"cell_type":{"87bde65a":"code","1232fb79":"code","3bf68332":"code","bf2c58ed":"code","5550c4c0":"code","3bc0ef32":"code","fe8bf987":"code","813c2e39":"code","24f38726":"code","5af0f27f":"code","31c394f5":"code","44af8c4b":"code","e86ee1e8":"code","c708bbd8":"code","a8f421cb":"code","0db155f7":"code","a48ab785":"code","551b07e6":"code","834bd8be":"code","7bac108f":"code","657b5b8c":"code","a6d94f08":"code","514649ce":"code","d122db57":"markdown","cfb80ca0":"markdown","63a44908":"markdown","4f223c21":"markdown","f8808d05":"markdown","29bb7515":"markdown","0c9b6c1e":"markdown"},"source":{"87bde65a":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\n!pip install h2o\nimport pickle\n\nimport h2o\nfrom h2o.automl import H2OAutoML","1232fb79":"df=pd.read_csv('..\/input\/tabular-playground-series-jun-2021\/train.csv')","3bf68332":"df.head()","bf2c58ed":"df.describe()","5550c4c0":"df['target'].unique()","3bc0ef32":"h2o.init(\n    nthreads=-1,     # number of threads when launching a new H2O server\n    max_mem_size=12  # in gigabytes\n)","fe8bf987":"train_df = pd.read_csv('..\/input\/tabular-playground-series-jun-2021\/train.csv')\ntest_df = pd.read_csv('..\/input\/tabular-playground-series-jun-2021\/test.csv')","813c2e39":"y_train=train_df['target']\nX_train=train_df.drop(['target','id'],axis=1)","24f38726":"X_y_train_h = h2o.H2OFrame(pd.concat([X_train, y_train], axis='columns'))\n\n# ^ the target column should have categorical type for classification tasks\n#   (numerical type for regression tasks)\n\nX_test_h = h2o.H2OFrame(test_df)\n\nX_y_train_h.describe()","5af0f27f":"X_y_train_h.head()","31c394f5":"feature_cols=X_train.columns","44af8c4b":"feature_cols=list(feature_cols)","e86ee1e8":"lb = h2o.import_file(path=\"..\/input\/auto-ml-output\/aml_leaderboard.h2o\")\n\nlb.head(rows=10)","c708bbd8":"H2O  = h2o.load_model(\"..\/input\/auto-ml-output\/StackedEnsemble_BestOfFamily_AutoML_20210611_175001\")","a8f421cb":"pred=H2O.predict(X_test_h)","0db155f7":"h20_predictions_df = pred.as_data_frame()","a48ab785":"h20_predictions_df.head()","551b07e6":"sub=pd.read_csv(\"..\/input\/tabular-playground-series-jun-2021\/sample_submission.csv\")","834bd8be":"sub['id']=test_df['id']","7bac108f":"h20_predictions_df['predict']=test_df['id']","657b5b8c":"h20_predictions_df=h20_predictions_df.rename(columns = {'predict': 'id'}, inplace = False)","a6d94f08":"h20_predictions_df.head()","514649ce":"h20_predictions_df.to_csv(\"submission.csv\",index=False)","d122db57":"# saving the predictions","cfb80ca0":"# H2O modelling ","63a44908":"# Load the pretrained models","4f223c21":"# Predict it !","f8808d05":"![lll](https:\/\/user-images.githubusercontent.com\/50532530\/121784795-9ef00480-cbd3-11eb-8df9-22a12e5608c5.PNG)","29bb7515":"# Imports","0c9b6c1e":"# Lets load the data and see it"}}