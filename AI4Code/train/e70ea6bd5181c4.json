{"cell_type":{"9a37e2ca":"code","96bc2018":"code","907fcee5":"code","f902664d":"code","0cf50389":"code","324e606d":"code","8a537793":"code","7708cf25":"code","146f752c":"code","d20d6e14":"code","8f1674f8":"code","e96d1d52":"code","da96aaf5":"code","5f97c05b":"code","770e689f":"code","59199e05":"code","fe524ef2":"code","fb1ee89e":"code","2636d574":"code","1ca9f799":"code","00b23169":"code","76b321f7":"code","04be4b7d":"markdown","dd1a9c56":"markdown","520d07ea":"markdown","9845c294":"markdown","8411dee2":"markdown","0ccd0304":"markdown","fec6b916":"markdown","fe507d1b":"markdown","5fd098a4":"markdown","1a755e21":"markdown","c3313a6f":"markdown","4040644c":"markdown"},"source":{"9a37e2ca":"!pip install dataprep","96bc2018":"import pandas as pd\nimport numpy as np\nfrom dataprep.eda import create_report\nimport plotly.express as px\nimport plotly.graph_objects as go\nfrom plotly.subplots import make_subplots\nimport plotly.figure_factory as ff\nfrom sklearn.preprocessing import StandardScaler, MinMaxScaler\nfrom sklearn.model_selection import train_test_split, GridSearchCV\nfrom xgboost import XGBClassifier, cv\nfrom sklearn.metrics import accuracy_score, f1_score, precision_score, confusion_matrix\nfrom sklearn.ensemble import RandomForestClassifier","907fcee5":"tr = pd.read_csv('..\/input\/customer-analytics\/Train.csv')\ntr.head()","f902664d":"create_report(tr)","0cf50389":"tr.info()","324e606d":"fig = go.Figure(data=[\n    go.Bar(name='Female', x=tr.loc[tr.Gender == 'F','Customer_care_calls'].value_counts().index, y=tr.loc[tr.Gender == 'F','Customer_care_calls'].value_counts().values),\n    go.Bar(name='Male', x=tr.loc[tr.Gender == 'M','Customer_care_calls'].value_counts().index, y=tr.loc[tr.Gender == 'M','Customer_care_calls'].value_counts().values)\n])\n\nfig.update_layout(barmode='group')\nfig.show()","8a537793":"# Add histogram data\nx1 = tr.loc[tr.Gender == 'F','Cost_of_the_Product']\nx2 = tr.loc[tr.Gender == 'M','Cost_of_the_Product']\n\n# Group data together\nhist_data = [x1, x2]\ngroup_labels = ['Female', 'Male']\ncolors = ['slategray', 'magenta']\n\n# Create distplot with custom bin_size\nfig = ff.create_distplot(hist_data, group_labels, colors=colors)\nfig.show()","7708cf25":"# Add histogram data\nx1 = tr.loc[tr.Gender == 'F','Weight_in_gms']\nx2 = tr.loc[tr.Gender == 'M','Weight_in_gms']\n\n# Group data together\nhist_data = [x1, x2]\ngroup_labels = ['Female', 'Male']\ncolors = ['slategray', 'magenta']\n\n# Create distplot with custom bin_size\nfig = ff.create_distplot(hist_data, group_labels, colors=colors)\nfig.show()","146f752c":"# Add histogram data\nx1 = tr.loc[tr.Mode_of_Shipment == 'Ship','Weight_in_gms']\nx2 = tr.loc[tr.Mode_of_Shipment == 'Flight','Weight_in_gms']\nx3 = tr.loc[tr.Mode_of_Shipment == 'Road','Weight_in_gms']\n\n# Group data together\nhist_data = [x1, x2, x3]\ngroup_labels = ['Ship', 'Flight', 'Road']\ncolors = ['Red', 'Blue', 'Green']\n\n# Create distplot with custom bin_size\nfig = ff.create_distplot(hist_data, group_labels, colors=colors)\nfig.show()","d20d6e14":"tr = tr.iloc[:,1:]","8f1674f8":"sc = StandardScaler()\ntr.iloc[:,[2,3,4,5,8,9]] = sc.fit_transform(tr.iloc[:,[2,3,4,5,8,9]])","e96d1d52":"tr_dum = pd.get_dummies(tr.iloc[:,:-1])","da96aaf5":"train = pd.concat([tr_dum,tr.iloc[:,-1]], axis='columns')","5f97c05b":"train.head()","770e689f":"X_train, X_test, y_train, y_test = train_test_split(train.iloc[:,:-1], train.iloc[:,-1], random_state=123, stratify=train.iloc[:,-1], test_size=0.3)","59199e05":"xgb = XGBClassifier(n_estimators=20, learning_rate=0.1, max_depth=50, use_label_encoder=False,objective = \"binary:hinge\")\nxgb.fit(X_train, y_train)\npred = xgb.predict(X_test)\nAcc_score = accuracy_score(pred, y_test)\nF1_score = f1_score(pred, y_test)\nPrecision_score = precision_score(pred, y_test)\nprint(\"Acc score : {:.2f}\".format(Acc_score))\nprint(\"F1 score : {:.2f}\".format(F1_score))\nprint(\"Precision score : {:.2f}\".format(Precision_score))","fe524ef2":"rf = RandomForestClassifier()\nrf_param_grid = {'n_estimators' : list(range(5,16)), 'max_depth' : list(range(5,16))}\nrf_grid = GridSearchCV(estimator=rf,\n                      param_grid=rf_param_grid,\n                      scoring='accuracy',\n                      cv=4,\n                      return_train_score=True)\n\nrf_grid.fit(train.iloc[:, :-1],train.iloc[:,-1])","fb1ee89e":"import itertools\nimport matplotlib.pyplot as plt\n\ndef plot_confusion_matrix(cm, classes,\n                          normalize=False,\n                          title='Confusion matrix',\n                          cmap=plt.cm.Blues):\n    \"\"\"\n    This function prints and plots the confusion matrix.\n    Normalization can be applied by setting `normalize=True`.\n    \"\"\"\n    plt.imshow(cm, interpolation='nearest', cmap=cmap)\n    plt.title(title)\n    plt.colorbar()\n    tick_marks = np.arange(len(classes))\n    plt.xticks(tick_marks, classes, rotation=0)\n    plt.yticks(tick_marks, classes)\n\n    if normalize:\n        cm = cm.astype('float') \/ cm.sum(axis=1)[:, np.newaxis]\n        #print(\"Normalized confusion matrix\")\n    else:\n        1#print('Confusion matrix, without normalization')\n\n    #print(cm)\n\n    thresh = cm.max() \/ 2.\n    for i, j in itertools.product(range(cm.shape[0]), range(cm.shape[1])):\n        plt.text(j, i, cm[i, j],\n                 horizontalalignment=\"center\",\n                 color=\"white\" if cm[i, j] > thresh else \"black\")\n\n    plt.tight_layout()\n    plt.ylabel('True label')\n    plt.xlabel('Predicted label')","2636d574":"rf_grid.best_params_","1ca9f799":"rf_best = RandomForestClassifier(max_depth=15, n_estimators=5)\nrf_best.fit(train.iloc[:, :-1],train.iloc[:,-1])","00b23169":"pred = rf_best.predict(train.iloc[:, :-1])","76b321f7":"cnf_matrix_tra = confusion_matrix(train.iloc[:,-1], pred)\nprint(round(accuracy_score(train.iloc[:,-1], pred),2), '%')\n\nclass_names = [0,1]\nplt.figure()\nplot_confusion_matrix(cnf_matrix_tra , classes=class_names, title='Confusion matrix')\nplt.show()","04be4b7d":"## 1. Load library","dd1a9c56":"#### 2-3. There was no difference in weight of product by gender.","520d07ea":"#### 2-2. There was no difference in cost of the product by gender.","9845c294":"## 4. Modeling","8411dee2":"#### 2-4. There was no difference in weight of product by shipment mode.","0ccd0304":"### 4-1. XGBoost","fec6b916":"> Using dataprep package, We can check basic data EDA","fe507d1b":"#### 2-1. There was no difference in the number of calls by gender.","5fd098a4":"## 3. Data preprocessing","1a755e21":"## 2. Read data and visualization","c3313a6f":"## 5. Result(Confusion matrix)","4040644c":"### 4-2. Randomforest with GridSearchCV"}}