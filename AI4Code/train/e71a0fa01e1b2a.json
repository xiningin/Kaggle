{"cell_type":{"b6630e3e":"code","c55b547b":"code","305c3f9a":"code","d59001a7":"code","c318f26a":"code","28338911":"code","961092ea":"code","a3b7926e":"code","6d337c92":"code","187aabb9":"markdown","325d0e19":"markdown","f4ba5441":"markdown"},"source":{"b6630e3e":"import numpy as np\nimport pandas as pd\nfrom sklearn.preprocessing import OneHotEncoder","c55b547b":"filepath = '..\/input\/30-days-of-ml\/train.csv' # Input data files are available in the read-only \"..\/input\/\" directory\ndf = pd.read_csv(filepath)\ndf.head(5)","305c3f9a":"cat_cols = [col for col in df.columns if df[col].dtype == 'object']\ndf[cat_cols].head(5)","d59001a7":"encoder_categories = []\nfor col in cat_cols:\n    cod_categ = df[col].unique()\n    encoder_categories.append(cod_categ)\n\nencoder_categories","c318f26a":"# Let's instance our OneHotEncode with a few parameters. In this case pay attention to 'categories'.\nencoder_ohe = OneHotEncoder(categories=encoder_categories, handle_unknown='ignore', sparse=False)\ndf_ohe = encoder_ohe.fit_transform(df[cat_cols]) #Here we have our encode categoricals in the form of an array ","28338911":"encoder_ohe.get_feature_names() #if we use no parameters in the .get_features_names() we obtain a column with no name","961092ea":"encoder_ohe.get_feature_names(cat_cols) #but if we pass it the list of columns, we get sth different","a3b7926e":"df_ohe # this is our categorical array. Let's take a look","6d337c92":"# Let's put it into a DataFrame with his correspondent column names.\ndf_encoded = pd.DataFrame(df_ohe, columns=encoder_ohe.get_feature_names(cat_cols))\ndf_encoded.head(5)","187aabb9":"# Sklearn One Hot Encode\nThis notebook is aimed to those who want to know a little bit more about the process of OneHotEncoding. It's simple but useful (at least for me) and help me to understand and fix the concept of Categorical Encoding.","325d0e19":"Now you got the df_encoded as a DataFrame. Don't forget to concat it to df and delete the categorical cols before another transformation. I hope this simple Notebook help you.","f4ba5441":"Let's select the categorical columns. This could be done in many ways so, here it's one of them."}}