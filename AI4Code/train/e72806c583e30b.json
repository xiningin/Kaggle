{"cell_type":{"94ad2d8c":"code","e7727b11":"code","286fd6e4":"code","31e0ec80":"code","b2a94520":"code","32bc8b1b":"code","8edc7f4b":"code","506f817d":"markdown","d35b382c":"markdown","490eea35":"markdown","f96fa5f5":"markdown","b24a6647":"markdown","39a9ea4c":"markdown","0d771925":"markdown"},"source":{"94ad2d8c":"# offical google cloud library is recommended\nfrom google.cloud import bigquery\nimport pandas as pd","e7727b11":"# initiate bigquery client\nbq = bigquery.Client()","286fd6e4":"# just write your sql query\nsql_query = \"\"\"\n#standardSQL\nSELECT\n  event_type,\n  COUNT(*) AS event_count\nFROM `bigquery-public-data.ncaa_basketball.mbb_pbp_sr`\nGROUP BY 1\nORDER BY event_count DESC;\n\"\"\"\n# and run the query to get the result in a dataframe\nresults = bq.query(sql_query).to_dataframe()\nresults","31e0ec80":"# just write your sql query\nsql_query = \"\"\"\n#standardSQL\n#most three points made\nSELECT\n  scheduled_date,\n  name,\n  market,\n  alias,\n  three_points_att,\n  three_points_made,\n  three_points_pct,\n  opp_name,\n  opp_market,\n  opp_alias,\n  opp_three_points_att,\n  opp_three_points_made,\n  opp_three_points_pct,\n  (three_points_made + opp_three_points_made) AS total_threes\nFROM `bigquery-public-data.ncaa_basketball.mbb_teams_games_sr`\nWHERE season > 2010\nORDER BY total_threes DESC\nLIMIT 5;\n\"\"\"\n# and run the query to get the result in a dataframe\nresults = bq.query(sql_query).to_dataframe()\nresults","b2a94520":"# just write your sql query\nsql_query = \"\"\"\n#standardSQL\nSELECT\n  venue_name, venue_capacity, venue_city, venue_state\nFROM `bigquery-public-data.ncaa_basketball.mbb_teams_games_sr`\nGROUP BY 1,2,3,4\nORDER BY venue_capacity DESC\nLIMIT 5;\n\"\"\"\n# and run the query to get the result in a dataframe\nresults = bq.query(sql_query).to_dataframe()\nresults","32bc8b1b":"# just write your sql query\nsql_query = \"\"\"\n#standardSQL\n#highest scoring game of all time\nSELECT\n  scheduled_date,\n  name,\n  market,\n  alias,\n  points_game AS team_points,\n  opp_name,\n  opp_market,\n  opp_alias,\n  opp_points_game AS opposing_team_points,\n  points_game + opp_points_game AS point_total\nFROM `bigquery-public-data.ncaa_basketball.mbb_teams_games_sr`\nWHERE season > 2010\nORDER BY point_total DESC\nLIMIT 5;\n\"\"\"\n# and run the query to get the result in a dataframe\nresults = bq.query(sql_query).to_dataframe()\nresults","8edc7f4b":"# just write your sql query\nsql_query = \"\"\"\n#standardSQL\n#biggest point difference in a championship game\nSELECT\n  scheduled_date,\n  name,\n  market,\n  alias,\n  points_game AS team_points,\n  opp_name,\n  opp_market,\n  opp_alias,\n  opp_points_game AS opposing_team_points,\n  ABS(points_game - opp_points_game) AS point_difference\nFROM `bigquery-public-data.ncaa_basketball.mbb_teams_games_sr`\nWHERE season > 2015 AND tournament_type = 'National Championship'\nORDER BY point_difference DESC\nLIMIT 5;\n\n\"\"\"\n# and run the query to get the result in a dataframe\nresults = bq.query(sql_query).to_dataframe()\nresults","506f817d":"- Since 2015, what was the biggest difference in final score for a National Conference?","d35b382c":"BigQuery has NCAA (National Collegiate Athletic Association) data and we are gonna play a bit with it. Here's the structure of the NCAA dataset on BigQuery.\n\n![NCAA dataset on BigQuery](https:\/\/i.imgur.com\/Rnthlig.png)\n\nRead introduction to BigQuery on Kaggle here: https:\/\/www.kaggle.com\/vikramtiwari\/bigquery-getting-started-with-bq-data-on-kaggle","490eea35":"Next steps:\n- More detailed analysis: https:\/\/github.com\/google-cloud-ncaa\/demos\n- Try it out: https:\/\/google.qwiklabs.com\/catalog_lab\/815","f96fa5f5":"- What were the highest scoring games since 2010?","b24a6647":"- Which 5 basketball venues have highest seating capcity?","39a9ea4c":"Let's start with a few questions:\n\n- What type of basketball plays are there?","0d771925":"- Which 5 games feature the most three point shots made? How accurate were the attempts?"}}