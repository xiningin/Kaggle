{"cell_type":{"ef38acc3":"code","68df5445":"code","bb1c41a1":"code","588d7f77":"code","3ec25bbf":"code","7b4508f4":"code","665cdd5e":"code","54876fea":"code","6a0161db":"code","821bedd3":"code","14301c5b":"code","b065e987":"code","5b5ab833":"code","87114478":"code","2db8f5e7":"code","ee3d44e1":"code","b044ada2":"code","2ec9b68b":"code","52281b5c":"code","81e31efd":"code","f58a6025":"code","21ac5ef9":"code","515446ff":"code","d906e5c4":"code","bd55d926":"code","960fd575":"code","cdce262d":"code","d043d3a9":"code","fae1785b":"code","94986fd9":"code","23cae90c":"markdown","e8d9b7fd":"markdown","51de1c00":"markdown","9aa46aeb":"markdown","c47c8e43":"markdown","4e77b63a":"markdown","b83ac389":"markdown","20765ca3":"markdown","a713d2aa":"markdown","17869898":"markdown","db7d4bda":"markdown","aa729486":"markdown","d7725a56":"markdown","7339a79d":"markdown","cda927fb":"markdown","86bab66d":"markdown","2de58f7f":"markdown","0ed9603c":"markdown","1a8bdf63":"markdown","5f182946":"markdown","789ae5da":"markdown","fae3dce0":"markdown","35c57181":"markdown","8076a7b0":"markdown","5368089b":"markdown","ae457bb8":"markdown","73511d1d":"markdown","f261260a":"markdown","2776ff66":"markdown","74509879":"markdown","6a869d43":"markdown","94570003":"markdown","148adfba":"markdown"},"source":{"ef38acc3":"# ignore warnings \nimport warnings\nwarnings.filterwarnings('ignore')\n\n# import general packages\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt \nimport seaborn as sns \n%matplotlib inline\ncolor = sns.color_palette()\n\n\n# algorithms\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.neural_network import MLPRegressor\n\n\n# modeling helper functions\nfrom sklearn.model_selection import GridSearchCV , KFold , cross_val_score\n\n\n# to read \/ write access to some common neuroimaging file formats\n## for more information, please visit : https:\/\/pypi.org\/project\/nibabel\/\nimport nibabel\n","68df5445":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\n\n# print all files in the data folder\nbase_url = '\/kaggle\/input\/trends-assessment-prediction'\nprint(os.listdir(base_url))","bb1c41a1":"%time\nloading_df = pd.read_csv(base_url +'\/loading.csv')\nsample_submission = pd.read_csv(base_url +'\/sample_submission.csv')\ntrain_df = pd.read_csv(base_url +'\/train_scores.csv')","588d7f77":"print(f'Size of loading_df : {loading_df.shape}')\nprint(f'Size of sample_submission : {sample_submission.shape}')\nprint(f'Size of train_df : {train_df.shape}')\nprint(f'Size of test set : {len(sample_submission)\/5}')","3ec25bbf":"def preview(df):\n    print(df.head())","7b4508f4":"preview(loading_df)","665cdd5e":"preview(sample_submission)","54876fea":"preview(train_df)","6a0161db":"missing_train_df = train_df.isnull().mean() * 100\nmissing_train_df.sort_values(ascending=False)","821bedd3":"loading_df.isnull().sum().sum()","14301c5b":"sample_submission.isnull().sum().sum()","b065e987":"target_labels = list(train_df.columns[1:])\ntarget_labels","5b5ab833":"x = train_df['age']\nplt.figure(figsize=(8,6))\nplt.hist(x, bins=25, color='g')\nplt.xlabel('Age')\nplt.ylabel('Number of patients')\nplt.title('Age distribution of patients', fontsize = 16)\nplt.show()","87114478":"x = train_df['domain1_var1']\nplt.figure(figsize=(8,6))\nplt.hist(x, bins=25, color='c')\nplt.xlabel('domain1_var1')\nplt.ylabel('Number of patients')\nplt.title('domain1_var1 distribution', fontsize = 16)\nplt.show()","2db8f5e7":"train_df['domain1_var1'].fillna(train_df['domain1_var1'].mean(), inplace=True)","ee3d44e1":"x = train_df['domain1_var2']\nplt.figure(figsize=(8,6))\nplt.hist(x, bins=25, color='pink')\nplt.xlabel('domain1_var2')\nplt.ylabel('Number of patients')\nplt.title('domain1_var2 distribution', fontsize = 16)\nplt.show()","b044ada2":"train_df['domain1_var2'].fillna(train_df['domain1_var2'].median(), inplace=True)","2ec9b68b":"x = train_df['domain2_var1']\nplt.figure(figsize=(8,6))\nplt.hist(x, bins=25, color='y')\nplt.xlabel('domain2_var1')\nplt.ylabel('Number of patients')\nplt.title('domain2_var1 distribution', fontsize = 16)\nplt.show()","52281b5c":"train_df['domain2_var1'].fillna(train_df['domain2_var1'].mean(), inplace=True)","81e31efd":"x = train_df['domain2_var2']\nplt.figure(figsize=(8,6))\nplt.hist(x, bins=25, color='r')\nplt.xlabel('domain2_var2')\nplt.ylabel('Number of patients')\nplt.title('domain2_var2 distribution', fontsize = 16)\nplt.show()","f58a6025":"train_df['domain2_var2'].fillna(train_df['domain2_var2'].mean(), inplace=True)","21ac5ef9":"train_df.isnull().sum()","515446ff":"cols = train_df.columns[1:]\ncorrelation = train_df[cols].corr()","d906e5c4":"mask = np.zeros_like(correlation)\nmask[np.triu_indices_from(mask)] = True\nwith sns.axes_style(\"white\"):\n    f, ax = plt.subplots(figsize=(12,8))\n    ax = sns.heatmap(correlation, mask=mask, vmax=.3, square=True, annot=True, cmap='YlGnBu', fmt='.2f', linecolor='white')\n    ax.set_title('Correlation Heatmap of training dataset')\n    ax.set_xticklabels(ax.get_xticklabels(), rotation=90)\n    ax.set_yticklabels(ax.get_yticklabels(), rotation=30)           \n    plt.show()","bd55d926":"sns.pairplot(train_df[cols], kind='scatter', diag_kind='hist', palette='Rainbow')\nplt.show()","960fd575":"train_ids = sorted(loading_df[loading_df['Id'].isin(train_df.Id)]['Id'].values)\ntest_ids = sorted(loading_df[~loading_df['Id'].isin(train_df.Id)]['Id'].values)\npredictions = pd.DataFrame(test_ids, columns=['Id'], dtype=str)\nfeatures = ('age', 'domain1_var1', 'domain1_var2','domain2_var1','domain2_var2')","cdce262d":"data = pd.merge(loading_df, train_df, on='Id')\nX_train = data.drop(list(features), axis=1).drop('Id', axis=1)\ny_train = data[list(features)]\nX_test = loading_df[loading_df.Id.isin(test_ids)].drop('Id', axis=1)\n","d043d3a9":"names = [\"Linear Regression\", \"Decision Tree\", \"Random Forest\", \"Neural Net\" ]    ","fae1785b":"regressors = [\n    LinearRegression(),\n    DecisionTreeRegressor(max_depth=5),\n    RandomForestRegressor(max_depth=5, n_estimators=10, max_features=1),\n    MLPRegressor(alpha=1, max_iter=1000),\n    ]","94986fd9":"# iterate over classifiers and calculate cross-validation score\nfor name, reg in zip(names, regressors):\n    scores = cross_val_score(reg, X_train, y_train, cv = 5, scoring='neg_mean_absolute_error')\n    print(name , ':{:.4f}'.format(scores.mean()))","23cae90c":"# **1. Import libraries** <a class=\"anchor\" id=\"1\"><\/a>\n\n[Table of Contents](#0.1)\n","e8d9b7fd":"We can see that Random Forest results in lowest negative MAE. So, we will use it for submission.","51de1c00":"# **3. Data Exploration** <a class=\"anchor\" id=\"3\"><\/a>\n\n[Table of Contents](#0.1)","9aa46aeb":"Age does not contain any missing values.","c47c8e43":"## **3.3 Check for missing values**  <a class=\"anchor\" id=\"3.3\"><\/a>\n\n[Table of Contents](#0.1)\n\n\nNow, let's check for missing values in training data.","4e77b63a":"## **4.1 Data Visualization of features** <a class=\"anchor\" id=\"4.1\"><\/a>\n\n[Table of Contents](#0.1)","b83ac389":"<a class=\"anchor\" id=\"0\"><\/a>\n# **TReNDS : EDA + Visualization + Models** \n\n\n\n## **Introduction**\n\n\n[TReNDS Neuroimaging](https:\/\/www.kaggle.com\/c\/trends-assessment-prediction) competition has been recently launched at Kaggle. We can find the evaluation page [here](https:\/\/www.kaggle.com\/c\/trends-assessment-prediction\/overview\/evaluation)\n\nHuman brain research is among the most complex areas of study for scientists. We know that age and other factors can affect its function and structure, but more research is needed into what specifically occurs within the brain. With much of the research using MRI scans, data scientists are well positioned to support future insights. In particular, neuroimaging specialists look for measurable markers of behavior, health, or disorder to help identify relevant brain regions and their contribution to typical or symptomatic effects.\n\nIn this competition, we will predict multiple assessments plus age from multimodal brain MRI features. \n\n\n","20765ca3":"# **2. Read datasets** <a class=\"anchor\" id=\"2\"><\/a>\n\n[Table of Contents](#0.1)\n","a713d2aa":"## **3.1 Shape of the data**  <a class=\"anchor\" id=\"3.1\"><\/a>\n\n[Table of Contents](#0.1)\n\nWe will begin our data exploration by checking the shape of the data.","17869898":"### **4.1.4 domain2_var1** <a class=\"anchor\" id=\"4.1.4\"><\/a>\n\n[Table of Contents](#0.1)","db7d4bda":"\n**I hope you find this notebook useful and your <font color=\"red\"><b>UPVOTES<\/b><\/font> keep me motivated**\n\n","aa729486":"`domain2_var2` is approximately normal. So, we will fill missing values with mean.","d7725a56":"## **3.2 Preview the data**  <a class=\"anchor\" id=\"3.2\"><\/a>\n\n[Table of Contents](#0.1)\n\n\nNow, let's preview the data to gain more insights about the data.","7339a79d":"We will check the distribution of target variables in training set. We will exclude `Id` from the training set.","cda927fb":"# **4. Data Visualization** <a class=\"anchor\" id=\"4\"><\/a>\n\n[Table of Contents](#0.1)","86bab66d":"# **5. Modelling** <a class=\"anchor\" id=\"5\"><\/a>\n\n[Table of Contents](#0.1)\n","2de58f7f":"<a class=\"anchor\" id=\"0.1\"><\/a>\n# **Table of Contents** \n\n1.\t[Import libraries](#1)\n2.\t[Read datasets](#2)\n3.  [Data Exploration](#3)\n   - 3.1 [Shape of the data](#3.1)\n   - 3.2 [Preview the data](#3.2)\n   - 3.3 [Check for missing values](#3.3)\n4.  [Data Visualization](#4)\n   - 4.1 [Data Visualization of Features](#4.1)\n         - 4.1.1 [age](#4.1.1)\n         - 4.1.2 [domain1_var1](#4.1.2)\n         - 4.1.3 [domain1_var2](#4.1.3)\n         - 4.1.4 [domain2_var1](#4.1.4)\n         - 4.1.5 [domain2_var2](#4.1.5)\n   - 4.2 [Correlation Heatmap](#4.2)\n   - 4.3 [Pair Plot](#4.3)\n5. [Modelling](#5)\n6. [Submission](#6)     \n\n   \n","0ed9603c":"## To be continued. Please visit this space again.","1a8bdf63":"### **Observations** \n\n\nFrom the above heatmap and pairplot, we can conclude that-\n\n- `age` is positively correlated with `domain1_var1` and `domain2_var1`.\n\n- `domain2_var1` and `domain2_var2` are positively correlated.","5f182946":"### **4.1.2 domain1_var1** <a class=\"anchor\" id=\"4.1.2\"><\/a>\n\n[Table of Contents](#0.1)","789ae5da":"![TReNDS](https:\/\/www.googleapis.com\/download\/storage\/v1\/b\/kaggle-user-content\/o\/inbox%2F1537731%2Fa5fdbe17ca91e6713d2880887232c81a%2FScreen%20Shot%202019-12-09%20at%2011.25.31%20AM.png?generation=1575920121028151&alt=media)","fae3dce0":"`domain1_var2` is skewed. So, we will fill missing values with median.","35c57181":"## **4.3 Pair Plot**  <a class=\"anchor\" id=\"4.3\"><\/a> \n\n[Table of Contents](#0.1)\n\n\nWe will draw pairplot to visualize relationship between the target variables. ","8076a7b0":"## **4.2 Correlation Heatmap**  <a class=\"anchor\" id=\"4.2\"><\/a> \n\n[Table of Contents](#0.1)\n\n\nCorrelation Heatmap is used to visualize feature interactions in training set.","5368089b":"There are no missing values in training set.","ae457bb8":"### **4.1.5 domain2_var2** <a class=\"anchor\" id=\"4.1.5\"><\/a>\n\n[Table of Contents](#0.1)","73511d1d":"### **4.1.1 age** <a class=\"anchor\" id=\"4.1.1\"><\/a>\n\n[Table of Contents](#0.1)","f261260a":"`domain2_var1` is approximately normal. So, we will fill missing values with mean.","2776ff66":"# **6. Submission** <a class=\"anchor\" id=\"6\"><\/a>\n\n[Table of Contents](#0.1)\n","74509879":"So, `loading_df` and `sample_submission` do not have any missing values. ","6a869d43":"[Go to Top](#0)","94570003":"We can see that `domain1_var1` distribution is approximately normal. So, we will fill the missing values with mean.","148adfba":"### **4.1.3 domain1_var2** <a class=\"anchor\" id=\"4.1.3\"><\/a>\n\n[Table of Contents](#0.1)"}}