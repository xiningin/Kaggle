{"cell_type":{"53f60c70":"code","5fc42bde":"code","494a6ea3":"code","22dbd86d":"code","f1d51e7d":"code","d22985a7":"code","fcfd9995":"code","a044fc6f":"code","82e02a51":"code","399c0d56":"code","9f53e8bc":"code","a67951de":"code","dd5f039c":"code","919bb030":"code","d44dba2c":"code","8402bae3":"code","8b1e8e69":"code","bcc0f578":"code","a3df9d3b":"code","89d932d0":"code","917ca8b2":"code","f725cf28":"code","f49706e4":"code","5e17cbdf":"code","9d411a3a":"code","14539e4d":"code","95d7106f":"code","b7633361":"code","8c115e68":"markdown","e3427660":"markdown","42087ba8":"markdown","15554450":"markdown","a284b408":"markdown"},"source":{"53f60c70":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","5fc42bde":"import numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom matplotlib import style\nstyle.use('fivethirtyeight')\nfrom scipy import stats","494a6ea3":"train = pd.read_csv('\/kaggle\/input\/home-data-for-ml-course\/train.csv')\ntest = pd.read_csv('\/kaggle\/input\/home-data-for-ml-course\/test.csv')\ntrain.head()\ncolumns = train.columns","22dbd86d":"train.shape, test.shape","f1d51e7d":"combi = pd.concat([train, test], sort = False, ignore_index=True)","d22985a7":"combi.tail()","fcfd9995":"num_col = [col for col in combi.columns if combi[col].dtype != 'object']\ncat_col = [col for col in combi.columns if combi[col].dtype == 'object']","a044fc6f":"nan_num = [col for col in num_col if combi[col].isnull().any()]\nnan_num","82e02a51":"combi['LotFrontage'].fillna(combi['LotFrontage'].mean(), inplace = True)\ncombi['MasVnrArea'].fillna(combi['MasVnrArea'].mean(), inplace = True)","399c0d56":"for col in nan_num:\n    if combi[col].isnull().any():\n        combi[col].fillna(0, inplace = True)","9f53e8bc":"for col in cat_col:\n    if combi[col].isnull().any():\n        combi[col].fillna('Missing', inplace = True)","a67951de":"combi[num_col].head()","dd5f039c":"for col in num_col:\n    combi[col] = np.log1p(combi[col])\n       \ncombi.head()","919bb030":"train_hot = combi.iloc[:train.shape[0], 1:-1]\ny = combi.iloc[:train.shape[0], -1]\ntrain_hot.shape, y.shape\ntest_hot = combi.iloc[train.shape[0] : , 1:-1]","d44dba2c":"from sklearn.preprocessing import OneHotEncoder\n\nmyOneHot = OneHotEncoder(handle_unknown= 'ignore', sparse=False)\n\ntrain_OneHot_cat_col = pd.DataFrame(myOneHot.fit_transform(train_hot[cat_col]))\ntest_OneHot_cat_col = pd.DataFrame(myOneHot.transform(test_hot[cat_col]))\n\n# add the index back\ntrain_OneHot_cat_col.index = train_hot.index\ntest_OneHot_cat_col.index = test_hot.index\n\n#remove the object columns \ntrain_hot.drop(cat_col, axis = 1, inplace = True)\ntest_hot.drop(cat_col, axis = 1, inplace = True)\n\n#add the onehot columns to the train, valid and test\ntrain_hot_encoded = pd.concat([train_hot, train_OneHot_cat_col], axis = 1)\ntest_hot_encoded = pd.concat([test_hot, test_OneHot_cat_col], axis = 1)","8402bae3":"train_hot_encoded.shape, test_hot_encoded.shape","8b1e8e69":"# PCA\nfrom sklearn.decomposition import PCA\n\npca = PCA(n_components = 2)\ntrain_hot_encoded_pca = pca.fit_transform(train_hot_encoded)\ntest_hot_encoded_pca = pca.transform(test_hot_encoded)","bcc0f578":"import pandas as pd\nfrom statistics import *\nfrom math import sqrt\nimport numpy as np\nimport seaborn as sns\nfrom sklearn.linear_model import LinearRegression,Ridge, Lasso\nfrom sklearn.model_selection import cross_val_score\nimport matplotlib\n# %pylab inline","a3df9d3b":"train_hot_encoded.head()","89d932d0":"from sklearn.linear_model import LinearRegression, Ridge, Lasso\n\nlin_reg = LinearRegression()\n\nscore = mean(np.sqrt((-cross_val_score(lin_reg, train_hot_encoded_pca, y, scoring='neg_mean_squared_error', cv=10))))\nprint(score)\n\n\n# score = mean(sqrt(-cross_val_score(lin_reg, train_hot_encoded, y, scoring='neg_mean_squared_error', cv=10)))\n# print(score)\n","917ca8b2":"alphas = np.logspace(-5, 2, 20)\nscores = []\n\nfor i in alphas:\n    model_ridge = Ridge(alpha = i)\n    score = mean(np.sqrt(-cross_val_score(model_ridge, train_hot_encoded_pca, y, scoring='neg_mean_squared_error', cv=10 )))\n    scores.append(score)\n    \ndf = pd.DataFrame(list(zip(alphas, scores)), columns = ['alphas', 'scores'])\nmin_score = df['scores'].idxmin()\ndf.iloc[min_score, :]    ","f725cf28":"alphas = np.logspace(-5, 2, 20)\nscores_lass = []\n\nfor i in alphas:\n    model_lass = Lasso(alpha = i)\n    score = mean(np.sqrt(-cross_val_score(model_lass, train_hot_encoded_pca, y, scoring='neg_mean_squared_error', cv=10 )))\n    scores_lass.append(score)\n    \nmin(scores_lass)\n","f49706e4":"df_lasso = pd.DataFrame(list(zip(alphas, scores_lass)), columns = ['alphas', 'scores_lass'])\nmin_score = df_lasso['scores_lass'].idxmin()\ndf_lasso.iloc[min_score, :][0]","5e17cbdf":"model_final = Lasso(alpha = df_lasso.iloc[min_score, :][0])\nmodel_final.fit(train_hot_encoded, y)\nprediction = model_final.predict(test_hot_encoded)\nconverted_prediction = np.expm1(prediction)","9d411a3a":"coef = pd.Series(model_final.coef_, index = train_hot_encoded.columns)\nprint(\"Lasso picked \" + str(sum(coef != 0)) + \" variables and eliminated the other \" +  str(sum(coef == 0)) + \" variables\")","14539e4d":"imp_coef = pd.concat([coef.sort_values().head(10),\n                     coef.sort_values().tail(15)])\n\nmatplotlib.rcParams['figure.figsize'] = (8.0, 10.0)\nimp_coef.plot(kind = \"barh\")\nplt.title(\"Coefficients in the Lasso Model\")","95d7106f":"submission2 = pd.DataFrame({\"Id\" : test['Id'],\n                           'SalePrice': converted_prediction}, index = None)\n\nsubmission2.to_csv('Submission3.csv')","b7633361":"converted_prediction","8c115e68":"MasVnrArea does have a corelation of 0.5 with the Sales price of the house, so will not be dropping them. I will be filling the nan values with mean of MasVnrArea.","e3427660":"One Hot imputing","42087ba8":"> Since the Lasso Regression has the minimum score, we will pick it.","15554450":"Baseline Run - Linear Regression, Ridge and Lasso","a284b408":"Data Normalization > PCA > Lasso regression"}}