{"cell_type":{"93b23173":"code","2257b1cf":"code","ea959560":"code","35174ad8":"code","d6378814":"code","5c61b358":"code","9108c21f":"code","34f2c449":"code","78d089f5":"code","538eea26":"code","e3a49ba5":"code","f4fe5448":"code","52812788":"code","b7f1b236":"code","9b215fdc":"markdown","1a048210":"markdown","da6a3ed4":"markdown","c0b79783":"markdown","fe2ce6f6":"markdown","3f0a0ba0":"markdown","84d454c5":"markdown","98dc2c35":"markdown","89df73a6":"markdown","75b5c36c":"markdown","254ebfe8":"markdown","aeaf52a0":"markdown","9f4ecb6c":"markdown","7c4df59d":"markdown","a4fa8fd7":"markdown","f88396f9":"markdown"},"source":{"93b23173":"import matplotlib.pyplot as plt\nimport pandas as pd\nimport seaborn as sns\nimport numpy as np\nimport scipy as sp","2257b1cf":"data = pd.read_csv(\"..\/input\/BreadBasket_DMS.csv\")\ndata.info()\ndata.head(5)","ea959560":"data[\"DateTime\"] = pd.to_datetime((data.Date + \" \" + data.Time))\ndata.drop(columns=[\"Date\", \"Time\"], inplace=True)","35174ad8":"data[\"DateTime\"].dt.hour.value_counts().sort_index()","d6378814":"data = (data.loc[(data[\"DateTime\"].dt.hour.between(8, 17, inclusive=True))]\n        .reset_index(drop=True))\n\ndata[\"Weekday\"] = data[\"DateTime\"].dt.day_name()\ndata[\"Hour\"] = data[\"DateTime\"].dt.hour","5c61b358":"np.sort(data.Item.unique())","9108c21f":"data.loc[data[\"Item\"]==\"NONE\"].shape[0]","34f2c449":"data.drop(index=data[data[\"Item\"] == \"NONE\"].index, inplace=True)\ndata.reset_index(drop=True, inplace=True)\n\ndata.head(5)","78d089f5":"totsales = data.groupby(data.DateTime.dt.date).Item.count().to_frame()\ntotsales.index = pd.to_datetime(totsales.index)\n\ntotsales.rename(columns={\"Item\":\"ItemsSold\"}, inplace=True)\ntotsales[\"UniqueTrans\"] = data.groupby(data.DateTime.dt.date).Transaction.nunique()\ntotsales[\"ItemsperTrans\"] = totsales.ItemsSold \/ totsales.UniqueTrans\ntotsales[\"Weekday\"] = totsales.index.day_name()\n\ntotsales.head(5)","538eea26":"def subplot_properties(titles):\n    fig = plt.gcf() # get current figure\n    for i, axis in enumerate(fig.axes): # iterate over the axes (subplots) stored in the figure\n        axis.yaxis.grid(True)\n        axis.set_xlabel(\"\")\n        axis.set_ylabel(\"\")\n        sns.despine(ax=axis, left=True, bottom=True)\n        axis.set_title(titles[i], fontweight=\"bold\")\n        plt.sca(axis)\n        plt.yticks(fontweight=\"light\")\n    sns.despine(ax=axis, left=True, bottom=False, offset=15)\n    plt.xticks(fontweight=\"light\")\n    fig.subplots_adjust(hspace=0.25)\n\n%config InlineBackend.figure_format = 'svg'\nsns.set(font=\"sans-serif\", palette=\"deep\", style=\"white\", context=\"notebook\")\n\nfig, ax = plt.subplots(3,1,figsize=(10,8), sharex=True)\n\nax[0].plot(totsales.index, totsales.ItemsSold)\nax[1].plot(totsales.index, totsales.UniqueTrans)\nax[2].plot(totsales.index, totsales.ItemsperTrans)\n\nplottitles = [\"Total Items Sold\", \"Total Transactions\", \"Items Sold per Transaction\"]\nsubplot_properties(plottitles)\n\nplt.show()","e3a49ba5":"totsales.iloc[:,:3].corr()","f4fe5448":"sp.stats.variation(a=totsales.iloc[:,:3])","52812788":"totsales.groupby(\"Weekday\").ItemsSold.mean().to_frame().sort_values(by=\"ItemsSold\", ascending=False)","b7f1b236":"weekdays = [\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\"]\n\nfig, ax = plt.subplots(3, 1, figsize=(10,8), sharex=True)\n\nsns.boxplot(x=\"Weekday\", y=\"ItemsSold\", data=totsales, order=weekdays, ax=ax[0])\nsns.boxplot(x=\"Weekday\", y=\"UniqueTrans\", data=totsales, order=weekdays, ax=ax[1])\nsns.boxplot(x=\"Weekday\", y=\"ItemsperTrans\", data=totsales, order=weekdays, ax=ax[2])\n\nplottitles2 = [i + \" by Weekday\" for i in plottitles]\nsubplot_properties(plottitles2)\n\nplt.show()","9b215fdc":"# Analysing Purchasing Patterns at a Bakery\n\n### Introduction\n\nIn this notebook (my first one, how exciting!) we will look at sales data from a little bakery. It's a pretty straightforward dataset containing each individual item sold at the bakery and the time the sale was made. Further, each sold item is assigned a transaction number, i.e. if you buy two muffins (everyone loves muffins), the dataset will contain two separate entries, both with the same transaction number and date\/time of sale.\n\nAnd that's it. Doesn't sound too exciting? Well, I'll try my best to squeeze as much insight out of this little dataset as possible, so let's get going!\n\n### Importing the Dataset and (light) cleaning\n\nFirst, we import the usual packages:","1a048210":"Our first intution proves correct: Sales and transactions are strongly correlated while sales per transaction are only moderately correlated (with total sales) or virtually uncorrelated (with transactions). What we could, very tentatively, conclude is that these sales spikes we are observing may be driven largely by a higher amount of customers coming to the store and only to a lesser degree by customers buying more items.\n\nFinally, sales and transactions are much more variable (in relative terms) than daily items sold per transaction. Again, we'll try to confirm this by looking at the **coefficient of variation** (standard deviation\/mean):","da6a3ed4":"Next, let's try to find out when this bakery is open for business:","c0b79783":"Weekends have the highest sales volume and number of transactions and also the highest variability in both measures. Items sold per transaction, on the other hand are only slightly higher on the weekend (interesting: Sundays perform best in this measure) and show rather little variability on a by-weekday basis confirming what we already learned from the time series plots. Overall, there are rather few outliers.\n\nOne thing of note is that Sundays see the 2nd highest sales on average, yet based on number of transactions (customers), Sunday performs quite low, almost like a typical workday week. The reason it still is the 2nd best selling weekday is more items per transaction are sold on Sundays for some reason. It would certainly be interesting to find out why this pattern arises, i.e. what does the typical transaction on a Sunday look like?\n\n### Conclusion\n\nWe now have gained a pretty decent understanding of this bakery's sales performance:\n* Sales on the weekend are significantly higher, particularly on Saturdays\n* These increases are probably mostly driven by larger customer volume and only to a lesser degree by larger sales volume per customer\n* Sundays pose a little bit of a mystery: Number of transactions are quite low, but items sold per transaction are quite high.\n\n### What's next?\n\n* Analyzing sales performance on a per-item basis\n* Diving deeper into Sunday sales patterns\n* Answering the following question: If more coffee is bought on any given day, all else being equal, are tea sales going to go down?","fe2ce6f6":"As we see the normalized standard deviations are almost identical for sales and transactions and significantly lower for sales per transaction.","3f0a0ba0":"Looks fine and yummy to me! Except those NONE entries... I wonder how many there are...","84d454c5":"What pops out immediately are the spikes in all three time series happening at regular intervals. This shouldn't be too surprising for a bakery (or most any retail business, really), and we would expect these spikes to ocurr during the weekend (when people generally have more time to shop and dine). We'll investigate this further in a bit!\n\n(Note: There is also a pretty clear negative time trend during the month of November. Unfortunately, we won't be able to determine whether this is random or part of a longer-term (monthly or quarterly) seasonal trend since we lack the data.)\n\nSecond, total sales and total transactions are almost mirror images of each other, while the shape of the graph of items sold per transaction is quite different. Since we don't just want to believe our own lying eyes, let's take a quick glance at the **correlation coefficients**:","98dc2c35":"That is quite a lot (almost 4% of all observations). I'm not really sure what NONE in this context means, but a fair assumption is that these were cancelled sales. In any case let's get rid of them:","89df73a6":"Finally, let's take a look at the actual items sold:","75b5c36c":"### Analyzing Sales by Day of the Week\n\nWe saw some clear periodicity in the data, likely based on particular weekdays. In this section we will investigate further. (Also, this is the reason we included that weekday column in the aggregated data earlier!)\n\nFirst, we'll take a look at total average sales per weekday:","254ebfe8":"That's a pretty large spread. On their strongest weekday this bakery sells about twice as many items as on their weakest day. Note further that their top three days are all on the weekend, with Saturday sporting their highest sales by far.\n\nSince we are now dealing with data grouped by a category (the day of the week), we need a kind of plot that can properly visualize this data. Here we will opt for a **box plot**, which aside from showing us the three middle quantiles also shows us potential outliers in the data. Further, from the size of the box and the location of the median, we can get a rough idea of the shape of the distribution of the data.","aeaf52a0":"### Analysis of daily total sales\n\nNow that our data is whipped into shape, let's get to analyzing. First we will study daily total sales volume. For that the data needs to be aggregated to a daily format. Hence, we will create a second dataframe with the following features:\n\n- Number of items sold per day\n- Number of unique transactions per day\n- Number of items sold per transaction per day\n- Day of the week","9f4ecb6c":"Looks exactly like what we were expecting. No good reason to have the dates and times in separate columns, however, so we'll merge those and convert them to datetime format:","7c4df59d":"Awesome! We now have three time series we can investigate. Obviously, the next step is to plot them to see if there are any interesting patterns. In particular, it would be instructive to know whether there are any time trends and\/or seasonality present in the data.\n\nThe next block of code creates three separate line plots for the three time series:\n\n1. A function is defined to take care of setting some of the plot properties on each subplot\n2. We take advantage of some of the seaborn style and color setting functions to make our plots easier on the eyes\n3. The actual plots are drawn","a4fa8fd7":"It appears like this store usually opens during the 8 o'clock hour and closes around 5 in the afternoon. Anything outside those hours seems to be due to special events or the store opening slightly before 8. In this analysis I'll focus on the main business hours and drop anything outside this range.\n\nAlso, I'll create two extra variables by extracting the day of the week and the hour from the datetime!","f88396f9":"Reading the data and taking a first quick peek at it:"}}