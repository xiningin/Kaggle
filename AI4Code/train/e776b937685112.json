{"cell_type":{"6e054b6e":"code","30bd49f0":"code","dc90f888":"code","2a34b3e4":"code","887e6156":"code","f0875ffe":"code","5d8f5640":"code","127f7388":"code","b6644840":"code","5df489ad":"code","9d989a03":"code","0f5c59d5":"code","44b8fe68":"code","feb82ac9":"code","4eea0a36":"code","7bd46ea9":"code","cc065902":"code","850b591a":"code","970cc1c3":"code","1b136a4d":"code","68f3fbb4":"code","8046d4f9":"code","0d0cf86c":"code","2fccb42d":"code","39fcbc69":"code","91aa9549":"code","633484e8":"code","bb6b6329":"markdown"},"source":{"6e054b6e":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.preprocessing import StandardScaler","30bd49f0":"df=pd.read_csv('..\/input\/breast-cancer-wisconsin-data\/data.csv')\ndf.head()","dc90f888":"df.shape","2a34b3e4":"df.info()","887e6156":"df.isnull().sum()","f0875ffe":"df.drop(['Unnamed: 32','id'],axis=1,inplace=True)","5d8f5640":"df.shape","127f7388":"df.diagnosis.unique()","b6644840":"x=df.drop('diagnosis',axis=1)\nx.head()","5df489ad":"x_scaled=StandardScaler()","9d989a03":"x=pd.DataFrame(x_scaled.fit_transform(x),columns=x.columns)\nx.head()","0f5c59d5":"y=df['diagnosis'].map({'M':0,'B':1}).astype(int)\ny.head()","44b8fe68":"y.unique()","feb82ac9":"x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.3,random_state=1)","4eea0a36":"error_rate=[]\n\nfor i in range(1,40):\n    knn=KNeighborsClassifier(n_neighbors=i)\n    knn.fit(x_train,y_train)\n    pred_i=knn.predict(x_test)\n    error_rate.append(np.mean(pred_i) != y_test)","7bd46ea9":"plt.figure(figsize=(10,6))\nplt.plot(range(1,40),error_rate,marker='o')\nplt.title('K-value vs Error rate')\nplt.xlabel('K-value')\nplt.ylabel('Error rate')\nplt.show()","cc065902":"k=np.arange(1,25)\ntrain_acc=np.empty(len(k))\ntest_acc=np.empty(len(k))\n\nfor i,k in enumerate(k):\n    knn=KNeighborsClassifier(n_neighbors=k)\n    knn.fit(x_train,y_train)\n    train_acc[i]=knn.score(x_train,y_train)\n    test_acc[i]=knn.score(x_test,y_test)","850b591a":"plt.figure(figsize=(12,6))\nj=np.arange(1,25)\nplt.subplot(1,2,1)\nplt.plot(j,train_acc)\nplt.xlabel('K-value')\nplt.ylabel('Train_acc')\nplt.subplot(1,2,2)\nplt.plot(j,test_acc)\nplt.xlabel('K-value')\nplt.ylabel('Test_acc')","970cc1c3":"idx=np.where(test_acc==max(test_acc))\na=j[idx]\na","1b136a4d":"model=KNeighborsClassifier(n_neighbors=2)\nmodel.fit(x_train,y_train)","68f3fbb4":"y_pred=model.predict(x_test)","8046d4f9":"from sklearn.metrics import accuracy_score,confusion_matrix,classification_report","0d0cf86c":"accuracy_score(y_test,y_pred)","2fccb42d":"confusion_matrix(y_test,y_pred)","39fcbc69":"print(classification_report(y_test,y_pred))","91aa9549":"from sklearn.model_selection import cross_val_score","633484e8":"np.mean(cross_val_score(model,x,y,cv=10))","bb6b6329":"### Finding K value"}}