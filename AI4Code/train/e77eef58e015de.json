{"cell_type":{"70f21349":"code","4559b1b3":"code","233a24e3":"code","6fb944ac":"code","c9a8d2d1":"code","22e28e4d":"code","af356240":"code","64a073cb":"code","2eec4f72":"code","0701326a":"code","c2430e82":"code","138f5a00":"code","19698190":"code","e22a3ad3":"code","790ed52a":"code","8bcdf7a6":"code","3dcb1f3d":"code","5f27d2e7":"code","76e09633":"code","f784cbc0":"code","66ff25de":"code","c2219d7b":"code","0fc5da2e":"markdown","fb56f38b":"markdown","ae895cba":"markdown","596b3a34":"markdown","6462b912":"markdown"},"source":{"70f21349":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set(context=\"notebook\", style=\"darkgrid\", palette=\"deep\", font=\"sans-serif\", font_scale=1, color_codes=True)\n","4559b1b3":"data= pd.read_csv(\"..\/input\/covid19-global-forecasting-week-1\/train.csv\")\ndata[\"Date\"] = data[\"Date\"].apply(lambda x: x.replace(\"-\",\"\"))\ndata[\"Date\"]  = data[\"Date\"].astype(int)\n","233a24e3":"data.head()","6fb944ac":"data = data.drop(['Province\/State'],axis=1)\ndata = data.dropna()\ndata.isnull().sum()\n","c9a8d2d1":"test = pd.read_csv(\"..\/input\/covid19-global-forecasting-week-1\/test.csv\")   \ntest[\"Date\"] = test[\"Date\"].apply(lambda x: x.replace(\"-\",\"\"))\ntest[\"Date\"]  = test[\"Date\"].astype(int)\n\ntest[\"Lat\"]  = test[\"Lat\"].fillna(12.5211)\ntest[\"Long\"]  = test[\"Long\"].fillna(69.9683)\ntest.isnull().sum()\n","22e28e4d":"x = data[['Lat', 'Long', 'Date']]\ny1 = data[['ConfirmedCases']]\ny2 = data[['Fatalities']]\nx_test = test[['Lat', 'Long', 'Date']]\n","af356240":"from sklearn.tree import DecisionTreeClassifier\n\nTree_model = DecisionTreeClassifier(random_state=42, criterion='entropy', max_depth=31)","64a073cb":"##\nTree_model.fit(x,y1)\npred1 = Tree_model.predict(x_test)\npred1 = pd.DataFrame(pred1)\npred1.columns = [\"ConfirmedCases_prediction\"]","2eec4f72":"pred1.head()","0701326a":"##\nTree_model.fit(x,y2)\npred2 = Tree_model.predict(x_test)\npred2 = pd.DataFrame(pred2)\npred2.columns = [\"Death_prediction\"]","c2430e82":"pred2.head()","138f5a00":"Sub = pd.read_csv(\"..\/input\/covid19-global-forecasting-week-1\/submission.csv\")\nSub.columns\nsub_new = Sub[[\"ForecastId\"]]","19698190":"OP = pd.concat([pred1,pred2,sub_new],axis=1)\nOP.head()\nOP.columns = ['ConfirmedCases', 'Fatalities', 'ForecastId']\nOP = OP[['ForecastId','ConfirmedCases', 'Fatalities']]\n","e22a3ad3":"OP[\"ConfirmedCases\"] = OP[\"ConfirmedCases\"].astype(int)\nOP[\"Fatalities\"] = OP[\"Fatalities\"].astype(int)\n","790ed52a":"OP.head()","8bcdf7a6":"from sklearn.tree import DecisionTreeRegressor  \n\nregressor = DecisionTreeRegressor(random_state=42, max_depth=31) ","3dcb1f3d":"regressor.fit(x,y1)\npred_r1 = regressor.predict(x_test)\npred_r1 = pd.DataFrame(pred_r1)\npred_r1.columns = [\"ConfirmedCases_prediction\"]\n","5f27d2e7":"regressor.fit(x,y2)\npred_r2 = regressor.predict(x_test)\npred_r2 = pd.DataFrame(pred_r2)\npred_r2.columns = [\"Death_prediction\"]","76e09633":"OP_dr = pd.concat([sub_new,pred_r1,pred_r2],axis=1)\nOP_dr.head()\nOP_dr.columns = [ 'ForecastId','ConfirmedCases', 'Fatalities']\n","f784cbc0":"OP_dr[\"ConfirmedCases\"] = OP_dr[\"ConfirmedCases\"].astype(int)\nOP_dr[\"Fatalities\"] = OP_dr[\"Fatalities\"].astype(int)\nOP_dr.head()\n","66ff25de":"submission = OP.merge(OP_dr, on=\"ForecastId\")\nsubmission['ConfirmedCases'] = 0.5*submission['ConfirmedCases_x'] + 0.5*submission['ConfirmedCases_y']\nsubmission['Fatalities'] = 0.5*submission['Fatalities_x'] + 0.5*submission['Fatalities_y']\nsubmission = submission[['ForecastId', 'ConfirmedCases', 'Fatalities']]\nsubmission.head()","c2219d7b":"submission.to_csv(\"submission.csv\",index=False)","0fc5da2e":"# Predicitons with DecisionTreeRegressor","fb56f38b":"# Ensemble (Baseline)","ae895cba":"# Import Data, Libraries & Data Preprocessing","596b3a34":"# Acknowledgements, Changelogs & Remarks\n\n- Built-upon https:\/\/www.kaggle.com\/yashgoyal401\/less-code-accurate-result-best-predictions\n- Set up simple ensemble\n- Added models","6462b912":"# Predictions with DecisionTreeClassifier"}}