{"cell_type":{"3534a20e":"code","23e96650":"code","e0d435e3":"code","fe264b80":"code","8262113e":"code","1d99e1ce":"code","ed3a4cee":"code","f6118af5":"code","a8a6f947":"code","982ee93b":"markdown","59ee303b":"markdown","c0186744":"markdown","c9f77d20":"markdown","b6575bed":"markdown"},"source":{"3534a20e":"from tensorflow.keras.preprocessing.image import ImageDataGenerator\nimport matplotlib.pyplot as plt\nimport tensorflow_hub as hub\nimport tensorflow as tf\nimport seaborn as sns\nimport pandas as pd\nimport numpy as np\n\nsns.set_theme()\ntf.__version__","23e96650":"labels_df = pd.read_csv('\/kaggle\/input\/dog-breed-identification\/labels.csv')\nlabels_df['id'] = labels_df['id'] + '.jpg'\nlabels_df.breed.value_counts().plot.bar(figsize=(25, 5));","e0d435e3":"datagen = ImageDataGenerator(rescale=1.0 \/ 255,\n                             horizontal_flip=True,\n                             vertical_flip=True,\n                             shear_range=0.2,\n                             validation_split=0.1)\n\ntrain = datagen.flow_from_dataframe(labels_df,\n                                    directory='\/kaggle\/input\/dog-breed-identification\/train',\n                                    x_col='id',\n                                    y_col='breed',\n                                    subset='training',\n                                    target_size=(224, 224),\n                                    batch_size=64,\n                                    seed=123)\n\nval = datagen.flow_from_dataframe(labels_df,\n                                  directory='\/kaggle\/input\/dog-breed-identification\/train',\n                                  x_col='id',\n                                  y_col='breed',\n                                  subset='validation',\n                                  target_size=(224, 224),\n                                  batch_size=64,\n                                  seed=123)","fe264b80":"# Get the images from a val batch\nimgs = val.next()\nlabels = list(val.class_indices.keys())\n\nplt.figure(figsize=(20, 6))\ncols, rows = 15, 4\nfor i in range(cols * rows):\n    plt.subplot(rows, cols, i + 1)\n    plt.imshow(imgs[0][i])\n    plt.title(np.argmax(imgs[1][i]))\n    plt.axis('off')\n\nplt.tight_layout();","8262113e":"url = 'https:\/\/tfhub.dev\/google\/imagenet\/inception_resnet_v2\/classification\/5'\ninception_resnet = tf.keras.Sequential([\n    hub.KerasLayer(url, trainable=False),\n    tf.keras.layers.Dense(120, activation='softmax'),\n])\ninception_resnet.build((None, 224, 224, 3))\ninception_resnet.compile(loss='categorical_crossentropy',\n                         optimizer='adam', metrics=['accuracy'])\nh = inception_resnet.fit(train, validation_data=val, epochs=10,\n                         steps_per_epoch=len(train),\n                         validation_steps=len(val))","1d99e1ce":"test_df = pd.read_csv('\/kaggle\/input\/dog-breed-identification\/sample_submission.csv')\nbreeds = test_df.columns[1:].tolist()\ntest_df['file_name'] = test_df['id'] + '.jpg'","ed3a4cee":"test_gen = ImageDataGenerator(rescale=1.0 \/ 255)\n\ntest = test_gen.flow_from_dataframe(test_df,\n                                    x_col='file_name',\n                                    y_col=None,\n                                    directory='\/kaggle\/input\/dog-breed-identification\/test',\n                                    class_mode=None,\n                                    target=(224, 224))","f6118af5":"# Predict\ntest_df.loc[:, breeds] = inception_resnet.predict(test)\ntest_df[breeds].head()","a8a6f947":"test_df.drop('file_name', axis=1).to_csv('submission.csv', index=False)","982ee93b":"# Import all the Modules","59ee303b":"# Prediction and Submission","c0186744":"<h1>Dog Breed Identification<\/h1>\n\n[https:\/\/www.kaggle.com\/c\/dog-breed-identification](https:\/\/www.kaggle.com\/c\/dog-breed-identification\/)\n\nAuthor: Vaasudevan Srinivasan [(Portfolio)](https:\/\/vaasudevans.github.io) <br>\nCreated on: July 06, 2021 <br>","c9f77d20":"# Data Preparation","b6575bed":"# Transfer Learning using Inception ResNet V2"}}