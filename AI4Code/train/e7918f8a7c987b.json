{"cell_type":{"0d69064d":"code","668fa331":"code","4f4f5f55":"code","d102a561":"code","bd842a23":"code","fee59783":"code","f7a2806b":"code","01f892fc":"code","0b7f03cf":"code","5405a60c":"code","7cf53a44":"code","faec7035":"code","2f5d4e9c":"code","1c1710ed":"code","fa901bf8":"code","5043674d":"code","38432078":"code","05280f56":"code","c9971fde":"code","a57be0f9":"code","00de6f59":"code","155032f1":"code","fcabb0e7":"code","0e5335ac":"code","6aa11b1a":"code","7662ded2":"code","b5e2b6f6":"code","d61fd5a7":"code","b72ddbba":"code","bf2dce51":"code","a63c672a":"code","782d1da1":"code","29d2afc7":"markdown","60732ff4":"markdown","143ffeab":"markdown","1df5b298":"markdown","f67f2be8":"markdown","bdac1c87":"markdown","e706b3d1":"markdown","2b91b184":"markdown"},"source":{"0d69064d":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport pandas as pd\nimport numpy as np\n\nimport plotly.express as px\nimport plotly.graph_objects as go\nimport plotly.figure_factory as ff\nfrom plotly.subplots import make_subplots\n\nimport matplotlib.pyplot as plt\n\nimport seaborn as sns\nfrom pandas_profiling import ProfileReport\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","668fa331":"#Read the Netflix Dataset\ndf= pd.read_csv(\"..\/input\/netflix-shows\/netflix_titles.csv\")\n\n#Print the first 5 row of dataset\ndf.head()","4f4f5f55":"#Show the profilling of the dataset, required pandas_profilling library\nreport = ProfileReport(df)\nreport","d102a561":"#find the missing values in our dataset\ndf.isna().sum()","bd842a23":"#percentage of missing data in columns\nfor i in  df.columns:\n    null_rate = df[i].isna().sum() \/ len(df) * 100 \n    if null_rate > 0 :\n        print(\"{} null rate: {}%\".format(i,round(null_rate,1)))","fee59783":"#change the director & cast value into NoDATA\n#replacement\ndf['cast'].replace(np.nan, 'No Data',inplace  = True)\ndf['director'].replace(np.nan, 'No Data',inplace  = True)\ndf['country'] = df['country'].fillna(df['country'].mode()[0])\n\n# Drops all NAN values\n\ndf.dropna(inplace=True)\n\n# Drop Duplicates values\n\ndf.drop_duplicates(inplace= True)","f7a2806b":"#check the current new values\ndf.isna().sum()\n","01f892fc":"df.info()\n","0b7f03cf":"#get a new column for the year added in the dataframe\ndf[\"date_added\"] = pd.to_datetime(df['date_added'])\n\ndf['month_added']=df['date_added'].dt.month\ndf['month_name_added']=df['date_added'].dt.month_name()\ndf['year_added'] = df['date_added'].dt.year\n\ndf.head(3)","5405a60c":"#create a filter for the rating column\nratings_ages = {\n    'TV-PG': 'Older Kids',\n    'TV-MA': 'Adults',\n    'TV-Y7-FV': 'Older Kids',\n    'TV-Y7': 'Older Kids',\n    'TV-14': 'Teens',\n    'R': 'Adults',\n    'TV-Y': 'Kids',\n    'NR': 'Adults',\n    'PG-13': 'Teens',\n    'TV-G': 'Kids',\n    'PG': 'Older Kids',\n    'G': 'Kids',\n    'UR': 'Adults',\n    'NC-17': 'Adults'\n}\n","7cf53a44":"df['target_ages'] = df['rating'].replace(ratings_ages)\ndf['target_ages'].unique()","faec7035":"# Lets retrieve just the first country (fixing up the countries with multiple values)\ndf['principal_country'] = df['country'].apply(lambda x: x.split(\",\")[0])\ndf['principal_country'].head()","2f5d4e9c":"df.dtypes","1c1710ed":"#the type column should be a categorical type\ndf['type'] = pd.Categorical(df['type'])\n\n# target_ages is another category (4 classes)\ndf['target_ages'] = pd.Categorical(df['target_ages'], categories=['Kids', 'Older Kids', 'Teens', 'Adults'])\ndf.dtypes\n","fa901bf8":"df['genre'] = df['listed_in'].apply(lambda x :  x.replace(' ,',',').replace(', ',',').split(',')) \ndf['genre'].head()","5043674d":"df.head()","38432078":"#create movie & show dataframe\nmovie_df = df[df['type'] == 'Movie']\nshow_df = df[df['type'] == 'TV Show']\n","05280f56":"\nfig = px.pie(df['type'].value_counts().reset_index(), values='type', names='index')\nfig.update_traces(textposition='inside', textinfo='percent+label')\nfig.show()","c9971fde":"def defineRating(df):\n    rating_df = df.groupby(['rating', 'target_ages']).agg({'show_id': 'count'}).reset_index()\n    rating_df = rating_df[rating_df['show_id'] != 0]\n    rating_df.columns = ['rating', 'target_ages', 'counts']\n    rating_df = rating_df.sort_values('target_ages')\n    return rating_df","a57be0f9":"#we can use the syntax 'counts' to fill the y parameter\nrating_df = defineRating(df)\nfig = px.bar(rating_df, x='rating', y='counts', color='target_ages')\nfig.show()","00de6f59":"#generate rating  by TYPE\nmovie_rating_df = defineRating(movie_df)\nshow_rating_df = defineRating(show_df)\n\nfig = make_subplots(rows=1, cols=2, specs=[[{\"type\": \"pie\"}, {\"type\": \"pie\"}]])\n\nfig.add_trace(\n    go.Pie(labels=movie_rating_df['target_ages'], values=movie_rating_df['counts']),\n    row=1, col=1\n)\n\nfig.add_trace(\n    go.Pie(labels=show_rating_df['target_ages'], values=show_rating_df['counts']),\n    row=1, col=2\n)\n\nfig.update_traces(textposition='inside', hole=.4, hoverinfo=\"label+percent+name\")\nfig.update_layout(\n    title_text=\"Rating distribution by Type of content\",\n    # Add annotations in the center of the donut pies.\n    annotations=[dict(text='Movies', x=0.16, y=0.5, font_size=12, showarrow=False),\n                 dict(text='TV Shows', x=0.82, y=0.5, font_size=12, showarrow=False)])\nfig.show()","155032f1":"fig = px.histogram(df, x='principal_country')\nfig.update_xaxes(categoryorder='total descending')\nfig.show()","fcabb0e7":"released_year_df = df.loc[df['release_year'] > 2010].groupby(['release_year', 'type']).agg({'show_id': 'count'}).reset_index()\nadded_year_df = df.loc[df['year_added'] > 2010].groupby(['year_added', 'type']).agg({'show_id': 'count'}).reset_index()\n\nfig = go.Figure()\nfig.add_trace(go.Scatter( \n    x=released_year_df.loc[released_year_df['type'] == 'Movie']['release_year'], \n    y=released_year_df.loc[released_year_df['type'] == 'Movie']['show_id'],\n    mode='lines+markers',\n    name='Movie: Released Year',\n    marker_color='blue',\n))\nfig.add_trace(go.Scatter( \n    x=released_year_df.loc[released_year_df['type'] == 'TV Show']['release_year'], \n    y=released_year_df.loc[released_year_df['type'] == 'TV Show']['show_id'],\n    mode='lines+markers',\n    name='TV Show: Released Year',\n    marker_color='darkblue',\n))\nfig.add_trace(go.Scatter( \n    x=added_year_df.loc[added_year_df['type'] == 'Movie']['year_added'], \n    y=added_year_df.loc[added_year_df['type'] == 'Movie']['show_id'],\n    mode='lines+markers',\n    name='Movie: Year Added',\n    marker_color='orange',\n))\nfig.add_trace(go.Scatter( \n    x=added_year_df.loc[added_year_df['type'] == 'TV Show']['year_added'], \n    y=added_year_df.loc[added_year_df['type'] == 'TV Show']['show_id'],\n    mode='lines+markers',\n    name='TV Show: Year Added',\n    marker_color='darkorange',\n))\nfig.update_xaxes(categoryorder='total descending')\nfig.show()","0e5335ac":"from sklearn.preprocessing import MultiLabelBinarizer \n","6aa11b1a":"def calculate_mlb(series):\n    mlb = MultiLabelBinarizer()\n    mlb_df = pd.DataFrame(mlb.fit_transform(series), columns=mlb.classes_, index=series.index)\n    return mlb_df","7662ded2":"def top_genres(df, title='Top ones'):\n    genres_df = calculate_mlb(df['genre'])\n    tdata = genres_df.sum().sort_values(ascending=False)\n    \n    fig = go.Figure()\n    fig.add_trace(go.Bar(\n        x=tdata.index,\n        y=tdata.values,\n    ))\n    fig.update_xaxes(categoryorder='total descending')\n    fig.update_layout(title=title)\n    fig.show()","b5e2b6f6":"top_genres(movie_df, title='Top Movies Genres')\n","d61fd5a7":"top_genres(show_df, title='Top TV Shows Genres')","b72ddbba":"#create a filter to sort out the duration\nsplit_duration = movie_df['duration'].apply(lambda x: int(x.split(' ')[0]))","bf2dce51":"movie_df.loc[split_duration.loc[split_duration < 60].index, 'duration_bin'] = '<60 Min'\nmovie_df.loc[split_duration.loc[(split_duration >= 60) & (split_duration < 120)].index, 'duration_bin'] = '60 - 120 Min'\nmovie_df.loc[split_duration.loc[split_duration >= 120].index, 'duration_bin'] = '>120 Min'","a63c672a":"movie_df.head()\n","782d1da1":"fig = px.histogram(x=movie_df['duration_bin'], color=movie_df['duration_bin'])\nfig.update_xaxes(categoryorder = \"array\",\n                categoryarray = ['<60 min', '60 - 120 Min', '>120 Min'],\n                )\nfig.update_layout(\n    title=\"Distribution of movies duration\",\n    xaxis_title=\"Duration of the Movies\",\n)\nfig.show()","29d2afc7":"I will use the Netflix Dataset to show the visualization, note that this is a simple practice, and a first step for me to dive into the Data Science, all feedbacks are most welcome, thank you and happy learning.\n\nthis practice methods are heavily inspired by:\n[ANDRESHG](https:\/\/www.kaggle.com\/andreshg\/eda-beginner-to-expert-plotly#Genres-Analysis)\n&\n[JOSH](https:\/\/www.kaggle.com\/joshuaswords\/netflix-data-visualization#Dealing-with-the-missing-data)","60732ff4":"now that there's no missing data in the values anymore, we can begin our visualizaing process.","143ffeab":"# ****NOW WE CAN FIX THE DATA TYPES****","1df5b298":"**Duration Analyze**\nlet's try to divide the duration onto 3 categories\n* <60 Min\n* 60 Min - 120 Min\n* .>120 Min","f67f2be8":"****Analysis of the genres****","bdac1c87":"Thank you for reading and following along","e706b3d1":"above the cell show the missing values from the DataFrame,\nwith this information we gathered, we can begin our cleaning process.\n","2b91b184":"# Lets visualize"}}