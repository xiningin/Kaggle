{"cell_type":{"55da127b":"code","682f7234":"code","40b09947":"code","0a80a4c5":"code","dff3b8f7":"code","89f6023b":"code","17cb0169":"code","df32b96b":"code","d62422b2":"code","2ed1cc07":"code","c81e2343":"code","d60bff6d":"code","9c50dbe0":"code","3ff8685b":"code","cae84e84":"code","cff927d5":"code","dc008464":"code","b91c0f5e":"code","58db5ac2":"code","303d90e6":"code","558df5eb":"markdown","431b3935":"markdown","d21cc6c0":"markdown","ed269f49":"markdown","65f4b83c":"markdown","df52b63c":"markdown","73859b5d":"markdown","ac5cf04c":"markdown","de71ef62":"markdown","f0ece717":"markdown","6dc6b04d":"markdown","baf6cce4":"markdown","e4928875":"markdown","bcab51c5":"markdown","0a15ffc5":"markdown","692a769f":"markdown","dc447464":"markdown","10d05b06":"markdown","7270806f":"markdown"},"source":{"55da127b":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\n\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.decomposition import PCA\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.svm import LinearSVC\nfrom sklearn.model_selection import cross_val_score, train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.neural_network import MLPClassifier\n\nimport xgboost as xgb\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\nimport os\nos.listdir('..\/input')\n","682f7234":"brainwave_df = pd.read_csv('..\/input\/emotions.csv')","40b09947":"brainwave_df.head()","0a80a4c5":"brainwave_df.tail()","dff3b8f7":"brainwave_df.shape","89f6023b":"brainwave_df.dtypes","17cb0169":"brainwave_df.describe()","df32b96b":"plt.figure(figsize=(12,5))\nsns.countplot(x=brainwave_df.label, color='mediumseagreen')\nplt.title('Emotional sentiment class distribution', fontsize=16)\nplt.ylabel('Class Counts', fontsize=16)\nplt.xlabel('Class Label', fontsize=16)\nplt.xticks(rotation='vertical');","d62422b2":"label_df = brainwave_df['label']\nbrainwave_df.drop('label', axis = 1, inplace=True)","2ed1cc07":"correlations = brainwave_df.corr(method='pearson')\ncorrelations","c81e2343":"skew = brainwave_df.skew()\nskew","d60bff6d":"%%time\n\npl_random_forest = Pipeline(steps=[('random_forest', RandomForestClassifier())])\nscores = cross_val_score(pl_random_forest, brainwave_df, label_df, cv=10,scoring='accuracy')\nprint('Accuracy for RandomForest : ', scores.mean())","9c50dbe0":"%%time\n\npl_log_reg = Pipeline(steps=[('scaler',StandardScaler()),\n                             ('log_reg', LogisticRegression(multi_class='multinomial', solver='saga', max_iter=200))])\nscores = cross_val_score(pl_log_reg, brainwave_df, label_df, cv=10,scoring='accuracy')\nprint('Accuracy for Logistic Regression: ', scores.mean())","3ff8685b":"scaler = StandardScaler()\nscaled_df = scaler.fit_transform(brainwave_df)\npca = PCA(n_components = 20)\npca_vectors = pca.fit_transform(scaled_df)\nfor index, var in enumerate(pca.explained_variance_ratio_):\n    print(\"Explained Variance ratio by Principal Component \", (index+1), \" : \", var)\n","cae84e84":"plt.figure(figsize=(25,8))\nsns.scatterplot(x=pca_vectors[:, 0], y=pca_vectors[:, 1], hue=label_df)\nplt.title('Principal Components vs Class distribution', fontsize=16)\nplt.ylabel('Principal Component 2', fontsize=16)\nplt.xlabel('Principal Component 1', fontsize=16)\nplt.xticks(rotation='vertical');","cff927d5":"%%time\npl_log_reg_pca = Pipeline(steps=[('scaler',StandardScaler()),\n                             ('pca', PCA(n_components = 2)),\n                             ('log_reg', LogisticRegression(multi_class='multinomial', solver='saga', max_iter=200))])\nscores = cross_val_score(pl_log_reg_pca, brainwave_df, label_df, cv=10,scoring='accuracy')\nprint('Accuracy for Logistic Regression with 2 Principal Components: ', scores.mean())","dc008464":"%%time\n\npl_log_reg_pca_10 = Pipeline(steps=[('scaler',StandardScaler()),\n                             ('pca', PCA(n_components = 10)),\n                             ('log_reg', LogisticRegression(multi_class='multinomial', solver='saga', max_iter=200))])\nscores = cross_val_score(pl_log_reg_pca_10, brainwave_df, label_df, cv=10,scoring='accuracy')\nprint('Accuracy for Logistic Regression with 10 Principal Components: ', scores.mean())","b91c0f5e":"%%time\n\npl_mlp = Pipeline(steps=[('scaler',StandardScaler()),\n                             ('mlp_ann', MLPClassifier(hidden_layer_sizes=(1275, 637)))])\nscores = cross_val_score(pl_mlp, brainwave_df, label_df, cv=10,scoring='accuracy')\nprint('Accuracy for ANN : ', scores.mean())","58db5ac2":"%%time\n\npl_svm = Pipeline(steps=[('scaler',StandardScaler()),\n                             ('pl_svm', LinearSVC())])\nscores = cross_val_score(pl_svm, brainwave_df, label_df, cv=10,scoring='accuracy')\nprint('Accuracy for Linear SVM : ', scores.mean())","303d90e6":"%%time\npl_xgb = Pipeline(steps=\n                  [('xgboost', xgb.XGBClassifier(objective='multi:softmax'))])\nscores = cross_val_score(pl_xgb, brainwave_df, label_df, cv=10)\nprint('Accuracy for XGBoost Classifier : ', scores.mean())","558df5eb":"<h2 style=\"text-align:center; color:#546545;text-shadow: 2px 2px 4px #000000;\">Logistic Regression Classifier<\/h2>\n\n`Logistic Regression` is a linear classifier and works in same way as linear regression.","431b3935":"<h2 style=\"text-align:center; color:#546545;text-shadow: 2px 2px 4px #000000;\"> A comparison of different classifiers\u2019 accuracy & performance for high-dimensional data<\/h2>","d21cc6c0":"<h2 style=\"text-align:center; color:#546545;text-shadow: 2px 2px 4px #000000;\">Data Type For Each Attribute<\/h2>","ed269f49":"<h2 style=\"text-align:center; color:#546545;text-shadow: 2px 2px 4px #000000;\">Peek of Data<\/h2>","65f4b83c":"<h2 style=\"text-align:center; color:#546545;text-shadow: 2px 2px 4px #000000;\">Skew of Univariate Distributions<\/h2>","df52b63c":"<h2 style=\"text-align:center; color:#546545;text-shadow: 2px 2px 4px #000000;\">Extreme Gradient Boosting Classifier (XGBoost)<\/h2>\n\nXGBoost is a boosted tree based ensemble classifier. Like \u2018RandomForest\u2019, it will also automatically reduce the feature set. ","73859b5d":"<h2 style=\"text-align:center; color:#546545;text-shadow: 2px 2px 4px #000000;\">Problem formulation<\/h2>\n\nThe **EEG Brainwave Dataset** contains electronic brainwave signals from an EEG headset and is in temporal format.\n\nThe challenge is: **Can we predict emotional sentiment from brainwave readings?**","ac5cf04c":"<h2 style=\"text-align:center; color:#546545;text-shadow: 2px 2px 4px #000000;\">Import Packages<\/h2>","de71ef62":"<h2 style=\"text-align:center; color:#546545;text-shadow: 2px 2px 4px #000000;\">Take all 10 PCs<\/h2>","f0ece717":"<h2 style=\"text-align:center; color:#546545;text-shadow: 2px 2px 4px #000000;\">Class Distribution<\/h2>","6dc6b04d":"<h2 style=\"text-align:center; color:#546545;text-shadow: 2px 2px 4px #000000;\">RandomForest Classifier<\/h2>\n\n`RandomForest` is a tree & bagging approach-based ensemble classifier. It will automatically reduce the number of features by its probabilistic entropy calculation approach.","baf6cce4":"<h2 style=\"text-align:center; color:#546545;text-shadow: 2px 2px 4px #000000;\">Tail of Data<\/h2>","e4928875":"<h2 style=\"text-align:center; color:#546545;text-shadow: 2px 2px 4px #000000;\">Descriptive Statistics<\/h2>","bcab51c5":"<h2 style=\"text-align:center; color:#546545;text-shadow: 2px 2px 4px #000000;\">Correlation Between Attributes<\/h2>\nCorrelation refers to the relationship between two variables and how they may or may not change together.\n\nThe most common method for calculating correlation is [Pearson\u2019s Correlation Coefficient](https:\/\/en.wikipedia.org\/wiki\/Pearson_product-moment_correlation_coefficient), that assumes a normal distribution of the attributes involved. A correlation of -1 or 1 shows a full negative or positive correlation respectively. Whereas a value of 0 shows no correlation at all.","0a15ffc5":"<h2 style=\"text-align:center; color:#546545;text-shadow: 2px 2px 4px #000000;\">Linear Support Vector Machines Classifier (SVM)<\/h2>","692a769f":"<h2 style=\"text-align:center; color:#546545;text-shadow: 2px 2px 4px #000000;\">Artificial Neural Network Classifier (ANN)<\/h2>\n\nAn ANN classifier is non-linear with automatic feature engineering and dimensional reduction techniques. `MLPClassifier` in scikit-learn works as an ANN. But here also, basic scaling is required for the data.[](http:\/\/)","dc447464":"<h2 style=\"text-align:center; color:#546545;text-shadow: 2px 2px 4px #000000;\">Principal Component Analysis (PCA)<\/h2>\n\nPCA can transform original low level variables to a higher dimensional space and thus reduce the number of required variables. All co-linear variables get clubbed together. ","10d05b06":"<h2 style=\"text-align:center; color:#546545;text-shadow: 2px 2px 4px #000000;\">Logistic Regression classifier with these two PCs<\/h2>","7270806f":"<h2 style=\"text-align:center; color:#546545;text-shadow: 2px 2px 4px #000000;\">Dimensions of Data"}}