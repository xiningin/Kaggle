{"cell_type":{"d5e071d3":"code","7a7fe174":"code","244d5f9a":"code","d2974edc":"code","c70f56e2":"code","5d32d9d5":"code","58fc9a55":"code","691930b1":"code","d771d5f7":"code","14160900":"code","15d616d4":"code","2800ec04":"code","f6553fc9":"code","6f9a73aa":"code","5e282888":"code","60abfcc8":"code","72902007":"code","953632fb":"code","8b4e4620":"code","df260ae6":"code","b07f5af4":"code","dadcdd97":"code","a9d568e5":"code","9eef47c2":"code","befdb4ea":"code","ec86a2b2":"code","bde0c6e6":"code","7e944b46":"code","45304399":"code","2f0f1f28":"code","3ad5e5b2":"code","ff4b5824":"code","d88cf576":"code","0da9a064":"code","a4f7dd69":"code","77a177d6":"code","5d5af7a1":"code","42b9df0c":"markdown","6d463873":"markdown","635b5a50":"markdown","2ddcfcc1":"markdown","ab8b9add":"markdown","7b99c9a3":"markdown","8142d418":"markdown","89763dfc":"markdown","9c967be9":"markdown","36b332b2":"markdown","c5cd1df1":"markdown","ab41f13f":"markdown"},"source":{"d5e071d3":"import pandas as pd","7a7fe174":"npr = pd.read_csv('..\/input\/npr-data\/npr.csv')","244d5f9a":"npr.head()","d2974edc":"from sklearn.feature_extraction.text import CountVectorizer","c70f56e2":"cv = CountVectorizer(max_df=0.95, min_df=2, stop_words='english')","5d32d9d5":"dtm = cv.fit_transform(npr['Article'])","58fc9a55":"dtm","691930b1":"from sklearn.decomposition import LatentDirichletAllocation","d771d5f7":"LDA = LatentDirichletAllocation(n_components=7,random_state=42)","14160900":"# This can take awhile, we're dealing with a large amount of documents!\nLDA.fit(dtm)","15d616d4":"len(cv.get_feature_names())","2800ec04":"import random","f6553fc9":"for i in range(10):\n    random_word_id = random.randint(0,54776)\n    print(cv.get_feature_names()[random_word_id])","6f9a73aa":"for i in range(10):\n    random_word_id = random.randint(0,54776)\n    print(cv.get_feature_names()[random_word_id])","5e282888":"len(LDA.components_)","60abfcc8":"LDA.components_","72902007":"len(LDA.components_[0])","953632fb":"single_topic = LDA.components_[0]","8b4e4620":"# Returns the indices that would sort this array.\nsingle_topic.argsort()","df260ae6":"# Word least representative of this topic\nsingle_topic[18302]","b07f5af4":"# Word most representative of this topic\nsingle_topic[42993]","dadcdd97":"# Top 10 words for this topic:\nsingle_topic.argsort()[-10:]","a9d568e5":"top_word_indices = single_topic.argsort()[-10:]","9eef47c2":"for index in top_word_indices:\n    print(cv.get_feature_names()[index])","befdb4ea":"for index,topic in enumerate(LDA.components_):\n    print(f'THE TOP 15 WORDS FOR TOPIC #{index}')\n    print([cv.get_feature_names()[i] for i in topic.argsort()[-15:]])\n    print('\\n')","ec86a2b2":"dtm","bde0c6e6":"dtm.shape","7e944b46":"len(npr)","45304399":"topic_results = LDA.transform(dtm)","2f0f1f28":"topic_results.shape","3ad5e5b2":"topic_results[0]","ff4b5824":"topic_results[0].round(2)","d88cf576":"topic_results[0].argmax()","0da9a064":"npr.head()","a4f7dd69":"topic_results.argmax(axis=1)","77a177d6":"npr['Topic'] = topic_results.argmax(axis=1)","5d5af7a1":"npr.head(10)","42b9df0c":"# Latent Dirichlet Allocation","6d463873":"### Combining with Original Data","635b5a50":"**`max_df`**` : float in range [0.0, 1.0] or int, default=1.0`<br>\nWhen building the vocabulary ignore terms that have a document frequency strictly higher than the given threshold (corpus-specific stop words). If float, the parameter represents a proportion of documents, integer absolute counts. This parameter is ignored if vocabulary is not None.\n\n**`min_df`**` : float in range [0.0, 1.0] or int, default=1`<br>\nWhen building the vocabulary ignore terms that have a document frequency strictly lower than the given threshold. This value is also called cut-off in the literature. If float, the parameter represents a proportion of documents, integer absolute counts. This parameter is ignored if vocabulary is not None.","2ddcfcc1":"Notice how we don't have the topic of the articles! Let's use LDA to attempt to figure out clusters of the articles.","ab8b9add":"## Preprocessing","7b99c9a3":"## Showing Stored Words","8142d418":"### Showing Top Words Per Topic","89763dfc":"These look like business articles perhaps... Let's confirm by using .transform() on our vectorized articles to attach a label number. But first, let's view all the 10 topics found.","9c967be9":"## Data\n\nWe will be using articles from NPR (National Public Radio), obtained from their website [www.npr.org](http:\/\/www.npr.org)","36b332b2":"This means that our model thinks that the first article belongs to topic #1.","c5cd1df1":"## LDA","ab41f13f":"### Attaching Discovered Topic Labels to Original Articles"}}