{"cell_type":{"c86b612d":"code","fe996921":"code","f31ab1ed":"code","dd502d9b":"code","b14cca89":"code","41c9fc26":"code","55f0a574":"code","f59c4137":"code","e9b0fb74":"code","8cc28281":"code","9a6efa39":"code","b23c532c":"markdown","6db90f48":"markdown","b9beaa07":"markdown","688b0ece":"markdown","6723f911":"markdown","b05d96be":"markdown","3bd41ea2":"markdown","3e901fce":"markdown","11bc535f":"markdown","4734a155":"markdown"},"source":{"c86b612d":"!pip install apyori\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nfrom apyori import apriori\n%matplotlib inline\nimport os\nprint(os.listdir(\"..\/input\"))","fe996921":"lastfm1 = pd.read_csv(\"https:\/\/www.biz.uiowa.edu\/faculty\/jledolter\/DataMining\/lastfm.csv\")","f31ab1ed":"lastfm = lastfm1.copy()\nlastfm.shape","dd502d9b":"lastfm = lastfm[['user','artist']]","b14cca89":"lastfm = lastfm.drop_duplicates()\nlastfm.shape","41c9fc26":"records = []\nfor i in lastfm['user'].unique():\n    records.append(list(lastfm[lastfm['user'] == i]['artist'].values))","55f0a574":"print(type(records))","f59c4137":"association_rules = apriori(records, min_support=0.01, min_confidence=0.4, min_lift=3, min_length=2)\nassociation_results = list(association_rules)","e9b0fb74":"print(\"There are {} Relation derived.\".format(len(association_results)))","8cc28281":"for i in range(0, len(association_results)):\n    print(association_results[i][0])","9a6efa39":"for item in association_results:\n    # first index of the inner list\n    # Contains base item and add item\n    pair = item[0]\n    items = [x for x in pair]\n    print(\"Rule: With \" + items[0] + \" you can also listen \" + items[1])\n\n    # second index of the inner list\n    print(\"Support: \" + str(item[1]))\n\n    # third index of the list located at 0th\n    # of the third index of the inner list\n\n    print(\"Confidence: \" + str(item[2][0][2]))\n    print(\"Lift: \" + str(item[2][0][3]))\n    print(\"=====================================\")","b23c532c":"### 6.Transform Dataset into form of Transaction into list <span id=\"6\"><\/span>","6db90f48":"### 2.Load Dataset <span id=\"2\"> <\/span>","b9beaa07":"### 1.Import Required Packages <h2 id=\"1\"> <\/h2>","688b0ece":"### 3.Generate Shallow Copy<span id=\"3\"><\/span>","6723f911":"# Association Rule Mining of Last FM\n\n* Datatset : https:\/\/www.biz.uiowa.edu\/faculty\/jledolter\/DataMining\/lastfm.csv\n* We have total Transaction : **289955**\n* We have library(apyori) to calculate the association rule using Apriori.\n\n> Requirement : `# pip install apyori`\n\n---\nNotebook outline\n---\n1. <b><a href=\"#1\">Import Required Packages<\/a><\/b>\n1. <b><a href=\"#2\">Load Dataset<\/a><\/b>\n1. <b><a href=\"#3\">Generate Shallow Copy<\/a><\/b>\n1. <b><a href=\"#4\">Differentiate Data and Extract useful columns<\/a><\/b>\n1. <b><a href=\"#5\">Drop Duplicate Data<\/a><\/b>\n1. <b><a href=\"#6\">Transform Dataset into form of Transaction into list<\/a><\/b>\n1. <b><a href=\"#7\">Generate Rule using Apriori Algorithm<\/a><\/b>\n1. <b><a href=\"#8\">Display All Rules<\/a><\/b>\n1. <b><a href=\"#9\">Final Result with Support, Confidense and Lift<\/a><\/b>\n\n---\n## Algorithm Explaination:\n---\n\n* We have provide `min_support`, `min_confidence`, `min_lift`, and `min length` of sample-set for find rule.\n\n#### Measure 1: Support.\nThis says how popular an itemset is, as measured by the proportion of transactions in which an itemset appears. In Table 1 below, the support of {apple} is 4 out of 8, or 50%. Itemsets can also contain multiple items. For instance, the support of {apple, beer, rice} is 2 out of 8, or 25%.\n\n![](https:\/\/annalyzin.files.wordpress.com\/2016\/04\/association-rule-support-table.png?w=503&h=447)\n\nIf you discover that sales of items beyond a certain proportion tend to have a significant impact on your profits, you might consider using that proportion as your support threshold. You may then identify itemsets with support values above this threshold as significant itemsets.\n\n#### Measure 2: Confidence. \nThis says how likely item Y is purchased when item X is purchased, expressed as {X -> Y}. This is measured by the proportion of transactions with item X, in which item Y also appears. In Table 1, the confidence of {apple -> beer} is 3 out of 4, or 75%.\n\n![](https:\/\/annalyzin.files.wordpress.com\/2016\/03\/association-rule-confidence-eqn.png?w=527&h=77)\n\nOne drawback of the confidence measure is that it might misrepresent the importance of an association. This is because it only accounts for how popular apples are, but not beers. If beers are also very popular in general, there will be a higher chance that a transaction containing apples will also contain beers, thus inflating the confidence measure. To account for the base popularity of both constituent items, we use a third measure called lift.\n\n#### Measure 3: Lift. \nThis says how likely item Y is purchased when item X is purchased, while controlling for how popular item Y is. In Table 1, the lift of {apple -> beer} is 1,which implies no association between items. A lift value greater than 1 means that item Y is likely to be bought if item X is bought, while a value less than 1 means that item Y is unlikely to be bought if item X is bought.\n![](https:\/\/annalyzin.files.wordpress.com\/2016\/03\/association-rule-lift-eqn.png?w=566&h=80)\n\n---","b05d96be":"### 4.Differentiate Data and Extract useful columns <span id=\"4\"><\/span>","3bd41ea2":"### 8.Display All Rules<span id=\"8\"><\/span>","3e901fce":"### 9.Final Result with Support, Confidense and Lift <span id=\"9\"><\/span>","11bc535f":"### 7.Generate Rule using Apriori Algorithm <span id=\"7\"><\/span>","4734a155":"### 5.Drop Duplicate Data <span id=\"5\"><\/span>"}}