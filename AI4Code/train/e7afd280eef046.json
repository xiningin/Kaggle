{"cell_type":{"f3733f72":"code","26444595":"code","fcbdfe60":"code","17f59b9b":"code","8904b970":"code","13bf2955":"code","63290987":"code","92d5015e":"code","60c2e3f5":"code","4ba56036":"code","fca5dcee":"code","978cf7bf":"code","a50b2889":"code","8ba8573d":"code","51b1f9f7":"code","b4f3a7ce":"code","57c70f26":"code","deab9d0f":"code","3d7d4424":"code","68300663":"code","d5f2e774":"code","6531c163":"code","5f950e35":"markdown","96016038":"markdown","f26636f1":"markdown","b35317d4":"markdown","8099dcac":"markdown","463a1e27":"markdown"},"source":{"f3733f72":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.preprocessing import StandardScaler\nimport tensorflow as tf\nfrom tensorflow import keras\nfrom tensorflow.keras import callbacks, layers\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","26444595":"df_train=pd.read_csv('..\/input\/birth-weight-prediction\/baby-weights-dataset.csv')\ndf_test=pd.read_csv('..\/input\/birth-weight-prediction\/judge-without-labels.csv')","fcbdfe60":"for cols in df_train.columns:\n    if(df_train[cols].isnull().sum()>0):\n        print(f'{cols}',df_train[cols].isnull().sum())","17f59b9b":"df_train=df_train.dropna()","8904b970":"df_train.describe()","13bf2955":"for cols in df_train.columns:\n    if(df_train[cols].dtype=='object'):\n        print(cols)","63290987":"his_tr=pd.get_dummies(df_train[['HISPMOM','HISPDAD']])\nhis_te=pd.get_dummies(df_test[['HISPMOM','HISPDAD']])","92d5015e":"df_train= df_train.drop(['HISPMOM','HISPDAD'],axis=1)\ndf_test= df_test.drop(['HISPMOM','HISPDAD'],axis=1)","60c2e3f5":"df_train","4ba56036":"df_train=pd.concat([df_train,his_tr],axis=1)\ndf_test=pd.concat([df_test,his_te],axis=1)","fca5dcee":"df_test['HISPDAD_O']=0","978cf7bf":"sns.set_style('darkgrid')\nsns.displot(data=df_train,x='FAGE',kde=True, aspect=10\/7)","a50b2889":"train_fea=df_train.drop(['ID','BWEIGHT'],axis=1).columns","8ba8573d":"sc=StandardScaler()\ntr_scaled=sc.fit_transform(df_train.drop(['ID','BWEIGHT'],axis=1))\nte_scaled=sc.fit_transform(df_test[train_fea])","51b1f9f7":"tr_scaled=pd.DataFrame(tr_scaled,columns=train_fea)\nte_scaled=pd.DataFrame(te_scaled,columns=train_fea)","b4f3a7ce":"from sklearn.model_selection import train_test_split\nxtr,xval,ytr,yval=train_test_split(tr_scaled,df_train['BWEIGHT'],random_state=108,test_size=0.3)","57c70f26":"model=keras.Sequential([\n    layers.Dense(units=94,input_shape=(47,),activation='relu'),\n    layers.BatchNormalization(),\n    layers.Dropout(0.3),\n    layers.Dense(units=198,activation='relu'),\n    layers.Dropout(0.3),  \n    layers.Dense(units=396,activation='relu'),\n    layers.Dropout(0.3),  \n    layers.Dense(units=796,activation='relu'),\n    layers.BatchNormalization(),\n    layers.Dropout(0.3),\n    layers.Dense(units=1496,activation='relu'),\n    layers.BatchNormalization(),\n    layers.Dropout(0.3),  \n    layers.Dense(units=396,activation='relu'),\n    layers.Dropout(0.3),  \n    layers.Dense(1,activation='relu')\n])\nadamax=keras.optimizers.Adamax(\n    learning_rate=0.00098, beta_1=0.93, beta_2=0.967, epsilon=1e-07,\n    name='Adamax')\nrmse=keras.metrics.RootMeanSquaredError(\n    name='root_mean_squared_error', dtype=None)\nmodel.compile(optimizer=adamax,loss='mean_squared_error',metrics=[rmse,'accuracy'])\ncall=callbacks.EarlyStopping(patience=10,restore_best_weights=True,min_delta=0.0001)\nhistory=model.fit(xtr,ytr,validation_data=(xval,yval),callbacks=[call],batch_size=36,epochs=50)","deab9d0f":"ypred=model.predict(te_scaled)","3d7d4424":"ypred","68300663":"ypred=pd.DataFrame(ypred)","d5f2e774":"submission=pd.DataFrame({'ID':df_test['ID'],'BWEIGHT':ypred[0]})","6531c163":"submission.reset_index()\nsubmission.to_csv('submission.csv',index=False)","5f950e35":"#### Dropping missing values as it won't have any affect on outcome","96016038":"# Scaling the dataset","f26636f1":"# Importing and exploring the dataset","b35317d4":"## Splitting the dataset","8099dcac":"#### Number of missing value in each column","463a1e27":"# Building the model"}}