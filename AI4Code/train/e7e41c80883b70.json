{"cell_type":{"cbe9ca7d":"code","dbdadfe4":"code","51475cf2":"code","2bddcad9":"code","3259c0d2":"code","5d199bf2":"code","cff4cfa1":"code","8d4fb577":"code","4dc53e12":"code","3b57dfac":"code","af8c0ccb":"code","d4751f43":"code","94e23125":"code","e678346d":"code","977b96eb":"code","19afc041":"code","c2d0f518":"code","557ab0f9":"code","30aa3cb2":"code","fc251776":"code","a154c622":"code","2d6e825e":"code","a13d725d":"code","a7717171":"code","1cbfe2c2":"code","9c7d3afa":"code","8e8a236b":"code","49e41e52":"code","c97afb06":"code","f14d482b":"code","d8832d9c":"code","0e2ce932":"code","662a86fd":"code","32f3e7b2":"code","97bfba0a":"code","7382bae4":"code","96d5266d":"code","31fff1a6":"code","d4e04439":"code","c498239e":"code","691591e6":"code","44ca77c2":"code","6d3a54cc":"code","3fc7c7e7":"code","cfccdd4c":"code","e40682d6":"code","194fc32a":"code","ad351504":"code","b47bcd48":"code","4547537b":"code","a1343835":"code","4f27d3f1":"code","5bcc1c33":"code","b1f63065":"code","b6ee83b7":"code","42e53fc2":"code","f01856a7":"code","de35764a":"code","14fb54c5":"code","a75a7b64":"code","4ad78833":"code","86837016":"code","55af4f53":"code","e258e385":"code","e8413963":"code","1d3c136f":"code","53d2085f":"code","7b6c2ab4":"code","9b9f012a":"code","4fc3e559":"code","9fd0cad4":"code","68b46ff6":"code","7e042f67":"code","f04b2fd5":"code","d3b72d35":"code","59ad94c1":"code","9c52c769":"code","a9a496fe":"code","7a13a516":"code","e5600bdb":"code","11a0df3a":"code","b0814876":"code","14edc7ad":"code","f746d57a":"code","95d0d56e":"code","5941ef3a":"code","7c32804a":"code","45bbb0d2":"code","ac8926c5":"code","7a95cd29":"code","c44fa751":"code","7fbe6b53":"code","83939a12":"markdown","5e34af54":"markdown","0da85865":"markdown","f71c0f63":"markdown","2cf522cc":"markdown","2d521a85":"markdown","29654b96":"markdown","81d2de5d":"markdown","ec7b7b23":"markdown","205897fc":"markdown","9217a2c9":"markdown","33697924":"markdown"},"source":{"cbe9ca7d":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom dateutil import parser #convert time in date time data type","dbdadfe4":"finetech_appdata=pd.read_csv('..\/input\/customers-to-subscription-through-app-behavior\/FineTech_appData.csv')","51475cf2":"finetech_appdata","2bddcad9":"finetech_appdata.shape","3259c0d2":"finetech_appdata.head(6)","5d199bf2":"finetech_appdata.tail(6)","cff4cfa1":"for i in [1,2,3,4,5,6,7]:\n    print(finetech_appdata.loc[i,'screen_list'],'\\n')","8d4fb577":"finetech_appdata.isnull().sum()#take summary of null data","4dc53e12":"finetech_appdata.info()#info about datasets","3b57dfac":"finetech_appdata.describe()#give destribution of numeric variable","af8c0ccb":"#getting unique value\nfeatures=finetech_appdata.columns\nfor i in features:\n    print(\"\"\"Unique value of {}\\n{}\\nlen is {}\\n\"\"\".format(i,finetech_appdata[i].unique(),len(finetech_appdata[i].unique())))","d4751f43":"finetech_appdata['age'].value_counts()","94e23125":"finetech_appdata.dtypes","e678346d":"finetech_appdata['hour']=finetech_appdata.hour.str.slice(1,3).astype(int)","977b96eb":"finetech_appdata.columns","19afc041":"finetech_appdata2=finetech_appdata.drop(['user','first_open','screen_list','enrolled_date'],axis=1)","c2d0f518":"finetech_appdata2","557ab0f9":"finetech_appdata2.head(6) #head of dropped data","30aa3cb2":"#heatmap\nplt.figure(figsize=(16,9))\nsns.heatmap(finetech_appdata2.corr(),annot=True,cmap='coolwarm')\nplt.title('Heatmap using correlation matrix of finetech_appdata2',fontsize=25)","fc251776":"sns.pairplot(finetech_appdata2,hue='enrolled');","a154c622":"sns.countplot(finetech_appdata.enrolled)","2d6e825e":"print('Not Enrolled Users=',(finetech_appdata.enrolled <1).sum(),'out of 50000')\nprint('Enrolled Users=',50000-(finetech_appdata.enrolled <1).sum(),'out of 50000')","a13d725d":"plt.figure(figsize=(16,9))\nfeatures=finetech_appdata2.columns\nfor i,j in enumerate(features):\n    plt.subplot(3,3,i+1)\n    plt.title('Histogram of {}'.format(j),fontsize=15)\n    bins=len(finetech_appdata2[j].unique())\n    plt.hist(finetech_appdata2[j],bins=bins,rwidth=0.8,edgecolor='y',linewidth=3,)\nplt.subplots_adjust(hspace=0.5)","a7717171":"for i,j in enumerate(features):\n    print(i,j)","1cbfe2c2":"sns.set()\nplt.figure(figsize=(14,5))\nplt.title('Correlation all features',fontsize=20)\nfinetech_appdata3=finetech_appdata2.drop(['enrolled'],axis=1)\nax=sns.barplot(finetech_appdata3.columns,finetech_appdata3.corrwith(finetech_appdata2.enrolled))\nax.tick_params(labelsize=15,labelrotation=20,color='k')","9c7d3afa":"finetech_appdata['first_open']=[parser.parse(i) for i in finetech_appdata['first_open']]","8e8a236b":"finetech_appdata['enrolled_date']=[parser.parse(i) if isinstance(i,str) else i for i in finetech_appdata['enrolled_date']]","49e41e52":"finetech_appdata.dtypes","c97afb06":"finetech_appdata['time_to_enrolled']=(finetech_appdata.enrolled_date - finetech_appdata.first_open).astype('timedelta64[h]')","f14d482b":"plt.hist(finetech_appdata['time_to_enrolled'].dropna())","d8832d9c":"plt.hist(finetech_appdata['time_to_enrolled'].dropna(),range=(0,100))","0e2ce932":"finetech_appdata.loc[finetech_appdata.time_to_enrolled > 48 ,'enrolled']=0","662a86fd":"finetech_appdata","32f3e7b2":"finetech_appdata.drop(columns=['time_to_enrolled','enrolled_date','first_open'],inplace=True)","97bfba0a":"finetech_appdata","7382bae4":"finetech_app_screen_data=pd.read_csv('..\/input\/customers-to-subscription-through-app-behavior\/top_screens.csv').top_screens.values","96d5266d":"finetech_app_screen_data","31fff1a6":"type(finetech_app_screen_data)","d4e04439":"finetech_appdata['screen_list']=finetech_appdata.screen_list.astype(str) +','","c498239e":"finetech_appdata","691591e6":"for screen_name in finetech_app_screen_data:\n    finetech_appdata[screen_name]=finetech_appdata.screen_list.str.contains(screen_name).astype(int)\n    finetech_appdata['screen_list']= finetech_appdata.screen_list.str.replace(screen_name+\",\",\"\")","44ca77c2":"finetech_appdata.screen_list.str.contains('Splash').astype(int)","6d3a54cc":"finetech_appdata.screen_list.str.replace('splash'+\",\",\"\")","3fc7c7e7":"finetech_appdata.head(6)","cfccdd4c":"finetech_appdata.loc[0,'screen_list']","e40682d6":"finetech_appdata['remain_screen_list']=finetech_appdata.screen_list.str.count(\",\")","194fc32a":"finetech_appdata.drop(columns=['screen_list'],inplace=True)","ad351504":"finetech_appdata","b47bcd48":"finetech_appdata.columns","4547537b":"saving_screens=['Saving1',\n               'Saving2',\n               'Saving2Amount',\n               'Saving4',\n               'Saving5',\n               'Saving6',\n               'Saving7',\n               'Saving8',\n               'Saving9',\n               'Saving10'\n               ]\nfinetech_appdata['saving_screen_count']=finetech_appdata[saving_screens].sum(axis=1)\nfinetech_appdata.drop(columns= saving_screens, inplace=True)","a1343835":"finetech_appdata","4f27d3f1":"credit_screens=['Credit1',\n                'Credit2',\n                'Credit3',\n                'Credit3Container',\n                'Credit3Dashboard',\n               ]\nfinetech_appdata['credit_screens_count']=finetech_appdata[credit_screens].sum(axis=1)\nfinetech_appdata.drop(columns=credit_screens,axis=1,inplace=True)","5bcc1c33":"finetech_appdata","b1f63065":"cc_screens=['CC1',\n           'CC1Category',\n           'CC3',\n           ]\nfinetech_appdata['cc_screens_count']=finetech_appdata[cc_screens].sum(axis=1)\nfinetech_appdata.drop(columns=cc_screens,inplace=True)","b6ee83b7":"finetech_appdata","42e53fc2":"loan_screens=['Loan',\n             'Loan2',\n             'Loan3',\n             'Loan4',\n             ]\nfinetech_appdata['loan_screens_count']=finetech_appdata[loan_screens].sum(axis=1)\nfinetech_appdata.drop(columns=loan_screens,inplace=True)","f01856a7":"finetech_appdata","de35764a":"finetech_appdata.shape","14fb54c5":"finetech_appdata.info()","a75a7b64":"finetech_appdata.describe()","4ad78833":"plt.figure(figsize=(45,35))\nsns.heatmap(finetech_appdata.corr(),annot=True,linewidth =2)","86837016":"finetech_appdata.columns","55af4f53":"finetech_appdata['ProfileChildren '].unique()","e258e385":"corr_matrix=finetech_appdata.corr()\ncorr_matrix['ProfileChildren ']","e8413963":"clean_finetech_appdata=finetech_appdata\ntarget=finetech_appdata['enrolled']\nfinetech_appdata.drop(columns='enrolled',inplace=True)","1d3c136f":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test=train_test_split(finetech_appdata,target,test_size=0.2,random_state=0)","53d2085f":"train_userID=X_train['user']\nX_train.drop(columns='user',inplace=True)\ntest_userID=X_test['user']\nX_test.drop(columns='user',inplace=True)","7b6c2ab4":"from sklearn.preprocessing import StandardScaler\nsc=StandardScaler()\nX_train_sc=sc.fit_transform(X_train)\nX_test_sc=sc.transform(X_test)","9b9f012a":"from sklearn.metrics import confusion_matrix,classification_report,accuracy_score","4fc3e559":"from sklearn.tree import DecisionTreeClassifier\ndt_model=DecisionTreeClassifier(criterion='entropy',random_state=0)\ndt_model.fit(X_train,y_train)\ny_pred_dt=dt_model.predict(X_test)\naccuracy_score(y_test,y_pred_dt)","9fd0cad4":"dt_model2=DecisionTreeClassifier(criterion='entropy',random_state=0)\ndt_model2.fit(X_train_sc,y_train)\ny_pred_dt_sc=dt_model2.predict(X_test_sc)\naccuracy_score(y_test,y_pred_dt_sc)","68b46ff6":"from sklearn.neighbors import KNeighborsClassifier\nknn_model=KNeighborsClassifier(n_neighbors=5,metric='minkowski',p=2)\nknn_model.fit(X_train,y_train)\ny_pred_knn=knn_model.predict(X_test)\naccuracy_score(y_test,y_pred_knn)","7e042f67":"from sklearn.neighbors import KNeighborsClassifier\nknn_model2=KNeighborsClassifier(n_neighbors=5,metric='minkowski',p=2)\nknn_model2.fit(X_train,y_train)\ny_pred_knn=knn_model.predict(X_test)\naccuracy_score(y_test,y_pred_knn)","f04b2fd5":"from sklearn.naive_bayes import GaussianNB\nnb_model=GaussianNB()\nnb_model.fit(X_train,y_train)\ny_pred_nb=nb_model.predict(X_test)\naccuracy_score(y_test,y_pred_nb)","d3b72d35":"nb_model=GaussianNB()\nnb_model.fit(X_train,y_train)\ny_pred_nb_sc=nb_model.predict(X_test_sc)\naccuracy_score(y_test,y_pred_nb_sc)","59ad94c1":"from sklearn.ensemble import RandomForestClassifier\nrf_model=RandomForestClassifier(n_estimators=10,criterion='entropy',random_state=0)\nrf_model.fit(X_train,y_train)\ny_pred_rf=rf_model.predict(X_test)\naccuracy_score(y_test,y_pred_rf)","9c52c769":"from sklearn.ensemble import RandomForestClassifier\nrf_model2=RandomForestClassifier(n_estimators=10,criterion='entropy',random_state=0)\nrf_model2.fit(X_train,y_train)\ny_pred_rf_sc=rf_model.predict(X_test_sc)\naccuracy_score(y_test,y_pred_rf_sc)","a9a496fe":"from sklearn.svm import SVC\nsvc_model=SVC()\nsvc_model.fit(X_train,y_train)\ny_pred_svc=svc_model.predict(X_test)\naccuracy_score(y_test,y_pred_svc)","7a13a516":"svc_model2=SVC()\nsvc_model2.fit(X_train,y_train)\ny_pred_svc_sc=svc_model.predict(X_test_sc)\naccuracy_score(y_test,y_pred_svc_sc)","e5600bdb":"import sys\nprint(sys.base_prefix)","11a0df3a":"import sys\n!{sys.executable} -m pip install xgboost","b0814876":"from xgboost import XGBClassifier\nxgb_model=XGBClassifier()\nxgb_model.fit(X_train,y_train)\ny_pred_xgb=xgb_model.predict(X_test)\naccuracy_score(y_test,y_pred_xgb)","14edc7ad":"xgb_model2=XGBClassifier()\nxgb_model2.fit(X_train,y_train)\ny_pred_xgb_sc=xgb_model.predict(X_test_sc)\naccuracy_score(y_test,y_pred_xgb_sc)","f746d57a":"xgb_model_pt1=XGBClassifier(\nlearning_rate=0.01,\nn_estimators=5000,\nmax_depth=4,\nmin_child_weight=6,\ngamma=0,\nsubsample=0.8,\ncolsample_bytree=0.8,\nreg_alpha=0.005,\nobjective='binary:logistic',\nnthread=4,\nscale_pos_weight=1,\nseed=27    \n)\nxgb_model_pt1.fit(X_train,y_train)\ny_pred_xgb_pt1=xgb_model_pt1.predict(X_test)\naccuracy_score(y_test,y_pred_xgb_pt1)","95d0d56e":"xgb_model_pt2=XGBClassifier(\nlearning_rate=0.01,\nn_estimators=5000,\nmax_depth=4,\nmin_child_weight=6,\ngamma=0,\nsubsample=0.8,\ncolsample_bytree=0.8,\nreg_alpha=0.005,\nobjective='binary:logistic',\nnthread=4,\nscale_pos_weight=1,\nseed=27    \n)\nxgb_model_pt2.fit(X_train,y_train)\ny_pred_xgb_sc_pt2=xgb_model_pt1.predict(X_test)\naccuracy_score(y_test,y_pred_xgb_sc_pt2)","5941ef3a":"#confusion Matrix\ncm_xgb_pt2=confusion_matrix(y_test,y_pred_xgb_sc_pt2)\nsns.heatmap(cm_xgb_pt2, annot=True ,fmt='g')\nplt.title('Confusion Matrix',fontsize=20)","7c32804a":"#classification report\ncr_xgb_pt2=classification_report(y_test,y_pred_xgb_sc_pt2)\nprint('Classification report\\n',cr_xgb_pt2)","45bbb0d2":"#cross validation\nfrom sklearn.model_selection import cross_val_score\ncross_validation=cross_val_score(estimator=xgb_model_pt2, X=X_train_sc, y=y_train,cv=10)\nprint('Cross Validation od Xgboost model=',cross_validation)\nprint('Cross Validation od Xgboost model(in mean)=',cross_validation.mean())","ac8926c5":"final_result=pd.concat([test_userID,y_test],axis=1)\nfinal_result['predicted result']=y_pred_xgb_sc_pt2\n\nfinal_result","7a95cd29":"final_result.head(6)","c44fa751":"#pickle\nimport pickle\n\npickle.dump(xgb_model_pt2,open('model_finetech.pickle','wb'))\n\nml_load_pl=pickle.load(open('model_finetech.pickle','rb'))\n\ny_pred_pl =ml_load_pl.predict(X_test_sc)\n\ncm_pl=confusion_matrix(y_test,y_pred_pl)\nprint('Confusion Matrix=\\n',cm_pl)\n\nprint('Accuracy of Model =',accuracy_score(y_test,y_pred_pl))","7fbe6b53":"import joblib\n\njoblib.dump(xgb_model_pt2,'model_finetech.joblib')\n\nml_model_jl=joblib.load('model_finetech.joblib')\n\ny_pred_jl=ml_model_jl.predict(X_test_sc)\n\ncm_jl=confusion_matrix(y_test,y_pred_jl)\n\nprint('Confusion Matrix =\\n',cm_jl)\n\nprint('Accuracy Model=\\n',accuracy_score(y_test,y_pred_jl))","83939a12":"# Random Forest","5e34af54":"--------------------------------------Project Ends Here------------------------------------------------------------------------","0da85865":"# Naive Bayes","f71c0f63":"# Decision Tree","2cf522cc":"# Feature Scaling","2d521a85":"# Data Visualization","29654b96":"# Support Vector Machine","81d2de5d":"# Model Building","ec7b7b23":"Data Preprocessing","205897fc":"# KNN","9217a2c9":"# Saving the Model","33697924":"# XGBoost"}}