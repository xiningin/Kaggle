{"cell_type":{"aa82a1e7":"code","d1c0b56b":"code","3188c137":"code","84e5f5e6":"code","07b3f123":"code","3b745ede":"code","349d2bb5":"code","24ccfb9e":"code","2a82a468":"code","91a48637":"code","c61cca2d":"code","195e5e7f":"code","a3ee598b":"code","df7f6385":"code","d8e2de58":"code","06086fc2":"code","40f75af1":"code","b2761470":"code","52ae6761":"code","3ad2651f":"code","8dcaa3e2":"code","444d6ec5":"code","ab531bdb":"code","fd719c42":"code","3a1030d1":"code","507b8258":"code","d39575dc":"code","054d1823":"code","809d8aa9":"code","0ea9758f":"code","6f1ac7b3":"code","01c07794":"code","01201fe3":"markdown","7caa2322":"markdown","99369ef1":"markdown","52ec6d1a":"markdown","f8bd14fd":"markdown","e3a1c648":"markdown","b9f724db":"markdown","29167980":"markdown","c49fe9d5":"markdown","550f45f7":"markdown","5b546c4c":"markdown","a105a875":"markdown","19c3f636":"markdown","9208443a":"markdown"},"source":{"aa82a1e7":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","d1c0b56b":"df = pd.read_csv('..\/input\/college-data\/College_Data.txt',index_col=0)","3188c137":"df.head()","84e5f5e6":"df.info()","07b3f123":"df.describe()","3b745ede":"sns.set_style('whitegrid')\nsns.lmplot('Room.Board','Grad.Rate',data=df, hue='Private',\n           palette='coolwarm',size=6,aspect=1,fit_reg=True)","349d2bb5":"sns.set_style('whitegrid')\nsns.lmplot('Outstate','F.Undergrad',data=df, hue='Private',\n           palette='coolwarm',size=6,aspect=1,fit_reg=False)","24ccfb9e":"sns.boxplot(x='Private',y='S.F.Ratio',data=df)","2a82a468":"sns.boxplot(x='Private',y='perc.alumni',data=df)","91a48637":"sns.set_style('darkgrid')\ng = sns.FacetGrid(df,hue=\"Private\",palette='coolwarm',size=6,aspect=2)\ng = g.map(plt.hist,'Outstate',bins=20,alpha=0.7)","c61cca2d":"sns.set_style('darkgrid')\ng = sns.FacetGrid(df,hue=\"Private\",palette='coolwarm',size=6,aspect=2)\ng = g.map(plt.hist,'Grad.Rate',bins=20,alpha=0.7)","195e5e7f":"df[df['Grad.Rate'] > 100]","a3ee598b":"df['Grad.Rate']['Cazenovia College'] = 100","df7f6385":"df[df['Grad.Rate'] > 100]","d8e2de58":"sns.set_style('darkgrid')\ng = sns.FacetGrid(df,hue=\"Private\",palette='coolwarm',size=6,aspect=2)\ng = g.map(plt.hist,'Grad.Rate',bins=20,alpha=0.7)","06086fc2":"from sklearn.preprocessing import MinMaxScaler","40f75af1":"scaler = MinMaxScaler()","b2761470":"X=df.drop('Private',1)","52ae6761":"var=scaler.fit_transform(X)","3ad2651f":"var","8dcaa3e2":"df.head()","444d6ec5":"from sklearn.cluster import KMeans\nfrom sklearn.metrics import silhouette_score, davies_bouldin_score,v_measure_score","ab531bdb":"km_scores= []\nkm_silhouette = []\nvmeasure_score =[]\ndb_score = []\n\nfor i in range(2,12):\n    km = KMeans(n_clusters=i, random_state=0).fit(var)\n    preds = km.predict(var)\n    \n    print(\"Score for number of cluster(s) {}: {}\".format(i,km.score(var)))\n    km_scores.append(-km.score(var))\n    \n    silhouette = silhouette_score(var,preds)\n    km_silhouette.append(silhouette)\n    print(\"Silhouette score for number of cluster(s) {}: {}\".format(i,silhouette))\n    \n    db = davies_bouldin_score(var,preds)\n    db_score.append(db)\n    print(\"Davies Bouldin score for number of cluster(s) {}: {}\".format(i,db))\n    \n    v_measure = v_measure_score(km.labels_,preds)\n    vmeasure_score.append(v_measure)\n    print(\"V-measure score for number of cluster(s) {}: {}\".format(i,v_measure))\n    print(\"-\"*100)","fd719c42":"clus_cent=km.cluster_centers_","3a1030d1":"plt.figure(figsize=(7,4))\nplt.title(\"The elbow method for determining number of clusters\\n\",fontsize=16)\nplt.scatter(x=[i for i in range(2,12)],y=km_scores,s=150,edgecolor='k')\nplt.grid(True)\nplt.xlabel(\"Number of clusters\",fontsize=14)\nplt.ylabel(\"K-means score\",fontsize=15)\nplt.xticks([i for i in range(2,12)],fontsize=14)\nplt.yticks(fontsize=15)\nplt.show()","507b8258":"plt.scatter(x=[i for i in range(2,12)],y=vmeasure_score,s=150,edgecolor='k')\nplt.grid(True)\nplt.xlabel(\"V-measure score\")\nplt.show()","d39575dc":"plt.figure(figsize=(7,4))\nplt.title(\"The silhouette coefficient method \\nfor determining number of clusters\\n\",fontsize=16)\nplt.scatter(x=[i for i in range(2,12)],y=km_silhouette,s=150,edgecolor='k')\nplt.grid(True)\nplt.xlabel(\"Number of clusters\",fontsize=14)\nplt.ylabel(\"Silhouette score\",fontsize=15)\nplt.xticks([i for i in range(2,12)],fontsize=14)\nplt.yticks(fontsize=15)\nplt.show()","054d1823":"plt.scatter(x=[i for i in range(2,12)],y=db_score,s=150,edgecolor='k')\nplt.grid(True)\nplt.xlabel(\"Davies-Bouldin score\")\nplt.show()","809d8aa9":"from sklearn.mixture import GaussianMixture","0ea9758f":"gm_bic= []\ngm_score=[]\nfor i in range(2,12):\n    gm = GaussianMixture(n_components=i,n_init=10,tol=1e-3,max_iter=1000).fit(var)\n    print(\"BIC for number of cluster(s) {}: {}\".format(i,gm.bic(var)))\n    print(\"Log-likelihood score for number of cluster(s) {}: {}\".format(i,gm.score(var)))\n    print(\"-\"*100)\n    gm_bic.append(-gm.bic(var))\n    gm_score.append(gm.score(var))","6f1ac7b3":"plt.figure(figsize=(7,4))\nplt.title(\"The Gaussian Mixture model BIC \\nfor determining number of clusters\\n\",fontsize=16)\nplt.scatter(x=[i for i in range(2,12)],y=np.log(gm_bic),s=150,edgecolor='k')\nplt.grid(True)\nplt.xlabel(\"Number of clusters\",fontsize=14)\nplt.ylabel(\"Log of Gaussian mixture BIC score\",fontsize=15)\nplt.xticks([i for i in range(2,12)],fontsize=14)\nplt.yticks(fontsize=15)\nplt.show()","01c07794":"plt.scatter(x=[i for i in range(2,12)],y=gm_score,s=150,edgecolor='k')\nplt.show()","01201fe3":"## K Means Cluster ","7caa2322":"**There seems to be a private school with a graduation rate of higher than 100%**","99369ef1":"## Expectation-maximization (Gaussian Mixture Model)","52ec6d1a":"### Import Libraries","f8bd14fd":"## The best number of cluster is 2 based on Silhouette score","e3a1c648":"** Create a stacked histogram showing Out of State Tuition based on the Private column.**","b9f724db":"**Create a scatterplot of F.Undergrad versus Outstate where the points are colored by the Private column.**\n\n**The plot shows that these two feature dimensions separate out baed on the type of college**","29167980":"** Create a boxplot of percent of alumni who donate based on college type**","c49fe9d5":"** Create a boxplot of student-faculty ratio based on college type**","550f45f7":"## The best number of cluster is 4 based on Gaussian Mixture Model","5b546c4c":"## Exploratory Analysis","a105a875":"**Create a similar histogram for the Grad.Rate column.**","19c3f636":"# Clustering\n\n\n## College Data\n\nFor this project we will attempt to use:\n\n1- KMeans Clustering  \n2-Gaussian Mixture \n\n\naim: To cluster Universities into to two groups, Private and Public. We will use a data frame with 777 observations on the following 18 variables.\n\n* Private A factor with levels No and Yes indicating private or public university\n* Apps Number of applications received\n* Accept Number of applications accepted\n* Enroll Number of new students enrolled\n* Top10perc Pct. new students from top 10% of H.S. class\n* Top25perc Pct. new students from top 25% of H.S. class\n* F.Undergrad Number of fulltime undergraduates\n* P.Undergrad Number of parttime undergraduates\n* Outstate Out-of-state tuition\n* Room.Board Room and board costs\n* Books Estimated book costs\n* Personal Estimated personal spending\n* PhD Pct. of faculty with Ph.D.\u2019s\n* Terminal Pct. of faculty with terminal degree\n* S.F.Ratio Student\/faculty ratio\n* perc.alumni Pct. alumni who donate\n* Expend Instructional expenditure per student\n* Grad.Rate Graduation rate","9208443a":"### Scaling"}}