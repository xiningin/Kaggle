{"cell_type":{"8aa809f3":"code","de4666bf":"code","b194366a":"code","c6866466":"code","7d271b3d":"code","c25988e3":"code","261c8937":"code","591e0eb8":"code","71db43ad":"code","1277461f":"code","18b639c2":"code","cd39e219":"code","b039d910":"code","662d8a63":"code","68de3a65":"code","80184ce8":"code","b9df1102":"code","4d2af358":"code","5764dd65":"code","0ca7bde5":"code","45c0cdfa":"code","ee006588":"code","7f03fb15":"code","90507433":"code","4489c42f":"code","92aba537":"code","5a6d966a":"code","a328d9ea":"code","e962fc0b":"code","b86f0274":"code","9bf6ddce":"code","b24a7a98":"code","e0b7cd63":"code","0dd5a87d":"code","29719485":"code","414b4dec":"code","81431405":"code","35a41dbd":"code","4459f129":"code","72abedc1":"code","1704f020":"code","89947db3":"code","c5a6f966":"code","133177da":"code","7e03228c":"code","fbbe5ba1":"code","e8ab7566":"code","cb9d375f":"code","fba7bebc":"code","4675db12":"markdown","e78a85f2":"markdown","de5e5c21":"markdown","9cf6b466":"markdown","e7a60fd8":"markdown","68a8e03c":"markdown","3ff7b246":"markdown","a202e865":"markdown","f96d6fad":"markdown","f4fa4535":"markdown","88b117f6":"markdown","00010a91":"markdown","10b4214a":"markdown","cae91c48":"markdown","48ccc9d8":"markdown","66b7510f":"markdown","5d564c95":"markdown","ec888659":"markdown","bf66b070":"markdown","608eea58":"markdown","10e63274":"markdown","c4a60009":"markdown","ff949642":"markdown","8eed4594":"markdown","95bdf931":"markdown","2b9728f7":"markdown","4df19fe1":"markdown","782bf245":"markdown","1e4f44d9":"markdown","3c4af019":"markdown","7187b1f4":"markdown","6de75eaa":"markdown","7a2cb1c7":"markdown","a7f301a2":"markdown","d02d1232":"markdown"},"source":{"8aa809f3":"#Load required libraries.\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings('ignore')\nimport matplotlib.lines as  lines\nfrom IPython.display import HTML\nfrom wordcloud import WordCloud\nimport datetime\nfrom tqdm import tqdm\nfrom pandas import option_context  #for changing the display column width of dataframe\nimport calendar","de4666bf":"#Visualization settings\nsns.set_style(style='white')\nsns.set(rc={\n    'figure.figsize': (12,7),\n    'axes.facecolor': 'white',\n    'axes.grid': True,\n    'grid.color': '.9',\n    'axes.linewidth': 1.0,\n    'grid.linestyle': u'-'},\n    font_scale=1.5)\ncustom_colors=[\"#3498db\", \"#95a5a6\",\"#34495e\", \"#2ecc71\", \"#e74c3c\"]\nsns.set_palette(custom_colors)\nbackground_color='#fbfbfb'","b194366a":"#Read datafile\ndf_input=pd.read_csv('..\/input\/netflix-shows\/netflix_titles.csv')","c6866466":"print (\"\\nSample dataframe\\n\")\ndisplay(df_input.head(3))\nprint (f\"Dataframe shape: {df_input.shape}\\n\")\ncol_tags=\"<ol><b>\" + \"\".join([f\"<li>{col}<\/li>\" for col in df_input.columns]) + \"<\/b><\/ol>\"\ndisplay(HTML(\"<b><u>Feature names<\/u><\/b>\"))\ndisplay(HTML(col_tags))\nprint (\"Dataset summary\")\ndisplay (df_input.info())","7d271b3d":"#Data frame for missing values\nval=df_input.isnull().sum()\nval.sort_values(inplace=True, ascending=False)\ndf=pd.DataFrame(columns=[\"Features\",\"Missing values\"])\ndf[\"Features\"]=val.index\ndf[\"Missing values\"]=val.values\ndf.drop(df[df[\"Missing values\"]==0].index, inplace=True)\n\n#Create plot for missing values \nfig=plt.figure(figsize=(15,7));\n\nax0=fig.add_subplot(1,2,1)\nax1=fig.add_subplot(1,2,2)\nax1.grid(False)\nax1.set_xticklabels([])\nax1.set_yticklabels([])\n\nfig.patch.set_facecolor(background_color)\nax0.set_facecolor(background_color)\n#ax0.set_title(\"Missing values in data\")\nax1.set_facecolor(background_color)\n\nsns.barplot(data=df,x=\"Features\",y=\"Missing values\",ax=ax0);\n#rotating the ticklabels in x axis\nfor tick in ax0.get_xticklabels():\n    tick.set_rotation(90)\n\n#Draw line in the middle    \nl1= lines.Line2D([0.5,0.5],[0.1, 0.9],color='black',lw=0.2,transform=fig.transFigure)\nfig.lines.extend([l1])\n\n#Description\nfig.text(x=0.6,\n        y=0.8,\n        s=\"Missing values in data\",\n        fontweight='bold',\n        fontfamily='serif',\n         fontsize=17,\n        color='grey')\nfig.text(x=0.47,\n        y=0.5,\n        fontweight='light',\n        fontfamily='serif',\n         fontsize=17,\n        color='grey',\n        s='''\n        Director,Cast,Country,date_added and rating\\n\n        features have missing values.\\n\n        30% Director feature having missing value.\n        ''')\nplt.show()\n\ndisplay(df)","c25988e3":"#Discrete feature analysis\ndef analyze_discrete_feature(fld,display_graph=True):\n    print (\"Sample data:\\n\")\n    display(fld.head())\n    df=pd.DataFrame({\"Value\": fld.value_counts().index,\n                 \"Count\":fld.value_counts().values})\n    print (\"\\nNull value count : \", fld.isnull().sum())\n    unique_list=fld.unique().tolist()\n    print (\"\\nUnique values: \", unique_list)\n    print (\"\\n Unique values count: \", len(unique_list))\n    print (\"\\nValue counts:\\n\",    df)\n    print (display_graph)\n    if display_graph==True:\n        plt.subplots(figsize=(25,10),facecolor=background_color)\n        plt.subplot(2,2,1)\n        plt.pie(fld.value_counts(),labels=fld.value_counts().index,autopct=lambda x: f'{x: .2f}%');\n        plt.xticks(rotation=90)\n\n        plt.subplot(2,2,2)   \n        sns.barplot(data=df, x=\"Value\",y=\"Count\").set_facecolor(background_color);\n        plt.xticks(rotation=90);\n        plt.suptitle(fld.name + \" -distribution\");\n\n        plt.show()\n        plt.close()\n    display(HTML(\"<h4 style='background-color:#fbfbfb;font-family:serif;font-size:160%'>Discrete variable<\/h4>\"))","261c8937":"#Continuous feature analysis\ndef analyze_continuous_feature(fld):\n    print (\"Null value count : \", fld.isnull().sum())\n    print (\"\\n\", fld.describe())\n    plt.subplots(figsize=(25,10))\n    plt.subplot(2,2,1)\n    plt.hist(fld)\n    plt.subplot(2,2,2)\n    sns.boxplot(fld)\n    plt.suptitle(\"fld.name + -distribution\")\n    plt.show()\n    plt.close()\n    display(HTML(\"<h4 style='background-color:#fbfbfb;font-family:serif;font-size:160%'>Continuous variable<\/h4>\"))","591e0eb8":"print (\"Sample data:\\n\")\ndisplay(df_input.show_id.head())","71db43ad":"analyze_discrete_feature(df_input.type)","1277461f":"display(df_input.title)","18b639c2":"print (\"\\n Sample data: \\n\")\ndisplay (df_input.director.dropna().head())\n#Get the series of director names.\ndirector_names=df_input.director.dropna().copy()\n\ndirector_names=director_names.apply(lambda x: x.replace(\" \",\"\"))\ndirector_names=director_names.value_counts()\n#Create a dictionary with director names and count of video contents.\ndirector_counts={}\nfor item in director_names.iteritems():\n    director_counts[item[0]]=item[1]\n    \nwc=WordCloud(background_color=background_color).generate_from_frequencies(director_counts)\n\nfig=plt.figure(figsize=(15,9),facecolor=background_color)\ngs= fig.add_gridspec(1,1)\ngs.update(wspace=0.5, hspace=0.5)\nax0=fig.add_subplot(gs[0,0])\nax0.set_facecolor(background_color)\nax0.imshow(wc,interpolation='bilinear')\nax0.axis('off')\n#Draw a seperation line\nl1=lines.Line2D([0.92,0.92],[0.1,0.9], transform=fig.transFigure,color='black',lw=0.2)\nfig.lines.extend([l1])\n\nfig.text(x=0.93,y=0.7,\n         s=\"List of directors based on their frequency in the data\",\n         fontsize=25,fontfamily='serif',color='grey',fontweight='bold')\nfig.text(x=0.92,\n        y=0.5,\n        fontweight='light',\n        fontfamily='serif',\n        fontsize=22,\n        color='grey',\n        s='''\n        Topmost director Raul Campos, Jan Suter did 18 contents.\n        There are 3312 directors with single content.\n        ''')\nfig.tight_layout(pad=0)\nfig.patch.set_facecolor(background_color)\nplt.show()\n#Display director names and counts\n#display(pd.DataFrame(director_names).rename(columns={'director':'Count'}))\n#dir_count=pd.DataFrame(director_names).rename(columns={'director':'Count'})\n#display (dir_count.value_counts())","cd39e219":"print (\"Sample data:\\n\")\ndisplay (df_input.cast.dropna().head())","b039d910":"actor_list=[]\ncast=df_input.cast.dropna().copy()\n#Convert to lower letters\ncast=cast.apply(lambda x : x.lower())\n\n#Create list of actors\nfor item in cast:\n    actor_list.extend(item.split(','))\n#remove duplicate actors    \nactor_list=list(set(actor_list))\nprint (f\"Number of actors: {len(actor_list)}\")\n#Create a dictionary for storing count\nactor_dict={}\nfor actor in actor_list:\n    actor_dict[actor]=0\n#Iterate through series and find the count\nfor actor in cast:\n    for x in actor.split(','):\n        actor_dict[x]+=1\nactors_count=pd.Series(actor_dict)\nactors_count.sort_values(ascending=False,inplace=True)\n","662d8a63":"wc=WordCloud(background_color=background_color).generate_from_frequencies(actor_dict)\n\nfig=plt.figure(figsize=(15,9),facecolor=None)\ngs= fig.add_gridspec(1,1)\ngs.update(wspace=0.5, hspace=0.5)\nax0=fig.add_subplot(gs[0,0])\nax0.set_facecolor(background_color)\nax0.imshow(wc,interpolation='bilinear')\nax0.axis('off')\n#Draw a seperation line\nl1=lines.Line2D([0.92,0.92],[0.1,0.9], transform=fig.transFigure,color='black',lw=0.2)\nfig.lines.extend([l1])\n\nfig.text(x=1,y=0.7,\n         s=\"Actors list\",\n         fontsize=25,fontfamily='serif',color='grey',fontweight='bold')\nfig.text(x=0.92,\n        y=0.4,\n        fontweight='light',\n        fontfamily='serif',\n        fontsize=22,\n        color='grey',\n        s='''\n        Anupam kher is the top most one who acted in 38 video contents,\n        followed by Takahiro sakurai, Shah rukh khan, Om puri etc.\\n\n        There are 35364 actors in the dataset.\n        ''')\nfig.tight_layout(pad=0)\nfig.patch.set_facecolor(background_color)\nplt.show()\nprint (\"\\nTop most actors based on content count:\\n\")\ndisplay(actors_count.head())","68de3a65":"print (\"Sample data:\\n\")\ndisplay(df_input.country.head(5))","80184ce8":"country=df_input.country.dropna().copy()\ncountry = country.apply(lambda x: x.lower().strip())\n\ncountry_list=[]\nfor item in country:\n    country_list.extend(item.split(','))\ncountry_list=list(set(country_list))\n\n#Dictionary for storing the count\ncountry_dict={}\nfor ctry in country_list:\n    country_dict[ctry]=0\n\n#Iterate through the series for updating the count\nfor ctry in country:\n    for x in ctry.split(','):\n        country_dict[x]+=1\ncountry_dict.pop('')\n\ncountry_count=pd.Series(country_dict)\ncountry_count.sort_values(ascending=False, inplace=True)","b9df1102":"wc=WordCloud(background_color=background_color).generate_from_frequencies(country_dict)\n\n\nfig=plt.figure(figsize=(15,9),facecolor=None)\ngs= fig.add_gridspec(1,1)\ngs.update(wspace=0.5, hspace=0.5)\nax0=fig.add_subplot(gs[0,0])\nax0.set_facecolor(background_color)\nax0.imshow(wc,interpolation='bilinear')\nax0.axis('off')\n#Draw a seperation line\nl1=lines.Line2D([0.92,0.92],[0.1,0.9], transform=fig.transFigure,color='black',lw=0.2)\nfig.lines.extend([l1])\n\nfig.text(x=0.93,y=0.7,\n         s=\"List of Countries based on their frequency in the data\",\n         fontsize=25,fontfamily='serif',color='grey',fontweight='bold')\nfig.text(x=0.92,\n        y=0.5,\n        fontweight='light',\n        fontfamily='serif',\n        fontsize=22,\n        color='grey',\n        s='''\n        Topmost countries in which Netflix released it's contents\n        are United states,India and United Kingdom.\n        ''')\nfig.tight_layout(pad=0)\nfig.patch.set_facecolor(background_color)\nplt.show()\n\nprint (\"\\nTop most countries based on count:\\n\")\ndisplay(country_count)\nprint (f\"\\nUnique country count: {len(country_dict)}\")","4d2af358":"print (\"Sample data:\\n\", df_input.date_added.dropna().head())\n","5764dd65":"date_added=df_input.date_added.dropna().copy()\n#Convert date from string to DateTime format\ndate_added=date_added.apply(lambda x: datetime.datetime.strptime(x.strip(),\"%B %d, %Y\"))\ndf=pd.DataFrame(date_added)\n#Get the years from date\ndf[\"YearAdded\"]=df.date_added.apply(lambda x: x.year)\n#Get the statistics for the year added\nanalyze_discrete_feature(df.YearAdded)","0ca7bde5":"analyze_discrete_feature(df_input.release_year)","45c0cdfa":"analyze_discrete_feature(df_input.rating)","ee006588":"analyze_discrete_feature(df_input.duration,display_graph=False)","7f03fb15":"df_input.listed_in","90507433":"listed_in=df_input.listed_in.copy()\nlisted_in=listed_in.apply(lambda x: x.strip().lower())\nlisted_in_list=[]\nfor item in listed_in:\n    listed_in_list.extend(item.split(','))\nlisted_in_list=list(set(listed_in_list))\nprint (f\"Number of listed_in :{len(listed_in_list)}\")\n\nlisted_in_dict={}\nfor listed in listed_in_list:\n    listed_in_dict[listed]=0\nfor item in listed_in:\n    for x in item.split(','):\n        listed_in_dict[x]+=1\nlisted_in_count=pd.Series(listed_in_dict)        \nlisted_in_count.sort_values(ascending=False,inplace=True)\n\n#Now generate word cloud\nwc=WordCloud(background_color=background_color).generate_from_frequencies(listed_in_dict)\n\nfig=plt.figure(figsize=(15,9),facecolor=None)\ngs= fig.add_gridspec(1,1)\ngs.update(wspace=0.5, hspace=0.5)\nax0=fig.add_subplot(gs[0,0])\nax0.set_facecolor(background_color)\nax0.imshow(wc,interpolation='bilinear')\nax0.axis('off')\n#Draw a seperation line\nl1=lines.Line2D([0.92,0.92],[0.1,0.9], transform=fig.transFigure,color='black',lw=0.2)\nfig.lines.extend([l1])\n\nfig.text(x=0.93,y=0.7,\n         s=\"Listed in Types\",\n         fontsize=20,fontfamily='serif',color='grey',fontweight='bold')\nfig.text(x=0.92,\n        y=0.5,\n        fontweight='light',\n        fontfamily='serif',\n        fontsize=18,\n        color='grey',\n        s='''\n        Topmost Listed In type is International movies.\n        ''')\nfig.tight_layout(pad=0)\nfig.patch.set_facecolor(background_color)\nplt.show()","4489c42f":"df_input.description","92aba537":"df=df_input.loc[:,[\"director\",\"country\",\"type\"]].copy()\ndf.dropna(subset=[\"director\"],inplace=True)\n# group the data by type which having two values - movie and TV Show\ngrouped=df.groupby(['type'])\n# Let's find the movie group\ndf_type=grouped.get_group('Movie')\n# Select for the country, for e.g India\ndf_country=df_type[df_type[\"country\"]==\"India\"]\ndisplay (df_country.value_counts().head(1))","5a6d966a":"df_type=grouped.get_group('TV Show')\ndf_country=df_type[df_type[\"country\"]==\"India\"]\ndisplay (df_country.value_counts().head(1))","a328d9ea":"del(df,df_type)","e962fc0b":"#Create dataframe with cast,country and type\ndf=df_input.loc[:,[\"cast\",\"country\",\"type\"]].copy()\ndf.dropna(subset=[\"cast\",\"country\"],inplace=True)\n\n#Create new data frame with case,country and type for processing purpose\ndf1 = pd.DataFrame(columns=[\"cast\",\"country\",\"type\"])\n\n# Insert values in the new data frame, with individual cast names in cast columns\n# so that every row contains one cast per country.\nfor rec in tqdm(df.iterrows()):\n    cast_names =rec[1][\"cast\"]\n    for name in cast_names.split(','):\n        df1=pd.concat([df1,\n                      pd.DataFrame(data=\n                        {\"cast\":name,\n                         \"country\":rec[1][\"country\"],\n                         \"type\":rec[1][\"type\"]},\n                        index=[0])])\ndf1.reset_index(drop=True,inplace=True)\n\n# Filter the values based on country name, e.g India\ndf_cast=df1[df1[\"country\"]==\"India\"]\n# create groups based on type\ngrouped=df_cast.groupby(\"type\")\n# Lets find data based on Movie type\ndf_type=grouped.get_group('Movie')\nprint (\"\\nCast names based on Movies:\\n\")\ndisplay(df_type.value_counts().head(3))\n#Let's find data based in type TV show\ndf_type=grouped.get_group('TV Show')\nprint (\"\\nCast based on TV shows:\\n\")\ndisplay(df_type.value_counts().head(3))\ndel(df,df1,df_cast,df_type,grouped)","b86f0274":"df = df_input.loc[:,[\"type\",\"country\"]].copy()\ndf.dropna(inplace=True)\ndf[\"country\"]=df[\"country\"].apply(lambda x: x.lower().strip())\n\n#New dataframe for processing purpose\ndf1 = pd.DataFrame(columns=[\"type\",\"country\"])\n\nfor rec in tqdm(df.iterrows()):\n    country_names = rec[1][\"country\"]\n    type_name=rec[1][\"type\"]\n    for name in country_names.split(','):\n        df1=pd.concat([df1,\n                      pd.DataFrame(data={\"type\":type_name,\n                                        \"country\":name},\n                                  index=[0])])\ndf1.reset_index(drop=True,inplace=True);\n\n#get top ten counry names from earlier country count\ntop_ten_countries=country_count.index.tolist()[:10]\n\n#Filtering data only with top 10 countries\ndf2=df1[df1[\"country\"].isin (top_ten_countries) ].copy()","9bf6ddce":"fig=plt.figure(figsize=(14,7));\n\nax0=fig.add_subplot(1,2,1)\nax1=fig.add_subplot(1,2,2)\nax1.grid(False)\nax1.set_xticklabels([])\nax1.set_yticklabels([])\n\nfig.patch.set_facecolor(background_color)\nax0.set_facecolor(background_color)\nax1.set_facecolor(background_color)\n\n#Plot the countplot\nsns.countplot(data=df2,x=\"country\",hue=\"type\",ax=ax0);\n\n#rotating the ticklabels in x axis\nfor tick in ax0.get_xticklabels():\n    tick.set_rotation(90)\n    \n\n#Draw line in the middle    \nl1= lines.Line2D([0.5,0.5],[0.1, 0.9],color='black',lw=0.2,transform=fig.transFigure)\nfig.lines.extend([l1])\n\n#text content\nfig.text(x=0.47,\n        y=0.5,\n        fontweight='bold',\n        fontfamily='serif',\n        fontsize=17,\n        color='grey',\n        s='''\n        Country based listing  \n        for the count of Movie and TV shows.\n        ''')\nplt.show()","b24a7a98":"del(df1,df2,df,df_country)","e0b7cd63":"df=df_input.loc[:,[\"director\",\"cast\"]].copy()\ndf.dropna(axis=0,inplace=True);\ndf[\"cast\"]=df[\"cast\"].apply(lambda x: x.lower().strip())\ndf1=pd.DataFrame(columns=[\"director\",\"cast\"])","0dd5a87d":"#Create a new data frame which contains unique director and unique actor per row.\nfor rec in tqdm(df.iterrows()):\n    director=rec[1][\"director\"]\n    cast_list=rec[1][\"cast\"]\n    for individual_cast in cast_list.split(','):\n        df1=pd.concat([df1,\n                     pd.DataFrame(data={'director':director,\n                                       'cast':individual_cast},\n                                 index=[0])])\ndf1.reset_index(drop=True, inplace=True)\n#View the statistics    \ndf2=df1.value_counts().to_frame()\ndf2.reset_index(inplace=True)\ndisplay(df2.head(15))","29719485":"#Incase we need to double check the actual data\n\n#\n#with option_context('display.max_colwidth',400):\n#    display(df_input[df_input['director']=='Cathy Garcia-Molina'].loc[:,['type','director','cast','title']])","414b4dec":"del(df,df1)","81431405":"df = df_input.loc[:,['cast','rating']].copy()\ndf.dropna(axis=0,inplace=True)\ndf[\"cast\"]=df[\"cast\"].apply(lambda x: x.lower().strip())\n#New dataframe for processing purpose\ndf1=pd.DataFrame(columns=[\"rating\",\"cast\"])\n#Insert a new data frame which contains unique director and unique actor per row.\nfor rec in tqdm(df.iterrows()):\n    rating=rec[1][\"rating\"]\n    cast_list=rec[1][\"cast\"]\n    for individual_cast in cast_list.split(','):\n        df1=pd.concat([df1,\n        pd.DataFrame(data={'rating':rating,\n                           'cast':individual_cast},\n                           index=[0])])\ndf1.reset_index(drop=True, inplace=True)\n#New data frame stores the value counts\ndf2=df1.value_counts().to_frame()\ndf2.reset_index(inplace=True)\ndf2.rename(columns={0:'counts'},inplace=True)\n","35a41dbd":"#Find which actor acted maximum videos with rating TV-MA\ndisplay(df2[df2[\"rating\"]==\"TV-MA\"].head(5))","4459f129":"del(df,df1,df2)","72abedc1":"df=df_input.loc[:,['country','release_year','date_added']].copy()\ndf.dropna(axis=0,inplace=True)\ndf['added_date']=df['date_added'].apply(lambda x: datetime.datetime.strptime(x.strip(), \"%B %d, %Y\"))\ndf['added_year']=df['added_date'].apply(lambda x: x.year)\ndf['year_difference'] =  df['added_year']-df['release_year']\ndf.drop(columns=['date_added','added_date','added_year','release_year'],inplace=True)\n\ndf1 = pd.DataFrame(columns=[\"country\",\"year_difference\"])\n\n#Insert a new data frame which contains unique director and unique actor per row.\nfor rec in tqdm(df.iterrows()):\n    country_list = rec[1][\"country\"]\n    for country_name in country_list.split(','):\n        df1 = pd.concat([df1,\n                        pd.DataFrame(data={'country': country_name,\n                                          'year_difference': rec[1]['year_difference']},\n                                    index=[0])])\n# Make sure that year_difference column is numeric so that we can process aggregations\ndf1['year_difference']=pd.to_numeric(df1['year_difference'])\n","1704f020":"# df1=df1.groupby(['country'],as_index=False).agg({'year_difference':['mean']})   #for checking only mean\ndf2=df1.groupby(['country'],as_index=False).agg({\"year_difference\":[min,max,'mean']})\ndisplay(df2.sort_values((('year_difference', 'mean')),ascending=False))","89947db3":"del(df,df1,df2)","c5a6f966":"df=df_input.loc[:,['date_added','country']].copy()\ndf.dropna(axis=0,inplace=True)\n#Convert date from string format to datetime format\ndf['added_date']=df['date_added'].apply(lambda x: datetime.datetime.strptime(x.strip(), \"%B %d, %Y\"))\n#Extract year and month\ndf['year_added'] = df['added_date'].apply(lambda x: x.year)\ndf['month_added'] = df['added_date'].apply(lambda x: x.month)\ndf.drop(columns=['date_added','added_date'],inplace=True)","133177da":"#Create new dataframe and copy the structure\ndf1=pd.DataFrame(columns=df.columns)","7e03228c":"#Get individual country names in each rows\nfor rec in tqdm(df.iterrows()):\n    country_list = rec[1]['country']\n    for country_name in country_list.split(','):\n        df1=pd.concat([df1,\n                      pd.DataFrame(data={'country':country_name,\n                                        'year_added':rec[1].year_added,\n                                        'month_added': rec[1].month_added},\n                                  index=[0])])\n#df1.month_added=df1.month_added.apply(lambda x: calendar.month_name[x])\ndf1.reset_index(inplace=True,drop=True)                ","fbbe5ba1":"#Group based on country\ngroupby=df1.groupby('country')\n#Check for movie statistics for a specific country. eg: India\ndf_india=groupby.get_group('India')","e8ab7566":"#Aggregation process\ndf_india=df_india.groupby(['year_added','month_added']).agg({'month_added':'count'})\ndf_india.rename(columns={'month_added':'VideoCount'},inplace=True)\ndf_india.reset_index(inplace=True)\nprint ('Sample dataframe after aggregating the video added count based on year and month')\ndisplay (df_india.head())","cb9d375f":"#Visualize data\nfig=plt.figure(figsize=(17,7));\n\nax0=fig.add_subplot(1,2,1)\nax1=fig.add_subplot(1,2,2)\nax1.grid(False)\nax1.set_xticklabels([])\nax1.set_yticklabels([])\n\nfig.patch.set_facecolor(background_color)\nax0.set_facecolor(background_color)\nax1.set_facecolor(background_color)\n\n#Plot the countplot\nsns.lineplot(data=df_india,x=\"month_added\",y=\"VideoCount\",hue=\"year_added\",ax=ax0,palette='tab10').set_title('Video count per month in India')\nax0.legend(loc='center', bbox_to_anchor=(1.1, 0.5))\nax0.set_xticks(np.arange(1,13))\nax0.set_xticklabels(['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'])\n\n\n#rotating the ticklabels in x axis\nfor tick in ax0.get_xticklabels():\n    tick.set_rotation(90)\n    \n\n#Draw line in the middle    \nl1= lines.Line2D([0.55,0.55],[0.1, 0.9],color='black',lw=0.2,transform=fig.transFigure)\nfig.lines.extend([l1])\n\n#text content\nfig.text(x=0.55,\n        y=0.5,\n        fontweight='light',\n        fontfamily='serif',\n        fontsize=17,\n        color='grey',\n        s='''\n        2016 having very less number of videos added.\n        Overall more videos added in 2018.\n        2019 December having highest number of videos added.\n        ''')\nplt.show()","fba7bebc":"del([df,df_india,df1])","4675db12":"# 7. Date_Added","e78a85f2":"# 5. Cast","de5e5c21":"# 3. Title","9cf6b466":"# 7. Release count per month","e7a60fd8":"# <center>Exploratory Data Analysis<\/center>","68a8e03c":"<h4 style=\"background-color:#fbfbfb;font-family:serif;font-size:160%;\">\n    Director 'David Dhawan' is the one who directed 9 Movies in India.\n    <\/h4>","3ff7b246":"# <center> Feature Relationships<\/center>","a202e865":"<h4 style=\"background-color:#fbfbfb;font-family:serif;font-size:160%;\">\n    Maximum of the contents are added in 2019. <br>\n    88% percent of the contents are added during 2017 to 2020.<br>\n    Data is available from 2008 to 2021.\n    <\/h4>","f96d6fad":"# 3. Type and Country","f4fa4535":"# 12. Description","88b117f6":"# 11. Listed in","00010a91":"# 6. Release year, Year added","10b4214a":"# <center>Netflix - movies and TV shows<\/center>\n<p> This dataset consists of tv shows and movies available on Netflix as of 2019.  <\/p>","cae91c48":"# 8. Release Year","48ccc9d8":"<h4 style=\"background-color:#fbfbfb;font-family:serif;font-size:160%;\">\nActor Takahiro Sakurai is the person who acted in highest numbers of 'TV-MA' rated contents.\n    <\/h4>","66b7510f":"<h4 style=\"background-color:#fbfbfb;font-family:serif;font-size:160%;\">\n    In India: <br>\n    Anupam kher acted maximum of 35 movies.<br>\n    Rajesh Kava and Nishka Raheja acted in maximum (3) TV shows.\n    <\/h4>","5d564c95":"<h4 style=\"background-color:#fbfbfb;font-family:serif;font-size:160%;\">\n    In the country Liechtenstein, there are video contents which added in netflix after 54 years, and that's the highest difference between release and added year.\n    <\/h4>","ec888659":"<h4 style=\"background-color:#fbfbfb;font-family:serif;font-size:160%;\">\n    There are 216 different types of duration types are available in the data.<br>\n    '1 Season' duration got the maximum count in dataset.\n    <\/h4>\n    ","bf66b070":"# 6. Country","608eea58":"# 10. Duration","10e63274":"# 4. Director and Cast","c4a60009":"# 9. Rating","ff949642":"# 5. Cast and Rating","8eed4594":"<h4 style=\"background-color:#fbfbfb;font-family:serif;font-size:160%;\">\n    14 types of ratings are available in the data. <br>\n    TV-MA (Mature Audience Only) type of the rating is the max count of rating, which included 36.8% ratings in the data.\n    <\/h4>","95bdf931":"<h4 style=\"background-color:#fbfbfb;font-family:serif;font-size:160%;\">\n    From the dataset, there are maximum of 6 movies where directors would like to work with specific actor\/actress.\n    <\/h4>","2b9728f7":"# 4. Director","4df19fe1":"<h3 style=\"background-color:yellow\">\n    11 String features and 1 integer feature.\n    <\/h3>","782bf245":"# 1. show_id","1e4f44d9":"# 1. Director and Type\n#### 1a. Which director directed maximum movie contents in India?","3c4af019":"# 2. Type","7187b1f4":"# 2. Cast and Type","6de75eaa":"<h4 style=\"background-color:#fbfbfb;font-family:serif;font-size:160%\">\nTitle of the show. String discrete feature.<\/h3>","7a2cb1c7":"#### 1b. Which director directed maximum TV serials in India?","a7f301a2":"<h4 style='background-color:#fbfbfb;font-family:serif;font-size:160%'>Just row identifier for columns.<\/h4>\n","d02d1232":"<h4 style=\"background-color:#fbfbfb;font-family:serif;font-size:160%;\">\n    Release_year is ranging from 1925 to 2021. <br>\n    2018 has got the maximum contents released.<br>\n    <\/h4>"}}