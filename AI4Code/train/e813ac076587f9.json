{"cell_type":{"82ad9322":"code","d67af106":"code","110bb244":"code","4262ce38":"code","83869831":"code","da9f9d71":"code","6b5f1404":"code","a71b0dde":"code","0c2d0696":"code","40b8ef02":"code","22d22f78":"code","24821bdc":"code","11ec5d35":"code","72a64190":"code","a9a78160":"code","4bb530f7":"code","1497da4d":"code","476144a6":"code","6dc5bacd":"code","b9184482":"code","6b9db5d0":"code","1aa54c9a":"code","3c40cc7c":"code","1e591ff1":"code","8feded94":"code","d29bedc0":"code","d2cb1d07":"code","393edc6c":"code","44d9e01c":"code","5c66e08c":"code","188798af":"code","ff9af7cd":"markdown","e979564b":"markdown","37ea4194":"markdown","b7695307":"markdown","b88d2cc4":"markdown","ec38ee54":"markdown","9e97e99a":"markdown","85bb7b3f":"markdown","380c8bf8":"markdown"},"source":{"82ad9322":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings(action=\"ignore\")\n%matplotlib inline\nplt.style.use(\"fivethirtyeight\")\nsns.set_style(\"darkgrid\")","d67af106":"!pip install dataprep","110bb244":"df = pd.read_csv(\"\/kaggle\/input\/shared-bikes-demand-prediction\/day.csv\")\ndf.head(10)","4262ce38":"# dropping instant column\ndf = df.drop(['instant'],axis=1)","83869831":"# cleaning comlumn names to make it more convinient to use\nfrom dataprep.clean import clean_headers\ndf = clean_headers(df, case=\"pascal\")","da9f9d71":"df.head(10)","6b5f1404":"# info of our data which includes size, datatypes of each column\ndf.info()","a71b0dde":"# percentage of null values in dataset\n(df.isna().sum()\/len(df))*100","0c2d0696":"# statistical info of data\ndf.describe()","40b8ef02":"plt.figure(figsize=(15,12))\nsns.heatmap(df.corr(), vmin=0, vmax=1, center=0, linecolor='black',fmt = '.1f', cmap=\"icefire\",annot=True)","22d22f78":"plt.figure(figsize=(15,12))\nsns.heatmap(df.corr(), vmin=1, vmax=1, annot=True, cmap=\"icefire\", fmt=\".1f\", mask= df.corr()<0.70)","24821bdc":"pair1 = [\"Season\",\"Mnth\"]\npair2 = [\"Registered\",\"Cnt\"]","11ec5d35":"sns.pairplot(df, vars=pair1)","72a64190":"sns.pairplot(df,vars=pair2)","a9a78160":"df.hist(figsize=(20, 20))\nplt.show()","4bb530f7":"df[['Weekday', 'Cnt']].groupby(['Weekday']).sum().plot(kind=\"bar\",figsize=(6,7))","1497da4d":"from sklearn.feature_selection import chi2\nf_p_values = chi2(df.drop([\"Cnt\",\"Dteday\"],axis=1),df.Cnt)","476144a6":"f_p_values","6dc5bacd":"pvalues = pd.Series(f_p_values[1])\nfvalues = pd.Series(f_p_values[0])","b9184482":"fvalues.index = X.columns\nfvalues.sort_values(ascending=False)","6b9db5d0":"pvalues.index = X.columns\npvalues.sort_values(ascending=True)","1aa54c9a":"pvalues.plot(kind=\"barh\")","3c40cc7c":"from sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import r2_score, mean_squared_error","1e591ff1":"X = df.drop([\"Cnt\",\"Dteday\",\"Season\",\"Workingday\",\"Weathersit\",\"Yr\"], axis=1)\ny = df.Cnt","8feded94":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=24)\nprint(X_train.shape)\nprint(y_train.shape)","d29bedc0":"regressor = LinearRegression()\nregressor.fit(X_train, y_train)\ny_pred = regressor.predict(X_test)","d2cb1d07":"pred = pd.DataFrame({\"Actual\":y_test,\"Prediction\":y_pred})","393edc6c":"pred.head(10)","44d9e01c":"r2_score(y_pred, y_test)","5c66e08c":"import math\nprint(f\"MEAN SQUARED ERROR: {mean_squared_error(y_test, y_pred)}\")\nprint(f\"ROOT MEAN SQUARED ERROR: {np.sqrt(mean_squared_error(y_test, y_pred))}\")","188798af":"plt.figure(figsize=(10,6))\nsns.scatterplot(x=y_pred,y=y_test,marker=\"*\")","ff9af7cd":"# Feature Selection using chi-square test","e979564b":"<div class=\"alert alert-box alert-info\">\nThank you!\n<\/div>","37ea4194":"<div class=\"alert alert-box alert-warning\">\nM.S.E can be reduced by applying GridSearchCV or RandomizedSearchCV to obtain better results.\n    <\/div>","b7695307":"# Prediction...\ud83c\udfaf","b88d2cc4":"# Importing Libraries","ec38ee54":"<div class=\"alert alert-box alert-info\">\nDiscarding [Season, Workingday, Weathersit, Yr] Columns from the data according to their feature importance as observed from chi-square test.\n<\/div>","9e97e99a":"# Model Training...\ud83d\udeb4","85bb7b3f":"* We do not have any null values in the dataset.","380c8bf8":"# Data Visualization"}}