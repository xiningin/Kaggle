{"cell_type":{"a1afeedc":"code","80e567bc":"code","b3c5f765":"code","4ffa5afe":"code","a1e5ecef":"code","6e1e3f95":"code","73eeb701":"code","1e77bc9d":"code","b4c0af32":"code","500e26ed":"code","ae2c9565":"code","c70624f6":"code","a1fc1dcc":"code","c6acd593":"markdown","5268f5af":"markdown","de365e2f":"markdown","9a27ba22":"markdown","40aaf2dd":"markdown","dfc2d4b0":"markdown","a4a692bd":"markdown","8b07743d":"markdown","6c178c93":"markdown","879ddc89":"markdown","50108c56":"markdown","2a85b8bc":"markdown","a9eee662":"markdown","58734cc9":"markdown"},"source":{"a1afeedc":"# You can easily install the library using pip\n!pip install h2o","80e567bc":"# And then load the libraries you'll use in this notebook\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\n\nimport h2o\nfrom h2o.automl import H2OAutoML","b3c5f765":"# Initialize your cluster\nh2o.init()","4ffa5afe":"train = h2o.import_file('\/kaggle\/input\/house-prices-advanced-regression-techniques\/train.csv')\ntest = h2o.import_file('\/kaggle\/input\/house-prices-advanced-regression-techniques\/test.csv')\ntrain.head()","a1e5ecef":"train = train[train['GrLivArea'] < 4500]\ntrain['SalePrice'] = train['SalePrice'].log1p()","6e1e3f95":"# Identify predictors and response\nx = [col for col in train.columns if col not in ['Id','SalePrice']]\ny = 'SalePrice'\ntest_id = test['Id']","73eeb701":"aml = H2OAutoML( max_runtime_secs=30000,nfolds=10, stopping_metric = 'RMSLE')\naml.train(x = x, y = y, training_frame = train)","1e77bc9d":"#                max_runtime_secs=36000,\u6700\u5927\u8fd0\u884c\u65f6\u95f4\n#                max_runtime_secs_per_model=3600,\u6700\u5927\u5355\u6a21\u578b\u8fd0\u884c\u65f6\u95f4\n#seed\uff0c\u968f\u4fbf\u9009\uff0c\u968f\u673a\u79cd\u5b50\n#                nfolds=10, \u4ea4\u53c9\u9a8c\u8bc1\uff0c\u8d8a\u5927\u4ea4\u53c9\u9a8c\u8bc1\u5ea6\u8d8a\u9ad8\uff0c\u7ed3\u679c\u8d8a\u597d\uff0c\u8d8a\u8017\u65f6\uff0c\u9ed8\u8ba4\u4e3a5\n#sort_metric: Specifies the metric used to sort the Leaderboard by at the end of an AutoML run. Available options include:\n#AUTO: This defaults to AUC for binary classification, mean_per_class_error for multinomial classification, and deviance for regression.\n#For binomial classification choose between AUC, \"logloss\", \"mean_per_class_error\", \"RMSE\", \"MSE\". For multinomial classification choose between \"mean_per_class_error\", \"logloss\", \"RMSE\", \"MSE\". For regression choose between \"deviance\", \"RMSE\", \"MSE\", \"MAE\", \"RMLSE\".\n#max_models=333,\u6700\u5927\u6a21\u578b\u6570\u76ee\uff1b\u9ed8\u8ba4\u4e3a\u65e0\u7a77\u5927\n#                include_algos=['XGBoost'], \u6b64\u9009\u9879\u5141\u8bb8\u60a8\u6307\u5b9a\u5728\u6a21\u578b\u6784\u5efa\u9636\u6bb5\u8981\u5305\u62ec\u5728AutoML\u8fd0\u884c\u4e2d\u7684\u7b97\u6cd5\u5217\u8868\u3002\u8be5\u9009\u9879\u9ed8\u8ba4\u4e3aNone \/ Null\uff0c\u8fd9\u610f\u5473\u7740\u5c06\u5305\u62ec\u6240\u6709\u7b97\u6cd5\uff0c\u9664\u975e\u5728\u8be5exclude_algos\u9009\u9879\u4e2d\u6307\u5b9a\u4e86\u4efb\u4f55\u7b97\u6cd5\u3002\n#                verbosity='info'\u4f20\u9012\u4f55\u79cd\u4fe1\u606f\uff0cinfo\u4e3a\u5168\u90e8","b4c0af32":"lb = aml.leaderboard; lb","500e26ed":"aml.leader","ae2c9565":"aml.leader.varimp_plot()","c70624f6":"preds = aml.leader.predict(test)","a1fc1dcc":"# Convert results back(they had been transformed using log, remember?) and save them in a csv format.\nresult = preds.expm1()\nsub = test_id.cbind(result)\nsub.columns = ['Id','SalePrice']\nsub = sub.as_data_frame()\nsub.to_csv('submission.csv', index = False)","c6acd593":"# *Using H2o AutoML to predict housing prices*","5268f5af":"It also gives you the Feature Importance","de365e2f":"I won't perform neither EDA nor Feature Engineering as these are not the focus of this kernel. At least not an extensive one. Here I'll only drop registers whose `GrLivArea` are above 4500 and log transform the target variable `SalePrice`.","9a27ba22":"### EDA, Data Processing and Feature Engineering","40aaf2dd":"### Using H2o AutoML","dfc2d4b0":"You can simply call predict on your best model","a4a692bd":"The attribute `leader` of your AutoML object holds the data about your best model.","8b07743d":"### Load train and test datasets","6c178c93":"### Predict","879ddc89":"This quick tutorial shows how you can use H2o AutoML to train and evaluate a large amount of models with only a few lines of coding.\nPlease, upvote if you find it useful.","50108c56":"The H2OAutoML function is quite easy to use. You specify the dataset you will use for training at `training_frame`, while `x` and `y` receives the column names of the features which will be used and the name of the target variable, respectively.\n\nYou can customize your AutoML to fit your needs. You can add or exclude algorithms, set nfolds for cross-validation, choose metrics, use validation sets, early stopping and so on. Please check the documentation at http:\/\/docs.h2o.ai\/h2o\/latest-stable\/h2o-docs\/automl.html","2a85b8bc":"### Load libraries","a9eee662":"Let's now create our model:","58734cc9":"The Leaderboard displays the performance of the trained models"}}