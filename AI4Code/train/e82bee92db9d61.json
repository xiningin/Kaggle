{"cell_type":{"8f6b98e4":"code","7c6b5bf0":"code","607abcb0":"code","2b7cff02":"code","a57ddcb5":"code","83929031":"code","33651b5b":"code","50fcf390":"code","5fb88151":"code","a926b594":"code","99fc48a2":"markdown","a3f5c7a9":"markdown","4d53aa41":"markdown","c31ea1f3":"markdown","5c95ea8b":"markdown","93e89830":"markdown","290c4d6d":"markdown"},"source":{"8f6b98e4":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom functools import reduce\nimport plotly.graph_objs as go\nfrom plotly.offline import init_notebook_mode,iplot\ninit_notebook_mode(connected=True)\npd.set_option('display.max_columns', None)\npd.options.mode.chained_assignment = None\n\ndf20 = pd.read_csv('\/kaggle\/input\/fifa-20-complete-player-dataset\/players_20.csv')\ndf19 = pd.read_csv('\/kaggle\/input\/fifa-20-complete-player-dataset\/players_19.csv')\ndf18 = pd.read_csv('\/kaggle\/input\/fifa-20-complete-player-dataset\/players_18.csv')\ndf17 = pd.read_csv('\/kaggle\/input\/fifa-20-complete-player-dataset\/players_17.csv')\ndf16 = pd.read_csv('\/kaggle\/input\/fifa-20-complete-player-dataset\/players_16.csv')\ndf15 = pd.read_csv('\/kaggle\/input\/fifa-20-complete-player-dataset\/players_15.csv')","7c6b5bf0":"#from the kernel https:\/\/www.kaggle.com\/laowingkin\/fifa-18-find-the-best-squad\n#thanks DLao\n\ndf20_pot = df20[(df20.age.astype(int) >= 18) & (df20.age.astype(int) <= 35)].groupby(['age'])['potential'].mean()\ndf20_over = df20[(df20.age.astype(int) >= 18) & (df20.age.astype(int) <= 35)].groupby(['age'])['overall'].mean()\ndf20_summary = pd.concat([df20_pot, df20_over], axis=1)\ndf19_pot = df19[(df19.age.astype(int) >= 18) & (df19.age.astype(int) <= 35)].groupby(['age'])['potential'].mean()\ndf19_over = df19[(df19.age.astype(int) >= 18) & (df19.age.astype(int) <= 35)].groupby(['age'])['overall'].mean()\ndf19_summary = pd.concat([df19_pot, df19_over], axis=1)\ndf18_pot = df18[(df18.age.astype(int) >= 18) & (df18.age.astype(int) <= 35)].groupby(['age'])['potential'].mean()\ndf18_over = df18[(df18.age.astype(int) >= 18) & (df18.age.astype(int) <= 35)].groupby(['age'])['overall'].mean()\ndf18_summary = pd.concat([df18_pot, df18_over], axis=1)\ndf17_pot = df17[(df17.age.astype(int) >= 18) & (df17.age.astype(int) <= 35)].groupby(['age'])['potential'].mean()\ndf17_over = df17[(df17.age.astype(int) >= 18) & (df17.age.astype(int) <= 35)].groupby(['age'])['overall'].mean()\ndf17_summary = pd.concat([df17_pot, df17_over], axis=1)\ndf16_pot = df16[(df16.age.astype(int) >= 18) & (df16.age.astype(int) <= 35)].groupby(['age'])['potential'].mean()\ndf16_over = df16[(df16.age.astype(int) >= 18) & (df16.age.astype(int) <= 35)].groupby(['age'])['overall'].mean()\ndf16_summary = pd.concat([df16_pot, df16_over], axis=1)\ndf15_pot = df15[(df15.age.astype(int) >= 18) & (df15.age.astype(int) <= 35)].groupby(['age'])['potential'].mean()\ndf15_over = df15[(df15.age.astype(int) >= 18) & (df15.age.astype(int) <= 35)].groupby(['age'])['overall'].mean()\ndf15_summary = pd.concat([df15_pot, df15_over], axis=1)\n\nfig, (ax1, ax2, ax3, ax4, ax5, ax6) = plt.subplots(nrows=6, ncols=1, figsize=(10, 25))\nax1.plot(df20_summary)\nax1.set_ylabel('Rating')\nax1.set_title('FIFA 20 - Average Rating by Age')\nax2.plot(df19_summary)\nax2.set_ylabel('Rating')\nax2.set_title('FIFA 19 - Average Rating by Age')\nax3.plot(df18_summary)\nax3.set_ylabel('Rating')\nax3.set_title('FIFA 18 - Average Rating by Age')\nax4.plot(df17_summary)\nax4.set_ylabel('Rating')\nax4.set_title('FIFA 17 - Average Rating by Age')\nax5.plot(df16_summary)\nax5.set_ylabel('Rating')\nax5.set_title('FIFA 16 - Average Rating by Age')\nax6.plot(df15_summary)\nax6.set_ylabel('Rating')\nax6.set_title('FIFA 15 - Average Rating by Age')","607abcb0":"df20['best_position'] = df20['player_positions'].str.split(',').str[0]\ndf19['best_position'] = df19['player_positions'].str.split(',').str[0]\ndf18['best_position'] = df18['player_positions'].str.split(',').str[0]\ndf17['best_position'] = df17['player_positions'].str.split(',').str[0]\ndf16['best_position'] = df16['player_positions'].str.split(',').str[0]\ndf15['best_position'] = df15['player_positions'].str.split(',').str[0]\n\ndef get_best_squad(df_name, position):\n    df_copy = df_name.copy()\n    store = []\n    for i in position:\n        store.append([i,df_copy.loc[[df_copy[df_copy['best_position'] == i]['overall'].idxmax()]]['short_name'].to_string(index = False), df_copy[df_copy['best_position'] == i]['overall'].max()])\n        df_copy.drop(df_copy[df_copy['best_position'] == i]['overall'].idxmax(), inplace = True)\n    #return store\n    return pd.DataFrame(np.array(store).reshape(11,3), columns = ['Position', 'Player', 'Overall']).to_string(index = False)\n\n# 4-3-3\nsquad_433 = ['GK', 'LB', 'CB', 'CB', 'RB', 'LM', 'CDM', 'RM', 'LW', 'ST', 'RW']\nprint ('4-3-3 in FIFA 20')\nprint (get_best_squad(df20, squad_433))\nprint ('\\n4-3-3 in FIFA 19')\nprint (get_best_squad(df19, squad_433))\nprint ('\\n4-3-3 in FIFA 18')\nprint (get_best_squad(df18, squad_433))\nprint ('\\n4-3-3 in FIFA 17')\nprint (get_best_squad(df17, squad_433))\nprint ('\\n4-3-3 in FIFA 16')\nprint (get_best_squad(df16, squad_433))\nprint ('\\n4-3-3 in FIFA 15')\nprint (get_best_squad(df15, squad_433))","2b7cff02":"# 3-5-2\nsquad_352 = ['GK', 'LWB', 'CB', 'RWB', 'LM', 'CDM', 'CAM', 'CM', 'RM', 'LW', 'RW']\nprint ('3-5-2 in FIFA 20')\nprint (get_best_squad(df20, squad_352))\nprint ('\\n3-5-2 in FIFA 19')\nprint (get_best_squad(df19, squad_352))\nprint ('\\n3-5-2 in FIFA 18')\nprint (get_best_squad(df18, squad_352))\nprint ('\\n3-5-2 in FIFA 17')\nprint (get_best_squad(df17, squad_352))\nprint ('\\n3-5-2 in FIFA 16')\nprint (get_best_squad(df16, squad_352))\nprint ('\\n3-5-2 in FIFA 15')\nprint (get_best_squad(df15, squad_352))","a57ddcb5":"df20['value_million_eur'] = pd.to_numeric(df20['value_eur'], errors='coerce') \/ 1000000\ndf19['value_million_eur'] = pd.to_numeric(df19['value_eur'], errors='coerce') \/ 1000000\ndf18['value_million_eur'] = pd.to_numeric(df18['value_eur'], errors='coerce') \/ 1000000\ndf17['value_million_eur'] = pd.to_numeric(df17['value_eur'], errors='coerce') \/ 1000000\ndf16['value_million_eur'] = pd.to_numeric(df16['value_eur'], errors='coerce') \/ 1000000\ndf15['value_million_eur'] = pd.to_numeric(df15['value_eur'], errors='coerce') \/ 1000000\n\ndef get_best_squad(df_name, position, club = '*', measurement = 'overall'):\n    df_copy = df_name.copy()\n    df_copy = df_copy[df_copy['club'] == club]\n    store = []\n    for i in position:\n        store.append([df_copy.loc[[df_copy[df_copy['best_position'].str.contains(i)][measurement].idxmax()]]['best_position'].to_string(index = False),df_copy.loc[[df_copy[df_copy['best_position'].str.contains(i)][measurement].idxmax()]]['short_name'].to_string(index = False), df_copy[df_copy['best_position'].str.contains(i)][measurement].max(), float(df_copy.loc[[df_copy[df_copy['best_position'].str.contains(i)][measurement].idxmax()]]['value_million_eur'].to_string(index = False))])\n        df_copy.drop(df_copy[df_copy['best_position'].str.contains(i)][measurement].idxmax(), inplace = True)\n    return np.mean([x[2] for x in store]).round(1), pd.DataFrame(np.array(store).reshape(11,4), columns = ['Position', 'Player', measurement, 'Value (M)']).to_string(index = False), np.sum([x[3] for x in store]).round(1)\n\n# easier constraint\nsquad_433_adj = ['GK', 'B$', 'B$', 'B$', 'B$', 'M$', 'M$', 'M$', 'W$|T$', 'W$|T$', 'W$|T$']\n\n# Example Output for ManCity\nrating_433_ManCity_Overall, best_list_433_ManCity_Overall, value_433_ManCity_Overall = get_best_squad(df20, squad_433_adj, 'Manchester City', 'overall')\nrating_433_ManCity_Potential, best_list_433_ManCity_Potential, value_433_ManCity_Potential  = get_best_squad(df20, squad_433_adj, 'Manchester City', 'potential')\nprint('FIFA 20 - Manchester City\\n')\nprint('-Overall-')\nprint('Average rating: {:.1f}'.format(rating_433_ManCity_Overall))\nprint('Total Value (M): {:.1f}'.format(value_433_ManCity_Overall))\nprint(best_list_433_ManCity_Overall)\nprint('\\n-Potential-')\nprint('Average rating: {:.1f}'.format(rating_433_ManCity_Potential))\nprint('Total Value (M): {:.1f}'.format(value_433_ManCity_Potential))\nprint(best_list_433_ManCity_Potential)","83929031":"# Example Output for ManUtd\nrating_433_ManUtd_Overall, best_list_433_ManUtd_Overall, value_433_ManUtd_Overall = get_best_squad(df20, squad_433_adj, 'Manchester United', 'overall')\nrating_433_ManUtd_Potential, best_list_433_ManUtd_Potential, value_433_ManUtd_Potential  = get_best_squad(df20, squad_433_adj, 'Manchester United', 'potential')\nprint('FIFA 20 - Manchester United\\n')\nprint('-Overall-')\nprint('Average rating: {:.1f}'.format(rating_433_ManUtd_Overall))\nprint('Total Value (M): {:.1f}'.format(value_433_ManUtd_Overall))\nprint(best_list_433_ManUtd_Overall)\nprint('\\n-Potential-')\nprint('Average rating: {:.1f}'.format(rating_433_ManUtd_Potential))\nprint('Total Value (M): {:.1f}'.format(value_433_ManUtd_Potential))\nprint(best_list_433_ManUtd_Potential)","33651b5b":"def get_top20_players(df_name):\n    df_copy = df_name.sort_values(['overall', 'potential'], ascending=[False, False]).head(20)\n    store = []\n    for index, row in df_copy.iterrows():\n        store.append([row['best_position'], row['short_name'], row['overall'], row['potential'], row['age']])\n    return np.mean([x[2] for x in store]).round(1), np.mean([x[3] for x in store]).round(1), np.mean([x[4] for x in store]).round(1), pd.DataFrame(np.array(store).reshape(20, 5), columns = ['Position', 'Player', 'Overall', 'Potential', 'Age']).to_string(index = False)\n\ntop20_players20_overall, top20_players20_potential, top20_players20_age, top20_players20 = get_top20_players(df20)\nprint('FIFA 20 - Top 20 Players')\nprint('Average overall: {:.1f}'.format(top20_players20_overall))\nprint('Average potential: {:.1f}'.format(top20_players20_potential))\nprint('Average age: {:.1f}'.format(top20_players20_age))\nprint(top20_players20)\n\ntop20_players19_overall, top20_players19_potential, top20_players19_age, top20_players19 = get_top20_players(df19)\nprint('\\nFIFA 19 - Top 20 Players')\nprint('Average overall: {:.1f}'.format(top20_players19_overall))\nprint('Average potential: {:.1f}'.format(top20_players19_potential))\nprint('Average age: {:.1f}'.format(top20_players19_age))\nprint(top20_players19)\n\ntop20_players18_overall, top20_players18_potential, top20_players18_age, top20_players18 = get_top20_players(df18)\nprint('\\nFIFA 18 - Top 20 Players')\nprint('Average overall: {:.1f}'.format(top20_players18_overall))\nprint('Average potential: {:.1f}'.format(top20_players18_potential))\nprint('Average age: {:.1f}'.format(top20_players18_age))\nprint(top20_players18)\n\ntop20_players17_overall, top20_players17_potential, top20_players17_age, top20_players17 = get_top20_players(df17)\nprint('\\nFIFA 17 - Top 20 Players')\nprint('Average overall: {:.1f}'.format(top20_players17_overall))\nprint('Average potential: {:.1f}'.format(top20_players17_potential))\nprint('Average age: {:.1f}'.format(top20_players17_age))\nprint(top20_players17)\n\ntop20_players16_overall, top20_players16_potential, top20_players16_age, top20_players16 = get_top20_players(df16)\nprint('\\nFIFA 16 - Top 20 Players')\nprint('Average overall: {:.1f}'.format(top20_players16_overall))\nprint('Average potential: {:.1f}'.format(top20_players16_potential))\nprint('Average age: {:.1f}'.format(top20_players16_age))\nprint(top20_players16)\n\ntop20_players15_overall, top20_players15_potential, top20_players15_age, top20_players15 = get_top20_players(df15)\nprint('\\nFIFA 15 - Top 20 Players')\nprint('Average overall: {:.1f}'.format(top20_players15_overall))\nprint('Average potential: {:.1f}'.format(top20_players15_potential))\nprint('Average age: {:.1f}'.format(top20_players15_age))\nprint(top20_players15)","50fcf390":"#['Lionel Andr\u00e9s Messi Cuccittini', 'Cristiano Ronaldo dos Santos Aveiro', 'Neymar da Silva Santos Junior', 'Jan Oblak', 'Eden Hazard', 'Kevin De Bruyne', 'Marc-Andr\u00e9 ter Stegen', 'Virgil van Dijk', 'Luka Modri\u0107', 'Mohamed  Salah Ghaly', 'Kylian Mbapp\u00e9', 'Kalidou Koulibaly', 'Harry Kane', 'Alisson Ramses Becker', 'David De Gea Quintana', \"N'Golo Kant\u00e9\", 'Giorgio Chiellini', 'Sergio Leonel Ag\u00fcero del Castillo', 'Sergio Ramos Garc\u00eda', 'Luis Alberto Su\u00e1rez D\u00edaz']\ntop20_players20_list = df20.sort_values(['overall', 'potential'], ascending=[False, False]).head(20)['long_name'].tolist()\nfiltered_players20 = df20[df20['long_name'].isin(top20_players20_list)][['short_name', 'overall', 'potential']]\nfiltered_players20.columns = ['short_name', 'overall20', 'potential20']\nfiltered_players20.set_index('short_name', inplace=True)\nfiltered_players19 = df19[df19['long_name'].isin(top20_players20_list)][['short_name', 'overall', 'potential']]\nfiltered_players19.columns = ['short_name', 'overall19', 'potential19']\nfiltered_players19.set_index('short_name', inplace=True)\nfiltered_players18 = df18[df18['long_name'].isin(top20_players20_list)][['short_name', 'overall', 'potential']]\nfiltered_players18.columns = ['short_name', 'overall18', 'potential18']\nfiltered_players18.set_index('short_name', inplace=True)\ntop20_players20_list = [item.replace('Kylian Mbapp\u00e9', 'Kylian Mbappe Lottin') for item in top20_players20_list] #Mbappe had a different name in FIFA 17\nfiltered_players17 = df17[df17['long_name'].isin(top20_players20_list)][['short_name', 'overall', 'potential']]\nfiltered_players17.at[3899, 'short_name'] = 'Kylian Mbapp\u00e9'\nfiltered_players17.columns = ['short_name', 'overall17', 'potential17']\nfiltered_players17.set_index('short_name', inplace=True)\nfiltered_players16 = df16[df16['long_name'].isin(top20_players20_list)][['short_name', 'overall', 'potential']] #VVD was not included in the sofifa database as of 21.09.2015 (not anymore in Celtic, not yet in Southamption)\nfiltered_players16.columns = ['short_name', 'overall16', 'potential16']\nfiltered_players16.set_index('short_name', inplace=True)\nfiltered_players15 = df15[df15['long_name'].isin(top20_players20_list)][['short_name', 'overall', 'potential']]\nfiltered_players15.columns = ['short_name', 'overall15', 'potential15']\nfiltered_players15.set_index('short_name', inplace=True)\n\ndfs = [filtered_players20, filtered_players19, filtered_players18, filtered_players17, filtered_players16, filtered_players15]\nmerged_df = reduce(lambda left,right: pd.merge(left, right, on='short_name'), dfs)\noverall_df = merged_df[['overall20', 'overall19', 'overall18', 'overall17', 'overall16', 'overall15']]\noverall_df.columns = ['FIFA 20', 'FIFA 19', 'FIFA 18', 'FIFA 17', 'FIFA 16', 'FIFA 15']\npotential_df = merged_df[['potential20', 'potential19', 'potential18', 'potential17', 'potential16', 'potential15']]\npotential_df.columns = ['FIFA 20', 'FIFA 19', 'FIFA 18', 'FIFA 17', 'FIFA 16', 'FIFA 15']","5fb88151":"transposed_overall_df = overall_df.T.sort_index(ascending=True)\nplt.rcParams[\"figure.figsize\"] = [15, 10]\nax = transposed_overall_df.plot()\nax.set_ylabel('Overall Rating')\nax.set_title('FIFA 20 - Top 20 Players Historical Overall Rating')","a926b594":"transposed_potential_df = potential_df.T.sort_index(ascending=True)\nplt.rcParams[\"figure.figsize\"] = [15, 10]\nax = transposed_potential_df.plot()\nax.set_ylabel('Potential Rating')\nax.set_title('FIFA 20 - Top 20 Players Historical Potential Rating')","99fc48a2":"Average rating by age comparison between the FIFA versions","a3f5c7a9":"Trend line of Top 20 players Overall Rating","4d53aa41":"Dream Team in FIFA 20 to play with 4-3-3 and 3-5-2","c31ea1f3":"Importing libraries and reading the datasets","5c95ea8b":"ManCity and ManUtd squads with the best players (Overall and Potential attributes) ","93e89830":"Trend line of Top 20 players Potential Rating","290c4d6d":"Top 20 FIFA players from the version 15 to FIFA 20"}}