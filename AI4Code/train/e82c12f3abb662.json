{"cell_type":{"7ea8c9a9":"code","ef6d4fa7":"code","bb53609f":"code","0f2df4f1":"code","27118319":"code","c3f7234c":"code","2c6db72d":"code","df1e097b":"code","5ee95295":"code","6f9f66a2":"code","70eb1691":"code","1a95cbac":"code","2dd6490b":"code","e7014aaa":"code","5049ef2a":"code","10e1821e":"code","a30514a1":"code","1b3c7ffd":"code","31ec9148":"code","c536f070":"code","6fa6eae2":"code","2fd1680b":"code","c4db3334":"code","5083cceb":"markdown","b55a75b5":"markdown"},"source":{"7ea8c9a9":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings('ignore')\n\n# setting up options\npd.set_option('display.max_rows', None)\npd.set_option('display.max_columns', None)","ef6d4fa7":"train = pd.read_csv('..\/input\/tabular-playground-series-jun-2021\/train.csv')\ntest = pd.read_csv('..\/input\/tabular-playground-series-jun-2021\/test.csv')","bb53609f":"train.drop('id', axis = 1, inplace = True)\ntest.drop('id', axis = 1, inplace = True)","0f2df4f1":"train.head()","27118319":"#Let's print a concise summary of train DataFrame.\ntrain.info()","c3f7234c":"#descriptive statistics of train set\ntrain.describe().T.style.bar(subset=['mean'], color='#606ff2').background_gradient(subset=['std'],cmap='YlOrBr').bar(subset=['max'],color='green')","2c6db72d":"# comparing zero rate in a column\npd.DataFrame((train==0).sum()\/len(train), columns=[\"zero_rate\"]).style.bar(subset=['zero_rate'], color='#20c8f2')","df1e097b":"#visualizing in Pie chart\nlabels = 'Class_6', 'Class_8', 'Class_9', 'Class_2', 'Class_3', 'Class_7', 'Class_1', 'Class_4', 'Class_5'\nexplode = (0, 0, 0, 0, 0, 0.1, 0.1, 0.1, 0.2)\n\nfig1, ax1 = plt.subplots()\nax1.pie(train['target'].value_counts(), explode=explode, labels=labels, autopct='%1.1f%%',\n        shadow=True, startangle=30)\nax1.axis('equal')\nplt.show()","5ee95295":"classes = ['Class_6', 'Class_8', 'Class_9', 'Class_2', 'Class_3', 'Class_7', 'Class_1', 'Class_4', 'Class_5']\nvalues = [51811, 51763, 25542, 24431, 14798, 14769, 9118, 4704, 3064]","6f9f66a2":"plt.rcParams['figure.dpi'] = 500\nfig = plt.figure(figsize=(3, 2), facecolor='#f6f5f5')\n\n#Specifies the geometry of the grid that a subplot will be placed.\ngs = fig.add_gridspec(1, 1)\ngs.update(wspace=0.4, hspace=0.1)\n\nbackground_color = \"#f6f5f5\"\nsns.set_palette(['#ffd514']*75)\n\nax0 = fig.add_subplot(gs[0, 0])\nfor s in [\"right\", \"top\"]:\n    ax0.spines[s].set_visible(False)\nax0.set_facecolor(background_color)\nax0_sns = sns.barplot(y=classes, x=values,  \n                      zorder=2, linewidth=0, orient=None, saturation=1, alpha=1)\nax0_sns.set_xlabel(\"Number of samples\",fontsize=4, weight='bold')\nax0_sns.set_ylabel(\"Features\",fontsize=4, weight='bold')\n\n#Change the appearance of ticks, tick labels, and gridlines.\nax0_sns.tick_params(labelsize=4, width=0.5, length=1.5)\n\nax0_sns.grid(which='major', axis='x', zorder=0, color='#EEEEEE', linewidth=0.4)\nax0_sns.grid(which='major', axis='y', zorder=0, color='#EEEEEE', linewidth=0.4)\nax0.text(0, -1.9, 'Number of samples belong to a class', fontsize=6, ha='left', va='top', weight='bold')\n\n# data label\nfor p in ax0.patches:\n    value = f'{p.get_width():.0f}'\n    x = p.get_x() + p.get_width() + 3\n    y = p.get_y() + p.get_height() \/ 2 \n    ax0.text(x, y, value, ha='center', va='center', fontsize=4, \n            bbox=dict(facecolor='none', edgecolor='black', boxstyle='round', linewidth=0.3))","70eb1691":"#let's check out the kernel density estimation for every column\nimport matplotlib.ticker as ticker\nfrom matplotlib.ticker import PercentFormatter\n\nplt.rcParams['figure.dpi'] = 600\nfig = plt.figure(figsize=(10, 10), facecolor='#f6f5f5')\ngs = fig.add_gridspec(15, 5)\ngs.update(wspace=0.3, hspace=0.3)\n\nbackground_color = \"#f6f5f5\"\nsns.set_palette('icefire')\n\nrun_no = 0\nfor row in range(0, 15):\n    for col in range(0, 5):\n        locals()[\"ax\"+str(run_no)] = fig.add_subplot(gs[row, col])\n        locals()[\"ax\"+str(run_no)].set_facecolor(background_color)\n        for s in [\"top\",\"right\"]:\n            locals()[\"ax\"+str(run_no)].spines[s].set_visible(False)\n        run_no += 1\n\nnew_train = train.drop('target', axis = 1)\nfeatures = list(new_train.columns) \n\nrun_no = 0\nfor col in features:\n    sns.kdeplot(ax=locals()[\"ax\"+str(run_no)],x=col, data = new_train)\n    locals()[\"ax\"+str(run_no)].grid(which='major', axis='x', zorder=0, color='#EEEEEE', linewidth=0.4)\n    locals()[\"ax\"+str(run_no)].grid(which='major', axis='y', zorder=0, color='#EEEEEE', linewidth=0.4)\n    locals()[\"ax\"+str(run_no)].set_ylabel('')\n    locals()[\"ax\"+str(run_no)].set_xlabel(col, fontsize=4, fontweight='bold')\n    locals()[\"ax\"+str(run_no)].tick_params(labelsize=4, width=0.5, length=1.5)\n    locals()[\"ax\"+str(run_no)].yaxis.set_major_formatter(ticker.PercentFormatter())\n    run_no += 1\n\nplt.show()","1a95cbac":"# let's get a idea about value range\nplt.figure(figsize=(18,25))\nsns.boxplot(data=train, orient=\"h\");","2dd6490b":"#finding unique values for train set\nfeatures = list(train.columns)\nfor feature in features:\n    temp = train[feature].unique()\n    train_unique_values = temp\ntrain_unique_values = np.unique(train_unique_values)\ntrain_unique_feature = pd.DataFrame(train[features].nunique())\ntrain_unique_feature = train_unique_feature.reset_index(drop=False)\ntrain_unique_feature.columns = ['Features', 'Count']","e7014aaa":"plt.rcParams['figure.dpi'] = 500\nfig = plt.figure(figsize=(4, 8), facecolor='#f6f5f5')\n\n#Specifies the geometry of the grid that a subplot will be placed.\ngs = fig.add_gridspec(1, 1)\ngs.update(wspace=0.4, hspace=0.1)\n\nbackground_color = \"#f6f5f5\"\nsns.set_palette('rocket_r')\n\nax0 = fig.add_subplot(gs[0, 0])\nfor s in [\"right\", \"top\"]:\n    ax0.spines[s].set_visible(False)\nax0.set_facecolor(background_color)\nax0_sns = sns.barplot(y=train_unique_feature['Features'], x=train_unique_feature['Count'],  \n                      zorder=2, linewidth=0, orient=None, saturation=1, alpha=1)\nax0_sns.set_xlabel(\"Number of unique values\",fontsize=4, weight='bold')\nax0_sns.set_ylabel(\"Features\",fontsize=4, weight='bold')\n\n#Change the appearance of ticks, tick labels, and gridlines.\nax0_sns.tick_params(labelsize=4, width=0.5, length=1.5)\n\nax0_sns.grid(which='major', axis='x', zorder=0, color='#EEEEEE', linewidth=0.4)\nax0_sns.grid(which='major', axis='y', zorder=0, color='#EEEEEE', linewidth=0.4)\nax0.text(0, -1.9, 'Unique values in Train Set', fontsize=6, ha='left', va='top', weight='bold')\n\n# data label\nfor p in ax0.patches:\n    value = f'{p.get_width():.0f}'\n    x = p.get_x() + p.get_width() + 3\n    y = p.get_y() + p.get_height() \/ 2 \n    ax0.text(x, y, value, ha='center', va='center', fontsize=4, \n            bbox=dict(facecolor='none', edgecolor='black', boxstyle='round', linewidth=0.3))","5049ef2a":"#finding unique values for test set\nfeatures = list(test.columns)\nfor feature in features:\n    temp = test[feature].unique()\n    test_unique_values = temp\ntest_unique_values = np.unique(test_unique_values)\ntest_unique_features = pd.DataFrame(test[features].nunique())\ntest_unique_features = test_unique_features.reset_index(drop=False)\ntest_unique_features.columns = ['Features', 'Count']","10e1821e":"plt.rcParams['figure.dpi'] = 500\nfig = plt.figure(figsize=(4, 8), facecolor='#f6f5f5')\n\n#Specifies the geometry of the grid that a subplot will be placed.\ngs = fig.add_gridspec(1, 1)\ngs.update(wspace=0.4, hspace=0.1)\n\nbackground_color = \"#f6f5f5\"\nsns.set_palette('vlag')\n\nax0 = fig.add_subplot(gs[0, 0])\nfor s in [\"right\", \"top\"]:\n    ax0.spines[s].set_visible(False)\nax0.set_facecolor(background_color)\nax0_sns = sns.barplot(y=test_unique_features['Features'], x=test_unique_features['Count'],  \n                      zorder=2, linewidth=0, saturation=1, alpha=1)\nax0_sns.set_xlabel(\"Number of unique values\",fontsize=4, weight='bold')\nax0_sns.set_ylabel(\"Features\",fontsize=4, weight='bold')\n\n#Change the appearance of ticks, tick labels, and gridlines.\nax0_sns.tick_params(labelsize=4, width=0.5, length=1.5)\n\nax0_sns.grid(which='major', axis='x', zorder=0, color='#EEEEEE', linewidth=0.4)\nax0_sns.grid(which='major', axis='y', zorder=0, color='#EEEEEE', linewidth=0.4)\nax0.text(0, -1.9, 'Unique values in Test Set', fontsize=6, ha='left', va='top', weight='bold')\n\n# data label\nfor p in ax0.patches:\n    value = f'{p.get_width():.0f}'\n    x = p.get_x() + p.get_width() + 3\n    y = p.get_y() + p.get_height() \/ 2 \n    ax0.text(x, y, value, ha='center', va='center', fontsize=4, \n            bbox=dict(facecolor='none', edgecolor='black', boxstyle='round', linewidth=0.3))","a30514a1":"plt.rcParams['figure.dpi'] = 600\nfig = plt.figure(figsize=(10, 10), facecolor='#f6f5f5')\ngs = fig.add_gridspec(5, 5)\ngs.update(wspace=0.3, hspace=0.3)\n\nbackground_color = \"#f6f5f5\"\nsns.set_palette('Spectral')\n\nrun_no = 0\nfor row in range(0, 5):\n    for col in range(0, 5):\n        locals()[\"ax\"+str(run_no)] = fig.add_subplot(gs[row, col])\n        locals()[\"ax\"+str(run_no)].set_facecolor(background_color)\n        for s in [\"top\",\"right\"]:\n            locals()[\"ax\"+str(run_no)].spines[s].set_visible(False)\n        run_no += 1\n\nax0.text(-0.5, 92, 'Top 5 Values in Train set', fontsize=10, fontweight='bold')       \n\nfeatures = list(train.columns[1:26])\n\nrun_no = 0\nfor col in features:\n    temp_df = pd.DataFrame(train[col].value_counts())[:5]\n    temp_df = temp_df.reset_index(drop=False)\n    temp_df.columns = ['Number', 'Count']\n    sns.barplot(ax=locals()[\"ax\"+str(run_no)],x=temp_df['Number'], y=temp_df['Count']\/len(train)*100, zorder=2, linewidth=0, alpha=1, saturation=1)\n    locals()[\"ax\"+str(run_no)].grid(which='major', axis='x', zorder=0, color='#EEEEEE', linewidth=0.4)\n    locals()[\"ax\"+str(run_no)].grid(which='major', axis='y', zorder=0, color='#EEEEEE', linewidth=0.4)\n    locals()[\"ax\"+str(run_no)].set_ylabel('')\n    locals()[\"ax\"+str(run_no)].set_xlabel(col, fontsize=4, fontweight='bold')\n    locals()[\"ax\"+str(run_no)].tick_params(labelsize=4, width=0.5, length=1.5)\n    locals()[\"ax\"+str(run_no)].yaxis.set_major_formatter(ticker.PercentFormatter())\n    \n    # data label\n    for p in locals()[\"ax\"+str(run_no)].patches:\n        percentage = f'{p.get_height():.1f}%\\n'\n        x = p.get_x() + p.get_width() \/ 2\n        y = p.get_height()\n        locals()[\"ax\"+str(run_no)].text(x, y, percentage, ha='center', va='center', fontsize=4)\n\n    run_no += 1\n\nplt.show()","1b3c7ffd":"label_dict = {val:idx for idx, val in enumerate(sorted(train['target'].unique()))}\ntrain['target'] = train['target'].map(label_dict)","31ec9148":"from umap import UMAP\n\ntrain_sub = train.sample(50000, random_state=72)\ntarget = train_sub['target']\numap = UMAP(random_state=0)\ndr = umap.fit_transform(train_sub.iloc[:,:-1], target)","c536f070":"light_palette = [\n    (0, 122, 255), # Blue\n    (255, 149, 0), # Orange\n    (52, 199, 89), # Green\n    (255, 59, 48), # Red\n    (175, 82, 222),# Purple\n    (255, 45, 85), # Pink\n    (88, 86, 214), # Indigo\n    (90, 200, 250),# Teal\n    (255, 204, 0)  # Yellow\n]","6fa6eae2":"# let's reduce dimentionality and visualize train set data\nfig = plt.figure(figsize=(20, 20))\ngs = fig.add_gridspec(10, 9)\nax = fig.add_subplot(gs[:-1,:])\n\nsub_axes = [None] * 9\nfor idx in range(9): \n    sub_axes[idx] = fig.add_subplot(gs[-1,idx])\n\nfor idx in range(9):\n    ax.scatter(x=dr[:,0][target==idx], y=dr[:,1][target==idx],\n              s=10, alpha=0.2\n              )\n\n    for j in range(9):\n        sub_axes[j].scatter(x=dr[:,0][target==idx], y=dr[:,1][target==idx],\n                            s=10, alpha = 0.4 if idx==j else 0.008, \n                            color = '#%02x%02x%02x' % light_palette[j] if idx==j else 'gray',\n                            zorder=(idx==j)\n                           )\n        \n    \n    sub_axes[idx].set_xticks([])\n    sub_axes[idx].set_yticks([])\n    sub_axes[idx].set_xlabel('')\n    sub_axes[idx].set_ylabel('')\n    sub_axes[idx].set_title(f'Class_{idx+1}')\n    sub_axes[idx].spines['right'].set_visible(True)\n    sub_axes[idx].spines['top'].set_visible(True)\n\nax.set_title('Dimenstion Reductio by UMAP in Train set', fontweight='bold', fontfamily='serif', fontsize=23, loc='center')   \n    \nax.set_xticks([])\nax.set_yticks([])\nax.set_xlabel('')\nax.set_ylabel('')\nax.spines['left'].set_visible(False)\nax.spines['bottom'].set_visible(False)\n\nfig.tight_layout()\nplt.show()","2fd1680b":"test_sub = train.sample(50000, random_state=72)\ndr_test = umap.transform(test_sub)","c4db3334":"import matplotlib.patches as mpatches\n\n\nfig, ax = plt.subplots(1, 1, figsize=(20, 20))\nax.scatter(x=dr[:,0], y=dr[:,1], \n           color = '#%02x%02x%02x' % light_palette[0],\n           s=10, alpha=0.3, label='Train')\nax.scatter(x=dr_test[:,0], y=dr_test[:,1], \n           color = '#%02x%02x%02x' % light_palette[1],\n           s=10, alpha=0.3, label='Test')\n\n\nax.set_title('Dimenstion Reduction Comparision between Train and Test set', fontweight='bold', fontfamily='serif', fontsize=20, loc='left')   \n    \nax.set_xticks([])\nax.set_yticks([])\nax.set_xlabel('')\nax.set_ylabel('')\nax.spines['left'].set_visible(False)\nax.spines['bottom'].set_visible(False)\n\ntrain_dot = mpatches.Patch(color='#%02x%02x%02x' % light_palette[0], label='Train')\ntest_dot = mpatches.Patch(color='#%02x%02x%02x' % light_palette[1], label='Train')\nax.legend(handles=[train_dot, test_dot], loc='lower center', ncol = 2, fontsize=15)\nfig.tight_layout()\nplt.show()\n","5083cceb":"### If you find this helpful, don't forget upvotting. Thank you","b55a75b5":"## Dimentionality reduction"}}