{"cell_type":{"d9834ed4":"code","c93b6caa":"code","9334ee8d":"code","7afd2e9c":"code","df5ec775":"code","af13a4f0":"code","4eddf9ac":"code","1fc84c3e":"code","1398ddf3":"code","05468d4d":"code","5a7d77fe":"code","3ec38cb9":"code","54815c41":"code","18e6deb0":"code","9c849975":"code","5a8b4f2f":"code","6dff7cbc":"code","42115949":"code","01c4bd58":"code","824f0328":"code","8d4f02f9":"code","83624f57":"code","37add0d5":"code","eea37771":"code","667af523":"code","15afc3a0":"code","977f1b2a":"code","46163076":"code","0b2dff87":"code","79a6c9c6":"code","f3da8822":"code","e04f7a1c":"markdown"},"source":{"d9834ed4":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.svm import SVC\nfrom sklearn import svm\nfrom sklearn.neural_network import MLPClassifier\nfrom sklearn.metrics import confusion_matrix, classification_report\nfrom sklearn.preprocessing import StandardScaler, LabelEncoder\nfrom sklearn.model_selection import train_test_split\n%matplotlib inline\nfrom IPython.display import display\nfrom sklearn import metrics\nhrt= pd.read_csv('..\/input\/heart.csv')\nhrt.head(10)","c93b6caa":"hrt.info()","9334ee8d":"hrt.isnull().sum() #checking for null data","7afd2e9c":"#preliminary figures to help understand the gist of the dataset\nsns.barplot(x='sex',y='chol',data=hrt,estimator=np.std) #1 for male and 0 for female","df5ec775":"sns.barplot(x='exang',y='chol',data=hrt,estimator=np.std)\n#exang= exercise-induced angina\n#1 = yes & 0 = no","af13a4f0":"sns.boxplot(x='sex',y='chol',data=hrt,hue='exang').set_title('Sex vs Cholestrol levels & excercise induced angina')","4eddf9ac":"sns.stripplot(x='thalach',y='chol',data=hrt,hue='exang',dodge=True,jitter=True).set_title('Maximum heart rate vs Cholestrol levels & excercise induced angina')","1fc84c3e":"sns.lmplot(x='thalach',y='trestbps',data=hrt,hue='sex',markers=['o','v'],scatter_kws={'s':100})","1398ddf3":"label_quality=LabelEncoder()","05468d4d":"hrt['exang']= label_quality.fit_transform(hrt['exang'])","5a7d77fe":"hrt['exang'].value_counts()","3ec38cb9":"ax=sns.countplot(hrt['exang'])\nax.set_title('exercise-induced angina')","54815c41":"#separate the dataset as response variable(dependent variable) and feature variable(independent variable)\nX= hrt.drop('exang', axis=1) #use all columns minus 'exang' as independent variables\ny=hrt['exang'] #use 'exang' as dependent variable\n#upper case 'X' and lowercase 'y' is the common-use","18e6deb0":"#Train and test splitting of the data\nX_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.2, random_state=42)\n#returns 4 variables","9c849975":"#applying standard scaling to get optimized results\nsc= StandardScaler()\n'''this levels the playing field so columns with big values (e.g.chol) \ndont get a prefrence over columns with smaller values (e.g. oldpeak)'''\nX_train= sc.fit_transform(X_train)\nX_test= sc.transform(X_test)\n","5a8b4f2f":"#Random Forest Classifier\nrfc= RandomForestClassifier(n_estimators=200) #how many models do I need\/trees in the forest \nrfc.fit(X_train,y_train)\npred_rfc=rfc.predict(X_test)","6dff7cbc":"#Let's see how the model performs\nprint(classification_report(y_test, pred_rfc))\nprint(confusion_matrix(y_test ,pred_rfc))\n#good at predicting when exercise-induced angina doesn't happen but not good at predicting when it does.","42115949":"#SVM Classifier\nclf=svm.SVC()\nclf.fit(X_train,y_train)\npred_clf=clf.predict(X_test)","01c4bd58":"#Let's see how the model performs\nprint(classification_report(y_test, pred_clf))\nprint(confusion_matrix(y_test ,pred_clf))\n#worse percision than RFC","824f0328":"# Neural Networks\nmlpc= MLPClassifier(hidden_layer_sizes=(11,11,11),max_iter=200)\n#3 layers of 11 nodes #more hidden layers= more resources but can lead to overfitting #normal amount of iterations are 200\nmlpc.fit(X_train,y_train)\npred_mlpc=mlpc.predict(X_test)","8d4f02f9":"#Let's see how the model performs\nprint(classification_report(y_test, pred_mlpc))\nprint(confusion_matrix(y_test ,pred_mlpc))\n#better percision for predicting when exercise-induced angina doesn't happen, but much worse at predicting when it should","83624f57":"X= hrt.drop(['exang','sex','oldpeak','target'], axis=1)#use all columns minus 'exang', 'sex', 'oldpeak', and 'target' as independent variables\ny=hrt['exang'] #use 'exang' as dependent variable","37add0d5":"X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.2, random_state=42)","eea37771":"sc= StandardScaler()\n'''this levels the playing field so columns with big values (e.g.chol) \ndont get a prefrence over columns with smaller values (e.g. oldpeak)'''\nX_train= sc.fit_transform(X_train)\nX_test= sc.transform(X_test)\n","667af523":"#Random Forest Classifier\nrfc= RandomForestClassifier(n_estimators=200)\nrfc.fit(X_train,y_train)\npred_rfc=rfc.predict(X_test)","15afc3a0":"#Let's see how the model performs\nprint(classification_report(y_test, pred_rfc))\nprint(confusion_matrix(y_test ,pred_rfc))\n#worse than initial","977f1b2a":"#SVM Classifier\nclf=svm.SVC()\nclf.fit(X_train,y_train)\npred_clf=clf.predict(X_test)","46163076":"#Let's see how the model performs\nprint(classification_report(y_test, pred_clf))\nprint(confusion_matrix(y_test ,pred_clf))\n#slightly better percision than inital","0b2dff87":"# Neural Networks\nmlpc= MLPClassifier(hidden_layer_sizes=(11,11,11),max_iter=200)\n#3 layers of 11 nodes\nmlpc.fit(X_train,y_train)\npred_mlpc=mlpc.predict(X_test)","79a6c9c6":"#Let's see how the model performs\nprint(classification_report(y_test, pred_mlpc))\nprint(confusion_matrix(y_test ,pred_mlpc))\n#better percision than initial","f3da8822":"'''after dropping the independent variables sex, oldpeak, and target, \nthe SVM and Neural network models both performed slightly better than before,\nbut the Random Forest model performed slightly worse'''","e04f7a1c":"# Testing the same models after excluding certain independent variables"}}