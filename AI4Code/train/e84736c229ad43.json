{"cell_type":{"f492dc2c":"code","4134fa0b":"code","00889cd0":"code","b5dbbe2a":"code","1cb9b6b2":"code","de9b4c97":"code","c614794a":"code","68cb09e1":"code","ba027519":"code","7645a885":"code","2d8b6526":"code","289c6d11":"code","d74305cf":"code","5d618a67":"code","57f1df88":"code","d9f7a0ca":"code","2e1fb7f4":"code","e7285573":"code","4499a649":"code","eefd4468":"code","0783c0fa":"code","ff7a9af5":"code","b1894c21":"code","8dfd970f":"code","3cdd56d4":"code","cf0e80a2":"code","c971f4b7":"code","8bbb1594":"code","c1c64c47":"code","fe446623":"code","1494ceb5":"code","10b12155":"code","202a3cae":"code","7f026f1e":"code","2f1675d5":"code","e9d0e1e0":"code","69bf8390":"code","b596c6dd":"code","32d023c3":"markdown","ecf8f719":"markdown","94f839e9":"markdown","a563978b":"markdown","d9ad1646":"markdown","775e0141":"markdown","f742d1ea":"markdown","a2f8211e":"markdown","db837252":"markdown","815ce107":"markdown","a60ca91f":"markdown","e1dac5ae":"markdown","c3e99ac9":"markdown","0e3db85e":"markdown","40bf927e":"markdown","558a58eb":"markdown","d23b9527":"markdown","48de6144":"markdown","625119f9":"markdown","33f8b1d5":"markdown","41832052":"markdown","dbe52937":"markdown"},"source":{"f492dc2c":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n%matplotlib inline","4134fa0b":"data_path = '\/kaggle\/input\/abalone-dataset\/abalone.csv'\nraw_df = pd.read_csv(data_path)","00889cd0":"raw_df.head()","b5dbbe2a":"print(raw_df.info())","1cb9b6b2":"raw_df['Age'] = raw_df['Rings']+1.5\ndf = raw_df #just a copy to be safe\ndf.columns","de9b4c97":"val_labl = ['Length', 'Diameter', 'Height', 'Whole weight', 'Shucked weight', 'Viscera weight', 'Shell weight',]\ntrgt_labl = ['Rings', 'Age']\ncatg_lbl = ['Sex']","c614794a":"df.info()","68cb09e1":"def plot_graph(var, color='r'):\n    plt.figure(figsize=(10,5))\n    plt.scatter(x = df[var], y = df['Age'], marker='+', c=color, s=60, alpha=0.7)\n    plt.ylabel('Age of Abalone')\n    plt.xlabel(var+' of Abalone')\n    plt.grid(True)","ba027519":"def data_removal(var, para1, para2):\n    df.drop(df[(df[var]> para1)].index, inplace=True)\n    df.drop(df[(df[var]< para2)].index, inplace=True)","7645a885":"plot_graph(val_labl[0])","2d8b6526":"data_removal(val_labl[0], 0.8, 0.1)\ndf.drop(df[(df[val_labl[0]]==0.8)].index, inplace=True)","289c6d11":"plot_graph(val_labl[1])","d74305cf":"data_removal(val_labl[1],0.65,0.1)","5d618a67":"plot_graph(val_labl[2], 'c')","57f1df88":"data_removal(val_labl[2],0.4,0)","d9f7a0ca":"plot_graph(val_labl[2], 'c')","2e1fb7f4":"data_removal(val_labl[2],0.25,0.01)","e7285573":"plot_graph(val_labl[3], 'b')","4499a649":"data_removal(val_labl[3],2.52,0)","eefd4468":"plot_graph(val_labl[4])","0783c0fa":"data_removal(val_labl[4],1.20,0)","ff7a9af5":"plot_graph(val_labl[5])","b1894c21":"data_removal(val_labl[5],0.55,0)","8dfd970f":"plot_graph(val_labl[6], 'g')","3cdd56d4":"data_removal(val_labl[6],0.75,0)","cf0e80a2":"df[df['Age'] >= 25]","c971f4b7":"data_removal('Age',25,0)","8bbb1594":"fig = plt.figure(figsize=[15,10])\naxes = fig.subplots(2, 4)\nk = 0\nfor i in range(2):\n    for j in range(4):\n        if k == 7: break\n        axes[i][j].scatter(df[val_labl[k]], df['Age'], alpha=0.7, marker='+',s= 40)\n        axes[i][j].set(xlabel=val_labl[k]+' of Abalone', ylabel='Age of Abalone')\n        k+=1","c1c64c47":"df.describe()","fe446623":"f,ax = plt.subplots(figsize=(10, 8))\nsns.heatmap(df.corr(), annot=True, linewidths=.5, fmt= '.1f',ax=ax)\nplt.show()","1494ceb5":"sns.pairplot(df[df.select_dtypes(include=[np.number]).columns])","10b12155":"df.skew(axis = 0, skipna = True) ","202a3cae":"fig = plt.figure(figsize=[15,5])\naxes = fig.subplots(1, 2)\n\naxes[0].axvline(df['Height'].mean(), ls='--', color='r')\naxes[1].axvline(df['Age'].mean(), ls='--', color='r')\n\nsns.distplot(df['Height'], bins=50, ax=axes[0], color='c')\nsns.distplot(df['Age'], bins=20, ax=axes[1], color='c')\n","7f026f1e":"fig = plt.figure(figsize=[20,5])\naxes = fig.subplots(1, 2)\naxes[0].pie(df.groupby(['Sex']).size(), explode=(0,0.1,0), colors=['gold', 'r', 'c'], shadow=True, autopct='%1.1f%%', labels=['Immature','Female','Male'])\nsns.violinplot(x = 'Sex', y = 'Age', data = df, ax=axes[1], colors=['c', 'r', ''])\nsns.swarmplot(x = 'Sex', y = 'Age', data = df, hue = 'Sex', ax=axes[1])","2f1675d5":"X = df[val_labl]\ny = df['Age']","e9d0e1e0":"X_train, X_test, y_train, y_test = train_test_split(X,y, test_size=0.7)","69bf8390":"lr_model = LinearRegression()\nclf = lr_model.fit(X_train, y_train)","b596c6dd":"print(\"LinearRegression Train Score: \",  clf.score(X_train, y_train))\nprint(\"LinearRegression Test Score: \",  clf.score(X_test, y_test))","32d023c3":"### Observations:\n- There is lot of correlation between various features with each other.\n- There is no direct correlation of any feature with our target variable 'Age'.\n- The above correlation map helps us to understand and relate the biological studies on abalone.","ecf8f719":"## Observation: -\n---\n- *Average age of an abalone can be tagged as 11.4*.\n- The age of abalone in data ranges for 2.5(min) to 30.50(max) which is quite interesting as the average is 11.43.\n- Standard Deviation for all the feature except 'Age and 'Rings' tell us the distribution of data is not a wide spreaded but resided near mean value.","94f839e9":"## Digging deeper to find linear relationship between features","a563978b":"The scores are pretty bad and the model can be changed or tuned for better performance. I am not empphasising on it as it is an EDA rather than building an model for prediction. ","d9ad1646":"# Modelling","775e0141":"### Observations: -\n----\n- In the data the male is in the majority followed by Immatures and last is the femal.\n- Female have the widest range of age.\n- Immature has the smallest range of age.\n- Male has the range of age lieing in between 7.5 years to 19 years.\n- Female has the range of age lieing in between 8 years to 19 years.\n- Immature has the range of age lieing in between 6 years to < 10 years.","f742d1ea":"![gif_lets_get_started](https:\/\/media0.giphy.com\/media\/Ln2dAW9oycjgmTpjX9\/giphy.gif)","a2f8211e":"### Let's see if some correlations exist in the data features","db837252":"## Observations: -\nIf you notice you can see incosistency in data for all the feature when age is greater than 25. Which can be taken as outlier if the points are corresponding to it are not much.","815ce107":"### Request-\nThis is my first notebook on kaggle and I might have done some mistakes, forgotten few things, did something wrong, made some wrong observations or assumptions. Please feel free to correct me and If you find my EDA good please show your support by upvoting my kernel as motivation.\n\n![Thank you](https:\/\/media.giphy.com\/media\/95P1vO6r7rsk0\/giphy.gif)","a60ca91f":"# Let's Begin with the Analysis\n---\n#### Main questions for the Analysis will be.\n- **How Age of Abalone relates to different physical features of itself.**\n- Is there any relation among the physical features of Abalone\n- Do sex of Abalone holds any relation to the Age of Abalone.","e1dac5ae":"**Let's add the 'age' column in the data frame to proceed with our EDA and predictions.**\n> *According to the research age of abalone = Number of rings + 1.5.*\n\nFrom the above information it can be determined that the data provided is quite consistent and clean from missing values. This kind of data is good to proceed and detect outliers.","c3e99ac9":"### Observations:-\nSupporting our heatmap we can see strong linear relatioships between\n- Length vs Diameter\n- Whole weight vs Shucked Weight\n- Whole weight vs Viscera Weight","0e3db85e":"# #1 Notebook | EDA on Abalone data.","40bf927e":"# Summary: -\n1. Yes, It is possible to determine age of an abalone without using a Microsocpe.\n2. Yes, It is possible to estimate age of Abalone without cutting it and counting the rings as physical features of the Abalone show some relation towards Age of the Abalone.\n3. No, the method of determining age of abalone through it's physical features is as relaible as the method determining it using number of rings as there is some relation but all factors are not completely dependent.\n4. From the given data we can also say that a Female Abalone is more likely to live longer than other two sexes of the abalone.\n5. Our EDA supports most of the already known facts about Abalone and its physical features.","558a58eb":"# Handling Outliers","d23b9527":"## What is Abalone?.\n\n<img src=\"https:\/\/df2sm3urulav.cloudfront.net\/tenants\/gr\/uploads\/images\/200000-204999\/203495\/203495_1289195309.jpg\" height=250 width=250>\n\nAbalone is a common name for any of a group of small to very large sea snails, marine gastropod molluscs in the family Haliotidae. Other common names are ear shells, sea ears, and muttonfish or muttonshells in Australia, ormer in the UK, perlemoen in South Africa, and paua in New Zealand. Abalone are marine snails.\n\n## Age of Abalone.\n\nThe age of abalone is determined by cutting the shell through the cone, staining it, and counting the number of rings through a microscope, a boring and time-consuming task. Other measurements, which are easier to obtain, are used to predict the age.","48de6144":"### Observations:-\n- The data is not normally distributed but is near the normal distribution.\n- Height and Age have skewness > 0 and hence are skewed right and contain more weight towards right tail.","625119f9":"These values of age above 25 can be considered as an outlier as there is just one value and also its presence makes data distribution against other feature makes incosistency as seen in the above graphs.\nStill there are outliers due to the data corresponding to Ages above **25**. So for this analysis we will be romving these values for ages.","33f8b1d5":"## After Outlier Detection and Removal","41832052":"## Linear Regression:-","dbe52937":"There are total of 7 feature we need to plot against age and eliminate all poosible outliers based over our analysis"}}