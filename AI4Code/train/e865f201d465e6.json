{"cell_type":{"40f5bc7e":"code","59be70b5":"code","4a05b365":"code","ac2e5798":"code","d88f2983":"code","f81ea236":"markdown","ec14d95d":"markdown"},"source":{"40f5bc7e":"# import python standard library\nimport os\n\n# import data manipulation library\nimport numpy as np\nimport pandas as pd\n\n# import data visualization library\nfrom tqdm import tqdm","59be70b5":"def csvload(file: str, nrows: int = None) -> pd.DataFrame:\n    \"\"\" Return a loaded csv file. \"\"\"\n    \n    return pd.read_csv('..\/input\/train_simplified\/' + file, nrows=nrows)","4a05b365":"# class files and dictionary\nfiles = sorted(os.listdir('..\/input\/train_simplified\/'), reverse=False)\nclass_dict = {file[:-4].replace(\" \", \"_\"): i for i, file in enumerate(files)}\n\n# data dimensions\nnum_shuffles = 100","ac2e5798":"# acquiring training and testing data\nfor i, file in tqdm(enumerate(files)):\n    df_data = csvload(file, nrows=30000)\n    df_data['shuffle'] = (df_data['key_id'] \/\/ 10 ** 7) % num_shuffles\n    for k in range(num_shuffles):\n        df_chunk = df_data[df_data['shuffle'] == k]\n        if i == 0: df_chunk.to_csv('train_k%d.csv' %k, index=False)\n        else: df_chunk.to_csv('train_k%d.csv' %k, header=False, index=False, mode='a')            ","d88f2983":"# shuffle and compress file\nfor k in tqdm(range(num_shuffles)):\n    df_data = pd.read_csv('train_k%d.csv' %k)\n    print(df_data.shape)\n    df_data['rand'] = np.random.rand(df_data.shape[0])\n    df_data = df_data.sort_values(['rand']).drop(['rand'], axis=1)\n    df_data.to_csv('train_k%d.csv.gz' %k, index=False, compression='gzip')\n    \n    # memory clean-up\n    os.remove('train_k%d.csv' %k)","f81ea236":"> **Problem overview**\n\n\"Quick, Draw!\" was released as an experimental game to educate the public in a playful way about how AI works. The game prompts users to draw an image depicting a certain category, such as \u201dbanana,\u201d \u201ctable,\u201d etc. The game generated more than 1B drawings, of which a subset was publicly released as the basis for this competition\u2019s training set. That subset contains 50M drawings encompassing 340 label categories.\n\nSounds fun, right? Here's the challenge: since the training data comes from the game itself, drawings can be incomplete or may not match the label. You\u2019ll need to build a recognizer that can effectively learn from this noisy data and perform well on a manually-labeled test set from a different distribution.\n\nYour task is to build a better classifier for the existing Quick, Draw! dataset. By advancing models on this dataset, Kagglers can improve pattern recognition solutions more broadly. This will have an immediate impact on handwriting recognition and its robust applications in areas including OCR (Optical Character Recognition), ASR (Automatic Speech Recognition) & NLP (Natural Language Processing).","ec14d95d":"> **Acquiring training and testing data**\n\nWe start by acquiring the training and testing datasets into Pandas DataFrames."}}