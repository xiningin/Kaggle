{"cell_type":{"7c504755":"code","f11fe17e":"code","4a9bc8c1":"code","d97ebfe9":"code","7d34ffe0":"code","a514ebf5":"code","074173f1":"code","f9750d21":"code","bec02076":"code","f2d1273d":"code","09b5c630":"code","a7ea877d":"code","bb6941fb":"code","1d705ff0":"code","ebca61dd":"code","8584e43c":"code","372131f7":"code","6d18375a":"code","2f59f032":"code","72452c3d":"code","2d439bd4":"code","10350e1c":"markdown","780f16fe":"markdown"},"source":{"7c504755":"import numpy as np\nimport pandas as pd \n\nimport matplotlib.pyplot as plt\nplt.style.use('ggplot')\n\nimport torch\nfrom fastai.vision import *\nfrom fastai.metrics import *\n\nnp.random.seed(7)\ntorch.cuda.manual_seed_all(7)","f11fe17e":"import os\nprint(os.listdir(\"..\/input\"))","4a9bc8c1":"train_dir=\"..\/input\/train\/train\"\ntest_dir=\"..\/input\/test\/test\"\ntrain = pd.read_csv('..\/input\/train.csv')\nsub_file = pd.read_csv(\"..\/input\/sample_submission.csv\")\ndata_folder = Path(\"..\/input\")","d97ebfe9":"train.head()","7d34ffe0":"sub_file.head()","a514ebf5":"# transformations for data augmentation\ntrfm = get_transforms(do_flip=True, flip_vert=True, max_rotate=10.0, max_zoom=1.1, max_lighting=0.2, max_warp=0.2, p_affine=0.75, p_lighting=0.75)","074173f1":"test_img = ImageList.from_df(sub_file, path=data_folder\/'test', folder='test')\n\ndatabunch = (ImageList.from_df(train, path=data_folder\/'train', folder='train')\n        .split_by_rand_pct(0.01)\n        .label_from_df()\n        .add_test(test_img)\n        .transform(trfm, size=48)\n        .databunch(path='.', bs=64, device= torch.device('cuda:0'))\n        .normalize(imagenet_stats)\n       )","f9750d21":"databunch.show_batch(rows=3, figsize=(8,8))","bec02076":"databunch.classes","f2d1273d":"databunch.label_list","09b5c630":"learn = cnn_learner(databunch, models.resnet34, metrics=[error_rate, accuracy])\nlearn.fit_one_cycle(5)","a7ea877d":"learn.recorder.plot_losses()","bb6941fb":"learn.lr_find()\nlearn.recorder.plot()","1d705ff0":"learn.unfreeze()\nlearn.fit_one_cycle(5, max_lr=slice(1e-03))","ebca61dd":"learn.recorder.plot_losses()","8584e43c":"learn.show_results(rows=3)","372131f7":"interp = ClassificationInterpretation.from_learner(learn)\n\nlosses,idxs = interp.top_losses()\n\nlen(databunch.valid_ds)==len(losses)==len(idxs)","6d18375a":"interp.plot_top_losses(9, figsize=(12,10), heatmap=False)","2f59f032":"interp.plot_confusion_matrix()","72452c3d":"predictions1=learn.get_preds(DatasetType.Test)\npredictions2=learn.get_preds(DatasetType.Test)\npredictions3=learn.get_preds(DatasetType.Test)\npredictions4=learn.get_preds(DatasetType.Test)\npredictions5=learn.get_preds(DatasetType.Test)\npredictions6=learn.get_preds(DatasetType.Test)\npredictions7=learn.get_preds(DatasetType.Test)\npredictions8=learn.get_preds(DatasetType.Test)\n\ncomb_output=[predictions1[0],predictions2[0],predictions3[0],predictions4[0],\n            predictions5[0],predictions6[0],predictions7[0],predictions8[0]]\n\ncomb_output=torch.sum(torch.stack(comb_output),dim=0)","2d439bd4":"sub_file.has_cactus = comb_output.numpy()[:, 0]\nsub_file.to_csv('submission.csv', index=False)","10350e1c":"**has_cactus = 1**","780f16fe":"**Context**\n\nTo assess the impact of climate change on Earth's flora and fauna, it is vital to quantify how human activities such as logging, mining, and agriculture are impacting our protected natural areas. Researchers in Mexico have created the [VIGIA project](https:\/\/jivg.org\/research-projects\/vigia\/), which aims to build a system for autonomous surveillance of protected areas. A first step in such an effort is the ability to recognize the vegetation inside the protected areas. In this competition, you are tasked with creation of an algorithm that can identify a specific type of cactus in aerial imagery.\n\n**Data description provided**\n\nThis dataset contains a large number of 32 x 32 thumbnail images containing aerial photos of a columnar cactus (Neobuxbaumia tetetzo). Kaggle has resized the images from the original dataset to make them uniform in size. The file name of an image corresponds to its id."}}