{"cell_type":{"53ed0074":"code","026c8b10":"code","41cad576":"code","bec5b89e":"code","5fce096d":"code","6c62732b":"code","fae8dcbd":"code","c0186977":"code","aa7a2a21":"code","d37c1968":"code","e9c35667":"code","6afa2b85":"markdown","b93c9a5f":"markdown","9f29b9d5":"markdown","c892d7c9":"markdown","572d3497":"markdown","c942b7ea":"markdown","77b16dd7":"markdown"},"source":{"53ed0074":"import pandas as pd\nimport numpy as np\nfrom sklearn.model_selection import train_test_split\nfrom matplotlib import pyplot as plt\nfrom sklearn.tree import DecisionTreeRegressor, plot_tree\nfrom sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error","026c8b10":"df = pd.read_csv(\"..\/input\/advertisinganalysis\/Advertising.csv\")","41cad576":"df.head()","bec5b89e":"X = df[[\"TV\", \"radio\", \"newspaper\"]]\ny = df[\"sales\"]\n\nx_train, x_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)","5fce096d":"tree_reg = DecisionTreeRegressor(max_depth=3, random_state=42)\ntree_reg.fit(x_train, y_train)","6c62732b":"model_pred = tree_reg.predict(x_test)","fae8dcbd":"accuracy = r2_score(y_test, model_pred)\nprint(\"Model Accuracy: {:.0%}\".format(accuracy))","c0186977":"feature_names = df.columns[:3]\ntarget_names = df['sales'].unique().tolist()\nplt.figure(figsize=(25, 20))\nplot_tree(tree_reg, \n          feature_names = feature_names, \n          class_names = target_names, \n          filled = True, \n          rounded = True)\n\nplt.title(\"Model Visualization\")","aa7a2a21":"mae = mean_absolute_error(y_test, model_pred)\nprint(\"Mean Absolute Error = \", mae)","d37c1968":"mse = mean_squared_error(y_test, model_pred)\nprint(\"Mean Squared Error = \", mse)","e9c35667":"rmse = np.sqrt(mse)\nprint(\"Root Mean Squared Error = \", rmse)","6afa2b85":"**<h1>Visualizing the Model<\/h1>**","b93c9a5f":"**<h1>Mean Absolute Error<\/h1>**","9f29b9d5":"**<h1>Model Accuracy<\/h1>**","c892d7c9":"**<h1>Splitting the data<\/h1>**","572d3497":"**<h1> Build the model<\/h1>**","c942b7ea":"**<h1>Mean Squared Error<\/h1>**","77b16dd7":"**<h1>Root Mean Squared Error<\/h1>**"}}