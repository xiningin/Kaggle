{"cell_type":{"3a610db3":"code","2bacbc60":"code","51fc2244":"code","9a13ca8b":"code","1d02816a":"code","bf47077c":"code","8be6d7fb":"code","ea8e63ed":"code","be4d3d18":"code","d6dccd23":"code","562e3a1f":"code","b0a616ae":"code","61ad6d0b":"code","fce3576b":"code","74ad2277":"code","1fab8a7e":"code","512f4afb":"code","a021adfd":"code","9c2dc0de":"code","68145108":"code","747b7e4f":"code","80afd308":"code","a7191a91":"code","fc2249ba":"markdown","b7f30cd9":"markdown"},"source":{"3a610db3":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","2bacbc60":"# import the libraries\nimport pandas as pd\nimport numpy as np\nfrom pandas import datetime\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nplt.style.use('fivethirtyeight')\n\nimport warnings\nwarnings.filterwarnings('ignore')","51fc2244":"# Get the data\n\ndf = pd.read_csv(\"\/kaggle\/input\/apple-aapl-historical-stock-data\/HistoricalQuotes.csv\", index_col='Date', parse_dates=True)\ndf.head()","9a13ca8b":"df.shape","1d02816a":"df.info()","bf47077c":"# Cleaning data\n\ndf = df.rename(columns={' Close\/Last':'Close', ' Volume':'Volume', ' Open': 'Open', ' High':'High', ' Low':'Low'})\ndf['Close'] = df['Close'].str.replace('$', '').astype('float')\ndf['Open'] = df['Open'].str.replace('$', '').astype('float')\ndf['High'] = df['High'].str.replace('$', '').astype('float')\ndf['Low'] = df['Low'].str.replace('$', '').astype('float')\ndf.head()","8be6d7fb":"# Let's go ahead and use sebron for a quick correlation plot for the daily returns\nsns.heatmap(df.corr(), annot=True, cmap='summer')","ea8e63ed":"sns.pairplot(df, kind='reg')","be4d3d18":"return_fig = sns.PairGrid(df.dropna())\nreturn_fig.map_upper(plt.scatter, color='purple')\nreturn_fig.map_lower(sns.kdeplot, cmap='cool_d')\nreturn_fig.map_diag(plt.hist, bins=30)","d6dccd23":"# Visually show the stock price\nplt.figure(figsize=(15,10))\nplt.plot(df['Close'], label='Close Price', alpha=1)\nplt.title('APPL Close Price History')\nplt.xlabel('Date')\nplt.ylabel('Close Price')\nplt.legend(loc='upper left')\nplt.xticks(rotation=45)\nplt.show()","562e3a1f":"# Create the simple moving average with a 30 days window\nSMA30 = pd.DataFrame()\nSMA30['Close'] = df['Close'].rolling(window=30).mean()\nSMA30","b0a616ae":"# Create the simple moving average with a 100 days window\nSMA100 = pd.DataFrame()\nSMA100['Close'] = df['Close'].rolling(window=100).mean()\nSMA100","61ad6d0b":"# Visually show the stock price\nplt.figure(figsize=(15,10))\nplt.plot(df['Close'], label='Close Price')\nplt.plot(SMA30['Close'], label='SMA30')\nplt.plot(SMA100['Close'], label='SMA100')\nplt.title('Close Price History')\nplt.xlabel('Timestamp')\nplt.ylabel('Price')\nplt.xticks(rotation=45)\nplt.legend(loc='upper left')\nplt.show()","fce3576b":"# Calculate typical price\ntypical_price = (df['Close'] + df['High'] + df['Low']) \/ 3\ntypical_price","74ad2277":"# Get the period\nperiod = 14\n\n# Calculate the money flow\nmoney_flow = typical_price * df['Volume']\nmoney_flow","1fab8a7e":"# Get all of the positive and negative money flows\n\npositive_flow = []\nnegative_flow = []\n\n# Loop through the typical price\nfor i in range(1, len(typical_price)):\n    if typical_price[i] > typical_price[i-1]:\n        positive_flow.append(money_flow[i-1])\n        negative_flow.append(0)\n        \n    elif typical_price[i] < typical_price[i-1]:\n        negative_flow.append(money_flow[i-1])\n        positive_flow.append(0)\n        \n    else:\n        positive_flow.append(0)\n        negative_flow.append(0)","512f4afb":"# Get all of the positive and negative money flows within the time period\n\npositive_mf = []\nnegative_mf = []\n\nfor i in range(period-1, len(positive_flow)):\n    positive_mf.append( sum(positive_flow[i + 1- period : i+1]))\n    \nfor i in range(period-1, len(negative_flow)):\n    negative_mf.append( sum(negative_flow[i + 1- period : i+1]))","a021adfd":"# Calculate the money flow index\nMFI = 100 * (np.array(positive_mf) \/ (np.array(positive_mf) + np.array(negative_mf) ))\nMFI","9c2dc0de":"# Visually show the MFI\n\ndf2 = pd.DataFrame()\ndf2['MFI'] = MFI\n\n# Create the plot\n\nplt.figure(figsize=(15,12))\nplt.plot(df2['MFI'], label='MFI')\nplt.axhline(10, linestyle= '--', color='orange')\nplt.axhline(20, linestyle= '--', color='blue')\nplt.axhline(80, linestyle= '--', color='blue')\nplt.axhline(90, linestyle= '--', color='orange')\nplt.title('MFI', fontsize=18)\nplt.ylabel('MFI Values')\nplt.show()","68145108":"# Create a new Dataframe\n\nnew_df = pd.DataFrame()\nnew_df = df[period:]\nnew_df['MFI'] = MFI\n\n# Show the new dataframe\n\nnew_df","747b7e4f":"# Create a function to get the buy and sell signals\ndef get_signal(data, high, low):\n    buy_signal = []\n    sell_signal = []\n          \n    for i in range(len(data['MFI'])):\n        if data['MFI'][i] > high:\n            buy_signal.append(np.nan)\n            sell_signal.append(data['Close'][i])\n          \n        elif data['MFI'][i] < low:\n       \n            buy_signal.append(data['Close'][i])\n            sell_signal.append(np.nan)\n          \n        else:\n            sell_signal.append(np.nan)\n            buy_signal.append(np.nan)\n      \n\n    return (buy_signal, sell_signal)","80afd308":"# Add new columns (Buy and Sell)\n\nnew_df['Buy'] = get_signal(new_df, 80, 20)[0]\nnew_df['Sell'] = get_signal(new_df, 80, 20)[1]\n\n# Show the data\n\nnew_df","a7191a91":"# Plot the data\n\nplt.figure(figsize=(15,12))\nplt.plot(new_df['Close'], label='Close Price', alpha=0.5)\nplt.scatter(new_df.index, new_df['Buy'], label='Buy Signal', color='green', marker='^', alpha=1)\nplt.scatter(new_df.index, new_df['Sell'], label='Sell Signal', color='red', marker='^', alpha=1)\nplt.title('Apple Close Price', fontsize=18)\nplt.xticks(rotation=45)\nplt.xlabel('Date', fontsize=18)\nplt.ylabel('Close Price', fontsize=18)\nplt.legend(loc='upper left')\nplt.show()\n\n# Create the plot\n\nplt.figure(figsize=(15,12))\nplt.plot(new_df['MFI'], label='MFI')\nplt.axhline(10, linestyle= '--', color='orange')\nplt.axhline(20, linestyle= '--', color='blue')\nplt.axhline(80, linestyle= '--', color='blue')\nplt.axhline(90, linestyle= '--', color='orange')\nplt.title('MFI', fontsize=18)\nplt.ylabel('MFI Values')\nplt.show()","fc2249ba":"## Money Flow Index","b7f30cd9":"## SMA (Simple Moving Average)"}}