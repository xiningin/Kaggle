{"cell_type":{"ab0cc859":"code","f90205cd":"code","d75d3e5b":"code","ff4c51ae":"code","7fdafebe":"code","806471e8":"code","549dc833":"code","f907dbea":"code","b4b574d9":"code","4f8613e5":"code","1029a30d":"code","e73ed274":"code","f41d2841":"code","9a732559":"code","5c7c3650":"code","4977692e":"code","631e65d9":"code","615f5b2b":"code","06161f7b":"code","cc8c20c6":"markdown","03390427":"markdown","583e3f4d":"markdown","728ebaa6":"markdown","2013aa16":"markdown","1f523a85":"markdown","68bdf7e2":"markdown","e59a5560":"markdown","e1fa237d":"markdown","68c524a9":"markdown","2ca638dd":"markdown","bb3a3519":"markdown","6e058dee":"markdown","532ce226":"markdown"},"source":{"ab0cc859":"import pandas as pd\nimport pandas_profiling as pp\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport warnings\nimport os\nimport plotly.graph_objects as go\nimport plotly.io as pio\nimport pickle\n\n# Metrics\nfrom sklearn.metrics import accuracy_score, classification_report, confusion_matrix, auc, roc_curve\n\n# Validation\nfrom sklearn.model_selection import train_test_split, cross_val_score, KFold\nfrom sklearn.pipeline import Pipeline\n\n# Tuning\nfrom sklearn.model_selection import GridSearchCV\n\n# Feature Extraction\nfrom sklearn.feature_selection import RFE\n\n# Preprocessing\nfrom sklearn.preprocessing import MinMaxScaler, StandardScaler, Normalizer, Binarizer, LabelEncoder\n\nfrom sklearn.pipeline import Pipeline, make_pipeline\n\n# Models\nfrom sklearn.discriminant_analysis import LinearDiscriminantAnalysis\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.svm import SVC\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.tree import DecisionTreeClassifier\n\n# Ensembles\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.ensemble import BaggingClassifier\nfrom sklearn.ensemble import AdaBoostClassifier\nfrom sklearn.ensemble import GradientBoostingClassifier\nfrom sklearn.ensemble import ExtraTreesClassifier\n\nwarnings.filterwarnings('ignore')\n%matplotlib inline\n\nsns.set_style(\"whitegrid\", {'axes.grid' : False})\npio.templates.default = \"plotly_white\"\n\ndf = pd.read_csv('\/kaggle\/input\/early-stage-diabetes-risk-prediction-datasets\/diabetes_data_upload.csv')\ndf.head()\n","f90205cd":"print(\"Number of Instances and Attributes:\", df.shape)","d75d3e5b":"df.columns","ff4c51ae":"print(df.dtypes)","7fdafebe":"df.isna().sum()","806471e8":"\ndf.columns = df.columns.str.replace(\" \", \"_\")\ndf.rename(columns={'weakness':'Weakness', 'visual_blurring':'Visual_blurring', 'delayed_healing':'Delayed_healing', 'partial_paresis':'Partial_paresis','muscle_stiffness':'Muscle_stiffness'}, inplace=True)\nlabels = ['Male','Female']\nvalues = df.Gender.value_counts()\n\ncolors = ['STEELBLUE','crimson']\n\nfig_1 = go.Figure(data=[go.Pie(labels=labels, values=values, textinfo='label+percent', showlegend=False)])\n\nfig_1.update_traces(marker=dict(colors=colors, line=dict(color='#000000', width=0.5)))\n\nfig_1.update_layout( margin={\"r\":0,\"t\":100,\"l\":0,\"b\":0},\n    title_text=\"<br>Gender Distribution:<br>\",\n    font=dict(size=15, color='black', family=\"Arial, Balto, Courier New, Droid Sans\"),\n\n)\nfig_1.show()","549dc833":"f,ax=plt.subplots(1,2,figsize=(22,10))\n#sns.stripplot(x=\"class\", y=\"Age\", data=df, jitter=True, palette=\"Set1\", ax=ax[0])\n\nsns.swarmplot(x=\"class\", y=\"Age\",data=df, palette=\"Set1\", ax=ax[0])\nsns.violinplot(x=\"class\", y=\"Age\", data=df, palette=\"Set1\", ax=ax[1])\nf.suptitle('Age of Positives vs Negatives', fontweight=\"bold\");\n\n","f907dbea":"plt.figure(figsize=(12,8))\nsns.countplot(x=\"class\", hue=\"Gender\", palette=['STEELBLUE','crimson'],data=df);\nplt.title('Gender of Positives vs Negatives',fontweight=\"bold\");","b4b574d9":"plt.figure(figsize=(10,5))\nsns.countplot(x=df['class'], palette='Set1');\nplt.title('Class Distribution',fontweight=\"bold\",alpha=0.8);","4f8613e5":"for c in df.columns:\n    if df[c].dtype == 'object':\n        lbl = LabelEncoder()\n        lbl.fit(list(df[c].values)) \n        df[c] = lbl.transform(list(df[c].values))\n        \ndf.describe().T","1029a30d":"colormap = plt.cm.RdBu\nplt.figure(figsize=(18,15));\nplt.title('Pearson Correlation of Features', y=1.05, size=50);\nsns.heatmap(df.corr(),linewidths=0.1, vmax=1.0, square=True, cmap=colormap, linecolor='white', annot=True);","e73ed274":"X = df.drop('class', axis=1)\ny = df['class']\n\nX_train, X_test, y_train, y_test = train_test_split(X,\n                                                   y,\n                                                    test_size=0.2,\n                                                   random_state=0)\nprint('X_train: ',X_train.shape)\nprint('X_test: ',X_test.shape)\nprint('y_train: ',y_train.shape)\nprint('y_test: ',y_test.shape)","f41d2841":"models = []\nmodels.append(( ' LR ' , LogisticRegression()))\nmodels.append(( ' LDA ' , LinearDiscriminantAnalysis()))\nmodels.append(( ' KNN ' , KNeighborsClassifier()))\nmodels.append(( ' NB ' , GaussianNB()))\nmodels.append(( ' SVM ' , SVC()))\nmodels.append(('CART', DecisionTreeClassifier()))\n\nresults = []\nnames = []\n\nfor name, model in models:\n    Kfold = KFold(n_splits=10, random_state=0)\n    cv_results = cross_val_score(model, X_train, y_train, cv=Kfold, scoring= 'accuracy')\n    results.append(cv_results)\n    names.append(name)\n    msg = \"%s: %f (%f)\" % (name, cv_results.mean(), cv_results.std());\n    print(msg)","9a732559":"models = []\nmodels.append(( 'Adab' , AdaBoostClassifier()))\nmodels.append(( 'Bagging' , BaggingClassifier()))\nmodels.append(( 'GBC' , GradientBoostingClassifier()))\nmodels.append(( 'RF' , RandomForestClassifier()))\nmodels.append(('ET'  , ExtraTreesClassifier()))\n\n\nresults = []\nnames = []\n\nfor name, model in models:\n    Kfold = KFold(n_splits=10, random_state=0)\n    cv_results = cross_val_score(model, X_train, y_train, cv=Kfold, scoring= 'accuracy')\n    results.append(cv_results)\n    names.append(name)\n    msg = \"%s: %f (%f)\" % (name, cv_results.mean(), cv_results.std());\n    print(msg)","5c7c3650":"model = ExtraTreesClassifier()\nn_estimators = [5, 10, 15, 100, 1000]\n\nmax_depth= [3, 5, 15, 25]\n\nmax_features = ['sqrt', 'log2']\n\ncriterion = ['gini', 'entropy']\n\ngrid = dict(n_estimators=n_estimators, criterion=criterion, max_depth=max_depth, max_features= max_features)\n\ngrid_search = GridSearchCV(estimator=model,param_grid=grid, n_jobs=-1, cv=10, scoring='accuracy')\ngrid_result = grid_search.fit(X_train, y_train)\n# summarize results\nprint(\"Best: %f using %s\" % (grid_result.best_score_, grid_result.best_params_))\nmeans = grid_result.cv_results_['mean_test_score']\nstds = grid_result.cv_results_['std_test_score']\nparams = grid_result.cv_results_['params']\nfor mean, stdev, param in zip(means, stds, params):\n    print(\"%f (%f) with: %r\" % (mean, stdev, param))","4977692e":"pipeline = make_pipeline(StandardScaler(), ExtraTreesClassifier(criterion='gini',max_depth=15, max_features='sqrt', n_estimators=15))\nmodel = pipeline.fit(X_train, y_train)\ny_pred = pipeline.predict(X_test)\nprint(f\"Training Accuracy Score: {model.score(X_train, y_train) * 100:.1f}%\")\nprint(f\"Validation Accuracy Score: {model.score(X_test, y_test) * 100:.1f}%\")\nprint(\"-----\"*30)\nprint(classification_report(y_test,y_pred))","631e65d9":"plt.figure(figsize=(10,5))\nsns.heatmap(confusion_matrix(y_test, y_pred), annot=True, fmt='2.0f');\nplt.title(\"Confusion Matrix\",fontweight=\"bold\", fontsize=20);\nplt.ylabel('Actual label', fontsize=15)\nplt.xlabel('Predicted label', fontsize=15)\nplt.show()","615f5b2b":"fpr, tpr, thresholds = roc_curve(y_test, y_pred)\nplt.figure(figsize=(8,6))\nprint(f\"roc_auc score: {auc(fpr, tpr)*100:.1f}%\")\nplt.plot(fpr, tpr, color='orange', label='ROC')\nplt.plot([0, 1], [0, 1], color='darkblue', linestyle='--')\nplt.xlabel('False Positive Rate',fontsize=12)\nplt.ylabel('True Positive Rate', fontsize=12)\nplt.title('Receiver Operating Characteristic (ROC) Curve', fontsize=20)\nplt.legend()\nplt.show()","06161f7b":"# saving model\npickle.dump(model, open('model.pkl', 'wb'))    ","cc8c20c6":"\n# [Improve Performance with Ensembles](http:\/\/)\n\n","03390427":"# [Predicting the Risk of Diabetes at Early Stage Using Machine Learning](http:\/\/)\n\nDiabetes is a chronic, metabolic disease characterized by elevated levels of blood glucose (or blood sugar), which leads over time to serious damage to the heart, blood vessels, eyes, kidneys and nerves. The most common is type 2 diabetes, usually in adults, which occurs when the body becomes resistant to insulin or doesn't make enough insulin. In the past three decades the prevalence of type 2 diabetes has risen dramatically in countries of all income levels. Type 1 diabetes, once known as juvenile diabetes or insulin-dependent diabetes, is a chronic condition in which the pancreas produces little or no insulin by itself. For people living with diabetes, access to affordable treatment, including insulin, is critical to their survival. There is a globally agreed target to halt the rise in diabetes and obesity by 2025. \n\n![](https:\/\/northmemorial.com\/wp-content\/uploads\/2016\/10\/Diabetes-illustration.png)\n\n> About 422 million people worldwide have diabetes, the majority living in low-and middle-income countries, and 1.6 million deaths are directly attributed to diabetes each year. Both the number of cases and the prevalence of diabetes have been steadily increasing over the past few decades. \n\n![](https:\/\/everydaydiabetes.com\/wp-content\/uploads\/Diabetes-Statistics-Worldwide-Everyday-Diabetes.jpg)","583e3f4d":"# [Parameter tuning](http:\/\/)","728ebaa6":"# [Attribute Information:]()\n\n* **Age**: 20-65\n* **Sex**: Male, Female ( 1 , 0 )\n* **Polyuria**: Yes, No ( 1 , 0 )\n* **Polydipsia**: Yes, No ( 1 , 0 )\n* **sudden weight loss**: Yes, No ( 1 , 0 )\n* **weakness**: Yes, No ( 1 , 0 )\n* **Polyphagia**: Yes, No ( 1 , 0 )\n* **Genital thrush**: Yes, No ( 1 , 0 )\n* **visual blurring**: Yes, No ( 1 , 0 )\n* **Itching**: Yes, No ( 1 , 0 )\n* **Irritability**: Yes, No ( 1 , 0 )\n* **delayed healing**: Yes, No ( 1 , 0 )\n* **partial paresis**: Yes, No ( 1 , 0 )\n* **muscle stiness**: Yes, No ( 1 , 0 )\n* **Alopecia**: Yes, No ( 1 , 0 )\n* **Obesity**: Yes, No ( 1 , 0 )\n* **Class**: 1.Positive, 2.Negative.\n\n","2013aa16":"# [Data type of each columns](http:\/\/)","1f523a85":"# [Classification Metrics](http:\/\/)","68bdf7e2":"# [Splitting data to training and validation set](http:\/\/)\n\n","e59a5560":"# [Checking for NaN Values](http:\/\/)","e1fa237d":"# [Size of Dataset](http:\/\/)\n> Our data  contains the sign and symptom data of newly diabetic or would be diabetic patient and have 520 rows and 17 columns.","68c524a9":"# [Training model without preprocessing techniques](http:\/\/)\n\n","2ca638dd":"# [AUC Curve](http:\/\/)","bb3a3519":"# [Confusion Matrix](http:\/\/)","6e058dee":"# [Reference](http:\/\/)\n\n* https:\/\/en.wikipedia.org\/wiki\/Diabetes\n* https:\/\/www.who.int\/health-topics\/diabetes#tab=tab_1\n* https:\/\/www.medicalnewstoday.com\/articles\/323185\n* https:\/\/www.diabetes.org\/diabetes\/type-1\/symptoms\n* https:\/\/www.medicinenet.com\/diabetes_symptoms_in_men\/article.htm","532ce226":"# [Data Analysis](http:\/\/)\n\n"}}