{"cell_type":{"05b8ce86":"code","d745105c":"code","10bacd93":"code","cc6e8315":"code","e023d27f":"code","9c5e28a0":"code","caa811cf":"code","95894d14":"code","36cfb29d":"code","393c9dd8":"code","d534f22c":"code","c1f1c485":"code","31238b28":"code","d544a66a":"code","e5454c21":"code","4f0581d8":"code","0234c7ed":"code","6a977a09":"code","7967635a":"code","a5d35142":"code","90258ae1":"code","ac4289e3":"code","3d8b66bc":"code","1c5ac84f":"code","d0752800":"code","b21e527d":"code","8f15626e":"code","f50716ec":"code","79449207":"code","df974e94":"code","258efd1d":"code","be45d516":"code","972f201a":"code","315f6eda":"code","d1139553":"code","35c62e29":"code","8d2c312a":"code","f6f8f6bf":"code","289799f6":"code","82af7a8b":"code","da467efa":"code","24c250b4":"code","8caa2e46":"code","cf4090d3":"code","c7a460c9":"code","20346211":"code","1be1ef91":"code","ae0bfdce":"code","bc4c11ff":"code","8d89f9b7":"code","6e87c24d":"code","a6e0c556":"code","70a3769b":"code","6c4b058b":"code","259b32ab":"code","b238a5e9":"code","de79fe3b":"code","02d8a103":"code","77d5870d":"code","0feac9cb":"code","64940711":"code","ce0c39e3":"markdown"},"source":{"05b8ce86":"import pandas as pd\nimport numpy as np","d745105c":"import matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","10bacd93":"train = pd.read_csv('..\/input\/titanic-disaster\/train.csv')","cc6e8315":"train.head()","e023d27f":"sns.heatmap(train.isnull(),yticklabels=False,cbar=False,cmap='viridis')","9c5e28a0":"sns.set_style('whitegrid')","caa811cf":"sns.countplot(data=train,x='Survived',hue='Sex')","95894d14":"sns.countplot(data=train,x='Survived',hue='Pclass')","36cfb29d":"train['Age'].plot.hist(bins=35)","393c9dd8":"train.info()","d534f22c":"sns.countplot(data=train,x='SibSp')","c1f1c485":"train['Fare'].hist(bins=40,figsize=(10,4))","31238b28":"plt.figure(figsize=(10,7))\nsns.boxplot(data=train,x='Pclass',y='Age')","d544a66a":"def impute_age(cols):\n    Age = cols[0]\n    Pclass = cols[1]\n    if pd.isnull(Age):\n        if Pclass == 1:\n            return 37\n        elif Pclass == 2:\n            return 29\n        else:\n            return 24\n    else:\n        return Age","e5454c21":"train['Age']=train[['Age','Pclass']].apply(impute_age,axis=1)","4f0581d8":"sns.heatmap(train.isnull(),yticklabels=False,cbar=False,cmap='viridis')","0234c7ed":"train.drop('Cabin',axis=1,inplace=True)","6a977a09":"train.head()","7967635a":"train.dropna(inplace=True)","a5d35142":"sns.heatmap(train.isnull(),yticklabels=False,cbar=False,cmap='viridis')","90258ae1":"sex=pd.get_dummies(train['Sex'],drop_first=True)","ac4289e3":"sex.head()","3d8b66bc":"embark=pd.get_dummies(train['Embarked'],drop_first=True)","1c5ac84f":"embark.head()","d0752800":"train=pd.concat ([train,sex,embark],axis=1)","b21e527d":"train.head()","8f15626e":"train.drop(['Name','Sex','Embarked','Ticket'],axis=1,inplace=True)","f50716ec":"train.head()","79449207":"train.drop('PassengerId',axis=1,inplace=True)","df974e94":"train.head()","258efd1d":"X=train.drop('Survived',axis=1)\ny=train['Survived']","be45d516":"from sklearn.model_selection import train_test_split","972f201a":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=101)","315f6eda":" from sklearn.linear_model import LogisticRegression","d1139553":"logmodel = LogisticRegression()","35c62e29":"logmodel.fit(X_train,y_train)","8d2c312a":"predictions = logmodel.predict(X_test)","f6f8f6bf":"predictions","289799f6":"from sklearn.metrics import classification_report","82af7a8b":"print(classification_report(y_test,predictions))","da467efa":"test = pd.read_csv('..\/input\/titanic-disaster-data\/test.csv')","24c250b4":"test.info()","8caa2e46":"def impute_age(cols):\n    Age = cols[0]\n    Pclass = cols[1]\n    if pd.isnull(Age):\n        if Pclass == 1:\n            return 37\n        elif Pclass == 2:\n            return 29\n        else:\n            return 24\n    else:\n        return Age","cf4090d3":"test['Age']=test[['Age','Pclass']].apply(impute_age,axis=1)","c7a460c9":"test.drop('Cabin',axis=1,inplace=True)","20346211":"sns.heatmap(test.isnull(),yticklabels=False,cbar=False,cmap='viridis')","1be1ef91":"sex=pd.get_dummies(test['Sex'],drop_first=True)","ae0bfdce":"embark=pd.get_dummies(test['Embarked'],drop_first=True)","bc4c11ff":"test=pd.concat ([test,sex,embark],axis=1)","8d89f9b7":"result=test.iloc[:,0]","6e87c24d":"test.drop(['Name','Sex','Embarked','Ticket'],axis=1,inplace=True)","a6e0c556":"test.drop('PassengerId',axis=1,inplace=True)","70a3769b":"test.info()","6c4b058b":"#test.dropna(inplace=True)","259b32ab":"test.isnull().sum()","b238a5e9":"test.head()","de79fe3b":"Xinput = test","02d8a103":"Xinput.info()","77d5870d":"Youtput = logmodel.predict(Xinput)","0feac9cb":"Youtput","64940711":"df=pd.DataFrame(dict(PassengerId = result, Survived = Youtput)).reset_index()\ndf.drop('index', axis=1, inplace=True)\n\ndf.to_csv('titanic_model.csv', index=False)","ce0c39e3":"Test Data"}}