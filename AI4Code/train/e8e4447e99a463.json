{"cell_type":{"1fe9869b":"code","9c017c97":"code","43eaf35b":"code","93f57bae":"code","4b4365cf":"code","f6211ba3":"code","780dfa0e":"code","983ba9cc":"code","c7bfcd4a":"code","9e24d10b":"code","fa67d5f4":"code","e03636be":"code","0186d3f5":"code","934b7aa3":"code","aad027f5":"markdown","bd218285":"markdown"},"source":{"1fe9869b":"import numpy as np\nfrom tqdm import tqdm\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\nfrom keras.layers import Dense\nfrom keras.models import Sequential\nfrom keras import utils\n\nfrom sklearn.model_selection import train_test_split","9c017c97":"train_data = pd.read_csv('\/kaggle\/input\/digit-recognizer\/train.csv')\ntest_data = pd.read_csv('\/kaggle\/input\/digit-recognizer\/test.csv')\nsubmission = pd.read_csv('\/kaggle\/input\/digit-recognizer\/sample_submission.csv')","43eaf35b":"X = train_data.drop('label', axis=1)\ny = train_data['label']","93f57bae":"X = X.values.reshape(X.shape[0],-1)\ny = utils.to_categorical(y, 10)","4b4365cf":"test_data = test_data.values.reshape(test_data.shape[0],-1)\ntest_data.shape","f6211ba3":"x_train, x_val, y_train, y_val = train_test_split(X,y, test_size=0.2, random_state=4)","780dfa0e":"model = Sequential()\nmodel.add(Dense(512, activation='sigmoid', input_shape=(784,)))\nmodel.add(Dense(512, activation= 'sigmoid'))\nmodel.add(Dense(256, activation= 'sigmoid'))\nmodel.add(Dense(10, activation='softmax'))\n\nmodel.compile(optimizer='adam', loss='categorical_crossentropy', metrics=['accuracy'])","983ba9cc":"model.summary()","c7bfcd4a":"model.fit(x_train, y_train, validation_data=(x_val, y_val), epochs=50)","9e24d10b":"rows = 2\ncols = 5\nplt.figure(figsize=(10,10))\nfor x in range(rows * cols):\n    pred = np.argmax(model.predict(x_val[x].reshape(1,784)))\n    plt.subplot(rows, cols, x+1)\n    plt.imshow(x_val[x].reshape(28,28))\n    plt.xlabel('Predicted: {}'.format(pred))\nplt.tight_layout()\nplt.show()","fa67d5f4":"y_pred = model.predict(test_data)","e03636be":"predictions = []\nfor i,pred in enumerate(y_pred):\n    predictions.append(np.argmax(pred))","0186d3f5":"submission['Label'] = predictions","934b7aa3":"submission.to_csv('mnist.csv', index= False)","aad027f5":"# Preparing submission","bd218285":"# Model"}}