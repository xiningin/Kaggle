{"cell_type":{"5ce44d8e":"code","5f0bb428":"code","9dec744c":"code","0175585d":"code","29db98cb":"code","dc377f66":"code","994e2199":"code","a51351a4":"markdown","9d9216e0":"markdown","07c4bde0":"markdown","61a32c5b":"markdown","69e99068":"markdown"},"source":{"5ce44d8e":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport datetime\nfrom statsmodels.tsa.statespace.sarimax import SARIMAX","5f0bb428":"data_pre = pd.read_csv(\"\/kaggle\/input\/weekly-deaths-in-the-netherlands\/deaths_NL.csv\")\n\ndata_pre = data_pre[data_pre[\"Week\"].str.len()<20]\n\ndata_pre[\"Week\"] = data_pre[\"Week\"].str.replace(\"*\", \"\")\n\ndata_pre[\"Week\"] = pd.to_datetime(data_pre[\"Week\"]+'0', format=\"%Y week %U%w\")\ndata = data_pre.set_index('Week')\ndata.index = pd.DatetimeIndex(data.index.values,\n                               freq=data.index.inferred_freq)\n","9dec744c":"n = 100 # number of predictions","0175585d":"\nmy_order = (2, 1, 1)\nmy_seasonal_order = (1, 1, 1, 52)  # this will cause me problems as some years will have less than 52 weeks\n# define model\nmodel = SARIMAX(data['All ages: both sexes'], order=my_order, seasonal_order=my_seasonal_order)\n\n#TODO\n# Do something with this error: ValueWarning: A date index has been provided, but it has no associated frequency information \n# and so will be ignored when e.g. forecasting.","29db98cb":"model_fit = model.fit()","dc377f66":"yhat = model_fit.forecast(n)","994e2199":"base = data.index[-1]\ndate_list = [base + datetime.timedelta(days=x*7) for x in range(n)]\n\nplt.figure(figsize=(12,8));\nplt.plot(data.index, data[\"All ages: both sexes\"], label=\"Measured\");\nplt.plot(date_list,yhat, label = \"Predicted\");\nplt.xlabel(\"Date\");\nplt.ylabel(\"Total deaths per week\");\nplt.title(\"Deaths per week in The Netherlands - measured and predicted by SARIMAX (2,1,1)\");\nplt.legend();","a51351a4":"## Fit model and forecast","9d9216e0":"## Define model","07c4bde0":"## Import the modules","61a32c5b":"First I ignore the non-complete weeks, which can cause some small inconsistencies. \n\n1995 starts with a Sunday and has a full week in this dataset, so in this dataset, a week starts on Sunday. This is `%U` in `strftime`[[1]](https:\/\/strftime.org\/).","69e99068":"## Load data"}}