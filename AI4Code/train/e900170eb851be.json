{"cell_type":{"0eccefbd":"code","f9af6ff6":"code","7085edb8":"code","a9dd214d":"code","1c3a9fc9":"code","127868db":"code","6469f261":"code","5e65c542":"code","531098ec":"code","f9391868":"code","ff1c4e6e":"code","cff6a40f":"code","71521abf":"code","ff6d22a7":"code","d5ce5135":"code","852ada4c":"code","737ef535":"code","69eae689":"code","7b241479":"code","00f38afe":"code","2577a215":"code","07b65196":"code","979ef961":"code","a09af1b0":"code","e10a4c67":"code","714d2c2d":"code","ffce192e":"code","1d00a2e8":"code","1a8fd79f":"code","f2bc1d2b":"code","f6afe05f":"code","d11496db":"code","a6d60dac":"code","6ab28702":"code","874bb7b1":"code","f3ef71db":"code","7cdd246b":"code","ebd520ba":"code","0a58b02b":"code","03c7924c":"code","50b2a07a":"code","b9fc7e70":"code","0a99b534":"code","5ddee40f":"code","0ab94642":"code","63cf67e8":"code","a66528d8":"code","aa3db518":"code","c4f345b3":"code","d753d803":"code","08dcb6e4":"code","4d6128e0":"code","a8122947":"code","21385c4e":"code","136cc30c":"code","a32f211c":"code","e56972ed":"code","4e902fd5":"code","6b88aa55":"code","0fe7a6c5":"code","bbc4878f":"markdown","3203cd9b":"markdown","34b50e57":"markdown","06a213f9":"markdown","107796be":"markdown","1cf05235":"markdown","b70b9fdc":"markdown","82d70fe0":"markdown","61248acd":"markdown"},"source":{"0eccefbd":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n%matplotlib inline","f9af6ff6":"train = pd.read_csv('..\/input\/covid19-global-forecasting-week-1\/train.csv')\ntest = pd.read_csv('..\/input\/covid19-global-forecasting-week-1\/test.csv')","7085edb8":"train.head()","a9dd214d":"test.tail()","1c3a9fc9":"train.dtypes","127868db":"train['Date']= pd.to_datetime(train['Date']) \ntest['Date']= pd.to_datetime(test['Date']) ","6469f261":"new_train = train.set_index(['Date'])\nnew_test = test.set_index(['Date'])","5e65c542":"new_test.head()","531098ec":"new_train.head()","f9391868":"new_train.isnull().sum()","ff1c4e6e":"new_train.info()","cff6a40f":"new_test = new_test.drop([\"ForecastId\"], axis=1)","71521abf":"new_train = new_train.drop([\"Id\"], axis=1)","ff6d22a7":"new_train[['Province\/State']] = new_train[['Province\/State']].fillna('')","d5ce5135":"new_train.isnull().sum()","852ada4c":"new_test[['Province\/State']] = new_test[['Province\/State']].fillna('')","737ef535":"new_test.isnull().sum()","69eae689":"import plotly.express as px","7b241479":"# Creating a dataframe with total no of cases for every country\nconfirmiedcases = pd.DataFrame(new_train.groupby('Country\/Region')['ConfirmedCases'].sum())\nconfirmiedcases['Country\/Region'] = confirmiedcases.index","00f38afe":"confirmiedcases.index","2577a215":"confirmiedcases.index = np.arange(1,164)","07b65196":"global_confirmiedcases = confirmiedcases[['Country\/Region','ConfirmedCases']]","979ef961":"fig = px.bar(global_confirmiedcases.sort_values('ConfirmedCases',ascending=False)[:20][::-1],\n             x='ConfirmedCases',y='Country\/Region',title='Confirmed Cases Worldwide',text='ConfirmedCases', height=900, orientation='h')\nfig.show()","a09af1b0":"formated_gdf = new_train.groupby(['Date', 'Country\/Region'])['ConfirmedCases'].max()\nformated_gdf = formated_gdf.reset_index()\nformated_gdf['Date'] = pd.to_datetime(formated_gdf['Date'])\nformated_gdf['Date'] = formated_gdf['Date'].dt.strftime('%m\/%d\/%Y')\nformated_gdf['size'] = formated_gdf['ConfirmedCases'].pow(0.3)\n\nfig = px.scatter_geo(formated_gdf, locations=\"Country\/Region\", locationmode='country names', \n                     color=\"ConfirmedCases\", size='size', hover_name=\"Country\/Region\", \n                     range_color= [0, 1500], \n                     projection=\"natural earth\", animation_frame=\"Date\", \n                     title='CORONA: Spread Over Time From Jan 2020 to Mar 2020', color_continuous_scale=\"portland\")\nfig.show()","e10a4c67":"new_train.head()","714d2c2d":"new_test.head()","ffce192e":"new_train[\"Country\/Region\"].unique()","1d00a2e8":"def create_time_features(df):\n    \"\"\"\n    Creates time series features from datetime index\n    \"\"\"\n    df['date'] = df.index\n    df['hour'] = df['date'].dt.hour\n    df['dayofweek'] = df['date'].dt.dayofweek\n    df['quarter'] = df['date'].dt.quarter\n    df['month'] = df['date'].dt.month\n    df['year'] = df['date'].dt.year\n    df['dayofyear'] = df['date'].dt.dayofyear\n    df['dayofmonth'] = df['date'].dt.day\n    df['weekofyear'] = df['date'].dt.weekofyear\n    \n    X = df[['hour','dayofweek','quarter','month','year',\n           'dayofyear','dayofmonth','weekofyear']]\n    return X","1a8fd79f":"create_time_features(new_train)\ncreate_time_features(new_test)","f2bc1d2b":"new_train.head()","f6afe05f":"new_train.drop(\"date\", axis=1, inplace=True)\nnew_test.drop(\"date\", axis=1, inplace=True)","d11496db":"new_test.head()","a6d60dac":"new_train = pd.concat([new_train,pd.get_dummies(new_train['Province\/State'], prefix='ps')],axis=1)\nnew_train.drop(['Province\/State'],axis=1, inplace=True)\nnew_test = pd.concat([new_test,pd.get_dummies(new_test['Province\/State'], prefix='ps')],axis=1)\nnew_test.drop(['Province\/State'],axis=1, inplace=True)","6ab28702":"new_train = pd.concat([new_train,pd.get_dummies(new_train['Country\/Region'], prefix='cr')],axis=1)\nnew_train.drop(['Country\/Region'],axis=1, inplace=True)\nnew_test = pd.concat([new_test,pd.get_dummies(new_test['Country\/Region'], prefix='cr')],axis=1)\nnew_test.drop(['Country\/Region'],axis=1, inplace=True)","874bb7b1":"new_train.head()","f3ef71db":"y_train = new_train[\"Fatalities\"]","7cdd246b":"X_train = new_train.drop([\"Fatalities\", \"ConfirmedCases\"], axis=1)","ebd520ba":"import xgboost as xgb\nfrom xgboost import plot_importance, plot_tree\nfrom sklearn.metrics import mean_squared_error, mean_absolute_error","0a58b02b":"reg = xgb.XGBRegressor(n_estimators=1000)","03c7924c":"reg.fit(X_train, y_train, verbose=True)","50b2a07a":"plot = plot_importance(reg, height=0.9, max_num_features=20)","b9fc7e70":"y_train = train[\"ConfirmedCases\"]","0a99b534":"reg = xgb.XGBRegressor(n_estimators=1000)","5ddee40f":"reg.fit(X_train, y_train, verbose=True)","0ab94642":"plot = plot_importance(reg, height=0.9, max_num_features=20)","63cf67e8":"y_train = train.groupby([\"Country\/Region\"]).ConfirmedCases.pct_change(periods=1)","a66528d8":"y_train = y_train.replace(np.nan, 0)","aa3db518":"y_train = y_train.replace(np.inf, 0)","c4f345b3":"reg = xgb.XGBRegressor(n_estimators=1000)","d753d803":"reg.fit(X_train, y_train, verbose=True)","08dcb6e4":"plot = plot_importance(reg, height=0.9, max_num_features=20)","4d6128e0":"y_train = train[\"ConfirmedCases\"]\nconfirmed_reg = xgb.XGBRegressor(n_estimators=1000)\nconfirmed_reg.fit(X_train, y_train, verbose=True)\npreds = confirmed_reg.predict(new_test)\npreds = np.array(preds)\npreds[preds < 0] = 0\npreds = np.round(preds, 0)","a8122947":"preds = np.array(preds)","21385c4e":"preds","136cc30c":"submission_new = pd.read_csv(\"..\/input\/covid19-global-forecasting-week-1\/submission.csv\")","a32f211c":"submission_new.head()","e56972ed":"submission_new[\"ConfirmedCases\"]=pd.Series(preds)","4e902fd5":"y_train = train[\"Fatalities\"]\nconfirmed_reg = xgb.XGBRegressor(n_estimators=1000)\nconfirmed_reg.fit(X_train, y_train, verbose=True)\npreds = confirmed_reg.predict(new_test)\npreds = np.array(preds)\npreds[preds < 0] = 0\npreds = np.round(preds, 0)\nsubmission_new[\"Fatalities\"]=pd.Series(preds)","6b88aa55":"submission_new","0fe7a6c5":"submission_new.to_csv('submission.csv',index=False)","bbc4878f":"**Filling missing values**","3203cd9b":"**Set the index as date**","34b50e57":"**XGBoost**","06a213f9":"**Changing Date column to datetime**","107796be":"**COVID-19** Analysis","1cf05235":"**Creating Time Features**","b70b9fdc":"**OHE of Province\/State & Country\/Region**","82d70fe0":"*Dropping Id*","61248acd":"The **coronavirus pandemic** is an ongoing pandemic of coronavirus disease 2019 (COVID-19), caused by severe acute respiratory syndrome coronavirus 2 (SARS-CoV-2).The outbreak was first identified in Wuhan, Hubei, China, in December 2019, and was recognised as a pandemic by the World Health Organization (WHO) on 11 March 2020.As of 25 March, more than 438,000 cases of COVID-19 have been reported in more than 190 countries and territories, resulting in more than 19,600 deaths and more than 111,000 recoveries.\n![https:\/\/en.wikipedia.org\/wiki\/2019%E2%80%9320_coronavirus_pandemic#\/media\/File:COVID-19_Outbreak_World_Map_per_Capita.svg](http:\/\/)"}}