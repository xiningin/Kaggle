{"cell_type":{"2cbc8edd":"code","31edd0a1":"code","ad3c2363":"code","dec053ba":"code","5ced99ac":"code","9e039123":"code","0920bbdf":"code","c610fb51":"code","2485c4d1":"code","7c62535c":"code","76249419":"code","0cf0f95e":"code","29fba1ac":"code","004b4222":"code","06a273a2":"code","9a3f3319":"markdown","ab7c164f":"markdown","de5ac304":"markdown","677b70c6":"markdown","e8f01d5b":"markdown","1a1ea49b":"markdown"},"source":{"2cbc8edd":"import numpy as np\nimport pandas as pd\nimport os\nfrom tensorflow.keras.preprocessing.image import load_img, img_to_array\nfrom tensorflow import keras\nfrom tensorflow.keras import Input\nfrom keras.preprocessing.image import ImageDataGenerator, load_img\nfrom sklearn.model_selection import train_test_split\nimport matplotlib.pyplot as plt\nfrom keras.utils import to_categorical\n","31edd0a1":"dir1 = '..\/input\/chest-xray-pneumonia\/chest_xray\/train'\ndir2 = '..\/input\/chest-xray-pneumonia\/chest_xray\/test'","ad3c2363":"dataset=[]\nmapping={\"PNEUMONIA\":0,\"NORMAL\":1}\ncount=0\n\nfor file in os.listdir(dir1):\n    path=os.path.join(dir1,file)\n    for im in os.listdir(path):\n        image=load_img(os.path.join(path,im), grayscale=False, color_mode='grayscale', target_size=(150,150))\n        image=img_to_array(image)\n        image=image\/255.0\n        dataset.append([image,count])     \n    count=count+1","dec053ba":"testset=[]\nmapping={\"PNEUMONIA\":0,\"NORMAL\":1}\ncount=0\n\nfor file in os.listdir(dir2):\n    path=os.path.join(dir2,file)\n    for im in os.listdir(path):\n        image=load_img(os.path.join(path,im), grayscale=False, color_mode='grayscale', target_size=(150,150))\n        image=img_to_array(image)\n        image=image\/255.0\n        testset.append([image,count])         \n    count=count+1","5ced99ac":"data,labels0=zip(*dataset)\ntest,testlabels0=zip(*testset)","9e039123":"print('Total number of images in training dataset :',len(data))\nprint('Number of images of NORMAL:',sum(labels0))\nprint('Number of images of PNEUMONIA :',len(data)-sum(labels0))\n","0920bbdf":"print('Total number of images in testing dataset :',len(test))\nprint('Number of images of NORMAL:',sum(testlabels0))\nprint('Number of images of PNEUMONIA :',len(test)-sum(testlabels0))","c610fb51":"# Quick look to the images \n\nimg_name = 'IM-0115-0001.jpeg'\nimg_normal = load_img('..\/input\/chest-xray-pneumonia\/chest_xray\/train\/NORMAL\/' + img_name)\nimg_name1 = 'IM-0122-0001.jpeg'\nimg_normal1 = load_img('..\/input\/chest-xray-pneumonia\/chest_xray\/train\/NORMAL\/' + img_name1)\n\nimg_name_1 = 'person1000_virus_1681.jpeg'\nimg_pneumonia = load_img('..\/input\/chest-xray-pneumonia\/chest_xray\/train\/PNEUMONIA\/' + img_name_1)\nimg_name_2 = 'person1002_bacteria_2933.jpeg'\nimg_pneumonia1 = load_img('..\/input\/chest-xray-pneumonia\/chest_xray\/train\/PNEUMONIA\/' + img_name_2)\nfig, axs = plt.subplots(2,2,figsize=(10,6))\naxs[0][0].imshow(img_normal)\naxs[0][0].set_title(\"NORMAL\")\naxs[0][1].imshow(img_normal1)\naxs[0][1].set_title(\"NORMAL\")\naxs[1][0].imshow(img_pneumonia)\naxs[1][0].set_title(\"PNEUMONIA\")\naxs[1][1].imshow(img_pneumonia1)\naxs[1][1].set_title(\"PNEUMONIA\")","2485c4d1":"labels1=to_categorical(labels0)\nX_train=np.array(data)\ny_train=np.array(labels1)\nprint(\"Data Shape:{}\\nTrain Labels shape: {}\".format(X_train.shape,y_train.shape))\ntestlabels1=to_categorical(testlabels0)\nX_test=np.array(test)\ny_test=np.array(testlabels1)\nprint(\"Test Shape:{}\\nTest Labels shape: {}\".format(X_test.shape,y_test.shape))","7c62535c":"\ntrainx,k,trainy,k1=train_test_split(X_train,y_train,test_size=0.0001,random_state=44)\ntestx,k2,testy,k3=train_test_split(X_test,y_test,test_size=0.001,random_state=44)\ntrainx.resize(5215,22500)\ntestx.resize(623,22500)\ntrainx.shape\n","76249419":"from sklearn.neural_network import MLPClassifier\nclf = MLPClassifier(random_state=1,max_iter=50,learning_rate='adaptive').fit(trainx,trainy)\nclf.score(testx, testy)\n","0cf0f95e":"predy = clf.predict(testx)\nfrom sklearn.metrics import confusion_matrix,ConfusionMatrixDisplay\ncm=confusion_matrix(testy.argmax(axis=1),predy.argmax(axis=1))\ndisp = ConfusionMatrixDisplay(confusion_matrix=cm,display_labels=['Pneumonia','Normal'])\ndisp.plot()\nprint(\"Accuracy of the model :\",100*clf.score(testx,testy))","29fba1ac":"from sklearn.metrics import classification_report\ntarget_names = ['Pneumonia', 'Normal']\nprint(classification_report(testy.argmax(axis=1),predy.argmax(axis=1), target_names=target_names))","004b4222":"pim='..\/input\/chest-xray-pneumonia\/chest_xray\/train\/PNEUMONIA\/person1000_virus_1681.jpeg'\nimage=load_img(pim, grayscale=False, color_mode='grayscale', target_size=(150,150))\nimage=img_to_array(image)\nimage=image\/255.0\nx=clf.predict(image.reshape(1,22500)).argmax(axis=1)[0]\nif(x==0):\n    print('Pneumonia')\nelse: \n    print('Normal')\nplt.imshow(load_img(pim))","06a273a2":"pim='..\/input\/chest-xray-pneumonia\/chest_xray\/train\/NORMAL\/IM-0137-0001.jpeg'\nimage=load_img(pim, grayscale=False, color_mode='grayscale', target_size=(150,150))\nimage=img_to_array(image)\nimage=image\/255.0\nx=clf.predict(image.reshape(1,22500)).argmax(axis=1)[0]\nif(x==0):\n    print('Pneumonia')\nelse: \n    print('Normal')\nplt.imshow(load_img(pim))","9a3f3319":"## Exploring Dataset","ab7c164f":"## Loading dataset","de5ac304":"## Feature engineering","677b70c6":"## Importing libraries\n","e8f01d5b":"## ML model : ","1a1ea49b":"## Testing model"}}