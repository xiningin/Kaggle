{"cell_type":{"3e3cde3a":"code","762fc0f9":"code","31bf903b":"code","e0689435":"code","f169bb39":"code","fbea5c04":"code","ad8bfd45":"code","a320f73f":"code","15ad4ee4":"code","05164a3e":"code","a56fee4b":"code","8aea013a":"code","f68a9640":"code","79764bd2":"code","636c5b6b":"code","7e86025a":"code","01371c98":"code","dbf2492c":"code","58d236fb":"code","d42d5cf3":"code","d92ae58c":"code","f8be6a1c":"markdown","c390b426":"markdown","201413f7":"markdown","1bcb4eb6":"markdown","42c1cd5b":"markdown","ce5552b8":"markdown","1ae9cfe3":"markdown","379b1207":"markdown","4b6e0abe":"markdown","18274b58":"markdown","37baca22":"markdown"},"source":{"3e3cde3a":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n        \nimport plotly.io as pio\nimport plotly.express as px\nimport plotly.graph_objects as go\nimport plotly.figure_factory as ff\nfrom plotly.subplots import make_subplots\nfrom plotly.validators.scatter.marker import SymbolValidator\nimport plotly.offline as pyo\npyo.init_notebook_mode()\n\nimport missingno as msno\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.metrics import accuracy_score, confusion_matrix, classification_report\n\ndf = pd.read_csv(\"..\/input\/stroke-prediction-dataset\/healthcare-dataset-stroke-data.csv\")\ndf.drop('id',axis=1,inplace=True)","762fc0f9":"msno.bar(df)\nplt.show()","31bf903b":"df = df.dropna()","e0689435":"def make_bar(feature, rows, cols):\n    tmp2 = df.groupby(feature)['stroke'].mean()\n    tmp = 1 - df.groupby(feature)['stroke'].mean().values\n    fig.add_trace(go.Bar(x = df[feature].value_counts().index, y= df[feature].value_counts().values*tmp,\n                     text=tmp,texttemplate='Not_Stroke : %{text:.2f}',textposition='auto'),rows,cols)\n    fig.add_trace(go.Bar(x = df[feature].value_counts().index, y= df[feature].value_counts().values * df.groupby(feature)['stroke'].mean().values,\n                     text=tmp2,texttemplate='Stroke : %{text:.2f}', textposition='auto'),rows,cols)\n\nfig = make_subplots(rows=4, cols=2, shared_yaxes=True,subplot_titles=(\"Gender\", \"Hypertension\",\n                                                                     \"Heart_disease\",\"Ever_married\",\n                                                                     \"Work_type\",\"Residence_type\",\n                                                                     \"Smoking_status\"),vertical_spacing=0.1)\nmake_bar('gender',1,1)\nmake_bar('hypertension',1,2)\nmake_bar('heart_disease',2,1)\nmake_bar('ever_married',2,2)\nmake_bar('work_type',3,1)\nmake_bar('Residence_type',3,2)\nmake_bar('smoking_status',4,1)\n\nfig.update_layout(barmode='stack')\nfig.update_layout(font_family=\"Rockwell\",height = 450*4, showlegend=False)\nfig.update_layout(paper_bgcolor=px.colors.qualitative.Pastel2[2],bargap=0.2)\nfig.show()","f169bb39":"fig = make_subplots(rows=1, cols=3, shared_yaxes=True,subplot_titles=(\"Age\", \"avg_glucose_level\",\"bmi\"))\n\ntmp = df['age']\nfig.add_trace(go.Histogram(x = df[df['stroke'] ==0]['age'], nbinsx=100),1,1)\nfig.add_trace(go.Histogram(x = df[df['stroke'] ==1]['age'], nbinsx=100),1,1)\n\nfig.add_trace(go.Histogram(x = df[df['stroke'] ==0]['avg_glucose_level'], nbinsx=400),1,2)\nfig.add_trace(go.Histogram(x = df[df['stroke'] ==1]['avg_glucose_level'], nbinsx=400),1,2)\n\nfig.add_trace(go.Histogram(x = df[df['stroke'] ==0]['bmi'], nbinsx=460),1,3)\nfig.add_trace(go.Histogram(x = df[df['stroke'] ==1]['bmi'], nbinsx=460),1,3)\n\n\nfig.update_layout(font_family=\"Rockwell\", showlegend=False)\nfig.update_layout(barmode=\"overlay\")\nfig.update_layout(paper_bgcolor=px.colors.qualitative.Pastel2[2])\nfig.show()","fbea5c04":"fig = px.parallel_categories(df, color ='stroke')\nfig.show()","ad8bfd45":"px.parallel_coordinates(df,color='stroke')","a320f73f":"str_list = ['gender','ever_married','work_type','Residence_type','smoking_status']\n\ndf =pd.get_dummies(df, columns=str_list,drop_first=True)\n\nig, ax = plt.subplots(1, 1, figsize=(14, 10))\nmask = np.triu(np.ones_like(df.corr(), dtype=bool))\nax = sns.heatmap(df.corr(),cmap='coolwarm',annot=True,mask=mask,)","15ad4ee4":"X = df.drop('stroke',axis=1)\ny = df['stroke']\n\nX_train, X_test, y_train, y_test = train_test_split(X,y, test_size=.2, random_state= 100)","05164a3e":"accur = []\npred_as_1 =[]\nfor i in range(2,51):\n    model = DecisionTreeClassifier(max_depth= i).fit(X_train, y_train)\n    pred = model.predict(X_test)\n    accur.append(accuracy_score(y_test, pred))\n    pred_as_1.append(confusion_matrix(y_test, pred)[1][1])","a56fee4b":"fig, axes = plt.subplots(nrows=1, ncols=2, figsize=(15,4))\nx=list(range(2,51))\naxes[0].plot(x,accur,'r')\naxes[1].plot(x,pred_as_1,'b')\nplt.show()","8aea013a":"model = DecisionTreeClassifier(max_depth= 16).fit(X_train, y_train)\npred = model.predict(X_test)\n\nconfusion_matrix(y_test, pred)","f68a9640":"print(classification_report(y_test,pred))","79764bd2":"df_control = pd.concat([df[df['stroke']==0].sample(500),df[df['stroke']==1]])","636c5b6b":"labels = ['Not Stroke','Stroke']\nspecs = [[{'type':'domain'}, {'type':'domain'}]]\nfig = make_subplots(rows=1, cols=2,specs= specs)\nfig.add_trace(go.Pie(labels=labels, values=list(df['stroke'].value_counts()), hole = .8),1,1)\nfig.add_trace(go.Pie(labels=labels, values=list(df_control['stroke'].value_counts()), hole = .8),1,2)\nfig.update_traces(textposition='outside', textinfo='percent+label')\nfig.update_layout(\n    title_text=\"Control the dataset's stroke rate\",\n    annotations=[dict(text='Previous', x=0.2, y=0.5, font_size=20, showarrow=False),\n                dict(text='Now', x=0.8, y=0.5, font_size=20, showarrow=False),\n                dict(text='->', x=0.5, y=0.5, font_size=20, showarrow=False)],\n    height=500)\nfig.update(layout_showlegend=False)\nfig.show()","7e86025a":"X = df_control.drop('stroke',axis=1)\ny = df_control['stroke']\nX_train, X_test, y_train, y_test = train_test_split(X,y, test_size=.2, random_state= 100)","01371c98":"from sklearn.ensemble import RandomForestClassifier","dbf2492c":"accur2 = []\npred_as_2 =[]\nfor i in range(2,51):\n    model = RandomForestClassifier(max_depth= i).fit(X_train, y_train)\n    pred = model.predict(X_test)\n    accur2.append(accuracy_score(y_test, pred))\n    pred_as_2.append(confusion_matrix(y_test, pred)[1][1])","58d236fb":"fig, axes = plt.subplots(nrows=1, ncols=2, figsize=(15,4))\nx=list(range(2,51))\naxes[0].plot(x,accur2,'r')\naxes[1].plot(x,pred_as_2,'b')\nplt.show()","d42d5cf3":"model = RandomForestClassifier(max_depth= accur2.index(max(accur2))).fit(X_train, y_train)\npred = model.predict(X_test)\nconfusion_matrix(y_test, pred)","d92ae58c":"print(classification_report(y_test,pred))","f8be6a1c":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:blue;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<h1 style=\"text-align: center;\n           padding: 10px;\n              color:white\">\n\nImport the libraries and Load dataset\n<\/h1>\n<\/div>","c390b426":"### It is lower than previous decisiontree model, But I think this model is more better than previous model. Because the stroke 1's  score is improve!","201413f7":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:blue;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<h1 style=\"text-align: center;\n           padding: 10px;\n              color:white\">\n\nMissing data\n<\/h1>\n<\/div>","1bcb4eb6":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:blue;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<h1 style=\"text-align: center;\n           padding: 10px;\n              color:white\">\n\nHeart Stroke  EDA and Prediction\n<\/h1>\n<\/div>\n\n![](https:\/\/viewmedica.com\/images\/thumbslarge\/heartfailure_1280.jpg)","42c1cd5b":"### The only bmi has missingdata. But, It is only 4%. So, I will drop this missingdata","ce5552b8":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:blue;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<h1 style=\"text-align: center;\n           padding: 10px;\n              color:white\">\n\nTry control dataset\n<\/h1>\n<\/div>","1ae9cfe3":"### I think, It is bad model. because, It's accuracy is high but, It can't predict stroke(1).","379b1207":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:blue;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<h1 style=\"text-align: center;\n           padding: 10px;\n              color:white\">\n\nPrediction by DecisionTreeClassifier\n<\/h1>\n<\/div>","4b6e0abe":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:blue;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<h1 style=\"text-align: center;\n           padding: 10px;\n              color:white\">\n\nVisualizing Data\n<\/h1>\n<\/div>","18274b58":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:blue;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n\n<h1 style=\"text-align: center;\n           padding: 10px;\n              color:white\">\n\nFeatures\n<\/h1>\n<\/div>\n\n* id - Unique id\n* gender - Gender, \"Male\", \"Female\" or \"Other\"\n* age - Age\n* hypertension - Hypertension binary feature,  0 if the patient doesn't have hypertension, 1 if the patient has hypertension\n* heart_disease - Heart disease binary feature, 0 if the patient doesn't have any heart diseases, 1 if the patient has a heart disease\n* ever_married - Has the patient ever been married?, \"No\" or \"Yes\"\n* work_type - Work type of the patient, \"children\", \"Govt_jov\", \"Never_worked\", \"Private\" or \"Self-employed\"\n* Residence_type - Residence type of the patient, \"Rural\" or \"Urban\"\n* avg_glucose_level - Average glucose level in blood\n* bmi - Body Mass Index\n* smoking_status - Smoking status of the patient, \"formerly smoked\", \"never smoked\", \"smokes\" or \"Unknown\"*\n* stroke - Stroke event, 1 if the patient had a stroke or 0 if not\n\n### Note: \"Unknown\" in smoking_status means that the information is unavailable for this patient","37baca22":"## Context\n### According to the World Health Organization (WHO) stroke is the 2nd leading cause of death globally, responsible for approximately 11% of total deaths."}}