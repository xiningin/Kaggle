{"cell_type":{"4321f3a3":"code","b5083e01":"code","6889fcd1":"code","06e7a8dd":"code","611c2e24":"code","3831d2c3":"code","434b04cc":"code","15f1b049":"code","3a093a62":"code","d87a7970":"code","9803b263":"code","62c2add7":"markdown","522cf43e":"markdown","d02e7902":"markdown","f3892ce5":"markdown","36651762":"markdown","31ad5620":"markdown","d0c8c9f5":"markdown","97502e4e":"markdown"},"source":{"4321f3a3":"import os\nimport numpy as np\nimport pandas as pd\nfrom lightgbm import LGBMRegressor\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import KFold, cross_val_score\n\npd.set_option('display.max_columns', 200)\npd.set_option('display.max_rows', 100)\n\nprint(os.listdir('..\/input'))","b5083e01":"train = pd.read_csv('..\/input\/train.csv')\ntest = pd.read_csv('..\/input\/test.csv')\nprint(\"Train has {} samples and {} variables.\".format(train.shape[0],train.shape[1]))\nprint(\"Test has {} samples and {} variables.\".format(test.shape[0],test.shape[1]))","6889fcd1":"train.head()","06e7a8dd":"train.columns.values","611c2e24":"for df in [train,test]:\n    for c in df:\n        if (df[c].dtype=='object'):\n            lbl = LabelEncoder() \n            lbl.fit(list(df[c].values))\n            df[c] = lbl.transform(list(df[c].values))","3831d2c3":"train.head()","434b04cc":"ntrain = train.shape[0]\nntest = test.shape[0]\nSEED = 2019 # for reproducibility\nNFOLDS = 5\n# Define Cross Validation\nfolds = KFold(n_splits=NFOLDS, shuffle=True, random_state=SEED)\n\n# Define evaluation function (Root Mean Square Error)\ndef cv_rmse(model, X, y):\n    rmse = np.sqrt(-cross_val_score(model, X, y, scoring=\"neg_mean_squared_error\", cv=folds))\n    return (rmse)","15f1b049":"cols_to_exclude = ['id', 'Overall Probability']\ny_train = train['Overall Probability'].ravel() #ravel coverts a series to a numpy array\ndf_train_columns = [c for c in train.columns if c not in cols_to_exclude]\n\n\nx_train = train[df_train_columns].values # converts a dataframe to a numpy array\nx_test = test[df_train_columns].values","3a093a62":"lightgbm = LGBMRegressor(objective='regression', \n                                       num_leaves=4,\n                                       learning_rate=0.01, \n                                       n_estimators=1000,\n                                       max_bin=200, \n                                       bagging_fraction=0.75,\n                                       bagging_freq=5, \n                                       bagging_seed=7,\n                                       feature_fraction=0.2,\n                                       feature_fraction_seed=7,\n                                       verbose=-1,\n                                       )\n\nscore = cv_rmse(lightgbm, x_train, y_train)\nprint(\"lightgbm: {:.4f} ({:.4f})\".format(score.mean(), score.std()) )","d87a7970":"lgb_model = lightgbm.fit(x_train, y_train)\nprediction = lgb_model.predict(x_test)","9803b263":"sample_submission = pd.read_csv('..\/input\/sample_submission.csv')\nsub_df = pd.DataFrame({\"id\":sample_submission[\"id\"].values})\nsub_df[\"Overall Probability\"] = prediction\nsub_df[\"Overall Probability\"] = sub_df[\"Overall Probability\"].apply(lambda x: 1 if x>1 else 0 if x<0 else x)\nsub_df.to_csv(\"submission.csv\", index=False)","62c2add7":"## Train Models","522cf43e":"### LightGBM","d02e7902":"### Read Dataset","f3892ce5":"### Create Submission File","36651762":"### Predict","31ad5620":"### Encode Categorical Features","d0c8c9f5":"### Import Packages","97502e4e":"**Variables**"}}