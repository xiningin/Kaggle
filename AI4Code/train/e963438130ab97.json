{"cell_type":{"7452c738":"code","1bc2b388":"code","b72900d0":"code","46647dad":"code","a76ba94a":"code","022de4a5":"code","d9835ff3":"code","bf74e086":"code","9fad0cd9":"code","60fabd82":"code","f9dbc62c":"code","8693e3d9":"code","923c6e01":"code","8bbe9f9f":"code","b5316f6b":"code","0fbe3916":"code","2a08063d":"code","45646d58":"code","970088b5":"code","6bd3d820":"code","746b9d02":"code","3a6385f1":"code","4489c5d8":"code","eb025709":"code","e178968f":"code","7f71c2b5":"code","883fe1e6":"code","f5e55b57":"code","e1299696":"code","b6bba070":"code","f7d9bdb9":"code","b7bd0101":"code","4abefa57":"code","0a094305":"code","b1b75b26":"code","af76df69":"code","324ab593":"code","5d8405c0":"code","d3733699":"code","614456e5":"code","5e9e8dd9":"code","1f6e76cd":"code","839b2ab6":"code","90a2abef":"code","ae776b5a":"code","73d9fa59":"code","f77a8370":"code","67319023":"code","0c847df5":"code","9c6f8d3a":"code","bab72fe5":"code","d80152a5":"code","ec718d34":"code","4ed9703a":"code","3c291543":"code","6f3ae6d8":"code","a6a732f7":"code","79efd9bd":"code","3c707338":"code","865ee619":"code","40135dd2":"code","184b99c0":"code","a4cd25e1":"code","40b8b219":"code","9d864ce6":"code","7a3ad1f9":"code","3a8b1201":"code","4a3f1a6d":"code","aa81edda":"code","935ac8ab":"code","4a2ac03d":"code","92bf2bfa":"code","10572950":"code","58bfb85c":"code","27c2f006":"code","4efc31e6":"code","604f9bd3":"code","ced8ed91":"code","36f2d09a":"code","e66feee7":"code","ab3d79da":"code","74855bf7":"code","b2b07ce1":"code","28da2f29":"code","822f1ea3":"code","0dd34ab5":"code","e4e6b113":"code","0ffa21b0":"code","4e23907a":"code","add3e5b1":"code","37067402":"code","12c2d738":"code","9dbd330c":"code","9d88da71":"code","7ff5370d":"code","dce9bb45":"code","519eea9a":"code","c545196e":"code","e0aac991":"code","1cb6961f":"code","a90b7442":"code","84190149":"code","1df67e74":"code","d856351d":"code","d563ba15":"code","70b571e0":"code","e3974bda":"code","9a8b22f5":"code","93dd041b":"code","830ec2c2":"code","4d36a5e7":"code","7f714bf1":"code","a7c5683d":"code","0b83bd0c":"code","fd550c0a":"code","c521a488":"code","388a1ad3":"code","0316d94c":"code","cf696d2e":"code","02cbedad":"code","245e213f":"code","84687f83":"code","71122c78":"code","bf8cdae0":"code","01af8e0a":"code","538557a0":"code","16025ede":"code","a53f8de0":"code","7be466f4":"code","4a9e30dd":"code","06a3c941":"code","dda420a3":"markdown","922533f2":"markdown","3034caf7":"markdown","4607c43b":"markdown","324cbd8d":"markdown","d7fb4661":"markdown","8200e4ba":"markdown","ea7479e5":"markdown","5a20e62e":"markdown","ba2b24c0":"markdown","a54a793d":"markdown","125b5d7e":"markdown","ed71692d":"markdown","95f48203":"markdown","6a5b1eea":"markdown","5088b2dd":"markdown","ff0dd04d":"markdown","e79d4028":"markdown"},"source":{"7452c738":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sb","1bc2b388":"from sklearn.preprocessing import normalize,StandardScaler,MinMaxScaler","b72900d0":"from sklearn.cluster import  KMeans,MeanShift,DBSCAN,AgglomerativeClustering","46647dad":"from sklearn.metrics import silhouette_score","a76ba94a":"sc=StandardScaler()","022de4a5":"pip install openpyxl","d9835ff3":"bank=pd.read_excel(\"..\/input\/bank-customers-churn\/bank.xlsx\",\"Sheet1\")","bf74e086":"bank.head()","9fad0cd9":"bank.tail()","60fabd82":"bank.columns","f9dbc62c":"\"\"\"\nNumber of days from the opening of the deposit until the date of the last transaction=NOF\nNumber of days of inactivity from the last transaction to the date of the day=NOITD\nTN=Total number\n\"\"\"\n\ncol=[\"index\",\"Account number\",\"Remaining on 31-6-98\",\"Average account balance\"\n             ,\"TN debtor transactions\",\"TN creditor transactions\"\n             ,\"TN transactions\",\"average debtor transaction\"\n              ,\"average creditor transaction\",\"Average interval between transaction days\"\n              ,\"NOITD\",\n               \"NOF\"   \n    ]","8693e3d9":"bank.columns=col","923c6e01":"bank.head()","8bbe9f9f":"bank.describe()","b5316f6b":"bank.info()","0fbe3916":"bank.drop(\"index\",axis=1,inplace=True)","2a08063d":"bank.NOF.nunique()","45646d58":"bank.NOF.value_counts(dropna=False,normalize=True).head()\n#24% nan value","970088b5":"plt.figure(figsize=(17,5),dpi=120)\n\nplt.subplot(221)\nplt.scatter(bank.NOF,bank[\"Average account balance\"])\nplt.xlabel(\"NOF\")\nplt.ylabel(\"Average account balance\")\nplt.title(\"Effect of NOF on Average account balance\")\n\nplt.subplot(222)\nplt.scatter(bank.NOF,bank[\"Remaining on 31-6-98\"],color=\"r\")\nplt.xlabel(\"NOF\")\nplt.ylabel(\"Remaining on 31-6-98\")\nplt.title(\"Effect of NOF on Remaining on 31-6-98\")\n\nplt.subplot(223)\nplt.scatter(bank.NOF,bank[\"TN transactions\"],color=\"g\")\nplt.xlabel(\"NOF\",fontsize=7)\nplt.ylabel(\"TN transactions\",fontsize=7)\nplt.title(\"Effect of NOF on TN transactions\",fontsize=7)\n\nplt.subplot(224)\nplt.scatter(bank.NOF,bank[\"Average interval between transaction days\"],color=\"black\")\nplt.xlabel(\"NOF\",fontsize=7)\nplt.ylabel(\"Average interval between transaction days\",fontsize=7)\nplt.title(\"Effect of NOF on Average interval between transaction days\",fontsize=7)\n\nplt.subplots_adjust(3,3,4.7,4.7)\n","6bd3d820":"##  NOF tasir khasi roye hich kdom nadare  & feature mofidi nist aslan\nbank.drop(\"NOF\",axis=1,inplace=True)","746b9d02":"bank.NOITD.value_counts(dropna=False,normalize=True)\n#24% nan values","3a6385f1":"bank[\"NOITD\"].agg({\"min\",\"mean\",\"max\"})","4489c5d8":"sb.distplot(bank[\"NOITD\"])\nplt.xticks([0,37.7,271],[\"min\",\"mean\",\"max\"])","eb025709":"plt.figure(figsize=(17,5),dpi=120)\n\nplt.subplot(221)\nplt.scatter(bank.NOITD,bank[\"Average account balance\"])\nplt.xlabel(\"NOITD\")\nplt.ylabel(\"Average account balance\")\nplt.title(\"Effect of NOITD on Average account balance\")\n\nplt.subplot(222)\nplt.scatter(bank.NOITD,bank[\"Remaining on 31-6-98\"],color=\"r\")\nplt.xlabel(\"NOITD\")\nplt.ylabel(\"Remaining on 31-6-98\")\nplt.title(\"Effect of NOITD on Remaining on 31-6-98\")\n\nplt.subplot(223)\nplt.scatter(bank.NOITD,bank[\"TN transactions\"],color=\"g\")\nplt.xlabel(\"NOITD\",fontsize=7)\nplt.ylabel(\"TN transactions\",fontsize=7)\nplt.title(\"Effect of NOITD on TN transactions\",fontsize=7)\n\nplt.subplot(224)\nplt.scatter(bank.NOITD,bank[\"Average interval between transaction days\"],color=\"black\")\nplt.xlabel(\"NOITD\",fontsize=7)\nplt.ylabel(\"Average interval between transaction days\",fontsize=7)\nplt.title(\"Effect of NOITD on Average interval between transaction days\",fontsize=7)\n\nplt.subplots_adjust(3,3,4.7,4.7)\n","e178968f":"plt.scatter(bank[\"NOITD\"],bank['Account number'])","7f71c2b5":"plt.figure(figsize=(17,5),dpi=120)\n\nplt.subplot(221)\nplt.scatter(bank[\"Account number\"],bank[\"Average account balance\"])\nplt.xlabel(\"Account number\")\nplt.ylabel(\"Average account balance\")\nplt.title(\"Effect of Account number on Average account balance\")\n\nplt.subplot(222)\nplt.scatter(bank[\"Account number\"],bank[\"Remaining on 31-6-98\"],color=\"r\")\nplt.xlabel(\"Account number\")\nplt.ylabel(\"Remaining on 31-6-98\")\nplt.title(\"Effect of Account number on Remaining on 31-6-98\")\n\nplt.subplot(223)\nplt.scatter(bank[\"Account number\"],bank[\"TN transactions\"],color=\"g\")\nplt.xlabel(\"Account number\",fontsize=7)\nplt.ylabel(\"TN transactions\",fontsize=7)\nplt.title(\"Effect of Account number on TN transactions\",fontsize=7)\n\nplt.subplot(224)\nplt.scatter(bank[\"Account number\"],bank[\"Average interval between transaction days\"],color=\"black\")\nplt.xlabel(\"Account number\",fontsize=7)\nplt.ylabel(\"Average interval between transaction days\",fontsize=7)\nplt.title(\"Effect of Account number on Average interval between transaction days\",fontsize=7)\n\nplt.subplots_adjust(3,3,4.7,4.7)\n","883fe1e6":"bank[\"Average interval between transaction days\"].agg({\"min\",\"max\",\"mean\"})\n","f5e55b57":"sb.distplot(bank[\"Average interval between transaction days\"])","e1299696":"plt.figure(figsize=(11,3),dpi=100)\nsb.countplot(\"Account number\",data=bank)\nplt.xticks([0,10,20,50,120],[1,10,20,50,120])\nplt.title(\"counts of Account number values\")","b6bba070":"plt.scatter(bank[\"Account number\"],bank[\"Average account balance\"])","f7d9bdb9":"bank.drop([\"Average interval between transaction days\", 'NOITD',\"Account number\"],axis=1,inplace=True)","b7bd0101":"bank.head()","4abefa57":"bank[\"Remaining on 31-6-98\"].value_counts().head()","0a094305":"bank[\"Remaining on 31-6-98\"].agg({\"std\",\"min\",\"max\",\"mean\"})","b1b75b26":"plt.scatter(bank[\"Remaining on 31-6-98\"],bank[\"Average account balance\"])","af76df69":"sb.distplot(bank[\"Remaining on 31-6-98\"])","324ab593":"bank.plot(\"Remaining on 31-6-98\",\"TN transactions\",kind=\"scatter\")","5d8405c0":"bank.drop(\"Remaining on 31-6-98\",axis=1,inplace=True)","d3733699":"bank.head()","614456e5":"bank.corr()","5e9e8dd9":"plt.figure(dpi=100)\nsb.heatmap(bank.corr(),annot=True,lw=0.1)","1f6e76cd":"bank.isna().sum()","839b2ab6":"bank[bank[\"TN creditor transactions\"].isna()]","90a2abef":"bank.loc[17815]","ae776b5a":"bank.drop([17815],inplace=True)","73d9fa59":"bank.reset_index(drop=True,inplace=True)","f77a8370":"bank.shape","67319023":"bank[bank[\"TN debtor transactions\"]==0]","0c847df5":"bank[bank[\"TN debtor transactions\"]==0][\"average debtor transaction\"].isna().sum()","9c6f8d3a":"bank[\"average debtor transaction\"].isna().sum()","bab72fe5":"bank.dropna(axis=0,inplace=True)","d80152a5":"bank.isna().sum()","ec718d34":"bank.head()","4ed9703a":"bank[\"DBNCD\"]=bank[\"TN creditor transactions\"]-bank[\"TN debtor transactions\"]","3c291543":"bank[\"DFACD\"]=bank[\"average creditor transaction\"]-bank[\"average debtor transaction\"]","6f3ae6d8":"bank.head()\n","a6a732f7":"plt.figure(figsize=(11,11))\nsb.heatmap(bank.corr(),annot=True,lw=0.1,cmap=\"Paired\")","79efd9bd":"#values to int64\nfor i in bank.columns:\n    bank[i]=bank[i].astype(np.int64)","3c707338":"bank_norm=normalize(bank)","865ee619":"bank_norm=pd.DataFrame(bank_norm,columns=bank.columns)","40135dd2":"sb.distplot(bank_norm[\"Average account balance\"])","184b99c0":"sb.distplot(bank_norm['TN debtor transactions'])","a4cd25e1":"bank_sc=sc.fit_transform(bank)","40b8b219":"bank_sc[0]","9d864ce6":"bank_sc=pd.DataFrame(bank_sc,columns=bank.columns)","7a3ad1f9":"sb.distplot(bank_sc[\"Average account balance\"])","3a8b1201":"fig,axes=plt.subplots(4,2)\nfig.dpi=100\nfig.figsize=(11,5)\n\n\nsb.distplot(bank[\"Average account balance\"], kde=False, color=\"b\", ax=axes[0,0])\nsb.distplot(bank['TN debtor transactions'], kde=False, color=\"b\", ax=axes[0,1])\nsb.distplot(bank['TN creditor transactions'], kde=False, color=\"b\", ax=axes[1,0])\nsb.distplot(bank['TN transactions'], kde=False, color=\"b\", ax=axes[1,1])\nsb.distplot(bank['average debtor transaction'], kde=False, color=\"b\", ax=axes[2,0])\nsb.distplot(bank['average creditor transaction'], kde=False, color=\"b\", ax=axes[2,1])\nsb.distplot(bank['DBNCD'], kde=False, color=\"b\", ax=axes[3,0])\nsb.distplot(bank['DFACD'], kde=False, color=\"b\", ax=axes[3,1])\n\nplt.savefig(\"D:\\\\bank.png\")\nplt.subplots_adjust(3,3,4.7,4.7)\n#motasefane alan balad nistam ino ba for benvisam :)","4a3f1a6d":"fig,axes=plt.subplots(4,2)\nfig.dpi=100\nfig.figsize=(11,5)\n\n\nsb.distplot(bank_sc[\"Average account balance\"], kde=False, color=\"r\", ax=axes[0,0])\nsb.distplot(bank_sc['TN debtor transactions'], kde=False, color=\"r\", ax=axes[0,1])\nsb.distplot(bank_sc['TN creditor transactions'], kde=False, color=\"r\", ax=axes[1,0])\nsb.distplot(bank_sc['TN transactions'], kde=False, color=\"r\", ax=axes[1,1])\nsb.distplot(bank_sc['average debtor transaction'], kde=False, color=\"r\", ax=axes[2,0])\nsb.distplot(bank_sc['average creditor transaction'], kde=False, color=\"r\", ax=axes[2,1])\nsb.distplot(bank_sc['DBNCD'], kde=False, color=\"r\", ax=axes[3,0])\nsb.distplot(bank_sc['DFACD'], kde=False, color=\"r\", ax=axes[3,1])\n\nplt.savefig(\"D:\\\\standard_bank.png\")\nplt.subplots_adjust(3,3,4.7,4.7)","aa81edda":"fig,axes=plt.subplots(4,2)\nfig.dpi=100\nfig.figsize=(11,5)\n\n\nsb.distplot(bank_norm[\"Average account balance\"],color=\"g\", ax=axes[0,0])\nsb.distplot(bank_norm['TN debtor transactions'],color=\"g\", ax=axes[0,1])\nsb.distplot(bank_norm['TN creditor transactions'],color=\"g\", ax=axes[1,0])\nsb.distplot(bank_norm['TN transactions'],color=\"g\", ax=axes[1,1])\nsb.distplot(bank_norm['average debtor transaction'],color=\"g\", ax=axes[2,0])\nsb.distplot(bank_norm['average creditor transaction'],color=\"g\", ax=axes[2,1])\nsb.distplot(bank_norm['DBNCD'], color=\"g\", ax=axes[3,0])\nsb.distplot(bank_norm['DFACD'], color=\"g\", ax=axes[3,1])\n\nplt.savefig(\"D:\\\\norm_bank.png\")\n\nplt.subplots_adjust(3,3,4.7,4.7)","935ac8ab":"data_one=bank_norm.drop(['TN debtor transactions','TN creditor transactions'\n                         ,'TN transactions','average debtor transaction'\n                         ,\"DFACD\",\"DBNCD\"\n                        ],axis=1)\ndata_two=bank_norm.drop(['TN debtor transactions','TN creditor transactions'\n                         ,'TN transactions','average debtor transaction'],axis=1)","4a2ac03d":"inertia_list=list()\nfor k in range(1,15):\n    kmn=KMeans(n_clusters=k)\n    kmn.fit(bank_norm)\n    inertia_list.append(kmn.inertia_)\n   ","92bf2bfa":"inertia_list_1=list()\nfor k in range(1,15):\n    kmn=KMeans(n_clusters=k)\n    kmn.fit(data_one)\n    inertia_list_1.append(kmn.inertia_)","10572950":"inertia_list_2=list()\nfor k in range(1,15):\n    kmn=KMeans(n_clusters=k)\n    kmn.fit(data_two)\n    inertia_list_2.append(kmn.inertia_)","58bfb85c":"plt.figure(figsize=(11,4),dpi=100)\nplt.subplot(221)\nplt.plot(range(1,15),inertia_list,\"*-\",color=\"r\",)\nplt.title(\"model train with bank_norm\")\nplt.xlabel(\"value of K(number of cluster)\")\nplt.ylabel(\"interia for each K\")\nplt.grid()\n\nplt.subplot(222)\nplt.plot(range(1,15),inertia_list_1,\"*-\")\nplt.title(\"model train with data_one\")\nplt.xlabel(\"value of K(number of cluster)\")\nplt.ylabel(\"interia for each K\")\nplt.grid()\n\nplt.subplot(223)\nplt.plot(range(1,15),inertia_list_2,\"o-\",color='g')\nplt.title(\"model train with data_Two\")\nplt.xlabel(\"value of K(number of cluster)\")\nplt.ylabel(\"interia for each K\")\nplt.grid()\n\n\n\nplt.subplots_adjust(3.5,2.5,4.5,4.5)","27c2f006":"score_list=list()    \nfor k in range(2,15):\n    kmn=KMeans(n_clusters=k)\n    labels=kmn.fit_predict(bank_norm)\n    score=silhouette_score(bank_norm,labels,metric='euclidean',sample_size=5000)\n    score_list.append(score)","4efc31e6":"score_list_1=list()    \nfor k in range(2,15):\n    kmn=KMeans(n_clusters=k)\n    labels=kmn.fit_predict(data_one)\n    score=silhouette_score(data_one,labels,metric='euclidean',sample_size=5000)\n    score_list_1.append(score)","604f9bd3":"score_list_2=list()    \nfor k in range(2,15):\n    kmn=KMeans(n_clusters=k)\n    labels=kmn.fit_predict(data_two)\n    score=silhouette_score(data_two,labels,metric='euclidean',sample_size=5000)\n    score_list_2.append(score)","ced8ed91":"#score=silhouette_score(data_one,kmn.labels_,metric='euclidean',sample_size=5000)\nplt.figure(figsize=(11,4),dpi=100)\nplt.subplot(221)\nplt.plot(range(2,15),score_list,\"o-\",color=\"r\")\nplt.xlabel(\"number of cluster fro data=bank_norm\")\nplt.ylabel(\"silhouette_score\")\nplt.grid()\nplt.subplot(222)\nplt.plot(range(2,15),score_list_1,\"o-\",color=\"b\")\nplt.xlabel(\"number of cluster fro data=data_one\")\nplt.ylabel(\"silhouette_score\")\nplt.grid()\nplt.subplot(223)\nplt.plot(range(2,15),score_list_2,\"o-\",color=\"g\")\nplt.xlabel(\"number of cluster fro data=data)two\")\nplt.ylabel(\"silhouette_score\")\nplt.grid()\n\n\nplt.subplots_adjust(3.5,2.5,4.5,4.5)","36f2d09a":"kmn=KMeans(n_clusters=3,random_state=42)\nlabel=kmn.fit_predict(bank_norm)\ncenters = kmn.cluster_centers_","e66feee7":"plt.scatter(bank_norm['Average account balance'],bank_norm[\"average creditor transaction\"],c=label)\n","ab3d79da":"label","74855bf7":"bank_norm[\"Label\"]=label","b2b07ce1":"bank_norm[\"Label\"].value_counts()","28da2f29":"bank_norm[\"Label\"].value_counts(normalize)*100","822f1ea3":"bank_norm[\"Label\"].unique()","0dd34ab5":"sb.set_style(\"darkgrid\")\nsb.countplot(\"Label\",data=bank_norm)","e4e6b113":"bank_norm.head(5)","0ffa21b0":"plt.figure(figsize=(11,9),dpi=100)\nsb.heatmap(bank_norm.corr(),annot=True,lw=0.2,cmap=\"YlGnBu\")","4e23907a":"sb.scatterplot(\"Label\",'Average account balance',hue=\"Label\",data=bank_norm)","add3e5b1":"plt.figure(figsize=(10,7),dpi=100)\n\nplt.subplot(311)\nsb.scatterplot('Average account balance',\"average creditor transaction\",hue=\"Label\",data=bank_norm)\n\nplt.scatter(centers[:, 0], centers[:, 1], c='black', s=200, alpha=0.5);\n\nplt.subplot(312)\nsb.scatterplot('Average account balance','DFACD',hue=\"Label\",data=bank_norm)\n\nplt.subplot(313)\nsb.scatterplot('average creditor transaction','DFACD',hue=\"Label\",data=bank_norm)\n\nplt.subplots_adjust(3.4,3.4,5,5)","37067402":"plt.figure(figsize=(10,7),dpi=100)\n\nplt.subplot(311)\nsb.scatterplot('Average account balance','DBNCD',hue=\"Label\",data=bank_norm)\n\nplt.subplot(312)\nsb.scatterplot('Average account balance','TN transactions',hue=\"Label\",data=bank_norm)\n\nplt.subplot(313)\nsb.scatterplot('DFACD','DBNCD',hue='Label',data=bank_norm)\n\n\nplt.subplots_adjust(3.4,3.4,5,5)","12c2d738":"bank_norm[bank_norm[\"Label\"]==0].head()","9dbd330c":"bank_norm.groupby(\"Label\").agg({\"mean\"})","9d88da71":"bank_norm.groupby(\"Label\").agg({\"min\"})","7ff5370d":"bank_norm.groupby(\"Label\").agg({\"max\"})","dce9bb45":"bank_norm.groupby(\"Label\").agg({\"std\"})","519eea9a":"bank_norm.groupby(\"Label\")[\"Average account balance\",\"DFACD\",\"average creditor transaction\"].max()","c545196e":"bank_norm.groupby(\"Label\")[\"Average account balance\",\"DFACD\",\"average creditor transaction\"].min()","e0aac991":"bank_norm.groupby(\"Label\")[\"Average account balance\",\"DFACD\",\"average creditor transaction\"].mean()","1cb6961f":"db=DBSCAN(eps=0.7,min_samples=9)","a90b7442":"db.fit(bank_norm)","84190149":"db_labels=db.labels_","1df67e74":"plt.figure(figsize=(11,9),dpi=100)\nsb.scatterplot('Average account balance','average creditor transaction',hue=db_labels,data=bank_norm)\nplt.savefig(\"D:\\\\a.png\")","d856351d":"pd.Series(db_labels).unique()   # -1 noise values","d563ba15":"pd.Series(db_labels).value_counts() #11 noise in data","70b571e0":"bank_norm_db=bank_norm.drop(\"Label\",axis=1)\nbank_norm_db[\"Label_db\"]=db_labels\n","e3974bda":"bank_norm_db[bank_norm_db[\"Label_db\"]==-1].index","9a8b22f5":"##drop nois row\nbank_norm_db.drop([1672, 7232, 9081, 10048, 13608, 13633, 13634, 13635, 13636, 13637,13638],axis=0, inplace=True)","93dd041b":"bank_norm_db[bank_norm_db[\"Label_db\"]==-1].index","830ec2c2":"sb.scatterplot('Average account balance','average creditor transaction',hue=\"Label_db\",data=bank_norm_db)","4d36a5e7":"plt.figure(figsize=(11,7),dpi=100)\nsb.heatmap(bank_norm_db.corr(),annot=True,lw=0.2)","7f714bf1":"bank_norm_db.groupby(\"Label_db\").agg({'mean'})","a7c5683d":"bank_norm_db.groupby(\"Label_db\").agg({'min'})","0b83bd0c":"bank_norm_db.groupby(\"Label_db\").agg({\"max\"})","fd550c0a":"sb.pairplot(bank_norm_db,hue=\"Label_db\")","c521a488":"mn=MeanShift(bandwidth=0.5,bin_seeding=True)","388a1ad3":"mn.fit(bank_norm.drop(\"Label\",axis=1))","0316d94c":"labels_mn=mn.labels_","cf696d2e":"pd.Series(labels_mn).unique()","02cbedad":"sb.countplot(labels_mn) #6 cluster dad ke mibinim bdarad nemikhore  ","245e213f":"sb.scatterplot(bank_norm[\"Average account balance\"],bank_norm[\"DFACD\"],hue=labels_mn)","84687f83":"mn=MeanShift(bandwidth=0.6,cluster_all=False,bin_seeding=True)\n#cluster_all==detection nois data\nmn.fit(bank_norm.drop(\"Label\",axis=1))\nlabels_mn=mn.labels_","71122c78":"sb.countplot(labels_mn)\n#detect 14% data is noise","bf8cdae0":"sb.scatterplot(bank_norm[\"Average account balance\"],bank_norm[\"DFACD\"],hue=labels_mn)","01af8e0a":"agc=AgglomerativeClustering(n_clusters=3,linkage=\"complete\")","538557a0":"data_agc=bank_norm.drop(\"Label\",axis=1).sample(frac=0.3,random_state=33)\n# Because this algorithm does not work on big data, we only give 30% of the data to it","16025ede":"agc.fit(data_agc)\n","a53f8de0":"sb.countplot(agc.labels_)","7be466f4":"lable_agc=agc.labels_\ndata_agc[\"label_agc\"]=lable_agc","4a9e30dd":"sb.scatterplot('Average account balance',\"DFACD\",hue=\"label_agc\",data=data_agc)","06a3c941":"#bank_norm_db.to_csv(r\"..\/input\/bank-customers-churn\/bank_DBSCAN_label.csv\")","dda420a3":"##### change columns name to EN","922533f2":"## Read Data","3034caf7":"###### creat columns == difference between the number of debtors and creditors  AND  difference between the average of debtors and creditors","4607c43b":"##### change type all columns to int64","324cbd8d":"## Analyze and visualize data ","d7fb4661":"###### Data normalizationdat ","8200e4ba":"#####  We use this bank_norm for clustering  ","ea7479e5":"#  Equivalent to Kmeans clusters\n###  0:Bad account\n###  1:Normal account\n###  2:good  account","5a20e62e":"## import libraries","ba2b24c0":"## clustring bank customers\nIn this project, we try to cluster bank customers based on the data we have. The names of the columns are Persian and we must replace them with their English equivalents.\nYou can see the whole project in My [Github](https:\/\/github.com\/9ashking\/bank)","a54a793d":"###  save data set to csv file for clasification","125b5d7e":"##### drop useless columns","ed71692d":"I hope this article was useful for you","95f48203":"#  Equivalent to  DBSCAN clusters\n\n###  0: good account\n\n###  1: Normal account\n\n###  2: bad  account","6a5b1eea":"#### denoising with DBSCAN","5088b2dd":"### scatter plot for features that are most correlated to the label","ff0dd04d":"###### dorp na in axis=0 in rows","e79d4028":"##### clustring bank_norm"}}