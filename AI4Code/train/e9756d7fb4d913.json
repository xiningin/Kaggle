{"cell_type":{"3484c72c":"code","8547ad1e":"code","fbe9a697":"code","f87541b9":"code","aab53733":"code","c472461e":"code","b034a394":"code","36eaeb15":"code","b83ac8b3":"code","10b4081f":"code","afca71e4":"code","563c3fe5":"code","e8ee1d76":"code","c742e9b0":"code","9aada1e7":"code","1d75e114":"code","22bbbc39":"code","7c6f819b":"code","4119de9c":"code","aecdaaa3":"code","22c28d62":"code","0f6980a7":"code","55dd1077":"code","fb65981a":"code","809d6285":"code","1b74f5e9":"code","40d1ef36":"code","a112f780":"code","73122496":"code","0663e46c":"code","ac6a49c2":"code","22c5f237":"code","0b3bdd02":"code","09f972d1":"code","8b79238c":"code","ac2f1402":"code","c9ca3195":"code","7157d9c9":"code","0bddca9e":"code","fb013577":"code","a8d14188":"code","03e1cb46":"code","ed7987bb":"code","79f4a935":"code","e2915bf8":"code","cd7c4bf9":"code","ba1872fe":"code","dbefd234":"code","39faf982":"code","cfe290b2":"code","5594171b":"code","90d24403":"code","5c1410b9":"code","e452fcf8":"code","590020c2":"code","9a89d05b":"code","368c1b34":"code","fb6e896d":"code","30b5729c":"code","65961ef1":"code","4d9b3dc0":"code","fa7ce455":"code","9ba9ae76":"code","06c00109":"code","fe468579":"code","a32edf08":"code","08ce4310":"code","384debbd":"code","8a4ea32e":"markdown","d933c4f6":"markdown","fb984b18":"markdown","6f711e65":"markdown","96843a83":"markdown","101d55c6":"markdown","cc379426":"markdown","d7a6d440":"markdown","96faed7f":"markdown","188e8a02":"markdown","77f4b3ea":"markdown","9f2cdf9e":"markdown","eb9bf94d":"markdown"},"source":{"3484c72c":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom datetime import datetime\nimport locale\nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.feature_extraction import DictVectorizer\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import RandomizedSearchCV","8547ad1e":"state_covid_df = pd.read_csv('..\/input\/may-4-us-state\/us-states_May4.csv')\nstate_population = pd.read_csv('..\/input\/covid19-data\/us_population_by_states.csv')\nPopulation_density_df = pd.read_csv('..\/input\/covid19-data\/population_density_by_state.csv')\nurban_percentage_df = pd.read_csv('..\/input\/covid19-data\/PctUrbanRural_State.csv')\nAirport_carry_df = pd.read_csv('..\/input\/covid19-data\/Airport_Carry_per_state.csv')\nCommute_to_work = pd.read_csv('..\/input\/covid19-data\/Commute_to_work_states_2013.csv')","fbe9a697":"state_covid_df.sort_values(['date', 'cases'], ascending=True).head(10)","f87541b9":"state_population.head()","aab53733":"Population_density_df.head()","c472461e":"urban_percentage_df.head()","b034a394":"Airport_carry_df.head()","36eaeb15":"Airport_carry_df.columns = ['State','Large certificated air carriers','Commuter and small certificated air carriers',\n                'Foreign air carriers','Total enplanements','1','2']","b83ac8b3":"Airport_carry_df","10b4081f":"Airport_carry_df.columns","afca71e4":"Airport_carry_df = Airport_carry_df[['State','Large certificated air carriers','Commuter and small certificated air carriers',\n                'Foreign air carriers','Total enplanements']]","563c3fe5":"Airport_carry_df.head()","e8ee1d76":"Commute_to_work.head()","c742e9b0":"Commute_to_work.columns = ['State','Numbers of Workers','drive alone','carpooled','Public transportation','Walked',\n                           'Taxicab, motorcycle, bicycle','Worked at home','na']","9aada1e7":"Commute_to_work.columns","1d75e114":"Commute_to_work = Commute_to_work[['State','Numbers of Workers','drive alone','carpooled','Public transportation','Walked',\n                           'Taxicab, motorcycle, bicycle','Worked at home']]","22bbbc39":"Commute_to_work.head()","7c6f819b":"def get_time_series(state):\n    if state_covid_df[state_covid_df['state'] == state]['state'].nunique() > 1:\n        state_table = state_covid_df[state_covid_df['state'] == state]\n        state_df = pd.DataFrame(pd.pivot_table(state_table, values = ['cases','deaths'],\n                              index='date', aggfunc=sum).to_records())\n        return state_df.set_index('date')[['cases','deaths']]\n    df = state_covid_df[(state_covid_df['state'] == state) \n                & (state_covid_df['state'].isin(['', state]))]\n    return df.set_index('date')[['cases','deaths']]","4119de9c":"state_covid_df[state_covid_df['state'] == 'New York']['state'].nunique()","aecdaaa3":"state = 'New York'\nNew_York = get_time_series(state)","22c28d62":"New_York.tail()","0f6980a7":"plt.plot(New_York['cases'])","55dd1077":"state_covid_df.tail()","fb65981a":"state_covid_df.info()","809d6285":"date_int = list()\ndate_num = [1]\nfor i in state_covid_df['date']:\n    date_i = datetime.strptime(i,'%Y-%m-%d').date()\n    date_int.append(int(date_i.strftime('%Y%m%d')))\n\nj = 1\nfor i in range(1,len(date_int)):\n    \n    if date_int[i] == date_int[i-1]:\n        date_num.append(j)\n    else:\n        j += 1\n        date_num.append(j)","1b74f5e9":"state_covid_df['date_num'] = date_num\nstate_covid_df = state_covid_df.drop(columns=['date'])","40d1ef36":"state_covid_df.tail()","a112f780":"state_covid_df.head(1)","73122496":"state_population.head(1)","0663e46c":"Population_density_df.head()","ac6a49c2":"urban_percentage_df.head()","22c5f237":"Airport_carry_df.head(1)","0b3bdd02":"airport_state = Airport_carry_df['State'].unique()\ncovid_state = state_covid_df['state'].unique()","09f972d1":"for i in covid_state:\n    if i not in airport_state:\n        print(i)","8b79238c":"Airport_carry_df.head(10)","ac2f1402":"Airport_carry_df","c9ca3195":"Airport_carry_df = Airport_carry_df.drop(columns=['Total enplanements'])","7157d9c9":"Airport_carry_df.head()","0bddca9e":"Commute_to_work.head()","fb013577":"## \u6211\u89c9\u5f97\u8981\u89e3\u91ca\u4e00\u4e0b\u554a\u4e3a\u5565drop\u4e86","a8d14188":"drop_list = ['District of Columbia','Puerto Rico','Virgin Islands','Guam'\n             ,'Northern Mariana Islands','American Samoa']\nfor i in range(len(state_covid_df)):\n    if state_covid_df['state'][i] in drop_list:\n        state_covid_df = state_covid_df.drop([i])","03e1cb46":"state_covid_df['state'].unique()","ed7987bb":"full_df = pd.merge(state_covid_df,Airport_carry_df,left_on='state',right_on='State')","79f4a935":"full_df = full_df.drop(columns=['State'])","e2915bf8":"full_df = pd.merge(full_df,state_population,left_on='state',right_on='NAME')","cd7c4bf9":"full_df = full_df.drop(columns=['NAME'])","ba1872fe":"for i in range(len(Population_density_df)):\n    Population_density_df['States'][i] = Population_density_df['States'][i][1:]\n\nPopulation_density_df['States'].head()","dbefd234":"full_df = pd.merge(full_df,Population_density_df,left_on='state',right_on='States')","39faf982":"full_df = pd.merge(full_df,urban_percentage_df,left_on='state',right_on='STATENAME')","cfe290b2":"full_df = pd.merge(full_df,Commute_to_work,left_on='state',right_on='State')","5594171b":"### Add in party data\ndf_party = pd.read_csv('..\/input\/politicalrace-age\/Governor_political_party.csv')\nfull_df = pd.merge(full_df, df_party, left_on = 'state', right_on='United States')","90d24403":"### Add age 65 data\ndf_age = pd.read_csv('..\/input\/politicalrace-age\/population_age_65_state.csv').iloc[:, [0,1]]\nfull_df = pd.merge(full_df, df_age, left_on = 'state', right_on='State')","5c1410b9":"### Add race data\ndf_race = pd.read_csv('..\/input\/politicalrace-age\/race_percentage_state.csv')\nfull_df = pd.merge(full_df, df_race, left_on = 'state', right_on='State')\n","e452fcf8":"full_df.head()","590020c2":"full_df.info()","9a89d05b":"full_df.to_csv('..\/working\/full_data.csv')\n","368c1b34":"full_df_2 = pd.read_csv('..\/working\/full_data.csv')","fb6e896d":"full_df_2 = full_df_2.drop(columns=['Unnamed: 0','States','United States','STATENAME','State','State_x', 'State_y'])","30b5729c":"pd.options.display.max_columns = 999\n","65961ef1":"full_df_2.info()","4d9b3dc0":"clean_data = pd.get_dummies(full_df_2, columns=[\"state\", 'Governor Political Affiliation'])","fa7ce455":"clean_data.head(5)","9ba9ae76":"clean_data_case = clean_data.drop(columns=['fips'])","06c00109":"clean_data_case.head()","fe468579":"clean_data_case.head()","a32edf08":"clean_data_case.to_csv('final_dataframe.csv')","08ce4310":"clean_data_case = pd.read_csv('final_dataframe.csv', sep=',', thousands=',')","384debbd":"clean_data_case","8a4ea32e":"# Loading Data","d933c4f6":"#### drop some of COVID19 states","fb984b18":"## Create a checking specific state dateset method","6f711e65":"Transform state categorical into dummy:","96843a83":"## transform date into continues list (1,2,3,4\u2026)","101d55c6":"## Combine Data","cc379426":"### Combine data","d7a6d440":"# Data Preprocessing","96faed7f":"We saw that those 6 region in covid19 data but not in airport dataset. DC's name in covid19 miss spelled, all other\n5 region can be delated (we conly focus on mainland US)","188e8a02":"District of Columbia\n\nPuerto Rico\n\nVirgin Islands\n\nGuam\n\nNorthern Mariana Islands\n\nAmerican Samoa","77f4b3ea":"### Cleaning some of additional dataset\n\nAirport_carry_df need to extract and clean","9f2cdf9e":"## cleaning final dataset","eb9bf94d":"### dataset that no need to clean"}}