{"cell_type":{"0d31051b":"code","a0499c9d":"code","d2fc1142":"code","9357abe7":"code","6ab11e5f":"code","49a06e4c":"code","fc65bd88":"code","43808140":"code","65823437":"code","71943691":"code","d97e6056":"code","9fc235c8":"code","490f8b64":"code","5da34e67":"code","145e775b":"code","0263ecec":"markdown","c52d8eb8":"markdown","9bf60bdc":"markdown","50c62686":"markdown","5944041a":"markdown","341b161b":"markdown","9e4c1424":"markdown","6ca0dacf":"markdown","631a7deb":"markdown","6db5452f":"markdown","2ee944a5":"markdown","d7eefaa1":"markdown","845c5c4f":"markdown","7a013cd4":"markdown","f003063e":"markdown","60ec2435":"markdown","0c1381a6":"markdown","f9335ee7":"markdown"},"source":{"0d31051b":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt","a0499c9d":"file_folder = '..\/input\/beer-consumption-in-20182019\/'\ndata = pd.read_csv(f'{file_folder}\/drink_dataset_money.csv')\nprint(data.shape)","d2fc1142":"data.head()","9357abe7":"counts = data['drank'].sum()\nprint(\"I drank {} times over the last year, or every {:.2f} days.\".format(counts, data.shape[0] \/ counts))","6ab11e5f":"s = data['drank'].astype('bool')\nprint(\"Longest abstinence time: {} days\".format(s.cumsum().value_counts().max() - 1))\nprint(\"Longest drinking streak: {} days\".format((~s).cumsum().value_counts().max() - 1))","49a06e4c":"data['date'] = pd.to_datetime(data['date'])\ndata['day'] = data['date'].apply(lambda x: x.day)\ndata['month'] = data['date'].apply(lambda x: x.month)\ndata['year'] = data['date'].apply(lambda x: x.year)\ndata['weekday'] = data['date'].apply(lambda x: x.dayofweek)","fc65bd88":"day_names = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']\n\nvalues = data.groupby('weekday')['drank'].agg('sum')\nvalues.index = [day_names[x] for x in values.index]\nvalues.plot(kind='bar', figsize=(15,7), grid=True)\nplt.title(\"What day of the week do I prefer?\")\nplt.xlabel(\"Day of the week\")\nplt.ylabel(\"Frequency\")\nplt.show()","43808140":"values = data.groupby('hour')['drank'].agg('sum')\n\nfor i in range(24):\n    if i not in values:\n        values[i] = 0\n        \nvalues.sort_index().plot(kind='bar', figsize=(15,10), grid=True)\nplt.title(\"When do I usually start drinking?\")\nplt.xlabel(\"Hour\")\nplt.ylabel(\"Frequency\")\nplt.show()","65823437":"month_names = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']\n\nvalues = data.groupby('month')['drank'].agg('sum')\nvalues.index = [month_names[x - 1] for x in values.index]\nvalues.plot(kind='bar', figsize=(10,5), grid=True)\nplt.title(\"Which month did I drink the most beer?\")\nplt.xlabel(\"Month\")\nplt.ylabel(\"Frequency\")\nplt.show()","71943691":"data[data['drank'] == 1]['day'].value_counts().sort_index().plot(kind='bar', figsize=(15,7), grid=True)\nplt.title(\"What day of the month is the most popular?\")\nplt.xlabel(\"Day of the month\")\nplt.ylabel(\"Frequency\")\nplt.show()","d97e6056":"money_spent = data['money_spent'].sum()\nprint(\"I spent {:.0f}$ on alcohol over the last year, or {:.2f}$ a day.\".format(money_spent, data.shape[0] \/ money_spent))","9fc235c8":"values = data.groupby('month')['money_spent'].agg('sum')\nvalues.index = [month_names[x - 1] for x in values.index]\nvalues.plot(kind='bar', figsize=(15,7), grid=True)\nplt.title(\"How much money did I spend each month?\")\nplt.xlabel(\"Month\")\nplt.ylabel(\"$\")\nplt.show()","490f8b64":"values = data.groupby('weekday')['money_spent'].agg('sum')\nvalues.index = [day_names[x] for x in values.index]\nvalues.plot(kind='bar', figsize=(15,7), grid=True)\nplt.title(\"How much money did I spend each weekday?\")\nplt.xlabel(\"Day of the week\")\nplt.ylabel(\"$\")\nplt.show()","5da34e67":"values = data[data['drank'] == 1]['money_spent']\nvalues.value_counts().sort_index().plot(kind='bar', figsize=(15,7), grid=True)\nplt.title(\"How much money do I usually spend every time?\")\nplt.xlabel(\"Amount spent $\")\nplt.ylabel(\"Frequency\")\nplt.show()","145e775b":"print(\"On average I spend {:.2f}$ every time I drink.\".format(values.mean()))","0263ecec":"![Image](https:\/\/i.ibb.co\/VHsQtxk\/quitzilla1-1.jpg)","c52d8eb8":"Let's start exploring the dataset!","9bf60bdc":"Friday and Saturday are kinda obvious, but I never thought that Monday would be the third popular day! I discover more and more interesting things about myself...\n\nLet's see what we can find about the hour. I decided not to use minute, cause it's probably too random.","50c62686":"So, we have 365 entries in our dataframe with date, hour, minute and money spent. \"drank == 1\" obviously means that I drank that day, otherwise the columns are filled with zeros.","5944041a":"Honestly, I expected it to be worse than that. And how long can you last without a cup of beer?\n\nLet's now look at some datetime patterns.","341b161b":"Summer is, without a shadow of a doubt, the best time of year to live active and healthy live.","9e4c1424":"No days missing, huh. There is also something magical with the middle of the month.\n\nLet's now look at the money spending!","6ca0dacf":"Welcome. Exactly one year ago (23 Aug, 2018) being a true data scientist I decided to start tracking my alcohol consumption, so today we are going to explore the data collected over the last year and see if we can find any interesting insights.","631a7deb":"First I am going to explore weekday dependencies.","6db5452f":"## EDA","2ee944a5":"September was either tough or very fun.","d7eefaa1":"* I drank alcohol 77 times over the last year. Longest abstinence time - 2 weeks, longest drinking streak - 4 days.\n* Friday, Saturday, and, surprisingly, Monday are the most popular days.\n* I mostly drink in the evening or at night, and never earlier than 2 PM.\n* I spent 254\\$, on alcohol over the last year, and 3.30\\$ on average every time I drink.\n* Maximum amount spent - 25\\$, and 14 times I spent no money at all.\n* Maybe I should quit.","845c5c4f":"## Conclusions","7a013cd4":"Wow, I wonder if it is above or below the average.\n\nNow lets calculate the **longest drinking and abstinence streaks**. What we want is to find the longest sequence of 0's or 1's in the 'drank' column, so it's possible to achieve in one line using cumsums.","f003063e":"It seems like over the last year I never drank in the morning.\nThe earliest time to start would be 2PM.\n\nBut what about month?","60ec2435":"Omg... **254$ is a lot**. Think about all the GPU hours you could acquire on GCP or AWS to fuel your neural nets. I chose the wrong fuel for myself, but you better avoid making my mistakes.","0c1381a6":"## Loading libraries and data","f9335ee7":"Yeah, there is certainly something wrong with Monday. Or with me."}}