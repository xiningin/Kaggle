{"cell_type":{"e4237219":"code","72c4cd4c":"code","a515b0f4":"code","ffa3fdf6":"code","9ee888bd":"code","d3099b90":"code","d55edbac":"code","466aa0b7":"code","7ffa7ef1":"code","8f140eb9":"code","ad8c89bd":"code","dbb3de68":"code","e056f2cb":"code","146a185d":"code","b493b667":"code","73c8ae49":"code","126e6305":"code","6b713521":"markdown","134dd9d1":"markdown","20dd78fa":"markdown","68917b25":"markdown","8fd471d2":"markdown","f94cd67e":"markdown","fcc389dc":"markdown","abf199f6":"markdown","33ff0ed4":"markdown","35382dd2":"markdown","966d3d39":"markdown","80deb02b":"markdown","2fb73fae":"markdown"},"source":{"e4237219":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt","72c4cd4c":"dataset = pd.read_csv('..\/input\/Sample_Stocks.csv')","a515b0f4":"dataset.head()","ffa3fdf6":"dataset.count()","9ee888bd":"dataset.max()","d3099b90":"dataset.min()","d55edbac":"dataset.shape","466aa0b7":"for i in dataset.columns:\n    print(i,\"---\",dataset[i].dtype)","7ffa7ef1":"dataset.isna().sum()","8f140eb9":"X = dataset.iloc[:, [1,0]].values","ad8c89bd":"X","dbb3de68":"from sklearn.cluster import KMeans","e056f2cb":"#elbow method to find optimal number of clusters\nwcss = []\nfor i in range(1, 8):\n    clust = KMeans(n_clusters = i, init='k-means++',n_init=10, max_iter=300,tol=0.0001,random_state=42)\n    clust.fit(X)\n    wcss.append(clust.inertia_)","146a185d":"plt.plot(range(1, 8), wcss)\nplt.plot(range(1, 8), wcss,'bo')\nplt.title('The Elbow Method')\nplt.xlabel('Number of clusters')\nplt.ylabel('WCSS SCORES')\nplt.show()","b493b667":"# Fitting K-Means to the dataset\nclust2 = KMeans(n_clusters = 3, init = 'k-means++', random_state = 42)\ny_clust2 = clust2.fit_predict(X)","73c8ae49":"# Visualising the clusters\nplt.scatter(X[y_clust2 == 0, 0], X[y_clust2 == 0, 1], s = 10, c = 'red', label = 'Cluster 1')\nplt.scatter(X[y_clust2 == 1, 0], X[y_clust2 == 1, 1], s = 10, c = 'green', label = 'Cluster 2')\nplt.scatter(X[y_clust2 == 2, 0], X[y_clust2 == 2, 1], s = 10, c = 'magenta', label = 'Cluster 3')\nplt.xlim([-2,6])\nplt.ylim([-30,60])\nplt.title('Sample Stocks clusters')\nplt.xlabel(\"Dividend's Yield\")\nplt.ylabel('Returns')\nplt.legend()\nplt.show()","126e6305":"# Visualising the clusters based on study\nplt.scatter(X[y_clust2 == 0, 0], X[y_clust2 == 0, 1], s = 10, c = 'red', label = 'worst stocks')\nplt.scatter(X[y_clust2 == 1, 0], X[y_clust2 == 1, 1], s = 10, c = 'green', label = 'best stocks')\nplt.scatter(X[y_clust2 == 2, 0], X[y_clust2 == 2, 1], s = 10, c = 'magenta', label = 'good stocks')\nplt.xlim([-2,6])\nplt.ylim([-30,60])\nplt.title('Sample Stocks clusters')\nplt.xlabel(\"Dividend's Yield\")\nplt.ylabel('Returns')\nplt.legend()\nplt.show()","6b713521":"### ELBOW GRAPH ","134dd9d1":"### DATASET ASSIGNED TO VARIABLE X","20dd78fa":" ## Appropriate number of clusters have been identified (k=3)\n    When we graph the plot, we see that the graph form an elbow after 3 clusters,\n    implying that addition of more clusters do not explain much more of the variance in \n    our relevant variable","68917b25":"### VISUALISING THE K-MEANS CLUSTERING MODEL","8fd471d2":"### IMPORTING THE LIBRARIES","f94cd67e":"### FINAL STUDY ON CLUSTERS","fcc389dc":"# CLUSTER ANALYSIS OF STOCKS USING K-MEANS ALGORITHM\n\nDATASET SOURCE: \"https:\/\/resources.oreilly.com\/examples\/0636920128861\/raw\/master\/Datasets\/sample_stocks.csv\"","abf199f6":"  ### Definition of 'Dividend Yield':\n        Dividend yield is the financial ratio that measures the quantum of cash dividends paid out to shareholders relative to the market value per share. It is computed by dividing the dividend per share by the market price per share and multiplying the result by 100. A company with a high dividend yield pays a substantial share of its profits in the form of dividends. Dividend yield of a company is always compared with the average of the industry to which the company \n        Suppose a company with a stock price of Rs 100 declares a dividend of Rs 10 per share. In that case, the dividend yield of the stock will be 10\/100*100 = 10%. \n        \n        ***High dividend yield stocks are good investment options during volatile times, as these companies offer good payoff options.\n        \n  ### Definition of 'Return':\n      A return, also known as a financial return, in its simplest terms, is the money made or lost on an investment. A return can be expressed nominally as the change in dollar value of an investment over time. A return can be expressed as a percentage derived from the ratio of profit to investment. \n      \n      Positive Return:\n         A positive return is the profit, or money made, on an investment or venture.\n         \n      Negative Return:\n         A negative return is the loss, or money lost, on an investment or venture.\n","33ff0ed4":"### DATASET PRE-ANALYSIS","35382dd2":"### IMPORTING THE DATASET","966d3d39":"### MODEL CREATION AND TRAINING","80deb02b":"### USING ELBOW METHOD TO FIND THE OPTIMAL K NUMBER OF CLUSTERS","2fb73fae":"### IMPORTING kmeans LIBRARY"}}