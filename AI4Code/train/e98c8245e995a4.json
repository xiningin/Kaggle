{"cell_type":{"d818921d":"code","c6526c52":"code","7021ee08":"code","52d2fa11":"code","41b152d4":"code","ba8349bf":"code","d690cff4":"code","ae28b591":"code","9b5dccf8":"code","28ff7db2":"markdown","4e3c58de":"markdown","ed103875":"markdown","5fcef9f8":"markdown","d7690814":"markdown","e70b5f76":"markdown"},"source":{"d818921d":"from scipy.io import loadmat\nimport numpy as np\nimport pickle","c6526c52":"fs = 128 \nn_subjects = 5\nmkpt1 = int(fs*10*60)\nmkpt2 = int(fs*20*60)","7021ee08":"subject_map = {}\nfor s in range(1, n_subjects+1):\n    a =  int(7*(s-1)) + 3\n    if s!=5:\n        b = a + 5\n    else:\n        b = a + 4\n    subject_map[s] = [i for i in range(a, b)]\nprint(subject_map)","52d2fa11":"channels = ['AF3', 'F7', 'F3', 'FC5', 'T7', 'P7', 'O1', 'O2', 'P8', 'T8', 'FC6', 'F4', 'F8', 'AF4']\nuseful_channels = ['F7','F3','P7','O1','O2','P8','AF4']\nuse_channel_inds = []\nfor c in useful_channels:\n    if c in channels:\n        use_channel_inds.append(channels.index(c))","41b152d4":"inp_dir = '..\/input\/eeg-data-for-mental-attention-state-detection\/EEG Data\/' ","ba8349bf":"for s in range(1, n_subjects+1):\n    data = {}\n    data['channels'] = useful_channels\n    data['fs'] = fs\n    for i, t in enumerate(subject_map[s]):\n        trial = {}\n        trial_data = loadmat(inp_dir + f'eeg_record{t}.mat')\n        eeg = trial_data['o']['data'][0][0][:, 3:17]\n        eeg = eeg[:, use_channel_inds]\n        trial['focussed'] = eeg[:mkpt1]\n        trial['unfocussed'] = eeg[mkpt1:mkpt2]\n        trial['drowsed'] = eeg[mkpt2:]\n        data[f'trial_{i+1}'] = trial\n    with open(f'subject_{s}.pkl', 'wb') as f: \n        pickle.dump(data, f, pickle.HIGHEST_PROTOCOL)","d690cff4":"with open('subject_1.pkl', 'rb') as f: \n    data = pickle.load(f)","ae28b591":"data","9b5dccf8":"print(data['trial_1']['focussed'])","28ff7db2":"### For working with any Machine learning models in python, it will be easier to work with numpy arrays. We can save each subject's numpy arrays inside a structured pickle object.","4e3c58de":"Below cell is not really important. I didn't want to manually write the relevant file names for each subject. So, I did the following. It based on what the data contributor has mentioned in an comment. There are 5 subjects, and they have recorded data on 7 separate days (except for subject-5 who has only done that for 6 days). I have segregated each day's data as a trial. Out of these 7, first 2 were used for getting the subject to familiarise with the process. That is why I have only considered the last 5 trials of each subject as training data.","ed103875":"### Saving the pickle object for each subject","5fcef9f8":"### Loading the pickle objects","d7690814":"The sampling frequency is 128 Hz. So, suppose on a particular day, if say the subject has recorded EEG data for 40 minutes. Then total number of rows in the array will 128x60x40. As mentioned by @inancigdem, for each subject, and during every day, first 10 minutes of data corresponds to 'focussed', next 10 minutes to 'unfocussed', and the remaining to 'drowsed' state. So, I have sliced each individual array going by that information (i.e. slicing till row number 128x10x60 for 'focussed', from 128x10x60 to 128x20x60 for 'unfocussed', and from 128x20x60 till last row for 'drowsed).","e70b5f76":"Suppose I just want the data related to 'focussed' state from trial_1 of subject_1"}}