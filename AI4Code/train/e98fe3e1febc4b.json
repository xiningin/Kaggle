{"cell_type":{"071fe5f8":"code","73c3eafa":"code","72c64849":"code","e0a8a00b":"code","5f13ce7b":"code","82b0c9b2":"code","76f1eefe":"code","07c51559":"code","dbd174a5":"code","3c130b95":"code","2920f38b":"code","4ec5e0a8":"code","b3d54c3b":"code","6ba600fb":"code","1a44f19a":"code","b9ec748a":"code","61ef81bd":"code","37f3604a":"code","e04bd571":"code","57b0904b":"code","176cd26c":"code","7c526e57":"code","d6fb78a7":"code","8c32e21c":"code","3ea489d0":"code","772171e6":"code","0dda1fcf":"code","2fd6edc5":"code","0f507c2c":"code","e6217260":"code","4327ed5e":"code","8380b682":"code","29f23c04":"code","972ccd39":"code","6db17538":"code","08170cda":"code","994a690b":"code","4d7bea62":"code","a2a8ecea":"markdown","e165dd17":"markdown"},"source":{"071fe5f8":"import numpy as np\nimport pandas as pd\n%matplotlib inline","73c3eafa":"import warnings\nwarnings.filterwarnings('ignore')","72c64849":"df1=pd.read_csv('..\/input\/dailyfemalebirth\/DailyTotalFemaleBirths.csv',index_col='Date',parse_dates=True)\ndf1.index.freq='D'\ndf2=pd.read_csv('..\/input\/tradeinventories\/TradeInventories.csv',index_col='Date',parse_dates=True)\ndf2.index.freq='MS'","e0a8a00b":"pip install pmdarima\n","5f13ce7b":"from pmdarima import auto_arima","82b0c9b2":"from statsmodels.tsa.stattools import adfuller\nfrom statsmodels.graphics.tsaplots import plot_acf,plot_pacf","76f1eefe":"def adf_test(series,title=''):\n    print(f'Augmented Dickey-Fuller Test :{title}')\n    results=adfuller(series.dropna(),autolag='AIC')\n    labels=['ADF Test Statistics','P_value','# lags Used','# Observations']\n    out=pd.Series(results[0:4],index=labels)\n    \n    for key,val in results[4].items():\n        out[f'Critical Value :({key})']=val\n    \n    print(out.to_string())\n    \n    if results[1]<=0.05:\n        print('Strong Evidence against the Null Hypothesis')\n        print('Reject the Null Hypothesis Testing')\n        print('Data has no unit root and it is Stationary')\n    else:\n        print('Waek Evidence against the Null Hypothesis')\n        print('Failed to reject the Null Hypothesis Testing')\n        print('Data has unit root and it is Non Stationary')","07c51559":"adf_test(df1['Births'])","dbd174a5":"adf_test(df2['Inventories'])","3c130b95":"auto_arima(df1['Births'],seasonal=False).summary()","2920f38b":"from statsmodels.tsa.arima_model import ARMA,ARMAResults,ARIMA,ARIMAResults","4ec5e0a8":"model=ARMA(df1['Births'],order=(2,2))\nresult=model.fit()\nresult.summary()","b3d54c3b":"len(df1)","6ba600fb":"df1=df1[:120]","1a44f19a":"len(df1)","b9ec748a":"train = df1.iloc[:90]\ntest = df1.iloc[90:]","61ef81bd":"start=len(train)\nend=len(train)+len(test)-1","37f3604a":"predictions=result.predict(start=start,end=end).rename('ARMA(2,2) Predictions')","e04bd571":"title = 'Daily Total Female Births'\nylabel='Births'\nxlabel='' # we don't really need a label here\n\nax = test['Births'].plot(legend=True,figsize=(12,6),title=title)\npredictions.plot(legend=True)\nax.autoscale(axis='x',tight=True)\nax.set(xlabel=xlabel, ylabel=ylabel);","57b0904b":"test.mean()","176cd26c":"predictions.mean()","7c526e57":"from statsmodels.tsa.seasonal import seasonal_decompose","d6fb78a7":"auto_arima(df2['Inventories'],seasonal=False).summary()","8c32e21c":"#since model is suugesting that we should Differenced the Data One time","3ea489d0":"from statsmodels.tsa.statespace.tools import diff","772171e6":"df2['Diff-1']=diff(df2['Inventories'],k_diff=1)","0dda1fcf":"adf_test(df2['Diff-1'])","2fd6edc5":"plot_acf(df2['Inventories'],lags=40);\nplot_pacf(df2['Inventories'],lags=40);","0f507c2c":"model=ARIMA(train['Inventories'],order=(1,1,0))","e6217260":"result=model.fit()\nresult.summary()","4327ed5e":"train = df2.iloc[:252]\ntest = df2.iloc[252:]","8380b682":"start=len(train)\nend=len(train)+len(test)-1\npredictions = result.predict(start=start, end=end, dynamic=False, typ='levels').rename('ARIMA(1,1,0) Predictions')","29f23c04":"for i in range(len(predictions)):\n    print(f\"predicted={predictions[i]:<11.10}, expected={test['Inventories'][i]}\")","972ccd39":"title = 'Real Manufacturing and Trade Inventories'\nylabel='Chained 2012 Dollars'\nxlabel='' # we don't really need a label here\n\nax = test['Inventories'].plot(legend=True,figsize=(12,6),title=title)\npredictions.plot(legend=True)\nax.autoscale(axis='x',tight=True)\nax.set(xlabel=xlabel, ylabel=ylabel)\n","6db17538":"from sklearn.metrics import mean_squared_error\n\nerror = mean_squared_error(test['Inventories'], predictions)\nprint(f'ARIMA(1,1,0) MSE Error: {error:11.10}')","08170cda":"from statsmodels.tools.eval_measures import rmse\n\nerror = rmse(test['Inventories'], predictions)\nprint(f'ARIMA(1,1,0) RMSE Error: {error:11.10}')","994a690b":"model = ARIMA(df2['Inventories'],order=(1,1,0))\nresults = model.fit()\nfcast = results.predict(len(df2),len(df2)+11,typ='levels').rename('ARIMA(1,1,0) Forecast')","4d7bea62":"title = 'Real Manufacturing and Trade Inventories'\nylabel='Chained 2012 Dollars'\nxlabel='' # we don't really need a label here\n\nax = df2['Inventories'].plot(legend=True,figsize=(12,6),title=title)\nfcast.plot(legend=True)\nax.autoscale(axis='x',tight=True)\nax.set(xlabel=xlabel, ylabel=ylabel)","a2a8ecea":"# Test for Stationarity","e165dd17":"# Pacf plot shows a sharp drop after first lag which suggest that AR1 model should be used"}}