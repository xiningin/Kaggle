{"cell_type":{"9cea9a16":"code","f0089bbb":"code","ac2eed63":"code","310e5f8a":"code","4ecf32f9":"code","21b74a89":"code","e531b19a":"code","135db02a":"code","a3b8af97":"code","9159615c":"code","4eb02206":"code","bbcab5e3":"code","f76b5af3":"code","240c7d92":"code","cabac6a3":"code","39a4715d":"code","1441e376":"code","ebbb98e5":"code","c76e305e":"code","59a6e412":"code","08e508c6":"code","1b0110f7":"code","1f5e3346":"markdown","d3f7dea3":"markdown","4462ee56":"markdown","e0ca23a0":"markdown","7fc3cdb8":"markdown","b6ee4499":"markdown"},"source":{"9cea9a16":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt","f0089bbb":"eventcode_file=\"..\/input\/eventcode1.csv\"\ndf_code=pd.read_csv(eventcode_file)","ac2eed63":"df_code.head()","310e5f8a":"# number of rows\nlen (df_code)","4ecf32f9":"df_code.dtypes","21b74a89":"#rename the count column\ndf_code.rename(columns={'_c2':'count'},inplace=True)","e531b19a":"df_code.tail(5)","135db02a":"#total number of events by country\ntotevents=df_code.groupby('actor1countrycode')['count'].sum()\nprint (totevents)","a3b8af97":"totevents.plot(kind='bar')\nplt.xlabel('Country')\nplt.ylabel('Number of events')\nplt.title('Number of events by Country')","9159615c":"#divide up large dataframe into separate ones for each country\nNZL=df_code[df_code['actor1countrycode']=='NZL']\nAUS=df_code[df_code['actor1countrycode']=='AUS']\nBEL=df_code[df_code['actor1countrycode']=='BEL']\nJPN=df_code[df_code['actor1countrycode']=='JPN']\nIND=df_code[df_code['actor1countrycode']=='IND']\nFRA=df_code[df_code['actor1countrycode']=='FRA']","4eb02206":"#sort from highest to lowest count of each eventcode and create a dataframe for each country's top 5 eventcodes\nNZL1=NZL.sort_values('count',ascending=False)\nNZLtop_e = NZL1.head()\nAUS1=AUS.sort_values('count',ascending=False)\nAUStop_e = AUS1.head()\nBEL1=BEL.sort_values('count',ascending=False)\nBELtop_e= BEL1.head()\nJPN1=JPN.sort_values('count',ascending=False)\nJPNtop_e = JPN1.head()\nIND1=IND.sort_values('count',ascending=False)\nINDtop_e = IND1.head()\nFRA1=FRA.sort_values('count',ascending=False)\nFRAtop_e = FRA1.head()","bbcab5e3":"NZLtop_e.plot('eventcode','count',kind='bar')\nplt.xlabel('Event Code')\nplt.ylabel('Count')\nplt.title('Count of events - New Zealand')\n\nAUStop_e.plot('eventcode','count',kind='bar')\nplt.xlabel('Event Code')\nplt.ylabel('Count')\nplt.title('Count of events - Australia')\n\nBELtop_e.plot('eventcode','count',kind='bar')\nplt.xlabel('Event Code')\nplt.ylabel('Count')\nplt.title('Count of events - Belgium')\n\nJPNtop_e.plot('eventcode','count',kind='bar')\nplt.xlabel('Event Code')\nplt.ylabel('Count')\nplt.title('Count of events - Japan')\n\nINDtop_e.plot('eventcode','count',kind='bar')\nplt.xlabel('Event Code')\nplt.ylabel('Count')\nplt.title('Count of events - India')\n\nFRAtop_e.plot('eventcode','count',kind='bar')\nplt.xlabel('Event Code')\nplt.ylabel('Count')\nplt.title('Count of events - France')","f76b5af3":"quadclass_file=\"..\/input\/quadclass_count.csv\"\ndf_quad=pd.read_csv(quadclass_file)","240c7d92":"df_quad.head()","cabac6a3":"df_quad.rename(columns={'_c2':'count'},inplace=True)","39a4715d":"aus1=df_quad[df_quad['actor1countrycode']=='AUS']\nbel1=df_quad[df_quad['actor1countrycode']=='BEL']\nfra1=df_quad[df_quad['actor1countrycode']=='FRA']\nind1=df_quad[df_quad['actor1countrycode']=='IND']\njpn1=df_quad[df_quad['actor1countrycode']=='JPN']\nnzl1=df_quad[df_quad['actor1countrycode']=='NZL']","1441e376":"aus1.plot('quadclass','count',kind='bar')\nplt.xlabel('QuadClass')\nplt.ylabel('Number of Events')\nplt.title('Number of events by QuadClass - Australia')","ebbb98e5":"bel1.plot('quadclass','count',kind='bar')\nplt.xlabel('QuadClass')\nplt.ylabel('Number of Events')\nplt.title('Number of events by QuadClass - Belgium')","c76e305e":"fra1.plot('quadclass','count',kind='bar')\nplt.xlabel('QuadClass')\nplt.ylabel('Number of Events')\nplt.title('Number of events by QuadClass - France')","59a6e412":"ind1.plot('quadclass','count',kind='bar')\nplt.xlabel('QuadClass')\nplt.ylabel('Number of Events')\nplt.title('Number of events by QuadClass - India')","08e508c6":"jpn1.plot('quadclass','count',kind='bar')\nplt.xlabel('QuadClass')\nplt.ylabel('Number of Events')\nplt.title('Number of events by QuadClass - Japan')","1b0110f7":"nzl1.plot('quadclass','count',kind='bar')\nplt.xlabel('QuadClass')\nplt.ylabel('Number of Events')\nplt.title('Number of events by QuadClass - New Zealand')","1f5e3346":"Load up the quadclass count file which contains results of a Hive query that counted the number of events in each quad class by country ","d3f7dea3":"break up the large dataframe into separate ones by country","4462ee56":"Plot of each country's top 5 event codes by count","e0ca23a0":"visualize the quad class data by country","7fc3cdb8":"eventcode1 file contains results of a Hive query that counted the number of eventcodes by country (for selected 6 countries) ","b6ee4499":"rename the count column"}}