{"cell_type":{"46ccad5b":"code","326b6295":"code","ea3fd6a7":"code","bb400f85":"code","9a610d95":"code","e0af3c56":"code","1de9393f":"code","f9a89ee7":"code","58671fd7":"code","2426bc70":"code","a3f0fd9d":"code","62903059":"code","834a0766":"code","42cd448c":"code","f2a6df5b":"code","cb0280eb":"code","755c51bf":"markdown","e94d5b58":"markdown","0cf8bbbe":"markdown","f3156636":"markdown","60511862":"markdown","bd487d51":"markdown"},"source":{"46ccad5b":"from fastai.tabular.all import *","326b6295":"path = Path('..\/input\/tabular-playground-series-mar-2021')","ea3fd6a7":"train_df = pd.read_csv(path\/'train.csv')\ntrain_df['target'] = train_df['target'].astype(np.float32)\ntrain_df","bb400f85":"train_df.describe()","9a610d95":"test_df = pd.read_csv(path\/'test.csv')\ntest_df","e0af3c56":"test_df.describe()","1de9393f":"# get category data column\ncat_nn = list(train_df.iloc[:,1:20])","f9a89ee7":"# get continuous data column\ncont_nn = list(train_df.iloc[:,21:-1])","58671fd7":"# split last 20% for validation\nsplits = (list(range(240000)),list(range(240000,300000)))","2426bc70":"procs_nn = [Categorify, FillMissing, Normalize]\nto_nn = TabularPandas(train_df, procs_nn, cat_nn, cont_nn,\n                      splits=splits, y_names='target')","a3f0fd9d":"# create dataloaders\ndls = to_nn.dataloaders(1024)","62903059":"# create a learner using tabular_learner\nlearn = tabular_learner(dls, y_range=(0,1), layers=[500,250],\n                        n_out=1, loss_func=F.mse_loss)","834a0766":"# to find a good lr\nlearn.lr_find()","42cd448c":"learn.fit_one_cycle(4, 1e-3)","f2a6df5b":"tst_dl = learn.dls.test_dl(test_df)\npred, _ = learn.get_preds(dl = tst_dl)","cb0280eb":"submission_df = pd.read_csv(path\/'sample_submission.csv')\nsubmission_df['target'] = pred.squeeze()\nsubmission_df.to_csv('submission.csv', index=False)\nsubmission_df","755c51bf":"# Make Submission File","e94d5b58":"# Create Dataloaders","0cf8bbbe":"# Create learner","f3156636":"# Import Train Data","60511862":"# Setup Environment","bd487d51":"# Get prediction"}}