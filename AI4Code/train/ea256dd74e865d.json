{"cell_type":{"4605748c":"code","5bfccd3c":"code","4e74bd77":"code","cf513d9c":"code","2c704781":"code","991e360d":"code","be793ec4":"code","0c1eba9f":"code","21cf0250":"code","c7cff2a8":"code","37506ea2":"code","dd358b9c":"code","c62bb74c":"code","b876645e":"code","a7d8050e":"code","99b2967d":"code","537cb7b2":"code","27882151":"code","be8c9954":"code","0a9f829b":"code","af858ff6":"code","d871f54c":"code","fe41a632":"code","51180048":"code","227cef91":"code","19914888":"code","610fb7e2":"code","9a8a504d":"code","74c259c1":"code","a2db6588":"code","99da5bf0":"code","16463402":"code","d2fbd679":"code","a33b0365":"code","7144923a":"code","3e033776":"code","98504422":"code","b3747807":"code","01e38a05":"code","03e764ac":"code","49d3427f":"code","ceb8e68c":"markdown","0a74aa38":"markdown","a649a928":"markdown","7eb54eb3":"markdown","a59cded0":"markdown","d6cdeb94":"markdown","a14e4f07":"markdown","626bb88a":"markdown","1cf6f508":"markdown","a23afa91":"markdown","d23a98e9":"markdown"},"source":{"4605748c":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import r2_score , mean_squared_error","5bfccd3c":"df = pd.read_csv(\"..\/input\/health-insurance-dataset\/Health_insurance.csv\")\ndf.columns","4e74bd77":"df.head()","cf513d9c":"df.tail()","2c704781":"df.shape","991e360d":"df.info()","be793ec4":"df[df['smoker']=='yes']","0c1eba9f":"df.describe()","21cf0250":"sns.distplot(df['age'])\n\n# distribution does not looks like normal\/gaussian distribution","c7cff2a8":"df['age'].max()\n\n# max age of the insurer is 64 which is quite commom","37506ea2":"df.boxplot(column=\"age\")\n\n# looks like there are no outliers\n# 50th percentile value is opprox half of the 100th percentile","dd358b9c":"sns.distplot(df['bmi'])\n\n# distribution looks like Normal\/gaussian distribution","c62bb74c":"df.boxplot(column='bmi')\n\n# looks like bmi has some outliers. Lets try the box plot for more clarity on outliers","b876645e":"df['bmi'].describe()\n\n# not sure whether there are outliers or not\n# try to compute percentile values","a7d8050e":"for i in range(0,101,2):\n    print(f\"BMI of {i}th percentile is :{np.percentile(df['bmi'], i)}\")\n    \n# looks like there are outliers by checking the percentile values\n# value difference for every 2nd percentile is lessthan or equal to 1\n# but the there is huge difference between 98th and 100th percentile\n# compute the percentile from 90th to 100","99b2967d":"for i in range(90,101,1):\n    print(f\"BMI of {i}th percentile is :{np.percentile(df['bmi'], i)}\")\n    \n# looks like 100th percentile is the outlier","537cb7b2":"upper_boundry = df['bmi'].mean() + 3 * df['bmi'].std()\nlower_boundry = df['bmi'].mean() - 3 * df['bmi'].std()\nprint(f\"Upper boundry value for BMI is:{round(upper_boundry)}\")\nprint(f\"Lower boundry value for BMI is: {round(lower_boundry)}\")","27882151":"smokers = df[df['smoker']=='yes']['charges'].values\n\nnon_smokers = df[df['smoker']=='no']['charges'].values\nnon_smokers","be8c9954":"plt.figure(figsize=(10,3))\nsns.distplot(smokers, hist=False, label=\"smokers\")\nsns.distplot(non_smokers, hist=False, label=\"non-smokers\")\nplt.title('charges for smokers and non-smokers')\nplt.xlabel('Comparision of smokers and non-smokers charges')\nplt.legend()\nplt.show()\n\n# from the graph we can clearly see that smokers paid very more charges than the non-smokers","0a9f829b":"male_charges = df[df['sex'] == 'male']['charges'].values\nfemale_charges = df[df['sex'] == 'female']['charges'].values","af858ff6":"plt.figure(figsize=(10,3))\nsns.distplot(male_charges, hist=False, label=\"male\")\nsns.distplot(female_charges, hist=False, label=\"female\")\nplt.title('charges for male and female')\nplt.xlabel('Comparision of male and female charges')\nplt.legend()\nplt.show()\n\n# charges for male and female are almost equal.","d871f54c":"df['children'].unique()","fe41a632":"zero_children = df[df['children'] == 0]['charges'].values\none_children = df[df['children'] == 1]['charges'].values\ntwo_children = df[df['children'] == 2]['charges'].values\nthree_children = df[df['children'] == 3]['charges'].values\nfour_children = df[df['children'] == 4]['charges'].values\nfive_children = df[df['children'] == 5]['charges'].values\n","51180048":"plt.figure(figsize=(10,3))\nsns.distplot(zero_children, hist=False, label=\"zero\")\nsns.distplot(one_children, hist=False, label=\"one\")\nsns.distplot(three_children, hist=False, label=\"three\")\nsns.distplot(four_children, hist=False, label=\"four\")\nsns.distplot(five_children, hist=False, label=\"five\")\nplt.title('charges based on number of children')\nplt.xlabel('Comparision of charges based on insurers number of children')\nplt.legend()\nplt.show()\n\n\n# insurers having 5 children paid very less charges when compared to others.","227cef91":"df['region'].unique()","19914888":"southwest = df[df['region'] == 'southwest']['charges'].values\nsoutheast = df[df['region'] == 'southeast']['charges'].values\nnorthwest = df[df['region'] == 'northwest']['charges'].values\nnortheast = df[df['region'] == 'northeast']['charges'].values\n","610fb7e2":"plt.figure(figsize=(10,3))\nsns.distplot(southeast, hist=False, label=\"southeast\")\nsns.distplot(southwest, hist=False, label=\"southwest\")\nsns.distplot(northwest, hist=False, label=\"northwest\")\nsns.distplot(northeast, hist=False, label=\"northeast\")\nplt.title('charges based on region of insurer')\nplt.xlabel('Comparision of region based on insurers region')\nplt.legend()\nplt.show()\n\n# looks like charges doesnot depend on the region","9a8a504d":"sns.pairplot(df, hue='smoker')\n\n# based on smoker or not we see there is a good relation among features age, bmi, children, smoker","74c259c1":"sns.pairplot(df, hue='sex')\n\n","a2db6588":"sns.lmplot(x='age', y='charges', hue='smoker', data=df);\n\n# charges increases for both smokers and non smokers linearly","99da5bf0":"sns.lmplot(x='bmi', y='charges', hue='smoker', data=df);\n# As BMI increases charges increases rapidly for smokers","16463402":"data = df.copy()\n\ndata.loc[data['bmi']>49, 'bmi'] = 49","d2fbd679":"# let's examine how many columns we we after one hot encoding\n\n# pd.get_dummies(df, drop_first=True)\none_hot_df = pd.get_dummies(df)\none_hot_df.shape","a33b0365":"X, y = one_hot_df.drop('charges', axis=1), one_hot_df.charges\nprint(X.shape, y.shape)","7144923a":"x_train , x_test , y_train , y_test = train_test_split(X, y, test_size = 0.2 , random_state = 51)","3e033776":"print(\" Shape of x_train = \", x_train.shape)\nprint(\" Shape of x_test = \", x_test.shape)\nprint(\" Shape of y_train = \", y_train.shape)\nprint(\" Shape of y_test = \", y_test.shape)","98504422":"sc = StandardScaler()\nsc.fit(x_train)\nx_train = sc.transform(x_train)\nx_test = sc.transform(x_test)\n\nx_train","b3747807":"lr = LinearRegression() \nlr.fit(x_train, y_train)","01e38a05":"print(\"Intercept : \" , lr.intercept_)\nprint(\"Slope : \" , lr.coef_)","03e764ac":"y_pred = lr.predict(x_test)\ny_pred_df = pd.DataFrame(y_pred, columns=[\"Predicted Values\" ])\ny_test_df = pd.DataFrame(np.array(y_test), columns=[\"Real Values\"])\npd.concat([y_test_df , y_pred_df] , axis=1)","49d3427f":"from sklearn.metrics import r2_score\naccuracy = r2_score(y_test, y_pred)\naccuracy","ceb8e68c":"##### 1. As the age increases charges increases liniarly\n##### 2. for charges lessthan 10000 Non smokers paid less insurance where as smokers with same age paid morethan 30,000\n##### 3. In the range of 10000 to 20000 smokers and non smokers are clubed.\n\n##### 4. As the bmi increses charges for smokers and non-smokers liniarly","0a74aa38":"### univariate analysis on region","a649a928":"### Multivariate analysis","7eb54eb3":"## univariate analysis on 'bmi'","a59cded0":"### Remove outliers","d6cdeb94":"### univariate analysis on children","a14e4f07":"### univariate analysis on smoker","626bb88a":"## Univariate analysis on 'age'","1cf6f508":"### overall assumption on Univariate analysis\n\n##### Categorical Features like region, children sex does not influence charges much\n##### Categarical Features like smoking influences charges more\n1. Insurer having smoking habit paid more charges than non smoker\n\n#### Looks like in bmi there are outliers\n\n<br><br><br><br><br><br><br><br><br><br><br>","a23afa91":"### Calculating the boundry values for BMI\n\n##### Assuming bmi follows a gaussian distribution we will calculate the boundaries which differentiates the outliers","d23a98e9":"### univariate analysis on sex"}}