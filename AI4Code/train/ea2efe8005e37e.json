{"cell_type":{"4bb587d9":"code","fe982b58":"code","ebdaab7d":"code","5acf4bfe":"code","dcd3e67e":"code","a1a5878b":"code","ab8181ef":"code","ae0ebc13":"code","461a2d06":"code","382f56ee":"code","7f66d2c1":"code","3d2119a3":"code","3a2568a4":"code","16aa52fb":"code","70d92194":"code","58ee5e26":"code","cf5e25db":"markdown","558a7ce6":"markdown","9f5d143b":"markdown","64fe6ae3":"markdown","b6ca7120":"markdown","fc8b747a":"markdown","6b2efdb3":"markdown","60699645":"markdown","f04b3973":"markdown","268d5acf":"markdown","ff286108":"markdown","df69a730":"markdown","3cef4363":"markdown"},"source":{"4bb587d9":"import itertools\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom matplotlib.ticker import NullFormatter\nimport pandas as pd\nimport numpy as np\nimport matplotlib.ticker as ticker\nfrom sklearn import preprocessing\n%matplotlib inline","fe982b58":"df = pd.read_csv('..\/input\/telecustsclasses\/teleCust1000t.csv')\ndf.head()","ebdaab7d":"df['custcat'].value_counts()","5acf4bfe":"df.hist(column='income', bins=50)","dcd3e67e":"df.columns","a1a5878b":"X = df[['region', 'tenure','age', 'marital', 'address', 'income', 'ed', 'employ','retire', 'gender', 'reside']] .values  #.astype(float)\nX[0:5]","ab8181ef":"y = df['custcat'].values\ny[0:5]","ae0ebc13":"X = preprocessing.StandardScaler().fit(X).transform(X.astype(float))\nX[0:5]","461a2d06":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split( X, y, test_size=0.2, random_state=4)\nprint ('Train set:', X_train.shape,  y_train.shape)\nprint ('Test set:', X_test.shape,  y_test.shape)","382f56ee":"from sklearn.neighbors import KNeighborsClassifier\nk = 3\n#Train Model and Predict  \nneigh = KNeighborsClassifier(n_neighbors = k).fit(X_train,y_train)\nneigh","7f66d2c1":"yhat = neigh.predict(X_test)\nyhat[0:5]","3d2119a3":"from sklearn import metrics\nprint(\"Train set Accuracy: \", metrics.accuracy_score(y_train, neigh.predict(X_train)))\nprint(\"Test set Accuracy: \", metrics.accuracy_score(y_test, yhat))","3a2568a4":"k = 6\nneigh = KNeighborsClassifier(n_neighbors = k).fit(X_train,y_train)\nneigh\n\nyhat = neigh.predict(X_test)\nyhat[0:5]\n\nfrom sklearn import metrics\nprint(\"Train set Accuracy: \", metrics.accuracy_score(y_train, neigh.predict(X_train)))\nprint(\"Test set Accuracy: \", metrics.accuracy_score(y_test, yhat))","16aa52fb":"Ks = 10\nmean_acc = np.zeros((Ks-1))\nstd_acc = np.zeros((Ks-1))\nConfustionMx = [];\nfor n in range(1,Ks):\n    \n    #Train Model and Predict  \n    neigh = KNeighborsClassifier(n_neighbors = n).fit(X_train,y_train)\n    yhat=neigh.predict(X_test)\n    mean_acc[n-1] = metrics.accuracy_score(y_test, yhat)\n\n    \n    std_acc[n-1]=np.std(yhat==y_test)\/np.sqrt(yhat.shape[0])\n\nmean_acc","70d92194":"plt.plot(range(1,Ks),mean_acc,'g')\nplt.fill_between(range(1,Ks),mean_acc - 1 * std_acc,mean_acc + 1 * std_acc, alpha=0.10)\nplt.legend(('Accuracy ', '+\/- 3xstd'))\nplt.ylabel('Accuracy ')\nplt.xlabel('Number of Nabors (K)')\nplt.tight_layout()\nplt.show()","58ee5e26":"print( \"The best accuracy was with\", mean_acc.max(), \"with k=\", mean_acc.argmax()+1)","cf5e25db":"**Plotting model accuracy for Different number of Neighbors**","558a7ce6":"ie. 281 Plus Service, 266 Basic-service, 236 Total Service, and 217 E-Service customers\n\n**Exploring data using visualization techniques**","9f5d143b":"**About data**\n\nThe target field, called custcat, has four possible values that correspond to the four customer groups, as follows: 1- Basic Service 2- E-Service 3- Plus Service 4- Total Service\n\nOur objective is to build a classifier, to predict the class of unknown cases.","64fe6ae3":"**converting the Pandas data frame to a Numpy array** ","b6ca7120":"**Data Visualization and Analysis**","fc8b747a":"**Prediction**","6b2efdb3":"**Classification\nk nearest neighbor (KNN)**","60699645":"**Accuracy evaluation**","f04b3973":"**Feature sets**","268d5acf":"**Normalize Data**","ff286108":"**So, how can we choose right value for K?** \n\nThe general solution is to reserve a part of your data for testing the accuracy of the model. Then choose k =1, use the training part for modeling, and calculate the accuracy of prediction using all samples in your test set. Repeat this process, increasing the k, and see which k is the best for your model.\n\n**We can calculate the accuracy of KNN for different Ks.**","df69a730":"**Train Test Split**","3cef4363":"**Imagine a telecommunications provider has segmented its customer base by service usage patterns, categorizing the customers into four groups. If demographic data can be used to predict group membership, the company can customize offers for individual prospective customers. That is, given the dataset, with predefined labels, we need to build a model to be used to predict class of a new or unknown case**\n\nFor example, we have data points of Class A and B. We want to predict what the test data point is. If we consider a k value of 3 (3 nearest data points) we will obtain a prediction of Class B. Yet if we consider a k value of 6, we will obtain a prediction of Class A."}}