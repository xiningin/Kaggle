{"cell_type":{"8e9333a9":"code","e7ae0875":"code","0cfd93e6":"code","57b5a182":"code","34d1ff34":"code","459f5e90":"code","1b75a0a8":"code","125c7730":"code","87aa0c7f":"code","5bfd2882":"code","f4048099":"code","da1b17ab":"code","c3b2fb15":"code","93e45d67":"markdown","1b990aa2":"markdown","eb817284":"markdown","ce3c9bdb":"markdown","c936cc88":"markdown","c4db3ffa":"markdown","604845bd":"markdown","a237c259":"markdown"},"source":{"8e9333a9":"# Segundo Desafio de Modelagem Preditiva da AISMP\n# rafael.souza@serpro.gov.br - (21)7499\n# \"O objetivo deste conjunto de dados \u00e9 prever a classe dos animais com base nas caracter\u00edsticas deles.\"\n\n# Neste exerc\u00edcio, utilizei a abordagem de \u00e1rvore de decis\u00e3o, \n# pois creio que o conjunto de caracter\u00edsticas de cada animal \n# \u00e9 fator crucial para determinar a esp\u00e9cie de cada um deles.","e7ae0875":"# importando as bibliotecas\nimport numpy as np\nimport pandas as pd\nimport os\nfrom sklearn.tree import DecisionTreeClassifier\n\n# carregando arquivos de dados\ntrain_data_1 = pd.read_csv('..\/input\/zoo-train.csv', index_col='animal_name')\ntrain_data_2 = pd.read_csv('..\/input\/zoo-train2.csv', index_col='animal_name')\ntest_data = pd.read_csv('..\/input\/zoo-test.csv', index_col='animal_name')","0cfd93e6":"# substituindo os caracteres por n\u00fameros, para permitir a an\u00e1lise do modelo.\n\ntrain_data_1 = train_data_1.replace(to_replace = [\"y\", \"n\"], value = [\"1\", \"0\"])\ntrain_data_1 = train_data_1.replace(to_replace = [\"y\", \"n\"], value = [\"1\", \"0\"])\ntrain_data_2 = train_data_2.replace(to_replace = [\"y\", \"n\"], value = [\"1\", \"0\"])\ntrain_data_2 = train_data_2.replace(to_replace = [\"y\", \"n\"], value = [\"1\", \"0\"])\ntest_data = test_data.replace(to_replace = [\"y\", \"n\"], value = [\"1\", \"0\"])\ntest_data = test_data.replace(to_replace = [\"y\", \"n\"], value = [\"1\", \"0\"])\n\n# Neste exerc\u00edcio, utilizaremos os dois arquivos de treino concatenados, para aumentar a acur\u00e1cia da an\u00e1lise preditiva.\n\n#train_data = train_data_1 \ntrain_data = pd.concat([train_data_1, train_data_2])","57b5a182":"# Exibindo o arquivo de treino concatenado\n\nprint (\"train_data\")\ntrain_data.head()","34d1ff34":"# Exibindo o arquivo de teste\n\nprint (\"test_data\")\ntest_data.head()","459f5e90":"# definindo os dados de treino de teste\n\nX_train = train_data.drop(['class_type'], axis=1) # dados de treino: todas as colunas, menos a alvo\nY_train = pd.DataFrame(train_data['class_type']) # dados de treino: coluna alvo\nX_test = test_data # dados de teste: todas as colunas, pois n\u00e3o possui a coluna alvo\n\n# exibindo a forma dos dados\n\nprint('Forma dos dados de treino:', X_train.shape, Y_train.shape)\nprint('Forma dos dados de teste:', X_test.shape)\nprint(type(X_train), type(Y_train), type(X_test))","1b75a0a8":"# Selecionando o modelo\n\nmodel = DecisionTreeClassifier()","125c7730":"# Treinando o modelo\n\nmodel.fit(X_train, Y_train)","87aa0c7f":"# Realizando a valida\u00e7\u00e3o cruzada\n\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.model_selection import LeaveOneOut\nloo = LeaveOneOut()\nscores = cross_val_score(model, X_train, Y_train, cv=loo)\nscores","5bfd2882":"# Realizando a an\u00e1lise preditiva\n\nY_pred = model.predict(X_test)\nprint(Y_pred)","f4048099":"# Gerando o conjunto de dados de sa\u00edda\n\nsubmission = pd.DataFrame({'animal_name': X_test.index, 'class_type': Y_pred})\nsubmission.set_index('animal_name', inplace=True)\n\n# Exibindo os dados de sa\u00edda\n\nsubmission.head()","da1b17ab":"# gerando o arquivo CSV de sa\u00edda\nsubmission.to_csv('..\/zoo-submission.csv')\n\n# verificando o conte\u00fado do arquivo gerado\nsubmission = pd.read_csv('..\/zoo-submission.csv', index_col='animal_name')\nprint(submission)","c3b2fb15":"# At\u00e9 o pr\u00f3ximo desafio.\n# Atenciosamente.\n# rafael.souza@serpro.gov.br","93e45d67":"Transforma\u00e7\u00e3o","1b990aa2":"Explora\u00e7\u00e3o","eb817284":"Leitura","ce3c9bdb":"Visualiza\u00e7\u00e3o","c936cc88":"Considera\u00e7\u00f5es Iniciais","c4db3ffa":"Considera\u00e7\u00f5es Finais","604845bd":"Escrita","a237c259":"Modelagem"}}