{"cell_type":{"a57a41fe":"code","099aeb26":"code","7645d305":"code","da6078ca":"code","05216cc7":"code","c1a7efc2":"code","3bb7a5c4":"code","4c3c1fd9":"code","021a7bfa":"markdown","f7ad5e68":"markdown","9ddecf5e":"markdown","69a49bd6":"markdown","9b006958":"markdown","196c11c6":"markdown","2975cae1":"markdown","fe170469":"markdown","c037ce80":"markdown"},"source":{"a57a41fe":"import numpy as np\nimport tensorflow as tf\nimport keras\nimport pandas as pd\nimport zipfile\nimport cv2\nimport sklearn.model_selection\nfrom keras import backend as K\nfrom keras.utils import to_categorical\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n#         print(os.path.join(dirname, filename))\n          pass\n        \n","099aeb26":"def pre_process(name): \n  data = pd.read_csv(name+'.csv')\n  x = np.array(data['image'])\n  la = np.array(data['category'])\n  new = []\n  for i in x:\n    y = cv2.imread('\/kaggle\/input\/game-of-deep-learning-ship-datasets\/train\/images\/'+i , 1)\n    res = cv2.resize(y , (210,126))\n    new.append(res)\n  new = np.array(new)\n  print(data.info())\n  print(data.describe())\n  return new , la\n\n\nw , labels = pre_process('\/kaggle\/input\/game-of-deep-learning-ship-datasets\/train\/train')","7645d305":"# #################### Train_test_split #################### #\n\nx_train , x_test , y_train , y_test = sklearn.model_selection.train_test_split(w , labels , test_size=0.1)\nprint(x_train.shape , y_train.shape)\nprint(x_test.shape , y_test.shape)\ny_dummy = y_test\n\n# ############## Making one hot coded train label ################ #\ny_train = to_categorical(y_train)\nprint(y_train.shape)\n\n# ############## Making one hot coded test label ################ #\ny_test = to_categorical(y_test)\nprint(y_test.shape)","da6078ca":"# ################# Model creation ################ #\n\nx_train = x_train\/255.0\nx_test = x_test\/255.0\n\nif K.image_data_format() == 'channels_first':\n    input_shape = (3, 126 , 210) \nelse:\n    input_shape = (126, 210, 3)\n\nmodel = keras.Sequential([\n\n############## First Convolutional layer so we will specify input_shape here #####################              \nkeras.layers.Conv2D(64, (3,3), activation='relu', input_shape = input_shape  ),\nkeras.layers.MaxPooling2D(2, 2),\n\n############## Second Convolutional layer || not specifying input shape #########################\nkeras.layers.Conv2D(64, (3,3), activation='relu'),\nkeras.layers.MaxPooling2D(2, 2),\n\n############## Third Convolutional layer || not specifying input shape #########################\nkeras.layers.Conv2D(64, (3,3), activation='relu'),\nkeras.layers.MaxPooling2D(2, 2),\n\n############## Fourth Convolutional layer || not specifying input shape ########################\nkeras.layers.Conv2D(64, (3,3), activation='relu'),\nkeras.layers.MaxPooling2D(2, 2),\n\n\n############### Flattening input ################## \nkeras.layers.Flatten(),\n\n############## Neurons droped per E-poch ##########\nkeras.layers.Dropout(0.5),\n# 512 neuron hidden layer\nkeras.layers.Dense(512, activation='relu'),\nkeras.layers.Dense(6 , activation='softmax')\n\n])\n\nmodel.summary()\n\nmodel.compile(loss = 'categorical_crossentropy', optimizer='rmsprop', metrics=['accuracy'])\n\n# model.fit(train_generator, epochs=25, steps_per_epoch=20, validation_data = validation_generator, verbose = 1, validation_steps=3)\n\n# ###### Fitting model ######\nmodel.fit(x_train , y_train , epochs=8 , validation_data=(x_test, y_test))\n\nloss , acc = model.evaluate( x_test , y_test )\n\nprint(acc)","05216cc7":"# ############### Saving model as hd5 file ################ #\n\nmodel.save('Ship_Class_2.h5')","c1a7efc2":"# ############ loading the saved model from Keras ################ #\n\nfrom keras.models import load_model\n\nmodel = load_model('\/content\/Ship_Class_2.h5')\n\nprint(model.summary())","3bb7a5c4":"z , lab = pre_process('\/kaggle\/input\/game-of-deep-learning-ship-datasets\/test_ApKoW4T')\npredictions = model.predict(z)\n\n# ############# Label names ################### #\n\nmy_dic = {\n1:'Cargo' ,\n2:'Military',\n3:'Carrier',\n4:'Cruise',\n5:'Tankers', \n}\n\nfor i in range(len(predictions)):\n    print( 'Pre : ' + my_dic[np.argmax(predictions[i])]  )","4c3c1fd9":"z , lab = pre_process('sample_submission_ns2btKE')\npredictions = model.predict(z)\n\n%matplotlib inline\nimport matplotlib.pyplot as plt\n\nvar = 0\nprint(my_dic[lab[var]])\n\nplt.imshow(z[var])\nplt.xlabel( ' Actuall :  ' + my_dic[lab[var]] )\nplt.ylabel( 'Predicted : ' + my_dic[np.argmax(predictions[var])] )\n\nplt.show()","021a7bfa":"# ***Checking model on samplefile.csv and plotting images ***","f7ad5e68":"# Model Creation using 4 convolutional layers and checking accuracy of model**********","9ddecf5e":"* ***SPLITTING TRAIN DATA***","69a49bd6":"* ***Saving model as h5 format***","9b006958":"# Ship classifier using convolutional neural net****","196c11c6":"* ***Importing Modules***\n","2975cae1":"* ***Loading as keras data set***","fe170469":"# ***Making predictions on Test sample ***","c037ce80":"* ***Data Preprocessing and joining to convert all images from train.csv\nto a numpy array and making them all of same size  ***"}}