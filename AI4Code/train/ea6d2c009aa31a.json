{"cell_type":{"24d199ef":"code","2299734a":"code","3346f038":"code","6f530431":"code","40117cea":"code","91187c8b":"code","e1176588":"code","93f5f0ae":"code","6b4e0305":"code","e32d69c4":"code","9aa7d54e":"code","41387c8c":"code","1a4d0bb2":"code","268d37e5":"code","83555f7e":"markdown","6c9e07bc":"markdown","ec54fd13":"markdown","6a4d0b92":"markdown","187d86c2":"markdown","72f8b3de":"markdown","bd3bb028":"markdown","81569257":"markdown","fa61731b":"markdown","1be5de10":"markdown","97e35c11":"markdown","4158dc30":"markdown","77d514f7":"markdown","03a10183":"markdown","79ae48b9":"markdown","8f411ad8":"markdown","a5d43358":"markdown","617adee3":"markdown"},"source":{"24d199ef":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nimport cv2\nimport os\nfrom tqdm import tqdm\nimport tensorflow as tf\nimport pickle\n\ntest = pd.read_csv('..\/input\/petfinder-pawpularity-score\/test.csv')\ntest_images_path = '..\/input\/petfinder-pawpularity-score\/test'\ntest_images_list = os.listdir(test_images_path)\nsample_submission = pd.read_csv('..\/input\/petfinder-pawpularity-score\/sample_submission.csv')\nprint('Total Number of Testing Images : ',len(test_images_list))","2299734a":"test_images = []\nfor i in tqdm(test_images_list):\n    path = os.path.join(test_images_path,i)\n    image = cv2.imread(path)\n    image = image \/ 255\n    image = cv2.resize(image,(128,128))\n    test_images.append(image)\ntest_images = np.array(test_images)  \nprint(len(test_images))","3346f038":"from tensorflow.keras.applications.vgg16 import VGG16\nmodel = VGG16(weights = '..\/input\/vgg16-no-top-weights\/vgg16_weights_tf_dim_ordering_tf_kernels_notop.h5',include_top=False,input_shape=(128,128,3))\nfor layer in model.layers:\n    layer.trainable = False\n    \ntest_feature_extractor = model.predict(test_images)\ntest_features = test_feature_extractor.reshape(test_feature_extractor.shape[0],-1)","6f530431":"print('Input to Feature Extractor Shape : ',test_images.shape)\nprint('Output of Feature Extractor Shape : ',test_feature_extractor.shape)\nprint('Input to Machine Learning Algorithm Shape',test_features.shape)","40117cea":"pickle_filename = '..\/input\/k\/tanmay111999\/training-notebook\/lr_pickle.pkl'\nwith open(pickle_filename, 'rb') as file:  \n    lr = pickle.load(file)","91187c8b":"prediction = lr.predict(test_features)\nsubmission = pd.DataFrame()\nsubmission['Id'] = test['Id']\nsubmission['Pawpularity'] = prediction * 100\nsubmission.to_csv('submission.csv',index = False)","e1176588":"pickle_filename = '..\/input\/k\/tanmay111999\/training-notebook\/svr_pickle.pkl'\nwith open(pickle_filename, 'rb') as file:  \n    svr = pickle.load(file)","93f5f0ae":"prediction = svr.predict(test_features)\nsubmission = pd.DataFrame()\nsubmission['Id'] = test['Id']\nsubmission['Pawpularity'] = prediction * 100\nsubmission.to_csv('submission.csv',index = False)","6b4e0305":"pickle_filename = '..\/input\/k\/tanmay111999\/training-notebook\/xgb_pickle.pkl'\nwith open(pickle_filename, 'rb') as file:  \n    xgb = pickle.load(file)","e32d69c4":"prediction = xgb.predict(test_features)\nsubmission = pd.DataFrame()\nsubmission['Id'] = test['Id']\nsubmission['Pawpularity'] = prediction * 100\nsubmission.to_csv('submission.csv',index = False)","9aa7d54e":"pickle_filename = '..\/input\/k\/tanmay111999\/training-notebook\/lgbm_pickle.pkl'\nwith open(pickle_filename, 'rb') as file:  \n    lgbm = pickle.load(file)","41387c8c":"prediction = lgbm.predict(test_features)\nsubmission = pd.DataFrame()\nsubmission['Id'] = test['Id']\nsubmission['Pawpularity'] = prediction * 100\nsubmission.to_csv('submission.csv',index = False)","1a4d0bb2":"pickle_filename = '..\/input\/k\/tanmay111999\/training-notebook\/stack_pickle.pkl'\nwith open(pickle_filename, 'rb') as file:  \n    stack = pickle.load(file)","268d37e5":"prediction = stack.predict(test_features)\nsubmission = pd.DataFrame()\nsubmission['Id'] = test['Id']\nsubmission['Pawpularity'] = (prediction * 100)\nsubmission.to_csv('submission.csv',index = False)","83555f7e":"## <center>Support Vector Regressor<\/center>","6c9e07bc":"## <center>Create Test Image Batches<\/center>","ec54fd13":"## <center>Conclusion<\/center>\n\n1. Pickle files are a great help.\n2. Model Performance Table :\n\n| Model  |  RMSE Submission Score |  O\/P Values |\n| :--- | :---: | ---: |\n|   LR   | 104.44  | Negative Values  |\n|  SVR   | 20.72 | 32 - 34  |\n|  XGB   | 20.95 | 42 - 43  |\n|  LGBM  | 20.48 | 37 - 38  |\n|  STACK | 20.49 | 37 - 38  |\n\n3. LGBM recorded the lowest RMSE scores.\n\nLinks :\n1. [Training Notebook](https:\/\/www.kaggle.com\/tanmay111999\/feature-extractor-ml-algo-infer)\n2. [Discussion Post](https:\/\/www.kaggle.com\/c\/petfinder-pawpularity-score\/discussion\/279212)","6a4d0b92":"- Values ranged from 37 - 38\n- Submission Score : 20.49","187d86c2":"### <font color = 'red'>Note<\/font> : Below cells were executed at different times, these cells were commented & executed once again before publishing. Thus, you won't be able to see the outputs.","72f8b3de":"## <center>Import The Necessary Libraries & Define Data Access Variables <\/center>","bd3bb028":"- Predicted values ranged from 32 - 34 \n- Submission Score : 20.72","81569257":"- Predicted Values ranged from 42 - 43  \n- Submission Score : 20.95","fa61731b":"## <center>Stack : Linear Regression, Support Vector Regressor, Xgboost Regressor, LGBM Regressor<\/center>","1be5de10":"- Negative Values predicted\n- Submission Score : 104.44","97e35c11":"## <center>Linear Regression<\/center>","4158dc30":"- Values ranged from 37 - 38\n- Submission Score : 20.48","77d514f7":"## <center>Feature Extractor : VGG16 + ML Algorithm [Inference Notebook]<\/center>\n\n### <center>Welcome Curious Reader!<\/center>\n\n- You are now going to explore and understand this Inference Notebook created for the competition : [PetFinder.my - PawPularity](https:\/\/www.kaggle.com\/c\/petfinder-pawpularity-score)\n    \n- This competition opens the door for facing the challenge of using Image Data & Categorical Data to predict a Continuous Value. \n\n- **Aim** : To understand the use of pickle files to load trained ML models and predict output values for submission purposes.","03a10183":"## <center>Prediction<\/center>","79ae48b9":"## <center>If you like the content of the notebook, please do upvote!<\/center>\n### <center>Feedback is appreciated!<\/center>\n### <center>Stay Safe!<\/center>","8f411ad8":"## <center>LGBM Regressor<\/center>","a5d43358":"## <center>Xgboost Regressor<\/center>","617adee3":"### <center>VGG16 : Feature Extractor<\/center>"}}