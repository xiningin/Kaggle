{"cell_type":{"8b41c277":"code","de4be3be":"code","48dd5e6f":"code","738b1e29":"code","af58df5b":"code","c34de7bb":"code","999d805b":"code","0f158b8f":"code","74842902":"code","aae2c9d0":"markdown"},"source":{"8b41c277":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom glob import glob\n\npd.set_option('display.max_rows', 500)\npd.set_option('display.max_columns', 500)\npd.set_option('display.width', 1000)\n\ndata = sorted(glob('..\/input\/covid-and-crime\/*metropolitan-street.csv'))\n\ncrimes = pd.concat((pd.read_csv(file).assign(filename = file)\n          for file in data), ignore_index = True)\n\n# By default, the Month columns contains the year and month in the format yyyy-mm\n# Create a new Year column from the Month column and\n# update the Month column so that it only contains the Month value,\n\ncrimes['Year'] =  crimes.Month.str.slice(0,4)\ncrimes['Month'] = crimes.Month.str.slice(5)\n\n# Split the 'LSOA name' column using rpartition()\n# rpartition results in a dataframe ('result') comprising 3 columns;\n# [0] The Region [1] A Space [2] The LSOA Code\n# Use column [0] to create a new Region column\n\nresult = crimes['LSOA name'].str.rpartition()\ncrimes['Region'] = result[0]\n\n# Drop the columns we don't need to simplify the dataframe\ncrimes.drop(['Crime ID', 'Reported by','Falls within', 'Longitude', 'Latitude', 'Location', 'LSOA code', 'LSOA name', 'Last outcome category', 'Context', 'filename'], axis=1, inplace=True)\n\n# Tidy up the columns names, removing spaces and capitalizing correctly.\ncolumns_headings = ['Month', 'Crime_Type', 'Year', 'Region']\ncrimes.columns = columns_headings\n\n# Reorder the columns using '.reindex' \nneworder = ['Region','Year','Month','Crime_Type']\ncrimes=crimes.reindex(columns=neworder)\n","de4be3be":"# Understanding the Missing Data \/ NaN Values\n# crimes.shape # Reports 1,181,922 rows\n\nwith_region = crimes.Region.notna().sum()\nwithout_region = crimes.Region.isna().sum()\ntotal_crimes = crimes.Crime_Type.count()\n\npercentage_missing = (without_region \/ total_crimes)\npercentage_complete = (with_region \/ total_crimes)\n\nfstring = f'Total Crimes: {total_crimes:,}\\n'\nfstring = fstring + f'Crimes with region: {with_region:,}\\nCrimes missing region: {without_region:,}\\n'\nfstring = fstring  + f'Percentage missing Region: {percentage_missing:.2%}\\n'\nfstring = fstring  + f'Percentage with Region: {percentage_complete:.2%}'\nprint(fstring)","48dd5e6f":"# Count Crimes by Region then Sort Descending\n# The top 33 values will (should) contain all the London Boroughs\nregion_summary = crimes.groupby(['Region']).Region.count()\nsorted_region_summary = region_summary.sort_values(ascending=False)\ndata = sorted_region_summary.head(33)\nboroughs = data.index.to_list()\n\n# Create one dataframe for Met Crimes and one for all others\nmet_crimes = crimes.loc[crimes.Region.isin(boroughs)]\nnon_met_crimes = crimes.loc[~crimes.Region.isin(boroughs)]","738b1e29":"year = '2020'\ncrime = 'Anti-social behaviour'\n\nplot_data = met_crimes.loc[(met_crimes.Year==year)&(met_crimes.Crime_Type==crime), :].groupby(['Region','Month']).Crime_Type.count().reset_index()\nplot_data.columns=['Region', 'Month', 'Count']\nplot_data.head()","af58df5b":"df = plot_data.pivot(index='Month', columns='Region', values='Count')\ndf.head()","c34de7bb":"df2 = plot_data.pivot(index='Region', columns='Month', values='Count')\ndf2.head()","999d805b":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nplt.rcParams['figure.figsize'] = (25,20)\n# plt.rcParams['legend.loc'] = 1\nplt.xticks(fontsize = 20)\nplt.yticks(fontsize = 20)\n\nsns.set(font_scale = 10)\nsns.set_theme(style=\"ticks\")\nsns.set_context(\"paper\")\nsns.color_palette(\"Spectral\", as_cmap=True)\n\nmychart = sns.lineplot(data=df, linewidth=1.5, dashes=False)\nmychart.set_title((crime + ' by Month ' + '(' + year + ')'), fontsize = 25)\nmychart.set_xlabel(\"Month\", fontsize = 25)\nmychart.set_ylabel(\"Count\", fontsize = 25)\n\n# mychart.legend(loc = 2, bbox_to_anchor= (1,.75,0.1,0.1), fontsize = 15, shadow = True )\nmychart.legend(loc = 2,  bbox_to_anchor= (0.001,1), fontsize = 13, shadow = True )\n\nplt.savefig('lineplot.png')","0f158b8f":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nplt.rcParams['figure.figsize'] = (25,20)\n# plt.rcParams['legend.loc'] = 1\nplt.xticks(fontsize = 20)\nplt.yticks(fontsize = 20)\n\nsns.set(font_scale = 10)\nsns.set_theme(style=\"darkgrid\")\nsns.set_context(\"paper\")\n\nmychart = sns.boxplot(data=df2, palette='Paired')\nmychart.set_title((crime + ' by Month ' + '(' + year + ')'), fontsize = 25)\nmychart.set_xlabel(\"Month\", fontsize = 25)\nmychart.set_ylabel(\"Count\", fontsize = 25)\n\nplt.savefig('boxplot.png')","74842902":"# The purpose of this chart is to show a heat map plotting instances of Anti-Social Behaviour against each London Borough during the course of 2020\n# For reference; The first national lockdown was introduced in April 2020.\n\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nplt.rcParams['figure.figsize'] = (25,20)\n# plt.rcParams['legend.loc'] = 1\nplt.xticks(fontsize = 15)\nplt.yticks(fontsize = 15)\n\nsns.set(font_scale = 10)\nsns.set_theme(style=\"darkgrid\")\nsns.set_context(\"paper\")\n\n#df2.drop(['Poverty'], axis=1, inplace=True)\nmychart = sns.heatmap(data=df2, cmap=\"icefire\")\n\nmychart.set_title((crime + ' (' + year + ')'), fontsize = 25)\nmychart.set_xlabel(\"Month\", fontsize = 20)\nmychart.set_ylabel(\"Borough\", fontsize = 20)\n\nplt.savefig('boxplot.png')","aae2c9d0":"# COVID and Crime Analysis\n## Understanding the impact of COVID and Lockdown on Street Crime in 2020\nTaking a look at street crime data in London for 2020, to understand what impact the COVID pandemic and subsequent lockdowns might have had on reported crime.\n\n> Note: This is work in progress\n\n![](https:\/\/www.notion.so\/image\/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F4f06a8f1-d0f4-43d3-bda6-452b5e7dc3cd%2FCharts-100721.png?table=block&id=b27605c8-8f25-47ee-bdea-a5839282b77b&spaceId=2211d575-debd-4659-b52c-32746d4222d1&width=4320&userId=96fcdb4b-dc90-48e3-9a12-7ecb7a9febac&cache=v2)\n"}}