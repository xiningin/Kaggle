{"cell_type":{"f93ad88b":"code","1d3787d7":"code","dc7a5801":"code","7e7816b2":"code","a47d47be":"code","cbd8a590":"code","f75704ed":"code","d0bfa53a":"code","8fe80102":"code","15ed21e0":"code","a8644676":"code","2b01adfe":"code","87aa0e22":"code","a747004c":"code","a74b5cf3":"code","5d89dbc0":"code","6e383b88":"code","66b708ac":"code","ca3d2598":"code","eb002912":"code","63f4b2d9":"code","3742ef1a":"code","a95d0887":"code","29fa1c31":"code","c5d968ae":"markdown","43e8fba4":"markdown","105b5dcc":"markdown","b356f58e":"markdown","2b68260b":"markdown","792519bb":"markdown","cb9f4df1":"markdown","818814c1":"markdown","ba744897":"markdown","8a1fe1f5":"markdown","6c43ee51":"markdown","7dcbe749":"markdown","fe932687":"markdown","b6d49a8f":"markdown","8f27cf9e":"markdown","2cc6c53d":"markdown","50501042":"markdown","f1221b93":"markdown"},"source":{"f93ad88b":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport numpy as np\nimport warnings\nfrom sklearn.model_selection import train_test_split\nimport keras\nfrom keras.layers import Dense,Conv2D,Flatten,MaxPool2D,BatchNormalization\nfrom keras.callbacks import EarlyStopping,LearningRateScheduler,ReduceLROnPlateau\nfrom keras.optimizers import SGD,RMSprop\nfrom sklearn.metrics import classification_report,confusion_matrix\nfrom keras.models import Sequential\nwarnings.filterwarnings('ignore')","1d3787d7":"data=pd.read_csv('..\/input\/age-gender-and-ethnicity-face-data-csv\/age_gender.csv')\ndata.head()","dc7a5801":"def value_to_image(pixels):\n    pixels=np.array(pixels.split(),'float64')\n    pixels=np.reshape(pixels,(48,48))\n    pixels=pixels\/255.0\n    return pixels\ndata['pixels']=data['pixels'].apply(value_to_image)","7e7816b2":"train_img,test_img,train_gender,test_gender=train_test_split(data['pixels'],data['gender'],test_size=0.15,random_state=42)","a47d47be":"gender_names=train_gender.replace({0:'Male',1:'Female'})","cbd8a590":"plt.figure(figsize=(20,15))\nfor i in range(0,8):\n    plt.subplot(2,4,(i%8)+1)\n    num=np.random.randint(1000)\n    plt.title(\"image no.{0} , gender:-{1}\".format(i+1,gender_names.iloc[num]))\n    plt.imshow(train_img.iloc[num],cmap='gray')\nplt.show()","f75704ed":"def change_image_dimension(data):\n    data=np.reshape(data.to_list(),(len(data),48,48,1))\n    return data","d0bfa53a":"train_img=change_image_dimension(train_img)\ntest_img=change_image_dimension(test_img)\n# train_img\ntrain_img=train_img\/255.0\ntest_img=test_img\/255.0","8fe80102":"early_stop=EarlyStopping(monitor='val_accuracy',patience=3)\nreducelr=ReduceLROnPlateau(monitor='val_accuracy',patience=1,min_lr=0.000001)","15ed21e0":"model=Sequential()\nmodel.add(Conv2D(256,(3,3),activation='relu',padding='same',input_shape=(48,48,1)))\nmodel.add(MaxPool2D(2,2))\nmodel.add(BatchNormalization())\nmodel.add(Conv2D(64,(3,3),activation='relu',padding='same'))\nmodel.add(MaxPool2D(2,2))\nmodel.add(BatchNormalization())\nmodel.add(Conv2D(32,(3,3),activation='relu',padding='same'))\nmodel.add(MaxPool2D(2,2))\nmodel.add(BatchNormalization())\nmodel.add(Flatten())\nmodel.add(Dense(512,activation='relu'))\nmodel.add(Dense(64,activation='relu'))\nmodel.add(Dense(1,activation='sigmoid'))","a8644676":"model.compile(optimizer=SGD(0.01),loss='binary_crossentropy',metrics=['accuracy'])\nr2=model.fit(train_img,train_gender,validation_data=(test_img,test_gender),epochs=20,callbacks=[reducelr,early_stop])","2b01adfe":"model.summary()","87aa0e22":"plt.plot(r2.history['loss'])\nplt.plot(r2.history['val_loss'])","a747004c":"plt.plot(r2.history['accuracy'])\nplt.plot(r2.history['val_accuracy'])","a74b5cf3":"pred_train_gender=model.predict_classes(train_img)\npred_test_gender=model.predict_classes(test_img)","5d89dbc0":"cm_train=confusion_matrix(train_gender,pred_train_gender)\ncm_test=confusion_matrix(test_gender,pred_test_gender)","6e383b88":"sns.heatmap(cm_train,annot=True)\nplt.show()","66b708ac":"sns.heatmap(cm_test,annot=True)\nplt.show()","ca3d2598":"train_gender=np.array(train_gender,'int32')\npred_train_gender=np.reshape(pred_train_gender,(len(train_gender),))\ntrain_gender=np.reshape(train_gender,(len(train_gender),))","eb002912":"misclassified_train_index=np.where(train_gender!=pred_train_gender)\nimages=np.reshape(train_img,(len(train_img),48,48))","63f4b2d9":"plt.figure(figsize=(20,15))\nfor i in range(0,5):\n    plt.subplot(1,4,(i%4)+1)\n    pred='Male' if pred_train_gender[misclassified_train_index[0][i]]==0 else 'Female'\n    actual='Male' if train_gender[misclassified_train_index[0][i]]==0 else 'Female'\n    plt.title(\"classified as {0} but the person is {1}\".format(pred,actual))\n    plt.imshow(images[misclassified_train_index[0][i]],cmap='gray')\nplt.show()","3742ef1a":"test_gender=np.array(test_gender,'int32')\npred_test_gender=np.reshape(pred_test_gender,(len(test_gender),))\ntest_gender=np.reshape(test_gender,(len(test_gender),))","a95d0887":"pred_test_gender=np.reshape(pred_test_gender,(len(test_gender),))\nmisclassified_test_index=np.where(test_gender!=pred_test_gender)\ntest_images=np.reshape(test_img,(len(test_img),48,48))","29fa1c31":"plt.figure(figsize=(20,15))\nfor i in range(0,5):\n    plt.subplot(1,4,(i%4)+1)\n    pred='Male' if pred_test_gender[misclassified_test_index[0][i]]==0 else 'Female'\n    actual='Male' if test_gender[misclassified_test_index[0][i]]==0 else 'Female'\n    plt.title(\"classified as {0} but the person is {1}\".format(pred,actual))\n    plt.imshow(images[misclassified_test_index[0][i]],cmap='gray')\nplt.show()","c5d968ae":"<h1 style=\"background-color:lightgreen;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;padding: 3px\">Changing Dimension Of Data<\/h1>\n<a id=4><\/a>","43e8fba4":"<center><img src=\"https:\/\/miro.medium.com\/max\/875\/1*8-1QrV3nlRjTFlDRJs2swg.jpeg\",height='500',width='600'><\/center>\n","105b5dcc":"<h1 style=\"background-color:lightgreen;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;padding: 3px\">Model Summary<\/h1>\n<a id=7><\/a>","b356f58e":"<h1 style=\"background-color:lightgreen;font-family:newtimeroman;font-size:400%;text-align:center;padding: 3px\">CONCLUSION<\/h1>\n<h3 style=\"background-color:lightblue;font-family:newtimeroman;font-size:200%;text-align:center;padding: 3px\">We can see that the model predicts quite well with accuracy on test data as about 90% and train data accuracy of about 93%<\/h3>\n<a id=13><\/a>","2b68260b":"<h1 style=\"background-color:lightgreen;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;padding: 3px\">Visualizing Mispredicted Training Examples<\/h1>\n<a id=11><\/a>","792519bb":"<h1 style=\"background-color:lightgreen;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;padding: 3px\">Callback Functions<\/h1>\n<a id=5><\/a>","cb9f4df1":"<h4 style=\"background-color:lightyellow;font-family:newtimeroman;font-size:200%;text-align:center;padding: 3px\">If you liked the notebook.. please upvote and if have any query feel free to ask in comment section.<\/h4>\n","818814c1":"<h1 style=\"background-color:lightgreen;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;padding: 3px\">Plotting Losses<\/h1>\n<a id=8><\/a>","ba744897":"<h1 style=\"background-color:lightgreen;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;padding: 3px\">OverView <\/h1>\n<a id=0><\/a>","8a1fe1f5":"<h1 style=\"background-color:lightgreen;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;padding: 3px\">Plotting Accuracy<\/h1>\n<a id=9><\/a>","6c43ee51":"<h1 style=\"background-color:lightgreen;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;padding: 3px\">Confusion Matrix<\/h1>\n<a id=10><\/a>","7dcbe749":"<h1 style=\"background-color:lightgreen;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;padding: 3px\">Convolutional Neural Network<\/h1>\n<a id=5><\/a>","fe932687":"<h1 style=\"background-color:lightgreen;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;padding: 3px\">Visualizing Mispredicted Test Examples<\/h1>\n<a id=12><\/a>","b6d49a8f":"<h1 style=\"background-color:lightgreen;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;padding: 3px\">Visualising Data<\/h1>\n<a id=3><\/a>","8f27cf9e":"<h1 style=\"background-color:pink;font-family:newtimeroman;font-size:550%;text-align:center;border-radius: 15px 50px;padding: 5px\">GENDER PREDICTION<\/h1>\n","2cc6c53d":"In this dataset our main objective is to predict the gender of the person by analysing his\/her images. Here we have about 24k labeled examples, by using this we have to make a generalised model for predicting the gender of the person. The column pixels contains the value of pixels of the image in string format separated by a space. For gender column 0 represents 'Male' and 1 represents 'Female'.","50501042":"<h1 style=\"background-color:lightgreen;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;padding: 3px\">Importing modules and Loading datasets<\/h1>\n<a id=1><\/a>","f1221b93":"<h1 style=\"background-color:lightgreen;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;padding: 3px\">Train test spliting of data<\/h1>\n<a id=2><\/a>"}}