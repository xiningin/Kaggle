{"cell_type":{"25f9102a":"code","9f3445f2":"code","d03ddf94":"code","50b17d09":"code","9d6bd4a5":"code","aa2284bd":"code","f923bd0c":"code","d797c147":"code","8cafe97b":"code","36db7f24":"code","79e62498":"code","e1651dff":"code","66e8e443":"code","4a4c041c":"code","455cce52":"code","7d879881":"code","35e0b405":"code","bbd9b4fb":"code","e36988d9":"code","9c842409":"code","70b28564":"code","4fa47110":"code","3f562e39":"code","f59b404b":"code","9c4c0a70":"code","91f9a4f4":"code","9553bcb4":"code","a83b9f09":"code","6b6cbfb4":"code","ddf7c445":"code","59a1c688":"code","ed93107b":"code","5a4c3534":"code","d69419dd":"code","d5516436":"code","ace0a1f5":"code","e89abe5a":"code","0eeb3c5a":"code","c48a1b47":"code","80bf216e":"code","4e275ded":"code","234982ba":"code","1ab5c49f":"code","d6206af9":"code","54930845":"code","6659a816":"code","d1c9930a":"code","6bb08327":"code","8e48e2da":"code","c5966c77":"code","3e29e239":"code","f7d42cb0":"code","2af20d7e":"markdown","a65488a7":"markdown","44a11f9d":"markdown","9c5c844a":"markdown","d9e4176f":"markdown","5c697814":"markdown","76cfb65e":"markdown","50723084":"markdown","175abdc6":"markdown","392fa66e":"markdown","883996e6":"markdown","0764ed0c":"markdown","b2c2cfa5":"markdown","4b4f3272":"markdown","b3c428fb":"markdown","77970844":"markdown","62effc55":"markdown","3eefbfd0":"markdown","f5b0be2b":"markdown","042a3d9c":"markdown","c81c8862":"markdown","e035f80d":"markdown"},"source":{"25f9102a":"# Manipula\u00e7\u00e3o de Dados:\n\nimport pandas as pd \nimport numpy as np\n\n# Visualiza\u00e7\u00e3o Gr\u00e1fica:\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns \n\n#Pr\u00e9-processamento de dados:\nfrom sklearn.model_selection import train_test_split\nfrom  sklearn.preprocessing import StandardScaler\nfrom sklearn import metrics\n\n# Modelos \nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import confusion_matrix, classification_report \nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom catboost import CatBoostClassifier \nfrom sklearn.ensemble import GradientBoostingClassifier\n","9f3445f2":"ds = pd.read_csv(\"..\/input\/hepatitis-c-dataset\/HepatitisCdata.csv\")\nds.head()","d03ddf94":"print(ds.describe())","50b17d09":"ds['Category'].value_counts()","9d6bd4a5":"ds['Sex'].value_counts()","aa2284bd":"# Excluindo valores nulos (na):\nds.dropna(inplace= True)\nds.info()","f923bd0c":"# Separar os dados entre as pessoas Saud\u00e1veis e as Doentes:\nds[\"Category\"].loc[ds[\"Category\"].isin([\"1=Hepatitis\",'2=Fibrosis','3=Cirrhosis'])] = 1\nds[\"Category\"].loc[ds['Category'].isin(['0=Blood Donor',\"0s=suspect Blood Donor\"])] = 0 ","d797c147":"plt.figure(figsize=(9,9))\nsns.histplot(ds[\"Age\"])\nplt.title('Distribui\u00e7\u00e3o da Idade')\nplt.show()","8cafe97b":"plt.figure(figsize=(9,9))\nsns.histplot(ds[['Age', 'Category']], x = \"Age\", hue=\"Category\")\nplt.title(\"Distribui\u00e7\u00e3o da Categoria por idade\")\nplt.show()","36db7f24":"# Separando os dados por Sexo:\ndh = ds.loc[ds.Sex == 'm']\ndm = ds.loc[ds.Sex == 'f']","79e62498":"dh['Category'].value_counts(normalize=True)","e1651dff":"dm['Category'].value_counts(normalize=True)","66e8e443":"x = np.arange(2)\nbarWidht = 0.25\nplt.bar(x,dh['Category'].value_counts(normalize=True),width=0.25, color= 'b',label = \"Homem\" )\nplt.bar(x+barWidht,dm['Category'].value_counts(normalize=True), width= 0.25, color='r', label=\"Mulher\")\nlocal = x+barWidht\nlabels = ['Doente','Saudavel']\nplt.xticks(local,labels)\nplt.legend()","4a4c041c":"colunas = ds.columns[4:]\nfig, ax = plt.subplots(nrows=len(colunas), ncols=1, sharex=True, figsize = (10,30))\nX = ds['Age']\nfor i in range(len(colunas)):\n  y = ds[colunas[i]]\n  scatter = ax[i].scatter(x = X, y = y, c = ds['Category'], cmap='winter')\n  ax[i].set(title=f'{colunas[i]} por idade', xlabel=\"Age\", ylabel=colunas[i])\n  ax[i].legend(*scatter.legend_elements(), title = 'Hepatite')\nplt.subplots_adjust(hspace=1)\nfig.suptitle(\"An\u00e1lise Hepatite C\", size= 20)","455cce52":"ds[\"Sex\"] = ds['Sex'].map({'m':1,'f':2})\nds.head()","7d879881":"ds['Category']=ds['Category'].astype(float)","35e0b405":"ds=ds.drop('Unnamed: 0', axis=1)","bbd9b4fb":"# Correla\u00e7\u00e3o entre os Dados:\n \nfig, ax = plt.subplots(figsize=(8,9))\nsns.heatmap(ds.corr(), annot=True, fmt='.1g', cmap=\"crest\")","e36988d9":"print ( f'Total de Pacientes Suspeitos: {ds.Category.value_counts()[1]}')\nprint(f'Total de Pacientes Saud\u00e1veis: {ds.Category.value_counts()[0]}')","9c842409":"# Compara\u00e7\u00e3o entre pacientes Saud\u00e1veis e suspeitos:\n\nplt.style.use('seaborn')\nfig,ax = plt.subplots(figsize=(8,8))\nplt.pie(x= ds['Category'].value_counts(),\n        colors=['turquoise','salmon'],\n        labels=['Pacientes Saud\u00e1veis',\"Pacientes Suspeitos\"],\n        shadow= True,\n        explode = (0,0.1)\n        \n        )\nplt.show()","70b28564":"ds.Sex.value_counts()","4fa47110":"plt.style.use('seaborn')\nfig,ax = plt.subplots(figsize=(8,8))\nplt.pie(x=ds['Sex'].value_counts(),\n        colors=[\"forestgreen\",'tomato'],\n        labels=[\"Homens\", \"Mulheres\"],\n        shadow = True,\n        autopct =\"%1.2f%%\",\n        explode=(0,0.1)\n)\nplt.show()","3f562e39":" # X\nX = ds.drop(\"Category\",axis=1)\nX.head()","f59b404b":"# Y \ny = ds['Category']\ny.head()","9c4c0a70":"x_train, x_test, y_train, y_test = train_test_split(X,y, test_size = 0.2, random_state=42)\n","91f9a4f4":"len(x_test), len(x_train)","9553bcb4":"# Scalando os dados:\n\nscaler = StandardScaler()\nx_train = scaler.fit_transform(x_train)\nx_test= scaler.transform(x_test)","a83b9f09":"lr = LogisticRegression()\nlr.fit(x_train,y_train)","6b6cbfb4":"LogisticRegressionScore = lr.score(x_test, y_test)\nprint(f'Precis\u00e3o do modelo LogisticRegression: {LogisticRegressionScore}')","ddf7c445":"y_pred_lr = lr.predict(x_test)\nmatrix_lr = confusion_matrix(y_test, y_pred_lr)\nsns.heatmap(matrix_lr, annot=True, cmap='flare')","59a1c688":"# Dados precis\u00e3o do modelo:\n\nprint(metrics.classification_report(y_test, y_pred_lr))","ed93107b":"rfc = RandomForestClassifier()\nrfc.fit(x_train, y_train)","5a4c3534":"RandomForestClassifierScore = rfc.score(x_test, y_test)\nprint(f'Precis\u00e3o do modelo RandomForestClassifier: {RandomForestClassifierScore}')","d69419dd":"y_pred_rfc = rfc.predict(x_test)\nmatrix_rfc = confusion_matrix(y_test, y_pred_rfc)\nsns.heatmap(matrix_rfc, annot=True, cmap=\"PuOr\")","d5516436":"print(metrics.classification_report(y_test, y_pred_rfc))","ace0a1f5":"knc = KNeighborsClassifier()\nknc.fit(x_train, y_train)","e89abe5a":"KNeighborsClassifierScore = knc.score(x_test, y_test)\nprint(f'Precis\u00e3o do Modelo KNC: {KNeighborsClassifierScore}')","0eeb3c5a":"y_pred_knc = knc.predict(x_test)\nmatrix_knc = confusion_matrix(y_test, y_pred_knc)\nsns.heatmap(matrix_knc, annot=True, cmap='PuRd')","c48a1b47":"print(metrics.classification_report(y_test,y_pred_knc))","80bf216e":"tree = DecisionTreeClassifier()\ntree.fit(x_train, y_train)","4e275ded":"DecisionTreeClassifierScore = tree.score(x_test, y_test)\nprint(f'Precis\u00e3o do modelo DTC: {DecisionTreeClassifierScore}')","234982ba":"y_pred_tree = tree.predict(x_test)\nmatrix_tree = confusion_matrix(y_test, y_pred_tree)\nsns.heatmap(matrix_tree, annot=True, cmap='winter')","1ab5c49f":"print(metrics.classification_report(y_test, y_pred_tree))","d6206af9":"cat = CatBoostClassifier(iterations= 10)\ncat.fit(x_train, y_train)","54930845":"CatBoostClassifierScore= cat.score(x_test,y_test)\nprint(f'Precis\u00e3o do modelo CBC: {CatBoostClassifierScore}')","6659a816":"y_pred_cat = cat.predict(x_test)\nmatrix_cat = confusion_matrix(y_test, y_pred_cat)\nsns.heatmap(matrix_cat, annot=True, cmap='gist_earth')","d1c9930a":"print(metrics.classification_report(y_test,y_pred_cat))","6bb08327":"gbc =  GradientBoostingClassifier()\ngbc.fit(x_train, y_train)","8e48e2da":"GradientBoostingClassifierScore = gbc.score(x_test,y_test)\nprint(f'Precis\u00e3o do modelo GBC: {GradientBoostingClassifierScore}')","c5966c77":"y_pred_gbc = gbc.predict(x_test)\nmatrix_gbc = confusion_matrix(y_test,y_pred_gbc)\nsns.heatmap(matrix_gbc, annot=True, cmap='brg')","3e29e239":"print(metrics.classification_report(y_test, y_pred_gbc))","f7d42cb0":"plt.style.use('seaborn')\n\nX = ['LogisticRegression', \n     \"DecisionTreeClassifier\",\n     'RandomForestClassifier',\n     \"KNeighborsClassifier\",\n     'CatBoostClassifier',\n     'GradientBoostingClassifier']\n\ny = [LogisticRegressionScore, \n     DecisionTreeClassifierScore,\n     RandomForestClassifierScore,\n     KNeighborsClassifierScore,\n     CatBoostClassifierScore,\n     GradientBoostingClassifierScore]\n\nfig,ax= plt.subplots(figsize=(10,8))\nsns.barplot(x=X, y=y, palette='crest')\nplt.ylabel('Precis\u00e3o do Modelo')\nplt.xticks(rotation=40)\nplt.title('Compara\u00e7\u00e3o de Modelos')\n","2af20d7e":"<div style=\"background-color:#99EEAA; color:#000066;\">\n    <h4><center>Confussion Matrix para RL<\/center><\/h4>\n<\/div>\n","a65488a7":"\n<div style=\"background-color:#99EEAA; color:#000066;\">\n    <h4><center>   Confusion Matrix para DTC <\/center><\/h4>\n<\/div>","44a11f9d":"<div style=\"background-color:#99EEAA; color:#000066;\">\n    <h2><center> Visualiza\u00e7\u00e3o dos Dados:  <\/center><\/h2>\n<\/div>\n","9c5c844a":"\n<div style=\"background-color:#99EEAA; color:#000066;\">\n    <h2><center> Relat\u00f3rio Final:  <\/center><\/h2>\n<\/div>\n\n* O modelo de classifica\u00e7\u00e3o que apresentou melhor performance tendo como par\u00e2mentro a precis\u00e3o foi o CatBoostClassifier.","d9e4176f":"<div style=\"background-color:#99EEAA; color:#000066;\">\n    <h3><center> Decision Tree Classifier:  <\/center><\/h3>\n<\/div>\n","5c697814":"<div style=\"background-color:#99EEAA; color:#000066;\">\n    <h3><center> K Neighbors Classifier:  <\/center><\/h3>\n<\/div>\n ","76cfb65e":"\n<div style=\"background-color:#99EEAA; color:#000066;\">\n    <h3><center> Gradient Boosting Classifier:  <\/center><\/h3>\n<\/div>","50723084":"\n<div style=\"background-color:#99EEAA; color:#000066;\">\n    <h4><center>   Confusion Matrix para GBC: <\/center><\/h4>\n<\/div>","175abdc6":"<div style=\"background-color:#99EEAA; color:#000066;\">\n    <h4><center>Confusion Matrix para KNC   <\/center><\/h4>\n<\/div>\n","392fa66e":"<div style=\"background-color:#99EEAA; color:#000066;\">\n    <h2><center>Modelagem:<\/center><\/h2>\n<\/div>","883996e6":"<div style=\"background-color:#99EEAA; color:#000066;\">\n    <h3><center> Random Forest Classifier  <\/center><\/h3>\n<\/div>\n\n","0764ed0c":"Dividindo os Dados de Treino e Teste:","b2c2cfa5":"\n<div style=\"background-color:#99EEAA; color:#000066;\">\n    <h3><center>  CatBoost Classifier: <\/center><\/h3>\n<\/div>","4b4f3272":"<div style=\"background-color:#99EEAA; color:#000066;\">\n    <h2><center>Importando os Dados:<\/center><\/h2>\n<\/div>\n","b3c428fb":"# <html>\n\n    \n<div  style=\"background-color:w; color:#636363;border:#63b365; border-width:5px; border-style:solid;\">\n\n    \n<p><center><img src=\"https:\/\/drive.google.com\/thumbnail?id=1yPGYO8HkTanlqsIXozDIUvUVuvawAdG_\" width =\"6%\"  \/><font size=8> <b>Modelo Preditivo Doen\u00e7as Hep\u00e1ticas<\/b><\/font> <\/p>\n<p ><font size=6><center>Ives Tulio<\/font> <\/p>\n<p ><font size=4><center><b>email:<\/b> ivestulio@gmail.com <br> \n<b>Linkedin:<\/b> in\/ives-tulio\/<br>\n<b>GitHub:<\/b> ivestulio<\/p>\n\n<\/div>\n","77970844":"\n**Descri\u00e7\u00e3o Dados:**\n* Resultados de Sangue de 615 pacientes,\n* De ambos os sexos \n* com idade entre 19 e 77 anos \n* divididos em:\n> * Doadores de sangue \n> * Cirrose \n> * Hepatite \n> * Fibroses \n> * doadores de sangue suspeitos\n\n**Avalia\u00e7\u00f5es:**\n\n> 1. H\u00e1 rela\u00e7\u00e3o entre o sexo e doen\u00e7as hep\u00e1ticas ?\n> 2. Qual faixa et\u00e1ria \u00e9 mais acometida por doen\u00e7as hep\u00e1ticas ?\n> 3. Qual a rela\u00e7\u00e3o entre as doen\u00e7as hep\u00e1ticas e os resultados do exame de sangue ?","62effc55":"<div style=\"background-color:#99EEAA; color:#000066;\">\n    <h4><center> Confusion Matrix para CBC:  <\/center><\/h4>\n<\/div>","3eefbfd0":"<div style=\"background-color:#99EEAA; color:#000066;\">\n    <h2><center>Bibliotecas:<\/center><\/h2>\n<\/div>","f5b0be2b":"\n<div style=\"background-color:#99EEAA; color:#000066;\">\n    <h2><center> Comparando Modelos:  <\/center><\/h2>\n<\/div>","042a3d9c":"<div style=\"background-color:#99EEAA; color:#000066;\">\n    <h4><center> Confusion Matrix para RFC  <\/center><\/h4>\n<\/div>\n","c81c8862":"<div style=\"background-color:#99EEAA; color:#000066;\">\n    <h2><center> Tratamento dos Dados:  <\/center><\/h2>\n<\/div>\n","e035f80d":"<div style=\"background-color:#99EEAA; color:#000066;\">\n    <h3><center>Regress\u00e3o Log\u00edstica<\/center><\/h3>\n<\/div>\n "}}