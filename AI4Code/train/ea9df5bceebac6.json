{"cell_type":{"b2cfe2aa":"code","e82e4a38":"code","fb965676":"code","e4b6c3ac":"code","1cefae66":"code","843ee7ae":"code","7ee5779e":"code","95c1c2e0":"code","1b4a816a":"code","f1e629b8":"code","f3028cc3":"code","3ee5abd6":"code","0bc6beeb":"code","bc4d4a25":"code","ec415e86":"code","4a8880f1":"code","39deeaf9":"code","856a3988":"code","a366f32f":"code","078a6e22":"code","dfaf8a78":"code","55eacbfc":"code","4c8aa5b5":"code","22510126":"code","a627e73f":"code","0b4c6ac9":"code","42ba77f6":"code","ef89e035":"code","5d3fceff":"code","270316c6":"code","4d0668ab":"code","2fd9c820":"code","44893dd2":"code","d52f7b0b":"code","08b1b7a3":"code","7a272304":"code","a66ea01b":"code","bee892c3":"code","ff75a710":"code","015eb9c1":"code","d7b12fd2":"code","da5b199a":"code","d665277e":"code","cacd838a":"code","902cef99":"markdown","1f7b16f4":"markdown","0de940c9":"markdown","1ea057e9":"markdown","2fecef70":"markdown","2a781db8":"markdown","8ccf3016":"markdown","cbefd6e3":"markdown","bb0ba3f0":"markdown","46d7f710":"markdown","eb045601":"markdown","02e82992":"markdown","ec1883df":"markdown","feb5dbeb":"markdown","a9b3ded0":"markdown","8596c651":"markdown","35eed0c8":"markdown","c6dfa8f6":"markdown","c66efed9":"markdown","010a6274":"markdown","aa507bae":"markdown","899e3a18":"markdown","6782c6b0":"markdown","6177d971":"markdown","5420f87c":"markdown"},"source":{"b2cfe2aa":"import numpy as np\nimport pandas as pd\nfrom pandas import DataFrame\n\nimport sklearn\n\nimport matplotlib.pyplot as plt\nimport plotly.express as px\nimport plotly.graph_objects as go\nimport seaborn as sns\n%matplotlib inline\n\nimport missingno\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\nsns.set_theme(style=\"darkgrid\")","e82e4a38":"wine_df = pd.read_csv('..\/input\/red-wine-quality-cortez-et-al-2009\/winequality-red.csv')\nwine_df.head()","fb965676":"wine_df.info()","e4b6c3ac":"wine_df.describe()","1cefae66":"wine_df.isna().sum()","843ee7ae":"wine_df.hist(bins=10,figsize=(15,12))\nplt.show()","7ee5779e":"plt.figure(figsize=(15,10))\ncorrelation = wine_df.corr()\nsns.heatmap(correlation,annot=True,cmap='viridis')","95c1c2e0":"correlation['quality'].sort_values(ascending=False)","1b4a816a":"fig = px.density_heatmap(wine_df, x=\"alcohol\", y=\"quality\", nbinsx=20, nbinsy=10, color_continuous_scale=\"thermal\")\nfig.show()","f1e629b8":"fig = px.density_heatmap(wine_df, x=\"sulphates\", y=\"quality\", nbinsx=30, nbinsy=10, color_continuous_scale=\"thermal\")\nfig.show()","f3028cc3":"fig = px.density_heatmap(wine_df, x=\"citric acid\", y=\"quality\", nbinsx=30, nbinsy=10,color_continuous_scale=\"thermal\")\nfig.show()","3ee5abd6":"fig = px.density_heatmap(wine_df, x=\"fixed acidity\", y=\"quality\", nbinsx=30, nbinsy=10, color_continuous_scale=\"thermal\")\nfig.show()","0bc6beeb":"categor_condn=[ (wine_df['quality']>=7),\n               (wine_df['quality']<=4)]\nrating=['superior','inferior']\nwine_df['rating'] = np.select(categor_condn,rating,default='fine')\n\nwine_df.head()","bc4d4a25":"wine_df['rating'].value_counts()","ec415e86":"wine_df.groupby('rating').mean()","4a8880f1":"fig = px.histogram(wine_df, x=\"alcohol\", color=\"rating\",marginal=\"violin\")\nfig.update_traces(opacity=0.85)\nfig.show()\n","39deeaf9":"fig = px.scatter(wine_df, x=\"free sulfur dioxide\", y=\"total sulfur dioxide\", color=\"rating\",\n                 facet_col=\"rating\", title=\"Total SO2, free SO2 Vs Rating\")\n\nfig.update_xaxes(showgrid=False)\n\nfig.show()","856a3988":"fig = px.scatter(wine_df, x=\"volatile acidity\", y=\"alcohol\", color=\"rating\",\n                 facet_col=\"rating\", title=\"Alcohol, Volatile Alcohol Vs Rating\")\n\nfig.update_xaxes(showgrid=False)\n\nfig.show()","a366f32f":"categor_condn=[ \n               (wine_df['quality']<=5)]\nrating=['inferior']\nwine_df['rating'] = np.select(categor_condn,rating,default='fine')\n\nwine_df.head()","078a6e22":"wine_df = wine_df.drop(['quality'], axis='columns')\nwine_df.head()","dfaf8a78":"from sklearn.preprocessing import LabelEncoder\nlabelencoder_y = LabelEncoder()\nwine_df['rating'] = labelencoder_y.fit_transform(wine_df['rating'])","55eacbfc":"X = wine_df.drop('rating', axis = 1).values\ny = wine_df['rating'].values.reshape(-1,1)","4c8aa5b5":"#splitting the data into train and test\nfrom sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.3, random_state=50)","22510126":"from sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\nX_train_scale = sc.fit_transform(X_train)\nX_test_scale = sc.fit_transform(X_test)","a627e73f":"from sklearn.model_selection import cross_val_score\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import confusion_matrix","0b4c6ac9":"# To store the accuracy result of all the models\nresults =[]","42ba77f6":"from sklearn.linear_model import LogisticRegression\n\nmodel_LR = LogisticRegression(C=1, fit_intercept=True, max_iter=1000, penalty = 'l2', solver='liblinear')\nmodel_LR.fit(X_train_scale, y_train.ravel())","ef89e035":"cv_score_LR = cross_val_score(estimator = model_LR, X = X_train_scale, y = y_train.ravel(), cv = 10)\nprint('LOGISTIC REGRESSION REPORT')\nprint(\"CV Score: \", cv_score_LR.mean())\n\ny_train_predict_LR = model_LR.predict(X_train_scale)\ntrain_accuracy_LR = accuracy_score(y_train, y_train_predict_LR)\nprint(\"Training set accuracy: \", train_accuracy_LR)\n\ny_test_predict_LR = model_LR.predict(X_test_scale)\ntest_accuracy_LR = accuracy_score(y_test, y_test_predict_LR)\nprint(\"Test set accuracy: \", test_accuracy_LR)\n\nresults.append(test_accuracy_LR)","5d3fceff":"confusion_matrix(y_test, y_test_predict_LR)","270316c6":"\nfrom sklearn.neighbors import KNeighborsClassifier\nmodel_KNN = KNeighborsClassifier(leaf_size = 1, metric = 'minkowski', n_neighbors = 32, weights = 'distance')\nmodel_KNN.fit(X_train_scale, y_train.ravel())","4d0668ab":"cv_score_KNN = cross_val_score(estimator = model_KNN, X = X_train_scale, y = y_train.ravel(), cv = 10)\nprint('KNN REPORT')\nprint(\"CV Score: \", cv_score_KNN.mean())\n\ny_train_predict_KNN = model_KNN.predict(X_train_scale)\ntrain_accuracy_KNN = accuracy_score(y_train, y_train_predict_KNN)\nprint(\"Training set accuracy: \", train_accuracy_KNN)\n\ny_test_predict_KNN = model_KNN.predict(X_test_scale)\ntest_accuracy_KNN = accuracy_score(y_test, y_test_predict_KNN)\nprint(\"Test set accuracy: \", test_accuracy_KNN)\n\nresults.append(test_accuracy_KNN)","2fd9c820":"confusion_matrix(y_test, y_test_predict_KNN)","44893dd2":"from sklearn.tree import DecisionTreeClassifier\nmodel_DT = DecisionTreeClassifier(criterion = 'gini', max_features=6, max_leaf_nodes=400, random_state = 33)\nmodel_DT.fit(X_train_scale, y_train.ravel())","d52f7b0b":"cv_score_DT = cross_val_score(estimator = model_DT, X = X_train_scale, y = y_train.ravel(), cv = 10)\nprint('DT REPORT')\nprint(\"CV Score: \", cv_score_DT.mean())\n\ny_train_predict_DT = model_DT.predict(X_train_scale)\ntrain_accuracy_DT = accuracy_score(y_train, y_train_predict_DT)\nprint(\"Training set accuracy: \", train_accuracy_DT)\n\ny_test_predict_DT = model_DT.predict(X_test_scale)\ntest_accuracy_DT = accuracy_score(y_test, y_test_predict_DT)\nprint(\"Test set accuracy: \", test_accuracy_DT)\n\nresults.append(test_accuracy_DT)","08b1b7a3":"confusion_matrix(y_test, y_test_predict_DT)","7a272304":"from sklearn.ensemble import RandomForestClassifier\nmodel_RF = RandomForestClassifier(criterion = 'entropy', max_features = 4, n_estimators = 900, random_state=40)\nmodel_RF.fit(X_train_scale, y_train.ravel())","a66ea01b":"cv_score_RF = cross_val_score(estimator = model_RF, X = X_train_scale, y = y_train.ravel(), cv = 10)\nprint('RF REPORT')\nprint(\"CV Score: \", cv_score_RF.mean())\n\ny_train_predict_RF = model_RF.predict(X_train_scale)\ntrain_accuracy_RF = accuracy_score(y_train, y_train_predict_RF)\nprint(\"Training set accuracy: \", train_accuracy_RF)\n\ny_test_predict_RF = model_RF.predict(X_test_scale)\ntest_accuracy_RF = accuracy_score(y_test, y_test_predict_RF)\nprint(\"Test set accuracy: \", test_accuracy_RF)\n\nresults.append(test_accuracy_RF)","bee892c3":"confusion_matrix(y_test, y_test_predict_RF)","ff75a710":"from sklearn.svm import SVC\nmodel_SVC = SVC()\nmodel_SVC.fit(X_train_scale, y_train.ravel())","015eb9c1":"cv_score_SVC = cross_val_score(estimator = model_SVC, X = X_train_scale, y = y_train.ravel(), cv = 10)\nprint('SVC REPORT')\nprint(\"CV Score: \", cv_score_SVC.mean())\n\ny_train_predict_SVC = model_SVC.predict(X_train_scale)\ntrain_accuracy_SVC = accuracy_score(y_train, y_train_predict_SVC)\nprint(\"Training set accuracy: \", train_accuracy_SVC)\n\ny_test_predict_SVC = model_SVC.predict(X_test_scale)\ntest_accuracy_SVC = accuracy_score(y_test, y_test_predict_SVC)\nprint(\"Test set accuracy: \", test_accuracy_SVC)\n\nresults.append(test_accuracy_SVC)","d7b12fd2":"confusion_matrix(y_test, y_test_predict_SVC)","da5b199a":"result_df = DataFrame({\"ML Models\":[\"Logistic Regression\",\"KNN\",\n             \"Decision Tree\",\"Random Forest\",\"SVC\"],\"Score\":results})","d665277e":"result_df.style.background_gradient(\"Blues\")","cacd838a":"g = sns.barplot(\"Score\", \"ML Models\", data = result_df, palette='Blues')\ng.set_xlabel(\"Score\")\ng.set_title(\"Model Accuracy Results\", color = \"Black\")\nplt.show()","902cef99":"## 2.KNN","1f7b16f4":"## 4.Random Forest","0de940c9":"**Alcohol - Quality Heatmap**","1ea057e9":"# MODEL BUILDING","2fecef70":"The above results shows the measure of correlation between quality and other columns. It can be deduced that alcohol has highest correlation value. After that we have sulphates, citric acid, fixed acidity and residual sugar. <\/br>\n**Let's have a closer look on these factors.**","2a781db8":"# DATA OVERVIEW","8ccf3016":"**Conclusion - The combinations with high alcohol percent and low volatie acidity seems to produce better wines.**","cbefd6e3":"## Splitting into train and test","bb0ba3f0":"\n## 3.Decision Tree","46d7f710":"**Conclusion :**\n\n**FIXED ACID** - This is a total of most acids involved with wine or fixed or nonvolatile. It resembles a bell shaped, normal distribution graph.the maximum count goes somewhat around 7.5.\n\n**VOLATILE ACID** - This attribute gives the amount of acetic acid in wine, which at too high of levels can lead to an unpleasant, vinegar taste. The graph resembles the bell shaped , like a normal dirstibution. Majority of wines have values between [0.3, 0.72].\n\n**CITRIC ACID** - Found in small quantities, citric acid can add \u2018freshness\u2019 and flavor to wines. There are two peaks appearing in the graph, one near 0.02 and other near 0.25.\n\n**RESIDUAL SUGAR** - It is the amount of sugar remaining after fermentation stops. The graph for residual sugar is positively i.e left skewed. Majority of wines have lower than 2.5 residual sugar value.\n\n**CHLORIDES** - Chlorides gives the amount of salt in the wine. Most of the wines have lesser than 0.2 chloride value.\n\n**FREE SO2** - Free sulfur dioxide prevents microbial growth and the oxidation of wine. Most of the wines have lesser than 20 free SO2 value.\n\n**TOTAL SO2** -Represents the amount of free and bound forms of S02; in low concentrations, SO2 is mostly undetectable in wine, but at free SO2 concentrations over 50 mg\/L, SO2 becomes evident in the nose and taste of wine. The graph appears to be left skewed and most of the wines have lesser than 50 total SO2 value.\n\n**DENSITY** - Density plot looks normally distributed, with mean eqals to 0.9967 and median equals to 0.9968.\n\n**pH** - This attribute describes how acidic or basic a wine is on a scale from 0 (very acidic) to 14 (very basic), where 7 is neutral.The graph appears to be quiet normally distributed. Most of the wines have a pH level ranging between [3.2, 3.4].\n\n**SULPHATE** - This is a wine additive which can contribute to sulfur dioxide gas (S02) levels and acts as an antimicrobial and antioxidant. It also resembles a bell shaped graph with maximum wines having around 6.5 sulphates value.\n\n**ALCOHOL CONTENT** - The graph of alcohol content appears to be positively i.e left skewed and most of them are below 11% mark.\n\n\n**QUALITY** - The wines in this dataset belong to the range[3,8] and most of them belong to 5.\n\n","eb045601":"Conclusion -  The above plot shows the distribution of alcohol content with respect to the reviews. We can see that the wines of superior quality have a higher percentage of alcohol content while the wines of inferior quality have lower percentage of alcohol content.","02e82992":"# DATA VISUALIZAION","ec1883df":"# 1. Logistic regression","feb5dbeb":"# READING DATA ","a9b3ded0":"## 5.SVM","8596c651":"## END NOTE:\nThere are some special noebooks on this particular topic whic I would like to mention for I got to learn a lot from them:\nhttps:\/\/www.kaggle.com\/rafetcan\/red-wine-quality-classification-95-76-acc\/notebook - ","35eed0c8":"![Colorful Planets Outer Space General Twitch Banner.png](attachment:9aa354c1-2cf4-4159-be19-7b76d6c018d8.png)","c6dfa8f6":"**At first, we are going to look one-by-one into the column and the relation between the quality of wine.**","c66efed9":"Conclusion - The alcohol range between [9,10] and quality equal to 5 accounts for highest number of wines. As we move upwards in the quality, wines having higher alcohol content increses, while in the lower quality, the alcohol content also decreases. The optimum range of alcohol seems to be between [10.5,12.5].","010a6274":"## Feature scaling","aa507bae":"**Conclusion - Most of the superior quality wines are below the 75 mg\/dm3 total sulfur dioxide concentration and,below the 30 mg\/dm3 free sulfur dioxide concentration.**","899e3a18":"Conclusion - The sulphates range between [0.5,0.7] and quality equal to [5,6] accounts for highest number of wines. As we move upwards in the quality, wines having sulphate content around 0.8 increses, while in the lower quality, the sulphate  content is around 0.5.","6782c6b0":"## Categorizing the wine quality ","6177d971":"**Conclusion: There are no null values in the dataset hence I am going to skip the missing value analysis and missing value imputation part.**","5420f87c":"Conclusion - Many wines fall under the category having fixed acidity the range between [7,8] and the quality from [5,6]. "}}