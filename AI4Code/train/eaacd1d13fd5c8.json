{"cell_type":{"b389eaa2":"code","ae2c4924":"code","fcd1ab21":"code","f6d13ae4":"code","1f87e7b7":"code","98baa81c":"code","70b0a790":"code","ecd28ffe":"code","d48aa177":"code","0be02771":"code","2738a2d3":"code","f0536736":"code","dab91b0b":"code","1076d575":"code","133f872b":"code","cf35cfe3":"code","6e1aa0fe":"code","5e8f58dc":"code","cf227320":"code","5ef1307c":"code","aa92f538":"code","891a1d60":"code","9ebdfc83":"code","23f83192":"code","e5781446":"markdown","8a8ee5b2":"markdown","1bd3ec3e":"markdown","7536f975":"markdown","6b98c784":"markdown","3ac37749":"markdown","57374747":"markdown","29fb2982":"markdown","bbd13dc4":"markdown","9eb18a4b":"markdown","4a73714f":"markdown","1ab4ff0d":"markdown","2153656c":"markdown","be8dd426":"markdown","bd549bc2":"markdown"},"source":{"b389eaa2":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport matplotlib as mpl\n%matplotlib inline","ae2c4924":"df_iris=pd.read_csv('..\/input\/iris\/Iris.csv')\ndf_iris.head()","fcd1ab21":"df_iris.drop('Id',axis=1,inplace=True)\n","f6d13ae4":"df_split=df_iris['Species'].str.rsplit('-',expand=True)\ndf_iris.drop('Species',axis=1,inplace=True)","1f87e7b7":"df_iris['Species']=df_split.iloc[:,-1]\ndf_iris.head()","98baa81c":"fig1=plt.figure(figsize=(10,5))\nax1=fig1.add_subplot(121)\n\ng=sns.distplot(df_iris['SepalLengthCm'],ax=ax1)\nax1.set_xlabel('Sepal Length (cm)',size=15)\nax1.set_title('Sepal length distribution  \\n \\n Median length (cm): {0:.2f}'.format(df_iris['SepalLengthCm'].median()),size=18)\ng.axvline(df_iris['SepalLengthCm'].median(),color='indianred',label='Median length')\nax1.legend()\n\n\nax2=fig1.add_subplot(122)\nh=sns.distplot(df_iris['SepalWidthCm'],ax=ax2,color='green')\nax2.set_xlabel('Sepal Width (cm)',size=15)\nax2.set_title('Sepal length distribution  \\n \\n Median width (cm): {0:.2f}'.format(df_iris['SepalWidthCm'].median()),size=18)\nh.axvline(df_iris['SepalWidthCm'].median(),color='black',label='Median Width')\nax2.legend()","70b0a790":"fig2=plt.figure(figsize=(10,5))\nax3=fig2.add_subplot(121)\n\ng=sns.distplot(df_iris['PetalLengthCm'],ax=ax3)\nax3.set_xlabel('Petal Length (cm)',size=15)\nax3.set_title('Petal length distribution  \\n \\n Median length (cm): {0:.2f}'.format(df_iris['PetalLengthCm'].median()),size=18)\ng.axvline(df_iris['PetalLengthCm'].median(),color='indianred',label='Median length')\nax3.legend()\n\n\nax4=fig2.add_subplot(122)\nh=sns.distplot(df_iris['PetalWidthCm'],ax=ax4,color='green')\nax4.set_xlabel('Petal Width (cm)',size=15)\nax4.set_title('Petal length distribution  \\n \\n Petal width (cm): {0:.2f}'.format(df_iris['PetalWidthCm'].median()),size=18)\nh.axvline(df_iris['PetalWidthCm'].median(),color='black',label='Median Width')\nax4.legend()","ecd28ffe":"df_vir=df_iris[df_iris['Species']=='virginica']\ndf_set=df_iris[df_iris['Species']=='setosa']\ndf_ver=df_iris[df_iris['Species']=='versicolor']\n\n\nfig3=plt.figure(figsize=(13,5))\n\nax5=fig3.add_subplot(121)\n\na=sns.violinplot(x='Species',y='SepalLengthCm',data=df_iris,ax=ax5,orient='v',inner='quartile')\n\nax5.set_title('Sepal Length distribution of each species',size=13)\n\n\nax6=fig3.add_subplot(122)\nb=sns.violinplot(x='Species',y='SepalWidthCm',data=df_iris,ax=ax6,orient='v',inner='quartile',palette='summer')\nax6.set_title('Sepal Width distribution of each species',size=13)\n","d48aa177":"fig4=plt.figure(figsize=(15,6))\nax6=fig4.add_subplot(121)\n\na=sns.violinplot(x='Species',y='PetalLengthCm',data=df_iris,ax=ax6,orient='v',inner='quartile')\n\nax6.set_title('Petal Length distribution of each species',size=13)\n\n\nax7=fig4.add_subplot(122)\nb=sns.violinplot(x='Species',y='PetalWidthCm',data=df_iris,ax=ax7,orient='v',inner='quartile',palette='summer')\nax7.set_title('Petal Width distribution of each species',size=13)\n\n","0be02771":"sns.set()\nfig5=plt.figure(figsize=(20,10))\nax8=fig5.add_subplot(121)\nax8.set_title('Labelled clusters based on Sepal width and length',size=20)\n\nax8.scatter(df_set.iloc[:,0],df_set.iloc[:,1],c='red',s=100,alpha=0.6,label='Setosa')\nax8.scatter(df_vir.iloc[:,0],df_vir.iloc[:,1],c='blue',s=100,alpha=0.6,label='Virginica')\nax8.scatter(df_ver.iloc[:,0],df_ver.iloc[:,1],c='green',s=100,alpha=0.6,label='Versicolor')\n\nax8.set_xlabel('Sepal Length (cm)',size=15)\nax8.set_ylabel('Sepal Width (cm)',size=15)\n\nax8.legend(fontsize=15)\n\n\nax8=fig5.add_subplot(122)\nax8.set_title('Labelled clusters based on Petal width and length',size=20)\n\nax8.scatter(df_set.iloc[:,2],df_set.iloc[:,3],c='red',s=100,alpha=0.6,label='Setosa')\nax8.scatter(df_vir.iloc[:,2],df_vir.iloc[:,3],c='blue',s=100,alpha=0.6,label='Virginica')\nax8.scatter(df_ver.iloc[:,2],df_ver.iloc[:,3],c='green',s=100,alpha=0.6,label='Versicolor')\n\nax8.set_xlabel('Petal Length (cm)',size=15)\nax8.set_ylabel('Petal Width (cm)',size=15)\n\nax8.legend(fontsize=15)","2738a2d3":"df_iris.plot.area(y=['SepalLengthCm', 'SepalWidthCm', 'PetalLengthCm', 'PetalWidthCm'],\n                  alpha=0.6,figsize=(10,8),stacked=False)\nplt.xlabel('Number of flowers',size=15)\nplt.ylabel('Dimensions (cm)',size=15)","f0536736":"df_iris.plot.area(y=['SepalLengthCm', 'SepalWidthCm', 'PetalLengthCm', 'PetalWidthCm'],\n                  alpha=0.6,figsize=(10,8),stacked=True)\nplt.xlabel('Number of flowers',size=15)\nplt.ylabel('Cumulative dimensions (cm)',size=15)","dab91b0b":"\n\nsns.jointplot(df_iris['SepalLengthCm'],df_iris['SepalWidthCm'],kind='kde',color='green')\nsns.jointplot(df_iris['PetalLengthCm'],df_iris['PetalWidthCm'],kind='kde',color='red')\n","1076d575":"df_iris['Species']=df_iris['Species'].replace('setosa',1)\ndf_iris['Species']=df_iris['Species'].replace('virginica',2)\ndf_iris['Species']=df_iris['Species'].replace('versicolor',3)","133f872b":"targets=df_iris['Species']\ndf_iris.drop('Species',axis=1,inplace=True)","cf35cfe3":"X=df_iris\ny=targets","6e1aa0fe":"from sklearn.model_selection import train_test_split\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.metrics import confusion_matrix","5e8f58dc":"X_train,X_test,y_train,y_test=train_test_split(X,y,random_state=0,shuffle=True)","cf227320":"dtc=DecisionTreeClassifier(max_depth=6)\ndtc.fit(X_train,y_train)","5ef1307c":"y_preds=dtc.predict(X_test)\ndtc.score(X_test,y_test)","aa92f538":"conf_mat=confusion_matrix(y_preds,y_test)\nfig6=plt.figure(figsize=(10,8))\nax9=fig6.add_subplot(111)\n\nsns.heatmap(conf_mat,annot=True,cmap='viridis',ax=ax9)\nax9.xaxis.set_ticklabels(['Setosa','Virginica','Versicolor'])\nax9.yaxis.set_ticklabels(['Setosa','Virginica','Versicolor'])\nplt.xlabel('Predictions',size=15)\nplt.ylabel('Actual',size=15)","891a1d60":"dtc.fit(X_train,y_train)\ncols=df_iris.columns\ncol_arr=np.array(cols).reshape(-1,1)\ndf_imp=pd.DataFrame(col_arr)\ndf_imp.rename(columns={0:'Feature'},inplace=True)\nimp=(100*dtc.feature_importances_)\ndf_imp['Importance']=imp\ndf_imp","9ebdfc83":"sns.catplot('Importance','Feature',data=df_imp,kind='bar',height=8,aspect=2)\nplt.title('Feature importance',size=20)","23f83192":"\nfig, axes = plt.subplots(nrows = 1,ncols = 1,figsize = (4,4), dpi=300 ,facecolor='b')\nmpl.rcParams['text.color'] = 'black'\nfn=['sepal length (cm)','sepal width (cm)','petal length (cm)','petal width (cm)']\ncn=['setosa', 'versicolor', 'virginica']\n\n\nfrom sklearn import tree\ntree.plot_tree(dtc,feature_names = fn, \n               class_names=cn,filled=True,rotate=True,ax=axes)","e5781446":"From the above area plot, we can see that Sepal length values are in general higher than any other values. We can also make a stacked area plot to understand the difference better.","8a8ee5b2":"Now that we have encoded the targets, let us segregate it from the input dataframe.","1bd3ec3e":"As we can see, we have completely refined our data and can move forward with the Data Visualisation.\n\n# Step 3: Data Visualisation\n\n\nIn this section, we are interested to check how the various sepal and petal widths and lengths vary for each species. This will give us a bit of understanding as to how they are distributed. We can leverage this knowledge later to predict the type of species as well for any given data of sepal lengths and widths.\n\nLet us start of with how the sepal lengths and widths vary.\n\n\n## Sepal and Petal dimensions \n\n\nLet us first check how are the Sepal lengths and widths distributed\n","7536f975":"The decision tree classifier could get a very high accuracy with 97.36 %. Let us make a heatmap confusion matrix that will help us understand how many values were correctly predicted.","6b98c784":"Here, we see the various violinplots of each of the species of flowers. As we can see, the sepal lengths are lowest for Setosa and highest for Vriginica. The inner lines show the quartile. The mid line in each violinplot shows the median values.\n\nOn the other hand, when we compare the sepal widths, the median sepal width is highest for Setosa.\n\nLet us perform the similar assessment for the petal width and length.\n\n","3ac37749":"As we can see, we have the various petal\/sepal witdths and lengths. These are all classified into their species. Since we are performing unsupervised learning technique, hence we will not have the column of species usually to confirm if we have labelled our data correctly.\n\n\n# Step 2: Data cleaning\n\nAlthough our dataframe is extremely clean, we will try to refine the dataframe further more.\n\nIn the above datafram, the Id column is unnecessary and hence, we will drop it. More over, the word Iris has been repeated every time which provides no extra info. Hence, we will try to remove the iris word from the Species column.","57374747":"As we can see from the above heatmap, only one particular instance was incorrectly classifide by the decision tree. This is an incredibly good classification.\n\nLet us now try to check which are the most important features that helped us to such an accurate classification.","29fb2982":"From the above plot, we can see that petal length has the highest importance when it comes to classifying the flowers into their species.\n\nLet us finally take a look at our decision tree which was able to classify the various species correctly using thhe feature values such as sepal and petal length,width. The visual representation of the tree tells us the decision making that went through the alogrithm","bbd13dc4":"As was established through the violinplots, the petal dimensions are extremely scattered while sepal dimensions are very close to each other.\n\n\n## Area plot of various dimensions\n\n\nLet us check the relative difference in values of sepal dimensions and petal dimensions using an area plot. The greater the area, the higher the dimension values.\n\n\n","9eb18a4b":"As we can see, the petal lengths and width are highly dispersed. Infact, it seems like the distribution is **bimodal** in nature i.e. with two peaks.\n\n\nNow that we have seen the complete distribution of the dimensions of petal and sepal dimensions, let us try to visualise the dimensions in a more granular nature with respect to each of the species.\n\n\n## Sepal and petal distributions of each flower species","4a73714f":"# Introduction\n\nIn this particular kernel, we will be exploring the famous Iris dataset that will contain the various values of petal length,width alongwith sepal length,width. \n\nWe shall be trying to visualise various data features of the different species and will try to find the right specie of the flower using a machine learning technique when we have the information of petal and sepal dimensions.\n\n![iris_virginica_virginica_lg.jpg](attachment:iris_virginica_virginica_lg.jpg)\n\n# Step 1: Importing libraries and data\n\nIn the first step, we shall move ahead with importing the relevant libraries and datasets","1ab4ff0d":"As it was already established, the petal dimensions for each of the species vary by a large amount when compared to sepal dimensions. Hence, we can see the violinplots are much further apart.\n\n\nLet us check the scatterplots of the dimensions of sepals and petals of each of the species.","2153656c":"As we can see, the distribution seems to be a normal distribution for both sepal lengths and widths.\n\nThe median sepal length is 5.8 cm while median sepal width is 3 cm.\n\nLet us now visualise the distribution of petal lengths and widths.","be8dd426":"## Jointplots and KDE of sepal and petal dimensions\n\nAlthough we have pretty much understood what the ranges of the values of dimensions are, we shall try to explore another particular helpful plot called the pairplots which are scatter plots paired with histograms on the axes that give us greater deal of details.","bd549bc2":"The darker shades in the graph shows the regions where the density of values are the highest.\n\n\n# Step 4: Machine Learning\n\nLet us now apply machine learning concept to be able to predict the species of flower when we are given with any dimensions of sepal and petal.\n\nThis would require us to perform classification. Let us apply a tree based algorithm such as Decision Tree classifier which could help us perform the required classification.\n\nFirst off, let us encode the targets as \n\n1: Setosa\n\n2: Virginica\n\n3: Versicolor\n"}}