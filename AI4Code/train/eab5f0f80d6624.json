{"cell_type":{"963b8df9":"code","e79f0cf7":"code","c0094a93":"code","973805ed":"code","d25e3953":"code","a999bb77":"code","d46d2ea4":"code","5ade7e42":"code","913753af":"code","17beaf61":"code","13578f2c":"code","ebfbaf69":"code","494f59e3":"code","34109f5f":"code","913d6ba9":"code","b3160730":"code","7269b8ce":"code","490e0aa6":"code","aa76b6ed":"code","ab927cd6":"code","3a62e496":"code","244189dc":"code","05b094b9":"code","1adee4ae":"code","a695ce1e":"code","f71fc0b7":"code","b07ccae4":"code","81af8c97":"code","d4ad6cd3":"code","89bc462d":"code","6b81a779":"code","5f03dadd":"code","2e4aeeaf":"code","728d715c":"code","488e7227":"code","2d3265d1":"code","c10df27e":"markdown","14fee3ba":"markdown","00c5942e":"markdown","d9cca951":"markdown","4bedeafb":"markdown","94f7cc7d":"markdown","e4de6500":"markdown","f60319a6":"markdown","d1aee836":"markdown","6d0446d2":"markdown","c42088c4":"markdown","0321c768":"markdown","dd2ca251":"markdown","bbcf907d":"markdown","18818709":"markdown","6220e096":"markdown","9e422ae3":"markdown","4c6267ea":"markdown","aaf17cf5":"markdown","0df87474":"markdown","87809280":"markdown","7e945e59":"markdown","16ee9762":"markdown","393a7f39":"markdown","eec407d4":"markdown","ebc395ff":"markdown"},"source":{"963b8df9":"import pandas as pd  #Pandas is used to analyze data\nimport numpy as np   #This library contains a large number of mathematical, algebraic, and transformation functions\nimport matplotlib.pyplot as plt  # Used for Visualization of data\nimport seaborn as sns   #Seaborn is a Python data visualization library based on matplotlib\n#matplotlib inline sets the backend of matplotlib to the 'inline' backend\n%matplotlib inline      \nsns.set_style('whitegrid')   # Set the aesthetic style of the plots\nplt.style.use('fivethirtyeight')  #\"fivethirtyeight\" styling which tries to replicate the styles","e79f0cf7":"# Loading the Dataset using Pandas Library using pd.read_csv(filename with extenstion)\n\ndf = pd.read_csv('..\/input\/college-data\/college_data')","c0094a93":"# Printing the Total Row and Column usinf Shape \n\ndf.shape","973805ed":"# Printing First Five Rows of dataset using head()\n\ndf.head()","d25e3953":"# Printing Last Five Row of Dataset using tail()\n\ndf.tail()","a999bb77":"# info(): This method prints information about a DataFrame including the index dtype and column dtypes, non-null values \n\ndf.info()","d46d2ea4":"# describe() : is used to view some basic statistical details like percentile,mean, std, etc\n\ndf.describe()","5ade7e42":"# Checking for Null Values using isnull() it return whole dataset with boolean value (False- Notnull value and True- Null Value)\n\ndf.isnull()","913753af":"# This is other way to check null value and here we use isnull() with sum() \n\ndf.isnull().sum()","17beaf61":"# Here we will remove Unnamed 0 since its a string and we cannot convert to number \n# and College Name  doesnt affect or contribute to form cluster so we can exclude them ","13578f2c":"# Droppinng Column Unnamed: 0 using drop(column_name,inplace= True argument stands for the data frame has to make changes \n#permanent, axis refers to the dimension of the array, axis=1 (or axis='columns') is vertical axis)\n\ndf.drop('Unnamed: 0',inplace=True,axis=1)","ebfbaf69":"# Printing whole dataset to check whether Column Unnamed: 0 is dropped or not (This is just to verfiy, You can skip it)\n\ndf","494f59e3":"# Firstly we plot Scatterplot of Grad.Rate Vs. Room.Board  using seaborn (Igonre Warning)\n\nsns.scatterplot(x='Room.Board', y='Grad.Rate', data=df, hue='Private')\n\nplt.title(\" Grad.Rate Vs. Room.Board\")\n\nplt.show()","34109f5f":"# Now we plot SCatterplot of F.Undergrad Vs. Outstate using Seaborn and Matplotlib (Ignore Warning)\n\nsns.scatterplot(x='Outstate', y='F.Undergrad', data=df, hue='Private')\n\nplt.title(\" F.Undergrad Vs. Outstate \")\n\nplt.show()","913d6ba9":"# histogram of Outstate Tuition based on the Private\nplt.figure(figsize=(15, 10))\n\ndf.loc[df.Private == 'Yes', 'Outstate'].hist(label=\"Private College\", bins=50)\ndf.loc[df.Private == 'No', 'Outstate'].hist(label=\"Non Private College\", bins=50)\nplt.title('Outstate Tuition based on the Private')\nplt.xlabel('Outstate')\nplt.legend()\n","b3160730":"# histogram of Grad.Rate based on the Private\n\nplt.figure(figsize=(15,10))\n\ndf.loc[df.Private == 'Yes', 'Grad.Rate'].hist(label=\"Private College\", bins=50)\ndf.loc[df.Private == 'No', 'Grad.Rate'].hist(label=\"Non Private College\", bins=50)\nplt.title('Grad.Rate based on the Private')\nplt.xlabel('Graduation Rate')\nplt.legend()\n","7269b8ce":"df[df['Grad.Rate'] > 100]","490e0aa6":"df.loc[df['Grad.Rate'] > 100, 'Grad.Rate'] = 100","aa76b6ed":"# Creating a Histogram of Gaduration Rate\n\nplt.figure(figsize=(15,10))\n\ndf.loc[df.Private == 'Yes', 'Grad.Rate'].hist(label=\"Private College\", bins=50)\ndf.loc[df.Private == 'No', 'Grad.Rate'].hist(label=\"Non Private College\", bins=50)\nplt.xlabel('Graduation Rate')\nplt.legend()","ab927cd6":"#Import KMeans from SciKit Learn\n\nfrom sklearn.cluster import KMeans","3a62e496":"#Create an instance of a K Means model with 2 clusters(Goverment and Private)\n\nkmeans = KMeans(2)","244189dc":"# Creating new_df to store Private \n\nnew_df=df['Private']","05b094b9":"# Converting String Value to numeric\n\nnew_df.replace(['No','Yes'],[1,0],inplace=True)","1adee4ae":"# Printing to verify\n\nnew_df","a695ce1e":"#Fit the model to all the data except for the Private label\n\n\nkmeans.fit(df.drop('Private',axis=1))","f71fc0b7":"kmeans.cluster_centers_","b07ccae4":"# Visulaize \nplt.scatter(df['Apps'],df['Accept'], c=kmeans.labels_,cmap='rainbow')\n\nplt.title('Application vs Accept')","81af8c97":"# Visulaize \nplt.scatter(df['F.Undergrad'],df['P.Undergrad'], c=kmeans.labels_,cmap='rainbow')\n\nplt.title('F.Undergrad vs P.Undergrad')","d4ad6cd3":"# Visulaize \n\nplt.scatter(df['Top10perc'],df['Top25perc'], c=kmeans.labels_,cmap='rainbow')\n\nplt.title('Top10perc vs Top25perc')","89bc462d":"# Create a new column for df called 'Cluster', which is a 1 for a Private and  0 for a Public\/Goveremnt \n\n#df['Private'] = df.Private.astype(\"category\").cat.codes\n\ndf['Private']=new_df","6b81a779":"# Printing Private Column which was just created \n\ndf['Private']","5f03dadd":"# Printing whole dataset\n\ndf.head()","2e4aeeaf":"kmeans.labels_","728d715c":"from sklearn.metrics import classification_report, confusion_matrix\n\nprint(confusion_matrix(df.Private, kmeans.labels_))\nprint(classification_report(df.Private, kmeans.labels_))","488e7227":"from sklearn.metrics import accuracy_score, confusion_matrix\n\nprint(accuracy_score(df.Private, kmeans.labels_))\nprint(pd.DataFrame(classification_report(df.Private, kmeans.labels_, output_dict=True)))","2d3265d1":"# StandardScaler removes the mean and scales each feature\/variable to unit variance.\nfrom sklearn.preprocessing import StandardScaler\n\nscalar = StandardScaler()\n\nX = df.drop('Private', axis=1)\ny = df.Private\n\nX = scalar.fit_transform(X)\n\nkmeans = KMeans(2)\nkmeans.fit(X)\n\nprint(kmeans.cluster_centers_)\n\nprint(accuracy_score(y, kmeans.labels_))\nprint(confusion_matrix(y, kmeans.labels_))\nprint(classification_report(y, kmeans.labels_))","c10df27e":"#### There is no perfect way to evaluate clustering if we  don't have the labels, however since this is just an exercise, we do have the labels, so we take advantage of this to evaluate our clusters, keep in mind, we usually won't have label in the real world while doing clustering. ","14fee3ba":"## Scaling Data ","00c5942e":"## College Data ---> Preprocessing Data---> Exploring Data ---> Model Fiting ---> Evaluation","d9cca951":"<a name='c'><\/a>\n# Conclusion:","4bedeafb":"### K-Means Clustering is an unsupervised learning algorithm that is used to solve the clustering problems in machine learning or data science.","94f7cc7d":"<a name='il'><\/a>\n# 3.Importing Library","e4de6500":"## Thats it we are done with K-Means Algorithm.....!!!","f60319a6":"<a name='wf'> <\/a>\n# 1. WorkFlow","d1aee836":"## Here we had had only two cluster and only 777 rows due to that our accuary of the model is less, however we can increase the accuracy by adding more data as well as adding new clusters to it.","6d0446d2":"### How does the K-Means Algorithm Work?","c42088c4":"### The working of the K-Means algorithm is explained in the below steps:\n\n-  Select the number K to decide the number of clusters.\n\n-  Select random K points or centroids. (It can be other from the input dataset).\n\n- Assign each data point to their closest centroid, which will form the predefined K clusters.\n\n- Calculate the variance and place a new centroid of each cluster.\n\n- Repeat the third steps, which means reassign each datapoint to the new closest centroid of each cluster.\n\n-  If any reassignment occurs, then go to step-4 else go to FINISH.\n\n-  The model is ready.","0321c768":"## Here we had an advantage since we had labels however in real world dataset we may not get labels, here we had label so we have done evaluation of clustering.","dd2ca251":"# Table of Content\n<hr style=\"height:2px\">","bbcf907d":"\"\"\"\nApps: Number of applications received\n\nAccept: Number of applications accepted\n\nEnroll: Number of new students enrolled\n\nTop10perc: % of new students from top 10% of their high school class\n\nTop25perc: % of new students from top 25% of their high school class\n\nF.Undergrad: Number of full-time undergraduates\n\nP.Undergrad: Number of part-time undergraduates\n\nOutstate: Out-of-state tuition\n\nRoom.Board: Room and board costs\n\nBooks: Estimated book costs\n\nPersonal: Estimated personal spending\n\nPhD: % of faculty with PhDs\n\nTerminal: % of faculty with a terminal degree (PhD\/JD\/MD\/MBA\/etc)\n\nS.F.Ratio: Student\/faculty ratio\n\nperc.alumni: % alumni who donate\n\nExpend: Instructional expenditure per student\n\nGrad.Rate: Graduation rate\n\n\"\"\"","18818709":"<a name='e'><\/a>\n# 8.Evaluation","6220e096":"<a name= \"ed\"><\/a>\n# 6.Exploring  Data","9e422ae3":"## Create a confusion matrix and classification report to see how well the Kmeans clustering worked without being given any labels. ","4c6267ea":"### K-Means Clustering is an Unsupervised Learning algorithm, which groups the unlabeled dataset into different clusters. Here K defines the number of pre-defined clusters that need to be created in the process, as if K=2, there will be two clusters, and for K=3, there will be three clusters, and so on.","aaf17cf5":"<a name='dp'><\/a>\n#  5.Preprocessing Data","0df87474":"## [ 1.WorkFlow](#wf)\n\n## [ 2. What is K-Mean ?](#km)\n\n## [3.Importing Library](#il)\n\n##  [4.Loading Dataset ](#ld)\n\n## [5. Data Preprocessing](#dp)\n\n## [6. EDA (Exploratory Data Analysis)](#ed)\n\n## [7. Model Creation and Fitting](#mc)\n\n## [8. Evaluation](#e)\n\n## [9.Conclusion](#c)","87809280":"<a name='mc'><\/a>\n#  7.Model Creating and Fitting","7e945e59":"##  This Algorithm performed well,\n## Where we were using 17 features(but we had 19 columns but one was label that is whether it is private or not and other was name of the University ) to create 2 cluster (Private and Goverment)  \n","16ee9762":"<a name='ld'><\/a>\n# 4.Loading dataset","393a7f39":"#### Set that School's graduation rate to 100 so it makes sense. You may get a warning not an error when doing this operation, so use dataframe operations or just re-do the histogram visualization to make sure it actually went through. ","eec407d4":"### About Data ","ebc395ff":"<a name='km'><\/a>\n# 2. What is K-Mean Clustering?"}}