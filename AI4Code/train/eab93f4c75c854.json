{"cell_type":{"6d15ec09":"code","731e9900":"code","bdc3bf8e":"code","37aa2e39":"code","91598c9d":"code","5c3349ae":"code","2276f196":"code","e3daaf8f":"code","0c696ae8":"code","ceb5ad7d":"markdown","fc3eac3f":"markdown","bd0833c1":"markdown","08471254":"markdown","aa63f9ad":"markdown","5e7c92e3":"markdown"},"source":{"6d15ec09":"import numpy as np\nimport matplotlib.pyplot as plt\nimport pandas as pd\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")\nimport os\nprint(os.listdir(\"..\/input\"))","731e9900":"#Importing the dataset\ndataset = pd.read_csv('..\/input\/Social_Network_Ads.csv')\nX= dataset.iloc[:,[2,3]].values\ny=dataset.iloc[:,4].values\ndataset.head()","bdc3bf8e":"#Splitting the dataset into the Training set and Test set\nfrom sklearn.cross_validation import train_test_split\nx_train, x_test, y_train, y_test = train_test_split(X,y,test_size = 0.25, random_state = 0)\n\n#Feature Scaling\nfrom sklearn.preprocessing import StandardScaler\nsc=StandardScaler()\nx_train = sc.fit_transform(x_train)\nx_test = sc.transform(x_test)\n\n","37aa2e39":"import lightgbm as lgb\n\nd_train = lgb.Dataset(x_train, label= y_train)","91598c9d":"params = {}\nparams['learning_rate']= 0.003\nparams['boosting_type']='gbdt'\nparams['objective']='binary'\nparams['metric']='binary_logloss'\nparams['sub_feature']=0.5\nparams['num_leaves']= 10\nparams['min_data']=50\nparams['max_depth']=10","5c3349ae":"clf= lgb.train(params, d_train, 100)","2276f196":"y_pred = clf.predict(x_test)\n\n#convert into binary values\n\nfor i in range(0,100):\n    if (y_pred[i] >= 0.5):\n        y_pred[i] = 1\n    else:\n        y_pred[i] =0\nlen(y_pred)        \n            ","e3daaf8f":"\n#Accuracy\nfrom sklearn.metrics import accuracy_score\naccuracy = accuracy_score(y_pred, y_test)\naccuracy","0c696ae8":"#Confusion matrix\nfrom sklearn.metrics import confusion_matrix\ncm = confusion_matrix(y_test, y_pred)\ncm","ceb5ad7d":"we can check the results either using confusion matrix or directly calculating accuracy","fc3eac3f":"Now let's create dictionary for parameters values","bd0833c1":"final predict the output. Output will be a list of probabilities.","08471254":"Now train model with 100 iterations","aa63f9ad":"Complete tutorial can be found [here](https:\/\/medium.com\/@pushkarmandot\/https-medium-com-pushkarmandot-what-is-lightgbm-how-to-implement-it-how-to-fine-tune-the-parameters-60347819b7fc).\nThanks to Pushkar Mandot for the  tutorial.","5e7c92e3":"First of all let's convert training data into LightGBM dataset format ( this is mandatory for LightGBM to work)"}}