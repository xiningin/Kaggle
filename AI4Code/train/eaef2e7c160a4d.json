{"cell_type":{"3c5d2fd7":"code","1c5ed313":"code","09e479a7":"code","dff9be5d":"code","89bf5250":"code","30c515c1":"code","450b5194":"code","eef25b30":"code","d25ffbbf":"code","72416b5a":"code","006b0287":"code","7a1383fd":"code","94110e41":"code","023dbdc6":"code","df79b234":"markdown","eb976741":"markdown","94d0f44f":"markdown","55ae5451":"markdown"},"source":{"3c5d2fd7":"!pip install -U https:\/\/github.com\/sberbank-ai-lab\/LightAutoML\/raw\/fix\/logging\/LightAutoML-0.2.16.2-py3-none-any.whl","1c5ed313":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nimport missingno as msno\nimport warnings\nwarnings.simplefilter(action='ignore', category=FutureWarning)\n\nfrom lightautoml.automl.presets.tabular_presets import TabularAutoML\nfrom lightautoml.tasks import Task","09e479a7":"df_train = pd.read_csv('..\/input\/tabular-playground-series-aug-2021\/train.csv')\ndf_test = pd.read_csv('..\/input\/tabular-playground-series-aug-2021\/test.csv')","dff9be5d":"df_train.head()","89bf5250":"df_train.info()","30c515c1":"msno.matrix(df_train)","450b5194":"plt.figure(figsize=(16,16))\nsns.heatmap(df_train.corr(),cmap='PuRd')\nplt.show()","eef25b30":"cols = df_train.columns.values\nfig, ax = plt.subplots(25, 4, figsize=(16,100))\ncnt = 0\nfor i in cols:\n    if i == 'loss':\n        break\n    elif i == 'id':\n        continue\n    else:\n        sns.histplot(df_train[i], ax=ax[cnt\/\/4, cnt%4], color='lightskyblue')\n        cnt += 1\n    \nplt.show()","d25ffbbf":"lgb_params = {\n    'metric': 'RMSE',\n    'lambda_l1': 1e-07, \n    'lambda_l2': 2e-07, \n    'num_leaves': 42, \n    'feature_fraction': 0.55, \n    'bagging_fraction': 0.9, \n    'bagging_freq': 3, \n    'min_child_samples': 19,\n    'num_threads': 4\n}\n\ncb_params = {\n    'num_trees': 7000, \n    'od_wait': 1200, \n    'learning_rate': 0.02, \n    'l2_leaf_reg': 64, \n    'subsample': 0.83, \n    'random_strength': 17.17, \n    'max_depth': 6, \n    'min_data_in_leaf': 10, \n    'leaf_estimation_iterations': 3,\n    'loss_function': 'RMSE',\n    'eval_metric': 'RMSE',\n    'bootstrap_type': 'Bernoulli',\n    'leaf_estimation_method': 'Newton',\n    'random_seed': 42,\n    \"thread_count\": 4\n}","72416b5a":"def do_automl(target, train, test):\n    laml = TabularAutoML(task=Task('reg', loss='mse', metric='mse'),\n                         timeout=3*3600, cpu_limit=4,\n                         reader_params = {'n_jobs': 4, 'cv': 10, 'random_state': 42},\n                         general_params = {'use_algos': [['lgb', 'cb']]},\n                         lgb_params = {'default_params': lgb_params, 'freeze_defaults': True}, \n                         cb_params = {'default_params': cb_params, 'freeze_defaults': True},\n                         verbose = 2\n                        )\n    laml.fit_predict(train_data=train, roles={'target': target })\n    pred = laml.predict(test).data.ravel()\n    return(pred)","006b0287":" pred = do_automl('loss', df_train.drop(['id'], axis=1), df_test.drop(['id'], axis=1))","7a1383fd":"pred","94110e41":"sample_sub = pd.read_csv('..\/input\/..\/input\/tabular-playground-series-aug-2021\/sample_submission.csv')\nsubmission = pd.DataFrame({'id': sample_sub.id, 'loss': pred })\nsubmission","023dbdc6":"submission.to_csv('LightAutoML_sub.csv',index=False)","df79b234":"## Setup","eb976741":"## Predict with LightAutoML\nSpecial thanks to [this notebook](https:\/\/www.kaggle.com\/alexryzhkov\/aug21-lightautoml-starter).","94d0f44f":"## Overview\nThere are no missing values and there seems to be no correlation with loss for any of the features. It's so abstract, I don't even know where to begin! I would like to gradually investigate this from now on.I'm not sure we'll know anything within a month.","55ae5451":"# Tabular Playground Series - Aug 2021\nA quick review of the data, predict with LightAutoML"}}