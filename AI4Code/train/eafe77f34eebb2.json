{"cell_type":{"e885a439":"code","9142e589":"code","820d68f8":"code","efa01776":"code","e6e9559e":"code","63b0b254":"code","4c0b2f64":"code","abaf277a":"code","608e0fba":"code","68dfa6c3":"code","724e94c3":"code","d856cae3":"code","f7f6d7c5":"code","a0cb3021":"code","85da6b86":"code","15ee3d87":"code","ca27539b":"code","c28b3272":"code","edc39179":"markdown"},"source":{"e885a439":"import numpy as np\nimport pandas as pd\nimport h2o\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom h2o.automl import H2OAutoML","9142e589":"h2o.init()","820d68f8":"train_df = h2o.import_file('..\/input\/tabular-playground-series-apr-2021\/train.csv',destination_frame='train_df')","efa01776":"test_df = h2o.import_file('..\/input\/tabular-playground-series-apr-2021\/test.csv')","e6e9559e":"train_df.describe()","63b0b254":"train_df = train_df.drop('PassengerId')","4c0b2f64":"predictor_cols = train_df.columns[1:]","abaf277a":"train, valid, test = train_df.split_frame(ratios=[0.6,0.2], seed=1111)\nresponse = \"Survived\"\ntrain[response] = train[response].asfactor()\nvalid[response] = valid[response].asfactor()\ntest[response] = test[response].asfactor()\nprint(\"Number of rows in train, valid and test set : \", train.shape[0], valid.shape[0], test.shape[0])","608e0fba":"aml = H2OAutoML(max_models=7, seed=1)\naml.train(x=predictor_cols, y=response, training_frame=train)","68dfa6c3":"aml.leaderboard","724e94c3":"test_df = test_df.drop('PassengerId')","d856cae3":"pred = aml.predict(test_df)\npred.head()","f7f6d7c5":"p1 = pred['predict']","a0cb3021":"p1_list = h2o.as_list(p1)","85da6b86":"submission = pd.read_csv('..\/input\/tabular-playground-series-apr-2021\/sample_submission.csv')","15ee3d87":"submission","ca27539b":"submission['Survived'] = p1_list['predict'].values","c28b3272":"submission.to_csv('Submission_AutoML.csv',index=False)","edc39179":"![automl](https:\/\/docs.h2o.ai\/h2o\/latest-stable\/h2o-docs\/_images\/h2o-automl-logo.jpg)"}}