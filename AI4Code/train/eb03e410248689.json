{"cell_type":{"a63d9ae5":"code","0f568b94":"code","7ca7970f":"code","b3b0d2b3":"code","d365820f":"code","b1ecf34c":"code","f9fe70fb":"code","9baccd64":"code","445bf619":"code","cbaf21f7":"code","de74112c":"code","4d5f5eab":"code","553ff986":"code","6555b157":"code","7956e530":"code","fdae881d":"code","9e3d5e4c":"code","2ed21810":"code","046ed51f":"code","cb92d004":"code","6824e8cb":"code","998672d7":"code","f401ae89":"code","653d7768":"code","7e2a355a":"code","87eff88f":"code","50519763":"code","930bfa59":"code","954a6f78":"code","8dd281a6":"code","1148a0e5":"code","fa0ccfd0":"code","605d161a":"code","6a9ee23f":"code","a12fac62":"code","afa82408":"code","e97c67c7":"code","665851d5":"code","720f650c":"code","a5331faf":"code","7ad6f066":"code","d42ed92b":"code","8008437d":"code","f66ec379":"code","4d6b00a0":"code","eae81880":"code","7ce15850":"code","d2c7e6e1":"code","6b01dc7c":"code","addea2ea":"code","8b57af38":"code","9f2aa977":"code","860fd7d4":"code","96fc5336":"code","698e075a":"code","e3283dfa":"code","b4e4aac7":"code","4cb4d279":"code","d3e8e7c0":"markdown","92a156cd":"markdown","36835053":"markdown","df204106":"markdown","c73210e4":"markdown","a3d3ebe3":"markdown","9d500d9e":"markdown","d06481b6":"markdown","6f08d552":"markdown","039d072d":"markdown","745a4727":"markdown","85489521":"markdown","2a1f1343":"markdown"},"source":{"a63d9ae5":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","0f568b94":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt","7ca7970f":"stocks = pd.read_csv('..\/input\/stockscsv\/stocks.csv')\nstocks","b3b0d2b3":"ser = stocks.groupby(['Symbol', 'Date']).Close.mean()\nser","d365820f":"ser.index","b1ecf34c":"ser.unstack()","f9fe70fb":"df = stocks.pivot_table(values='Close', index='Symbol', columns='Date')\ndf","9baccd64":"ser","445bf619":"ser.loc['AAPL']","cbaf21f7":"ser.loc['AAPL', '2016-10-03']","de74112c":"ser.loc[:, '2016-10-03']","4d5f5eab":"df","553ff986":"df.loc['AAPL']","6555b157":"df.loc['AAPL', '2016-10-03']","7956e530":"df.loc[:, '2016-10-03']","fdae881d":"stocks.set_index(['Symbol', 'Date'], inplace=True)\nstocks","9e3d5e4c":"stocks.index","2ed21810":"stocks.sort_index(inplace=True)\nstocks","046ed51f":"stocks.loc['AAPL']","cb92d004":"stocks.loc[('AAPL', '2016-10-03'), :]","6824e8cb":"stocks.loc[('AAPL', '2016-10-03'), 'Close']","998672d7":"stocks.loc[['AAPL', 'MSFT'], :]","f401ae89":"stocks.loc[(['AAPL', 'MSFT'], '2016-10-03'), :]","653d7768":"stocks.loc[(['AAPL', 'MSFT'], '2016-10-03'), 'Close']","7e2a355a":"stocks.loc[('AAPL', ['2016-10-03', '2016-10-04']), 'Close']","87eff88f":"stocks.loc[(slice(None), ['2016-10-03', '2016-10-04']), :]","50519763":"close = pd.read_csv('..\/input\/stockscsv\/stocks.csv', usecols=[0, 1, 3], index_col=['Symbol', 'Date']).sort_index()\nclose","930bfa59":"volume = pd.read_csv('..\/input\/stockscsv\/stocks.csv', usecols=[0, 2, 3], index_col=['Symbol', 'Date']).sort_index()\nvolume","954a6f78":"both = pd.merge(close, volume, left_index=True, right_index=True)\nboth","8dd281a6":"both.reset_index()","1148a0e5":"drinks = pd.read_csv('..\/input\/drinks\/drinks.csv')","fa0ccfd0":"drinks.info(memory_usage='deep')","605d161a":"pd.read_csv('..\/input\/stock-abc\/stocks1.csv')","6a9ee23f":"pd.read_csv('..\/input\/stock-abc\/stocks2.csv')","a12fac62":"pd.read_csv('..\/input\/stock-abc\/stocks3.csv')","afa82408":"from glob import glob\nstock_files = sorted(glob('..\/input\/stock-abc\/stocks*.csv'))\nstock_files","e97c67c7":"pd.concat((pd.read_csv(file) for file in stock_files))","665851d5":"#Alternate method\npd.concat((pd.read_csv(file) for file in stock_files), ignore_index=True)","720f650c":"pd.read_csv('..\/input\/all-in-one\/drinks1.csv').head()","a5331faf":"pd.read_csv('..\/input\/all-in-one\/drinks2.csv').head()","7ad6f066":"drink_files = sorted(glob('..\/input\/all-in-one\/drinks*.csv'))","d42ed92b":"pd.concat((pd.read_csv(file) for file in drink_files), axis='columns').head()","8008437d":"df = pd.DataFrame({'name':['John Arthur Doe', 'Jane Ann Smith'],\n                   'location':['Los Angeles, CA', 'Washington, DC']})\ndf","f66ec379":"df.name.str.split(' ', expand=True)","4d6b00a0":"df[['first', 'middle', 'last']] = df.name.str.split(' ', expand=True)\ndf","eae81880":"df.location.str.split(', ', expand=True)","7ce15850":"df['city'] = df.location.str.split(', ', expand=True)[0]\ndf","d2c7e6e1":"df = pd.DataFrame({'col_one':['a', 'b', 'c'], 'col_two':[[10, 40], [20, 50], [30, 60]]})\ndf","6b01dc7c":"df_new = df.col_two.apply(pd.Series)\ndf_new","addea2ea":"pd.concat([df, df_new], axis='columns')","8b57af38":"stocks","9f2aa977":"format_dict = {'Date':'{:%m\/%d\/%y}', 'Close':'${:.2f}', 'Volume':'{:,}'}","860fd7d4":"stocks.style.format(format_dict)","96fc5336":"(stocks.style.format(format_dict)\n .hide_index()\n .highlight_min('Close', color='red')\n .highlight_max('Close', color='lightgreen')\n)","698e075a":"(stocks.style.format(format_dict)\n .hide_index()\n .background_gradient(subset='Volume', cmap='Blues')\n)","e3283dfa":"(stocks.style.format(format_dict)\n .hide_index()\n .bar('Volume', color='lightblue', align='zero')\n .set_caption('Stock Prices from October 2016')\n)","b4e4aac7":"import pandas_profiling","4cb4d279":"pandas_profiling.ProfileReport(drinks)","d3e8e7c0":"# 4.Build a DataFrame from multiple files (column-wise)","92a156cd":"# Profile a DataFrame","36835053":"# 5.Split a string into multiple columns","df204106":"# 2.Reduce DataFrame size","c73210e4":"**a)Series with MultiIndex**","a3d3ebe3":"# 3.Build a DataFrame from multiple files (row-wise)","9d500d9e":"**e)Merging DataFrames with MultiIndexes**","d06481b6":"# 1. MultiIndex in pandas.....","6f08d552":"**b)Selection from Series with MultiIndex**","039d072d":"# 7.Style a DataFrame","745a4727":"**d)Selection from DataFrame with MultiIndex**","85489521":"# 6.Expand a Series of lists into a DataFrame","2a1f1343":"**c)DataFrame with MultiIndex**"}}