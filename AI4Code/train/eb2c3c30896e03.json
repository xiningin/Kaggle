{"cell_type":{"666557fa":"code","1a02169c":"code","d2ea8516":"code","d02e3851":"code","e5f8b6ec":"code","82ce6984":"code","4602d0eb":"code","e67a53c9":"code","fb3ae297":"code","e11d20ce":"code","373856fe":"code","2e003821":"code","343de7fb":"code","397e0f23":"markdown","b3d3b0fa":"markdown","da4e6818":"markdown","4b3ca678":"markdown","2f4722ee":"markdown","3a698bf1":"markdown","e099299f":"markdown"},"source":{"666557fa":"import pandas as pd\nimport os\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nubicacion= \"\/kaggle\/input\/spanish-high-speed-rail-system-ticket-pricing\/high_speed_spanish_trains.csv\"\ndatos= pd.read_csv(ubicacion)","1a02169c":"datos.head()","d2ea8516":"datos.info()","d02e3851":"#normalizar registros\ndatos['price_tree'] = datos['price_tree'].fillna(0.0)\ndatos['price'] = datos['price'].fillna(0.0)\ndatos['train_class'] = datos['train_class'].fillna('None')\ndatos['fare'] = datos['fare'].fillna('None')\ndatos['batch'] = datos['batch'].fillna('None')\n\n#normalizar tipos de datos\ndatos['insert_date'] = pd.to_datetime(datos['insert_date']) \ndatos['origin'].astype(str)\ndatos['destination'].astype(str)\ndatos['start_date'] = pd.to_datetime(datos['start_date']) \ndatos['end_date'] = pd.to_datetime(datos['end_date']) \ndatos['train_type'].astype(str)\ndatos['price'].astype(float)\ndatos['train_class'].astype(str)\ndatos['fare'].astype(str)\ndatos['price_tree'].astype(str)\ndatos['batch'].astype(str)\ndatos['id'].astype(str)","e5f8b6ec":"datos = datos.sample(frac=0.30, random_state=99)\ndatos","82ce6984":"print(\"***Estadisticos para precio***\")\nprint(\"Media: \",datos['price'].mean())\nprint(\"Desviacion Estandar: \",datos['price'].std())\nprint(\"Moda: \",datos['price'].mode())","4602d0eb":"datos['start_date_year'] = pd.DatetimeIndex(datos['start_date']).year\ndatos['start_date_month'] = pd.DatetimeIndex(datos['start_date']).month\ndatos['start_date_day'] = pd.DatetimeIndex(datos['start_date']).day\nstart_date_polarity = datos.groupby([\"origin\", 'start_date_year', 'start_date_month','start_date_day'], as_index=False).count()\nstart_date_polarity.head(10)","e67a53c9":"datos['train_class'].value_counts()","fb3ae297":"medias= datos.groupby([datos['start_date_month']])['destination'].value_counts()\nmedias","e11d20ce":"tarifa1= datos.groupby([datos['train_class']])['price'].mean()\ntarifa1.index.names= [\"CLASE\"]\ntarifa1","373856fe":"tarifa2= datos.groupby([datos['start_date_month'], datos['destination']])['price'].mean()\ntarifa2.index.names= [\"MES\",\"DESTINO\"]\ntarifa2","2e003821":"tarifa3= datos.groupby([datos['destination']])['price'].min()\ntarifa3.index.names= [\"DESTINO\"]\nprint(\"***MIN***\")\ntarifa3","343de7fb":"tarifa4= datos.groupby([datos['destination']])['price'].max()\ntarifa4.index.names= [\"DESTINO\"]\nprint(\"***MAX***\")\ntarifa4","397e0f23":"# Viajes por mes","b3d3b0fa":"# Extraer Datatime","da4e6818":"# **NORMALIZAR**","4b3ca678":"# Tarifas","2f4722ee":"# Datos estadisticos Numerico","3a698bf1":"# Reducir el tama\u00f1o del Dataframe","e099299f":"# Facturas"}}