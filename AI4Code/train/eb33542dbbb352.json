{"cell_type":{"81c4ac27":"code","594e97cb":"code","cc9f1605":"code","26ebd936":"code","7456b856":"code","b57dd06b":"code","8410fc3c":"code","d6443f8b":"code","e5bfa03b":"code","f89504ab":"code","16b6fa9e":"code","326c3920":"code","84e6f006":"code","3d83c86b":"code","a93fff6e":"code","47850acc":"code","45a3731b":"code","886e2bbc":"code","6a9fbbe6":"code","681888bc":"code","ad808fd9":"code","17a2f59d":"code","88975801":"code","24f3bbc3":"markdown","671cbe68":"markdown","37e0bd9d":"markdown","b62f387f":"markdown","e37c07bd":"markdown","db2e543c":"markdown","0c3dd12d":"markdown","9c21f49d":"markdown","66b8e8fd":"markdown","79be72c3":"markdown","0a43daef":"markdown","710d59c5":"markdown","c0a5b011":"markdown","6ffbe0f6":"markdown","530796c8":"markdown","ee420d8b":"markdown","aa84df70":"markdown","34354add":"markdown","ae1ad6d3":"markdown"},"source":{"81c4ac27":"from sklearn import svm\nfrom xgboost import XGBClassifier\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.model_selection import train_test_split\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import classification_report,confusion_matrix,mean_squared_error","594e97cb":"df=pd.read_csv('..\/input\/red-wine-quality-cortez-et-al-2009\/winequality-red.csv')\ndf.head()","cc9f1605":"df.isna().sum()","26ebd936":"plt.figure(figsize=(15,10))\nplt.subplot(2,2,1)\nsns.distplot(df['alcohol'],bins=50)\nplt.subplot(2,2,2)\nsns.distplot(df['pH'],bins=50,color='red')\nplt.subplot(2,2,3)\nsns.distplot(df['sulphates'],bins=50,color='green')\nplt.subplot(2,2,4)\nsns.distplot(df['total sulfur dioxide'],bins=50,color='purple')","7456b856":"plt.figure(figsize=(15,10))\nplt.subplot(2,2,1)\nsns.distplot(df['fixed acidity'],bins=50)\nplt.subplot(2,2,2)\nsns.distplot(df['volatile acidity'],bins=50,color='red')\nplt.subplot(2,2,3)\nsns.distplot(df['citric acid'],bins=50,color='green')\nplt.subplot(2,2,4)\nsns.distplot(df['residual sugar'],bins=50,color='purple')","b57dd06b":"plt.figure(figsize=(15,10))\nplt.subplot(2,2,1)\nsns.distplot(df['chlorides'],bins=50)\nplt.subplot(2,2,2)\nsns.distplot(df['free sulfur dioxide'],bins=50,color='red')\nplt.subplot(2,2,3)\nsns.distplot(df['density'],bins=50,color='green')","8410fc3c":"plt.figure(figsize=(15,10))\nsns.heatmap(df.corr(),annot=True,linewidth=0.2)","d6443f8b":"plt.figure(figsize=(15,10))\nplt.subplot(2,2,1)\nsns.boxplot(df['quality'],df['alcohol'])\nplt.subplot(2,2,2)\nsns.boxplot(df['quality'],df['sulphates'])\nplt.subplot(2,2,3)\nsns.boxplot(df['quality'],df['pH'])\nplt.subplot(2,2,4)\nsns.boxplot(df['quality'],df['density'])","e5bfa03b":"plt.figure(figsize=(15,10))\nplt.subplot(2,2,1)\nsns.boxplot(df['quality'],df['fixed acidity'])\nplt.subplot(2,2,2)\nsns.boxplot(df['quality'],df['volatile acidity'])\nplt.subplot(2,2,3)\nsns.boxplot(df['quality'],df['residual sugar'])\nplt.subplot(2,2,4)\nsns.boxplot(df['quality'],df['citric acid'])","f89504ab":"plt.figure(figsize=(15,10))\nplt.subplot(2,2,1)\nsns.boxplot(df['quality'],df['free sulfur dioxide'])\nplt.subplot(2,2,2)\nsns.boxplot(df['quality'],df['total sulfur dioxide'])","16b6fa9e":"df['quality'].min()","326c3920":"df['quality'].max()","84e6f006":"values = (2, 6, 9)\nqual = ['bad', 'good']\ndf['quality'] = pd.cut(df['quality'], bins = values, labels = qual)\ndf.head()","3d83c86b":"df['quality'].value_counts()","a93fff6e":"le=LabelEncoder()\ndf['quality']=le.fit_transform(df['quality'])","47850acc":"X=df.drop('quality',axis=1)\ny=df['quality']","45a3731b":"xtrain,xtest,ytrain,ytest=train_test_split(X,y,test_size=0.2,random_state=42)","886e2bbc":"sc=StandardScaler()\nxtrain=sc.fit_transform(xtrain)\nxtest=sc.fit_transform(xtest)","6a9fbbe6":"model=svm.SVC()\nmodel.fit(xtrain,ytrain)\nypred=model.predict(xtest)\nprint(accuracy_score(ytest,ypred))","681888bc":"rf=RandomForestClassifier()\nrf.fit(xtrain,ytrain)\ny0pred=rf.predict(xtest)\nprint(accuracy_score(ytest,y0pred))","ad808fd9":"xgb=XGBClassifier(max_depth=3,n_estimators=200,learning_rate=0.5)\nxgb.fit(xtrain,ytrain)\ny1pred=xgb.predict(xtest)\nprint(accuracy_score(ytest,y1pred))","17a2f59d":"print(confusion_matrix(ytest,y1pred))","88975801":"print(classification_report(ytest,y1pred))","24f3bbc3":"Random forest","671cbe68":"The heatmap from seaborn gives the relation between the different features. The negative values show that there is almost no correlation between the 2 respective variables whereas the opposite is true for positive values that appear in the grid.","37e0bd9d":"# Classification models:","b62f387f":"Checking the minimum and maximum value of quality.","e37c07bd":"Since there are no null values, next step will be data visualization and plotting.\nPlotting the various features of the dataset as distplots using seaborn shows the range of values that our features lie in and the distribution of our features over the range. This is just a basic visualization of the features in the dataset to asses their range.","db2e543c":"# Data visualization","0c3dd12d":"Printing the confusion matrix and checking the no. of false and true positives and negatives for the XGBoost classification model.","9c21f49d":"XGBoost classifier-a boosting algorithm","66b8e8fd":"SVM  (Support Vector Machine)","79be72c3":"# Classification report","0a43daef":"# Splitting training and testing data","710d59c5":"# Prediction of quality of red wine","c0a5b011":"Import all the necessary modules for plotting, scaling and classification","6ffbe0f6":"This model has a 90.3% accuracy score which is higher than the other 2 models.","530796c8":"We have 9+22 false predictions","ee420d8b":"Scaling the data and normalizing it to a particular range of values. A pre processing step for faster calculations.","aa84df70":"Now, we have 2 groups i.e. good quality and bad quality wine. This helps us with label encoding to classify data better.","34354add":"Check for the presence of null values","ae1ad6d3":"Now, visualizing the values of the quality of red wine for different features' values as given in the dataset using seaborn's boxplot. It shows us for which values of various features, the quality is the highest."}}