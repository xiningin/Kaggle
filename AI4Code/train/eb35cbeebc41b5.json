{"cell_type":{"17bab53c":"code","c5f2ba2d":"code","12985ddd":"code","4ee4502d":"code","98398d02":"code","7d738819":"code","3622143b":"code","c9001da3":"code","4fb8b15a":"code","ec3ff742":"code","0d753409":"code","bcb342a6":"code","ef718155":"code","2d685ef4":"code","b9894e79":"code","c3eb660b":"code","e7cf5ea7":"code","529ed396":"code","b5fa4e67":"code","5eb8fbfd":"code","8c18b593":"code","7fbdfcc2":"code","e1525d43":"code","1d5b46e0":"code","699e8b5c":"code","a4e7901a":"code","934a7259":"code","f82268de":"code","f51aa13d":"code","d5c83d0c":"code","f91330e6":"code","382b8b71":"code","cdd88353":"code","df261b09":"code","22bb16dd":"code","65ede136":"code","82a979ca":"code","0c29bfaf":"code","8af784d3":"code","10e5696d":"code","e9a33ccf":"code","a2eedb05":"code","0bac12f7":"code","aa1b0002":"code","82d96dbf":"code","9731c1ba":"code","1e158207":"code","506cb062":"code","1edb1a33":"code","744b26a5":"code","13df93d1":"code","45e39869":"code","f0400b52":"markdown","1da0b8ac":"markdown","8ccac597":"markdown","115461dd":"markdown"},"source":{"17bab53c":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport missingno as msno\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\nimport warnings\nwarnings.filterwarnings('ignore')","c5f2ba2d":"data=pd.read_csv('..\/input\/brilliant-diamonds\/diamonds_dataset.csv')","12985ddd":"data.head()","4ee4502d":"data.info()","98398d02":"data.describe()","7d738819":"data.isnull().sum()","3622143b":"plt.figure(figsize=(10,5))\nsns.countplot(data['shape'])\nplt.xticks(rotation=90);","c9001da3":"plt.figure(figsize=(10,5))\nsns.countplot(data['shape'],hue=data['type'])\nplt.xticks(rotation=90);","4fb8b15a":"plt.hist(data['price']);\nplt.xlim(0,150000)","ec3ff742":"plt.figure(figsize=(10,5))\nsns.histplot(data['carat'],bins=80)\nplt.xlim(0,4);","0d753409":"sns.countplot(data['cut'],palette='winter')","bcb342a6":"sns.countplot(data['cut'],palette='summer_r',hue=data['type'])","ef718155":"sns.countplot(data['color'],palette='viridis')","2d685ef4":"sns.countplot(data['color'],palette='viridis',hue=data['type'])","b9894e79":"sns.countplot(data['clarity'],palette='icefire')","c3eb660b":"sns.countplot(data['clarity'],palette='icefire',hue=data['type'])","e7cf5ea7":"sns.countplot(data['report'],palette='Oranges')","529ed396":"sns.countplot(data['report'],palette='Oranges',hue=data['type'])","b5fa4e67":"sns.countplot(data['type'],palette='Set1')","5eb8fbfd":"data.shape","8c18b593":"X=data.drop(['id','url','date_fetched','price'],axis=1)","7fbdfcc2":"X=pd.get_dummies(X)","e1525d43":"y=data['price']","1d5b46e0":"from sklearn.model_selection import train_test_split","699e8b5c":"X_train, X_, y_train, y_ = train_test_split(X, y, test_size=0.30, random_state=101)","a4e7901a":"X_val, X_test, y_val, y_test = train_test_split(X_, y_, test_size=0.30, random_state=101)","934a7259":"from sklearn.preprocessing import StandardScaler","f82268de":"scaler=StandardScaler()","f51aa13d":"scaler=StandardScaler()","d5c83d0c":"X_val=scaler.fit_transform(X_val)","f91330e6":"X_test=scaler.transform(X_test)","382b8b71":"from sklearn.linear_model import LinearRegression,ElasticNetCV, Ridge\nfrom sklearn.ensemble import RandomForestRegressor, GradientBoostingRegressor","cdd88353":"linear_model=LinearRegression()\nlinear_model.fit(X_train,y_train)","df261b09":"elastic_model=ElasticNetCV()\nelastic_model.fit(X_train,y_train)","22bb16dd":"ridge_model=Ridge()\nridge_model.fit(X_train,y_train)","65ede136":"rfr_model=RandomForestRegressor()\nrfr_model.fit(X_train,y_train)","82a979ca":"gbr_model=GradientBoostingRegressor()\ngbr_model.fit(X_train,y_train)","0c29bfaf":"from sklearn.metrics import mean_absolute_error, mean_squared_error","8af784d3":"def report(model):\n    preds = model.predict(X_val)\n    MAE= mean_absolute_error(preds,y_val)\n    MSE=mean_squared_error(preds,y_val)\n    RMSE=np.sqrt(MSE)\n    print('MAE:'+ str(MAE))\n    print('RMSE:'+ str(RMSE))","10e5696d":"print('LINEAR REGRESSION MODEL')\nreport(linear_model)","e9a33ccf":"print('ELASTIC NET CV MODEL')\nreport(elastic_model)","a2eedb05":"print('RIDGE REGRESSION MODEL')\nreport(ridge_model)","0bac12f7":"print('RANDOM FOREST REGRESSOR MODEL')\nreport(rfr_model)","aa1b0002":"print('GRADIENT BOOSTING REGRESSOR MODEL')\nreport(gbr_model)","82d96dbf":"from sklearn.model_selection import GridSearchCV","9731c1ba":"n_estimators=[50,60,70,80,90,100,110,120]\nmax_features=[10,11,12,13,14,15,16,17,18,19,20]\nbootstrap=[True,False]","1e158207":"param_grid={'n_estimators':n_estimators,'max_features':max_features}","506cb062":"grid_model=GridSearchCV(rfr_model,param_grid)","1edb1a33":"grid_model.fit(X_train,y_train)","744b26a5":"grid_model.best_params_","13df93d1":"print('FINAL MODEL')\nreport(grid_model)","45e39869":"preds = grid_model.predict(X_test)\nMAE= mean_absolute_error(preds,y_test)\nMSE=mean_squared_error(preds,y_test)\nRMSE=np.sqrt(MSE)\nprint('RANDOM FOREST REGRESSOR MODEL AFTER HYPERPARAMTER TUNING:')\nprint('MAE:'+ str(MAE))\nprint('RMSE:'+ str(RMSE))","f0400b52":"###### EDA & Data Visualization","1da0b8ac":"Since Random Forest Regressor performed better than the rest so we will perform grid search on Random Forest Regressor and see if we can get better results after hyperparameter tuning.","8ccac597":"###### Data Preprocessing","115461dd":"###### Modelling"}}