{"cell_type":{"f6c88f61":"code","74bbc717":"markdown"},"source":{"f6c88f61":"import pandas as pd\nimport h2o\nfrom h2o.automl import H2OAutoML\n\nh2o.init()\ntrain = h2o.import_file('..\/input\/titanic\/train.csv')\ntest = h2o.import_file('..\/input\/titanic\/test.csv')\n\nlabel ='Survived'\ncolumns = train.columns\ncolumns.remove(label)\naml = H2OAutoML(max_models=3)\ntrain[label] = train[label].asfactor()\naml.train(x=columns, y=label, training_frame=train)\n\nmodel = aml.leader\npreds = model.predict(test)\npreds_df = h2o.as_list(preds)\n\nsubmission = pd.read_csv('..\/input\/titanic\/gender_submission.csv')\nsubmission[label] = preds_df['predict']\nsubmission.to_csv('submission.csv', index=False)\nsubmission.head()","74bbc717":"## version 2021\/03\/15"}}