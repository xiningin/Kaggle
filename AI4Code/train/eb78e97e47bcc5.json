{"cell_type":{"8f2b9a1e":"code","e2b6d849":"code","e88c1a03":"code","11599b33":"code","d90112a8":"code","ee443862":"code","2d4450f5":"code","ec66010a":"code","e80892e0":"code","ddc9815e":"code","256d6373":"code","6556704b":"code","db7f00dc":"code","00c6b60b":"code","0b0aefef":"code","206c8c9a":"code","6191259b":"code","eb120e5d":"code","d6995770":"markdown","9769d458":"markdown","6620501c":"markdown","47b6abea":"markdown","24365a79":"markdown","da843ea3":"markdown","cb6f3559":"markdown","37e4bf8a":"markdown","e19c8c4c":"markdown"},"source":{"8f2b9a1e":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n","e2b6d849":"#read file from kaggle \ndf=pd.read_csv(\"..\/input\/calcofi\/bottle.csv\")\n","e88c1a03":"df.shape","11599b33":"df.head()","d90112a8":"df.describe()","ee443862":"df=df[[\"Salnty\",\"T_degC\"]]","2d4450f5":"df.head()","ec66010a":"print(\"\\nSalinty\\n\",df.Salnty.isnull().value_counts())\nprint(\"\\nTemprature\\n\",df.T_degC.isnull().value_counts())","e80892e0":"df=df.dropna(axis=0)\ndf.reset_index(drop=True,inplace=True)","ddc9815e":"df=df[0:750]#slicing array for as it has a lot of rows ","256d6373":"df.shape","6556704b":"\nplt.figure(figsize=(12,12))\nplt.scatter(df.Salnty,df.T_degC, color='blue')\nplt.xlabel(\"Tempurature\",fontsize=25)\nplt.ylabel(\"Salinity\",fontsize=25)","db7f00dc":"x=np.array(df['Salnty']).reshape(750,1)\ny=np.array(df['T_degC']).reshape(750,1)","00c6b60b":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(x, y, test_size = 0.2, random_state = 100)\n","0b0aefef":"from sklearn.linear_model import LinearRegression\nregr=LinearRegression()\nregr.fit(X_train,y_train)\nprint ('Coefficients: ', regr.coef_)\nprint ('Intercept: ',regr.intercept_)","206c8c9a":"accuracy = regr.score(X_test, y_test)\nprint(accuracy)","6191259b":"plt.figure(figsize=(12,12))\nplt.scatter(x, y,  color='blue')\nplt.plot(X_train, regr.predict(X_train), '-r',linewidth=\"4\")\nplt.xlabel(\"Tempurature\",fontsize=25)\nplt.ylabel(\"Salinity\",fontsize=25)\nplt.title(\"Regression plot\",fontsize=25)\n","eb120e5d":"from sklearn.metrics import r2_score\nypred = regr.predict(X_test)\nprint(\"Mean absolute error: %.2f\" % np.mean(np.absolute(ypred - y_test)))\nprint(\"Residual sum of squares (MSE): %.2f\" % np.mean((ypred - y_test) ** 2))\nprint(\"R2-score: %.2f\" % r2_score(y_test , ypred) )","d6995770":"# Train Test Split\n","9769d458":"# Model  Evaluation \n","6620501c":"## accuracy on test data\n","47b6abea":"\n## reshape into 1-d array","24365a79":"# linear regression between salinity and temprature\n","da843ea3":"### Remove null items and reset the indexes","cb6f3559":"### Checking for null values ","37e4bf8a":"# Regression Plot","e19c8c4c":"# train model\nTrain\/Test Split involves splitting the dataset into training and testing sets respectively, which are mutually exclusive. After which, you train with the training set and test with the testing set. This will provide a more accurate evaluation on out-of-sample accuracy because the testing dataset is not part of the dataset that have been used to train the data."}}