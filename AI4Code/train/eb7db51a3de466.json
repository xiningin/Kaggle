{"cell_type":{"41a86fb3":"code","290106e1":"code","a889c6eb":"code","5652a3cd":"code","fd7555cb":"code","f8facc4b":"code","d80d19de":"code","e6afe4b1":"code","652f1c33":"code","9e425e22":"code","a61bbd77":"code","f1f8bd84":"code","92f532f4":"code","65e7ed0c":"code","ded85812":"code","507c3efe":"code","c22cfb01":"code","9a49b083":"code","8df0c44f":"code","de02fc16":"code","f7da6a77":"code","4b37e22a":"code","b84c8d5b":"code","c712749f":"code","2774c358":"code","26fdeb39":"code","2d7cca31":"code","14347dca":"code","fb41e799":"code","2eca75e9":"code","a58145b3":"code","c2f5298b":"code","512d2199":"code","a3eff416":"code","54ed5dd8":"code","4e953d78":"code","fe19152b":"code","0e93919c":"code","3c453559":"code","566ec308":"code","6847773e":"code","71744de7":"code","183a7ccb":"code","2d33cb9f":"code","7b8b668d":"code","72f81be5":"code","f37fcc7c":"markdown","282d6b74":"markdown","f8a4a99d":"markdown","920ff795":"markdown","713ce7fd":"markdown","b8105996":"markdown","bf2ba1bf":"markdown","a5fb5be9":"markdown","02ac1f67":"markdown","7356fb53":"markdown","58b6ce8c":"markdown","283e627a":"markdown","8bb50666":"markdown","1f1bafbb":"markdown","5859168f":"markdown","e83ac1a1":"markdown"},"source":{"41a86fb3":"#importing the necessary libraries\n\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.cluster import KMeans\nfrom sklearn.preprocessing import PolynomialFeatures\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_squared_error, r2_score\n\nimport seaborn as sns\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n","290106e1":"#reading the data\n\ndata = pd.read_csv(\"\/kaggle\/input\/anz-banking-data\/ANZ.csv\")","a889c6eb":"data.head()","5652a3cd":"#the columns in data\ndata.columns","fd7555cb":"#selecting the necessary columns, with numerical data\ndata=data[[\"customer_id\",\"age\",\"txn_description\",\"balance\",\"amount\"]]","f8facc4b":"data.head()","d80d19de":"#Getting the unique values for the types of transactions\n\nprint(data['txn_description'].unique())","e6afe4b1":"plt.figure(figsize=(10, 6))\nsns.countplot(x=\"txn_description\", data=data)","652f1c33":"plot_data= data.groupby([\"customer_id\"]).mean().reset_index()\nplot_data.head()","9e425e22":"#Finding the Salary for all the customers\n\nsalary=data[data[\"txn_description\"]==\"PAY\/SALARY\"].groupby(\"customer_id\").mean().reset_index()\nsalary=salary[[\"customer_id\",\"amount\"]]\nsalary=salary.rename(columns = {'amount':'salary'})","a61bbd77":"salary.head()","f1f8bd84":"plot_data=pd.merge(plot_data, salary, on=\"customer_id\")\nplot_data.head()","92f532f4":"plt.figure(figsize=(12, 8))\nsns.regplot(x=\"age\", y=\"salary\", data=plot_data)","65e7ed0c":"plt.figure(figsize=(12, 8))\nsns.regplot(x=\"balance\",y= \"salary\", fit_reg=True, data=plot_data)","ded85812":"plt.figure(figsize=(12, 8))\nsns.regplot(x=\"amount\",y= \"salary\", fit_reg=True, data=plot_data)","507c3efe":"#POS indicates transaction made at any business or such, thus it reflects spending behaviour of customer\n\npos=data[data[\"txn_description\"]==(\"POS\"or\"SALES-POS\")].groupby(\"customer_id\").mean().reset_index()\npos=pos[[\"customer_id\",\"amount\"]]\npos=pos.rename(columns = {'amount':'pos'})","c22cfb01":"pos.head()","9a49b083":"len(pos)","8df0c44f":"#Bills and payments made by customer\n\npayment=data[data[\"txn_description\"]==\"PAYMENT\"].groupby(\"customer_id\").mean().reset_index()\npayment=payment[[\"customer_id\",\"amount\"]]\npayment=payment.rename(columns = {'amount':'payment'})","de02fc16":"payment.head()","f7da6a77":"len(payment)","4b37e22a":"#Bank transfer values\n\ninterbank=data[data[\"txn_description\"]=='INTER BANK'].groupby(\"customer_id\").mean().reset_index()\ninterbank=interbank[[\"customer_id\",\"amount\"]]\ninterbank=interbank.rename(columns = {'amount':'interbank'})","b84c8d5b":"interbank.head()","c712749f":"len(interbank)","2774c358":"#Banking via phone\/online pay\n\nphonebank=data[data[\"txn_description\"]=='PHONE BANK'].groupby(\"customer_id\").mean().reset_index()\nphonebank=phonebank[[\"customer_id\",\"amount\"]]\nphonebank=phonebank.rename(columns = {'amount':'phonebank'})","26fdeb39":"phonebank.head()","2d7cca31":"len(phonebank)","14347dca":"customer=data.groupby(\"customer_id\").mean().reset_index()\ncustomer=customer[[\"customer_id\",\"age\",\"balance\"]]\ncustomer.head()","fb41e799":"df=pd.merge(customer, payment, on=\"customer_id\")\ndf=pd.merge(df, pos, on=\"customer_id\")\ndf=pd.merge(df, salary, on=\"customer_id\")","2eca75e9":"df.head()","a58145b3":"plt.figure(figsize=(12, 8))\nsns.regplot(x=\"payment\",y= \"salary\", fit_reg=True, data=df)","c2f5298b":"plt.figure(figsize=(12, 8))\nsns.regplot(x=\"pos\",y= \"salary\", fit_reg=True, data=df)","512d2199":"#Defining the X and y of machine learning\n\nX=df[[\"age\",\"balance\",\"payment\",\"pos\"]].values\ny=df[\"salary\"].values","a3eff416":"#Train,Test splitting\n\nX_train, X_test, y_train, y_test = train_test_split( X, y, test_size=0.2, random_state=42)","54ed5dd8":"#Linear Regression model\n\nlr = LinearRegression()","4e953d78":"#Fitting the model\nlr.fit(X_train, y_train)\n","fe19152b":"#Prediction using \n\ny_pred=lr.predict(X_test)","0e93919c":"#r2 score\nprint('Coefficient of determination: ', r2_score(y_test, y_pred))","3c453559":"#Here we make a sample prediction\n#age=50\n#balance=5000\n#payment=100\n#pos=50\n#age in years and financial values in Australian Dollar","566ec308":"print(\"The model predicts salary will be=\")\nprint(lr.predict([[60,5000,100,50]])[0])","6847773e":"#decision tree regressor \ndt = DecisionTreeRegressor()","71744de7":"#fitting the score and model score\n\ndt.fit(X_train, y_train)\ndt.score(X_train, y_train)","183a7ccb":"#prediction of  test values\n\ndt.predict(X_test)","2d33cb9f":"#score using test values\ndt.score(X_test, y_test)","7b8b668d":"#Here we make a sample prediction\n#age=50\n#balance=5000\n#payment=100\n#pos=50\n#age in years and financial values in Australian Dollar","72f81be5":"print(\"The model predicts salary will be=\")\nprint(dt.predict([[60,5000,100,50]])[0])","f37fcc7c":"# Decision Tree Regressor","282d6b74":"# Finding out the mean \"PHONE BANK\" made by the customer","f8a4a99d":"# Salary and Transaction Amount","920ff795":"# Salary vs Point Of Sale","713ce7fd":"# Finding out the mean salary of each customer","b8105996":"# Salary vs Payments","bf2ba1bf":"# Salary and age","a5fb5be9":"# Relations For New Features","02ac1f67":"# Creating New Features","7356fb53":"# Combining relevant data into a single dataframe","58b6ce8c":"# Create some plots to analyze relation between existing data","283e627a":"# Finding out the mean \"PAYMENT\" made by the customer","8bb50666":"# Finding out mean POS (Point of Sale) for each customer","1f1bafbb":"# Salary and Account Balance","5859168f":"# Finding out the mean 'INTER BANK', that is Bank to Bank transfer by each customer","e83ac1a1":"# Linear Regression Model"}}