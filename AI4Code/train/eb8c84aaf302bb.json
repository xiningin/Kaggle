{"cell_type":{"57763bcd":"code","c7c0329f":"code","b40b3399":"code","4bfcc540":"code","ee0a802c":"code","394a3317":"code","80a7aa9b":"code","f6ec04a0":"code","a834498f":"code","14f7b800":"code","4d5c2546":"code","8759fe4e":"code","45b83f6d":"code","9a837baf":"code","f324f5fb":"markdown","bcab10bd":"markdown","13b73315":"markdown","e5d529c4":"markdown","e5c362f3":"markdown","73f86a28":"markdown"},"source":{"57763bcd":"!pip install fastai -q --upgrade","c7c0329f":"import fastai\nprint(fastai.__version__)","b40b3399":"from fastai.vision.all import *\npath = Path('..\/input\/ballon-dor-2021-images')\npath.ls()","4bfcc540":"def get_dls(bs, size):\n    dblock = DataBlock(blocks = (ImageBlock, CategoryBlock),\n                       get_items = get_image_files,\n                       get_y = parent_label,\n                       splitter = RandomSplitter(),\n                       item_tfms = Resize(size)\n                      )\n    return dblock.dataloaders(path, bs = bs)\n\n","ee0a802c":"dls = get_dls(16, 128)","394a3317":"learn = cnn_learner(dls, resnet34, metrics=accuracy)","80a7aa9b":"learn.lr_find()","f6ec04a0":"learn = cnn_learner(dls, resnet34, metrics=accuracy)\nlearn.fit_one_cycle(10, 1e-3)","a834498f":"learn.dls = get_dls(16, 224)\nlearn.fine_tune(5, 1e-3)","14f7b800":"learn.show_results()","4d5c2546":"interp = Interpretation.from_learner(learn)\ninterp.plot_top_losses(k=3)","8759fe4e":"learn.predict('..\/input\/ballon-dor-2021-images\/Kylian Mbappe\/image_20211118_170126.jpg')","45b83f6d":"learn.export(fname='model.pkl', pickle_module=pickle, pickle_protocol=2)","9a837baf":"reload_model=load_learner('model.pkl', cpu=True, pickle_module=pickle)\nreload_model","f324f5fb":"## Reload model","bcab10bd":"## Predict","13b73315":"## Save model","e5d529c4":"## Interpretation","e5c362f3":"## Show results","73f86a28":"## Enjoy."}}