{"cell_type":{"338e2217":"code","0f282f8f":"code","39cc14ed":"code","53d76f5e":"code","c9847ab9":"code","f4205b32":"code","7df25b01":"code","20c8e545":"code","77660ed9":"code","51188760":"code","cf3d8f54":"code","b10573ab":"code","87226cc4":"code","02934601":"code","6722bd19":"code","9a4a415e":"markdown","03d9640a":"markdown","52671780":"markdown"},"source":{"338e2217":"import numpy as np \nimport pandas as pd \nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import train_test_split,KFold,cross_val_score\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.metrics import accuracy_score\nfrom lightgbm import LGBMRegressor\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.linear_model import LinearRegression\nimport warnings\nplt.rcParams['figure.figsize']=(10,4)\nwarnings.filterwarnings(action='ignore')","0f282f8f":"data=pd.read_csv(\"\/kaggle\/input\/insurance\/insurance.csv\")","39cc14ed":"data.head()","53d76f5e":"data.shape","c9847ab9":"data.info()","f4205b32":"data.columns","7df25b01":"features=['age', 'sex', 'bmi', 'children', 'smoker', 'region']\ntarget='charges'","20c8e545":"X_train,X_test,Y_train,Y_test=train_test_split(data[features],data[target])\ntrain=pd.concat([X_train,Y_train],axis=1)","77660ed9":"plt.figure(figsize=(10,6))\nplt.subplot(3,2,1)\nsns.kdeplot(train['age'],color='navy')\nplt.subplot(3,2,2)\nsns.kdeplot(train['bmi'],color='navy')\nplt.subplot(3,2,3)\nsns.kdeplot(train['charges'],color='navy')\nplt.subplot(3,2,4)\nsns.countplot(train['region'])\nplt.subplot(3,2,5)\nsns.countplot(train['children'])","51188760":"plt.subplot(1,2,1)\nplt.title('Sex')\nplt.pie(train['sex'].value_counts(sort=False),labels=['female','male'],autopct='%.1f%%')\nplt.subplot(1,2,2)\nplt.title('Smoker')\nplt.pie(train['smoker'].value_counts(sort=False),labels=['yes','no'],autopct='%.1f%%')","cf3d8f54":"le=LabelEncoder()\nX_train['sex']=le.fit_transform(X_train['sex'])\nX_train['region']=le.fit_transform(X_train['region'])\nX_train['smoker']=le.fit_transform(X_train['smoker'])\nX_test['sex']=le.fit_transform(X_test['sex'])\nX_test['region']=le.fit_transform(X_test['region'])\nX_test['smoker']=le.fit_transform(X_test['smoker'])","b10573ab":"kf=KFold(n_splits=5)","87226cc4":"lgb=LGBMRegressor()\nlgb.fit(X_train,Y_train)\nresult=lgb.predict(X_test)\nscore=cross_val_score(lgb,pd.Series.to_numpy(Y_test).reshape(-1,1),result.reshape(-1,1),cv=kf)\nscore.mean()","02934601":"dtr=DecisionTreeRegressor()\ndtr.fit(X_train,Y_train)\nresult1=dtr.predict(X_test)\nscore1=cross_val_score(dtr,pd.Series.to_numpy(Y_test).reshape(-1,1),result1.reshape(-1,1),cv=kf)\nscore1.mean()","6722bd19":"lr=LinearRegression()\nlr.fit(X_train,Y_train)\nresult2=lr.predict(X_test)\nscore2=cross_val_score(dtr,pd.Series.to_numpy(Y_test).reshape(-1,1),result2.reshape(-1,1),cv=kf)\nscore2.mean()","9a4a415e":"# Introduction","03d9640a":"LightGBM Model is the best model to predict Medical Cost Data","52671780":"# Exploratory Data Analysis"}}