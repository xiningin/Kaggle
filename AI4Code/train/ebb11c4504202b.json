{"cell_type":{"ef6e7975":"code","8bfda51e":"code","5087bdac":"code","c195e491":"code","d63b36d9":"code","acdbcb11":"code","3ecd7b7f":"code","73fc4dbd":"code","6427922e":"code","efffc9b4":"code","d36dd3fa":"code","0cb415ca":"code","d660bcf8":"code","48fea946":"code","7aedc1a1":"code","fe4c8c55":"code","b87cfead":"code","4d664174":"code","b8a9db6c":"code","9f15493c":"code","7b07547e":"code","5507627c":"code","63b5303e":"code","45044a40":"markdown","3095268d":"markdown","7e29e594":"markdown"},"source":{"ef6e7975":"%reload_ext autoreload\n%autoreload 2\n%matplotlib inline","8bfda51e":"from fastai.tabular import *","5087bdac":"path = Path('\/kaggle\/input\/house-prices-advanced-regression-techniques')\npath.ls()","c195e491":"# Import the datasets\ntrain_df = pd.read_csv(path\/'train.csv')\ntest_df = pd.read_csv(path\/'test.csv')","d63b36d9":"# Check the length of the dataset\nprint(train_df.shape)\nprint(test_df.shape)","acdbcb11":"train_df.head()","3ecd7b7f":"test_df.head()","73fc4dbd":"print(train_df.columns)","6427922e":"train_df.describe()","efffc9b4":"# We can see that there are some missing data, let's check for any null value\ntrain_df.isnull().sum()","d36dd3fa":"# Let's check for the test set as well\ntest_df.isnull().sum()","0cb415ca":"# Fill missing value in the test dataset first\ntest_df.fillna(value=test_df.mean(), inplace=True)","d660bcf8":"# Preprocessing \nprocs = [FillMissing, Categorify, Normalize]","48fea946":"# Split our variables into target, categorical and continuous variables\ndep_var = 'SalePrice'\n\ncat_names = train_df.drop('Id', axis=1).select_dtypes(exclude='number').columns.tolist()\n\ncont_names = train_df.drop('SalePrice', axis=1).select_dtypes(include='number').columns.tolist()\n\nprint(cat_names)\nprint(cont_names)","7aedc1a1":"test = TabularList.from_df(df=test_df, cat_names=cat_names, cont_names=cont_names, procs=procs)","fe4c8c55":"data = (TabularList.from_df(df=train_df, cat_names=cat_names, cont_names=cont_names, procs=procs)\n                   .split_by_rand_pct()\n                   .label_from_df(cols=dep_var, label_cls=FloatList, log=True)\n                   .add_test(test)\n                   .databunch())","b87cfead":"data.show_batch(10)","4d664174":"learn = tabular_learner(data, layers=[10, 10, 10], metrics=rmse)","b8a9db6c":"learn.model_dir = '\/kaggle\/working'","9f15493c":"learn.lr_find()\nlearn.recorder.plot(suggestion=True)","7b07547e":"min_grad_lr = learn.recorder.min_grad_lr\nlearn.fit_one_cycle(30, slice(min_grad_lr))","5507627c":"learn.recorder.plot_losses()","63b5303e":"# Getting prediction\npreds, targets = learn.get_preds(DatasetType.Test)\nlabels = [np.exp(p[0].data.item()) for p in preds]\n\n# Create \"submission.csv\" file\nsubmission = pd.DataFrame({'Id': test_df['Id'], 'SalePrice': labels})\nsubmission.to_csv('submission.csv', index=False)\nsubmission.head()","45044a40":"* We can see that there are 3 columns that have missing values: **MSZoning, LotFrontage, SaleType**","3095268d":"* Now let's use the FastAI Tabular Learner to train our model","7e29e594":"* Now let's explore the training set a little bit"}}