{"cell_type":{"b7dd22c2":"code","936eaa8a":"code","6f8695a0":"code","f16d97d0":"code","8c1e842b":"code","030e6f5d":"code","889cc8c9":"code","d1a5d7a4":"code","0e0307a0":"code","ff396cbb":"code","11907202":"code","8262f611":"code","c26dc9fc":"code","c0f5511c":"code","7cb48b43":"code","701a110c":"code","0a1b8728":"code","e8f49152":"code","f91ce404":"markdown","4c9b04cd":"markdown","06b14262":"markdown","1354899d":"markdown","cbf6d1fb":"markdown","33dc7be2":"markdown","56e85472":"markdown","8044db60":"markdown","da6a6aeb":"markdown","ecd7b6c6":"markdown","239ddc18":"markdown","9e9ad72e":"markdown","bf386e96":"markdown","f5613c76":"markdown","31a80c26":"markdown","4646e685":"markdown"},"source":{"b7dd22c2":"import warnings\nwarnings.filterwarnings('ignore')\n\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\n\npd.options.display.max_rows = 150","936eaa8a":"iris_df = pd.read_csv('https:\/\/github.com\/GPShiva\/Sparks-Internship\/blob\/main\/Iris.csv?raw=true',index_col = 'Id')\niris_df.head()","6f8695a0":"iris_df.dtypes","f16d97d0":"iris_df.describe()","8c1e842b":"iris_df.Species.value_counts()","030e6f5d":"iris_df.isnull().sum()","889cc8c9":"plt.figure(figsize=(20,5))\nj = 1\nfor i in iris_df.iloc[:,:-1].columns:\n    plt.subplot(1,4,j)\n    sns.boxplot(iris_df[i])\n    j+=1","d1a5d7a4":"plt.figure(figsize=(20,5))\nj = 1\nfor i in iris_df.iloc[:,:-1].columns:\n    plt.subplot(1,4,j)\n    sns.distplot(iris_df[i])\n    j+=1","0e0307a0":"sns.pairplot(iris_df,hue='Species')\nplt.show()","ff396cbb":"X = iris_df.drop('Species',axis=1)\ny = iris_df.Species\nX.shape, y.shape","11907202":"from sklearn.model_selection import train_test_split  \nX_train, X_test, y_train, y_test= train_test_split(X, y, test_size= 0.25, random_state=100)","8262f611":"from sklearn.preprocessing import StandardScaler    \nscaler= StandardScaler()  \nX_train= scaler.fit_transform(X_train)    \nX_test= scaler.transform(X_test)","c26dc9fc":"from sklearn.tree import DecisionTreeClassifier\nfrom sklearn.model_selection import GridSearchCV\n\nparams = {'criterion': ['entropy', 'gini'], 'max_depth': [5, 6, 7, 8, 9, 10], 'min_samples_leaf': [1, 3, 5, 7, 9]}\ngs = GridSearchCV(DecisionTreeClassifier(), params, cv=10, n_jobs=-1, verbose=1)\ngs.fit(X_train, y_train)","c0f5511c":"print('Score:',gs.best_score_,'\\nParameters:', gs.best_params_)","7cb48b43":"best_classifier = gs.best_estimator_\nbest_classifier","701a110c":"from sklearn.metrics import confusion_matrix\n\ny_pred = best_classifier.predict(X_test)\ncm = confusion_matrix(y_test, y_pred)\ncm","0a1b8728":"from sklearn import metrics\nprint(\"Accuracy:\",metrics.accuracy_score(y_test, y_pred))","e8f49152":"from sklearn import tree\n\nfig = plt.figure(figsize=(25,20))\ntree.plot_tree(best_classifier, feature_names=iris_df.columns, filled=True)\nplt.show()","f91ce404":"## MODEL BUILDING\n- Using `Decision Tree Classifier` \n- Using `GridSearchCV` to get best parameters which will not make model overfit","4c9b04cd":"## Data Preprocessing\n### `Species` is the target variable here. So, y = `Species` and remaining features are X","06b14262":"### INSIGHT\n- `SepalLengthCm`, `SepalWidthCm` are following `Normal Distribution`.\n- `PetalLengthCm`, `PetalWidthCm` are not following `Normal Distribution`. Thus, maybe much helpful when compared to other two in clustering.","1354899d":"## MODEL EVALUATION\n### Calculating `Accuracy` on the test data","cbf6d1fb":"# Predicting the Species in Iris Dataset\n\n### The purpose is if we feed any new data to this classifier, it would be able to predict the right class accordingly.\n\n### Importing modules","33dc7be2":"### INSIGHT\n- Only `SepalWidthCm` is having outliers.\n- All other are not having any outliers.","56e85472":"### INSIGHT\n- No `Null` values.\n- No need of any datatype conversions.\n- Every species category have equal number of data points. Thus, the dataset is not biased","8044db60":"## Loading CSV and Data Inspection","da6a6aeb":"### INSIGHT\n- `PetalLengthCm`, `PetalWidthCm` columns are much more segmented between species when compared to other two.\n- In `scatter plot` between `SepalWidthCm` and `SepalLenthCm`, we cannot draw a border line between Species `versicolor` and `virginica`\n- Remaining plots look promising.","ecd7b6c6":"## Visualizing the `Decision Tree Model`","239ddc18":"### Checking for null values","9e9ad72e":"### Feature Scaling  \n- Using `StandardScaler` to scale the training data ","bf386e96":"## EDA\n### CHECKING FOR OUTLIERS","f5613c76":"## CONCLUSION\n\n<b> `Accuracy` of the `decision tree model` with `max_depth` at 5 and `min_samples_leaf` is 3 is `94.7%`<\/b>","31a80c26":"### Train-Test Split","4646e685":"### Checking the distribution"}}