{"cell_type":{"14300ef2":"code","2bbbeb04":"code","a57df03a":"code","6f645f60":"code","5ffd1702":"code","bedff4db":"code","8de47831":"code","279d1d41":"code","9ab65727":"code","207f765e":"code","ddcea612":"code","3ac60fb1":"code","fdf42f52":"code","66523069":"code","205d2445":"code","da7789f5":"markdown","da54631c":"markdown","b3b49ac0":"markdown","e3704c10":"markdown","2b98364a":"markdown","9e1a0cd8":"markdown","aa2f27b5":"markdown"},"source":{"14300ef2":"from fastai.tabular.all import *","2bbbeb04":"input_path = \"..\/input\/tabular-playground-series-jun-2021\/\"\ntrain = pd.read_csv(input_path + \"train.csv\")","a57df03a":"train","6f645f60":"train.nunique().sort_values(ascending=False)[:20]","5ffd1702":"train.info()","bedff4db":"train = df_shrink(train)","8de47831":"train.drop(\"id\", axis=1, inplace=True)","279d1d41":"from sklearn.model_selection import StratifiedShuffleSplit\n\nstratified_split = StratifiedShuffleSplit(n_splits=1, test_size=0.2)\nsplits = next(stratified_split.split(train.iloc[:,1:], train[\"target\"]))\nsplits_list = [array.tolist() for array in splits]","9ab65727":"cont,cat = cont_cat_split(train, 105, dep_var=\"target\")\nprocs = [Categorify]\n\nto = TabularPandas(train, procs, cat, cont, y_names=\"target\", splits=splits_list)","207f765e":"dls = to.dataloaders(1024)","ddcea612":"learn = tabular_learner(dls, layers=[200, 100])\nlearn.lr_find()","3ac60fb1":"learn.fit_one_cycle(3, 1e-4, wd=0.8)","fdf42f52":"test = pd.read_csv(input_path + \"test.csv\")\nto_tst = to.new(test)\nto_tst.process()","66523069":"tst_dl = dls.valid.new(to_tst)\npreds, _ = learn.get_preds(dl=tst_dl)","205d2445":"sub = pd.read_csv(input_path + \"sample_submission.csv\")\nsub.iloc[:, 1:] = preds\nsub.to_csv(\"submission.csv\", index=False)","da7789f5":"# Preprocessing","da54631c":"## Neural Net","b3b49ac0":"split the data set in a stratified manner","e3704c10":"preprocess our data using fastai's `TabularPandas`","2b98364a":"prediction of neural net","9e1a0cd8":"form dataloaders for training and validation set","aa2f27b5":"# Predicting"}}