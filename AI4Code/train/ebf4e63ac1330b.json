{"cell_type":{"9f03eddb":"code","23a075dd":"code","cc854462":"code","329e24ff":"code","a1e13779":"code","e4d91722":"code","7470cb62":"code","0061f2d2":"code","ff054da1":"code","709cd10b":"code","6d219582":"code","be5d40a4":"code","4b5fd2a9":"code","cb887b36":"code","966830dc":"code","0433e5a5":"code","41f4570d":"code","ab4694d0":"code","e39f9dcc":"code","d84d6047":"code","18c606e7":"code","515ea5fd":"code","f72afa55":"code","d8e6bc3f":"markdown"},"source":{"9f03eddb":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","23a075dd":"# Import required librarues\n\nimport numpy as np\nimport pandas as pd\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.model_selection import train_test_split\n\nfrom sklearn.preprocessing import RobustScaler\nfrom sklearn.preprocessing import PowerTransformer\nfrom sklearn.preprocessing import QuantileTransformer\n\nfrom sklearn.ensemble import RandomForestClassifier\nfrom xgboost import XGBClassifier\nfrom sklearn.multiclass import OneVsRestClassifier\n\nfrom sklearn.ensemble import ExtraTreesClassifier\nfrom sklearn.tree import DecisionTreeClassifier\n\n\nfrom mlxtend.classifier import StackingCVClassifier\nfrom sklearn.model_selection import cross_val_score\n\nfrom sklearn.metrics import accuracy_score\n\nfrom mlxtend.feature_selection import SequentialFeatureSelector as SFS\nfrom mlxtend.plotting import plot_sequential_feature_selection as plot_sfs","cc854462":"train = pd.read_csv(\"\/kaggle\/input\/learn-together\/train.csv\")\ntest = pd.read_csv(\"\/kaggle\/input\/learn-together\/test.csv\")","329e24ff":"# Remove the Labels and make them y\ny = train['Cover_Type']\n\n# Remove label from Train set\nX = train.drop(['Cover_Type'],axis=1)\n\n# Rename test to text_X\ntest_X = test\n\n\n\n# split data into training and validation data\ntrain_X, val_X, train_y, val_y = train_test_split(X, y, test_size=0.2, random_state=42)\n\nX = X.drop(['Id'], axis = 1)\ntrain_X = train_X.drop(['Id'], axis = 1)\nval_X = val_X.drop(['Id'], axis = 1)\ntest_X = test_X.drop(['Id'], axis = 1)","a1e13779":"train_X.describe()","e4d91722":"val_X.describe()","7470cb62":"sns.distplot(train_X['Elevation'], label = 'train_X')\nsns.distplot(val_X['Elevation'], label = 'val_X')\nsns.distplot(test_X['Elevation'], label = 'test_X')\nplt.legend()\nplt.title('Elevation')\nplt.show()","0061f2d2":"sns.distplot(train_X['Aspect'], label = 'train_X')\nsns.distplot(val_X['Aspect'], label = 'val_X')\nsns.distplot(test_X['Aspect'], label = 'test_X')\nplt.title('Aspect')\nplt.legend()\nplt.show()","ff054da1":"sns.distplot(train_X['Horizontal_Distance_To_Hydrology'], label = 'train_X')\nsns.distplot(val_X['Horizontal_Distance_To_Hydrology'], label = 'val_X')\nsns.distplot(test_X['Horizontal_Distance_To_Hydrology'], label = 'test_X')\nplt.title('Horizontal_Distance_To_Hydrology')\nplt.legend()\nplt.show()","709cd10b":"sns.distplot(train_X['Vertical_Distance_To_Hydrology'], label = 'train_X')\nsns.distplot(val_X['Vertical_Distance_To_Hydrology'], label = 'val_X')\nsns.distplot(test_X['Vertical_Distance_To_Hydrology'], label = 'test_X')\nplt.title('Vertical_Distance_To_Hydrology')\nplt.legend()\nplt.show()","6d219582":"sns.distplot(train_X['Horizontal_Distance_To_Roadways'], label = 'train_X')\nsns.distplot(val_X['Horizontal_Distance_To_Roadways'], label = 'val_X')\nsns.distplot(test_X['Horizontal_Distance_To_Roadways'], label = 'test_X')\nplt.title('Horizontal_Distance_To_Roadways')\nplt.legend()\nplt.show()","be5d40a4":"sns.distplot(train_X['Hillshade_9am'], label = 'train_X')\nsns.distplot(val_X['Hillshade_9am'], label = 'val_X')\nsns.distplot(test_X['Hillshade_9am'], label = 'test_X')\nplt.title('Hillshade_9am')\nplt.legend()\nplt.show()","4b5fd2a9":"### define the classifiers\n\n#classifier_rf = RandomForestClassifier(random_state=42)\n#classifier_xgb = OneVsRestClassifier(XGBClassifier(random_state=42))\nclassifier_et = ExtraTreesClassifier(random_state=42)","cb887b36":"\n#sclf_sbs = StackingCVClassifier(classifiers=[classifier_rf,\n#                                         classifier_xgb,\n#                                         classifier_et],\n#                            use_probas=True,\n#                            meta_classifier=classifier_rf)","966830dc":"### Running Sequential Backward Selection with Random Forest Only\nseqbacksel_et = SFS(classifier_et, k_features = (30, 50),\n                    forward = False, floating = False,\n                    scoring = 'accuracy', cv = 5, \n                    n_jobs = -1)\nseqbacksel_et = seqbacksel_et.fit(train_X, train_y.values.ravel())\n\n\nprint('best combination (ACC: %.3f): %s\\n' % (seqbacksel_et.k_score_, seqbacksel_et.k_feature_idx_))\nprint('all subsets:\\n', seqbacksel_et.subsets_)\nplot_sfs(seqbacksel_et.get_metric_dict(), kind='std_err');","0433e5a5":"train_X_sbs = seqbacksel_et.transform(train_X)\nval_X_sbs = seqbacksel_et.transform(val_X)","41f4570d":"classifier_et.fit(train_X_sbs, train_y.values.ravel())","ab4694d0":"\nvalsbs_pred = classifier_et.predict(val_X_sbs)","e39f9dcc":"acc = accuracy_score(val_y, valsbs_pred)\nprint(acc)","d84d6047":"X_sbs = seqbacksel_et.transform(X)\ntest_X_sbs = seqbacksel_et.transform(test_X)","18c606e7":"classifier_etfin = ExtraTreesClassifier(random_state=42)\nclassifier_etfin.fit(X_sbs, y.values.ravel())","515ea5fd":"test_ids = test[\"Id\"]\ntest_pred = classifier_etfin.predict(test_X_sbs)","f72afa55":"# Save test predictions to file\noutput = pd.DataFrame({'Id': test_ids,\n                       'Cover_Type': test_pred})\noutput.to_csv('submission.csv', index=False)","d8e6bc3f":"### Import the Raw Data"}}