{"cell_type":{"84f07ac1":"code","2f29d1b6":"code","1bc5fb2c":"code","26d3ce29":"code","cc56c06b":"code","326adc8c":"code","e443b2ba":"code","bc14fd8c":"code","ec1a7118":"code","85923467":"code","d9daea17":"code","a379b3cd":"markdown","156e737f":"markdown"},"source":{"84f07ac1":"# !pip install --upgrade transformers\n# !pip install simpletransformers","2f29d1b6":"!pip install --upgrade transformers\n!pip install simpletransformers \n!pip uninstall fsspec -y\n!pip install fsspec==2021.5.0\n!pip install seqeval==0.0.12 simpletransformers==0.45.3 tokenizers==0.8.1rc1 transformers==3.0.2","1bc5fb2c":"import numpy as np\nimport pandas as pd\nimport sklearn\n\nimport torch\nfrom simpletransformers.classification import ClassificationModel\n\nimport warnings\nwarnings.simplefilter('ignore')","26d3ce29":"train_data = pd.read_csv('..\/input\/nlp-with-disaster-tweets-cleaning-data\/train_data_cleaning2.csv')[['text', 'target']]\ntest_data = pd.read_csv('..\/input\/nlp-with-disaster-tweets-cleaning-data\/test_data_cleaning2.csv')[['text']]","cc56c06b":"train_data","326adc8c":"test_data","e443b2ba":"model_type = 'distilbert'\nmodel_name = 'distilbert-base-uncased'\nseed = 100\nmodel_args =  {'fp16': False,\n               'train_batch_size': 4,\n               'gradient_accumulation_steps': 2,\n               'do_lower_case': True,\n               'learning_rate': 1e-05,\n               'overwrite_output_dir': True,\n               'manual_seed': seed,\n               'num_train_epochs': 2}","bc14fd8c":"%%time\n# Training model and prediction\nmodel = ClassificationModel(model_type, model_name, args=model_args) \nmodel.train_model(train_data)\nresult, model_outputs, wrong_predictions = model.eval_model(train_data, acc=sklearn.metrics.accuracy_score)\ny_preds, _, = model.predict(test_data['text'])","ec1a7118":"# Training model accuracy\nprint('accuracy =',result['acc'])","85923467":"# Predicted data\ny_preds[:20]","d9daea17":"# Submission predicted data\ntest_data[\"target\"] = y_preds\ntest_data.to_csv(\"submission.csv\", index=False)","a379b3cd":"# [Real or Not? NLP with Disaster Tweets](https:\/\/www.kaggle.com\/c\/nlp-getting-started)","156e737f":"## This notebook is based on:\n* notebook [NLP with DT: Simple Transformers Research](https:\/\/www.kaggle.com\/vbmokin\/nlp-with-dt-simple-transformers-research) \n* library [**simpletransformers**](https:\/\/github.com\/ThilinaRajapakse\/simpletransformers)\n* dataset [**NLP with Disaster Tweets - cleaning data**](https:\/\/www.kaggle.com\/vbmokin\/nlp-with-disaster-tweets-cleaning-data)"}}