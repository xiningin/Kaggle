{"cell_type":{"44ee6839":"code","7c00fed7":"code","8d38e49c":"code","87a8b1b5":"code","20a03881":"code","cdbcf788":"code","5a3a1e7d":"code","4a219ec1":"code","efe67ba6":"code","b2abd710":"code","6ebb929c":"code","a4c8b998":"code","21157e8b":"code","dccf0f71":"code","40089a38":"code","b6ab3d9d":"code","da60d1f2":"code","7eb652aa":"code","e2dfd0df":"code","5f5db02f":"code","8e39c62b":"code","a93c2927":"code","60d85c84":"code","5fee5430":"code","f83d1c3e":"code","8d05cf14":"code","96ea7225":"code","dd95125e":"code","94ab5c56":"code","3a3a6074":"code","ef806c89":"code","b904c3f8":"code","fdbb3e3c":"code","a11ba63e":"code","16a042c5":"code","75183119":"code","b0bc6740":"code","97384de3":"code","2d4d1b29":"code","f4da7c91":"code","73ded86b":"code","5fd908d9":"code","c5c5801c":"code","c1a9e5b0":"code","969eb9dd":"code","540eae74":"code","572d7b2a":"code","25cc1fc8":"code","fd0daa45":"code","fdde32a3":"code","2e3cc6e6":"code","88a85b67":"code","bd72d8fe":"code","ea8471a5":"code","1881e4e3":"code","4a1c1502":"code","343f8d48":"code","328c43e2":"code","66d9f815":"code","82f3c15b":"code","4da66f47":"code","d4ed0f33":"code","300489c4":"code","6514f07f":"code","b96b160f":"code","2261518e":"code","d10df066":"code","dc8dfc50":"code","d49aa2dd":"code","47ae9fe0":"code","47f92e5a":"code","9f75c099":"code","de4fd382":"code","bcb3c16a":"code","d84054b0":"code","063b33c6":"code","ccc960f5":"code","45c55d6d":"code","c4adff12":"code","fe48e0fd":"code","50f561b2":"code","a2a64ecd":"code","69a59407":"code","dee5f4e1":"code","beb088b3":"code","920d7bea":"code","cf9f4489":"code","a966c2b3":"code","5c9aa132":"code","20c4e8fd":"code","d5265064":"code","015ad9a5":"code","1c0cf6ed":"code","243c887b":"code","f062ee10":"code","7df54418":"code","38ac8de6":"markdown","80bc9763":"markdown","833821c9":"markdown","ae9d6a1a":"markdown","71eeb673":"markdown","fec00865":"markdown","2d0d60c7":"markdown","0d7594ec":"markdown","bfd2be95":"markdown","45558c23":"markdown","5ba2341d":"markdown","ccf1a3e1":"markdown","cc5f7a71":"markdown","a865f433":"markdown","c9d284c0":"markdown","83b1bcf3":"markdown","f30e9fa6":"markdown","6fc0c575":"markdown","9b395364":"markdown","d5d19769":"markdown","186e2dfb":"markdown","302970ac":"markdown","33967be7":"markdown","d253cda6":"markdown","82befc3a":"markdown","3cc74661":"markdown","64ff9919":"markdown","a6308732":"markdown","5bcce14c":"markdown","2c51fa5c":"markdown","d88b949e":"markdown","e583efe2":"markdown","c96c1545":"markdown","c60f92f8":"markdown","aab7f59d":"markdown","2f886b1b":"markdown","8fc5706c":"markdown","7b02bc1f":"markdown","4a37b860":"markdown","3274c03f":"markdown","06f0d45c":"markdown","4b9213f9":"markdown","f93ffb4e":"markdown","92196319":"markdown","deca2948":"markdown","9b69eea3":"markdown","463f2c43":"markdown","6a03be00":"markdown","5dbf105e":"markdown","50a71f63":"markdown","c515b6bc":"markdown","e5d4e199":"markdown","dc092b63":"markdown","af0be654":"markdown"},"source":{"44ee6839":"#import dependencies\nimport matplotlib.pyplot as plt\nimport pandas as pd\nimport seaborn as sns\nimport numpy as np\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn import linear_model\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split\n\nsns.set_palette(\"pastel\")","7c00fed7":"df = pd.read_csv('..\/input\/ushealthinsurancedataset\/insurance.csv')\ndf.head()","8d38e49c":"df.shape","87a8b1b5":"df.describe()","20a03881":"df.isnull().value_counts()","cdbcf788":"df['age'].describe()","5a3a1e7d":"np.median(df['age'])","4a219ec1":"#bins = 8\n#print(bins)\nages_hist = sns.histplot(df['age'], bins=47)\nplt.show()","efe67ba6":"ages_kde = sns.kdeplot(df['age'])\nplt.show()","b2abd710":"sns.boxplot(df['age'])","6ebb929c":"var_1 = df['age'][df['age']==18].value_counts()\nvar_2 = df['age'][df['age']==19].value_counts()\nprint('18 yrs: {} \\n19 yrs: {}'.format(var_1, var_2))","a4c8b998":"sns.countplot(df['sex'])","21157e8b":"bmi = df['bmi']\nbmi.head()","dccf0f71":"bmi.describe()","40089a38":"np.median(bmi)","b6ab3d9d":"sns.kdeplot(bmi)","da60d1f2":"plt.hist(bmi, bins=20)","7eb652aa":"sns.boxplot(bmi)","e2dfd0df":"children = df[['children']]\nchildren.head()","5f5db02f":"children.describe()","8e39c62b":"np.median(children)","a93c2927":"sns.countplot(df['children'])","60d85c84":"children.value_counts()","5fee5430":"smoker=df['smoker']\nsmoker.head()","f83d1c3e":"smoker.value_counts()","8d05cf14":"sns.countplot(df['smoker'])","96ea7225":"smoker.value_counts()['no']\/smoker.value_counts()['yes']","dd95125e":"region = df['region']\nregion.head()","94ab5c56":"region.value_counts()","3a3a6074":"sns.countplot(region)","ef806c89":"charges = df['charges']\ncharges.head()","b904c3f8":"charges.describe()","fdbb3e3c":"np.median(charges)","a11ba63e":"sns.distplot(charges)","16a042c5":"sns.boxplot(charges)","75183119":"sns.scatterplot(x=df['age'], y=df['charges'])","b0bc6740":"women = df[['sex', 'charges']][df['sex'] == 'female']\nmen = df[['sex', 'charges']][df['sex'] == 'male']\n\nwomen_median = np.median(women['charges'])\nmen_median = np.median(men['charges'])\nprint('Median Charges for Men: ', men_median, '\\nMedian Charges for Women: ', women_median, '\\nDifference: ', women_median-men_median)","97384de3":"sns.barplot(data=df, x='sex', y='charges')","2d4d1b29":"plt.hist(df['charges'][df['sex']=='female'], alpha=0.4, label='Female')\nplt.hist(df['charges'][df['sex']=='male'], alpha=0.4, label='Male')\nplt.legend()","f4da7c91":"sns.boxplot(data=df, x='sex', y='charges')","73ded86b":"sns.scatterplot(x=df['bmi'], y=df['charges'])","5fd908d9":"sns.barplot(data=df, x='children', y='charges')","c5c5801c":"sns.boxplot(data=df, x='children', y='charges')","c1a9e5b0":"sns.kdeplot(df['charges'][df['children']==0], shade=True, label = '0 Children')\nsns.kdeplot(df['charges'][df['children']==1], shade=True, label='1 Child')\nsns.kdeplot(df['charges'][df['children']==2], shade=True, label='2 Children')\nsns.kdeplot(df['charges'][df['children']==3], shade=True, label='3 Children')\nsns.kdeplot(df['charges'][df['children']==4], shade=True, label='4 Children')\nsns.kdeplot(df['charges'][df['children']==5], shade=True, label='5 Children')\n\nplt.legend()","969eb9dd":"sns.barplot(data=df, x='smoker', y='charges')","540eae74":"sns.boxplot(data=df, x='smoker', y='charges')","572d7b2a":"sns.kdeplot(df['charges'][df['smoker']=='yes'], shade=True, label='Smoker')\nsns.kdeplot(df['charges'][df['smoker']=='no'], shade=True, label='Non-Smoker')\n\nplt.legend()","25cc1fc8":"sns.barplot(data=df, x='region', y='charges')","fd0daa45":"sns.boxplot(data=df, x='region', y='charges')","fdde32a3":"sns.kdeplot(df['charges'][df['region']=='southwest'], shade=True, label='Southwest')\nsns.kdeplot(df['charges'][df['region']=='southeast'], shade=True, label='Southeast')\nsns.kdeplot(df['charges'][df['region']=='northwest'], shade=True, label='Northwest')\nsns.kdeplot(df['charges'][df['region']=='northeast'], shade=True, label='Northeast')\n\nplt.legend()","2e3cc6e6":"sns.heatmap(df.corr(), center=0, cmap='YlGnBu', robust=True, annot=True)","88a85b67":"sns.scatterplot(data=df, x='age', y='charges', hue='sex')","bd72d8fe":"sns.scatterplot(data=df, x='age', y='charges', hue='bmi')","ea8471a5":"sns.scatterplot(data=df, x='age', y='charges', hue='children')","1881e4e3":"sns.scatterplot(data=df, x='age', y='charges', hue='smoker')","4a1c1502":"sns.scatterplot(data=df, x='age', y='charges', hue='region')","343f8d48":"def age_bucket(df):\n    if df['age'] > 45:\n        return 'older'\n    elif (df['age'] >= 31) & (df['age'] <=45):\n        return 'middle age'\n    else:\n        return 'young'\n\ndf['age_bucket'] = df.apply(age_bucket, axis=1)\n\ndf['age_bucket'].value_counts()","328c43e2":"sns.barplot(data=df, x='age_bucket',y='charges')","66d9f815":"sns.barplot(data=df, x='age_bucket', y='charges', hue='sex')","82f3c15b":"sns.barplot(data=df, x='age_bucket', y='charges', hue='smoker')","4da66f47":"sns.barplot(data=df, x='age_bucket', y='charges', hue='children')","d4ed0f33":"sns.barplot(data=df, x='age_bucket', y='charges', hue='region')","300489c4":"df.head()","6514f07f":"sns.scatterplot(data=df, x='bmi', y='charges', hue='sex')","b96b160f":"sns.scatterplot(data=df, x='bmi', y='charges', hue='age_bucket')","2261518e":"sns.scatterplot(data=df, x='bmi', y='charges', hue='children')","d10df066":"df['bmi'].describe()","dc8dfc50":"def bmi_bucket(df):\n    if df['bmi'] > 34:\n        return 'high bmi'\n    elif (df['bmi'] <=34) & (df['bmi'] >=26):\n        return 'medium bmi'\n    else:\n        return 'low bmi'\n\ndf['bmi bucket'] = df.apply(bmi_bucket, axis=1)\n\ndf['bmi bucket'].value_counts()","d49aa2dd":"sns.countplot(df['bmi bucket'].sort_values(), order=['low bmi', 'medium bmi', 'high bmi'])","47ae9fe0":"sns.barplot(data=df, x='sex', y='charges', hue='bmi bucket')","47f92e5a":"sns.barplot(data=df, x='sex', y='charges', hue='region')","9f75c099":"sns.barplot(data=df, x='sex', y='charges', hue='age_bucket')","de4fd382":"df.head()","bcb3c16a":"sns.countplot(df['children'])","d84054b0":"sns.boxplot(data=df, x='children', y='charges')","063b33c6":"def children_bucket(df):\n    if df['children'] == 0:\n        return 'no children'\n    elif (df['children'] >= 1) & (df['children']<=3):\n        return '1-3 children'\n    else:\n        return '4+ children'\ndf['children bucket'] = df.apply(children_bucket, axis=1)","ccc960f5":"df['children bucket'].value_counts()","45c55d6d":"df.head()","c4adff12":"df_cat = df[['age_bucket', 'sex', 'bmi bucket', 'children bucket', 'smoker', 'region']]\nli = ['age', 'sex', 'bmi', 'children', 'smoker', 'region']\ndf_onehot_cat = pd.get_dummies(df_cat, prefix = li)\ndf_onehot_cat.head()","fe48e0fd":"X=df_onehot_cat\ny=df[['charges']]","50f561b2":"#feature scaling for charges\n\n#Standard Scaler\n\nsc = StandardScaler()\ny = sc.fit_transform(y)","a2a64ecd":"# split data between training and testing datasets using SKLearn's train test split\n\nX_train, X_test, y_train, y_test = train_test_split(X,y,test_size = 0.2, random_state=1)","69a59407":"X_train","dee5f4e1":"y_train","beb088b3":"y_test","920d7bea":"regr = linear_model.LinearRegression()\nregr.fit (X_train, y_train)\n# The coefficients & intercept\nprint ('Coefficients: ', regr.coef_)\nprint ('Intercept: ',regr.intercept_)","cf9f4489":"# training data\nregr.score(X_train, y_train)","a966c2b3":"# testing data\n\nregr.score(X_test, y_test)","5c9aa132":"df_cat2 = df[['age', 'sex', 'bmi', 'children', 'smoker', 'region']]\ndf_onehot_cat2 = pd.get_dummies(df_cat2, columns=['sex', 'children', 'smoker', 'region'])\ndf_onehot_cat2.head()","20c4e8fd":"df_onehot_cat2_temp = df_onehot_cat2[['age', 'bmi']]\ndf_onehot_cat2_temp2 = df_onehot_cat2.drop(columns=['age', 'bmi'])\n\ndf_onehot_cat2_temp = sc.fit_transform(df_onehot_cat2_temp)\ndf_onehot_cat2_temp = pd.DataFrame(df_onehot_cat2_temp, columns=['age', 'bmi'])\ndf_onehot_cat2_temp.head()","d5265064":"df_onehot_cat2_temp = pd.concat([df_onehot_cat2_temp, df_onehot_cat2_temp2], axis=1)\ndf_onehot_cat2_temp","015ad9a5":"y","1c0cf6ed":"X_train2, X_test2, y_train2, y_test2 = train_test_split(df_onehot_cat2_temp,y,test_size = 0.2, random_state=1)","243c887b":"regr2 = linear_model.LinearRegression()\nregr2.fit (X_train2, y_train2)\n# The coefficients\nprint ('Coefficients: ', regr2.coef_)\nprint ('Intercept: ',regr2.intercept_)","f062ee10":"# performance of training set\n\nregr2.score(X_train2, y_train2)","7df54418":"# testing set\nregr2.score(X_test2, y_test2)","38ac8de6":"We see that although males and females have roughly the same average charges, a higher percentage of males have higher charges than females, and the max value for charges is higher for males by ~USD 10,000","80bc9763":"We see the distribution of # of children is left-skewed, with most individuals having 0 children, with decreasing numbers having increasing numbers of children.","833821c9":"# Smoker Analysis","ae9d6a1a":"Regression Model 2 - the second model will retain the numerical age and bmi variables","71eeb673":"This chart clearly illustrates the higher charges that smokers typically pay regardless of age.","fec00865":"# Data Preprocessing & Modeling","2d0d60c7":"The breakdown by region is fairly similar, though we see a bit higher concentration of high-charge values in the southeast region.","0d7594ec":"## Multivariate Analysis","bfd2be95":"As we can see this appears to be a fairly uniform distribution, though the number of 18 year olds and 19 year olds is almost double the number of every other age group.","45558c23":"### Children","5ba2341d":"We are all good!","ccf1a3e1":"The BMI feature follows a fairly standard distribution, as can be seen above.  BMI is ~30 on average, and we see seveeral outliers on the higher end past ~46","cc5f7a71":"# Bivariate Analysis (charges)","a865f433":"### Smoker","c9d284c0":"Let's bucket the number of children as well.","83b1bcf3":"Using charges as our independent variable of interest, let's take a look at how charges vary with the features.","f30e9fa6":"We see more high-charge values with higher BMI values, but we can see heteroskedasticity in the data.","6fc0c575":"This one seems pretty intuitive as well.","9b395364":"BMI ranges from ~16 to ~53.  The mean and median BMI are ~30.  The IQR falls between ~26 and ~35.  ","d5d19769":"# Age Analysis","186e2dfb":"We have a nice even mix of the 4 different regions around the US.  Great representation!","302970ac":"Regression Model 1 - the first model will use only categorical features, including the buckets created from the numerical features.","33967be7":"# Children Analysis","d253cda6":"### BMI","82befc3a":"This looks nice and clean. Let's further breakdown by segments of each age group.","3cc74661":"Check for missing values in the dataset.","64ff9919":"## This notebook will explore insurance premiums and attempt to predict premium charges from demographic information.","a6308732":"Slight positive trend can be seen as age increases, charges tend to increase as well.","5bcce14c":"# Charges Analysis","2c51fa5c":"Let's take a look at age","d88b949e":"Similarly to the age groups, we will now bucket the BMI into low, medium and high, based on the IQR for BMI.","e583efe2":"Since we have a large range for age values, let's bucket the ages into young, middle-age, and older age buckets.  This may help simplify a few things.","c96c1545":"### Age","c60f92f8":"We can see heavy left-skew with the majority of charges falling below ~USD 20,000, with a slight uptick around the USD 40,000 - 50,000 range.  There are a very large number of outliers on the high end, at ~USD 35,000 and above.\n","aab7f59d":"Even mix of female and male.  Nice.","2f886b1b":"The hospital charges range from USD 1,122 to USD 63,770, with a mean of USD 13,270 but a median of USD 9,382.  Let's get a closer look.","8fc5706c":"Age ranges from 18 to 64. Average and median age is 39, and IQR is between ages 27 and 51. ","7b02bc1f":"Let's check how the  second model performed.","4a37b860":"I hope you enjoyed my EDA and basic model development on the insurance charges dataset. Any and all feedback would be greatly appreciated!","3274c03f":"### Region","06f0d45c":"We see the charges are clearly higher for older people vs middle age, and higher for middle age vs young, across all BMI types.","4b9213f9":"# BMI Analysis","f93ffb4e":"In each age group, we see that males typically experience higher charges on average then females do.","92196319":"Note the greater differential in charges for males of high bmi vs medium bmi compared with the differential between females of high bmi vs females of medium bmi. Let's explore the other features.","deca2948":"# An Analysis of Insurance Premiums","9b69eea3":"People with 5 children are concentrated around the ~USD 10,000 range with few outliers.  People with 2-4 children have the highest average and IQR for charges.","463f2c43":"The majority of individuals are non-smokers, with non-smokers outweighing smokers by a factor of 3.88.  Woo hoo!","6a03be00":"# Region Analysis","5dbf105e":"The number of children ranges from 0 to 5, with the IQR falling between 0 and 2.  The mean and median number of children is 1\n","50a71f63":"We can clearly see the significantly higher charges for smokers vs non-smokers from the plots above.  Seems pretty intuitive, but something to keep in mind as we move forward.","c515b6bc":"Let's see the performance of our first model.","e5d4e199":"The highest score for my linear regression model came out to .76","dc092b63":"# Sex Analysis","af0be654":"Something interesting to note is the degree of differential between the regions as the age bucket increases, e.g. northwest surpasses northeast in the older age bucket.  Let's take a look at BMI now."}}