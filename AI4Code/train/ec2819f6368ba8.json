{"cell_type":{"2f339263":"code","4a991176":"code","312dfd6d":"code","aa27588c":"code","29129dd4":"code","be2d5d4a":"code","4ea7cccd":"code","1bd54c5e":"code","57fa2f1c":"code","a2337388":"markdown","9098c6d5":"markdown","b3ab010d":"markdown","b3de9b23":"markdown"},"source":{"2f339263":"!pip install fastai2 -q","4a991176":"# Import the library\nfrom fastai2.vision.all import *\n\n# Download the dataset\npath = untar_data(URLs.PETS)\/'images'\n\n# Function for determining labels of images\ndef is_cat(x): return x[0].isupper()\n\n# Create data loaders\ndls = ImageDataLoaders.from_name_func(\n    path,                   # working directory\n    get_image_files(path),  # list of filenames\n    valid_pct=0.2,          # validation set (20%)\n    seed=42,                # fix random number generator\n    label_func=is_cat,      # provide label_func\n    item_tfms=Resize(224))  # image size\n\n# Create learner\nlearn = cnn_learner(dls, resnet34, metrics=error_rate)\n\n# Fine tune the top layers\nlearn.fine_tune(1)","312dfd6d":"import os\n\nos.listdir(path)[:10]","aa27588c":"# Change this to see different images\nfname = 'english_setter_6.jpg'\n\n# Load it using PIL\nimg = PILImage.create(path\/fname)\n\n# View the image\nimg.to_thumb(192)","29129dd4":"is_cat,_,probs = learn.predict(img)\nprint(f\"Is this a cat?: {is_cat}.\")\nprint(f\"Probability it's a cat: {probs[1].item():.6f}\")","be2d5d4a":"pip install jovian --upgrade -q","4ea7cccd":"import jovian","1bd54c5e":"# Check out the options jovian.commit provides\n?jovian.commit","57fa2f1c":"jovian.commit(message='Simple image classification example', project='fastai2-lesson1', privacy='secret', environment='pip')\n\n# Run this cell twice if you get blank notebook the first time","a2337388":"Let's take a quick look into the files that were downloaded. You will notice that breeds of cats start with an uppercase letter e.g. Maine, Persian etc. and breeds of dogs start with lowercase e.g. boxer, beagle etc. This is why the labeling function `label_func` checks the first character of the filename.","9098c6d5":"## Save and Commit\n\nYou can save your work to Jovian by running `jovian.commit`","b3ab010d":"Let's load up an image and pass it into the model.","b3de9b23":"## Training an Image Classification model using FastAI v2\n\nAll it takes is 6 lines of code!"}}