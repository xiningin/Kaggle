{"cell_type":{"274c2049":"code","779467cf":"code","aaa73224":"code","ca391c04":"code","b76715bc":"code","9866f73a":"code","34ef7b2b":"code","33d130e5":"code","0b287c17":"code","08722700":"code","87b62642":"code","9fc56026":"code","e9557ab9":"code","cf268151":"markdown"},"source":{"274c2049":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","779467cf":"import h2o\nfrom h2o.automl import H2OAutoML\n\nh2o.init(max_mem_size='15G')","aaa73224":"%%time\ntrain = h2o.import_file(\"..\/input\/vsb-train-test-1\/train_new.csv\")\ntest = h2o.import_file(\"..\/input\/vsb-train-test-1\/test_new.csv\")","ca391c04":"train = train.drop(['id_measurement','phase'])\ntest = test.drop(['id_measurement','phase'])","b76715bc":"train.describe()","9866f73a":"x = train.columns\ny = \"target\"","34ef7b2b":"# For binary classification, response should be a factor\ntrain[y] = train[y].asfactor()\nx.remove(y)","33d130e5":"%%time\n# Run AutoML for 50 base models (limited to 1 hour max runtime by default)\naml = H2OAutoML(max_models=50, seed=42, max_runtime_secs=7200)\naml.train(x=x, y=y, training_frame=train)","0b287c17":"lb = aml.leaderboard\nlb.head(rows=lb.nrows) ","08722700":"aml.leader # Best model","87b62642":"preds = aml.predict(test)","9fc56026":"predictions = preds[0].as_data_frame().values.flatten()","e9557ab9":"x_filename = pd.read_csv('..\/input\/vsb-train-test-1\/test_new.csv')['signal_id']\nsub_df = pd.DataFrame({\"signal_id\":x_filename})\nsub_df[\"target\"] = pd.Series(predictions).round()\nsub_df['signal_id'] = sub_df['signal_id'].astype(np.int64)\nsub_df['target'] = sub_df['target'].astype(np.int64)\nsub_df.to_csv(\"submission.csv\", index=False)\nsub_df","cf268151":"### cf. https:\/\/www.kaggle.com\/bluexleoxgreen\/simple-feature-lightgbm-baseline"}}