{"cell_type":{"2a30e7aa":"code","2d80bc1e":"code","89c59b21":"code","62b4a8ac":"code","5eaf49f9":"code","94efe05f":"code","17d09571":"code","b00c627b":"markdown","e401f0a7":"markdown","23d7a961":"markdown"},"source":{"2a30e7aa":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport datetime\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score\nimport tensorflow as tf\nfrom tensorflow.keras import models, layers\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\nfrom keras.callbacks import ModelCheckpoint, EarlyStopping, ReduceLROnPlateau\nfrom tensorflow.keras.applications import ResNet50, DenseNet121, EfficientNetB0\nfrom keras.optimizers import Adam\n\n# ignoring warnings\nimport warnings\nwarnings.simplefilter(\"ignore\")\n\nimport os, cv2, json\nfrom PIL import Image","2d80bc1e":"TARGET_SIZE = 224\n\nWORK_DIR = '..\/input\/cassava-leaf-disease-classification'\nos.listdir(WORK_DIR)","89c59b21":"def create_model():\n    model = models.Sequential()\n\n    model.add(EfficientNetB0(include_top = False, weights = None,\n                             input_shape = (TARGET_SIZE, TARGET_SIZE, 3)))\n    \n    model.add(layers.GlobalAveragePooling2D())\n    model.add(layers.Dense(5, activation = \"softmax\"))\n\n    model.compile(optimizer = Adam(lr = 0.001),\n                  loss = \"sparse_categorical_crossentropy\",\n                  metrics = [\"acc\"])\n    return model\n\nmodel = create_model()\nmodel.summary()","62b4a8ac":"model.load_weights(\"..\/input\/cassava-leaf-disease-keras-cnn-baseline\/best_baseline_model.h5\")","5eaf49f9":"ss = pd.read_csv(os.path.join(WORK_DIR, \"sample_submission.csv\"))\nss","94efe05f":"preds = []\n\nfor image_id in ss.image_id:\n    image = Image.open(os.path.join(WORK_DIR,  \"test_images\", image_id))\n    image = image.resize((TARGET_SIZE, TARGET_SIZE))\n    image = np.expand_dims(image, axis = 0)\n    preds.append(np.argmax(model.predict(image)))\n\nss['label'] = preds\nss","17d09571":"ss.to_csv('submission.csv', index = False)","b00c627b":"# Prediction","e401f0a7":"# **Cassava Leaf Disease Classification:** \n# **CNN Keras Baseline Prediction**\n![Cassava](https:\/\/scx2.b-cdn.net\/gfx\/news\/2019\/3-geneeditingt.jpg)\n\n\n## The first part of this notebook: [Cassava Leaf Disease: CNN Keras Baseline](https:\/\/www.kaggle.com\/maksymshkliarevskyi\/cassava-leaf-disease-keras-cnn-baseline)\n\n## See also the last part of this work with my best CNN: [Cassava Leaf Disease: Best Keras CNN](https:\/\/www.kaggle.com\/maksymshkliarevskyi\/cassava-leaf-disease-best-keras-cnn)","23d7a961":"## SEE THE [FIRST PART OF THIS NOTEBOOK](https:\/\/www.kaggle.com\/maksymshkliarevskyi\/cassava-leaf-disease-keras-cnn-baseline)"}}