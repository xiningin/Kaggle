{"cell_type":{"23c8e2ad":"code","acf84472":"code","02590639":"markdown","460ff2c4":"markdown"},"source":{"23c8e2ad":"from keras import layers, models\nfrom keras.datasets import mnist\nfrom keras.utils import to_categorical\nfrom keras.preprocessing.image import ImageDataGenerator\nimport pandas as pd\n\ntrain = pd.read_csv(\"..\/input\/digit-recognizer\/train.csv\")\ny_train = train[\"label\"]\nX_train = train.drop(labels=[\"label\"], axis=1)\n\nX_train \/= 255\nX_train = X_train.to_numpy().reshape(-1, 28, 28, 1)\ny_train = to_categorical(y_train)\n\nmodel = models.Sequential()\nmodel.add(layers.Conv2D(filters=32, kernel_size=(5, 5), activation=\"relu\", padding=\"same\", input_shape=(28, 28, 1)))\nmodel.add(layers.Conv2D(filters=32, kernel_size=(5, 5), activation=\"relu\", padding=\"same\"))\nmodel.add(layers.MaxPooling2D(pool_size=(2, 2)))\nmodel.add(layers.Dropout(0.25))\nmodel.add(layers.Conv2D(filters=64, kernel_size=(5, 5), activation=\"relu\", padding=\"same\"))\nmodel.add(layers.Conv2D(filters=64, kernel_size=(5, 5), activation=\"relu\", padding=\"same\"))\nmodel.add(layers.MaxPooling2D(pool_size=(2, 2), strides=(2, 2)))\nmodel.add(layers.Dropout(0.25))\nmodel.add(layers.Flatten())\nmodel.add(layers.Dense(256, activation=\"relu\"))\nmodel.add(layers.Dropout(0.5))\nmodel.add(layers.Dense(10, activation=\"softmax\"))\n\ndatagen = ImageDataGenerator(rotation_range=10, width_shift_range=0.1, height_shift_range=0.1, zoom_range=0.1)\n\nmodel.compile(loss=\"categorical_crossentropy\", optimizer=\"rmsprop\", metrics=[\"acc\"])","acf84472":"history = model.fit_generator(datagen.flow(X_train, y_train, batch_size=32), \n                              epochs=30, \n                              steps_per_epoch=len(X_train))","02590639":"More information here: https:\/\/www.kaggle.com\/questions-and-answers\/168203","460ff2c4":"If I run this notebook with the GPU acceleration, the above line always stops after about 30 seconds."}}