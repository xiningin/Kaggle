{"cell_type":{"6aac2486":"code","9bbf080f":"code","90546b74":"code","647bdd25":"code","46cc9a8c":"code","160a4cc8":"code","0a2aa0e0":"code","b7c3b8e7":"code","2cc195f7":"code","86e87319":"code","de2a234f":"code","e484b645":"code","0b08db71":"code","73093d9b":"code","1321c9fc":"markdown"},"source":{"6aac2486":"from tensorflow.keras.layers import Flatten, Dense, Input, Lambda, Conv2D, MaxPooling2D\nfrom tensorflow.keras.applications.resnet_v2 import ResNet50V2, preprocess_input\nfrom tensorflow.keras.models import Model, Sequential\nfrom tensorflow.keras.preprocessing import image\nfrom tensorflow.keras.preprocessing.image import load_img,ImageDataGenerator, img_to_array\nimport tensorflow as tf\n\nimport numpy as np\nfrom glob import glob\nimport os\nimport matplotlib.pyplot as plt ","9bbf080f":"IMAGE_SIZE = [150,150]\ntrain_path = '..\/input\/intel-image-classification\/seg_train\/seg_train'\nvalid_path = '..\/input\/intel-image-classification\/seg_test\/seg_test'","90546b74":"resent_model = ResNet50V2(include_top=False, weights='imagenet', input_shape=IMAGE_SIZE + [3])","647bdd25":"for layer in resent_model.layers:\n    layer.trainable = False","46cc9a8c":"resent_model.summary()","160a4cc8":"x = Conv2D(128, (3, 3), activation='relu')(resent_model.output)\nx = MaxPooling2D(pool_size=(2, 2))(x)\nx = Flatten()(x)\nx = Dense(100,activation='relu')(x)\nx = Dense(6,activation='softmax')(x)\n\nmodel = Model(inputs=resent_model.input, outputs=x)","0a2aa0e0":"model.summary()","b7c3b8e7":"model.compile(\n    optimizer='adam',\n    loss='categorical_crossentropy',\n    metrics = ['accuracy']\n)","2cc195f7":"train_datagen = ImageDataGenerator(\n    rescale = 1.\/255,\n    shear_range = 0.2,\n    horizontal_flip = True,\n    rotation_range=20,\n    width_shift_range=0.2,\n    height_shift_range=0.2,\n)\n\ntest_datagen = ImageDataGenerator(\n    rescale = 1.\/255\n)\n","86e87319":"training_set = train_datagen.flow_from_directory(train_path,\n                                                 target_size = (150,150),\n                                                 batch_size = 128,\n                                                 class_mode = 'categorical')","de2a234f":"testing_set = test_datagen.flow_from_directory(valid_path,\n                                               target_size = (150,150),\n                                               batch_size = 128,\n                                               class_mode = 'categorical')","e484b645":"hist = model.fit(training_set,\n                validation_data = testing_set,\n                epochs = 20,\n                steps_per_epoch=len(training_set),\n                validation_steps=len(testing_set))","0b08db71":"\n# plot the loss\nplt.plot(hist.history['loss'], label='train loss')\nplt.plot(hist.history['val_loss'], label='val loss')\nplt.legend()\nplt.show()\nplt.savefig('LossVal_loss')\n\n# plot the accuracy\nplt.plot(hist.history['accuracy'], label='train acc')\nplt.plot(hist.history['val_accuracy'], label='val acc')\nplt.legend()\nplt.show()\nplt.savefig('AccVal_acc')","73093d9b":"from tensorflow.keras.models import load_model\n\nmodel.save('model.h5')","1321c9fc":"# Preparing the dataset"}}