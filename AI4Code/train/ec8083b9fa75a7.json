{"cell_type":{"3a93133e":"code","84f0fae3":"code","6b6bacd9":"code","590bb6c4":"code","46649bf5":"code","d8baaccf":"code","1d5c2219":"code","2adc0983":"code","5d7bb4d4":"code","2042b008":"code","3c9636e0":"code","710b61cf":"code","a9c206f8":"code","4dc3b6d6":"code","0f785843":"code","5b806f04":"code","2c467d29":"code","eea66374":"code","bc7afdce":"code","12363815":"code","3b384572":"code","3584b673":"code","fe5b217a":"code","58f14995":"code","c3e73245":"code","a5cad444":"code","d326650e":"code","8bc3ec5a":"code","cd6aa10b":"code","96d341ee":"code","807af85c":"code","6045fae9":"code","ca67530a":"code","9bf0a475":"markdown","f5f433b1":"markdown","4bea072f":"markdown"},"source":{"3a93133e":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings('ignore')","84f0fae3":"df = pd.read_csv('\/kaggle\/input\/heart-disease-uci\/heart.csv')","6b6bacd9":"df.head()","590bb6c4":"df.info()","46649bf5":"df.describe().transpose()","d8baaccf":"df['cp'].unique()","1d5c2219":"df['target'].unique()","2adc0983":"plt.figure(figsize=(10,6))\n\nsns.countplot(data = df, x = 'target')","5d7bb4d4":"plt.figure(dpi=200)\nsns.catplot(data = df, row='sex', col = 'cp' ,x = 'target', kind = 'count')\n","2042b008":"df.columns","3c9636e0":"sns.pairplot(df[['age', 'sex', 'cp', 'target']], hue = 'target', markers=['o', 's'])","710b61cf":"sns.scatterplot(data = df, x = 'age', y = 'thalach', hue = 'target',alpha = 0.5, s =50)","a9c206f8":"df.corr()['target'].sort_values()","4dc3b6d6":"from sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.metrics import accuracy_score, precision_score, recall_score, confusion_matrix, plot_confusion_matrix, plot_precision_recall_curve, plot_roc_curve, classification_report","0f785843":"X = df.drop('target', axis = 1)","5b806f04":"y = df['target']","2c467d29":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size= 0.1, random_state= 99)","eea66374":"scaler = StandardScaler()","bc7afdce":"X_train = scaler.fit_transform(X_train)","12363815":"X_test = scaler.transform(X_test)","3b384572":"log_model = LogisticRegression(solver='saga', multi_class='ovr', max_iter=10000)","3584b673":"penalty = ['l1', 'l2', 'elasticnet']\nl1_ratio = np.linspace(0,10,20)\nC = np.logspace(0,10,20)","fe5b217a":"param_grid = {\n    'penalty':penalty,\n    'l1_ratio': l1_ratio,\n    'C': C\n}","58f14995":"grid_model = GridSearchCV(log_model, param_grid=param_grid,cv=5 )","c3e73245":"grid_model.fit(X_train, y_train)","a5cad444":"grid_model.best_estimator_","d326650e":"grid_model.best_params_","8bc3ec5a":"y_pred = grid_model.predict(X_test)","cd6aa10b":"accuracy_score(y_test, y_pred)","96d341ee":"precision_score(y_test, y_pred)","807af85c":"recall_score(y_test, y_pred)","6045fae9":"plot_confusion_matrix(grid_model, X_test,y_test)","ca67530a":"print(classification_report(y_test, y_pred))","9bf0a475":"No null values","f5f433b1":"No categorical variables here which need encoding\n\nChest Pain is given in ordinal scale","4bea072f":"target is not unbalanced"}}