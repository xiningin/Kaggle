{"cell_type":{"12fc54af":"code","b828497a":"code","c57f05f8":"code","6bc553bc":"code","9d4affff":"code","eea161b8":"code","c13ffbe9":"code","32673be1":"code","bba3b91b":"code","e5552bf6":"code","b648cbe4":"code","6b8eac6a":"code","ce140784":"code","81cd1a0b":"code","90dffc66":"code","bfd59458":"code","01f2dac2":"code","9efa2774":"code","5c2383a4":"code","d3ed03c1":"code","63960e75":"code","22f91a9d":"code","d3ee9d7e":"code","b8b4790f":"code","3b0ad91c":"code","8b268683":"code","17952823":"code","835f4da1":"code","4985a0a7":"code","148d8073":"code","c417502d":"code","58b12465":"code","b9c3829b":"code","48139af1":"code","48542336":"code","e3ec7105":"code","b09a1b72":"code","65e7af8b":"code","7e3263f2":"code","1bed0378":"code","e1316039":"code","a357ea41":"code","57f7ddae":"code","2e909e04":"code","91cd3de2":"code","381af1df":"code","27e1769d":"markdown","789b683a":"markdown","d10ea3d6":"markdown","bf1302dd":"markdown","5d08a260":"markdown","ee8a9351":"markdown","29304833":"markdown","0d77b2c2":"markdown","6045940c":"markdown","cc186158":"markdown","d2f005b3":"markdown","9bb65fab":"markdown","cef7a141":"markdown","895def85":"markdown","188125a7":"markdown","5cc46222":"markdown","a6d311c4":"markdown","2bebc64e":"markdown","e00dc669":"markdown","56369ad9":"markdown","76b2b2ce":"markdown","e6ec089a":"markdown","8d024aab":"markdown","bdd5b085":"markdown","521d2c0c":"markdown","5cade6a3":"markdown","4c97046b":"markdown","90aa233e":"markdown","98e4f9c1":"markdown","c1e20b08":"markdown","44710d16":"markdown","ea9f6e8a":"markdown","dd928558":"markdown","daf47b47":"markdown","c54e5361":"markdown","a61ce6e1":"markdown","9763c1eb":"markdown","f913cf31":"markdown","34fbee87":"markdown","6ef6d50b":"markdown","46467f73":"markdown"},"source":{"12fc54af":"#importing the libraries\\\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport matplotlib\n%matplotlib inline\n\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import confusion_matrix, classification_report,accuracy_score,roc_curve, auc\nimport warnings\nwarnings.filterwarnings('ignore')\nimport warnings\n\nimport plotly.express as px\nimport plotly.offline as py\npy.init_notebook_mode(connected=True)\nimport plotly.graph_objs as go\nimport plotly.tools as tls\nimport plotly.figure_factory as ff","b828497a":"#importing the dataset \ndf = pd.read_csv(\"..\/input\/breast-cancer-coimbra-data-set\/dataR2.csv\")","c57f05f8":"df.info()","6bc553bc":"df.columns","9d4affff":"numeric=['int8', 'int16', 'int32', 'int64', 'float16', 'float32', 'float64']\ndf_num=df.select_dtypes(include=numeric)\ndf_num.head(3)","eea161b8":"df.Classification.unique()","c13ffbe9":"df['Classification'] = df.Classification.map({1:0, 2:1})\ndf","32673be1":"describeNum = df.describe(include =['float64', 'int64', 'float', 'int'])\ndescribeNum.T.style.background_gradient(cmap='viridis',low=0.2,high=0.1)","bba3b91b":"null=pd.DataFrame(df.isnull().sum(),columns=[\"Null Values\"])\nnull[\"% Missing Values\"]=(df.isna().sum()\/len(df)*100)\nnull = null[null[\"% Missing Values\"] > 0]\nnull.style.background_gradient(cmap='viridis',low =0.2,high=0.1) ","e5552bf6":"df.corr()","b648cbe4":"plt.figure(figsize=(30,20))\nax = sns.heatmap(data = df.corr(),cmap='YlGnBu',annot=True)\n\nbottom, top = ax.get_ylim()\nax.set_ylim(bottom + 0.5,top - 0.5)","6b8eac6a":"fig, ax = plt.subplots(1, 1, figsize=(10,10))\ndf_cor = df.corr()\nhalf = np.triu(np.ones_like(df_cor, dtype=np.bool))\n\nmy_colors = ['#bbeb44','#1db1cf']\ncmap = matplotlib.colors.LinearSegmentedColormap.from_list('Custom', my_colors)\n\nheatmap = sns.heatmap(df_cor, \n            square=True, \n            mask=half,\n            linewidth=2.5, \n            vmax=0.4, vmin=0, \n            cmap=cmap, \n            cbar=False, \n            ax=ax,annot=True)\n\nheatmap.set(title=\"Heatmap of continous variables\")\nheatmap.set_yticklabels(heatmap.get_xticklabels(), rotation = 0)\nheatmap.spines['top'].set_visible(True)\nplt.tight_layout()","ce140784":"fig, ax = plt.subplots()\n_ = plt.scatter(x=df['HOMA'], y=df['Insulin'], edgecolors=\"#000000\", linewidths=0.5)\n_ = ax.set(xlabel=\"HOMA\", ylabel=\"Insulin\")","81cd1a0b":"fig, ax = plt.subplots()\n_ = plt.scatter(x=df['Leptin'], y=df['BMI'], edgecolors=\"#000000\", linewidths=0.5)\n_ = ax.set(xlabel=\"Leptin\", ylabel=\"BMI\")","90dffc66":"featuresNum = ['Age', 'BMI', 'Glucose', 'Insulin', 'HOMA', 'Leptin', 'Adiponectin', 'Resistin', 'MCP.1']\nplt.figure(figsize=(15, 7))\nfor i in range(0, len(featuresNum)):\n    plt.subplot(1, len(featuresNum), i+1)\n    sns.boxplot(y=df[featuresNum[i]], color='#1db1cf', orient='v')\n    plt.tight_layout()","bfd59458":"fig, ax = plt.subplots(figsize=(10,5))\n\n_ = sns.countplot(x=\"Classification\", data=df, palette=\"nipy_spectral\",\n              order=df.Classification.value_counts().index)\n\n_ = ax.set_xticklabels(ax.get_xticklabels(), rotation=90)\n_ = ax.set(xlabel=\"Classification\", ylabel=\"No. of patients\")\nplt.legend(bbox_to_anchor=(0.945, 0.90))","01f2dac2":"#How many Startup have both 'acquired' status and is_top500?\nlen(df[(df[\"Classification\"] == True)].index)","9efa2774":"#How many Startup have both 'acquired' status and is_top500?\nlen(df[(df[\"Classification\"] == False)].index)","5c2383a4":"fig, ax = plt.subplots(figsize=(17,10))\n\nsns.countplot(x=\"Age\", hue=\"Classification\", data=df, palette=\"nipy_spectral\",\n              order=df.Age.value_counts().index)\nplt.legend(bbox_to_anchor=(0.945, 0.90))","d3ed03c1":"fig = px.histogram(df, x=\"Age\",color=\"Classification\",\n                   marginal=\"box\",\n                   hover_data=df.columns,\n                  color_discrete_sequence=['#bbeb44','#1db1cf'])\nfig.update_layout(\n    title=\"Breast Cancer Patients Corresponding to Age\"\n)\nfig.show()","63960e75":"more = df[df['Classification']==1]['Glucose']\nless = df[df['Classification']==0]['Glucose']\nfig = ff.create_distplot([less, more],['Healty Control', 'Breast Cancer Patients']\n                         , show_hist=False, \n                        colors=['#bbeb44','#1db1cf'])\nfig.update_layout(\n    title=\"Breast Cancer Patients Corresponding to Glucose\",\n    xaxis_title=\"Glucose\",\n)\nfig.show()","22f91a9d":"more = df[df['Classification']==1]['Glucose']\nless = df[df['Classification']==0]['Glucose']\nfig = ff.create_distplot([less, more],['Healty Control', 'Breast Cancer Patients']\n                         , bin_size=5,\n                        colors=['#bbeb44','#1db1cf'])\nfig.update_layout(\n    title=\"Breast Cancer Patients Corresponding to Glucose\",\n    xaxis_title=\"Glucose\",\n)\nfig.show()","d3ee9d7e":"more = df[df['Classification']==1]['Resistin']\nless = df[df['Classification']==0]['Resistin']\nfig = ff.create_distplot([less, more],['Healty Control', 'Breast Cancer Patients']\n                         , show_hist=False, \n                        colors=['#bbeb44','#1db1cf'])\nfig.update_layout(\n    title=\"Breast Cancer Patients Corresponding to Resistin\",\n    xaxis_title=\"Resistin\",\n)\nfig.show()","b8b4790f":"more = df[df['Classification']==1]['Resistin']\nless = df[df['Classification']==0]['Resistin']\nfig = ff.create_distplot([less, more],['Healty Control', 'Breast Cancer Patients']\n                         , bin_size=5,\n                        colors=['#bbeb44','#1db1cf'])\nfig.update_layout(\n    title=\"Breast Cancer Patients Corresponding to Resistin\",\n    xaxis_title=\"Resistin\",\n)\nfig.show()","3b0ad91c":"more = df[df['Classification']==1]['BMI']\nless = df[df['Classification']==0]['BMI']\nfig = ff.create_distplot([less, more],['Healty Control', 'Breast Cancer Patients']\n                         , show_hist=False, \n                        colors=['#bbeb44','#1db1cf'])\nfig.update_layout(\n    title=\"Breast Cancer Patients Corresponding to BMI\",\n    xaxis_title=\"BMI\",\n)\nfig.show()","8b268683":"more = df[df['Classification']==1]['BMI']\nless = df[df['Classification']==0]['BMI']\nfig = ff.create_distplot([less, more],['Healty Control', 'Breast Cancer Patients']\n                         , bin_size=5,\n                        colors=['#bbeb44','#1db1cf'])\nfig.update_layout(\n    title=\"Breast Cancer Patients Corresponding to BMI\",\n    xaxis_title=\"BMI\",\n)\nfig.show()","17952823":"more = df[df['Classification']==1]['Insulin']\nless = df[df['Classification']==0]['Insulin']\nfig = ff.create_distplot([less, more],['Healty Control', 'Breast Cancer Patients']\n                         , show_hist=False, \n                        colors=['#bbeb44','#1db1cf'])\nfig.update_layout(\n    title=\"Breast Cancer Patients Corresponding to Insulin\",\n    xaxis_title=\"Insulin\",\n)\nfig.show()","835f4da1":"more = df[df['Classification']==1]['HOMA']\nless = df[df['Classification']==0]['HOMA']\nfig = ff.create_distplot([less, more],['Healty Control', 'Breast Cancer Patients']\n                         , show_hist=False, \n                        colors=['#bbeb44','#1db1cf'])\nfig.update_layout(\n    title=\"Breast Cancer Patients Corresponding to HOMA\",\n    xaxis_title=\"HOMA\",\n)\nfig.show()","4985a0a7":"more = df[df['Classification']==1]['Leptin']\nless = df[df['Classification']==0]['Leptin']\nfig = ff.create_distplot([less, more],['Healty Control', 'Breast Cancer Patients']\n                         , show_hist=False, \n                        colors=['#bbeb44','#1db1cf'])\nfig.update_layout(\n    title=\"Breast Cancer Patients Corresponding to Leptin\",\n    xaxis_title=\"Leptin\",\n)\nfig.show()","148d8073":"more = df[df['Classification']==1]['Adiponectin']\nless = df[df['Classification']==0]['Adiponectin']\nfig = ff.create_distplot([less, more],['Healty Control', 'Breast Cancer Patients']\n                         , show_hist=False, \n                        colors=['#bbeb44','#1db1cf'])\nfig.update_layout(\n    title=\"Breast Cancer Patients Corresponding to Adiponectin\",\n    xaxis_title=\"Adiponectin\",\n)\nfig.show()","c417502d":"more = df[df['Classification']==1]['MCP.1']\nless = df[df['Classification']==0]['MCP.1']\nfig = ff.create_distplot([less, more],['Healty Control', 'Breast Cancer Patients']\n                         , show_hist=False, \n                        colors=['#bbeb44','#1db1cf'])\nfig.update_layout(\n    title=\"Breast Cancer Patients Corresponding to MCP.1\",\n    xaxis_title=\"MCP.1\",\n)\nfig.show()","58b12465":"#check\nduplicate = df[df.duplicated()] \n  \nprint(\"Duplicate Rows :\")","b9c3829b":"age=['Age', 'BMI', 'Glucose', 'Insulin', 'HOMA', 'Leptin', 'Adiponectin', 'Resistin', 'MCP.1']\n\nfor a in range(len(age)):\n    print(\"Is there any negative value in '{}' column  : {} \".format(age[a],(df[age[a]]<0).any()))","48139af1":"featuresNum = ['Age', 'BMI', 'Glucose', 'Insulin', 'HOMA', 'Leptin', 'Adiponectin', 'Resistin', 'MCP.1']\nplt.figure(figsize=(15, 7))\nfor i in range(0, len(featuresNum)):\n    plt.subplot(1, len(featuresNum), i+1)\n    sns.boxplot(y=df[featuresNum[i]], color='green', orient='v')\n    plt.tight_layout()","48542336":"df[\"Glucose\"] = np.log(df[\"Glucose\"])\ndf[\"Insulin\"] = np.log(df[\"Insulin\"])\ndf[\"HOMA\"] = np.log(df[\"HOMA\"])\ndf[\"Leptin\"] = np.log(df[\"Leptin\"])\ndf[\"Adiponectin\"] = np.log(df[\"Adiponectin\"])\ndf[\"Resistin\"] = np.log(df[\"Resistin\"])\ndf[\"MCP.1\"] = np.log(df[\"MCP.1\"])","e3ec7105":"featuresNum = ['Age', 'BMI', 'Glucose', 'Resistin', 'Insulin', 'HOMA', 'Leptin', 'Adiponectin', 'MCP.1']\nplt.figure(figsize=(15, 7))\nfor i in range(0, len(featuresNum)):\n    plt.subplot(1, len(featuresNum), i+1)\n    sns.boxplot(y=df[featuresNum[i]], color='green', orient='v')\n    plt.tight_layout()","b09a1b72":"df = df.drop(['Insulin'],axis=1)\ndf = df.drop(['MCP.1'],axis=1)\ndf = df.drop(['Adiponectin'],axis=1)\ndf = df.drop(['Leptin'],axis=1)\ndf = df.drop(['HOMA'],axis=1)","65e7af8b":"df","7e3263f2":"from sklearn.model_selection import train_test_split\n# Split the data\n# Input\/independent variables\nX = df.drop('Classification', axis = 1) # her we are droping the output feature as this is the target and 'X' is input features, the changes are not \n                                              # made inplace as we have not used 'inplace = True'\n\ny = df['Classification'] # Output\/Dependent variable\n# train_x, test_x,train_y,test_y = train_test_split(X,y)","1bed0378":"# Scaling the data\nfrom sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\nX =  sc.fit_transform(X)\nX","e1316039":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 42)\n\n# lets print the shapes again \nprint(\"Shape of the X Train :\", X_train.shape)\nprint(\"Shape of the y Train :\", y_train.shape)\nprint(\"Shape of the X test :\", X_test.shape)\nprint(\"Shape of the y test :\", y_test.shape)","a357ea41":"# Model Build\nfrom sklearn.metrics import confusion_matrix, classification_report,accuracy_score,roc_curve, auc, precision_recall_curve, f1_score\nimport warnings\nwarnings.filterwarnings('ignore')","57f7ddae":"from sklearn.ensemble import RandomForestClassifier\nrf = RandomForestClassifier()\n\nrf.fit(X_train,y_train)\n\ny_pred_rf = rf.predict(X_test)\n\nprint(\"Training Accuracy :\", rf.score(X_train, y_train))\nprint(\"Testing Accuracy :\", rf.score(X_test, y_test))\n\ncm = confusion_matrix(y_test, y_pred_rf)\nplt.rcParams['figure.figsize'] = (3, 3)\nsns.heatmap(cm, annot = True, cmap = 'YlGnBu', fmt = '.8g')\nplt.show()\n\ncr = classification_report(y_test, y_pred_rf)\nprint(cr)\n\nprint(\"------------------------------------------\")\n\nfalse_positive_rate, true_positive_rate, thresholds = roc_curve(y_test,y_pred_rf)\nroc_auc = auc(false_positive_rate, true_positive_rate)\nprint(\"ROC AUC Curves  : \",roc_auc)\n\nsensitivity1 = cm[0,0]\/(cm[0,0]+cm[0,1])\nprint('Sensitivity : ', sensitivity1)\n\nspecificity1 = cm[1,1]\/(cm[1,0]+cm[1,1])\nprint('Specificity : ', specificity1)","2e909e04":"from lightgbm import LGBMClassifier\nclf = LGBMClassifier()\n\nclf.fit(X_train,y_train)\n\ny_pred_lgb = clf.predict(X_test)\n\nprint(\"Training Accuracy :\", clf.score(X_train, y_train))\nprint(\"Testing Accuracy :\", clf.score(X_test, y_test))\n\ncm = confusion_matrix(y_test, y_pred_lgb)\nplt.rcParams['figure.figsize'] = (3, 3)\nsns.heatmap(cm, annot = True, cmap = 'YlGnBu', fmt = '.8g')\nplt.show()\n\ncr = classification_report(y_test, y_pred_lgb)\nprint(cr)\n\nprint(\"------------------------------------------\")\n\nfalse_positive_rate, true_positive_rate, thresholds = roc_curve(y_test,y_pred_lgb)\nroc_auc = auc(false_positive_rate, true_positive_rate)\nprint(\"ROC AUC Curves  : \",roc_auc)\n\nsensitivity1 = cm[0,0]\/(cm[0,0]+cm[0,1])\nprint('Sensitivity : ', sensitivity1)\n\nspecificity1 = cm[1,1]\/(cm[1,0]+cm[1,1])\nprint('Specificity : ', specificity1)","91cd3de2":"from xgboost import XGBClassifier\n\n#train\nxgb = XGBClassifier()\n\nxgb.fit(X_train,y_train)\n\n#predict\ny_predicted_xgb = xgb.predict(X_test)\n\nprint(\"Training Accuracy :\", xgb.score(X_train, y_train))\nprint(\"Testing Accuracy :\", xgb.score(X_test, y_test))\n\n#eval\ncm = confusion_matrix(y_test, y_predicted_xgb)\nplt.rcParams['figure.figsize'] = (3, 3)\nsns.heatmap(cm, annot = True, cmap = 'YlGnBu', fmt = '.8g')\nplt.show()\n\ncr = classification_report(y_test, y_predicted_xgb)\nprint(cr)\n\nprint(\"------------------------------------------\")\n\nfalse_positive_rate, true_positive_rate, thresholds = roc_curve(y_test,y_predicted_xgb)\nroc_auc = auc(false_positive_rate, true_positive_rate)\nprint(\"ROC AUC Curves  : \",roc_auc)\n\nsensitivity1 = cm[0,0]\/(cm[0,0]+cm[0,1])\nprint('Sensitivity : ', sensitivity1)\n\nspecificity1 = cm[1,1]\/(cm[1,0]+cm[1,1])\nprint('Specificity : ', specificity1)","381af1df":"from sklearn.ensemble import GradientBoostingClassifier\n#train\ngbc = GradientBoostingClassifier(learning_rate=0.02,\n                    max_depth=4,\n                    random_state=100, n_estimators=1000)\n\n\ngbc.fit(X_train,y_train)\n\n#predict\ny_predicted_gb = gbc.predict(X_test)\n\nprint(\"Training Accuracy :\", gbc.score(X_train, y_train))\nprint(\"Testing Accuracy :\", gbc.score(X_test, y_test))\n\n#eval\ncm = confusion_matrix(y_test, y_predicted_gb)\nplt.rcParams['figure.figsize'] = (3, 3)\nsns.heatmap(cm, annot = True, cmap = 'YlGnBu', fmt = '.8g')\nplt.show()\n\ncr = classification_report(y_test, y_predicted_gb)\nprint(cr)\n\n\nprint(\"------------------------------------------\")\n\nfalse_positive_rate, true_positive_rate, thresholds = roc_curve(y_test,y_predicted_gb)\nroc_auc = auc(false_positive_rate, true_positive_rate)\nprint(\"ROC AUC Curves  : \",roc_auc)\n\nsensitivity1 = cm[0,0]\/(cm[0,0]+cm[0,1])\nprint('Sensitivity : ', sensitivity1)\n\nspecificity1 = cm[1,1]\/(cm[1,0]+cm[1,1])\nprint('Specificity : ', specificity1)","27e1769d":"## LGBM","789b683a":"There are 10 predictors, all quantitative, and a binary dependent variable, indicating the presence or absence of breast cancer.\nThe predictors are anthropometric data and parameters which can be gathered in routine blood analysis.\nPrediction models based on these predictors, if accurate, can potentially be used as a biomarker of breast cancer.","d10ea3d6":"# Modeling","bf1302dd":"## Log-transformation variable","5d08a260":"### Breast Cancer Patients corresponding to Glucose","ee8a9351":"## Duplicate Values","29304833":"## Changing 'status' data value","0d77b2c2":"# Exploratory Data Analysis (EDA)","6045940c":"### Breast Cancer Patients corresponding to Insulin","cc186158":"### Breast Cancer Patients corresponding to MCP.1","d2f005b3":"## Load libraries and read the data","9bb65fab":"Quantitative Attributes:\n- Age (years)\n- BMI (kg\/m2)\n- Glucose (mg\/dL)\n- Insulin (\u00b5U\/mL)\n- HOMA\n- Leptin (ng\/mL)\n- Adiponectin (\u00b5g\/mL)\n- Resistin (ng\/mL)\n- MCP-1(pg\/dL)\n\nLabels:\n- 1=Healthy controls\n- 2=Patients\n\nAbbreviations\n- BC: Breast cancer; \n- BMI: Body mass index; \n- HOMA: Homeostasis Model Assessment; \n- MCP-1: Chemokine Monocyte Chemoattractant Protein 1;","cef7a141":"## XGBoost","895def85":"# Data Exploration","188125a7":"## Data Set Information:","5cc46222":"## Goals\nThe goal of this exploratory study was to develop and assess a prediction model which can potentially\nbe used as a biomarker of breast cancer, based on anthropometric data and parameters which can be gathered in\nroutine blood analysis.\n\nNowadays in a medical test, the big indicators of success are specificity and sensitivity. Every medical test strives to reach 100% in both criteria.\n\nSensitivity\/recall:\n- How good a test is at detecting the positives. A test can cheat and maximize this by always returning \u201cpositive\u201d.\n\nSpecificity:\n- How good a test is at avoiding false alarms. A test can cheat and maximize this by always returning \u201cnegative\u201d.","a6d311c4":"### Breast Cancer Patients corresponding to HOMA","2bebc64e":"## Statistical Summary","e00dc669":"### How many patients have breast cancer and not?","56369ad9":"## Missing Value ","76b2b2ce":"## Random Forest","e6ec089a":"### Scatter plot","8d024aab":"### Breast Cancer Patients corresponding to Leptin","bdd5b085":"### Breast Cancer Patients Corresponding to Age","521d2c0c":"# Data Preprocessing","5cade6a3":"## Graphic Approach","4c97046b":"# Breast Cancer Prediction","90aa233e":"### Box plots","98e4f9c1":"### Breast Cancer Patients corresponding to Adiponectin","c1e20b08":"## Outliers","44710d16":"### Breast Cancer Patients corresponding to Resistin","ea9f6e8a":" ### Correlation heatmap","dd928558":"## Negative value","daf47b47":"## Data Column Identification","c54e5361":"## Attribute Information:","a61ce6e1":"### Which Age related to Patients or Healty Control Health?","9763c1eb":"## Description","f913cf31":"### Breast Cancer Patients corresponding to BMI","34fbee87":"## Drop unused column for modelling","6ef6d50b":"## Data numeric","46467f73":"## SVM"}}