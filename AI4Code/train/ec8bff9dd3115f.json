{"cell_type":{"e1ac067a":"code","d47dcfff":"code","194d5440":"code","a2b6ac3b":"code","3c895e04":"code","4f7dc55c":"code","418f1438":"code","1476cebf":"code","fc843e4b":"code","9c49cff7":"code","e6c59de6":"code","5526f6db":"code","e5bfe23d":"code","c5378b38":"code","3a986950":"code","56de3a32":"code","4749efc4":"code","4dfa34c0":"code","4af49658":"code","6c09cd5b":"code","c304f162":"code","914bef0d":"code","93f60339":"code","8d44ead8":"code","74b154db":"code","46c6b36b":"code","242ded40":"code","eedc873e":"code","02556b5c":"code","3aef79cd":"markdown","dc510267":"markdown","7d3d2aae":"markdown","0687806a":"markdown","44aadfdd":"markdown","5ec39ddf":"markdown","f60f1186":"markdown","e591ce14":"markdown","a72e32d3":"markdown","a83d6c4f":"markdown","830bbc9b":"markdown","d2105a08":"markdown","9291cd48":"markdown","6572b94f":"markdown","2a11cd4b":"markdown","8568b259":"markdown","3556ee6d":"markdown","3db793f9":"markdown","0ce12753":"markdown"},"source":{"e1ac067a":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport os\n\nfrom sklearn.impute import SimpleImputer\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.ensemble import RandomForestRegressor\n\nfrom xgboost import XGBRegressor\n","d47dcfff":"def num_missing(data):\n    ms_counts = data.isnull().sum()\n    return ms_counts[ms_counts!=0]","194d5440":"raw_train = pd.read_csv('..\/input\/train.csv')\nraw_test = pd.read_csv('..\/input\/test.csv')","a2b6ac3b":"raw_train.head()","3c895e04":"raw_test.head()","4f7dc55c":"raw_train.describe()","418f1438":"raw_train.info()","1476cebf":"raw_train.select_dtypes(['float64','int64']).columns","fc843e4b":"raw_train.select_dtypes(['object']).columns","9c49cff7":"plt.figure(num=None, figsize=(12, 10))\nsns.heatmap(raw_train.corr())","e6c59de6":"raw_train.corr().SalePrice.sort_values(ascending=False)","5526f6db":"missing = num_missing(raw_train)\nmissing","e5bfe23d":"raw_train[missing.index.values].dtypes","c5378b38":"train = raw_train.copy()\ntest = raw_test.copy()","3a986950":"train['MSSubClass'] = train['MSSubClass'].astype('object')","56de3a32":"cat_columns = train.select_dtypes('object').columns","4749efc4":"train[cat_columns] = train[cat_columns].fillna('missing')","4dfa34c0":"test[cat_columns] = test[cat_columns].fillna('missing')","4af49658":"train = pd.get_dummies(train)\ntest = pd.get_dummies(test)\ntrain, test = train.align(test,join='left',axis=1)","6c09cd5b":"train_X = train.drop(columns=['Id','SalePrice'])\ntrain_y = train.SalePrice\ntest_X = test.drop(columns=['Id','SalePrice'])","c304f162":"rnreg = Pipeline([\n    ('imputer', SimpleImputer(strategy='most_frequent')),\n    ('reg', RandomForestRegressor(n_estimators=500,max_depth=3))\n])","914bef0d":"rnreg.fit(train_X,train_y);","93f60339":"feat_importances = rnreg['reg'].feature_importances_","8d44ead8":"impdf = pd.DataFrame({'Feature Name':train_X.columns,'Importance':feat_importances})","74b154db":"impdf.sort_values('Importance',ascending=False).head(15).plot(x='Feature Name',y='Importance',kind='barh')","46c6b36b":"model = Pipeline([\n    ('imputer', SimpleImputer(strategy='most_frequent')),\n    ('reg', XGBRegressor(objective='reg:squarederror',n_estimators=2000,max_depth=20))\n])","242ded40":"from sklearn.model_selection import cross_val_score\n\nnp.sqrt(-cross_val_score(model, train_X,train_y, cv=5,scoring='neg_mean_squared_error'))","eedc873e":"model.fit(train_X, train_y)","02556b5c":"test_preds = model.predict(test_X)\n\noutput = pd.DataFrame({'Id':test.Id,'SalePrice':test_preds})\noutput.to_csv('submission.csv',index=False)","3aef79cd":"## Stats","dc510267":"# Making test predictions","7d3d2aae":"### Numeric columns","0687806a":"# Getting the features","44aadfdd":"## Data types","5ec39ddf":"## Fill missing categories","f60f1186":"Correlation heatmap","e591ce14":"MSSubClass is a category","a72e32d3":"# Prepare data","a83d6c4f":"## Correct data types","830bbc9b":"## One hot encoding","d2105a08":"### Categorical columns","9291cd48":"# Reading the data","6572b94f":"## Feature importance","2a11cd4b":"Correlation with SalePrice","8568b259":"# Exploratory Data analysis","3556ee6d":"# Training the model","3db793f9":"## Missing data","0ce12753":"# Helper functions"}}