{"cell_type":{"76fda2e7":"code","af2dba14":"code","b2a21cf2":"code","629356a4":"code","938039df":"code","3c662d38":"code","dff6c53b":"code","be9ba958":"code","ab4b47c6":"code","e81fb45b":"code","e512d8c2":"code","88b9f8a8":"code","247afcba":"markdown","77ac674b":"markdown","41f955f3":"markdown","90a4c0b8":"markdown","f7afe738":"markdown","b4d9c41e":"markdown","191b46fd":"markdown","55ae61e4":"markdown"},"source":{"76fda2e7":"%matplotlib inline\n\nimport numpy as np\nimport pandas as pd\nimport datetime as dt\nimport altair as alt","af2dba14":"def read_traffic():\n    return pd.read_csv(\"..\/input\/au-dom-traffic\/audomcitypairs-202102.csv\")","b2a21cf2":"def transform_traffic(df):\n    df1 = df.assign(\n        Journey = df.City1 + \"-\" + df.City2, \n        Month = dt.datetime(1899, 12, 30) + df['Month'].map(dt.timedelta))\n    return df1","629356a4":"dom = transform_traffic(read_traffic())","938039df":"dom.head()","3c662d38":"dom.dtypes","dff6c53b":"trips = dom['Passenger_Trips'] \\\n    .groupby(dom['Journey']) \\\n    .mean() \\\n    .sort_values(ascending = False) \\\n    .reset_index()\n\ntrips.head(5)","be9ba958":"bars = alt.Chart(trips.head(15)) \\\n    .mark_bar(size = 15) \\\n    .encode(\n        x = alt.X(\n            'Passenger_Trips:Q',\n            scale = alt.Scale(domain = [0, 550000])),\n        y = alt.Y(\n            'Journey:O', \n            sort = '-x'))\n\nlabels = bars \\\n    .mark_text(dx = 25) \\\n    .encode(\n        text = alt.Text(\n            'Passenger_Trips:Q', \n            format = \".0d\"))\n\n(bars+labels).properties(\n        width = 500, \n        height = 350)","ab4b47c6":"trips_months = dom \\\n    .groupby(['Month'])[['Passenger_Trips']] \\\n    .sum() \\\n    .reset_index()","e81fb45b":"alt.Chart(trips_months) \\\n    .mark_line(color = 'green') \\\n    .encode(\n        x = 'Month:T',\n        y = 'Passenger_Trips:Q') \\\n    .properties(\n        width = 400,\n        height = 250)","e512d8c2":"df = trips_months \\\n    .set_index('Month').rolling(window = 12, center = True) \\\n    .mean() \\\n    .reset_index()","88b9f8a8":"alt.Chart(df) \\\n    .mark_line(color = 'green') \\\n    .encode(\n        x = 'Month:T',\n        y = 'Passenger_Trips:Q') \\\n    .properties(\n        width = 400,\n        height = 250)","247afcba":"## Visualise","77ac674b":"Top sectors by total passengers","41f955f3":"## Read and process the data","90a4c0b8":"## Description\n\nVisualisation sandbox on some random data sets using Python3 and Vega-Lite (via Altair). In this case, it's Australian [monthly airport domestic traffic data](https:\/\/data.gov.au\/dataset\/domestic-airlines-top-routes-and-totals) via data.gov.au.","f7afe738":"Time series of monthly passenger numbers.","b4d9c41e":"Plot the moving average centered over a 12-month window.","191b46fd":"# City Pairs: Domestic Traffic\n\nAndrewJ, 2020-04-05","55ae61e4":"## Run"}}