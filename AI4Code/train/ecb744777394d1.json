{"cell_type":{"585efa00":"code","6d61ae59":"code","f9b68ba5":"code","28c99583":"code","8632c85f":"code","ca224949":"code","572e4365":"code","97cedeef":"code","fb23bb3f":"code","8d43ac1f":"code","e7454d08":"code","70e8d6a7":"code","14da5f83":"code","621ed65d":"code","80d3c9a3":"code","7f1155dc":"code","d14f4e8d":"code","c45ca775":"code","3524feaa":"code","53d295a1":"code","acd41c90":"code","84555e7c":"code","94e05f09":"code","821170e0":"code","c1732025":"code","e7ec7e1d":"code","f4bfe161":"code","dda3ad2c":"code","ffd0a91d":"code","8caf6bca":"code","7f093f0e":"code","d5893c5d":"code","2bbd8165":"code","4f14fd38":"code","260789ce":"code","220bd30a":"code","7f91dfa8":"code","b04d9164":"code","1ed8b64b":"code","9ef90792":"code","23716ffa":"code","6723a51c":"code","114de319":"code","8a29a141":"code","8ccd5abe":"markdown","c94eb3c6":"markdown","0ae8bdb8":"markdown","83286cf6":"markdown","8f4a0a22":"markdown","c635a4c2":"markdown","e26c5310":"markdown","82245d5c":"markdown","393a7cf9":"markdown","21b6ddc9":"markdown","cfa91430":"markdown","0c70a078":"markdown","53f2604b":"markdown","90050e53":"markdown","2d6f3218":"markdown","304035fd":"markdown","fbd485fa":"markdown","21374f36":"markdown","dd2d2ac7":"markdown","4ca87e0f":"markdown","c966a191":"markdown","c295adb7":"markdown","06e4c81a":"markdown","019de97b":"markdown","dfaba645":"markdown","2518899f":"markdown","eeedfde5":"markdown","7041e097":"markdown","def51f82":"markdown","91562293":"markdown","f01a13b3":"markdown","f48854c1":"markdown","d98a8cf7":"markdown","acfabc0d":"markdown","337a747c":"markdown","0a6bd57c":"markdown","02bac4e8":"markdown","dd5c8f20":"markdown","bf86a123":"markdown","7948bb52":"markdown","9ed792b1":"markdown","ccf746e0":"markdown","77d89282":"markdown","764b7353":"markdown","a70fb330":"markdown","31f7d871":"markdown","2d39d9ee":"markdown"},"source":{"585efa00":"import numpy as np\nimport pandas as pd \nfrom pandas import Series,DataFrame\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.impute import SimpleImputer\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\n%matplotlib inline","6d61ae59":"gender_submission = pd.read_csv(\"..\/input\/titanic\/gender_submission.csv\")\ntest = pd.read_csv(\"..\/input\/titanic\/test.csv\")\ntrain = pd.read_csv(\"..\/input\/titanic\/train.csv\")","f9b68ba5":"print('Test data shape: ', train.shape)\ntrain.head()","28c99583":"train.describe()","8632c85f":"train.info()","ca224949":"train.isnull().sum()","572e4365":"test.isnull().sum()","97cedeef":"imputer = SimpleImputer(np.nan, \"mean\")\n\ntrain['Age'] = imputer.fit_transform(np.array(train['Age']).reshape(891, 1)) \ntrain.Embarked.fillna(method='ffill', inplace=True) \ntrain.drop(['PassengerId', 'Name','Ticket'], axis=1, inplace=True)\ntrain.head()","fb23bb3f":"test['Age'] = imputer.fit_transform(np.array(test['Age']).reshape(418, 1))\ntest.Embarked.fillna(method='ffill', inplace=True)\ntest.Fare.fillna(method='ffill', inplace=True)\ntest.drop(['Name', 'Ticket'], axis=1, inplace=True)\ntest.head()","8d43ac1f":"train['Survived'].value_counts()","e7454d08":"plt.figure(figsize=[10,5])\nsns.countplot(x = 'Sex', hue = 'Survived', data = train)\nplt.xticks(rotation = 20);","70e8d6a7":"sns.barplot(x='Sex', y='Survived', data=train, palette=('RdPu'));","14da5f83":"print('% of survived females:', train['Survived'][train['Sex'] == 'female'].value_counts(normalize = True)[1]*100)\nprint('% of survived males:', train['Survived'][train['Sex'] == 'male'].value_counts(normalize = True)[1]*100)","621ed65d":"train[['Sex', 'Survived']].groupby(['Sex'], as_index=False).mean().sort_values(by='Survived', ascending=False)","80d3c9a3":"fig, ax = plt.subplots(figsize = (10,6))\nax = sns.countplot(x = 'Survived', hue = 'Pclass', data = train, palette = 'YlOrRd')\nax.set_xlabel('Survived')\nax.set_title('Survival Rate for Passenger Classes', fontsize = 14, fontweight='bold');","7f1155dc":"ax = sns.catplot(x=\"Pclass\", hue=\"Sex\", col=\"Survived\",\n                data=train, kind=\"count\",\n                height=4, aspect=.7, palette = 'OrRd');","d14f4e8d":"sns.countplot(x = \"Pclass\", hue = \"Survived\", data = train, palette = 'RdPu');","c45ca775":"sns.barplot(x=\"Pclass\", y=\"Survived\", data= train, palette = 'BuGn');","3524feaa":"perc = train[['Pclass', 'Survived']].groupby(['Pclass'], as_index=False).mean().sort_values(by='Survived', ascending=False)\nperc*100","53d295a1":"sns.factorplot(x='Pclass', y='Survived', hue = 'Sex', data = train, palette = 'PRGn');","acd41c90":"sns.boxplot(x='Sex', y='Age', hue = 'Survived',data=train);","84555e7c":"grid = sns.FacetGrid(train, col='Survived')\ngrid.map(plt.hist, 'Age', bins=25, color = 'y').add_legend();\nsns.set(style=\"ticks\", color_codes=True);","94e05f09":"plt.figure(figsize=(10,5))\nsns.distplot(train['Age'], bins=24, color='g');","821170e0":"avg_age_train = train [\"Age\"].mean()\nstd_age_train = train [\"Age\"].std()\n\navg_age_test = test[\"Age\"].mean()\nstd_age_test = test [\"Age\"].std()","c1732025":"bins = [0, 1, 12, 18, 21,  60, np.inf]\nlabels = ['Infant', 'Child', 'Teenager',' Young Adult', 'Adult', 'Senior']\ntrain['AgeGroup'] = pd.cut(train[\"Age\"], bins, labels = labels)\ntest['AgeGroup'] = pd.cut(test[\"Age\"], bins, labels = labels)\nsns.barplot(x=\"AgeGroup\", y=\"Survived\", data= train)\nplt.show;","e7ec7e1d":"train.head()","f4bfe161":"train[['AgeGroup', 'Survived']].groupby(['AgeGroup'], as_index=False).mean().sort_values(by='Survived', ascending=False)","dda3ad2c":"AgeGroup_train  = pd.get_dummies(train['AgeGroup'])\nAgeGroup_train.columns = ['Infant', 'Child', 'Teenager',' Young Adult', 'Adult', 'Senior']\nAgeGroup_test  = pd.get_dummies(test['AgeGroup'])\nAgeGroup_test.columns = ['Infant', 'Child', 'Teenager',' Young Adult', 'Adult', 'Senior']\n\ntrain = train.join(AgeGroup_train)\ntest = test.join(AgeGroup_test)","ffd0a91d":"age_mapping = {'Infant': 1, 'Child': 2, 'Teenager': 3, 'Young Adult': 4, 'Adult': 5, 'Senior': 7}\ntrain['AgeGroup'] = train['AgeGroup'].map(age_mapping)\ntest['AgeGroup'] = test['AgeGroup'].map(age_mapping)\n\ntrain.head()\n","8caf6bca":"train.drop(['AgeGroup', 'Age'],axis=1,inplace=True)\ntest.drop(['AgeGroup', 'Age'],axis=1,inplace=True)\ntrain.head()","7f093f0e":"train[\"Cabin_new\"] = (train[\"Cabin\"].notnull().astype('int'))\ntest[\"Cabin_new\"] = (test[\"Cabin\"].notnull().astype('int'))\ntrain = train.drop(['Cabin'], axis = 1)\ntest = test.drop(['Cabin'], axis = 1)\n","d5893c5d":"print(\"% of Cabin = 1 survived:\", train[\"Survived\"][train[\"Cabin_new\"] == 1].value_counts(normalize = True)[1]*100)\nprint(\"% of Cabin = 0 survived:\", train[\"Survived\"][train[\"Cabin_new\"] == 0].value_counts(normalize = True)[1]*100)\n\nsns.barplot(x=\"Cabin_new\", y=\"Survived\", data=train).set_title('Cabin vs No Cabin')\nplt.show()","2bbd8165":"train[[\"SibSp\", \"Survived\"]].groupby(['SibSp'], as_index=False).mean().sort_values(by='Survived', ascending=False)","4f14fd38":"train[[\"Parch\", \"Survived\"]].groupby(['Parch'], as_index=False).mean().sort_values(by='Survived', ascending=False)","260789ce":"train['FamilySize'] = train['Parch'] + train['SibSp']\ntest['FamilySize'] = test['Parch'] + test['SibSp']\n#train.drop(['Parch', 'SibSp'], axis=1,inplace=True)\n#test.drop(['Parch', 'SibSp'], axis=1,inplace=True)\nax = sns.barplot(x=\"FamilySize\", y=\"Survived\", data=train)\nplt.show()\n#plt.savefig('familysize.jpg',dpi=300)\nfigure = ax.get_figure()    \nfigure.savefig('test.jpg', dpi=500)","220bd30a":"sns.pointplot(x='FamilySize', y = 'Survived', data = train);","7f91dfa8":"train[['Embarked', 'Survived']].groupby(['Embarked'], as_index=False).mean().sort_values(by='Survived', ascending=False)","b04d9164":"embark_perc = train[[\"Embarked\", \"Survived\"]].groupby(['Embarked'],as_index=False).mean()\nsns.barplot(x='Embarked', y='Survived', data=embark_perc,order=['S','C','Q']);","1ed8b64b":"sns.countplot(x='Embarked', hue='Survived', data=train);","9ef90792":"embark_dummies_train  = pd.get_dummies(train['Embarked'])\nembark_dummies_test  = pd.get_dummies(test['Embarked'])\n\ntrain = train.join(embark_dummies_train)\ntest = test.join(embark_dummies_test)\ntrain.head()","23716ffa":"train = train.drop(['Embarked'], axis = 1)\ntest = test.drop(['Embarked'], axis = 1)\ntrain.head()","6723a51c":"sex_mapping = {\"male\": 0, \"female\": 1}\ntrain['Sex'] = train['Sex'].map(sex_mapping)\ntest['Sex'] = test['Sex'].map(sex_mapping)\n\ntrain.head()","114de319":"# convert from float to int\ntrain['Fare'] = train['Fare'].astype(int)\ntest['Fare']= test['Fare'].astype(int)\n\n# get fare for survived & didn't survive passengers \nfare_not_survived = train[\"Fare\"][train[\"Survived\"] == 0]\nfare_survived = train[\"Fare\"][train[\"Survived\"] == 1]\n\n# get average and std for fare of survived\/not survived passengers\navgerage_fare = DataFrame([fare_not_survived.mean(), fare_survived.mean()])\nstd_fare = DataFrame([fare_not_survived.std(), fare_survived.std()])\n\n# plot\ntrain['Fare'].plot(kind='hist', figsize=(15,3),bins=100, xlim=(0,50), color = 'purple')\n\navgerage_fare.index.names = std_fare.index.names = [\"Survived\"]\navgerage_fare.plot(yerr=std_fare,kind='bar',legend=False, color = 'r');","8a29a141":"mask = np.zeros_like(train.corr(), dtype=np.bool)\n## in order to reverse the bar replace \"RdBu\" with \"RdBu_r\"\nplt.subplots(figsize = (15,12))\nsns.heatmap(train.corr(), annot=True,mask = False,cmap = 'OrRd', linewidths=.7, linecolor='black',fmt='.2g',center = 0,square=True)\n\nplt.title(\"Correlations\", y = 1.03,fontsize = 20, fontweight = 'bold', pad = 40);","8ccd5abe":"To analyse the data based on the family size, first, create new column:","c94eb3c6":"Another way to calculate these % using groupby():","0ae8bdb8":"## Fare","83286cf6":"## Treating Missing Values","8f4a0a22":"## Data Analysis\n","c635a4c2":"Missing Values in the column Age can be fixed by imputing values, in our case, using average, of this column. \nFor the column Embarked the missing values can be fixed by 'ffil' that implaces last valid observation in this column. At the same time, I dropped PassengerId, Name and Ticket columns.","e26c5310":"To look at the correlation between passenger class and survival statistics I would plot a countplot.","82245d5c":"Looking at the survaval data for each port separetely, port Southampton has the highest number of survivors. At the same time, the largest number of victims came from port Cherbourg.","393a7cf9":"### Passenger Class","21b6ddc9":"Percentages of who survived: The men's survival is tragically a lot lower than women's.","cfa91430":"## Family Size","0c70a078":"Now, I map each Gender value to a numerical value:","53f2604b":"As many of us here, I have been a part of the [Titanic Competition](https:\/\/www.kaggle.com\/c\/titanic) and I have done my share of submissions.","90050e53":"Here is another representation of this correlation:","2d6f3218":"Since for the Predictions everyone uses more of less the same models, in this Notebook I would like to cover Data Analysis and Data Visualisation. ","304035fd":"## Cabin","fbd485fa":"Note: Some of the seaborn color palettes can be found here:\nhttps:\/\/images.app.goo.gl\/a4gDzjx5ZgAvf5Kf8","21374f36":"As expected, 3rd class passngers has the lowest survival rate, while the 1st class has the highest.","dd2d2ac7":"## Port of Embarkation","4ca87e0f":"Below, another representation of the survivors and victims for each ticket class.","c966a191":"And now for the test data:","c295adb7":"### Survived","06e4c81a":"## Missing values","019de97b":"In this case, I decided to use mapping each Embarked value to a numerical value instead of creating a dummies.","dfaba645":"Most of the passengers are between 15 and 40 years old and many infants had survived. ","2518899f":"The percentage of survived women is a lot higher. However, it was expected since the women and children were put on the emergency boats first.","eeedfde5":"## Age","7041e097":"Distribution of survived: 1 is for survived and 0 is for not. ","def51f82":"Looking at the Age distribution for men and women, it's clear that the average age for both was about 30. Many men older 50 years old and children after 8 years old did not survive. However, it's opposite for women: most of the women older 50 years old survived. The middle age of men, who did not survive, was between 24 and 36 years old, for women - between 18 and 32. The oldest person on the Titanic survived who was 80 years old. ","91562293":"Instead of creating dummies like I did above, you can map values to each category. And, as you can see, these works.","f01a13b3":"![Titanic](https:\/\/resize-pdm.francedimanche.ladmedia.fr\/rcrop\/635,500\/img\/2017-04\/titanic.png?version=v1)","f48854c1":"Reading in data from the competition page:\nhttps:\/\/www.kaggle.com\/c\/titanic","d98a8cf7":"Now, let's take a look at the titanic data: There are 891 rows by 12 columns observations in total. Just by the logic, I would assume that Age, Passenger Class, and Sex are major factors in the survival rate on the Titanic.","acfabc0d":"As a metter of fact, passangers with the Cabin were more likely to survive.","337a747c":"Another way to present it:","0a6bd57c":"The average Age is around 30 years old which is not a surprise considering the time.","02bac4e8":"At the catplot below we can see the detailed distribution of the survival rate between different passenger classes on the Titanic for men and women.  ","dd5c8f20":"Now, it's clear that 1st class had 63%, 2nd class is almost 'fifty-fifty' and 3rd class had only 24% survival rate.","bf86a123":"Some additional statistics for both data sets: Average and Standard Deviation.","7948bb52":"By creating Age subgroups we can examen the data even more.","9ed792b1":"#### Barplot of survival rate between men and women:","ccf746e0":"## Correlations  and Heatmap","77d89282":"And here is the rate of survival by class:","764b7353":"The survival rate of women is a lot higher than men.","a70fb330":"#### I hope you find this kernel useful and your UPVOTES would be highly appreciated","31f7d871":"Let's started by importing our libraries:","2d39d9ee":"### Gender"}}