{"cell_type":{"ea67e231":"code","e9fb173a":"code","c32689d3":"code","a7cf16b9":"code","fb589223":"code","e4d8a799":"code","5a7423d9":"code","111e6af8":"code","096df459":"code","e7b34656":"code","5d817e5d":"code","d1d851ea":"code","d473d9d8":"code","23e62025":"code","6d0e4b9a":"markdown","cefaba9e":"markdown","c3a820b1":"markdown","07ce10f4":"markdown","4268f2bd":"markdown","845e352c":"markdown"},"source":{"ea67e231":"!pip install fastai -q --upgrade","e9fb173a":"import fastai\nprint(fastai.__version__)","c32689d3":"from fastai.vision.all import *\npath = Path('..\/input\/squidgame-images')\npath.ls()","a7cf16b9":"def get_dls(bs, size):\n    dblock = DataBlock(blocks = (ImageBlock, CategoryBlock),\n                       get_items = get_image_files,\n                       get_y = parent_label,\n                       splitter = RandomSplitter(),\n                       item_tfms = Resize(size)\n                      )\n    return dblock.dataloaders(path, bs = bs)\n\n","fb589223":"dls = get_dls(16, 128)","e4d8a799":"learn = cnn_learner(dls, resnet34, metrics=accuracy)","5a7423d9":"learn.lr_find()","111e6af8":"learn = cnn_learner(dls, resnet34, metrics=accuracy)\nlearn.fit_one_cycle(10, 1e-3)","096df459":"learn.dls = get_dls(16, 224)\nlearn.fine_tune(5, 1e-3)","e7b34656":"learn.show_results()","5d817e5d":"interp = Interpretation.from_learner(learn)\ninterp.plot_top_losses(k=3)","d1d851ea":"learn.predict('..\/input\/squidgame-images\/Oh Il-nam\/image_20211118_172426.jpg')","d473d9d8":"learn.export(fname='model.pkl', pickle_module=pickle, pickle_protocol=2)","23e62025":"reload_model=load_learner('model.pkl', cpu=True, pickle_module=pickle)\nreload_model","6d0e4b9a":"## Predict","cefaba9e":"## Save model","c3a820b1":"## Reload model","07ce10f4":"## Interpretation","4268f2bd":"## Show results","845e352c":"## Enjoy."}}