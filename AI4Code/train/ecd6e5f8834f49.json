{"cell_type":{"2a276daf":"code","233b009a":"code","305268bc":"code","53b8f14c":"code","0f343386":"code","7dc07dc3":"code","6548123d":"code","1785991e":"code","4226dd68":"code","33dcbd76":"code","b449236a":"code","83f6b592":"code","c93309fc":"code","f84ac072":"code","3789c6d2":"code","ed57c69b":"markdown","d7e7c184":"markdown","db2d025f":"markdown","ae860b7b":"markdown","3e3938d7":"markdown","8ab2695e":"markdown","e78ea063":"markdown","539c35a8":"markdown","057f8337":"markdown","cb21e95d":"markdown"},"source":{"2a276daf":"import numpy as np\nimport pandas as pd\nimport scipy.special\nimport matplotlib.pyplot as plt\nimport os\nimport random\n\nfrom sklearn.model_selection import train_test_split, GridSearchCV\nfrom sklearn.metrics import log_loss\nfrom xgboost import XGBClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.metrics import confusion_matrix\nfrom mlxtend.plotting import plot_confusion_matrix\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")","233b009a":"path = '\/kaggle\/input\/tabular-playground-series-may-2021\/'\nos.listdir(path)","305268bc":"train_data = pd.read_csv(path+'train.csv', index_col=0)\ntest_data = pd.read_csv(path+'test.csv', index_col=0)\nsamp_subm = pd.read_csv(path+'sample_submission.csv')","53b8f14c":"print('Number train samples:', len(train_data.index))\nprint('Number test samples:', len(test_data.index))","0f343386":"train_data['target'].value_counts().sort_index()","7dc07dc3":"train_data.head()","6548123d":"def encode_target(s):\n    return int(s.split('_')[1])\n\ntrain_data['target'] = train_data['target'].apply(encode_target)","1785991e":"train_data.head()","4226dd68":"X = train_data[train_data.columns[:-1]]\ny = train_data['target']\nX_train, X_val, y_train, y_val = train_test_split(X, y, test_size=0.33, random_state=2021)\nX_test = test_data","33dcbd76":"model = XGBClassifier(objective = 'multi:softprob',\n                      eval_metric = 'mlogloss',\n                      n_estimators = 50,\n                      num_class=3)\nmodel.fit(X_train, y_train)","b449236a":"y_val_pred = model.predict_proba(X_val)","83f6b592":"print('Validation Score:', log_loss(y_val, y_val_pred))","c93309fc":"y_test = model.predict_proba(X_test)","f84ac072":"targets = ['Class_'+str(i) for i in range(1, 5)]\nsamp_subm[targets] = pd.DataFrame(y_test, columns=[targets])","3789c6d2":"samp_subm.to_csv('submission.csv', index=False)","ed57c69b":"# Load Data","d7e7c184":"# Encode Target","db2d025f":"Welcome to the [Tabular Playground Series - May 2021](https:\/\/www.kaggle.com\/c\/tabular-playground-series-may-2021) competition.\n\u200b\n![](https:\/\/storage.googleapis.com\/kaggle-competitions\/kaggle\/26479\/logos\/header.png)\n\u200b\n<span style=\"color: royalblue;\">Please vote the notebook up if it helps you. Feel free to leave a comment above the notebook. Thank you. <\/span>","ae860b7b":"# Path","3e3938d7":"# Intro","8ab2695e":"# Model","e78ea063":"# Export","539c35a8":"# Overview","057f8337":"# Define Train, Val And Test Data","cb21e95d":"# Libraries"}}