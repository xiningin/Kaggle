{"cell_type":{"0a290ab3":"code","07271f78":"code","25eb3016":"code","e7163380":"code","e7a96b10":"code","531cf50b":"code","63feb576":"code","7b66b7b7":"code","65d68c5c":"code","b8573464":"code","8831542c":"code","d28e107c":"code","8fe87415":"code","95dc3167":"code","5203a9f8":"code","b73739d4":"code","d81c88b2":"code","a8972f37":"code","2badc073":"code","948c23db":"code","336d05d6":"code","0a585f7b":"code","25362087":"markdown","be71fe04":"markdown","640a7ed3":"markdown","afaf1fab":"markdown","ed99b715":"markdown","08fb2f89":"markdown","c3a65954":"markdown","31dee069":"markdown","7416ee4e":"markdown","974924c4":"markdown","6daa9852":"markdown","88bd0828":"markdown","fe22cf61":"markdown","4b57d05c":"markdown","a0c53a51":"markdown"},"source":{"0a290ab3":"import pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport numpy as np\nfrom pandas import DataFrame as df\nimport os\nimport folium\nfrom datetime import datetime\nfrom IPython.display import Image\nimport datetime as dt\nimport pylab as pl\nimport matplotlib.dates as mdates\nfrom fbprophet import Prophet\nimport pystan\nfrom fbprophet import Prophet\nsns.set(rc={\"figure.figsize\": (18,10)})","07271f78":"Image(\"..\/input\/imagess\/CovidDataAnalysisinHK.jpg\")","25eb3016":"Crown_data=pd.read_csv('..\/input\/hkdata\/enhanced_sur_covid_19_eng0716.csv')\nCrown_data29=pd.read_csv('..\/input\/hkdata\/enhanced_sur_covid_19_eng0729.csv')\nimpexp_data=pd.read_csv('..\/input\/covid-19-hk\/hongkong_covid_(importExp).csv')","e7163380":"Crown_data.info()","e7a96b10":"months = mdates.MonthLocator()\nx=np.arange(7)\nCrown_data29.rename(columns={'Report date':'ReportDate'},inplace=True)\nCrown_data29[\"ReportDate\"] = pd.to_datetime(Crown_data29[\"ReportDate\"], format='%d\/%m\/%Y', errors='ignore')\nCrown_data29[\"xDate\"]=Crown_data29[\"ReportDate\"]\n\nCrown_data29[\"xDate\"]= Crown_data29['ReportDate'].dt.strftime('%b')\nCrown_data29['month'] = pd.DatetimeIndex(Crown_data29['ReportDate']).month\n\ndata_cofim=pd.get_dummies(Crown_data29['Confirmed\/probable'],prefix='Confirmed\/probable')\ndata_cofim.rename(columns={'Confirmed\/probable_Confirmed':'Confirmed'},inplace=True)\ndata_cofim.rename(columns={'Confirmed\/probable_Probable':'Probable'},inplace=True)\n\nmon_date=Crown_data29[['month','xDate']]\n\nmerge_data=pd.concat([mon_date,data_cofim],axis=1)\n\nresuldata=merge_data.groupby(['month']).sum().reset_index() \n\nresuldata.set_index('month')\n\n#setting\nplt.subplots_adjust(bottom=0.18)\npal = sns.color_palette(\"Greens_d\",len(resuldata))\n#\nrank = resuldata[\"month\"].argsort().argsort()\n#text\ng = sns.barplot(x=\"month\",y=\"Confirmed\",data=resuldata,palette=np.array(pal[::-1])[rank])\nfor index,row in resuldata.iterrows():\n g.text(row.name,row.Confirmed,round(row.Confirmed,2),color=\"black\",ha=\"right\")\n#title\nplt.xlabel(\"Month\")\nplt.ylabel(\"Confirmed Cases Counts\")\nplt.xticks(x,('Jan','Feb','Mar','Apr','May','Jun','Jul'))\nplt.title(\"From 23Jan To 29Jul Convid19 Confirmed Cases in HongKong\")\nplt.show()","531cf50b":"#import case count with local case compare\nimpexp_data.tail()\nimpexp_data.rename(columns={'Report date':'inoutDate'},inplace=True)\nimpexp_data.rename(columns={'Case classification*':'CaseStatus'},inplace=True)\nimpexp_data['inoutDate']=pd.to_datetime(impexp_data['inoutDate'],format='%d\/%m\/%Y',errors='ignore')\nimpexp_data['month']=pd.DatetimeIndex(impexp_data['inoutDate']).month\ndategroup=impexp_data['month']\ndategroup.reset_index()\ncase_data=pd.get_dummies(impexp_data['CaseStatus'],prefix='CaseStatus')\ncase_data.rename(columns={'CaseStatus_Epidemiologically linked with imported case':'Epidemiologically_With_Imported_Case'},inplace=True)\ncase_data.rename(columns={'CaseStatus_Epidemiologically linked with local case':'Epidemiologically_With_Local_Case'},inplace=True)\ncase_data.rename(columns={'CaseStatus_Epidemiologically linked with possibly local case':'Epidemiologically_Possibly_Local_Case'},inplace=True)\ncase_data.rename(columns={'CaseStatus_Imported case':'Imported_Case'},inplace=True)\ncase_data.rename(columns={'CaseStatus_Local case':'Local_Case'},inplace=True)\ncase_data.rename(columns={'CaseStatus_Possibly local case':'Possibly_Local_Case'},inplace=True)\n\ncase_data1=case_data[['Imported_Case','Local_Case']]\ncasegroup=pd.concat([dategroup,case_data1],axis=1)\ncase_data1.reset_index()\nalldata=pd.concat([dategroup,case_data1],axis=1)\ndisplaydata=alldata.groupby(alldata['month']).sum()\ndisplaydata.plot()\nplt.title(\"Imported Case & Local Case Counts Compare\")\nplt.xlabel(\"Month\")","63feb576":"resuldata=pd.DataFrame(resuldata[\"Confirmed\"])\nresuldata.describe().round()","7b66b7b7":"\n# Data sorce of Hospital just update to 16\/Jul\nguest_data=Crown_data[['Name of hospital admitted','Hospitalised\/Discharged\/Deceased']]\n\nHos_inout_data=pd.get_dummies(guest_data['Hospitalised\/Discharged\/Deceased'],prefix='Hospitalised\/Discharged\/Deceased')\nHos_inout_data.rename(columns={'Hospitalised\/Discharged\/Deceased_Discharged':'Discharged'},inplace=True)\nHos_inout_data.rename(columns={'Hospitalised\/Discharged\/Deceased_Hospitalised':'Hospitalised'},inplace=True)\nHos_inout_data.rename(columns={'Hospitalised\/Discharged\/Deceased_Deceased':'Deceased'},inplace=True)\nHos_inout_data.rename(columns={'Hospitalised\/Discharged\/Deceased_No admission':'No admission'},inplace=True)\nHos_inout_data.rename(columns={'Hospitalised\/Discharged\/Deceased_Pending admission':'Pending admission'},inplace=True)\nguest_dataH=Crown_data[['Name of hospital admitted']]\nguest_dataH.rename(columns={'Name of hospital admitted':'HospitalName'},inplace=True)\nInout_status=pd.concat([guest_dataH,Hos_inout_data],axis=1)\nview_data=Inout_status.groupby(by='HospitalName').sum()\nview_data.reset_index(inplace=True)\nview_data_hos=view_data[['HospitalName','Hospitalised']]\nsns.barplot(x='Hospitalised',y='HospitalName',data=view_data_hos)","65d68c5c":"view_data","b8573464":"view_data_dec=view_data[['HospitalName','Deceased']]\nsns.barplot(x='Deceased',y='HospitalName',data=view_data_dec)","8831542c":"#by sex for comfired\nsexdata=Crown_data29['Gender']\ncomparemf=pd.concat([sexdata,data_cofim],axis=1)\nmf=comparemf.groupby(['Gender']).sum().reset_index()\nmfrank = mf[\"Gender\"].argsort().argsort()\nmfg = sns.barplot(x=\"Gender\",y=\"Confirmed\",data=mf,palette=np.array(pal[::-1])[mfrank])\nfor index,row in mf.iterrows():\n  mfg.text(row.name,row.Confirmed,round(row.Confirmed,2),color=\"blue\",ha=\"right\")\nplt.xticks(np.arange(2),('Female','Male'),rotation=360)\nplt.title(\"Male & Female Confirmed Cases Compare\")\nplt.show()","d28e107c":"print(\"23Jan-29Jul Confirmed Cases Total:\",int(mf['Confirmed'].sum()))","8fe87415":"guest_age=Crown_data['Age']\ncolors = ['tomato', 'lightskyblue', 'goldenrod', 'green', 'y']\ncutdata=pd.concat([guest_age,Hos_inout_data],axis=1)\ncutdata['splitdata']=pd.cut(cutdata['Age'],[0,20,40,60,80,100],\n                            labels=['under20AgeGroup','20-40AgeGroup','40-60AgeGroup','60-80AgeGrpup','80-100AgeGroup'])\ndisdata=cutdata['Discharged'].groupby(cutdata['splitdata']).sum()\ndisdata.reset_index()\nplt.subplot(2,2,1)\ndisdata.plot(kind='pie',title='Discharged Percentage',autopct='%.1f%%',colors=colors,explode=(0,0.1,0,0,0))\n\ndecdata=cutdata['Deceased'].groupby(cutdata['splitdata']).sum()\ndecdata.reset_index()\nplt.subplot(2,2,2)\ndecdata.plot(kind='pie',title='Deceased Percentage',autopct='%1.1f%%',colors=colors,explode=(0,0,0,0.1,0))\n\nhosdata=cutdata['Hospitalised'].groupby(cutdata['splitdata']).sum()\nhosdata.reset_index()\nplt.subplot(2,2,3)\nhosdata.plot(kind='pie',title='Hospitalised Percentage',startangle=70,colors=colors,autopct='%1.1f%%',explode=(0,0,0.1,0,0))\n\ncutdata2=pd.concat([guest_age,data_cofim],axis=1)\ncutdata2['splitdata2']=pd.cut(cutdata2['Age'],[0,20,40,60,80,100],labels=['under20AgeGroup','20-40AgeGroup','40-60AgeGroup','60-80AgeGrpup','80-100AgeGroup'])\ncomdata=cutdata2['Confirmed'].groupby(cutdata2['splitdata2']).sum()\ncomdata.reset_index()\nplt.subplot(2,2,4)\ncomdata.plot(kind='pie',title='Confirmed Percentage',autopct='%1.1f%%',colors=colors,explode=(0,0.1,0,0,0))\nplt.show()","95dc3167":"## Age with hospitalised & Deceased heamap\nCrown_Age=Crown_data[['Age']]\nview_data_Thr=Hos_inout_data[['Hospitalised','Discharged','Deceased']]\ngroupAge=pd.concat([Crown_Age,view_data_Thr],axis=1)\nsns.pairplot(groupAge,kind=\"reg\",vars=[\"Age\",\"Hospitalised\",\"Discharged\",\"Deceased\"])\n#sns.pairplot(groupAge,kind=\"reg\",hue=\"Discharged\",vars=[\"Age\",\"Hospitalised\",\"Discharged\",\"Deceased\"])","5203a9f8":"agedata=view_data.corr()\nsns.heatmap(agedata,annot=True)","b73739d4":"# 18 districts in which more than 2 probable\/confirmed cases have resided in the past 14 days\nbuild_data=pd.read_csv('..\/input\/hkdata\/building_list_eng29.csv')\nbuild_data.rename(columns={'Related probable\/confirmed cases':'Confirmed_Case_Counts'},inplace=True)\nbuild_data=build_data[['District','Confirmed_Case_Counts']]\ninfo_case=build_data['Confirmed_Case_Counts'].str.split(',',expand=True)\ninfo_case=info_case.stack()\ninfo_case=info_case.reset_index(level=1,drop=True).rename('Case_Counts')\ninfo_new=build_data.drop(['Confirmed_Case_Counts'],axis=1).join(info_case)\nDistrict=info_new.groupby(\"District\")\nDisdata=District.size()\nDisdata","d81c88b2":"#with 2 or more probable\/confirmed cases have resided in the past 14 days(25\/07\/2020)\nlongitude = 114.1693611\nlatitude = 22.3193039\n\ntooltip ='Please click for informations'\ncase_map = folium.Map(location=[latitude, longitude],zoom_start=11)\ncase_map.add_child(folium.Marker(location=[22.286667,114.155],tooltip=tooltip,popup='Central&Western CaseCounts 44',icon=folium.Icon(color='blue')))\ncase_map.add_child(folium.Marker(location=[22.284167,114.224167],tooltip=tooltip,popup='Eastern CaseCounts 82',icon=folium.Icon(color='blue')))\ncase_map.add_child(folium.Marker(location=[22.261111,113.946111],tooltip=tooltip,popup='Islands CaseCounts 25',icon=folium.Icon(color='blue'))) \ncase_map.add_child(folium.Marker(location=[22.328333,114.181667],tooltip=tooltip,popup='Kowloon City CaseCounts 159',icon=folium.Icon(color='pink'))) \ncase_map.add_child(folium.Marker(location=[22.355,114.083889],tooltip=tooltip,popup='Kwai Tsing CaseCounts 121',icon=folium.Icon(color='blue'))) \ncase_map.add_child(folium.Marker(location=[22.313333,114.225833],tooltip=tooltip,popup='Kwun Tong CaseCounts 241',icon=folium.Icon(color='pink')))\ncase_map.add_child(folium.Marker(location=[22.494722,114.138056],tooltip=tooltip,popup='North CaseCounts 101',icon=folium.Icon(color='blue')))\ncase_map.add_child(folium.Marker(location=[22.381389,114.270556],tooltip=tooltip,popup='Sai Kung CaseCounts 116',icon=folium.Icon(color='blue')))\ncase_map.add_child(folium.Marker(location=[22.385556,114.193056],tooltip=tooltip,popup='Sha Tin CaseCounts 163',icon=folium.Icon(color='pink')))\ncase_map.add_child(folium.Marker(location=[22.330833,114.162222],tooltip=tooltip,popup='Sham Shui Po CaseCounts 168',icon=folium.Icon(color='pink')))\ncase_map.add_child(folium.Marker(location=[22.247222,114.158889],tooltip=tooltip,popup='Southern CaseCounts 29',icon=folium.Icon(color='blue')))\ncase_map.add_child(folium.Marker(location=[22.441178,114.164772],tooltip=tooltip,popup='Tai Po CaseCounts 48',icon=folium.Icon(color='blue')))\ncase_map.add_child(folium.Marker(location=[22.374444,114.115],tooltip=tooltip,popup='Tsuen Wan CaseCounts 59',icon=folium.Icon(color='blue')))\ncase_map.add_child(folium.Marker(location=[22.390264,113.976255],tooltip=tooltip,popup='Tuen Mun CaseCounts 234',icon=folium.Icon(color='pink')))\ncase_map.add_child(folium.Marker(location=[22.390264,113.976255],tooltip=tooltip,popup='Wan Chai CaseCounts 88',icon=folium.Icon(color='blue')))\ncase_map.add_child(folium.Marker(location=[22.333611,114.196944],tooltip=tooltip,popup='Wong Tai Sin  CaseCounts 538',icon=folium.Icon(color='red')))\ncase_map.add_child(folium.CircleMarker(location=[22.333611,114.196944],tooltip=tooltip,popup='Wong Tai Sin  CaseCounts 538',max_width=1000,min_width=1000,radius=25,fill=True,fill_color='crimson',icon=folium.Icon(color='red')))\ncase_map.add_child(folium.Marker(location=[22.321389,114.1725],tooltip=tooltip,popup='Yau Tsim Mong CaseCounts 256',icon=folium.Icon(color='red')))\ncase_map.add_child(folium.CircleMarker(location=[22.321389,114.1725],tooltip=tooltip,popup='Yau Tsim Mong CaseCounts 256',radius=25,fill=True,fill_color='crimson',icon=folium.Icon(color='red')))\ncase_map.add_child(folium.Marker(location=[22.445556,114.022222],tooltip=tooltip,popup='Yuen Long CaseCounts 82',icon=folium.Icon(color='blue')))\n\ncase_map","a8972f37":"#future\nfutrue_data=pd.read_csv('..\/input\/hkdata\/enhanced_sur_covid_19_eng0729.csv')\nfutrue_data=futrue_data[['Report date','Confirmed\/probable']]\nspilt_data=pd.get_dummies(futrue_data['Confirmed\/probable'],prefix='Confirmed\/probable')\nspilt_data.rename(columns={'Confirmed\/probable_Confirmed':'Confirmed'},inplace=True)\nspilt_data=spilt_data[['Confirmed']]\n\nComtraining_data=pd.concat([futrue_data,spilt_data],axis=1)\nComtraining_data.rename(columns={'Report date':'ds','Confirmed':'y'},inplace=True)\nComtraining_data=Comtraining_data[['ds','y']]\nComtraining_data['ds']=Comtraining_data['ds'].apply(pd.to_datetime)\nComtraining_data.reset_index()\nplt.xticks(rotation=90)\nrecord=Comtraining_data['y'].groupby(Comtraining_data['ds']).value_counts()\nrecord.plot()","2badc073":"#Comtraining_data\nprophet = Prophet()\nprophet.fit(Comtraining_data)\nfuture = prophet.make_future_dataframe(periods=180)\nfuture.tail()","948c23db":"forecast = prophet.predict(future)\nforecast[['ds','trend','yhat', 'yhat_lower','yhat_upper']].tail()","336d05d6":"fig1 = prophet.plot(forecast)\nprint(fig1)","0a585f7b":"fig2 = prophet.plot_components(forecast)\nprint(fig2)","25362087":"![image.png](attachment:image.png)","be71fe04":"# Again Outbreak Reason:\n\nBecause exempted quarantine personnel infect local people.\n*From all over the world seaman and pilots is shift in HK\nSome sick seaman come in HK on Jun\n\nLocal cases spread further through transportation and restaurants etc.","640a7ed3":"# Forecast To peak from Jul to Oct in HongKong","afaf1fab":"# Forecast once again break out from Dec2020 to May 2021 in HongKong","ed99b715":"# Confirmed Cases on past 14 days\n15Jul-29Jul","08fb2f89":"**# 23Jan-16Jul Hospitalised,Discharged,Deceased and Pending admission counts of Hospital**","c3a65954":"# Wong Tai Sin District is High-Risk Area","31dee069":"Setting Date and Data for Forecast","7416ee4e":"![image.png](attachment:image.png)","974924c4":"![image.png](attachment:image.png)","6daa9852":"Male & Female Confirmed Cases Compare: Female is more than Male","88bd0828":"Highest Percentage of Hospitalization 26.9% 20-40 AgeGroup\n\nHighest Percentage of Discharged      42.7% 20-40 AgeGroup\n\nHighest Percentage of Deceased        50%   60-80 AgeGroup\n\nHighest Percentage of Confirmed       38.7% 20-40 AgeGroup\n\n20-40 AgeGroup is Confirmed High-Risk AgeGroup\n\n60-80 AgeGroup is Deceased High-Risk AgeGroup","fe22cf61":"In the face of the pandemic virus of this century, no place on earth is immune. Then we can only face and predict the time period of the next outbreak in advance,and prevent to high-risk area.I hope that an effective vaccine will be available to help everyone soon.\nThe Convid-19 broke out again in a short time in HongKong.This notebook will trend forecast Convid-19 for HongKong.","4b57d05c":"Data just update to 16\/Jul about Hospital","a0c53a51":"![image.png](attachment:image.png)"}}