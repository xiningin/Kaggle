{"cell_type":{"44ec4f84":"code","0c06a8be":"code","9980f65e":"code","5116e841":"code","6686f64d":"code","63711c77":"code","b167eb59":"code","d60b1213":"code","69e2c33f":"code","5745e0b3":"code","6bef1d12":"code","35f22c72":"code","c8624e9f":"code","04ee6bb0":"code","917c5b9e":"code","faa586e7":"code","ddf207fa":"code","45f01c9a":"code","d4600cb0":"code","01a07542":"code","1a2c5c31":"code","1cdbf71f":"code","39aeb0b8":"code","a6fd4d90":"code","a8ba6e17":"code","fa236458":"code","048bf4af":"code","3650771a":"code","27bf4a91":"code","0789e3bb":"code","0ef2ffe1":"code","ce8ea3cd":"code","5d8965a8":"code","102d2cf3":"code","4ab0adb2":"code","349fa04e":"code","305b7404":"code","0b8eb818":"code","412f786e":"code","5419795f":"code","55dd3453":"code","d31e1e3b":"code","1dfe3ad3":"code","ca50299b":"code","bb0adc49":"code","6637df05":"code","41521c5d":"code","5d39fe5b":"code","181460a4":"code","9230bba5":"code","dedf6fd9":"markdown","0d5198c9":"markdown","142e761e":"markdown","752bc52c":"markdown","56a18c02":"markdown","6c030dd3":"markdown","7c182246":"markdown","d12470f2":"markdown","973740d7":"markdown","8baf9ce4":"markdown","767a461b":"markdown","3e7e77d2":"markdown","330678fe":"markdown","661c8d1b":"markdown","06a2da0c":"markdown","d080b2bf":"markdown","44c23025":"markdown","e86f81b9":"markdown","0765af61":"markdown","19304242":"markdown","5484eaaf":"markdown","a56db9a2":"markdown","042ea13d":"markdown","95588246":"markdown","ec58a5ee":"markdown","bcfd0c72":"markdown","c8f4ec3a":"markdown","ce828b1c":"markdown","607af30d":"markdown","3fbaae09":"markdown","4f16c0c9":"markdown","c870cc28":"markdown"},"source":{"44ec4f84":"import warnings\nwarnings.filterwarnings('ignore')\n\n\nimport numpy as np \nimport pandas as pd\nimport os\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom scipy.stats import norm\n\nfrom sklearn.metrics import accuracy_score,confusion_matrix,recall_score,precision_score\n\n\nfrom sklearn.model_selection import train_test_split,cross_val_score,RandomizedSearchCV\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.svm import SVC\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.ensemble import AdaBoostClassifier\nfrom catboost import CatBoostClassifier\nfrom xgboost import XGBClassifier\n\n\n\nplt.rcParams['figure.figsize'] = (10,6)\n","0c06a8be":"#mat = pd.read_csv('\/kaggle\/input\/student-alcohol-consumption\/student-mat.csv')\ndata =pd.read_csv('\/kaggle\/input\/student-alcohol-consumption\/student-por.csv')","9980f65e":"data.head()","5116e841":"data.isnull().sum()","6686f64d":"data.info()","63711c77":"# Describe data Statistically(only numerical values and continous values)\ndata.describe().T.style.bar(subset=['mean'])\\\n                            .background_gradient(subset=['std'])\\\n                            .background_gradient(subset=['50%'])\\\n                            .background_gradient(subset=['max'])","b167eb59":"# create Grand Total by adding all grades\ndata['G_Total'] = data['G1']+data['G2']+data['G3']","d60b1213":"# combine weekend consumption with workday consumption\ndata['Dalc'] = data['Dalc']+data['Walc']","69e2c33f":"# for finding unique values\ndata['Dalc'].unique()","5745e0b3":"# lets seperate the categorical variable and numerical variables\ncat_col = [x for x in data.columns if data[x].dtypes=='O']\nnum_col = [x for x in data.columns if x not in cat_col]\n","6bef1d12":"# Target Variable\nplt.figure(figsize=(12,6))\nsns.countplot(x='G_Total', data=data,\n                   facecolor=(0,0,0,0),\n                   linewidth=5,\n                   edgecolor=sns.color_palette(\"dark\", 10))\n","35f22c72":"plt.figure(figsize=(10,6))\nsns.countplot(data=data,x='age',hue='Dalc')\nplt.tight_layout()\nplt.show()","c8624e9f":"# lets examine various features together\nplt.figure(figsize=(30,30))\nfeature = [x for x in num_col if 'G_Total' not in x]\nfor i in enumerate(feature):\n    plt.subplot(5,4,i[0]+1)\n    sns.countplot(i[1],hue='Dalc',data=data)\n    plt.title(i[1]+' vs workday alcohol Consumption (Dalc)')\n    plt.xticks(rotation=45)","04ee6bb0":"# school vs alcohol consumption on workday\nsns.countplot(data=data,x='school',hue='Dalc')","917c5b9e":"# female vs alcohol consumption on weekends\nsns.countplot(data=data,x='sex',hue='Dalc',palette='Set3')","faa586e7":"# Countplot provide us the count values\nsns.countplot('Dalc',data=data,palette='winter')","ddf207fa":"#grade vs Alcohol consumption\nsns.catplot(y=\"G_Total\", x=\"Dalc\",hue='sex', kind=\"swarm\", data=data)","45f01c9a":"# alcohol consumption vs grades(under average or above average)\naverage=data['G_Total'].mean()\ndata['average'] = ['under average'if i < average else 'above average' for i in data.G_Total]\nsns.swarmplot(x='Dalc',y='G_Total',hue='average',data=data,palette={'above average':'Red','under average':'green'})","d4600cb0":"# Dalc vs G_Total on gender\nsns.catplot(x='Dalc',y='G_Total',hue='school',col='sex',data=data,kind='bar')","01a07542":"#countplot for romantic vs Dalc\nsns.catplot(x='romantic',hue='Dalc',data=data,kind='count')","1a2c5c31":"\nsns.catplot(x='Dalc',y='G_Total',col='romantic',data=data,kind='bar',palette='summer')","1cdbf71f":"plt.figure(figsize=(30,30))\nfor i in enumerate(cat_col):\n    plt.subplot(5,4,i[0]+1)\n    sns.countplot(x=i[1],hue='Dalc',data=data,palette='nipy_spectral')\n    \n    ","39aeb0b8":"GP = data[data.school == 'GP']\nMS = data[data.school == 'MS']\n\nfig,ax=plt.subplots(1,2,figsize=(12,6))\nsns.kdeplot(GP.G_Total,label=\"GP\",ax=ax[0])\nsns.kdeplot(MS.G_Total,label=\"MS\",ax=ax[0])\n\nsns.kdeplot(GP.Dalc,label='GP',ax=ax[1],)\nsns.kdeplot(MS.Dalc,label='MS',ax=ax[1])\nax[0].set_ylabel('')\nax[1].set_ylabel('')\n\nplt.show()","a6fd4d90":"# count of Pstatus\nsns.countplot(x='Pstatus',data=data)","a8ba6e17":"#g_Total vs Pstatus\n\nsns.catplot(x='Pstatus',y='G_Total',data=data)","fa236458":"#guardian vs G_total\nsns.catplot(x='guardian',y='G_Total',data=data)","048bf4af":"#guardian vs G_total with Dalc\nsns.catplot(x='Dalc',y='G_Total',hue='guardian',data=data)","3650771a":"sns.catplot(x='internet',y='G_Total',data=data,kind='swarm')","27bf4a91":"sns.barplot(x='internet',y='G_Total',data=data,hue='romantic')","0789e3bb":"sns.catplot(x='internet',y='G_Total',data=data,hue='Dalc',kind='bar')","0ef2ffe1":"fig,ax=plt.subplots(1,3,figsize=(20,5))\nsns.distplot(data['G1'],ax=ax[0])\nsns.distplot(data['G_Total'],ax=ax[0],color='red')\nax[0].set_xlabel(\"G1 vs G_Total\")\n\nsns.distplot(data['G2'],ax=ax[1])\nsns.distplot(data['G_Total'],ax=ax[1],color='green')\nax[1].set_xlabel(\"G2 vs G_Total\")\n\nsns.distplot(data['G3'],ax=ax[2])\nsns.distplot(data['G_Total'],ax=ax[2])\nax[2].set_xlabel(\"G3 vs G_Total\")\nplt.show()\n\nsns.distplot(data['G_Total'],color='violet',fit=norm)","ce8ea3cd":"plt.figure(figsize=(16,6))\nsns.heatmap(data.corr(),annot=True,cmap='cividis')","5d8965a8":"data['romantic']=np.where(data['romantic'].values=='yes',1,0)\ndata['internet']=np.where(data['internet'].values=='yes',1,0)\ndata['higher']=np.where(data['higher'].values=='yes',1,0)\ndata['nursery']=np.where(data['nursery'].values=='yes',1,0)\ndata['activities']=np.where(data['activities'].values=='yes',1,0)\ndata['paid']=np.where(data['paid'].values=='yes',1,0)\ndata['famsup']=np.where(data['famsup'].values=='yes',1,0)\ndata['schoolsup']=np.where(data['schoolsup'].values=='yes',1,0)","102d2cf3":"data['school']=np.where(data['school'].values=='GP',1,0)\ndata['sex']=np.where(data['sex'].values=='M',1,0)\ndata['address']=np.where(data['address'].values=='U',1,0)\ndata['famsize']=np.where(data['famsize'].values=='GT3',1,0)\ndata['Pstatus']=np.where(data['Pstatus'].values=='A',1,0)","4ab0adb2":"data['health']","349fa04e":"Mjob=pd.get_dummies(data['Mjob'],prefix='M_job',drop_first=True)\nFjob=pd.get_dummies(data['Fjob'],prefix='F_job',drop_first=True)\nreason = pd.get_dummies(data['reason'],prefix='reason',drop_first=True)\nguardian = pd.get_dummies(data['guardian'],prefix='guardian',drop_first=True)","305b7404":"Mjob.head()","0b8eb818":"data.drop(['Mjob','Fjob','reason','guardian','G1','G2','G3','average'],axis=1,inplace=True)","412f786e":"df_1 = pd.concat([data,Mjob,Fjob,reason,guardian],axis=1)\ndf_1.head()","5419795f":"# If you want to Convert your data into 3 categories\n\n#data['G_Total']=np.where(data['G_Total'].between(1,21),1,data['G_Total'])\n#data['G_Total']=np.where(data['G_Total'].between(21,40),2,data['G_Total'])\n#data['G_Total']=np.where(data['G_Total'] >39,3,data['G_Total'])\n#data['G_Total'].plot.hist()\n#data['G_Total'].value_counts()","55dd3453":"X=df_1.drop('G_Total',axis=1)\ny=df_1['G_Total']","d31e1e3b":"print(X.shape)\nprint(y.shape)\n","1dfe3ad3":"\nX_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.3,random_state=20)\nprint(X_train.shape)\nprint(X_test.shape)\nprint(y_train.shape)\nprint(y_test.shape)","ca50299b":"models=[]\nnames=['Decision Tree','SVC','Random Forest','Adaboost','XGB classifier']\ncv_models=[]\n# Decision Tree\ndt=[]\ndt=DecisionTreeClassifier()\ndt.fit(X_train,y_train)\ndt_pred=dt.predict(X_test)\nmodels.append(accuracy_score(y_test,dt_pred))\n\n\ncv_models.append(cross_val_score(dt,X,y,cv=5).mean())\n","bb0adc49":"#svm\nsvc=SVC()\nsvc.fit(X_train,y_train)\nsvc_pred = svc.predict(X_test)\nmodels.append(accuracy_score(y_test,svc_pred).mean())\ncv_models.append(cross_val_score(svc,X,y,cv=5).mean())","6637df05":"#Random Forest\nrf =RandomForestClassifier()\nrf.fit(X_train,y_train)\nrf_pred = rf.predict(X_test)\nmodels.append(accuracy_score(y_test,rf_pred))\ncv_models.append(cross_val_score(rf,X,y,cv=5).mean())","41521c5d":"#AdaBoost\nab = AdaBoostClassifier()\nab.fit(X_train,y_train)\nab_pred = ab.predict(X_test)\nmodels.append(accuracy_score(y_test,ab_pred))\ncv_models.append(cross_val_score(ab,X,y,cv=5).mean())\nprint(cross_val_score(ab,X,y,cv=5).mean())","5d39fe5b":"xgb =XGBClassifier()\nxgb.fit(X_train,y_train)\nxgb_pred =xgb.predict(X_test)\nmodels.append(accuracy_score(y_test,xgb_pred))\ncv_models.append(cross_val_score(xgb,X,y,cv=5).mean())\nprint(cross_val_score(xgb,X,y,cv=5).mean())","181460a4":"cv_models=[i*1000 for i in cv_models]\nmodels = [i*1000 for i in models]","9230bba5":"# final models dataset\nfinal_df=pd.DataFrame({'Model_names':names,'Train_test_split_score in %':models,'CV_Score in %':cv_models})\nfinal_df","dedf6fd9":"# Data Split\n**Here we see we have very few rows and high number of columns we use various techniques to split the data**","0d5198c9":"**In our dataset we have 0 Null values**","142e761e":"# Preprocessing","752bc52c":"Lets know about dataset columns\n- school - student's school (binary: 'GP' - Gabriel Pereira or 'MS' - Mousinho da Silveira)\n- sex - student's sex (binary: 'F' - female or 'M' - male)\n- age - student's age (numeric: from 15 to 22)\n- address - student's home address type (binary: 'U' - urban or 'R' - rural)\n- famsize - family size (binary: 'LE3' - less or equal to 3 or 'GT3' - greater than 3)\n- Pstatus - parent's cohabitation status (binary: 'T' - living together or 'A' - apart)\n- Medu - mother's education (numeric: 0 - none, 1 - primary education (4th grade), 2 \u2013 5th to 9th grade, 3 \u2013 secondary education or 4 \u2013 higher education)\n- Fedu - father's education (numeric: 0 - none, 1 - primary education (4th grade), 2 \u2013 5th to 9th grade, 3 \u2013 secondary education or 4 \u2013 higher education)\n- Mjob - mother's job (nominal: 'teacher', 'health' care related, civil 'services' (e.g. administrative or police), 'at_home' or 'other')\n- Fjob - father's job (nominal: 'teacher', 'health' care related, civil 'services' (e.g. administrative or police), 'at_home' or 'other')\n- reason - reason to choose this school (nominal: close to 'home', school 'reputation', 'course' preference or 'other')\n- guardian - student's guardian (nominal: 'mother', 'father' or 'other')\n- traveltime - home to school travel time (numeric: 1 - 1 hour)\n- studytime - weekly study time (numeric: 1 - 10 hours)\n- failures - number of past class failures (numeric: n if 1<=n<3, else 4)\n- schoolsup - extra educational support (binary: yes or no)\n- famsup - family educational support (binary: yes or no)\n- paid - extra paid classes within the course subject (Math or Portuguese) (binary: yes or no)\n- activities - extra-curricular activities (binary: yes or no)\n- nursery - attended nursery school (binary: yes or no)\n- higher - wants to take higher education (binary: yes or no)\n- internet - Internet access at home (binary: yes or no)\n- romantic - with a romantic relationship (binary: yes or no)\n- famrel - quality of family relationships (numeric: from 1 - very bad to 5 - excellent)\n- freetime - free time after school (numeric: from 1 - very low to 5 - very high)\n- goout - going out with friends (numeric: from 1 - very low to 5 - very high)\n- Dalc - workday alcohol consumption (numeric: from 1 - very low to 5 - very high)\n- Walc - weekend alcohol consumption (numeric: from 1 - very low to 5 - very high)\n- health - current health status (numeric: from 1 - very bad to 5 - very good)\n- absences - number of school absences (numeric: from 0 to 93)\n\nThese grades are related with the course Portuguese:\n- G1 - first period grade (numeric: from 0 to 20)\n- G2 - second period grade (numeric: from 0 to 20)\n- G3 - final grade (numeric: from 0 to 20, output target)","56a18c02":"# Import Packages","6c030dd3":"**Most of columns are of object then others are of int64 datatypes**","7c182246":"**As we see romantic relation have an impact on alcohol consumption.Those who are not in a Relationship,consumes more alcohol then those who are in relationship**\n\n**Let's check what is the affect of relationship on Alcohol consumption and Total grade**","d12470f2":"- **students of GP are more good than student of MS in overall grades**\n- **In right hand figure we can see students of GP are also good in alcohol consumption compare to the students of MS**","973740d7":"- **We see there are the heighr number of T then A that means there are less then 100 students whose parents are far from each other**","8baf9ce4":"# EDA","767a461b":"**Students with mother as Guradian shows good result in grades**","3e7e77d2":"**MODELS :**\n- **Decision Tree.**\n- **SVC**\n- **Random Forest.**\n- **Adaboost.**\n- **CatBoost.**\n- **XGB classifier**","330678fe":"**There are very less student who drinks more than 8 times in a week and most of them are males**","661c8d1b":"# Feature Engineering","06a2da0c":"**So alcohol consumption on workday is more in GP comparible to MS and they most of are level 1 consumer of alcohol**","d080b2bf":"**we observe following Points:**\n1. Age having heighest mean value with lead in 50% values.\n2. Absences having heighest std value that mean absence having more spread in distribution.\n3. absence also having maximum value.","44c23025":"### One-Hot Encoding","e86f81b9":"**Here we clearly see that the student of school GP are more engage in alcohol consumption than MS and we can also see that males are little more number than female**","0765af61":"**I hope you enjoy this Notebook.If you like please give Upvote**","19304242":"**Students with Internet Performs very well than student with no internet**\n","5484eaaf":"# Models\n**There are lots of columns in our dataset so either we use dimensional reduction or we can go with specific classification algorithms which robust to high dimensionality and multicollinearity also**\n\n\n**Amazed!  what are these heavy words so let me explain for you:**\n- ***Dimensional Reduction :*It is the transformation of data from a high-dimensional space into a low-dimensional space so that the low-dimensional representation retains some meaningful properties of the original data.**\n\n- ***High Dimensionality :* It means that the number of dimensions are staggeringly high \u2014 so high that calculations become extremely difficult. With high dimensional data, the number of features can exceed the number of observations.**\n\n- ***Multicollinearity :* It exists whenever an independent variable is highly correlated with one or more of the other independent variables in a multiple regression equation. Multicollinearity is a problem because it undermines the statistical significance of an independent variable.**\n\n\n\n\n**NOTE :**\n- ***Curse of Dimensionality :* Curse of Dimensionality refers to a set of problems that arise when working with high-dimensional data**","a56db9a2":"**Those who are in relationship and also consume alcohol doesn't much impact on their Grades**","042ea13d":"# Future Updates:\n- **Hyperparameter Optimization of models.**\n- **Use other classification algorithms.**\n- **Use of Dimensional Reduction techniques**","95588246":"**As the level of consumption increases the average grade decreases.that means student who takes highest grade consumes alcohol only 2 times in a week.**\n\n\n**Let's try to find more information about grades and consumption**","ec58a5ee":"**There is no student who does not consume alcohol. However, all students at least 2 times in a week consume alcohol**","bcfd0c72":"# Load Dataset","c8f4ec3a":"**From the above figures we observe following things:**\n1. A large number of females takes 2 times alcohol consumption in a week while there are some males who consme 10 times alcohol in a week.\n2. Students from Urban places or cities consume more alcohol than Rural students.\n3. Those students whose father and mother are Apart from each other having very low amount of consumption comparable to students whose parents lives together.\n4. Guardian of students also impact on their drink status.Students having guardian other than mother and father,their alcohol consumption also very low.\n5. still lot to search\n","ce828b1c":"**Mostly age between 15-19 are more engaged in daily consumption of alcohol but they are in initial drinking stage**","607af30d":"**Age group between 15-19 are more interested in drinking but there are everytype of drinkers in this age.mostly the beginner one**","3fbaae09":"- **In Grades, Students with Pstatus 'T' are more good**","4f16c0c9":"- **students having their mother as guardian,they perform well in grades but they also consume alcohol on large scale**\n- **students having their mother as guardian,they are on every level of alcohol consumption**","c870cc28":"**We can Observe the following things:**\n- Most of the drinker belongs to age group 15-18 but the consumption of alcohol is not very much.\n- Normally there is not any special pattern in Medu and Fedu but still there is very less consumption of alcohol with 0 value of Medu and Fedu.There is still lot to find in Medu and Fedu.\n- Those who live far from school takes less alcohol consumption that means if traveltime decreases,alcohol consumption increases.\n- Studytime: It is not confirmed but more study time means less alcohol consumption.\n- failures: failures shows us that 0 failures having heighest consumption.\n- absence: lesser absence have direct relation to highest consumption\n\n\n\n**But still lot to analyse**\n\n\n"}}