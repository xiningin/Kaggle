{"cell_type":{"d94ce328":"code","94e3b961":"code","2cc5b1cb":"code","18a1b28d":"code","180235e0":"code","f23f2e40":"code","f0545a48":"code","02b9ab00":"code","196c732d":"code","fb2243f6":"code","6e44fce6":"code","5e82e0e1":"code","7abd3f1d":"code","a00a9796":"code","8d021b90":"code","20daadb8":"code","2a3458bf":"code","f00441b5":"code","54b228d8":"code","8bb1b89e":"markdown","221ad4dd":"markdown","5cc354ef":"markdown","be65b936":"markdown","3dd10c70":"markdown","b528bad2":"markdown","bd0a2e58":"markdown","007af789":"markdown"},"source":{"d94ce328":"# \uc2dc\ud5d8\ud658\uacbd \uc138\ud305 (\ucf54\ub4dc \ubcc0\uacbd X)\nimport pandas as pd\nimport numpy as np\nfrom sklearn.model_selection import train_test_split\n\ndef exam_data_load(df, target, id_name=\"\", null_name=\"\"):\n    if id_name == \"\":\n        df = df.reset_index().rename(columns={\"index\": \"id\"})\n        id_name = 'id'\n    else:\n        id_name = id_name\n    \n    if null_name != \"\":\n        df[df == null_name] = np.nan\n    \n    X_train, X_test = train_test_split(df, test_size=0.2, shuffle=True, random_state=2021)\n    y_train = X_train[[id_name, target]]\n    X_train = X_train.drop(columns=[id_name, target])\n    y_test = X_test[[id_name, target]]\n    X_test = X_test.drop(columns=[id_name, target])\n    return X_train, X_test, y_train, y_test \n    \ndf = pd.read_csv(\"..\/input\/titanic\/train.csv\")\nX_train, X_test, y_train, y_test = exam_data_load(df, \n                                                  target='Survived', \n                                                  id_name='PassengerId')\n\nX_train.shape, X_test.shape, y_train.shape, y_test.shape","94e3b961":"# \ub77c\uc774\ube0c\ub7ec\ub9ac \ubd88\ub7ec\uc624\uae30\nimport pandas as pd","2cc5b1cb":"# \ub370\uc774\ud130 \ubd88\ub7ec\uc624\uae30 (\uc0dd\ub7b5)\nX_train.shape, y_train.shape, X_test.shape","18a1b28d":"X_train.head()","180235e0":"X_test.head()","f23f2e40":"X_train.isnull().sum(), X_test.isnull().sum()","f0545a48":"y_train.head()","02b9ab00":"X_train.info(), X_test.info()","196c732d":"X_train[\"Embarked\"].value_counts()","fb2243f6":"# 1.\uacb0\uce21\uce58 \ucc98\ub9ac\nX_train = X_train.drop([\"Cabin\", \"Name\", \"Ticket\"], axis=1)\nX_test = X_test.drop([\"Cabin\", \"Name\", \"Ticket\"], axis=1)\n\nX_train[\"Age\"] = X_train[\"Age\"].fillna(X_train[\"Age\"].mean())\nX_test[\"Age\"] = X_test[\"Age\"].fillna(X_test[\"Age\"].mean())\n\nX_train[\"Embarked\"] = X_train[\"Embarked\"].fillna(\"S\")\nX_test[\"Embarked\"] = X_test[\"Embarked\"].fillna(\"S\")\n\nX_train.info(), X_test.info()","6e44fce6":"X_train.describe(), X_test.describe()","5e82e0e1":"# 2. \ub77c\ubca8\ub9c1\nfrom sklearn.preprocessing import LabelEncoder\n\ntrain_ob = X_train.select_dtypes(include=\"object\").columns\n\nle = LabelEncoder()\n\nfor i in train_ob:\n    X_train[i] = le.fit_transform(X_train[i])\n    X_test[i] = le.transform(X_test[i])","7abd3f1d":"from sklearn.model_selection import train_test_split, RandomizedSearchCV\nfrom sklearn.pipeline import Pipeline\n\nX_train, X_valid, y_train, y_valid = train_test_split(X_train, y_train[\"Survived\"], test_size=0.2, random_state=42, stratify=y_train[\"Survived\"])","a00a9796":"from random import randint, uniform\n\nfrom sklearn.preprocessing import StandardScaler\n\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom xgboost import XGBClassifier\n\n\nmy_pipe = Pipeline([(\"scaler\", StandardScaler()), (\"model\", LogisticRegression())])\n\nparam = [{'model': [LogisticRegression(random_state=42)],\n         'model__C': [1, 3, 5,7, 10]},\n         \n        {'model': [RandomForestClassifier(random_state=42)],\n         'model__n_estimators': [i for i in range(10, 101, 10)],\n         'model__max_depth': [i for i in range(3, 11)]},\n         \n         {'model': [XGBClassifier(random_state=42)],\n         'model__max_depth': [i for i in range(3, 11)],\n         'model__learning_rate': [0.5, 0.3, 0.1, 0.05, 0.001]}]\n\nr_s = RandomizedSearchCV(my_pipe, param, cv=5, scoring=\"accuracy\", n_iter=20)\nr_s.fit(X_train, y_train)\n\nprint(\"Best Params :\", r_s.best_params_)\nprint(\"Best Score :\", r_s.best_score_)","8d021b90":"model = RandomForestClassifier(max_depth=9, n_estimators=70, random_state=42)\n\nmodel.fit(X_train, y_train)\n\nprint(model.score(X_valid, y_valid))\n\npred = model.predict(X_test)","20daadb8":"pd.DataFrame({\"PassengerId\": X_test.index + 1, \"Survived\": pred}).to_csv(\"555.csv\", index=False)","2a3458bf":"# \uc800\uc7a5 \ud655\uc778\nfinal_df = pd.read_csv(\".\/555.csv\")\n\nfinal_df.head()","f00441b5":"final_df.isnull().sum()","54b228d8":"model.score(X_test, y_test['Survived'])","8bb1b89e":"## \ubaa8\ub378 \ubc0f \ud3c9\uac00","221ad4dd":"## Start","5cc354ef":"## \uc0dd\uc874\uc5ec\ubd80 \uc608\uce21\ubaa8\ub378 \ub9cc\ub4e4\uae30\n### \ud559\uc2b5\uc6a9 \ub370\uc774\ud130 (X_train, y_train)\uc744 \uc774\uc6a9\ud558\uc5ec \uc0dd\uc874 \uc608\uce21 \ubaa8\ud615\uc744 \ub9cc\ub4e0 \ud6c4, \uc774\ub97c \ud3c9\uac00\uc6a9 \ub370\uc774\ud130(X_test)\uc5d0 \uc801\uc6a9\ud558\uc5ec \uc5bb\uc740 \uc608\uce21\uac12\uc744 \ub2e4\uc74c\uacfc \uac19\uc740 \ud615\uc2dd\uc758 CSV\ud30c\uc77c\ub85c \uc0dd\uc131\ud558\uc2dc\uc624(\uc81c\ucd9c\ud55c \ubaa8\ub378\uc758 \uc131\ub2a5\uc740 accuracy \ud3c9\uac00\uc9c0\ud45c\uc5d0 \ub530\ub77c \ucc44\uc810)\n\n(\uac00) \uc81c\uacf5 \ub370\uc774\ud130 \ubaa9\ub85d\n- y_train: \uc0dd\uc874\uc5ec\ubd80(\ud559\uc2b5\uc6a9)\n- X_trian, X_test : \uc2b9\uac1d \uc815\ubcf4 (\ud559\uc2b5\uc6a9 \ubc0f \ud3c9\uac00\uc6a9)\n\n(\ub098) \ub370\uc774\ud130 \ud615\uc2dd \ubc0f \ub0b4\uc6a9\n- y_trian (712\uba85 \ub370\uc774\ud130)\n\n**\uc2dc\ud5d8\ud658\uacbd \uc138\ud305\uc740 \uc608\uc2dc\ubb38\uc81c\uc640 \ub3d9\uc77c\ud55c \ud615\ud0dc\uc758 X_train, y_train, X_test \ub370\uc774\ud130\ub97c \ub9cc\ub4e4\uae30 \uc704\ud568\uc784**\n\n### \uc720\uc758\uc0ac\ud56d\n- \uc131\ub2a5\uc774 \uc6b0\uc218\ud55c \uc608\uce21\ubaa8\ud615\uc744 \uad6c\ucd95\ud558\uae30 \uc704\ud574\uc11c\ub294 \uc801\uc808\ud55c \ub370\uc774\ud130 \uc804\ucc98\ub9ac, \ud53c\ucc98\uc5d4\uc9c0\ub2c8\uc5b4\ub9c1, \ubd84\ub958\uc54c\uace0\ub9ac\uc998, \ud558\uc774\ud37c\ud30c\ub77c\ubbf8\ud130 \ud29c\ub2dd, \ubaa8\ud615 \uc559\uc0c1\ube14 \ub4f1\uc774 \uc218\ubc18\ub418\uc5b4\uc57c \ud55c\ub2e4.\n- \uc218\ud5d8\ubc88\ud638.csv\ud30c\uc77c\uc774 \ub9cc\ub4e4\uc5b4\uc9c0\ub3c4\ub85d \ucf54\ub4dc\ub97c \uc81c\ucd9c\ud55c\ub2e4.\n- \uc81c\ucd9c\ud55c \ubaa8\ub378\uc758 \uc131\ub2a5\uc740 accuracy\ub85c \ud3c9\uac00\ud568\n\ncsv \ucd9c\ub825\ud615\ud0dc\n\n![image.png](attachment:de1920de-121e-47c3-a61f-e905386713bf.png)","be65b936":"## \ub77c\uc774\ube0c\ub7ec\ub9ac \ubc0f \ub370\uc774\ud130 \ubd88\ub7ec\uc624\uae30","3dd10c70":"## \ub370\uc774\ud130 \uc804\ucc98\ub9ac","b528bad2":"## EDA","bd0a2e58":"## \uacb0\uacfc \uccb4\uc810 (\uc218\ud5d8\uc790\ub294 \uc54c \uc218 \uc5c6\ub294 \ubd80\ubd84\uc784)","007af789":"## [\ucc38\uace0]\uc791\uc5c5\ud6152 \ubb38\uad6c\n- \ucd9c\ub825\uc744 \uc6d0\ud558\uc2e4 \uacbd\uc6b0 print() \ud568\uc218 \ud65c\uc6a9\n- \uc608\uc2dc) print(df.head())\n- getcwd(), chdir() \ub4f1 \uc791\uc5c5 \ud3f4\ub354 \uc124\uc815 \ubd88\ud544\uc694\n- \ud30c\uc77c \uacbd\ub85c \uc0c1 \ub0b4\ubd80 \ub4dc\ub77c\uc774\ube0c \uacbd\ub85c(C: \ub4f1) \uc811\uadfc \ubd88\uac00\n\n### \ub370\uc774\ud130 \ud30c\uc77c \uc77d\uae30 \uc608\uc81c\n- import pandas as pd\n- X_test = pd.read_csv(\"data\/X_test.csv\")\n- X_train = pd.read_csv(\"data\/X_train.csv\")\n- y_train = pd.read_csv(\"data\/y_train.csv\")\n\n### \uc0ac\uc6a9\uc790 \ucf54\ub529\n\n### \ub2f5\uc548 \uc81c\ucd9c \ucc38\uace0\n- \uc544\ub798 \ucf54\ub4dc \uc608\uce21\ubcc0\uc218\uc640 \uc218\ud5d8\ubc88\ud638\ub97c \uac1c\uc778\ubcc4\ub85c \ubcc0\uacbd\ud558\uc5ec \ud65c\uc6a9\n- pd.DataFrame({'cust_id': X_test.cust_id, 'gender': pred}).to_csv('003000000.csv', index=False)"}}