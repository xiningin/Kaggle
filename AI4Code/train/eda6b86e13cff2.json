{"cell_type":{"101682d7":"code","df9389e7":"code","5b6e606b":"code","47a0516e":"code","5ce9fe7e":"code","d8319d7d":"code","c6ba950a":"code","7476c561":"code","61310655":"code","a4c66c3c":"code","d4fc019a":"code","2845e747":"code","2181992c":"markdown","278bbcb3":"markdown","6fda5c03":"markdown","762e910d":"markdown"},"source":{"101682d7":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n","df9389e7":"df = pd.read_csv(\"\/kaggle\/input\/covid19-tweets\/covid19_tweets.csv\")\ndata = pd.DataFrame(df[[\"user_name\", \"user_location\", \"date\", \"text\"]])\ndata.head()","5b6e606b":"#Non Ascii data will at the user_location column will be deleted to make it easier\n#All nan values will be replaced by unknown\n\n#def datacleaning(data):\ndata.fillna(\"unknown\", inplace = True)\ndata[data[\"user_location\"].str.contains(r'[^\\x00-\\x7F]+')]\ndata.info()\n","47a0516e":"import nltk\nfrom nltk.sentiment.vader import SentimentIntensityAnalyzer","5ce9fe7e":"#Sentiment value only store able as string? TODO -> Solution, need an INT value\n#def Sentimentanalysis(data)\nsid = SentimentIntensityAnalyzer()\n\ndata[\"sentiment\"] = \"\"\n\nfor index, row in data.iterrows():\n        data.at[index, \"sentiment\"] = sid.polarity_scores(str(row[\"text\"]))[\"compound\"]","d8319d7d":"\ndata[\"user_region\"] = \"\"\ncountries = pd.read_csv(\"..\/input\/countries-of-the-world\/countries of the world.csv\")\ncountries = countries[[\"Country\", \"Region\"]]\n\ncities = pd.read_csv(\"..\/input\/world-cities\/world-cities.csv\")\ncities = cities[[\"name\", \"country\"]]\n\ncities[\"country\"] = cities[\"country\"].str.rstrip()\ncountries[\"Country\"] = countries[\"Country\"].str.strip()\ndata[\"user_location\"] = data[\"user_location\"].str.strip()\n\nlocation = cities.join(countries.set_index(\"Country\"), on = \"country\")\nlocation.head()","c6ba950a":"#Mapping of the region on the data dataframe to do region based evaluations \n#Created with the friendly help of ShivamSingla(@ssingla)\n#Processing time ~ 1 hour for (data(rows 179108) & location(rows ~ 23019))\n\nfrom tqdm.notebook import tqdm_notebook\n\ndef regionfinder(a):\n    for item in location.itertuples():\n        if item[1] in a:\n            return item[3]\n        elif item[2] in a:\n            return item[3]\n    return \"unknown\"   \n\ntqdm_notebook.pandas()\ndata[\"region\"] = data[\"user_location\"].progress_apply(regionfinder)\n\ndata.head()\n","7476c561":"#Saving the data as csv to make it easier to work with the evaluations\ndata.to_csv(\"Aufbereitete Daten\")\n","61310655":"import matplotlib as mlp\nimport matplotlib.pyplot as plt","a4c66c3c":"df2 = pd.read_csv(\"..\/input\/aufbereitete-daten\/Aufbereitete Daten\")","d4fc019a":"#Evaluation of the mean sentiment per region\n\nsentimentperregion= df2[[\"sentiment\", \"region\"]].groupby(\"region\").mean()\nsentimentperregion[[\"sentiment\"]].plot(kind = \"bar\", grid = True)","2845e747":"#Evaluation of the mean sentiment change over time world wide\ndef Print(a):\n    print(a)\n\nsentimentovertime = df2[[\"date\", \"sentiment\"]]\nsentimentovertime[\"month\"] = sentimentovertime[\"date\"].apply(lambda x: str(x)[5:7])\nsentimentovertime = sentimentovertime.drop([\"date\"], axis = 1)\nsentimentovertime = sentimentovertime.groupby(\"month\").mean()\n\nsentimentovertime = sentimentovertime.dropna()\nsentimentovertime[[\"sentiment\"]].plot(figsize= (5, 10), kind = \"line\" ,grid = True)\n","2181992c":"I\u00b4ve decided to write the evaluation as an extra part because the region mapping on the data dataframe takes about 1 hour","278bbcb3":"**Data modification**","6fda5c03":"In this Notebook you will find a sentiment analysis for the covid19-tweets data package with vader.\nIt is my first \"bigger\" project, so if you've feedback or suggestions, feel free to reach out to me.\n\nUsed data: \n* https:\/\/www.kaggle.com\/gpreda\/covid19-tweets \n* https:\/\/www.kaggle.com\/fernandol\/countries-of-the-world \n* https:\/\/www.kaggle.com\/okfn\/world-cities","762e910d":"**Evaluation**"}}