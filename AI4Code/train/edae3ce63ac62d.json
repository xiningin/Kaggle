{"cell_type":{"106cc009":"code","41844168":"code","c21210dc":"code","bcc9d844":"code","696f3daa":"code","d09d27cd":"code","e9003ee6":"code","33ca601b":"code","aa58e0d7":"code","1737febe":"code","eaaa4e56":"code","88512418":"code","4d63fc0a":"code","1c105fbe":"code","ebb27e84":"code","ae1d69c8":"code","10ea38f8":"code","23f81c22":"code","15854279":"code","6d064491":"code","edbc91d7":"code","9b8e2109":"code","d75de93f":"code","2323e76f":"code","748c21a5":"code","07609240":"code","48e0428a":"code","42b737ab":"code","55c92400":"code","76bd85c4":"code","83f54bde":"code","39a79db2":"code","6c3396c9":"code","17be61d1":"code","836ceb41":"code","788e14b8":"code","68c817be":"code","87f2adec":"code","993a6180":"code","6ac2ef8d":"code","569a86f7":"code","a4038aa3":"code","077eb5db":"code","47cc3401":"code","3a83ebbd":"code","8a65706c":"code","11038215":"code","3df4062d":"markdown","9bfa84f9":"markdown","25218c41":"markdown","ebbeade2":"markdown","8fcda72d":"markdown","91f83ed6":"markdown","37e805b9":"markdown","b71688bc":"markdown","e365d35d":"markdown"},"source":{"106cc009":"import pandas as pd\nimport numpy as np\nimport seaborn as sb\nimport matplotlib.pyplot as plt\nimport sklearn.metrics\nimport warnings\nwarnings.filterwarnings('ignore')","41844168":"data= pd.read_csv('..\/input\/pima-indians-diabetes-database\/diabetes.csv')","c21210dc":"data","bcc9d844":"data.describe()","696f3daa":"col = data.columns[:- 1]\ncol","d09d27cd":"data.info()","e9003ee6":"data[['Glucose','BloodPressure','SkinThickness','Insulin','BMI']] = data[['Glucose','BloodPressure','SkinThickness','Insulin','BMI']].replace(0,np.NaN)\n","33ca601b":"data.describe()","aa58e0d7":"p = data.hist(figsize = (20,20))","1737febe":"data['Glucose'].fillna(data['Glucose'].mean(), inplace = True)\ndata['BloodPressure'].fillna(data['BloodPressure'].mean(), inplace = True)\ndata['SkinThickness'].fillna(data['SkinThickness'].median(), inplace = True)\ndata['Insulin'].fillna(data['Insulin'].median(), inplace = True)\ndata['BMI'].fillna(data['BMI'].median(), inplace = True)","eaaa4e56":"p = data.hist(figsize=(10,10))","88512418":"sb.heatmap(data.isnull())","4d63fc0a":"col = data.columns[:-1]","1c105fbe":"col","ebb27e84":"plt.figure(figsize=(20,18))\nfor i in range(len(col)):\n    plt.subplot(4,2,i+1)\n    data[col[i]].plot(kind='box')\n    \n    \n    ","ae1d69c8":"#CHECKING DIstribution of columns","10ea38f8":"plt.figure(figsize=(20,18))\nfor i in range(len(col)):\n    plt.subplot(4,2,i+1)\n    data[col[i]].plot(kind='hist')\n    \n    \n    ","23f81c22":"\nQ1 = data.quantile(.25)\nQ3 = data.quantile(.75)\nIQR = Q3 - Q1\ncount = ( ( data.iloc[:] > ( Q3 + 1.5*IQR )) | ( data.iloc[:] <  (Q1 - 1.5*IQR)) ).sum(axis=0)","15854279":"count","6d064491":"data = data[~( ( data.iloc[:] < (Q1 - 1.5*IQR ) ) |( data.iloc[:] > (Q3 + 1.5*IQR ) )).any(axis=1)]\ncount = ( ( data.iloc[:] > ( Q3 + 1.5*IQR )) | ( data.iloc[:] <  (Q1 - 1.5*IQR)) ).sum(axis=0)\ncount","edbc91d7":"from sklearn.preprocessing import StandardScaler\nscale = StandardScaler()","9b8e2109":"scale.fit(data.drop('Outcome',axis=1))","d75de93f":"features = scale.fit_transform(data.drop('Outcome',axis=1))\n","2323e76f":"new_data = pd.DataFrame(features,columns=col)\nnew_data","748c21a5":"sb.heatmap(data.corr(),annot=True)","07609240":"cor = new_data.corr()","48e0428a":"cor","42b737ab":"sb.scatterplot('SkinThickness','BMI',data=data,hue='Outcome')","55c92400":"sb.pairplot(data)","76bd85c4":"plt.figure(figsize=(20,18))\nfor i in range(len(col)):\n    plt.subplot(4,2,i+1)\n    new_data[col[i]].plot(kind='hist')\n    ","83f54bde":"from sklearn.model_selection import train_test_split ","39a79db2":"x_train,x_test,y_train,y_test = train_test_split(new_data,data['Outcome'],test_size=.28,random_state = 45)","6c3396c9":"from sklearn.neighbors import KNeighborsClassifier","17be61d1":"knn =KNeighborsClassifier(n_neighbors=1)","836ceb41":"knn.fit(x_train,y_train)","788e14b8":"error = []\nfor i in range(1,40):\n    knn_test = KNeighborsClassifier(n_neighbors=i)\n    knn_test.fit(x_train,y_train)\n    pred_i = knn_test.predict(x_test)\n    error.append(np.mean(pred_i != y_test))","68c817be":"plt.figure(figsize=(15,10))\nplt.title('ErrorRate VS K-Value')\nplt.plot(range(1,40),error,marker='*',linestyle='dashed')\n","87f2adec":"from sklearn.metrics import accuracy_score,classification_report,confusion_matrix\nknn_final = KNeighborsClassifier(n_neighbors=13)\nknn_final.fit(x_train,y_train)\npred = knn_final.predict(x_test)\naccuracy_score(y_test,pred)","993a6180":"from sklearn.linear_model import RidgeClassifier,ElasticNet,LogisticRegression","6ac2ef8d":"from sklearn.svm import SVC","569a86f7":"svc = SVC(kernel='linear',C=1)","a4038aa3":"svc.fit(x_train,y_train)\npred_l = svc.predict(x_test)\naccuracy_score(y_test,pred_l)","077eb5db":"from sklearn.metrics import roc_curve","47cc3401":"y_pred_proba = knn_final.predict_proba(x_test)[:,1]\nfpr, tpr, thresholds = roc_curve(y_test, y_pred_proba)","3a83ebbd":"plt.plot([0,1],[0,1],'k--')\nplt.plot(fpr,tpr, label='Knn')\nplt.xlabel('1-specificity')\nplt.ylabel('sensitivity')\nplt.title('Knn(n_neighbors=11) ROC curve')\nplt.show()","8a65706c":"from sklearn.metrics import roc_auc_score\nroc_auc_score(y_test,y_pred_proba)","11038215":"from sklearn.model_selection import GridSearchCV\n#In case of classifier like knn the parameter to be tuned is n_neighbors\nparam_grid = {'n_neighbors':np.arange(1,50)}\nknn = KNeighborsClassifier()\nknn_cv= GridSearchCV(knn,param_grid,cv=5)\nknn_cv.fit(new_data,data['Outcome'])\n\nprint(\"Best Score:\" + str(knn_cv.best_score_))\nprint(\"Best Parameters: \" + str(knn_cv.best_params_))","3df4062d":"IMPORTING IMPORTS","9bfa84f9":"# Hyper Parameter optimization\nGrid search is an approach to hyperparameter tuning that will methodically build and evaluate a model for each combination of algorithm parameters specified in a grid.","25218c41":"OUTLIER TREATMENT, but as no of outliers are high in number, Removing outliers not an option,instead scaling data","ebbeade2":"Checking Performance with Other MOdels","8fcda72d":"# DIABETES DIAGNOSIS\nDATA:\n - Pregnancies\n - Glucose\n - BloodPressure\n - Skin THickness\n - INsulin\n - BMI\n - DiabetesPedigreeFunction\n - AGe\n - Outcome","91f83ed6":"# EDA","37e805b9":"checking outliers","b71688bc":"As we know 0's in columns are same as nan but can interfere with code performance,\nReplace all the 0's with Nan ","e365d35d":"Fillings Nan values with Mean, Meadian as per the skewness and presence of outliers,\nin CASE OF OUTLIERS, WE USE mEDIANS,FOR CATEGROICAL WE USE mode AND WITHOUT OUTLIER CONTINOUS VLAUES WE USE mean"}}