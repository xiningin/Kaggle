{"cell_type":{"0feb65f3":"code","3be83601":"code","54695872":"code","931f7f5e":"code","c21ea8df":"code","2fb988fd":"code","4062aad4":"code","bf23eeec":"code","5d4cf598":"code","43371f44":"code","68346808":"code","3e18c8e7":"code","ff4b4ff8":"code","a9d69521":"code","2d1aa921":"code","819f0e81":"code","274dc07c":"code","2b46012d":"code","5eb9bf86":"code","c4bff1b5":"code","6dacc4dd":"code","80596812":"code","eb362e49":"code","39d2d50c":"code","e2b36c21":"code","fc5e5bbe":"code","a89c3156":"code","f3718939":"code","48763a5d":"code","b725c4e7":"markdown","2d9d9b09":"markdown","1f65e71b":"markdown","dd5f5930":"markdown","9f03016c":"markdown","dad7c8af":"markdown","4f9802c7":"markdown","ca3c660d":"markdown","35a0abbd":"markdown","d2afe9c4":"markdown","57135393":"markdown","b9edec09":"markdown","a77a77a9":"markdown","28e0d122":"markdown"},"source":{"0feb65f3":"import numpy as np \nimport pandas as pd \nimport os\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set(style=\"whitegrid\")\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","3be83601":"data = pd.read_csv('..\/input\/thoraric-surgery\/ThoraricSurgery.csv', index_col = 'id')","54695872":"data.head(2)","931f7f5e":"data.info()","c21ea8df":"data[['PRE7', 'PRE8', 'PRE9', 'PRE10', 'PRE11', 'PRE17', 'PRE19', 'PRE25', 'PRE30', 'PRE32', 'Risk1Yr']] = \\\n(data[['PRE7', 'PRE8', 'PRE9', 'PRE10', 'PRE11', 'PRE17', 'PRE19', 'PRE25', 'PRE30', 'PRE32', 'Risk1Yr']] == 'T').astype(int)","2fb988fd":"data.head(2)","4062aad4":"data['DGN']   = data['DGN'].str[-1:].astype(int)\ndata['PRE6']  = data['PRE6'].str[-1:].astype(int)\ndata['PRE14'] = data['PRE14'].str[-1:].astype(int)","bf23eeec":"data.describe(include='all')","5d4cf598":"col = ['Diagnosis','Forced_Capacity','Forced_Expiration','Zubrod_scale','Pain',' Haemoptysis','Dyspnoea',\n       'Cough','Weakness','Size_of_tumor','diabetes','MI_6months','PAD','Smoker','Asthmatic','Age','Risk_1y']\ndata.columns = col","43371f44":"data.head()","68346808":"sns.pairplot(data[['Forced_Expiration','Smoker', 'Age', 'Risk_1y']], \n             hue='Risk_1y', diag_kws={'bw':1.5}, markers=['o', 'D'], height=2.5)","3e18c8e7":"fig, ax = plt.subplots(figsize=(12, 12))\nmask=np.zeros_like(data.corr())\nmask[np.triu_indices_from(mask)] = True\nsns.heatmap(data.corr(), annot=True, linewidths=.1, cmap=\"YlGnBu\", square=True, mask=mask, cbar=False)","ff4b4ff8":"fig, ax = plt.subplots(figsize = (12,6))\nsns.scatterplot(x='Diagnosis', y='Size_of_tumor', #hue='Risk_1y', \n                size='dgn_cnt', sizes=(20, 250),\n                data=data.groupby(['Diagnosis','Size_of_tumor']).size().reset_index().rename(columns={0:'dgn_cnt'}))","a9d69521":"fig, ax = plt.subplots(figsize = (10,6))\nsns.barplot(x='Diagnosis', y='Risk_1y', \n            data = data, palette=\"Blues_d\",\n            ax=ax, ci=None)","2d1aa921":"# \u043d\u043e \u0438 \u043d\u0430\u0431\u043b\u044e\u0434\u0435\u043d\u0438\u0439 \u0442\u0430\u043a\u0438\u0445 \u0441\u043e\u0432\u0441\u0435\u043c \u043c\u0430\u043b\u043e..\ndata[data.Diagnosis.isin([1, 6])]","819f0e81":"fig, ax = plt.subplots(figsize = (10,6))\nsns.distplot(data.Diagnosis, kde=False)","274dc07c":"data1 = data.copy()\ndata1['Diagnosis'] = np.where(data['Diagnosis'].isin([1,5,6,7,8]), 0, data['Diagnosis'])\ndata1.head()","2b46012d":"fig, ax = plt.subplots(figsize = (10,6))\nsns.distplot(data1.Diagnosis, kde=False)","5eb9bf86":"from sklearn.linear_model import Ridge, LinearRegression, LogisticRegression\nfrom sklearn import metrics\nfrom sklearn.metrics import r2_score\nfrom sklearn.model_selection import learning_curve, GridSearchCV, train_test_split\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.preprocessing import StandardScaler, PolynomialFeatures\nfrom sklearn.neighbors import KNeighborsClassifier","c4bff1b5":"X = data1.drop(columns='Diagnosis')\ny = data1.Diagnosis","6dacc4dd":"clf = LogisticRegression(class_weight = 'balanced')\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, stratify=y)\nclf.fit(X_train, y_train)\npredictions = clf.predict(X_test)","80596812":"print(metrics.classification_report(y_test, predictions))","eb362e49":"from imblearn.over_sampling import SMOTE, ADASYN","39d2d50c":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, stratify=y)","e2b36c21":"augm = ADASYN()\nX_train_augm, y_train_augm = augm.fit_resample(np.array(X_train), np.array(y_train))","fc5e5bbe":"pd.Series(y_train).value_counts()","a89c3156":"pd.Series(y_train_augm).value_counts()","f3718939":"clf = LogisticRegression()\nclf.fit(X_train_augm, y_train_augm)\npredictions = clf.predict(X_test)","48763a5d":"print(metrics.classification_report(y_test, predictions))","b725c4e7":"\u0442.\u043a. \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445 \u044f\u0447\u0435\u0439\u043a\u0430\u0445 \u0443\u0436\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442 \u0432 \u0441\u0435\u0431\u0435 \u0446\u0438\u0444\u0440\u043e\u0432\u043e\u0439 \u043a\u043e\u0434, \u043c\u043e\u0436\u043d\u043e \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u0442\u044c \u0438\u0445 \u0432 \u0447\u0438\u0441\u043b\u0430 \u0442\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c:","2d9d9b09":"\u043d\u0435\u043c\u043d\u043e\u0433\u043e \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u043c \u043d\u0430 \u0434\u0430\u043d\u043d\u044b\u0435","1f65e71b":"\u0442\u0430\u043c \u0433\u0434\u0435 \u0431\u044b\u043b\u043e \u0431\u043e\u043b\u044c\u0448\u0435 \u043d\u0430\u0431\u043b\u044e\u0434\u0435\u043d\u0438\u0439 - \u0445\u043e\u0442\u044c \u043a\u0430\u043a\u0430\u044f-\u0442\u043e \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c \u0432\u044b\u0448\u043b\u0430, \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u043a\u043b\u0430\u0441\u0441\u044b - \u043f\u043e \u043d\u0443\u043b\u044f\u043c","dd5f5930":"Attribute Information:\n\n1. DGN: Diagnosis - specific combination of ICD-10 codes for primary and secondary as well multiple tumours if any (DGN3,DGN2,DGN4,DGN6,DGN5,DGN8,DGN1)\n2. PRE4: Forced vital capacity - FVC (numeric)\n3. PRE5: Volume that has been exhaled at the end of the first second of forced expiration - FEV1 (numeric)\n4. PRE6: Performance status - Zubrod scale (PRZ2,PRZ1,PRZ0)\n5. PRE7: Pain before surgery (T,F)\n6. PRE8: Haemoptysis before surgery (T,F)\n7. PRE9: Dyspnoea before surgery (T,F)\n8. PRE10: Cough before surgery (T,F)\n9. PRE11: Weakness before surgery (T,F)\n10. PRE14: T in clinical TNM - size of the original tumour, from OC11 (smallest) to OC14 (largest) (OC11,OC14,OC12,OC13)\n11. PRE17: Type 2 DM - diabetes mellitus (T,F)\n12. PRE19: MI up to 6 months (T,F)\n13. PRE25: PAD - peripheral arterial diseases (T,F)\n14. PRE30: Smoking (T,F)\n15. PRE32: Asthma (T,F)\n16. AGE: Age at surgery (numeric)\n17. Risk1Y: 1 year survival period - (T)rue value if died (T,F)","9f03016c":"\u041f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0431\u0443\u0434\u0435\u043c \u0414\u0438\u0430\u0433\u043d\u043e\u0437, \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u043c \u043d\u0430 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435","dad7c8af":"\u0447\u0443\u0442\u044c \u043f\u043e\u0434\u0442\u044f\u043d\u0443\u043b\u0441\u044f 2\u0439 \u043a\u043b\u0430\u0441\u0441 - \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0438\u0437\u043d\u0430\u0447\u0430\u043b\u044c\u043d\u043e \u0431\u044b\u043b \u043d\u0430 2\u043c \u043c\u0435\u0441\u0442\u0435 \u043f\u043e \u043a\u043e\u043b-\u0432\u0443 \u043d\u0430\u0431\u043b\u044e\u0434\u0435\u043d\u0438\u0439.\n\n\u0412\u0435\u0440\u043e\u044f\u0442\u043d\u043e \u0432 \u0442\u0430\u043a\u043e\u0439 \u0441\u0438\u0442\u0443\u0430\u0446\u0438\u0438 \u043e\u0441\u0442\u0430\u0435\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430\u043a\u0430\u043f\u043b\u0438\u0432\u0430\u0442\u044c \u043d\u0430\u0431\u043b\u044e\u0434\u0435\u043d\u0438\u044f \u0434\u043e \u043f\u043e\u0432\u044b\u0448\u0435\u043d\u0438\u044f \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u0438, \u0430 \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c \u043d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u043f\u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u043d\u0430 (\u043a\u0430\u043a \u043f\u0440\u0438\u043c\u0435\u0440) \u0432\u044b\u0441\u043e\u043a\u0438\u0439 recall \u043f\u043e \u043e\u0434\u043d\u043e\u043c\u0443 \u0438\u0437 \u043a\u043b\u0430\u0441\u0441\u043e\u0432, \u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u043f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043a\u0440\u0438\u0442\u0438\u0447\u043d\u044b\u0439 \u0434\u0438\u0430\u0433\u043d\u043e\u0437","4f9802c7":"\u041f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u0435\u043c T \/ F \u044f\u0447\u0435\u0439\u043a\u0438 \u0432 1 \/ 0","ca3c660d":"\u0442.\u0435. \u043d\u0435\u0442 \u0441\u043c\u0435\u0440\u0442\u0435\u0439 \u0434\u043b\u044f DGN6, DGN1","35a0abbd":"\u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0430 [\u0442\u0443\u0442](https:\/\/archive.ics.uci.edu\/ml\/datasets\/Thoracic+Surgery+Data)","d2afe9c4":"\u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e \u0447\u0430\u0441\u0442\u0438 \u0434\u0438\u0430\u0433\u043d\u043e\u0437\u043e\u0432 \u043e\u0447\u0435\u043d\u044c \u043e\u0447\u0435\u043d\u044c \u043c\u0430\u043b\u043e   \n\u041e\u0431\u044a\u0435\u0434\u0438\u043d\u0438\u043c \u0434\u0438\u0430\u0433\u043d\u043e\u0437\u044b 1,5,6,7,8 \u0432 \u043e\u0434\u0438\u043d - \u0432\u0441\u0451 \u0440\u0430\u0432\u043d\u043e \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c \u043f\u043e \u043d\u0438\u043c \u0431\u0443\u0434\u0435\u0442 \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f","57135393":"\u043f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u0443\u0435\u043c \u0434\u043b\u044f \u043f\u043e\u043d\u044f\u0442\u043d\u043e\u0441\u0442\u0438","b9edec09":"\u0435\u0441\u0442\u044c \u043f\u0430\u0440\u0430 \u044f\u0440\u043a\u043e\u0432\u044b\u0440\u0430\u0436\u0435\u043d\u043d\u044b\u0445 \u0441\u0432\u044f\u0437\u0435\u0439","a77a77a9":"\u043e\u0447\u0435\u043d\u044c \u043c\u0430\u043b\u0435\u043d\u044c\u043a\u0438\u0439 \u0434\u0430\u0442\u0430\u0441\u0435\u0442.","28e0d122":"\u043f\u0443\u0441\u0442\u044c \u0431\u0430\u0437\u043e\u0432\u043e\u0435 \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u0438\u0435 \u0431\u0443\u0434\u0435\u0442 \u0431\u0435\u0437 \u0430\u0443\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438 - \u043e\u0431\u044b\u0447\u043d\u0430\u044f \u043b\u043e\u0433\u0438\u0441\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0440\u0435\u0433\u0440\u0435\u0441\u0441\u0438\u044f"}}