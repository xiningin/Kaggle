{"cell_type":{"647f99d9":"code","61cc3562":"code","04583e67":"code","aacaca77":"code","e11a50bf":"code","febab849":"code","5b08f01f":"code","3b22defb":"code","8f861410":"code","75490f63":"code","c62c8ead":"code","7de6cefa":"code","d46ac0af":"code","9a2aac8d":"code","ad216054":"code","02b8abe0":"code","24a5bbd3":"code","c2f5f5c3":"code","f1343d97":"code","6668693b":"code","3369cead":"code","fa31a192":"code","1b3364fa":"code","eab1e99c":"markdown","b15a447b":"markdown","a0e32cc5":"markdown","095ae29c":"markdown"},"source":{"647f99d9":"# import Libraries\nimport pandas as pd\nimport numpy as np\nimport matplotlib as pyplot\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","61cc3562":"# to see all the comands result in a single kernal \n%load_ext autoreload\n%autoreload 2\nfrom IPython.core.interactiveshell import InteractiveShell\nInteractiveShell.ast_node_interactivity = \"all\"","04583e67":"# to increase no. of rows and column visibility in outputs\npd.set_option('display.max_rows', 500)\npd.set_option('display.max_columns', 500)\npd.set_option('display.width', 1000)","aacaca77":"#Upload data\ntrain = pd.read_csv(r'..\/input\/janatahack-crosssell-prediction\/train.csv')\ntest = pd.read_csv(r'..\/input\/janatahack-crosssell-prediction\/test.csv')\nsample_submmission = pd.read_csv(r'..\/input\/janatahack-crosssell-prediction\/sample_submission.csv')\ntrain.shape\ntest.shape\nsample_submmission.shape","e11a50bf":"train.head()","febab849":"train.isna().sum().sum()\ntest.isna().sum().sum()","5b08f01f":"train['Response'].value_counts()\/len(train)\ntrain['Gender'].value_counts()\ntrain['Vehicle_Age'].value_counts()\ntrain['Vehicle_Damage'].value_counts()","3b22defb":"#converting onject to int type\ntrain['Vehicle_Age']=train['Vehicle_Age'].replace({'< 1 Year':0,'1-2 Year':1,'> 2 Years':2})\ntrain['Gender']=train['Gender'].replace({'Male':1,'Female':0})\ntrain['Vehicle_Damage']=train['Vehicle_Damage'].replace({'Yes':1,'No':0})\ntest['Vehicle_Age']=test['Vehicle_Age'].replace({'< 1 Year':0,'1-2 Year':1,'> 2 Years':2})\ntest['Gender']=test['Gender'].replace({'Male':1,'Female':0})\ntest['Vehicle_Damage']=test['Vehicle_Damage'].replace({'Yes':1,'No':0})","8f861410":"train.columns","75490f63":"col_1=['Gender', 'Age', 'Driving_License', 'Region_Code', 'Previously_Insured', 'Vehicle_Age', 'Vehicle_Damage', 'Annual_Premium', 'Policy_Sales_Channel', 'Vintage']","c62c8ead":"# categorical column \ncat_col=['Gender','Driving_License', 'Region_Code', 'Previously_Insured', 'Vehicle_Age', 'Vehicle_Damage','Policy_Sales_Channel']","7de6cefa":"train.info()","d46ac0af":"# changing data type because cat_feature in catboost cannot be float\ntrain['Region_Code']=train['Region_Code'].astype(int)\ntest['Region_Code']=test['Region_Code'].astype(int)\ntrain['Policy_Sales_Channel']=train['Policy_Sales_Channel'].astype(int)\ntest['Policy_Sales_Channel']=test['Policy_Sales_Channel'].astype(int)","9a2aac8d":"X=train[col_1]\ny=train['Response']","ad216054":"len(test)\/(len(test)+len(train))","02b8abe0":"from sklearn.metrics import roc_auc_score\nfrom sklearn.model_selection import train_test_split\nX_t, X_tt, y_t, y_tt = train_test_split(X, y, test_size=.25, random_state=150303,stratify=y,shuffle=True)","24a5bbd3":"from catboost import CatBoostClassifier\nfrom sklearn.metrics import accuracy_score\ncatb = CatBoostClassifier()\ncatb= catb.fit(X_t, y_t,cat_features=cat_col,eval_set=(X_tt, y_tt),plot=True,early_stopping_rounds=30,verbose=100)\ny_cat = catb.predict(X_tt)\nprobs_cat_train = catb.predict_proba(X_t)[:, 1]\nprobs_cat_test = catb.predict_proba(X_tt)[:, 1]\nroc_auc_score(y_t, probs_cat_train)\nroc_auc_score(y_tt, probs_cat_test)","c2f5f5c3":"# from lightgbm import LGBMClassifier\n# lgbcl = LGBMClassifier(n_estimators=52)\n# lgbcl= lgbcl.fit(X_t, y_t,eval_metric='auc',eval_set=(X_tt , y_tt),verbose=2,categorical_feature=cat_col)\n# y_lgb = lgbcl.predict(X_tt)\n# probs_tr = lgbcl.predict_proba(X_t)[:, 1]\n# probs_te = lgbcl.predict_proba(X_tt)[:, 1]\n# roc_auc_score(y_t, probs_tr)\n# roc_auc_score(y_tt, probs_te)","f1343d97":"# 85.66 on Public leaderboard\n# 85.84  on pulic leaderboard C","6668693b":"feat_importances = pd.Series(catb.feature_importances_, index=X_t.columns)\nfeat_importances.nlargest(15).plot(kind='barh')\n#feat_importances.nsmallest(20).plot(kind='barh')\nplt.show()","3369cead":"cat_pred= catb.predict_proba(test[col_1])[:, 1]\nsample_submmission['Response']=cat_pred","fa31a192":"sample_submmission.head()","1b3364fa":"sample_submmission.to_csv(\"cat.csv\", index = False)","eab1e99c":"# Model ","b15a447b":"# Basic Visualization","a0e32cc5":"#It is an Analytics vidhya Hackathon\n#To have better idea of probelm statement and to try your own notebook on Kaggle I have also added dataset.\n#DataSet Link- https:\/\/www.kaggle.com\/jassican\/janatahack-crosssell-prediction\n#CompetitionLink -https:\/\/datahack.analyticsvidhya.com\/contest\/janatahack-cross-sell-prediction\/#ProblemStatement","095ae29c":"# Don't Forget to Upvote, if you find this notebook useful. It encourage me to make more such notebooks.\n"}}