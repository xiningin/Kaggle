{"cell_type":{"2a02eb2c":"code","fe160462":"code","792a4595":"code","ae1e7435":"code","56ee6aaa":"code","754c7027":"code","5fe9e157":"code","2ec5e81b":"code","14199ff4":"code","4dcae00b":"code","6abc43a7":"code","014eb743":"code","3529362e":"code","f7f3bf5f":"code","09667476":"markdown","c4199802":"markdown","b99f50f7":"markdown","4712af64":"markdown","9df51d0a":"markdown","e2213eb8":"markdown","bbbcdb32":"markdown","d63f1611":"markdown","513da8c7":"markdown","6dfd3f30":"markdown","73f8391a":"markdown","19e6896d":"markdown","3e4850db":"markdown"},"source":{"2a02eb2c":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","fe160462":"import pandas as pd","792a4595":"data_df = pd.read_csv(\"..\/input\/percentage-of-the-ict-sector-in-gdp-in-europe\/isoc_bde15ag.tsv\", sep='\\t')","ae1e7435":"print(list(data_df.columns))","56ee6aaa":"data_df.head()","754c7027":"data_df.tail()","5fe9e157":"pivot_data_col = data_df.columns[0]\nyear_columns = data_df.columns[1:]","2ec5e81b":"data_df['nace_r2'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[0])\ndata_df['geo']     = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[1])","14199ff4":"selected_columns = list(['nace_r2', 'geo']) +  list(year_columns)\ndata_df = data_df[selected_columns]","4dcae00b":"data_tr_df = data_df.melt(id_vars=['nace_r2', 'geo'], \n        var_name=\"year\", \n        value_name=\"value\")\ndata_tr_df['geo'] = data_tr_df['geo'].apply(lambda x: str(x))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"p\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"e\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"b\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"c\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"d\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"z\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\": \", \"NAN\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: float(x))","6abc43a7":"print(f\"Transformed data shape: {data_tr_df.shape} (rows\/columns)\")\ndata_tr_df.head()","014eb743":"data_tr_df.tail()","3529362e":"import pandas_profiling\npandas_profiling.ProfileReport(data_tr_df)","f7f3bf5f":"data_tr_df.to_csv(\"percentage_of_the_ict_sector_in_gdp.csv\", index=False)","09667476":"# Analysis preparation\n\n## Load packages","c4199802":"Then, we split from `pivot_data_col` the 2 separate fields:\n* nace_r2;\n* geo - geography - mainly countries but also aggregated countries in EU;","b99f50f7":"# Data pre-processing\n\nWe start by defining two working lists.","4712af64":"Let's glimpse the data columns.","9df51d0a":"# Introduction\n\nWe show in this Kernel how we can process the data to prepare it for easier processing. Let's check the data files.","e2213eb8":"We select now only the new columns resulted from splitting the `pivot_data_col` and the time columns.","bbbcdb32":"Next, we pivot the time columns using `melt` operation in pandas.  \nWe also make sure we transform `date` to be an integer (here is a year data).  \nWe set `value` to be a float, after we replace \": \" (for N\/A) with `NAN`.","d63f1611":"The first column is a composed one, containing 5 different information (unit, isced11 education indicator, isced13 education indicator, sex, geography). The next columns are temporal values, the years value.","513da8c7":"## Load the data\n\nThe datafiles are in TSV format. We will read the files using pandas, just include in the function call the `sep` (tab separator data).\nWe demonstrate first how to read and process the Annual data.","6dfd3f30":"Let's inspect the result.","73f8391a":"# A very preliminary exploratory data analysis\n\nThis would be a very short exploratory data analysis. The role of this Kernel is just to show how we can prepare the annual data for analysis and we already did this.","19e6896d":"Let's also take a look to few of the rows.","3e4850db":"# Export data in csv format"}}