{"cell_type":{"10b8a87a":"code","1dc1d9f1":"code","e1f175f1":"code","3ed2410b":"code","984186f3":"code","e0c7bae0":"code","8898c09b":"code","da6e7732":"code","54add291":"code","d27e3535":"code","9e650206":"code","58636e1f":"code","4f9cfa80":"code","caae7bcf":"code","986c6af6":"code","31214df7":"code","1de3828c":"code","4ef71b4b":"code","f24f8a4c":"markdown","b4944f53":"markdown","103ead51":"markdown","214ca28b":"markdown","6d43ae22":"markdown","1ec49633":"markdown","a5c24373":"markdown","cc1d1964":"markdown","bb724338":"markdown","f12ca637":"markdown"},"source":{"10b8a87a":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nimport matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport seaborn as sns","1dc1d9f1":"import bq_helper\nfrom bq_helper import BigQueryHelper\nusa = bq_helper.BigQueryHelper(active_project=\"bigquery-public-data\", dataset_name=\"usa_names\")\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"usa_names\")\nbq_assistant.list_tables()","e1f175f1":"bq_assistant.head(\"usa_1910_2013\", num_rows=3)","3ed2410b":"bq_assistant.table_schema(\"usa_1910_current\")","984186f3":"# create a helper object for this dataset\nusa_names = bq_helper.BigQueryHelper(active_project=\"bigquery-public-data\", dataset_name=\"usa_names\")\n\n# query and export data \nquery = \"\"\"SELECT year, gender, name, sum(number) as number FROM `bigquery-public-data.usa_names.usa_1910_current` GROUP BY year, gender, name ORDER BY year ASC\"\"\"\nagg_names = usa_names.query_to_pandas_safe(query)\nagg_names.to_csv(\"usa_names.csv\")","e0c7bae0":"agg_names.head(5)","8898c09b":"plt.pie(agg_names.groupby(\"gender\")[\"number\"].sum(),labels=[\"Female\",\"Male\"],autopct='%1.0f%%',colors=[\"lightpink\",\"skyblue\"])","da6e7732":"plt.figure(figsize=(20,6))\nax=agg_names[agg_names[\"gender\"]==\"F\"].groupby(\"year\")[\"number\"].sum().plot(label=\"Female\",color=\"lightpink\")\nax=agg_names[agg_names[\"gender\"]==\"M\"].groupby(\"year\")[\"number\"].sum().plot(label=\"Male\",color=\"skyblue\")\nplt.legend()\nax.yaxis.set_major_formatter(mpl.ticker.StrMethodFormatter('{x:,.0f}'))\nplt.title('Total applicants per year')","54add291":"from wordcloud import WordCloud, STOPWORDS\nwordcloud=WordCloud(max_font_size=50,stopwords=STOPWORDS,background_color=\"black\").generate(\" \".join(agg_names[\"name\"].sample(5000).tolist()))\nplt.figure(figsize=(14,7))\nplt.title(\"Wordcloud for top names\",fontsize=35)\nplt.imshow(wordcloud)\nplt.axis('off')\nplt.show()","d27e3535":"top_name_byyear=agg_names.sort_values('number', ascending=False).drop_duplicates(['year',\"gender\"]).sort_values(by=\"year\")\ntop_name_byyear.head()","9e650206":"ax=top_name_byyear[top_name_byyear[\"gender\"]==\"F\"].groupby(by=\"name\")[\"year\"].count().sort_values(ascending=False).plot(kind=\"bar\",label=\"Female name\")\nplt.title(\"Number of years the name was the top female name\")\nax.set_xlabel(\"Top Female names\")\nax.set_ylabel(\"Number of Years\")","58636e1f":"ax=top_name_byyear[top_name_byyear[\"gender\"]==\"M\"].groupby(by=\"name\")[\"year\"].count().sort_values(ascending=False).plot(kind=\"bar\",label=\"Male name\")\nplt.title(\"Number of years the name was the top male name\")\nax.set_xlabel(\"Top Male names\")\nax.set_ylabel(\"Number of Years\")","4f9cfa80":"agg_names[\"decade\"]=agg_names[\"year\"].apply(lambda row: row\/\/10*10)\nnames_decade=pd.pivot_table(agg_names,aggfunc=\"sum\",index=[\"decade\",\"gender\",\"name\"],values=\"number\").reset_index()\ndec=names_decade.groupby([\"decade\",\"gender\"])[\"number\"].sum()\nnames_decade[\"dec_total\"]=names_decade.apply(lambda row: dec[row[\"decade\"]][row[\"gender\"]],axis=1)\nnames_decade[\"perc\"]=np.round(names_decade[\"number\"]\/names_decade[\"dec_total\"],3)","caae7bcf":"three_top=pd.pivot_table(names_decade,values=\"perc\",index=[\"decade\",\"gender\",\"name\"])\nthree_top=three_top.groupby(level=[\"decade\",\"gender\"])[\"perc\"].nlargest(3).reset_index(level=0,drop=True).reset_index(level=0,drop=True).reset_index()","986c6af6":"three_top.head()","31214df7":"fig,axs=plt.subplots(figsize=(20,14),ncols=3,nrows=4,sharey=True)\n\ndecade=three_top[\"decade\"].unique().tolist()\ncounter=0\nfor col in range(4):\n    for row in range(3): \n        if col==3 and row==2:         \n            axs[col][row].axis('off')\n        elif col==0 and row==0:   \n            sns.barplot(x=\"name\", y=\"perc\", hue=\"gender\", data=three_top[three_top[\"decade\"]==decade[counter]],ax=axs[col][row])\n            axs[col][row].set_title(decade[counter]) \n            axs[col][row].set_xlabel(\"\") \n            axs[col][row].set_ylabel(\"\")    \n        else:\n            sns.barplot(x=\"name\", y=\"perc\", hue=\"gender\", data=three_top[three_top[\"decade\"]==decade[counter]],ax=axs[col][row])\n            axs[col][row].set_title(decade[counter]) \n            axs[col][row].set_xlabel(\"\") \n            axs[col][row].set_ylabel(\"\") \n            axs[col][row].get_legend().remove()\n            counter+=1\n            \nfig.suptitle(\"Top three names per decade and percentage of applicants with this name for male and female\",fontsize=25,x=0.5,y=1.1)\nfig.tight_layout()\n","1de3828c":"order_top_average_names=agg_names.groupby(\"name\")[\"number\"].mean().sort_values(ascending=False).head(20).index.tolist()","4ef71b4b":"data2=agg_names[agg_names[\"name\"].isin(order_top_average_names) ][[\"year\",\"name\",\"number\"]]\nheat_map2=pd.pivot_table(data2,columns=\"year\",index=\"name\",values=\"number\")\nheat_map2.index = pd.Categorical(heat_map2.index, order_top_average_names)\nheat_map2.sort_index(level=0, inplace=True)\nplt.figure(figsize=(35,13))\nplt.yticks(fontsize=20)\nplt.xticks(fontsize=14, rotation=90)\nsns.heatmap(heat_map2,cmap=\"YlGnBu\",linewidths=0.5)\n","f24f8a4c":"**Basic Analysis** WordCloud","b4944f53":"**Top 20 names popularity over time**","103ead51":"**Import Database**","214ca28b":"WHY DO NAMES BECOME POPULAR?\n\nThe name Linda was the most popular name between 1947 and 1950, this coincides with the release of the song \u201cLinda,\u201d which was a huge hit for Buddy Clark back in February 1947.\n\nThe song was written in 1942 when Lawrence was in the service during World War II, taking its name from the then one-year-old Lee Eastman,  future first wife of the Beatle Paul McCartney. The song did not get published until after Lawrence left the military, and was then recorded by a number of performers, but the biggest hit was by Ray Noble's orchestra (with a vocal by Buddy Clark). \n\nSong: https:\/\/www.youtube.com\/watch?v=Ej2HuRw8dlg\n\nSource:\nhttps:\/\/en.wikipedia.org\/wiki\/Linda_(1946_song)\n","6d43ae22":"- Import Libraries\n- Import Dataset\n- Basic Analysis: \n            - Percentage of total female versus male applicants\n            - Number of total applicants per year\n            - WordCloud\n\n1. Top Female and Male names per year\n2. Three most popular names for each decade\n3. Top 20 names popularity over time","1ec49633":"**Import Libraries**","a5c24373":"**Basic Analysis**\nPercentage of total female versus male applicants","cc1d1964":"**Top Female and Male names per year**","bb724338":"**Basic Analysis**\nNumber of total applicants per year","f12ca637":"**Three most popular names for each decade**"}}