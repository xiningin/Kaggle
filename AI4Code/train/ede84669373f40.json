{"cell_type":{"7533d61f":"code","f314af25":"code","5bd4eb63":"code","d544c2b7":"code","77c7dd3c":"code","12797901":"code","d10504a9":"code","08f76dfe":"code","1d0ab385":"code","96b4159f":"code","133ddae6":"code","c8ac6e4a":"code","a1f1ad65":"code","f852fec0":"code","e849c2fc":"code","c5845c3e":"code","47f973d9":"code","47b7a1c6":"code","f7e0bc11":"code","4d357a6a":"code","dd921f9b":"code","4881812c":"code","73e6ab32":"code","b2135d88":"code","2a9a7a67":"code","3dd7d8be":"code","8f97ac43":"code","369dbd36":"code","bd17ac05":"code","ff02083b":"code","f9c996bc":"code","611e9249":"code","92ff9fdf":"code","560284cf":"code","6a2441bb":"code","cd229f8b":"markdown","d0a69800":"markdown","124a7155":"markdown","dc03917d":"markdown","88041f67":"markdown","694a5f71":"markdown","10aa4cdd":"markdown","eb2dc10b":"markdown","941a234a":"markdown","016d8ebe":"markdown","385d9981":"markdown","26be5015":"markdown","9438bde8":"markdown","6328a203":"markdown"},"source":{"7533d61f":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.decomposition import PCA\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score,confusion_matrix, f1_score\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nimport seaborn as sns","f314af25":"data=pd.read_csv('\/kaggle\/input\/heart-failure-clinical-data\/heart_failure_clinical_records_dataset.csv')","5bd4eb63":"data.head()","d544c2b7":"col_list=list(data.columns)","77c7dd3c":"cnt=data.DEATH_EVENT.value_counts()\nplt.bar(['0','1'],cnt)","12797901":"X=data.drop('DEATH_EVENT',axis=1)\ny=data['DEATH_EVENT']","d10504a9":"scale=StandardScaler()\nscaled_data=pd.DataFrame(scale.fit_transform(X),columns=col_list[:-1])","08f76dfe":"cor=scaled_data.corr()\nplt.figure(figsize=(10, 10))\nsns.heatmap(cor,vmin=-1,vmax=1,cmap='RdYlGn',annot=True)","1d0ab385":"X_train,X_test,y_train,y_test=train_test_split(scaled_data,y,test_size=0.2)","96b4159f":"logi=LogisticRegression()\nlogi.fit(X_train,y_train)\ny_pred=logi.predict(X_test)","133ddae6":"accuracy_score(y_test,y_pred)","c8ac6e4a":"confusion_matrix(y_test,y_pred)","a1f1ad65":"f1_score(y_test,y_pred)","f852fec0":"decision_tree=DecisionTreeClassifier()\ndecision_tree.fit(X_train,y_train)\ny_pred=decision_tree.predict(X_test)","e849c2fc":"accuracy_score(y_test,y_pred)","c5845c3e":"f1_score(y_test,y_pred)","47f973d9":"r_forest=RandomForestClassifier()\nr_forest.fit(X_train,y_train)\ny_pred=r_forest.predict(X_test)","47b7a1c6":"accuracy_score(y_test,y_pred)","f7e0bc11":"f1_score(y_test,y_pred)","4d357a6a":"class_0,class_1=data.DEATH_EVENT.value_counts()\ndf_class_0=data[data['DEATH_EVENT']==0]\ndf_class_1=data[data['DEATH_EVENT']==1]","dd921f9b":"df_class_1 =df_class_1.sample(class_0,replace=True)\ndf_class_1=df_class_1.reset_index(drop=True)\nresampled_data=pd.concat([df_class_0,df_class_1],axis=0).reset_index()","4881812c":"cnt=resampled_data.DEATH_EVENT.value_counts()\nplt.bar(['0','1'],cnt)","73e6ab32":"X=resampled_data.drop(['DEATH_EVENT','index'],axis=1)\ny=resampled_data['DEATH_EVENT']","b2135d88":"scale=StandardScaler()\nscaled_data=pd.DataFrame(scale.fit_transform(X),columns=col_list[:-1])","2a9a7a67":"X_train,X_test,y_train,y_test=train_test_split(scaled_data,y,test_size=0.2)","3dd7d8be":"logi=LogisticRegression()\nlogi.fit(X_train,y_train)\ny_pred=logi.predict(X_test)","8f97ac43":"accuracy_score(y_test,y_pred)","369dbd36":"confusion_matrix(y_test,y_pred)","bd17ac05":"f1_score(y_test,y_pred)","ff02083b":"decision_tree=DecisionTreeClassifier()\ndecision_tree.fit(X_train,y_train)\ny_pred=decision_tree.predict(X_test)","f9c996bc":"accuracy_score(y_test,y_pred)","611e9249":"f1_score(y_test,y_pred)","92ff9fdf":"r_forest=RandomForestClassifier()\nr_forest.fit(X_train,y_train)\ny_pred=r_forest.predict(X_test)","560284cf":"accuracy_score(y_test,y_pred)","6a2441bb":"f1_score(y_test,y_pred)","cd229f8b":"### Decision Tree","d0a69800":"## Finding Correlation","124a7155":"### Random Forest","dc03917d":"## Machine Learnig Models","88041f67":"From correlation heat map we can see there is very less correlation betwwen features of data","694a5f71":"We can see there is imbalance of data. We need to consider this imbalance when using machine learning models. Thus we will use resampling","10aa4cdd":"## Data Scaling","eb2dc10b":"### Random Forest","941a234a":"Here now we have balaced data","016d8ebe":"### Decision Tree","385d9981":"## Splitting data into Training and Testing","26be5015":"We scale the data inorder to avoid bias during modelling","9438bde8":"# Resampling Data ","6328a203":"### Logistic Regression"}}