{"cell_type":{"3ba609ef":"code","653fcbf4":"code","fc383f9e":"code","c6dc32d0":"code","7c30c1a9":"code","04f85d21":"code","8aa7f455":"code","55e46e0f":"code","fda0cb94":"code","4bc4dac6":"code","11edb421":"code","35d8b5a6":"code","c68d96ab":"code","e3d85401":"code","bbfce36e":"code","38c32220":"code","4a298de2":"code","e776d446":"code","9580219f":"code","98c575ef":"code","bba17b78":"code","747a8407":"code","11b4438b":"code","5369cb72":"code","8e804dc8":"code","d7a50f02":"code","544f2264":"markdown","89be8bd8":"markdown","273b250f":"markdown","fe01dfc8":"markdown","06e9143e":"markdown","3e2ea339":"markdown","821ec4d9":"markdown","c28768e5":"markdown","cb64f64d":"markdown","d961032e":"markdown","bd12afad":"markdown","1232951d":"markdown","2b39f73f":"markdown","6d801f3f":"markdown","c5a4fbab":"markdown","436e7f55":"markdown","2bbd1870":"markdown","ee2640b3":"markdown","658fb254":"markdown","7c4dfab4":"markdown","52ba5d78":"markdown","7401cd89":"markdown","3c5c91fd":"markdown","25496d6a":"markdown","1e384c91":"markdown","8127f067":"markdown","57a59fa5":"markdown"},"source":{"3ba609ef":"# import required libraries\nimport pandas as pd \nimport io\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.model_selection import RandomizedSearchCV\nfrom sklearn.ensemble import ExtraTreesRegressor","653fcbf4":"# read csv file\ndf = pd.read_csv('..\/input\/graduate-admissions\/Admission_Predict_Ver1.1.csv')\n\n# last 5 rows of dataset\ndf.tail(5)","fc383f9e":"# shape\ndf.shape","c6dc32d0":"# columns\ndf.columns","7c30c1a9":"df = df.rename(columns={'GRE Score':'GRE_Score','TOEFL Score':'TOEFL_Score','University Rating':'University_Rating','LOR ':'LOR','Chance of Admit ':'Chance of Admit'})","04f85d21":"# chnage probability into percentage\ndf['100_'] = [100 for i in range(500)]\ndf['Chance of Admit'] = df['Chance of Admit']*df['100_']","8aa7f455":"df.drop(['100_'],axis=1,inplace=True)","55e46e0f":"df.drop(['Serial No.'],axis=1,inplace=True)","fda0cb94":"# final dataset\ndf.head()","4bc4dac6":"# basic info \ndf.info()","11edb421":"# basic stats info\ndf.describe()","35d8b5a6":"# pairplot\nsns.pairplot(df,hue='Research')","c68d96ab":"# correlation\ncorr_matrix = df.corr()\nsns.heatmap(corr_matrix, annot=True)\nplt.show()","e3d85401":"#box plot\nfig, ax = plt.subplots(3, 2, figsize=(10, 15))\nbp=sns.boxplot(y=df.GRE_Score,ax=ax[0, 0])\nax[0, 0].set_title('GRE Score')\n\nbp=sns.boxplot(y=df.TOEFL_Score,ax=ax[0, 1])\nax[0, 1].set_title('TOEFL Score')\n\nbp=sns.boxplot(y=df.University_Rating,ax=ax[1, 0])\nax[1,0].set_title('University Rating')\n\nbp=sns.boxplot(y=df.SOP,ax=ax[1, 1])\nax[1,1].set_title('Statement of purpose')\n\nbp=sns.boxplot(y=df.LOR,ax=ax[2,0])\nax[2, 0].set_title('Letter of Recommendation')\n\ns=sns.boxplot(y=df.CGPA,ax=ax[2, 1])\nax[2,1].set_title('CGPA')\n\nplt.show()","bbfce36e":"p=sns.countplot(x='University_Rating',data=df)\np.set_xticklabels(p.get_xticklabels(),rotation=90)\nplt.title('Count of University Rating')","38c32220":"p=sns.countplot(x='Research',data=df)\np.set_xticklabels(p.get_xticklabels(),rotation=90)\nplt.title('Count of Research')","4a298de2":"sns.set(style='darkgrid')\nsns.countplot(x='LOR',hue='Research',data=df)","e776d446":"ax = sns.regplot(x=\"GRE_Score\", y=\"TOEFL_Score\", data=df , scatter_kws = {'color':'black'} , line_kws = {'color':'red'})\nplt.title(\"GRE Score vs TOEFL Score\")\nplt.show()","9580219f":"ax = sns.regplot(x=\"GRE_Score\", y=\"CGPA\", data=df ,  scatter_kws = {'color':'black'} , line_kws = {'color':'blue'} )\nplt.title(\"GRE Score vs CGPA\")\nplt.show()","98c575ef":"model = ExtraTreesRegressor() \nmodel.fit(df.iloc[:,:-1],df.iloc[:,-1])\n\nfeat_impt = pd.Series(model.feature_importances_, index = df.iloc[:,:-1].columns) \nfeat_impt.nlargest(7).plot(kind='barh')\nplt.show()","bba17b78":"# dependent and independent features\nX = df.iloc[:,:-1]\ny = df.iloc[:,-1]","747a8407":"# split into train and test\nX_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.15)","11b4438b":"#parameters\nn_estimators=[100,200,300,400,500,600,700,800,900,1000]\nmax_depth=[2,4,6,8,10,12,14]\nmin_samples_split=[5,15,25,35,45,55]\nmax_features=['auto','sqrt','log2']\nmin_samples_leaf=[2,4,6,8]\n\n#hyperparameter grid\nhyper_grid={\n    'n_estimators':n_estimators,\n    'max_depth':max_depth,\n    'min_samples_split':min_samples_split,\n    'max_features':max_features,\n    'min_samples_leaf':min_samples_leaf\n}","5369cb72":"regressor =RandomForestRegressor()\n\nrandom_cv2 = RandomizedSearchCV(estimator=regressor,param_distributions=hyper_grid,\n                              cv=5,n_iter=20,scoring='neg_mean_absolute_error',verbose=3,n_jobs=1,random_state=121\n                              )\n#fitting X_train and y_train\nrandom_cv2.fit(X_train,y_train)","8e804dc8":"# prediction\nprediction = random_cv2.predict(X_test)","d7a50f02":"#calculating mean absolute error of random forest\nfrom sklearn import metrics\nmetrics.mean_absolute_error(y_test,prediction)","544f2264":"### GRE Score VS CGPA ","89be8bd8":"Now I want prediction in percentage not in probability.So I am going to convert that column in % by multiplying by 100","273b250f":"Now it's time build the model","fe01dfc8":"From above we can clearly see that CGPA is the most important key for getting Admission in college","06e9143e":"From above we can see that we have dtypes as int or float and we don't have any null value","3e2ea339":"## Randomized Search CV","821ec4d9":"In this notebook we are going to predict the chances of admission in college based on different features like CGPA,LOR,etc.\nWithout taking much time let's get started.First of all we need to import all the required libraries \n","c28768e5":"The ml web app will look like this: ![image.png](attachment:image.png)","cb64f64d":"## Heroku app","d961032e":"From above we got to knwo many things about our data\n- We can see that TOEFL Score and GRE Score are highly positive correlated to each other as expected \n- We don't have any values which are negative correlated to each other","bd12afad":"We can see that their are unwanted spaces in column name.So now we are going to change our column name","1232951d":"We don't need '100_' and 'Serial No.' column.So we can drop them","2b39f73f":"Now it's time to understand our data.So let's get started and make some amazing plots","6d801f3f":"# Model Building","c5a4fbab":"Students with higher GRE Scores also have higher TOEFL Scores which is justified because both TOEFL and GRE have a verbal section which although not similar are relatable","436e7f55":"### **I would like to thanks KRISH NAIK sir by watching his video I have made this web app using flask**","2bbd1870":"## Prediction and MAE","ee2640b3":"# Feature Importance","658fb254":"**Do you wanna see your your chances for getting into the college based on your marks and experience?**\n**I have predicted my chances and you also can do it just by clicking on this link https:\/\/admission-chances-predictions.herokuapp.com\/**","7c4dfab4":"### Research","52ba5d78":"So we can clearly see that we don't have any outlier.So it's clear that the student who have high score will have higher chances for admission in college","7401cd89":"### GRE Score vs TOEFL Score","3c5c91fd":"### University Rating","25496d6a":"So from above we got to knwo that are dataset is very small","1e384c91":"### outliers","8127f067":"Although there are exceptions, people with higher CGPA usually have higher GRE scores maybe because they are smart or hard working","57a59fa5":"# Data Visulization"}}