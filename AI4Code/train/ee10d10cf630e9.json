{"cell_type":{"e8cb0e9a":"code","87c1a6c6":"code","c4add3d6":"code","f9867d86":"code","1c3862ab":"code","a855b226":"code","f45ed9f2":"code","5a17bc6e":"code","51bb7adb":"code","83301f58":"code","e330ceee":"code","93f4213a":"code","0c7b1bd9":"code","318a46c5":"code","1ea1abff":"code","1db2fff0":"code","051c1fec":"code","1c144c53":"code","c76b9a2a":"code","323da834":"code","68795281":"code","8151a8a6":"code","86e0d6e3":"code","1b650a3d":"code","0a14740f":"code","25062465":"code","ddc9cec9":"code","8f840ae6":"code","2a457309":"code","2a4fe5cc":"code","eeadd05f":"code","58caf575":"code","019415f4":"code","0773785b":"code","a43d754f":"code","1c4e0e84":"code","32326252":"code","c38e91d4":"code","81a70d9d":"code","e2f70bfe":"code","ae547ade":"code","34a582aa":"code","e5cd513d":"code","caac05ad":"code","e93e0e1d":"code","ebccdaed":"code","8b830761":"code","69312358":"code","b502c21d":"code","4fa2e003":"code","487349e7":"code","7682aa9f":"markdown","ab996b99":"markdown","3f4d8839":"markdown","67349b3a":"markdown","0a53a50d":"markdown","e54ab9ad":"markdown","05fc958a":"markdown","cc82c6a9":"markdown","971a4002":"markdown","fac15e6e":"markdown","81e8f8fb":"markdown","7fa8775a":"markdown","91d75972":"markdown"},"source":{"e8cb0e9a":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","87c1a6c6":"#Import Ames House Dataset\ndf= pd.read_csv('\/kaggle\/input\/taitanictrain\/datasets_11657_16098_train.csv')","c4add3d6":"df.info()","f9867d86":"df.describe()","1c3862ab":"df.head()","a855b226":"sns.countplot(x='Survived',data=df)","f45ed9f2":"sns.countplot(x='Survived',hue='Sex',data=df,palette='winter')","5a17bc6e":"sns.countplot(x='Survived',hue='Pclass',data=df)","51bb7adb":"df['Age'].plot.hist()\n","83301f58":"sns.scatterplot(data=df, x='Age', y='Sex', hue='Survived')","e330ceee":"sns.boxplot(data=df, x='Survived', y='Age')","93f4213a":"sns.boxplot(data=df, x='Sex', y='Age')","0c7b1bd9":"df['Fare'].plot.hist(bins=20,figsize=(10,5))","318a46c5":"sns.countplot(x='SibSp',data=df)","1ea1abff":"df['Parch'].plot.hist()","1db2fff0":"sns.countplot(x='Parch',data=df)","051c1fec":"df.isnull().sum()","1c144c53":"df.drop('Cabin',axis=1,inplace=True)","c76b9a2a":"df.head()","323da834":"df.dropna(inplace=True)","68795281":"df.shape","8151a8a6":"df.isnull().sum()","86e0d6e3":"df['Sex'] = df['Sex'].map({'male':1,'female':0})\ndf.head()","1b650a3d":"df.drop(['PassengerId','Ticket','Embarked','Name'],axis=1,inplace=True)","0a14740f":"df.head()","25062465":"df.info()","ddc9cec9":"print('max_missing:', df.count().idxmin())","8f840ae6":"sns.pairplot(df, hue='Survived')","2a457309":"sns.scatterplot(data=df, x='Age', y='Fare', hue='Survived',palette='Dark2')","2a4fe5cc":"width = 5\nheight = 5\nplt.figure(figsize=(width, height))\nsns.regplot( data=df , x=\"Fare\", y=\"Survived\")\nplt.ylim(0,)","eeadd05f":"pd.get_dummies(df)","58caf575":"pd.get_dummies(df.drop('Survived',axis=1),drop_first=True)","019415f4":"df['Survived'].value_counts()","0773785b":"from sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.metrics import confusion_matrix , classification_report\nfrom sklearn.tree import plot_tree","a43d754f":"X= df.drop(['Survived'], axis=1)\ny=df['Survived']","1c4e0e84":"X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.3,random_state=101)","32326252":"scaler= StandardScaler()\nscaler.fit(X_train)","c38e91d4":"model = DecisionTreeClassifier()\nmodel.fit(X_train,y_train)","81a70d9d":"y_pred = model.predict(X_test)","e2f70bfe":"confusion_matrix(y_test,y_pred)","ae547ade":"print(classification_report(y_test,y_pred))","34a582aa":"model.feature_importances_","e5cd513d":"pd.DataFrame(index=X.columns,data=model.feature_importances_,columns=['Feature Importance'])","caac05ad":"plt.figure(figsize=(12,8),dpi=150)\nplot_tree(model,filled=True,feature_names=X.columns);","e93e0e1d":"def report_model(model):\n    model_preds = model.predict(X_test)\n    print(classification_report(y_test,model_preds))\n    print('\\n')\n    plt.figure(figsize=(12,8),dpi=150)\n    plot_tree(model,filled=True,feature_names=X.columns);","ebccdaed":"pruned_tree = DecisionTreeClassifier(max_depth=2)\npruned_tree.fit(X_train,y_train)","8b830761":"report_model(pruned_tree)","69312358":"pruned_tree = DecisionTreeClassifier(max_leaf_nodes=3)\npruned_tree.fit(X_train,y_train)","b502c21d":"report_model(pruned_tree)","4fa2e003":"entropy_tree = DecisionTreeClassifier(criterion='entropy')\nentropy_tree.fit(X_train,y_train)","487349e7":"report_model(entropy_tree)","7682aa9f":"### Understanding Hyperparameters","ab996b99":"#### Max Leaf Nodes","3f4d8839":"### Visualize the Tree\nA Decision Tree is a supervised algorithm used in machine learning. It is using a binary tree graph (each node has two children) to assign for each data sample a target value. The target values are presented in the tree leaves. To reach to the leaf, the sample is propagated through nodes, starting at the root node. In each node a decision is made, to which descendant node it should go. A decision is made based on the selected sample\u2019s feature. Decision Tree learning is a process of finding the optimal rules in each internal tree node according to the selected metric.","67349b3a":"### decision tree classifier\nDecision tree learning or induction of decision trees is one of the predictive modelling approaches used in statistics, data mining and machine learning. It uses a decision tree (as a predictive model) to go from observations about an item (represented in the branches) to conclusions about the item's target value (represented in the leaves). Tree models where the target variable can take a discrete set of values are called classification trees; in these tree structures, leaves represent class labels and branches represent conjunctions of features that lead to those class labels. Decision trees where the target variable can take continuous values (typically real numbers) are called regression trees. Decision trees are among the most popular machine learning algorithms given their intelligibility and simplicity","0a53a50d":"### Train the Model","e54ab9ad":"### Criterion","05fc958a":"### Split the Dataset to Train & Test set","cc82c6a9":"### Determine the Features & Target Variable","971a4002":"### Predicting Test Data","fac15e6e":"### Reporting Model Results\n\nTo begin experimenting with hyperparameters, let's create a function that reports back classification results and plots out the tree.","81e8f8fb":"### Data Cleaning\nOnce processed and organized, the data may be incomplete, contain duplicates, or contain errors. The need for data cleaning will arise from problems in the way that the datum are entered and stored. Data cleaning is the process of preventing and correcting these errors. Common tasks include record matching, identifying inaccuracy of data, overall quality of existing data, deduplication, and column segmentation. Such data problems can also be identified through a variety of analytical techniques. ","7fa8775a":"### Evaluating the Model","91d75972":"### Analysing data\nData analysis is a process of inspecting, cleansing, transforming, and modelling data with the goal of discovering useful information, informing conclusions, and supporting decision-making.[1] Data analysis has multiple facets and approaches, encompassing diverse techniques under a variety of names, and is used in different business, science, and social science domains. In today's business world, data analysis plays a role in making decisions more scientific and helping businesses operate more effectively."}}