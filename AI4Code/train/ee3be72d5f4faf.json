{"cell_type":{"bc7a9ee1":"code","3b1e720a":"code","b113b0ea":"code","376a1770":"code","d8bf9495":"code","0878061e":"code","f2976b4b":"code","e83d6237":"code","fd4996f1":"code","261057f9":"code","ec2aa77f":"code","5a91525e":"code","df92b483":"code","7ecdb90a":"code","26ed715e":"code","bac06ba1":"code","9d5261f0":"code","9b88b213":"code","b2731b3a":"code","2128bcf2":"code","101cd981":"code","6e861491":"code","d44cd95d":"code","194a6bfe":"code","8f77e5ae":"code","a8242bc5":"code","66c755d1":"code","3c0bdfdb":"code","3130497c":"code","293683d6":"code","7023ce8c":"code","59ba9bda":"code","9fd11e40":"code","9100e29e":"code","84c96ba2":"code","9f48cffe":"code","d752895b":"code","c697d4de":"code","c5785f96":"code","31691cfd":"code","c984a7ae":"code","6b3b62d8":"code","6f0c1907":"code","90978c05":"code","d6b5bea6":"code","da85241c":"code","6cbeb82a":"code","ec73f61e":"code","0e0f648d":"code","e1b75c1a":"code","7c781e8e":"code","feb75024":"code","a5bd7457":"code","2af03271":"code","fd502b01":"code","a79f8712":"code","58d93ffb":"code","7f544be5":"code","21665300":"code","82f24d2e":"code","ebb2f580":"code","606b9fdc":"code","ca1e4a9b":"code","a11b260c":"code","bfea8f10":"code","ef554447":"code","cd6fe932":"code","a3409491":"code","4b09b94c":"code","202e2297":"code","c77e748f":"code","e5e8b1c2":"code","bfc64b22":"code","95bc25cb":"code","34637031":"code","fa53245a":"code","81256b67":"code","6f4e06e9":"code","e4478fc3":"code","7541e2a0":"code","aee1a763":"code","5f3c0d78":"code","9310acee":"code","3870a07f":"code","3c2ef23e":"code","d9fc9246":"code","1d0d63ce":"code","1930e5a7":"code","300a4b48":"code","976fae33":"code","63400daa":"code","eea8eb05":"code","a9d10127":"code","dbda8ace":"code","404ed07b":"code","82b704d8":"code","fa1be568":"code","3ced6b35":"code","b6353150":"code","8d2a5829":"code","8bd2f8e1":"code","760bdc6b":"code","31d7805c":"code","1740aeca":"code","f20fd590":"code","eb9ae401":"code","521a13c6":"code","497ddc89":"code","a020da80":"code","94fc8162":"code","c2a5ad79":"code","1f9c5293":"code","70f5448c":"code","218f2e71":"code","7c691a96":"code","e165e662":"code","afe4e982":"code","77e492ad":"code","536c95c0":"code","5703d145":"code","990e272c":"code","eee7262d":"code","562dcf64":"code","71070096":"markdown","c3d8d1ee":"markdown","0f3e5e77":"markdown","d2c975f1":"markdown","f1867b10":"markdown","100ebfc1":"markdown","ba00d59b":"markdown","42d899cb":"markdown","2a5e0ae5":"markdown","835923d4":"markdown","42bc9125":"markdown","fefa96a3":"markdown","524961f1":"markdown","7f35417b":"markdown","0184f2bb":"markdown","4b61d489":"markdown","345bf5ec":"markdown","b23dab33":"markdown","34aa84ea":"markdown","a080d248":"markdown","5bd194d3":"markdown","4dadc3b8":"markdown","3fa0b88e":"markdown","422ac19e":"markdown","3a239e9c":"markdown","999dfa0a":"markdown","766ee4ad":"markdown","eacede11":"markdown","ec922736":"markdown","9f62bd19":"markdown","d6046122":"markdown","89609f71":"markdown","dde2ac35":"markdown","361b3663":"markdown","c175b784":"markdown","e1a60f8a":"markdown","dad59df0":"markdown","1328426b":"markdown","c831958f":"markdown","59bed9ca":"markdown","15e31372":"markdown","ef6747ce":"markdown","eb1489ec":"markdown"},"source":{"bc7a9ee1":"# supress warnings\nimport warnings\nwarnings.filterwarnings('ignore')","3b1e720a":"# Importing all required packages\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\nfrom matplotlib.pyplot import xticks","b113b0ea":"df = pd.DataFrame(pd.read_csv(\"..\/input\/CarPrice_Assignment.csv\"))","376a1770":"df.head()","d8bf9495":"df.shape\n# Data has 26 columns and 205 rows.","0878061e":"df.describe()","f2976b4b":"df.info()","e83d6237":"df.columns","fd4996f1":"#checking duplicates\nsum(df.duplicated(subset = 'car_ID')) == 0\n# No duplicate values","261057f9":"# Checking Null values\ndf.isnull().sum()*100\/df.shape[0]\n# There are no NULL values in the dataset, hence it is clean.","ec2aa77f":"df.price.describe()","5a91525e":"sns.distplot(df['price'])","df92b483":"# Inference\n# Mean and median of price are significantly different.\n# Large standard deviation indicates that there is considerable variance in the prices of the automobiles.\n# Price values are right-skewed, most cars are priced at the lower end (9000) of the price range.","7ecdb90a":"# car_ID : Unique ID for each observation","26ed715e":"# symboling : Its assigned insurance risk rating\n#             A value of +3 indicates that the auto is risky,\n#             -3 that it is probably pretty safe.(Categorical)","bac06ba1":"# Let's see the count of automobile in each category and percent share of each category.","9d5261f0":"plt1 = sns.countplot(df['symboling'])\nplt1.set(xlabel = 'Symbol', ylabel= 'Count of Cars')\nplt.show()\nplt.tight_layout()","9b88b213":"df_sym = pd.DataFrame(df['symboling'].value_counts())\ndf_sym.plot.pie(subplots=True,labels = df_sym.index.values, autopct='%1.1f%%', figsize = (15,7.5))\n# Unsquish the pie.\nplt.gca().set_aspect('equal')\nplt.show()\nplt.tight_layout()","b2731b3a":"# Let's see average price of cars in each symbol category.","2128bcf2":"plt1 = df[['symboling','price']].groupby(\"symboling\").mean().plot(kind='bar',legend = False,)\nplt1.set_xlabel(\"Symbol\")\nplt1.set_ylabel(\"Avg Price (Dollars)\")\nxticks(rotation = 0)\nplt.show()\n","101cd981":"# Inference\n# More than 50% of cars are with symbol 0 or 1.\n# Average price of car is lower for 0,1 & 2 symbol category.","6e861491":"df.CarName.values[0:10]","d44cd95d":"# It is observed that Car Name consists of two parts 'car company' + ' ' + 'Car Model'\n# Let's split out car company to a new column.","194a6bfe":"df['brand'] = df.CarName.str.split(' ').str.get(0).str.upper()","8f77e5ae":"len(set(df.brand.values))","a8242bc5":"# Let's see companies and their no of models.","66c755d1":"fig, ax = plt.subplots(figsize = (15,5))\nplt1 = sns.countplot(df['brand'], order=pd.value_counts(df['brand']).index,)\nplt1.set(xlabel = 'Brand', ylabel= 'Count of Cars')\nxticks(rotation = 90)\nplt.show()\nplt.tight_layout()","3c0bdfdb":"# It's noticed that in brand names,\n# VOLKSWAGON has three different values as VOLKSWAGEN, VOKSWAGEN and VW\n# MAZDA is also spelled as MAXDA\n# PORSCHE as PORSCHE and PORCSCHE.\n# Let's fix these data issues.\ndf['brand'] = df['brand'].replace(['VW', 'VOKSWAGEN'], 'VOLKSWAGEN')\ndf['brand'] = df['brand'].replace(['MAXDA'], 'MAZDA')\ndf['brand'] = df['brand'].replace(['PORCSHCE'], 'PORSCHE')\ndf['brand'] = df['brand'].replace(['TOYOUTA'], 'TOYOTA')","3130497c":"fig, ax = plt.subplots(figsize = (15,5))\nplt1 = sns.countplot(df['brand'], order=pd.value_counts(df['brand']).index,)\nplt1.set(xlabel = 'Brand', ylabel= 'Count of Cars')\nxticks(rotation = 90)\nplt.show()\nplt.tight_layout()","293683d6":"df.brand.describe()","7023ce8c":"# Inference\n# Toyota, a Japanese company has the most no of models.","59ba9bda":"# Let's see average car price of each company.","9fd11e40":"\ndf_comp_avg_price = df[['brand','price']].groupby(\"brand\", as_index = False).mean().rename(columns={'price':'brand_avg_price'})\nplt1 = df_comp_avg_price.plot(x = 'brand', kind='bar',legend = False, sort_columns = True, figsize = (15,3))\nplt1.set_xlabel(\"Brand\")\nplt1.set_ylabel(\"Avg Price (Dollars)\")\nxticks(rotation = 90)\nplt.show()","9100e29e":"#df_comp_avg_price","84c96ba2":"df = df.merge(df_comp_avg_price, on = 'brand')","9f48cffe":"df['brand_category'] = df['brand_avg_price'].apply(lambda x : \"Budget\" if x < 10000 \n                                                     else (\"Mid_Range\" if 10000 <= x < 20000\n                                                           else \"Luxury\"))\n","d752895b":"# Inference:\n# Toyota has considerably high no of models in the market.\n# Brands can be categorised as Luxury, Mid Ranged, Budget based on their average price.\n# Some of the Luxury brans are","c697d4de":"# Let's see how price varies with  Fuel Type","c5785f96":"df_fuel_avg_price = df[['fueltype','price']].groupby(\"fueltype\", as_index = False).mean().rename(columns={'price':'fuel_avg_price'})\nplt1 = df_fuel_avg_price.plot(x = 'fueltype', kind='bar',legend = False, sort_columns = True)\nplt1.set_xlabel(\"Fuel Type\")\nplt1.set_ylabel(\"Avg Price (Dollars)\")\nxticks(rotation = 0)\nplt.show()","31691cfd":"# Inference\n# Diesel cars are priced more than gas cars.","c984a7ae":"df_aspir_avg_price = df[['aspiration','price']].groupby(\"aspiration\", as_index = False).mean().rename(columns={'price':'aspir_avg_price'})\nplt1 = df_aspir_avg_price.plot(x = 'aspiration', kind='bar',legend = False, sort_columns = True)\nplt1.set_xlabel(\"Aspiration\")\nplt1.set_ylabel(\"Avg Price (Dollars)\")\nxticks(rotation = 0)\nplt.show()","6b3b62d8":"# Inference\n# Cars with turbo aspiration engine are priced more than standard ones.","6f0c1907":"df_door_avg_price = df[['doornumber','price']].groupby(\"doornumber\", as_index = False).mean().rename(columns={'price':'door_avg_price'})\nplt1 = df_door_avg_price.plot(x = 'doornumber', kind='bar',legend = False, sort_columns = True)\nplt1.set_xlabel(\"No of Doors\")\nplt1.set_ylabel(\"Avg Price (Dollars)\")\nxticks(rotation = 0)\nplt.show()","90978c05":"# Inference\n# Number of doors doesn't seem to have much effect on price.","d6b5bea6":"df_body_avg_price = df[['carbody','price']].groupby(\"carbody\", as_index = False).mean().rename(columns={'price':'carbody_avg_price'})\nplt1 = df_body_avg_price.plot(x = 'carbody', kind='bar',legend = False, sort_columns = True)\nplt1.set_xlabel(\"Car Body\")\nplt1.set_ylabel(\"Avg Price (Dollars)\")\nxticks(rotation = 0)\nplt.show() ","da85241c":"# Inference \n# Hardtop and convertible are the most expensive whereas hatchbacks are the cheapest.","6cbeb82a":"df_drivewheel_avg_price = df[['drivewheel','price']].groupby(\"drivewheel\", as_index = False).mean().rename(columns={'price':'drivewheel_avg_price'})\nplt1 = df_drivewheel_avg_price.plot(x = 'drivewheel', kind='bar', sort_columns = True,legend = False,)\nplt1.set_xlabel(\"Drive Wheel Type\")\nplt1.set_ylabel(\"Avg Price (Dollars)\")\nxticks(rotation = 0)\nplt.show()","ec73f61e":"# Inference\n# Cars with Rear wheel drive have a higher price value.","0e0f648d":"plt1 = sns.scatterplot(x = 'wheelbase', y = 'price', data = df)\nplt1.set_xlabel('Wheelbase (Inches)')\nplt1.set_ylabel('Price of Car (Dollars)')\nplt.show()","e1b75c1a":"# Most cars has a wheel base around 95 inches.\n# Price has a slight positive correlation with wheelbase.","7c781e8e":"# Let's see how price varies with Car's length, width,height and weight.","feb75024":"fig, axs = plt.subplots(2,2,figsize=(15,10))\nplt1 = sns.scatterplot(x = 'carlength', y = 'price', data = df, ax = axs[0,0])\nplt1.set_xlabel('Length of Car (Inches)')\nplt1.set_ylabel('Price of Car (Dollars)')\nplt2 = sns.scatterplot(x = 'carwidth', y = 'price', data = df, ax = axs[0,1])\nplt2.set_xlabel('Width of Car (Inches)')\nplt2.set_ylabel('Price of Car (Dollars)')\nplt3 = sns.scatterplot(x = 'carheight', y = 'price', data = df, ax = axs[1,0])\nplt3.set_xlabel('Height of Car (Inches)')\nplt3.set_ylabel('Price of Car (Dollars)')\nplt3 = sns.scatterplot(x = 'curbweight', y = 'price', data = df, ax = axs[1,1])\nplt3.set_xlabel('Weight of Car (Pounds)')\nplt3.set_ylabel('Price of Car (Dollars)')\nplt.tight_layout()","a5bd7457":"# Inference\n# Length width and weight of the car is positively related with the price.\n# There is not much of a correlation with Height of the car with price.","2af03271":"fig, axs = plt.subplots(1,3,figsize=(20,5))\n#\ndf_engine_avg_price = df[['enginetype','price']].groupby(\"enginetype\", as_index = False).mean().rename(columns={'price':'engine_avg_price'})\nplt1 = df_engine_avg_price.plot(x = 'enginetype', kind='bar', sort_columns = True, legend = False, ax = axs[0])\nplt1.set_xlabel(\"Engine Type\")\nplt1.set_ylabel(\"Avg Price (Dollars)\")\nxticks(rotation = 0)\n#\ndf_cylindernumber_avg_price = df[['cylindernumber','price']].groupby(\"cylindernumber\", as_index = False).mean().rename(columns={'price':'cylindernumber_avg_price'})\nplt1 = df_cylindernumber_avg_price.plot(x = 'cylindernumber', kind='bar', sort_columns = True,legend = False, ax = axs[1])\nplt1.set_xlabel(\"Cylinder Number\")\nplt1.set_ylabel(\"Avg Price (Dollars)\")\nxticks(rotation = 0)\n#\ndf_fuelsystem_avg_price = df[['fuelsystem','price']].groupby(\"fuelsystem\", as_index = False).mean().rename(columns={'price':'fuelsystem_avg_price'})\nplt1 = df_fuelsystem_avg_price.plot(x = 'fuelsystem', kind='bar', sort_columns = True,legend = False, ax = axs[2])\nplt1.set_xlabel(\"Fuel System\")\nplt1.set_ylabel(\"Avg Price (Dollars)\")\nxticks(rotation = 0)\nplt.show()","fd502b01":"# Inference\n# DOHCV and OHCV engine types are priced high.\n# Eight and twelve cylinder cars have higher price.\n# IDI and MPFI fuel system have higher price.\n","a79f8712":"fig, axs = plt.subplots(3,2,figsize=(20,20))\n#\nplt1 = sns.scatterplot(x = 'enginesize', y = 'price', data = df, ax = axs[0,0])\nplt1.set_xlabel('Size of Engine (Cubic Inches)')\nplt1.set_ylabel('Price of Car (Dollars)')\n#\nplt2 = sns.scatterplot(x = 'boreratio', y = 'price', data = df, ax = axs[0,1])\nplt2.set_xlabel('Bore Ratio')\nplt2.set_ylabel('Price of Car (Dollars)')\n#\nplt3 = sns.scatterplot(x = 'stroke', y = 'price', data = df, ax = axs[1,0])\nplt3.set_xlabel('Stroke')\nplt3.set_ylabel('Price of Car (Dollars)')\n#\nplt4 = sns.scatterplot(x = 'compressionratio', y = 'price', data = df, ax = axs[1,1])\nplt4.set_xlabel('Compression Ratio')\nplt4.set_ylabel('Price of Car (Dollars)')\n#\nplt5 = sns.scatterplot(x = 'horsepower', y = 'price', data = df, ax = axs[2,0])\nplt5.set_xlabel('Horsepower')\nplt5.set_ylabel('Price of Car (Dollars)')\n#\nplt5 = sns.scatterplot(x = 'peakrpm', y = 'price', data = df, ax = axs[2,1])\nplt5.set_xlabel('Peak RPM')\nplt5.set_ylabel('Price of Car (Dollars)')\nplt.tight_layout()\nplt.show()\n","58d93ffb":"# Inference\n# Size of Engine, bore ratio, and Horsepower has positive correlation with price.","7f544be5":"# A single variable mileage can be calculated taking the weighted average of 55% city and 45% highways.","21665300":"df['mileage'] = df['citympg']*0.55 + df['highwaympg']*0.45","82f24d2e":"# Let's see how price varies with mileage.","ebb2f580":"plt1 = sns.scatterplot(x = 'mileage', y = 'price', data = df)\nplt1.set_xlabel('Mileage')\nplt1.set_ylabel('Price of Car (Dollars)')\nplt.show()","606b9fdc":"# Inference \n# Mileage has a negative correlation with price.","ca1e4a9b":"# It is expected that luxury brands don't care about mileage. Let's find out how price varies with brand category and mileage.","a11b260c":"plt1 = sns.scatterplot(x = 'mileage', y = 'price', hue = 'brand_category', data = df)\nplt1.set_xlabel('Mileage')\nplt1.set_ylabel('Price of Car (Dollars)')\nplt.show()","bfea8f10":"plt1 = sns.scatterplot(x = 'horsepower', y = 'price', hue = 'brand_category', data = df)\nplt1.set_xlabel('Horsepower')\nplt1.set_ylabel('Price of Car (Dollars)')\nplt.show()","ef554447":"plt1 = sns.scatterplot(x = 'mileage', y = 'price', hue = 'fueltype', data = df)\nplt1.set_xlabel('Mileage')\nplt1.set_ylabel('Price of Car (Dollars)')\nplt.show()","cd6fe932":"plt1 = sns.scatterplot(x = 'horsepower', y = 'price', hue = 'fueltype', data = df)\nplt1.set_xlabel('Horsepower')\nplt1.set_ylabel('Price of Car (Dollars)')\nplt.show()","a3409491":"auto = df[['fueltype', 'aspiration', 'carbody', 'drivewheel', 'wheelbase', 'carlength', 'carwidth', 'curbweight', 'enginetype',\n       'cylindernumber', 'enginesize',  'boreratio', 'horsepower', 'price', 'brand_category', 'mileage']]","4b09b94c":"auto.head()","202e2297":"plt.figure(figsize=(15, 15))\nsns.pairplot(auto)\nplt.show()","c77e748f":"plt.figure(figsize=(10, 20))\nplt.subplot(4,2,1)\nsns.boxplot(x = 'fueltype', y = 'price', data = auto)\nplt.subplot(4,2,2)\nsns.boxplot(x = 'aspiration', y = 'price', data = auto)\nplt.subplot(4,2,3)\nsns.boxplot(x = 'carbody', y = 'price', data = auto)\nplt.subplot(4,2,4)\nsns.boxplot(x = 'drivewheel', y = 'price', data = auto)\nplt.subplot(4,2,5)\nsns.boxplot(x = 'enginetype', y = 'price', data = auto)\nplt.subplot(4,2,6)\nsns.boxplot(x = 'brand_category', y = 'price', data = auto)\nplt.subplot(4,2,7)\nsns.boxplot(x = 'cylindernumber', y = 'price', data = auto)\nplt.tight_layout()\nplt.show()\n","e5e8b1c2":"# Categorical Variables are converted into Neumerical Variables with the help of Dummy Variable ","bfc64b22":"cyl_no = pd.get_dummies(auto['cylindernumber'], drop_first = True)","95bc25cb":"auto = pd.concat([auto, cyl_no], axis = 1)","34637031":"brand_cat = pd.get_dummies(auto['brand_category'], drop_first = True)","fa53245a":"auto = pd.concat([auto, brand_cat], axis = 1)","81256b67":"eng_typ = pd.get_dummies(auto['enginetype'], drop_first = True)","6f4e06e9":"auto = pd.concat([auto, eng_typ], axis = 1)","e4478fc3":"drwh = pd.get_dummies(auto['drivewheel'], drop_first = True)","7541e2a0":"auto = pd.concat([auto, drwh], axis = 1)","aee1a763":"carb = pd.get_dummies(auto['carbody'], drop_first = True)","5f3c0d78":"auto = pd.concat([auto, carb], axis = 1)","9310acee":"asp = pd.get_dummies(auto['aspiration'], drop_first = True)","3870a07f":"auto = pd.concat([auto, asp], axis = 1)","3c2ef23e":"fuelt = pd.get_dummies(auto['fueltype'], drop_first = True)","d9fc9246":"auto = pd.concat([auto, fuelt], axis = 1)","1d0d63ce":"auto.drop(['fueltype', 'aspiration', 'carbody', 'drivewheel', 'enginetype', 'cylindernumber','brand_category'], axis = 1, inplace = True)","1930e5a7":"from sklearn.model_selection import train_test_split\n\n# We specify this so that the train and test data set always have the same rows, respectively\nnp.random.seed(0)\ndf_train, df_test = train_test_split(auto, train_size = 0.7, test_size = 0.3, random_state = 100)","300a4b48":"# We will use min-max scaling","976fae33":"from sklearn.preprocessing import MinMaxScaler","63400daa":"scaler = MinMaxScaler()","eea8eb05":"# Apply scaler() to all the columns except the 'dummy' variables\nnum_vars = ['wheelbase', 'carlength', 'carwidth', 'curbweight', 'enginesize','boreratio', 'horsepower', 'price','mileage']\n\ndf_train[num_vars] = scaler.fit_transform(df_train[num_vars])","a9d10127":"df_train.head()","dbda8ace":"df_train.describe()","404ed07b":"# Let's check the correlation coefficients to see which variables are highly correlated\n\nplt.figure(figsize = (16, 10))\nsns.heatmap(df_train.corr(), annot = True, cmap=\"YlGnBu\")\nplt.show()","82b704d8":"y_train = df_train.pop('price')\nX_train = df_train","fa1be568":"# Importing RFE and LinearRegression\nfrom sklearn.feature_selection import RFE\nfrom sklearn.linear_model import LinearRegression","3ced6b35":"# Running RFE with the output number of the variable equal to 10\nlm = LinearRegression()\nlm.fit(X_train, y_train)\n\nrfe = RFE(lm, 10)             # running RFE\nrfe = rfe.fit(X_train, y_train)","b6353150":"list(zip(X_train.columns,rfe.support_,rfe.ranking_))","8d2a5829":"col = X_train.columns[rfe.support_]\ncol","8bd2f8e1":"# Creating X_test dataframe with RFE selected variables\nX_train_rfe = X_train[col]","760bdc6b":"# Adding a constant variable \nimport statsmodels.api as sm  \nX_train_rfe = sm.add_constant(X_train_rfe)","31d7805c":"lm = sm.OLS(y_train,X_train_rfe).fit()   # Running the linear model","1740aeca":"#Let's see the summary of our linear model\nprint(lm.summary())","f20fd590":"# Calculate the VIFs for the new model\nfrom statsmodels.stats.outliers_influence import variance_inflation_factor\n\nvif = pd.DataFrame()\nX = X_train_rfe\nvif['Features'] = X.columns\nvif['VIF'] = [variance_inflation_factor(X.values, i) for i in range(X.shape[1])]\nvif['VIF'] = round(vif['VIF'], 2)\nvif = vif.sort_values(by = \"VIF\", ascending = False)\nvif","eb9ae401":"# Dropping curbweight as p-value is high.\nX_train_new1 = X_train_rfe.drop([\"twelve\"], axis = 1)\n\n\n# Adding a constant variable \nimport statsmodels.api as sm  \nX_train_lm = sm.add_constant(X_train_new1)\n\nlm = sm.OLS(y_train,X_train_lm).fit()   # Running the linear model\n\n#Let's see the summary of our linear model\nprint(lm.summary())\n","521a13c6":"# This leaves mileage insignificant.","497ddc89":"# Dropping hardtop as p value is high.\nX_train_new2 = X_train_new1.drop([\"mileage\"], axis = 1)\n\n\n# Adding a constant variable \nimport statsmodels.api as sm  \nX_train_lm = sm.add_constant(X_train_new2)\n\nlm = sm.OLS(y_train,X_train_lm).fit()   # Running the linear model\n\n#Let's see the summary of our linear model\nprint(lm.summary())","a020da80":"# Calculate the VIFs for the new model\nfrom statsmodels.stats.outliers_influence import variance_inflation_factor\n\nvif = pd.DataFrame()\nX = X_train_new2\nvif['Features'] = X.columns\nvif['VIF'] = [variance_inflation_factor(X.values, i) for i in range(X.shape[1])]\nvif['VIF'] = round(vif['VIF'], 2)\nvif = vif.sort_values(by = \"VIF\", ascending = False)\nvif","94fc8162":"# Dropping mileage as p-value is high.\nX_train_new3 = X_train_new2.drop([\"curbweight\"], axis = 1)\n\n\n# Adding a constant variable \nimport statsmodels.api as sm  \nX_train_lm = sm.add_constant(X_train_new3)\n\nlm = sm.OLS(y_train,X_train_lm).fit()   # Running the linear model\n\n#Let's see the summary of our linear model\nprint(lm.summary())","c2a5ad79":"# Calculate the VIFs for the new model\nfrom statsmodels.stats.outliers_influence import variance_inflation_factor\n\nvif = pd.DataFrame()\nX = X_train_new3\nvif['Features'] = X.columns\nvif['VIF'] = [variance_inflation_factor(X.values, i) for i in range(X.shape[1])]\nvif['VIF'] = round(vif['VIF'], 2)\nvif = vif.sort_values(by = \"VIF\", ascending = False)\nvif","1f9c5293":"# Dropping sedan as VIF value is high.\nX_train_new4 = X_train_new3.drop([\"sedan\"], axis = 1)\n\n\n# Adding a constant variable \nimport statsmodels.api as sm  \nX_train_lm = sm.add_constant(X_train_new4)\n\nlm = sm.OLS(y_train,X_train_lm).fit()   # Running the linear model\n\n#Let's see the summary of our linear model\nprint(lm.summary())","70f5448c":"# Dropping wagon as p value is high.\nX_train_new5 = X_train_new4.drop([\"wagon\"], axis = 1)\n\n\n# Adding a constant variable \nimport statsmodels.api as sm  \nX_train_lm = sm.add_constant(X_train_new5)\n\nlm = sm.OLS(y_train,X_train_lm).fit()   # Running the linear model\n\n#Let's see the summary of our linear model\nprint(lm.summary())","218f2e71":"# Calculate the VIFs for the new model\nfrom statsmodels.stats.outliers_influence import variance_inflation_factor\n\nvif = pd.DataFrame()\nX = X_train_new5\nvif['Features'] = X.columns\nvif['VIF'] = [variance_inflation_factor(X.values, i) for i in range(X.shape[1])]\nvif['VIF'] = round(vif['VIF'], 2)\nvif = vif.sort_values(by = \"VIF\", ascending = False)\nvif","7c691a96":"# Dropping dohcv to see if any change in model.\nX_train_new6 = X_train_new5.drop([\"dohcv\"], axis = 1)\n\n\n# Adding a constant variable \nimport statsmodels.api as sm  \nX_train_lm = sm.add_constant(X_train_new6)\n\nlm = sm.OLS(y_train,X_train_lm).fit()   # Running the linear model\n\n#Let's see the summary of our linear model\nprint(lm.summary())","e165e662":"y_train_price = lm.predict(X_train_lm)","afe4e982":"# Plot the histogram of the error terms\nfig = plt.figure()\nsns.distplot((y_train - y_train_price), bins = 20)\nfig.suptitle('Error Terms', fontsize = 20)                  # Plot heading \nplt.xlabel('Errors', fontsize = 18)                         # X-label","77e492ad":"num_vars = ['wheelbase', 'carlength', 'carwidth', 'curbweight', 'enginesize','boreratio', 'horsepower', 'price','mileage']\n\ndf_test[num_vars] = scaler.transform(df_test[num_vars])","536c95c0":"y_test = df_test.pop('price')\nX_test = df_test","5703d145":"# Now let's use our model to make predictions.\n\n# Creating X_test_new dataframe by dropping variables from X_test\nX_test_new = X_test[['carwidth', 'horsepower', 'Luxury', 'hatchback']]\n\n# Adding a constant variable \nX_test_new = sm.add_constant(X_test_new)","990e272c":"# Making predictions\ny_pred = lm.predict(X_test_new)","eee7262d":"from sklearn.metrics import r2_score \nr2_score(y_test, y_pred)","562dcf64":"# Plotting y_test and y_pred to understand the spread.\nfig = plt.figure()\nplt.scatter(y_test,y_pred)\nfig.suptitle('y_test vs y_pred', fontsize=20)              # Plot heading \nplt.xlabel('y_test', fontsize=18)                          # X-label\nplt.ylabel('y_pred', fontsize=16)                          # Y-label","71070096":"## Reading and Understanding Data","c3d8d1ee":"## Model Building","0f3e5e77":"## Visualising the Data","d2c975f1":"### Price : Target Variable","f1867b10":"### Data Inspection","100ebfc1":"### Drivewheel","ba00d59b":"### Car Name","42d899cb":"### Visualising Numeric Variables\n\nLet's make a pairplot of all the numeric variables","2a5e0ae5":"### Dummy Variables","835923d4":"### Car Body","42bc9125":"## Engine Specifications","fefa96a3":"## Making Predictions\nApplying the scaling on the test sets","524961f1":"### Wheel base","7f35417b":"### Rescaling the Features","0184f2bb":"# Prediction of car prices\n\n### Problem Statement\nA Chinese automobile company __Geely Auto__ aspires to enter the US market by setting up their manufacturing unit there and producing cars locally to give competition to their US and European counterparts. \n\nThey have contracted an automobile consulting company to understand the factors on which the pricing of cars depends. Specifically, they want to understand the factors affecting the pricing of cars in the American market, since those may be very different from the Chinese market. \n\n__The company wants to know:__ <br>\nWhich variables are significant in predicting the price of a car.<br>\nHow well those variables describe the price of a car.<br>\n\nBased on various market surveys, the consulting firm has gathered a large dataset of different types of cars across the Americal market. <br>\n\n \n\n### Business Goal \n\nYou are required to model the price of cars with the available independent variables. It will be used by the management to understand how exactly the prices vary with the independent variables. They can accordingly manipulate the design of the cars, the business strategy etc. to meet certain price levels. \nFurther, the model will be a good way for management to understand the pricing dynamics of a new market. \n","4b61d489":"### Car ID","345bf5ec":"### Mileage - Fuel Type","b23dab33":"### Fuel Type","34aa84ea":"### Brand Category - Mileage","a080d248":"## __Exploratory Data Analysis ( EDA )__","5bd194d3":"## City Mileage & Highway Mileage","4dadc3b8":"## Model Evaluation","3fa0b88e":"### Horsepower - Fuel Type","422ac19e":"## Summary Univariate and Bivriate Analysis:\n__From the above Univariate and bivariate analysis we can filter out variables which does not affect price much.__ <br>\n__The most important driver variable for prediction of price are:-__\n1. Brand Category\n2. Fuel Type\n3. Aspiration\n4. Car Body\n5. Drive Wheel\n6. Wheelbase\n7. Car Length\n8. Car Width\n9. Curb weight\n10. Engine Type\n11. Cylinder Number\n12. Engine Size\n13. Bore Ratio\n14. Horsepower\n15. Mileage\n","3a239e9c":"### Data Cleaning","999dfa0a":"### Engine Size, Bore Ratio, Stroke, Horsepower & Compression Ratio","766ee4ad":"### Symboling","eacede11":"### Dividing into X and Y sets for the model building","ec922736":"### Visualising Categorical Variables\n\nLet's make a boxplot for categorical variables.","9f62bd19":"### Aspiration","d6046122":"## Car Dimensions","89609f71":"## Bivariate Analysis","dde2ac35":"### RFE\nRecursive feature elimination","361b3663":"### Building model using statsmodel, for the detailed statistics","c175b784":"## Residual Analysis of the train data\nSo, now to check if the error terms are also normally distributed (which is infact, one of the major assumptions of linear regression), let us plot the histogram of the error terms and see what it looks like.","e1a60f8a":"### Brand Category - Horsepower","dad59df0":"# Linear Regression Model","1328426b":"## Data Preparation","c831958f":"#### We can see that the equation of our best fitted line is:\n\n__price = 0.3957 carwidth + 0.4402 horsepower + 0.2794 luxury -0.0414 hatchback -0.0824__     ","59bed9ca":"### Door Numbers","15e31372":"## Univariate Analysis","ef6747ce":"### Engine Type, Cylinder, Fuel System","eb1489ec":"## Splitting the Data into Training and Testing sets"}}