{"cell_type":{"eac82c55":"code","a97e8eda":"code","d98e1314":"code","bf293615":"code","f1d7a31e":"code","ccb943d6":"code","6c63f787":"code","8ab97412":"code","ae98018d":"code","ea46950e":"code","f80177f1":"code","825b1603":"code","9966575d":"code","9063f0d4":"code","52c3f57b":"code","2fa7c72b":"code","47c01697":"code","ba98e82f":"code","2d153c16":"code","53b099b1":"code","bc5c050b":"code","3236287c":"code","26c8bc3d":"code","13a349e2":"code","d2487a0e":"code","c46f1391":"code","d2e97067":"code","2dab9a7a":"code","3f9cf8e3":"code","b386b8aa":"code","8873c40e":"code","f8652aa0":"code","4e650298":"code","a8bf4047":"code","12e50a5e":"code","588f1d4f":"code","710e0559":"code","29dd481f":"code","ad363b53":"markdown","8f7f5390":"markdown","e66a8fc4":"markdown"},"source":{"eac82c55":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set_style('whitegrid')\n%matplotlib inline\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\n","a97e8eda":"df = pd.read_csv('..\/input\/heart.csv')","d98e1314":"df.shape","bf293615":"df.columns","f1d7a31e":"df.info()","ccb943d6":"df.head()","6c63f787":"plt.figure(figsize=(10,8))\nsns.heatmap(df.corr(),annot=True,linewidths=2,)","8ab97412":"sns.countplot(x='target',data=df,hue='sex')\nplt.legend(['Female','Male'])\nplt.xlabel('-ve Heart Diagnosis                   +ve Heart Diagnosis')","ae98018d":"sns.pairplot(df,hue='target')","ea46950e":"sns.distplot(df['age'],)","f80177f1":"df['age'].describe()","825b1603":"\ndf['Age_Category']= pd.cut(df['age'],bins=list(np.arange(25, 85, 5)))","9966575d":"plt.figure(figsize=(20,5))\n\nplt.subplot(121)\ndf[df['target']==1].groupby('Age_Category')['age'].count().plot(kind='bar')\nplt.title('Age Distribution of Patients with +ve Heart Diagonsis')\n\nplt.subplot(122)\ndf[df['target']==0].groupby('Age_Category')['age'].count().plot(kind='bar')\nplt.title('Age Distribution of Patients with -ve Heart Diagonsis')","9063f0d4":"df.nunique()","52c3f57b":"plt.figure(figsize=(6,5))\nsns.countplot(x='cp',data=df,hue='target')\nplt.xlabel('typical angina     atypical angina     non-anginal pain     asymptomatic')\nplt.ylabel('Counts of Chest pain Type')","2fa7c72b":"plt.figure(figsize=(7,5))\nsns.countplot(x='fbs',data=df,hue='target')\nplt.xlabel('fasting blood sugar < 120 mg\/dl        fasting blood sugar > 120 mg\/dl')\nplt.ylabel('Count')","47c01697":"plt.figure(figsize=(5,5))\nsns.countplot(x='exang',data=df,hue='target')\nplt.xlabel('No                                       Yes')\nplt.ylabel('Count')\nplt.title('Exercise induced angina')","ba98e82f":"df = pd.get_dummies(df,columns=['sex','cp','fbs','restecg','exang','slope','ca','thal','Age_Category'])\n","2d153c16":"df.shape","53b099b1":"df.columns","bc5c050b":"df.drop(['age'],axis=1,inplace=True)","3236287c":"df.shape","26c8bc3d":"y = df['target']\nX = df.drop(['target'],axis=1)","13a349e2":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=5)\n","d2487a0e":"from sklearn.linear_model import LogisticRegression\nlr = LogisticRegression()","c46f1391":"lr.fit(X_train,y_train)","d2e97067":"y_pred = lr.predict(X_test)","2dab9a7a":"from sklearn.metrics import classification_report,accuracy_score,confusion_matrix","3f9cf8e3":"print(classification_report(y_test,y_pred))","b386b8aa":"print(accuracy_score(y_test,y_pred))","8873c40e":"print(confusion_matrix(y_test,y_pred))\n","f8652aa0":"from sklearn.tree import DecisionTreeClassifier\ntrees = DecisionTreeClassifier()","4e650298":"trees.fit(X_train,y_train)\n","a8bf4047":"y_pred = trees.predict(X_test)","12e50a5e":"print(classification_report(y_test,y_pred))\nprint(accuracy_score(y_test,y_pred))\nprint(confusion_matrix(y_test,y_pred))\n","588f1d4f":"from sklearn.ensemble import RandomForestClassifier","710e0559":"rfc = RandomForestClassifier(n_estimators=750)\nrfc.fit(X_train,y_train)\ny_pred = rfc.predict(X_test) ","29dd481f":"print(classification_report(y_test,y_pred))\nprint(accuracy_score(y_test,y_pred))\nprint(confusion_matrix(y_test,y_pred))\n","ad363b53":"Attribute Information:\n\nOnly 14 attributes used: \n1. age : Patient age in years\n2. sex : sex (1 = male; 0 = female)\n3. cp : cp: chest pain type \n                -- Value 1: typical angina \n                -- Value 2: atypical angina \n                -- Value 3: non-anginal pain \n                -- Value 4: asymptomatic\n4. trestbps : resting blood pressure (in mm Hg on admission to the hospital) \n5. chol : serum cholestoral in mg\/dl \n6. fbs : (fasting blood sugar > 120 mg\/dl) (1 = true; 0 = false)\n7. restecg : resting electrocardiographic results \n                -- Value 0: normal \n                -- Value 1: having ST-T wave abnormality (T wave inversions and\/or ST elevation or depression of > 0.05 mV) \n                -- Value 2: showing probable or definite left ventricular hypertrophy by Estes' criteria \n8. thalach :  maximum heart rate achieved \n9. exang : exercise induced angina (1 = yes; 0 = no) \n10. oldpeak : ST depression induced by exercise relative to rest \n11. slope : the slope of the peak exercise ST segment \n               -- Value 1: upsloping \n               -- Value 2: flat \n               -- Value 3: downsloping \n12. ca : number of major vessels (0-3) colored by flourosopy \n13. thal :  3 = normal; 6 = fixed defect; 7 = reversable defect \n14. num (the predicted attribute) : diagnosis of heart disease (angiographic disease status) \n           -- Value 0: < 50% diameter narrowing \n           -- Value 1: > 50% diameter narrowing \n\n","8f7f5390":"# **E.D.A. (Exploratory Data Analysis)**","e66a8fc4":"# Libraries Import"}}