{"cell_type":{"a60975c5":"code","f474a8ba":"code","5c206dfe":"code","a1bbeb3c":"code","1385bd0f":"code","6111f8cd":"code","7c800129":"code","d1cecf9e":"code","4b5fe734":"code","6ff04d13":"code","8ef8389b":"markdown","cdf4bd00":"markdown","6924c12f":"markdown","6290f2e9":"markdown","bf2b2748":"markdown","895c44cb":"markdown","330a2fa3":"markdown","8942da94":"markdown","6447d6a1":"markdown","298c8219":"markdown","5195af95":"markdown","ddee5fd0":"markdown","c1f700f2":"markdown","1a16ec85":"markdown"},"source":{"a60975c5":"import numpy as np \nimport pandas as pd \nimport os\nimport lightgbm as lgb\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import classification_report","f474a8ba":"df = pd.read_csv(\"..\/input\/credit-card-transactions\/credit_card_transactions-ibm_v2.csv\")","5c206dfe":"df.head()","a1bbeb3c":"for col in df.columns:\n    col_type = df[col].dtype\n    if col_type == 'object' or col_type.name == 'category':\n        df[col] = df[col].astype('category')","1385bd0f":"y = df['Is Fraud?']","6111f8cd":"X = df.drop(['Is Fraud?'],axis=1)","7c800129":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.3, random_state = 0, stratify=y)\n","d1cecf9e":"model = lgb.LGBMClassifier()\nmodel.fit(X_train, y_train, feature_name='auto', categorical_feature = 'auto', verbose=50)","4b5fe734":"y_pred=model.predict(X_test)","6ff04d13":"print(classification_report(y_test, y_pred))","8ef8389b":"#### Change datatypes\n\nInorder to use the categorical feature attrribute in LightGBM, the object types need to be converted to the category datatype.","cdf4bd00":"#### Creating Train and Test Datasets\n\nHere the original data is split into 30% test and 70% train with stratification.\nThe proportion of fraudulent transactions is less as compared to the majority of normal transactions. Thus inorder to maintain the proportion of fraudulent and non-fraudulent transactions in the train and test, we split the original data by stratification. ","6924c12f":"From the report we can see that for the minority class, the classifier doesn't perform as well as the majority class in terms of F-1 score.","6290f2e9":"## Credit Card Fraud Detection using LightGBM ","bf2b2748":"#### Load the required libraries ","895c44cb":"A high F-1 score indicates a good balance of high precision as well as high recall. In the credit card transactions scenario, to ensure customers use the credit card and are satisfied with the service, it is necessary to detect fraud (have lower false negatives) but also prevent unecessary blocking since if the card is always blocked, then users may be frustated with the service (have lower false positives). Thus F-1 score is a good metric choice.\n\nAdditionally, since fraudulent transactions are rare, it would also be interesting to look at other metrics such as Precision-Recall curve  and area under this curve along with Matthews Correlation Coefficient.","330a2fa3":"#### Read the data into a dataframe","8942da94":"#### Train a LightGBM Model\n\nInitialize and train a model ","6447d6a1":"This notebook presents a baseline simplistic LightGBM classification model on the Credit Card Fraud Transactions dataset. \nThe LightGBM Classifier predicts whether a transaction is fraudulent or not. \n\n> This notebook goes through all of the steps leading to building a classfier for fraud prediction. It starts with making sure the data types suit the LightGBM model requirements, followed by creation of training a test data and finally building the classifier. \n\n![ml](https:\/\/media.giphy.com\/media\/iPj5oRtJzQGxwzuCKV\/giphy.gif)","298c8219":"From the small sneak peak of the data we can see that the Amount column is represented as a string with the $ symbol and Time can be broken down into hour and minute as new columns","5195af95":"## Possible Improvements\n* Handle class imbalance\n* Feature Engineering\n    * Create attributes from timestamp such as Hour, Minute and Day       of the week\n    * Convert Amount column to float\n* Do hyper-parameter tuning with creation on a validation set for the LightGBM Model\n* Experiment with different types of Machine Learning Models and Deep Learning architectures for better outcomes","ddee5fd0":"In addition to the transactions file, two additional files are available where one provides demographic information about the users and the other provides details about the cards.\n\nIt may be interesting to merge data from all of these files to get more rich features.","c1f700f2":"#### Classification Report","1a16ec85":"Separating the label from the features"}}