{"cell_type":{"849c225f":"code","2392c0a0":"code","cbfaef7d":"code","18ac6eda":"code","fb0cccd2":"code","2506f0a4":"code","ed85ca83":"code","25002d0c":"code","c6b9e16f":"code","bbe0bdb0":"code","80f665c0":"code","59c09b1e":"code","5ad0ce0d":"code","b6ea12dd":"code","4fa3ff4e":"code","461337db":"code","1fd85eb8":"code","49e67fb7":"code","cd389419":"code","760fadfd":"code","bd70ed47":"markdown"},"source":{"849c225f":"#Importing the necessary libraries\n\nimport pandas as pd\nimport numpy as np\nfrom sklearn import metrics\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import confusion_matrix\nfrom nltk.corpus import stopwords\nfrom sklearn.feature_extraction.text import CountVectorizer\nfrom sklearn.naive_bayes import MultinomialNB","2392c0a0":"#Data is tab separated\n#Putting text and type of message into respective label\nurl=\"https:\/\/raw.githubusercontent.com\/tanmaydn\/prml-group007\/master\/SMSSpamCollection?token=AQ6W2IN2KOBQCGJ674JUZLS74NJ6Y\"\ndf=pd.read_csv(url, sep='\\t', header=None, names=['Label', 'Text'])\ndf.value_counts('Label')","cbfaef7d":"df=df.sort_values(by='Label').reset_index(drop=True)\ndf=df[2500:].reset_index(drop=True)\ndf","18ac6eda":"print(len(df))\ndf.isna().any()","fb0cccd2":"sns.countplot(x='Label', data=df)\npd.value_counts(df['Label'])","2506f0a4":"#Text Pre processing","ed85ca83":"Y=df['Label']\nX=df['Text']","25002d0c":"X_train, X_test, Y_train, Y_test=train_test_split(X, Y, test_size=0.2, random_state=56)","c6b9e16f":"X_test","bbe0bdb0":"X_test.reset_index(drop=True)\nX_test[615]='free scholarship worth 1 crore'\nY_test[615]='spam'\nX_test","80f665c0":"cv1=CountVectorizer()\nX_traincv=cv1.fit_transform(X_train, Y_train)\n\na=X_traincv.toarray()\n#print(cv1.get_feature_names())\ncv1.inverse_transform(a[1])","59c09b1e":"cv=CountVectorizer(stop_words='english')\nX_traincv=cv.fit_transform(X_train)\n\nX_testcv=cv.transform(X_test)\nnb_classifier=MultinomialNB()\nnb_classifier.fit(X_traincv, Y_train)","5ad0ce0d":"pred=nb_classifier.predict(X_testcv)\nlen(pred)","b6ea12dd":"pd.DataFrame(pred).value_counts()","4fa3ff4e":"Y_test.value_counts()","461337db":"print(\"Accuracy using Count Vectorizer\", metrics.accuracy_score(Y_test, pred))\n\nprint('Confusion Matrix using Count Vectorizer')\n\nprint(metrics.confusion_matrix(Y_test, pred, labels=['ham', 'spam']))","1fd85eb8":"from sklearn.feature_extraction.text import TfidfVectorizer","49e67fb7":"#Initializing the Vectorizer\ntfidf=TfidfVectorizer()\n\nX_train_tf=tfidf.fit_transform(X_train)\nX_test_tf=tfidf.transform(X_test)","cd389419":"nb_classifier_new=MultinomialNB()\n\nnb_classifier_new.fit(X_train_tf, Y_train)\npred=nb_classifier_new.predict(X_test_tf)\npd.DataFrame(pred).value_counts()","760fadfd":"print(\"Accuracy using Tf idf Vectorizer\", metrics.accuracy_score(Y_test, pred))\n\nprint('Confusion Matrix using Tf idf Vectorizer')\n\nprint(metrics.confusion_matrix(Y_test, pred, labels=['ham', 'spam']))","bd70ed47":"# **Exploratory data Analysis**"}}