{"cell_type":{"7e8dd68f":"code","d26d72a8":"code","033bcc64":"code","84518550":"code","6ad87dd1":"code","c47e5080":"code","edb2bad6":"code","dc8210ef":"code","895edbae":"code","87866929":"code","51730582":"code","42196001":"code","64e7393e":"code","739028a8":"code","84c05939":"code","2edb33b9":"code","35437556":"code","a990027a":"code","c5dd9f3a":"code","b18550bf":"code","c13e7999":"code","ce78459d":"code","8fe977b3":"code","a8042eb6":"code","cb55b5c9":"code","3f9ad464":"code","3da664fe":"code","15e860c1":"code","3df5fd3d":"code","96d3c3df":"code","8f90de01":"code","13e0f34e":"code","f13ab2d9":"code","5c6a6b1d":"code","2064deb3":"code","80bf7421":"code","e0d0b65c":"code","5d2e9d65":"code","6cd78abe":"code","bdd6e354":"code","be96455e":"code","e6316a59":"code","a4e90859":"code","5d970065":"code","ccd39549":"code","ab95491b":"code","90917d26":"code","15d95a9e":"code","c2685e7a":"code","d863188b":"code","398b8376":"code","15e2e94b":"code","8e3377b3":"code","0b8623bd":"markdown","4ffacbf1":"markdown","d7f83fae":"markdown","f33e67de":"markdown","be560552":"markdown","4f8c0c00":"markdown","a9450902":"markdown","e3af2651":"markdown","66db8ca2":"markdown","f3ed442a":"markdown","9b1a5733":"markdown","8bf59028":"markdown","7c7bb63c":"markdown","3e72a790":"markdown","b894953d":"markdown","62d5293d":"markdown","d92f9373":"markdown","57595675":"markdown","df3e1807":"markdown","33e7a149":"markdown","38eff517":"markdown","506cde62":"markdown","33134fc6":"markdown","f9b0204f":"markdown","76f51740":"markdown","7b7fde3c":"markdown","c7d8ec42":"markdown","ba034a21":"markdown","a13269cd":"markdown","53a901b7":"markdown","e824f164":"markdown","7672c3fd":"markdown","069a0c25":"markdown","010ec400":"markdown"},"source":{"7e8dd68f":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom scipy import stats \n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","d26d72a8":"data = pd.read_csv('\/kaggle\/input\/heart-disease-uci\/heart.csv')\ndata.head()","033bcc64":"data.columns = [\"Age\",\"Sex\",\"Chest Pain\",\"Resting BP\",\"Cholestrol\",\"Fasting BS\",\"Resting ECG\",\"Max HR\",\"Exercise Angina\",\"ST Depression\",\"ST Seg Slope\",\"Ca\",\"Th Stress Test\",\"Disease\"]","84518550":"data.describe()","6ad87dd1":"data.info()","c47e5080":"corr = abs(data.corr())\ncorr_with_sorted = corr[['Disease']].sort_values(by='Disease',ascending=False)\ncorr_matrix = corr.loc[corr_with_sorted.index][corr_with_sorted.index]\nmask = np.triu(np.ones_like(corr_matrix,dtype=np.bool))","edb2bad6":"plt.figure(figsize=(16, 8))\nheatmap = sns.heatmap(corr_matrix,annot=True,fmt='.1%',vmin=0,vmax=1,mask=mask)\nheatmap.set_title('Features Correlating with Disease', fontdict={'fontsize':18}, pad=16);","dc8210ef":"df = data.copy()","895edbae":"df['Disease'] = df['Disease'].astype('category')\ndf.Disease.cat.categories","87866929":"df.Disease.cat.categories = ['Yes','No']","51730582":"plt.figure(figsize=(10,5))\nsns.countplot(x='Disease',data=df);","42196001":"sns.displot(x='Cholestrol',hue='Disease',data=df,element='step',kde=True);","64e7393e":"df[df['Cholestrol'] > 400]","739028a8":"df['Resting ECG'] = df['Resting ECG'].astype('category')\ndf['Resting ECG'].cat.categories","84c05939":"df['Resting ECG'].cat.categories = ['Prob left ven. hypertrophy','normal','ST-T wave abnormality']","2edb33b9":"plt.figure(figsize=(10,5))\nsns.countplot(x='Resting ECG', hue='Disease', data=df);","35437556":"df.Sex = df.Sex.astype('category')\ndf.Sex.cat.categories","a990027a":"df.Sex.cat.categories = ['female','male']","c5dd9f3a":"plt.figure(figsize=(10,5))\nsns.countplot(x='Sex',hue='Disease',data=df);","b18550bf":"mapping = {\n    'Age': 'median',\n    'Resting BP' : 'median',\n    'Cholestrol' : 'median',\n    'Resting ECG' : pd.Series.mode,\n    'Max HR' : 'median',\n    'ST Depression' : 'median',\n    'ST Seg Slope' : pd.Series.mode,\n    'Ca' : pd.Series.mode,\n    'Chest Pain': pd.Series.mode,\n    'Exercise Angina' : 'median',\n    'Fasting BS' : pd.Series.mode,\n    'Th Stress Test' : pd.Series.mode\n}","c13e7999":"df.groupby('Sex').aggregate(mapping)","ce78459d":"print(df.query(\"Sex == 'male' and `Resting ECG` != 'normal'\").shape[0]\/df.query(\"Sex == 'male' and `Resting ECG` == 'normal'\").shape[0])\nprint(df.query(\"Sex == 'female' and `Resting ECG` != 'normal'\").shape[0]\/df.query(\"Sex == 'female' and `Resting ECG` == 'normal'\").shape[0])","8fe977b3":"plt.figure(figsize=(10,5))\nsns.countplot(x='Exercise Angina',hue='Disease',data=df);","a8042eb6":"df['Chest Pain'] = df['Chest Pain'].astype('category')\ndf['Chest Pain'].cat.categories","cb55b5c9":"df['Chest Pain'].cat.categories = ['asymptomatic','atypical angina','non-anginal pain','typical angina']","3f9ad464":"fig,ax = plt.subplots(nrows=1,ncols=2,sharey=True,figsize=(10,5))\nsns.countplot(x='Disease',hue='Chest Pain',data=df,ax=ax[0])\nsns.countplot(x='Chest Pain',data=df,ax=ax[1])\nax[1].tick_params(axis=\"x\", rotation=50)","3da664fe":"f, ax = plt.subplots(1,3,sharey=True,sharex=True,figsize=(18,6))\nsns.histplot(x= 'Max HR',data=df,hue='Disease',element='step',ax=ax[0])\nsns.histplot(x= df[df['Disease'] == 'Yes']['Max HR'], element='step',ax=ax[1])\nsns.histplot(x= df[df['Disease'] == 'No']['Max HR'], element='step',ax=ax[2],color=sns.color_palette(\"rocket\")[-1])\nax[1].legend(['Disease'])\nax[2].legend(['No Disease']);","15e860c1":"hr_cat = pd.cut(df['Max HR'],bins = [0,160,220])\ndf.pivot_table(values='Age',index=hr_cat,columns='Disease',aggfunc='median')","3df5fd3d":"sns.displot(x='ST Depression',hue='Disease',data=df);","96d3c3df":"print(f\"Skew Before: {df['ST Depression'].skew()}\")\ndf['ST Depression'] = np.log1p(df['ST Depression'])\nprint(f\"Skew After: {df['ST Depression'].skew()}\")","8f90de01":"plt.figure(figsize=(10,5))\nsns.histplot(x='ST Depression',hue='Disease',data=df,multiple='stack');","13e0f34e":"plt.figure(figsize=(10,5))\nsns.histplot(x='Age',hue='Disease',data=df,element='step');","f13ab2d9":"df.drop(df[df['Ca'] == 4].index,axis=0,inplace=True)","5c6a6b1d":"plt.figure(figsize=(10,5))\nsns.countplot(x='Ca',hue='Disease',data=df);","2064deb3":"df.drop(df[df['Th Stress Test'] == 0].index,axis=0,inplace=True)","80bf7421":"df['Th Stress Test'] = df['Th Stress Test'].astype('category')\ndf['Th Stress Test'].cat.categories","e0d0b65c":"df['Th Stress Test'].cat.categories = ['fixed defect','normal','reversable defect']","5d2e9d65":"f,ax = plt.subplots(1,2,figsize=(10,5),sharey=True)\nsns.countplot(x='Th Stress Test',data=df,ax=ax[0])\nsns.countplot(x='Disease',hue='Th Stress Test',data=df,ax=ax[1])\nax[0].tick_params(axis='x',rotation=30);","6cd78abe":"df['ST Seg Slope'] = df['ST Seg Slope'].astype('category')\ndf['ST Seg Slope'].cat.categories","bdd6e354":"df['ST Seg Slope'].cat.categories = ['downsloping', 'flat','upsloping']","be96455e":"plt.figure(figsize=(10,5))\nsns.countplot(x='ST Seg Slope',hue='Disease',data=df);","e6316a59":"f,ax = plt.subplots(1,2,figsize=(18,6))\nsns.boxplot(y='ST Depression',x='ST Seg Slope',data=df,ax=ax[0])\nsns.boxplot(y='ST Depression',x='ST Seg Slope',hue='Disease',data=df,ax=ax[1]);","a4e90859":"from sklearn.preprocessing import OneHotEncoder,StandardScaler\nfrom sklearn.pipeline import make_pipeline\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.base import BaseEstimator, TransformerMixin","5d970065":"data.drop(data.query('Ca == 4 or `Th Stress Test` == 0').index,axis=0,inplace=True)","ccd39549":"nominal_pip = make_pipeline(OneHotEncoder())","ab95491b":"class ReorderOrdinalFeatures(BaseEstimator, TransformerMixin):\n    def __init__(self,ecg=True,th=True):\n        self.ecg = ecg\n        self.th = th\n    def fit(self,X,y=None):\n        return self\n    def transform(self,X):\n        if self.ecg:\n            # 'Prob left ven. hypertrophy','normal','ST-T wave abnormality'\n            #       0                          1             2\n            #       1                          0             2\n            X['Resting ECG'] = X['Resting ECG'].replace({0:1,1:0})\n        \n        if self.th:\n            # 'fixed defect','normal','reversable defect'\n            #       0           1            2\n            #       2           0            1\n            X['Th Stress Test'] = X['Th Stress Test'].replace({1:0,0:2,2:1})\n        return X","90917d26":"ordianl_pip = make_pipeline(ReorderOrdinalFeatures())","15d95a9e":"numarical_pip = make_pipeline(StandardScaler())","c2685e7a":"nominal_att = ['Sex','Fasting BS', 'ST Seg Slope']\nordinal_att = ['Chest Pain','Resting ECG','Th Stress Test','Ca']\nnumarical_att = ['Age','ST Depression','Max HR','Cholestrol','Resting BP']","d863188b":"full_pipeline = ColumnTransformer([\n    ('nom_cat',nominal_pip,nominal_att),\n    ('ord_cat',ordianl_pip,ordinal_att),\n    ('numarical',numarical_pip,numarical_att)\n])","398b8376":"X = data.drop('Disease',axis=1) \ny = data.Disease.replace({\"YES\":1,'NO':0})","15e2e94b":"X_prep = full_pipeline.fit_transform(X)","8e3377b3":"pd.DataFrame(X_prep).head()","0b8623bd":"* Significant Displacement from ST segment is indicator of Heart Diseses.   ","4ffacbf1":"### Sex","d7f83fae":"* Exercise Angina, Chest Pain, Maximum Heart Rate, ST Depression etc are highly realted with Disease.\n* Age and gender are also factors which can contribute to heart problems.\n* Commonly gussed features which contribute to Disease such as Fasting Blood Sugar & Cholestrol show less impact in this data.\n* There is also multi collinearity between features especially ST Seg Slope & ST Deppression which is obvious.","f33e67de":"*  From this we can mark that is a person has Downsloping Slope of Segment than Hear Disease can be decided by using ST depression.\n> If Depession < 1.25 person has greater chances of no Heart Disease.\n\n   > If Depession > 1.25 person has greater chances of Heart Disease.","be560552":"*  Here we can se that most cases are of asymptomatic heart patients, this also because of class dominance to some extent.\n*  Thus is can be said that it is difficult to say about heart diseases from patient symptoms.","4f8c0c00":"* We can see that median age for 160 < Heart Rate < 220 is 48","a9450902":"* Higher Rate of heart disease in male gender.\n> Lets see if this trend is cause of class imbalance or some solid reason","e3af2651":"### Collinear Features\n> ST Dipression & ST Seg Slope","66db8ca2":"### ST Depression","f3ed442a":"### Th Stress Test","9b1a5733":"* Comapring ECG we can se males have greater ratio of abnormal ECG as compared to females","8bf59028":"# Data Analysis","7c7bb63c":"### CA","3e72a790":"* With increse in Age risk of Heart Related Problems also increse.\n* Rise in Heart Diseases in Group 55 - 65 could be due to fact that people with unhealty life style during 30's and 40's may get problems in this period of Age. ","b894953d":"### Max Heart Rate","62d5293d":"### ECG","d92f9373":"## About Feature\n    |\n    \n    1. Age      :  Age of patient\n    2. Sex      :  Gender\n    3. cp       :  Chest Pain Intensity\n    4. trestbps :  Resting Blood Pressure\n                   Measure of BP when after resting for few minutes.\n                   High RBP can be indication of some disese.\n    5. chol     :  Cholestrol\n    6. fbs      :  Fasting Blood Sugar\n                   High fasting blood sugar levels point to insulin resistance or diabetes,\n                   while abnormally low fasting blood sugar could be due to diabetes medications.\n    7. restecg  :  A resting ECG is administered when the patient is at rest.\n                   The dimensions and regularity or irregularity of these lines,\n                   communicates the nature of the patient\u2019s heart activity. \n    8. thalach  :  Max Heart Rate\n    9. exang    :  Angina is generally caused from not getting enough blood through the arteries.\n                   Angina can be caused by blockage, injury or spasms.\n    10. oldpeak :  ST depression refers to a finding on an electrocardiogram,\n                   wherein the trace in the ST segment is abnormally low below the baseline.\n                   During Exercise realtive to Rest\n    11. slope   :  the slope of the peak exercise ST segment\n    12. ca      :  number of major vessels (0-3) colored by flourosopy\n    13. thal    :  A thallium stress test is a nuclear imaging test that shows how well blood flows into your heart.\n    \n    |","57595675":"### Exercise Enduced Angina","df3e1807":"### Chest Pain","33e7a149":"* Data is quite Balanced and we have only 0\/1 binary target","38eff517":"*Nominal Categorical Columns*\n* Sex\n* Fasting BS\n* Slope\n\n*Ordinal Categorical Columns*\n\n* Chest Pain\n* Rest ECG\n* Th Stress Test\n* Ca","506cde62":"# Feature Engineering","33134fc6":"### Cholestrol","f9b0204f":"### Correlation","76f51740":"### ST Segment Slope","7b7fde3c":"## Realtion With Features","c7d8ec42":"* The overall trend here is that chances of heart disease increse with level of cholestrol, but at a particular interval people may have disease or not 'cause higher chol level can be because of diet and not fasting before test.\n\n> Values with Cholestrol levels 400+ lets check them. Here also we can see that this level of chol is very high and cause of heat disease but cases also so no disease","ba034a21":"* Higher count of coloured vessels ie. blocked\/narrow greater risk of heart disease.","a13269cd":"### Target Feature","53a901b7":"* If Angina is caused during exercise reslative to rest it is a indicator or heart disease","e824f164":"* It can be unusual to see that higher heart rate causes less heart problems but HR depends on age and these high heart rates are from young peps.","7672c3fd":"### Age","069a0c25":"*  If Th Test is abnormal greater chances of Heart disease.","010ec400":"About Dataset Feature Refer This [Guide](http:\/\/www.kaggle.com\/ronitf\/heart-disease-uci\/discussion\/105877)."}}