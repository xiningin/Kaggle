{"cell_type":{"f19795ca":"code","0dbb51f0":"code","661ee626":"code","08bed5eb":"code","065f8a8f":"code","3acc04a4":"code","d2b0b1ac":"code","da55264e":"code","3cb90357":"code","29336aa9":"code","939bdb63":"code","93ea8c95":"code","505aca7d":"code","f096c45b":"code","fd98dd9f":"code","321910c9":"code","8c2fb828":"code","92adfc0f":"code","03b3d46c":"code","eb7161ad":"code","29a4a82a":"code","7003ce1a":"code","1dc3c1b0":"code","fd359c36":"code","824329d7":"code","07fe6988":"code","cc0f6102":"code","86c379b9":"code","f9355615":"markdown","2d7b061d":"markdown","0c6b9b33":"markdown","2b31b09c":"markdown","ec15548d":"markdown","4ba93f44":"markdown"},"source":{"f19795ca":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","0dbb51f0":"!pip install scipy","661ee626":"from scipy.stats import spearmanr","08bed5eb":"train_nlp = pd.read_csv(open('train.csv', 'rb'))\ntest_nlp = pd.read_csv(open('test.csv', 'rb'))\nsample_sub_nlp = pd.read_csv(open('sample_submission.csv', 'rb'))","065f8a8f":"train_nlp.head(2)","3acc04a4":"test_nlp.head(2)","d2b0b1ac":"print(train_nlp.columns.tolist())","da55264e":"from sklearn.feature_extraction.text import CountVectorizer\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import ensemble \nfrom sklearn.metrics import classification_report, accuracy_score","3cb90357":"train_nlp['nReview'] =train_nlp['Review'].fillna(value='')\ntest_nlp['nReview'] =test_nlp['Review'].fillna(value='')\ntrain_nlp['nReview_Title'] =train_nlp['Review_Title'].fillna(value='')\ntest_nlp['nReview_Title'] =test_nlp['Review_Title'].fillna(value='')","29336aa9":"train_nlp['nReview'] = train_nlp['nReview'].apply(lambda x: \" \".join(x.lower() for x in x.split()))\ntest_nlp['nReview'] = test_nlp['nReview'].apply(lambda x: \" \".join(x.lower() for x in x.split()))\ntrain_nlp['nReview_Title'] = train_nlp['nReview_Title'].apply(lambda x: \" \".join(x.lower() for x in x.split()))\ntest_nlp['nReview_Title'] = test_nlp['nReview_Title'].apply(lambda x: \" \".join(x.lower() for x in x.split()))","939bdb63":"cv = CountVectorizer()\ntext_vec = cv.fit_transform(train_nlp['nReview'])\ny = train_nlp[['Recommended', 'Rating']]\nX_train, X_test, y_train, y_test = train_test_split(text_vec, y , test_size = 0.45, random_state = 42, shuffle = True)","93ea8c95":"test_vec = cv.transform(test_nlp['nReview'])","505aca7d":"#sparce matrix to dense matrix\nX_train.todense()","f096c45b":"from sklearn.naive_bayes import MultinomialNB","fd98dd9f":"MNB = MultinomialNB()","321910c9":"MNB.fit(X_train,y_train['Recommended'])","8c2fb828":"y_pred = MNB.predict(X_test)","92adfc0f":"y_pred_proba = MNB.predict_proba(X_test)[:,1]","03b3d46c":"spearmanr(y_test['Recommended'], y_pred_proba >= 0.58)","eb7161ad":" y_test_pred = MNB.predict(test_vec)","29a4a82a":" y_test_pred_proba = MNB.predict_proba(test_vec)[:,1]","7003ce1a":"MNB_r = MultinomialNB()","1dc3c1b0":"MNB_r.fit(X_train,y_train['Rating'])","fd359c36":"y_r_pred = MNB_r.predict(X_test)","824329d7":"spearmanr(y_test['Rating'], y_r_pred)","07fe6988":"y_testr_pred = MNB_r.predict(test_vec)","cc0f6102":"df = pd.DataFrame()\ndf['Id'] = test_nlp['Id']\ndf['Rating'] = y_testr_pred\ndf['Recommended'] = (y_test_pred_proba >= 0.58).astype('int64')\n\ndf.to_csv('MNB.csv')","86c379b9":"# Import a module to display a link to the file\nfrom IPython.display import FileLink\n# Import a module to delete the file\/l\nimport os\n# Create a download function\ndef csv_download_link(df, csv_file_name, delete_prompt=True):\n    \"\"\"Display a download link to load a data frame as csv within a Jupyter notebook\n\n    Parameters\n    ----------\n    df : pandas data frame\n    csv_file_name : str\n    delete_prompt : bool\n    \"\"\"\n    df.to_csv(csv_file_name, index=False)\n    display(FileLink(csv_file_name))\n    if delete_prompt:\n        a = input('Press enter to delete the file after you have downloaded it.')\n        os.remove(csv_file_name)\ncsv_download_link(df, 'MNB_proba.csv')","f9355615":"# Analysis and Preprocessing","2d7b061d":"# Importing datasets","0c6b9b33":"# Importing and Installing Packages","2b31b09c":"# Predict on Test Dataset","ec15548d":"# Modelling","4ba93f44":"# Download Dataset"}}