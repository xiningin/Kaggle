{"cell_type":{"3cb433f4":"code","dec4d607":"code","96e7e767":"code","878042b3":"code","95d21dc1":"code","c935948b":"code","0a0d36a4":"code","79026e3f":"code","23be2d5f":"code","17a804c9":"code","1db6110e":"code","d1dc4f0b":"code","f2c25445":"code","7c9fb2d4":"code","283844a9":"code","4ad5e338":"code","765ec28d":"code","e7b27488":"code","8183d69e":"code","6ccb6c67":"code","ca7bfd37":"code","f3c6091b":"code","2b2c6fdd":"code","16bc9853":"code","f381fa3e":"code","2d25f810":"code","e40cf4d7":"code","9516a7b3":"code","829421ae":"code","bafe07ba":"code","019fa73d":"code","a7daa64f":"code","1f80042e":"code","37817994":"code","0a971991":"code","636ab90c":"code","599a9a88":"code","57f60dbd":"code","f6391685":"code","c01bd6c3":"code","8a26ef73":"code","ef5be1a2":"code","cd69a6aa":"code","067b28a8":"code","921ce794":"markdown","2179d43c":"markdown","950aff6a":"markdown","5fadaabe":"markdown","b6797c9d":"markdown","a8fba973":"markdown","056eefdf":"markdown","f5071972":"markdown","b776f9af":"markdown","90ce5b6c":"markdown","43169aaf":"markdown","0c7a7658":"markdown","af08beeb":"markdown","d7580b9c":"markdown","b19ca1dc":"markdown","68fcb73d":"markdown","007ebf1b":"markdown","f344c602":"markdown","e33bd268":"markdown","fd478e51":"markdown","576ce322":"markdown","679ad641":"markdown","8b0a63c1":"markdown","81e85409":"markdown","d81d4237":"markdown","a462ce61":"markdown","020ce2ae":"markdown","f399fbc0":"markdown","f92cc850":"markdown","212ae729":"markdown","689e5b55":"markdown","5af4fd23":"markdown","b12d011d":"markdown","b29b5f9b":"markdown","16ff134a":"markdown","674926fe":"markdown","0fdb460c":"markdown","7de10018":"markdown","6db7b322":"markdown","b584620f":"markdown"},"source":{"3cb433f4":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport datetime\nfrom sklearn import preprocessing\nfrom scipy.optimize import curve_fit\nfrom scipy.optimize import fsolve\nimport sklearn.metrics as metrics\nimport plotly.express as px\nfrom pandas.plotting import table\nfrom statsmodels.graphics.gofplots import qqplot\nfrom scipy.stats import shapiro\nimport warnings\nwarnings.filterwarnings('ignore')\nimport os\nprint(os.listdir(\"..\/input\"))\nnp.random.seed(100)","dec4d607":"train = pd.read_csv(\"..\/input\/covid19-global-forecasting-week-3\/train.csv\", na_values=['']) \ntest = pd.read_csv(\"..\/input\/covid19-global-forecasting-week-3\/test.csv\") ","96e7e767":"train.info()\ntrain.shape","878042b3":"test.info()\ntest.shape","95d21dc1":"train.ConfirmedCases = train.ConfirmedCases.astype(int)\ntrain.Fatalities = train.Fatalities.astype(int)","c935948b":"train[\"Date\"] = train[\"Date\"].apply(pd.to_datetime, \"%m\/%d\/%Y\")\ntest[\"Date\"] = test[\"Date\"].apply(pd.to_datetime, \"%m\/%d\/%Y\")","0a0d36a4":"test.shape","79026e3f":"desc = train.describe()\n#create a subplot without frame\nplot = plt.subplot(111, frame_on=False)\n\n#remove axis\nplot.xaxis.set_visible(False) \nplot.yaxis.set_visible(False) \n\n#create the table plot and position it in the upper left corner\ntable(plot, desc,loc='upper right')\n\n#save the plot as a png file\nplt.savefig('mytable.png')","23be2d5f":"train.groupby(\"Date\").agg({\"ConfirmedCases\":[\"sum\"],\"Fatalities\":[\"sum\"]}).plot(kind=\"line\", figsize=(12,7),marker =\"s\",linewidth=2)\nplt.xlabel(\"Date\", fontsize=20)\nplt.ylabel(\"Number of cases\", fontsize=20)\nplt.title(\"COVID19 Confirmed Cases and Fatalities since Jan 22,2020\",fontsize=25)\nplt.bar(train.groupby(\"Date\").agg({\"ConfirmedCases\":[\"sum\"],\"Fatalities\":[\"sum\"]}).index, train.groupby(\"Date\").sum()[\"ConfirmedCases\"],alpha=0.1,color=\"b\")\nplt.savefig(\"Worldwide\")\nplt.show()\n","17a804c9":"US_confirmed = train[train[\"Country_Region\"]==\"US\"].groupby([\"Date\"]).agg({\"ConfirmedCases\":[\"sum\"]})\nUS_fatalities = train[train[\"Country_Region\"]==\"US\"].groupby([\"Date\"]).agg({\"Fatalities\":[\"sum\"]})\nUS_cases = US_confirmed.join(US_fatalities)\n\nplt.figure(figsize=(15,15))\nplt.subplot(3, 2, 1)\nUS_cases.plot(ax=plt.gca(),marker =\"s\",linewidth=1, title='US Cases')\nplt.bar(train[train[\"Country_Region\"]==\"US\"].groupby(\"Date\").sum()[[\"ConfirmedCases\",\"Fatalities\"]].index, train[train[\"Country_Region\"]==\"US\"].groupby(\"Date\").sum()[\"ConfirmedCases\"],alpha=0.1,color=\"b\")\nplt.ylabel(\"Number of cases\", size=10)\nplt.xlim(datetime.date(2020, 3, 7))\n\nMX_confirmed = train[train[\"Country_Region\"]==\"Mexico\"].groupby([\"Date\"]).agg({\"ConfirmedCases\":[\"sum\"]})\nMX_fatalities = train[train[\"Country_Region\"]==\"Mexico\"].groupby([\"Date\"]).agg({\"Fatalities\":[\"sum\"]})\nMX_cases = MX_confirmed.join(MX_fatalities)\n\nplt.subplot(3, 2, 2)\nMX_cases.plot(ax=plt.gca(),marker =\"s\",linewidth=1, title='Mexico Cases')\nplt.bar(train[train[\"Country_Region\"]==\"Mexico\"].groupby(\"Date\").sum()[[\"ConfirmedCases\",\"Fatalities\"]].index, train[train[\"Country_Region\"]==\"Mexico\"].groupby(\"Date\").sum()[\"ConfirmedCases\"],alpha=0.1,color=\"brown\")\nplt.xlim(datetime.date(2020, 2, 24))\n\nCN_confirmed = train[train[\"Country_Region\"]==\"Canada\"].groupby([\"Date\"]).agg({\"ConfirmedCases\":[\"sum\"]})\nCN_fatalities = train[train[\"Country_Region\"]==\"Canada\"].groupby([\"Date\"]).agg({\"Fatalities\":[\"sum\"]})\nCN_cases = CN_confirmed.join(CN_fatalities)\n\nplt.subplot(3, 2, 3)\nCN_cases.plot(ax=plt.gca(),marker =\"s\",linewidth=1, title='Canada Cases')\nplt.bar(train[train[\"Country_Region\"]==\"Canada\"].groupby(\"Date\").sum()[[\"ConfirmedCases\",\"Fatalities\"]].index, train[train[\"Country_Region\"]==\"Canada\"].groupby(\"Date\").sum()[\"ConfirmedCases\"],alpha=0.1,color=\"orange\")\nplt.xlim(datetime.date(2020, 2, 24))\nplt.xlabel(\"Date\", fontsize=10)\nplt.ylabel(\"Number of cases\", size=10)\n\nCH_confirmed = train[train[\"Country_Region\"]==\"China\"].groupby([\"Date\"]).agg({\"ConfirmedCases\":[\"sum\"]})\nCH_fatalities = train[train[\"Country_Region\"]==\"China\"].groupby([\"Date\"]).agg({\"Fatalities\":[\"sum\"]})\nCH_cases = CH_confirmed.join(CH_fatalities)\n\nplt.subplot(3, 2, 4)\nCH_cases.plot(ax=plt.gca(),marker =\"s\",linewidth=1, title='China Cases')\nplt.bar(train[train[\"Country_Region\"]==\"China\"].groupby(\"Date\").sum()[[\"ConfirmedCases\",\"Fatalities\"]].index, train[train[\"Country_Region\"]==\"China\"].groupby(\"Date\").sum()[\"ConfirmedCases\"],alpha=0.1,color=\"green\")\nplt.xlabel(\"Date\", fontsize=10)\n\nIT_confirmed = train[train[\"Country_Region\"]==\"Italy\"].groupby([\"Date\"]).agg({\"ConfirmedCases\":[\"sum\"]})\nIT_fatalities = train[train[\"Country_Region\"]==\"Italy\"].groupby([\"Date\"]).agg({\"Fatalities\":[\"sum\"]})\nIT_cases = IT_confirmed.join(IT_fatalities)\n\nplt.subplot(3, 2, 5)\nIT_cases.plot(ax=plt.gca(),marker =\"s\",linewidth=1, title='Italy Cases')\nplt.bar(train[train[\"Country_Region\"]==\"Italy\"].groupby(\"Date\").sum()[[\"ConfirmedCases\",\"Fatalities\"]].index, train[train[\"Country_Region\"]==\"Italy\"].groupby(\"Date\").sum()[\"ConfirmedCases\"],alpha=0.1,color=\"magenta\")\nplt.xlabel(\"Date\", fontsize=10)\nplt.ylabel(\"Number of cases\", size=10)\n\nIN_confirmed = train[train[\"Country_Region\"]==\"Iran\"].groupby([\"Date\"]).agg({\"ConfirmedCases\":[\"sum\"]})\nIN_fatalities = train[train[\"Country_Region\"]==\"Iran\"].groupby([\"Date\"]).agg({\"Fatalities\":[\"sum\"]})\nIN_cases = IN_confirmed.join(IN_fatalities)\n\nplt.subplot(3, 2, 6)\nIN_cases.plot(ax=plt.gca(),marker =\"s\",linewidth=1, title='Iran Cases')\nplt.bar(train[train[\"Country_Region\"]==\"Iran\"].groupby(\"Date\").sum()[[\"ConfirmedCases\",\"Fatalities\"]].index, train[train[\"Country_Region\"]==\"Iran\"].groupby(\"Date\").sum()[\"ConfirmedCases\"],alpha=0.1,color=\"pink\")\nplt.xlabel(\"Date\", fontsize=10)\nplt.tight_layout(3.0)\nplt.savefig('myfigCountry')","1db6110e":"US_confirmed_dates = train[(train[\"Country_Region\"]==\"US\")].groupby([\"Date\"]).agg({\"ConfirmedCases\":[\"sum\"]})\nUS_fatalities_dates = train[(train[\"Country_Region\"]==\"US\")].groupby([\"Date\"]).agg({\"Fatalities\":[\"sum\"]})\nUS_cases_dates = US_confirmed_dates.join(US_fatalities_dates)\n\nMX_confirmed_dates = train[(train[\"Country_Region\"]==\"Mexico\") & train[\"ConfirmedCases\"]>0].groupby([\"Date\"]).agg({\"ConfirmedCases\":[\"sum\"]})\nMX_fatalities_dates = train[(train[\"Country_Region\"]==\"Mexico\") & train[\"ConfirmedCases\"]>0].groupby([\"Date\"]).agg({\"Fatalities\":[\"sum\"]})\nMX_cases_dates = MX_confirmed_dates.join(MX_fatalities_dates)\n\nCN_confirmed_dates = train[(train[\"Country_Region\"]==\"Canada\") & train[\"ConfirmedCases\"]>0].groupby([\"Date\"]).agg({\"ConfirmedCases\":[\"sum\"]})\nCN_fatalities_dates = train[(train[\"Country_Region\"]==\"Canada\") & train[\"ConfirmedCases\"]>0].groupby([\"Date\"]).agg({\"Fatalities\":[\"sum\"]})\nCN_cases_dates = CN_confirmed_dates.join(CN_fatalities_dates)\n\nCH_confirmed_dates = train[(train[\"Country_Region\"]==\"China\")].groupby([\"Date\"]).agg({\"ConfirmedCases\":[\"sum\"]})\nCH_fatalities_dates = train[(train[\"Country_Region\"]==\"China\")].groupby([\"Date\"]).agg({\"Fatalities\":[\"sum\"]})\nCH_cases_dates = CH_confirmed_dates.join(CH_fatalities_dates)\n\nIT_confirmed_dates = train[(train[\"Country_Region\"]==\"Italy\") & train[\"ConfirmedCases\"]>0].groupby([\"Date\"]).agg({\"ConfirmedCases\":[\"sum\"]})\nIT_fatalities_dates = train[(train[\"Country_Region\"]==\"Italy\") & train[\"ConfirmedCases\"]>0].groupby([\"Date\"]).agg({\"Fatalities\":[\"sum\"]})\nIT_cases_dates = IT_confirmed_dates.join(IT_fatalities_dates)\n\nIN_confirmed_dates = train[(train[\"Country_Region\"]==\"Iran\") & train[\"ConfirmedCases\"]>0].groupby([\"Date\"]).agg({\"ConfirmedCases\":[\"sum\"]})\nIN_fatalities_dates = train[(train[\"Country_Region\"]==\"Iran\") & train[\"ConfirmedCases\"]>0].groupby([\"Date\"]).agg({\"Fatalities\":[\"sum\"]})\nIN_cases_dates = IN_confirmed_dates.join(IN_fatalities_dates)\n\nUS = [e0 for e0 in US_cases_dates.ConfirmedCases['sum'].values]\nUS = US[49:]\nMX = [e1 for e1 in MX_cases_dates.ConfirmedCases['sum'].values]\nCN = [e2 for e2 in CN_cases_dates.ConfirmedCases['sum'].values]\nCH = [e3 for e3 in CH_cases_dates.ConfirmedCases['sum'].values]\nIT = [e2 for e2 in IT_cases_dates.ConfirmedCases['sum'].values]\nIN = [e2 for e2 in IN_cases_dates.ConfirmedCases['sum'].values]\n\n# Plots\nplt.figure(figsize=(12,6))\nplt.plot(US)\nplt.plot(MX)\nplt.plot(CN)\nplt.plot(CH)\nplt.plot(IT)\nplt.plot(IN)\nplt.legend([\"US\", \"Mexico\", \"Canada\", \"China\",\"Italy\",\"Iran\"], loc='upper left')\nplt.title(\"Confirmed cases of COVID19\", size=15)\nplt.xlabel(\"Date\", size=13)\nplt.ylabel(\"Number of cases\", size=13)\nplt.ylim(0, 100000)\nplt.xlim(0, 19)\nplt.show()","d1dc4f0b":"US_fatalities = [e0 for e0 in US_cases_dates.Fatalities['sum'].values]\nMX_fatalities = [e1 for e1 in MX_cases_dates.Fatalities['sum'].values]\nCN_fatalities = [e2 for e2 in CN_cases_dates.Fatalities['sum'].values]\nCH_fatalities = [e3 for e3 in CH_cases_dates.Fatalities['sum'].values]\nIT_fatalities = [e3 for e3 in IT_cases_dates.Fatalities['sum'].values]\nIN_fatalities = [e3 for e3 in IN_cases_dates.Fatalities['sum'].values]\n\n\nplt.figure(figsize=(12,6))\nplt.plot(US_fatalities)\nplt.plot(MX_fatalities)\nplt.plot(CN_fatalities)\nplt.plot(CH_fatalities)\nplt.plot(IT_fatalities)\nplt.plot(IN_fatalities)\n\nplt.legend([\"US\", \"Mexico\", \"Canada\",\"China\",\"Italy\",\"Iran\"], loc='upper left')\nplt.title(\"Fatalities of COVID19\", size=15)\nplt.xlabel(\"Date\", size=13)\nplt.ylabel(\"Number of cases\", size=13)\nplt.show()","f2c25445":"US_cases_ratio = US_cases[datetime.date(2020, 3, 10):]\nMX_cases_ratio = MX_cases[datetime.date(2020, 3, 19):]\nCN_cases_ratio = CN_cases[datetime.date(2020, 3, 9):]\nCH_cases_ratio = CH_cases[:datetime.date(2020, 3, 22)]\nIN_cases_ratio = IN_cases[datetime.date(2020, 2, 19):]\nIT_cases_ratio = IT_cases[datetime.date(2020, 2, 22):]\nUS_cases_ratio.columns = US_cases_ratio.columns.droplevel(level=1)\nMX_cases_ratio.columns = MX_cases_ratio.columns.droplevel(level=1)\nCN_cases_ratio.columns = CN_cases_ratio.columns.droplevel(level=1)\nCH_cases_ratio.columns = CH_cases_ratio.columns.droplevel(level=1)\nIN_cases_ratio.columns = IN_cases_ratio.columns.droplevel(level=1)\nIT_cases_ratio.columns = IT_cases_ratio.columns.droplevel(level=1)\nUS_cases_ratio = US_cases_ratio.reset_index()\nMX_cases_ratio = MX_cases_ratio.reset_index()\nCN_cases_ratio = CN_cases_ratio.reset_index()\nCH_cases_ratio = CH_cases_ratio.reset_index()\nIN_cases_ratio = IN_cases_ratio.reset_index()\nIT_cases_ratio = IT_cases_ratio.reset_index()\n\nUS_cases_ratio[\"Fatalities_difference\"] = 0\nUS_cases_ratio[\"Fatalities_trend\"] = 0.0\nMX_cases_ratio[\"Fatalities_difference\"] = 0\nMX_cases_ratio[\"Fatalities_trend\"] = 0.0\nCN_cases_ratio[\"Fatalities_difference\"] = 0\nCN_cases_ratio[\"Fatalities_trend\"] = 0.0\nCH_cases_ratio[\"Fatalities_difference\"] = 0\nCH_cases_ratio[\"Fatalities_trend\"] = 0.0\nIT_cases_ratio[\"Fatalities_difference\"] = 0\nIN_cases_ratio[\"Fatalities_trend\"] = 0.0\nIT_cases_ratio[\"Fatalities_difference\"] = 0\nIT_cases_ratio[\"Fatalities_trend\"] = 0.0","7c9fb2d4":"for element in range(1, US_cases_ratio.shape[0]):\n    US_cases_ratio.at[US_cases_ratio.index[element], \"Fatalities_difference\"] = US_cases_ratio.iloc[element][\"Fatalities\"]-US_cases_ratio.iloc[element-1][\"Fatalities\"]\n    US_cases_ratio.at[US_cases_ratio.index[element], \"Fatalities_trend\"] = US_cases_ratio.iloc[element][\"Fatalities_difference\"]\/US_cases_ratio.iloc[element-1][\"Fatalities\"]\n\nfor element in range(1, MX_cases_ratio.shape[0]):\n    MX_cases_ratio.at[MX_cases_ratio.index[element], \"Fatalities_difference\"] = MX_cases_ratio.iloc[element][\"Fatalities\"]-MX_cases_ratio.iloc[element-1][\"Fatalities\"]\n    MX_cases_ratio.at[MX_cases_ratio.index[element], \"Fatalities_trend\"] = MX_cases_ratio.iloc[element][\"Fatalities_difference\"]\/MX_cases_ratio.iloc[element-1][\"Fatalities\"]\n\nfor element in range(1, CN_cases_ratio.shape[0]):\n    CN_cases_ratio.at[CN_cases_ratio.index[element], \"Fatalities_difference\"] = CN_cases_ratio.iloc[element][\"Fatalities\"]-CN_cases_ratio.iloc[element-1][\"Fatalities\"]\n    CN_cases_ratio.at[CN_cases_ratio.index[element], \"Fatalities_trend\"] = CN_cases_ratio.iloc[element][\"Fatalities_difference\"]\/CN_cases_ratio.iloc[element-1][\"Fatalities\"]\n\nfor element in range(1, CH_cases_ratio.shape[0]):\n    CH_cases_ratio.at[CH_cases_ratio.index[element], \"Fatalities_difference\"] = CH_cases_ratio.iloc[element][\"Fatalities\"]-CH_cases_ratio.iloc[element-1][\"Fatalities\"]\n    CH_cases_ratio.at[CH_cases_ratio.index[element], \"Fatalities_trend\"] = CH_cases_ratio.iloc[element][\"Fatalities_difference\"]\/CH_cases_ratio.iloc[element-1][\"Fatalities\"]\n\nfor element in range(1, IN_cases_ratio.shape[0]):\n    IN_cases_ratio.at[IN_cases_ratio.index[element], \"Fatalities_difference\"] = IN_cases_ratio.iloc[element][\"Fatalities\"]-IN_cases_ratio.iloc[element-1][\"Fatalities\"]\n    IN_cases_ratio.at[IN_cases_ratio.index[element], \"Fatalities_trend\"] = IN_cases_ratio.iloc[element][\"Fatalities_difference\"]\/IN_cases_ratio.iloc[element-1][\"Fatalities\"]\n\nfor element in range(1, IT_cases_ratio.shape[0]):\n    IT_cases_ratio.at[IT_cases_ratio.index[element], \"Fatalities_difference\"] = IT_cases_ratio.iloc[element][\"Fatalities\"]-IT_cases_ratio.iloc[element-1][\"Fatalities\"]\n    IT_cases_ratio.at[IT_cases_ratio.index[element], \"Fatalities_trend\"] = IT_cases_ratio.iloc[element][\"Fatalities_difference\"]\/IT_cases_ratio.iloc[element-1][\"Fatalities\"]\n","283844a9":"print(\"US fatalities average growth everyday: \"+str(round(US_cases_ratio[1:][\"Fatalities_trend\"].mean(axis=0)*100,2))+\"%\")\nprint(\"Mexico fatalities average growth everyday: \"+str(round(MX_cases_ratio[1:][\"Fatalities_trend\"].mean(axis=0)*100,2))+\"%\")\nprint(\"Canada fatalities average growth everyday: \"+str(round(CN_cases_ratio[1:][\"Fatalities_trend\"].mean(axis=0)*100,2))+\"%\")\nprint(\"China fatalities average growth everyday: \"+str(round(CH_cases_ratio[1:][\"Fatalities_trend\"].mean(axis=0)*100,2))+\"%\")\nprint(\"Iran fatalities average growth everyday: \"+str(round(IN_cases_ratio[1:][\"Fatalities_trend\"].mean(axis=0)*100,2))+\"%\")\nprint(\"Italy fatalities average growth everyday: \"+str(round(IT_cases_ratio[1:][\"Fatalities_trend\"].mean(axis=0)*100,2))+\"%\")","4ad5e338":"US_cases_ratio1 = US_cases[datetime.date(2020, 3, 10):]\nMX_cases_ratio1 = MX_cases[datetime.date(2020, 2, 28):]\nCN_cases_ratio1 = CN_cases[datetime.date(2020, 1, 26):]\nCH_cases_ratio1 = CH_cases[:datetime.date(2020, 3, 22)]\nIT_cases_ratio1 = IT_cases[datetime.date(2020, 1, 31):]\nIN_cases_ratio1 = IN_cases[datetime.date(2020, 2, 19):]\nUS_cases_ratio1.columns = US_cases_ratio1.columns.droplevel(level=1)\nMX_cases_ratio1.columns = MX_cases_ratio1.columns.droplevel(level=1)\nCN_cases_ratio1.columns = CN_cases_ratio1.columns.droplevel(level=1)\nCH_cases_ratio1.columns = CH_cases_ratio1.columns.droplevel(level=1)\nIT_cases_ratio1.columns = IT_cases_ratio1.columns.droplevel(level=1)\nIN_cases_ratio1.columns = IN_cases_ratio1.columns.droplevel(level=1)\nUS_cases_ratio1 = US_cases_ratio1.reset_index()\nMX_cases_ratio1 = MX_cases_ratio1.reset_index()\nCN_cases_ratio1 = CN_cases_ratio1.reset_index()\nCH_cases_ratio1 = CH_cases_ratio1.reset_index()\nIT_cases_ratio1 = IT_cases_ratio1.reset_index()\nIN_cases_ratio1 = IN_cases_ratio1.reset_index()\n\nUS_cases_ratio1[\"Confirmed_difference\"] = 0\nUS_cases_ratio1[\"Confirmed_trend\"] = 0.0\nMX_cases_ratio1[\"Confirmed_difference\"] = 0\nMX_cases_ratio1[\"Confirmed_trend\"] = 0.0\nCN_cases_ratio1[\"Confirmed_difference\"] = 0\nCN_cases_ratio1[\"Confirmed_trend\"] = 0.0\nCH_cases_ratio1[\"Confirmed_difference\"] = 0\nCH_cases_ratio1[\"Confirmed_trend\"] = 0.0\nIT_cases_ratio1[\"Confirmed_difference\"] = 0\nIT_cases_ratio1[\"Confirmed_trend\"] = 0.0\nIN_cases_ratio1[\"Confirmed_difference\"] = 0\nIN_cases_ratio1[\"Confirmed_trend\"] = 0.0","765ec28d":"for element in range(1, US_cases_ratio1.shape[0]):\n    US_cases_ratio1.at[US_cases_ratio1.index[element], \"Confirmed_difference\"] = US_cases_ratio1.iloc[element][\"ConfirmedCases\"]-US_cases_ratio1.iloc[element-1][\"ConfirmedCases\"]\n    US_cases_ratio1.at[US_cases_ratio1.index[element], \"Confirmed_trend\"] = US_cases_ratio1.iloc[element][\"Confirmed_difference\"]\/US_cases_ratio1.iloc[element-1][\"ConfirmedCases\"]\n\nfor element in range(1, MX_cases_ratio1.shape[0]):\n    MX_cases_ratio1.at[MX_cases_ratio1.index[element], \"Confirmed_difference\"] = MX_cases_ratio1.iloc[element][\"ConfirmedCases\"]-MX_cases_ratio1.iloc[element-1][\"ConfirmedCases\"]\n    MX_cases_ratio1.at[MX_cases_ratio1.index[element], \"Confirmed_trend\"] = MX_cases_ratio1.iloc[element][\"Confirmed_difference\"]\/MX_cases_ratio1.iloc[element-1][\"ConfirmedCases\"]\n\nfor element in range(1, CN_cases_ratio1.shape[0]):\n    CN_cases_ratio1.at[CN_cases_ratio1.index[element], \"Confirmed_difference\"] = CN_cases_ratio1.iloc[element][\"ConfirmedCases\"]-CN_cases_ratio1.iloc[element-1][\"ConfirmedCases\"]\n    CN_cases_ratio1.at[CN_cases_ratio1.index[element], \"Confirmed_trend\"] = CN_cases_ratio1.iloc[element][\"Confirmed_difference\"]\/CN_cases_ratio1.iloc[element-1][\"ConfirmedCases\"]\n\nfor element in range(1, CH_cases_ratio1.shape[0]):\n    CH_cases_ratio1.at[CH_cases_ratio1.index[element], \"Confirmed_difference\"] = CH_cases_ratio1.iloc[element][\"ConfirmedCases\"]-CH_cases_ratio1.iloc[element-1][\"ConfirmedCases\"]\n    CH_cases_ratio1.at[CH_cases_ratio1.index[element], \"Confirmed_trend\"] = CH_cases_ratio1.iloc[element][\"Confirmed_difference\"]\/CH_cases_ratio1.iloc[element-1][\"ConfirmedCases\"]\n    \nfor element in range(1, IT_cases_ratio1.shape[0]):\n    IT_cases_ratio1.at[IT_cases_ratio1.index[element], \"Confirmed_difference\"] = IT_cases_ratio1.iloc[element][\"ConfirmedCases\"]-IT_cases_ratio1.iloc[element-1][\"ConfirmedCases\"]\n    IT_cases_ratio1.at[IT_cases_ratio1.index[element], \"Confirmed_trend\"] = IT_cases_ratio1.iloc[element][\"Confirmed_difference\"]\/IT_cases_ratio1.iloc[element-1][\"ConfirmedCases\"]\nfor element in range(1, IN_cases_ratio1.shape[0]):\n    IN_cases_ratio1.at[IN_cases_ratio1.index[element], \"Confirmed_difference\"] = IN_cases_ratio1.iloc[element][\"ConfirmedCases\"]-IN_cases_ratio1.iloc[element-1][\"ConfirmedCases\"]\n    IN_cases_ratio1.at[IN_cases_ratio1.index[element], \"Confirmed_trend\"] = IN_cases_ratio1.iloc[element][\"Confirmed_difference\"]\/IN_cases_ratio1.iloc[element-1][\"ConfirmedCases\"]\n   ","e7b27488":"print(\"US average infected growth everyday: \"+str(round(US_cases_ratio1[1:][\"Confirmed_trend\"].mean(axis=0)*100,2))+\"%\")\nprint(\"Mexico average infected growth everyday: \"+str(round(MX_cases_ratio1[1:][\"Confirmed_trend\"].mean(axis=0)*100,2))+\"%\")\nprint(\"Canada average infected growth everyday: \"+str(round(CN_cases_ratio1[1:][\"Confirmed_trend\"].mean(axis=0)*100,2))+\"%\")\nprint(\"China average infected growth everyday: \"+str(round(CH_cases_ratio1[1:][\"Confirmed_trend\"].mean(axis=0)*100,2))+\"%\")\nprint(\"Iran average infected growth everyday: \"+str(round(IN_cases_ratio1[1:][\"Confirmed_trend\"].mean(axis=0)*100,2))+\"%\")\nprint(\"Italy average infected growth everyday: \"+str(round(IT_cases_ratio1[1:][\"Confirmed_trend\"].mean(axis=0)*100,2))+\"%\")","8183d69e":"US_cases_ratio[\"Mortality_rate\"] = US_cases_ratio[\"Fatalities\"]\/US_cases_ratio[\"ConfirmedCases\"]\nMX_cases_ratio[\"Mortality_rate\"] = MX_cases_ratio[\"Fatalities\"]\/MX_cases_ratio[\"ConfirmedCases\"]\nCN_cases_ratio[\"Mortality_rate\"] = CN_cases_ratio[\"Fatalities\"]\/CN_cases_ratio[\"ConfirmedCases\"]\nCH_cases_ratio[\"Mortality_rate\"] = CH_cases_ratio[\"Fatalities\"]\/CH_cases_ratio[\"ConfirmedCases\"]\nIN_cases_ratio[\"Mortality_rate\"] = IN_cases_ratio[\"Fatalities\"]\/IN_cases_ratio[\"ConfirmedCases\"]\nIT_cases_ratio[\"Mortality_rate\"] = IT_cases_ratio[\"Fatalities\"]\/IT_cases_ratio[\"ConfirmedCases\"]","6ccb6c67":"print(\"US average mortality rate: \"+str(round(US_cases_ratio[:][\"Mortality_rate\"].mean(axis=0)*100,2))+\"%\")\nprint(\"Mexico average mortality rate: \"+str(round(MX_cases_ratio[:][\"Mortality_rate\"].mean(axis=0)*100,2))+\"%\")\nprint(\"Canada average mortality rate: \"+str(round(CN_cases_ratio[:][\"Mortality_rate\"].mean(axis=0)*100,2))+\"%\")\nprint(\"China average mortality rate: \"+str(round(CH_cases_ratio[:][\"Mortality_rate\"].mean(axis=0)*100,2))+\"%\")\nprint(\"Iran average mortality rate: \"+str(round(IN_cases_ratio[:][\"Mortality_rate\"].mean(axis=0)*100,2))+\"%\")\nprint(\"Italy average mortality rate: \"+str(round(IT_cases_ratio[:][\"Mortality_rate\"].mean(axis=0)*100,2))+\"%\")","ca7bfd37":"population = pd.read_csv(\"\/kaggle\/input\/population-by-country-2020\/population_by_country_2020.csv\", usecols=[\"Country (or dependency)\",\"Population (2020)\", \"Density (P\/Km\u00b2)\",\"Migrants (net)\",\"Med. Age\",\"Urban Pop %\"], na_values=[\"\",\"N.A.\"])","f3c6091b":"population.info()\npopulation.shape","2b2c6fdd":"# Change columns names\npopulation.columns = [\"Country_Region\",\"Population\", \"Density\",\"Migrants\",\"Med_Age\",\"Urban_Pop\"]\n# Convert string type percentages to floats\npopulation[\"Urban_Pop\"] = population[\"Urban_Pop\"].str.replace(r\"%\",r\".0\").astype(\"float\")\/100.0\n# Replace missing values with mean\npopulation = population.fillna(population.mean())\npopulation.info()","16bc9853":"population = population.sort_values(\"Country_Region\",ascending=True).reset_index(drop=True)\npopulation.at[population.index[224],\"Country_Region\"] = \"US\"\npopulation.at[population.index[55],\"Country_Region\"] = \"Czechia\"\npopulation.at[population.index[46],\"Country_Region\"] = \"Congo (Brazzaville)\"\npopulation.at[population.index[194],\"Country_Region\"] = \"Korea, South\"\npopulation.at[population.index[175],\"Country_Region\"] = \"Saint Kitts and Nevis\"\npopulation.at[population.index[198],\"Country_Region\"] = \"Saint Vincent and the Grenadines\"\npopulation.at[population.index[205],\"Country_Region\"] = \"Taiwan*\"","f381fa3e":"train = pd.merge(train, population, on=\"Country_Region\")","2d25f810":"print (\"\\nMissing values in train:  \", train.isnull().sum().values.sum())\nprint (\"\\nMissing values in test:  \", test.isnull().sum().values.sum())","e40cf4d7":"train_df = train.groupby([\"Date\",\"Country_Region\"], as_index=False).agg({\"ConfirmedCases\":[\"sum\"],\"Fatalities\":[\"sum\"]})\ntrain_df.columns = list(map(\"\".join, train_df.columns.values))\ntrain_df.columns = [\"Date\",\"Country_Region\",\"ConfirmedCases\",\"Fatalities\"]\ntrain_df = pd.merge(train_df, population, on=\"Country_Region\")\ntrain_df","9516a7b3":"print (\"\\nMissing values :  \", train_df.isnull().sum().values.sum())\nprint (\"\\nMissing values :  \", test.isnull().sum().values.sum())","829421ae":"encoder = preprocessing.LabelEncoder()\ntrain_df['Day_No'] = (encoder.fit_transform(train_df.Date))\ntest['Day_No'] = (encoder.fit_transform(test.Date))","bafe07ba":"a = list(train_df[\"ConfirmedCases\"])\na.sort()\nb = list(train_df[\"Fatalities\"])\nstat_a, p = shapiro(a)\nstat_b, p_b = shapiro(b)\nprint('Confirmed Cases Statistics=%.3f, p=%.3f' % (stat_a, p))\nif p > 0.05:\n    print('Sample looks Gaussian (fail to reject H0)')\nelse:\n    print('Sample does not look Gaussian (reject H0)')\nprint('Fatalities Statistics=%.3f, p=%.3f' % (stat_b, p_b))\nif p > 0.05:\n    print('Sample looks Gaussian (fail to reject H0)')\nelse:\n    print('Sample does not look Gaussian (reject H0)')","019fa73d":"qqplot(train_df[\"ConfirmedCases\"], line='s')\nplt.title(\"Confirmed Cases\")\nqqplot(train_df[\"Fatalities\"], line=\"s\")\nplt.title(\"Fatalities\")\nplt.show()","a7daa64f":"corr = train_df.corr(method=\"spearman\")\ncorr.style.background_gradient(cmap='coolwarm')","1f80042e":"CH_df = train_df[train_df.Country_Region.isin([\"China\"])]\nIT_df = train_df[train_df.Country_Region.isin([\"Italy\"])]\nUS_df = train_df[train_df.Country_Region.isin([\"US\"])]\nIN_df = train_df[train_df.Country_Region.isin([\"Iran\"])]\nMX_df = train_df[train_df.Country_Region.isin([\"Mexico\"])]\nCN_df = train_df[train_df.Country_Region.isin([\"Canada\"])]","37817994":"plt.plot(CH_df[\"Date\"],CH_df[\"ConfirmedCases\"])\nplt.plot(IT_df[\"Date\"],IT_df[\"ConfirmedCases\"])\nplt.plot(US_df[\"Date\"],US_df[\"ConfirmedCases\"])\nplt.plot(IN_df[\"Date\"],IN_df[\"ConfirmedCases\"])\nplt.plot(MX_df[\"Date\"],MX_df[\"ConfirmedCases\"])\nplt.plot(CN_df[\"Date\"],CN_df[\"ConfirmedCases\"])\nplt.legend([\"China\", \"Italy\", \"US\",\"Iran\",\"Mexico\",\"Canada\"], loc='upper left')\nplt.title(\"Confirmed cases of COVID19\", size=15)\nplt.xlabel(\"Date\", size=13)\nplt.ylabel(\"Number of cases\", size=13)\nplt.show()","0a971991":"train_df = train.groupby([\"Date\"], as_index=False).agg({\"ConfirmedCases\":[\"sum\"],\"Fatalities\":[\"sum\"]})\ntrain_df.columns = list(map(\"\".join, train_df.columns.values))\ntrain_df.columns = [\"Date\",\"ConfirmedCases\",\"Fatalities\"]\nencoder = preprocessing.LabelEncoder()\ntrain_df['Day_No'] = (encoder.fit_transform(train_df.Date))","636ab90c":"test_df = test[[\"Day_No\"]]","599a9a88":"# Train x,y\nx_train_wd = list(train_df[\"Day_No\"])\ny_train_wd = list(train_df[\"ConfirmedCases\"])\n# Test x\nx_test_wd = list(test_df[\"Day_No\"])","57f60dbd":"# Logistic Curve Equation\ndef log_curve(x, k, x_0, L):\n    return L \/ (1 + np.exp(-k*(x-x_0)))","f6391685":"# Fit the model\nfit_par, fit_cov = curve_fit(log_curve, x_train_wd, y_train_wd, bounds=([0,0,0],np.inf), maxfev=100000)\nestimated_k_wd, estimated_x0_wd, L_wd = fit_par\n# Create the predictions\npredictions_con = log_curve(x_test_wd, estimated_k_wd, estimated_x0_wd, L_wd)","c01bd6c3":"# Train with Fatalities\ny_train_wd = list(train_df[\"Fatalities\"])","8a26ef73":"# Fit the model\nfit_par, fit_cov = curve_fit(log_curve, x_train_wd, y_train_wd, bounds=([0,0,0],np.inf), maxfev=100000)\nestimated_k_wd, estimated_x0_wd, L_wd = fit_par\n# Create the predictions\npredictions_fat = log_curve(x_test_wd, estimated_k_wd, estimated_x0_wd, L_wd)","ef5be1a2":"submission = pd.DataFrame(test[\"ForecastId\"])","cd69a6aa":"submission['ConfirmedCases'] = predictions_con\nsubmission['Fatalities'] = predictions_fat\nsubmission","067b28a8":"submission.to_csv('submission.csv', index = False)","921ce794":"A sigmoid function is a mathematical function that has a sigmoid curve characteristic. A common exaple of a sigmoid function is the logistic function defined by the equation of the form:\n\n$$f(x) = \\frac{L}{1+e^{-k(x-x_0)}},$$\n\nWhere,\n\n$e$ = Euler's number,\n\n$x_0$ = the x value of the sigmoid's midpoint,\n\n$L$ = the curve's maximum value, and\n\n$k$ = the logistic growth rate.\n\nhttps:\/\/en.wikipedia.org\/wiki\/Logistic_function","2179d43c":"The infection in North America has increase in an average rate of 23.08% everyday.","950aff6a":"We group all the countries by date and sum all confirmed cases and fatalities. Then, instead of having a date type variable, we need the dates to be a progressive number throught time. So, we will transform the dates to number starting with 22nd of January as 1.","5fadaabe":"Now we want to understand the average of death rates cases in each country that happens everyday.","b6797c9d":"Now we plot the confirmed cases and fatalities worldwide.","a8fba973":"We sort the country by names to replace the unmatching labels in population dataframe. The labels that do not match are: US, Czechia, Congo(Brazzaville, Korea South, Saint Kitts and Nevis, Saint Vincent and the Grenadines, and Taiwan.","056eefdf":"#### Model Construction for Confirmed Cases","f5071972":"**Confirmed cases and fatalities**","b776f9af":"#### Normality Test","90ce5b6c":"#### Model Construction For Fatalities","43169aaf":"### Grouping","0c7a7658":"### Spearman Correlation Matrix","af08beeb":"Convert float type: \"ConfirmedCases\" and \"Fatalities\" to int type","d7580b9c":"Check for missing values","b19ca1dc":"Next we want to compare the growth tendency of confirmed cases through time for each country, so we will plot them in the next Figure.","68fcb73d":"## **1.2 Preprocessing** <a id=\"section12\"><\/a>","007ebf1b":"To understand which correlation method we should use for the coefficient matrix, we first need to understand if the data is normally distributed. If the data density behaviour is normally distributed, we can calculate the correlation by using the Pearson coefficient, if not, we can use the Spearman coefficient which is more robust to non-normally distributed data.","f344c602":"**Data Separation by Country of Interest**","e33bd268":"### 1.1 Exploratory Data Analysis <a id=\"section11\"><\/a>","fd478e51":"Since the first entry of confirmed cases, the number of people infected in the United States has been growing at a bigger pace than Mexico and Canada.","576ce322":"## 1. Data Understanding and Preparation <a id=\"section1\"><\/a>","679ad641":"### 1.0. Housekeeping <a id=\"section10\"><\/a>","8b0a63c1":"Next, we want to understand the mortality rate of each country. For this we calculate the number of fatalities over the number of confirmed cases.","81e85409":"A brief summary of the train dataset","d81d4237":"Import csv files John Hopkins University open database","a462ce61":"# Multiple Countries COVID19 Analysis #\n\n\n**Index**\n\n1. [Data Understanding and Preparation](#section1)\n\n    1.0. [Housekeeping](#section10)\n    \n    1.1. [Preprocessing](#section11)\n\n    1.2. [Exploratory Data Analysis](#section12)\n    \n2. [Modeling ](#section2)\n\n    2.1 [Logistic Curve Fitting](#section20)","020ce2ae":"The train dataset is separated by country to visualize the number of confirmed cases.","f399fbc0":"From the previous graph we can observe an exponential growth of the infection worldwide since the 22nd of January. The total number of cases of COVID19 entries up to March 31st, was of 856337 with 42089 deaths, with a mortality rate of 4.92%.","f92cc850":"Check again for missing values","212ae729":"## **2 Modeling** <a id=\"section2\"><\/a>","689e5b55":"#### Matrix","5af4fd23":"To understand the growth of the infection in the countries of interest: US, Mexico, Canada, China, Iran and Italy; we proceed to plot the confirmed cases and fatalities per country through time.","b12d011d":"The Shapiro-Wilk test is used to test data normality and the results from this test are for the confirmed cases variable, a coefficient of 0.10 with a p value less than 0.05, and for the Fatalities variable a coefficient of 0.068 with a p value less than 0.05. With this information we have enough statistical evidence to reject the null hypothesis which states that the data is normally distributed.","b29b5f9b":"### Creating a day number column","16ff134a":"### Adding Information ###","674926fe":"Change to date type with library 'datetime':","0fdb460c":"And the average rate of growth of the infection in each country.","7de10018":"We want to understand as a fraction of the total population of each country, for that we import the \"population_by_country_2020.csv\" file from an open source database in kaggle (https:\/\/www.kaggle.com\/tanuprabhu\/population-by-country-2020).","6db7b322":"Libraries initialization","b584620f":"### 2.1 Logistic Curve Fitting <a id=\"section20\"><\/a>"}}