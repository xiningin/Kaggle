{"cell_type":{"51fdca56":"code","91ac9441":"code","d0047ac7":"code","e110337b":"code","3ebcfb77":"code","b6f4dbbd":"code","6b84c407":"code","48bdf560":"code","3ab0f914":"code","98df2e4e":"code","3181fc43":"code","1479b201":"code","eba07b5a":"code","b8cb2675":"code","2cc9f6ac":"code","117dd4cc":"code","b94c6a5a":"code","6589140a":"code","cb7576a3":"code","ec96f03c":"code","e290d1a1":"code","c4fa579f":"code","4689f431":"code","aa2e0bc7":"code","d418e366":"code","1136be65":"code","7d07fe5a":"code","2b8f3958":"code","62ac3999":"code","7598e9d8":"code","41a766ff":"code","00c9dae1":"code","1a493345":"code","823667ef":"code","a1df02da":"code","86953e3d":"code","421d32e8":"code","666e0d31":"code","3c7a11db":"code","b2309b7f":"code","8113fd4b":"code","29078268":"code","702f21b4":"code","85b4f091":"code","6188935c":"code","faa5c36a":"code","41e7cfc6":"code","58b29b2c":"code","5500dd53":"code","2d949215":"code","7112232c":"code","51322e55":"code","bcd28bdc":"code","786e2f29":"code","af52bb32":"code","6a65865b":"code","9b69dd8e":"markdown","b34a2709":"markdown","2dbd5d8b":"markdown","dfc9498c":"markdown","4217a906":"markdown","1ca500f2":"markdown","a2715d4e":"markdown","6bfaaead":"markdown","4c097316":"markdown","6771532f":"markdown","fdc635fa":"markdown","10f1d9f4":"markdown","7db738d8":"markdown","44c99387":"markdown","fcf97655":"markdown","aa4407ca":"markdown","efb737e1":"markdown","d07d5919":"markdown","aa80b1c2":"markdown","13763ce4":"markdown","33a19add":"markdown","585a3cb7":"markdown","21327f8b":"markdown","93987d2c":"markdown","451ee3b3":"markdown","a5ac11b8":"markdown","70d123ec":"markdown","ce2aa186":"markdown","33b940b2":"markdown","44b2d7ac":"markdown","1fde7648":"markdown","5cd3e99e":"markdown"},"source":{"51fdca56":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings('ignore')","91ac9441":"df=pd.read_csv('\/kaggle\/input\/goodreadsbooks\/books.csv', error_bad_lines=False)","d0047ac7":"df.head()","e110337b":"# Arrange by rating (high to low):\n\ndf.sort_values(by='average_rating',ascending=False)","3ebcfb77":"# Count null values (if any):\n\ndf.isnull().sum()","b6f4dbbd":"plt.figure(figsize=(15,10))\nsns.barplot(data=df,x='language_code',y='average_rating')\nplt.xlabel('Languages')\nplt.ylabel('Average Rating')\nplt.show()","6b84c407":"plt.figure(figsize=(15,10))\nsns.scatterplot(data=df,x='# num_pages',y='average_rating')\nplt.xlabel('No. of Pages')\nplt.ylabel('Average Rating')\nplt.show()","48bdf560":"plt.figure(figsize=(15,6))\nsns.distplot(df['average_rating'],bins=20, color='red')\nplt.title('Distribution of Average Ratings')\nplt.xlabel('Average Rating')\nplt.show()","3ab0f914":"plt.figure(figsize=(15,10))\nsns.boxplot(data=df,y='# num_pages',x='language_code')\nplt.xlabel('Language')\nplt.ylabel('No. of Pages')\nplt.show()","98df2e4e":"plt.figure(figsize=(15,10))\nsns.heatmap(df.corr(),square=True,vmax=0.1,annot=True)\nplt.xlabel('Language')\nplt.ylabel('No. of Pages')\nplt.show()","3181fc43":"plt.figure(figsize=(15,7))\nsns.distplot(df['# num_pages'],bins=20,color='gold')\nplt.title('Distribution of Number of Pages')\nplt.xlabel('No. of Pages')\nplt.show()","1479b201":"df.describe()","eba07b5a":"cols = list(df.select_dtypes(exclude=['object']).columns)\ndf1 = df.loc[:,cols]","b8cb2675":"print(\"The Range of the dataset is : \\n\\n\",df1.max()-df1.min())","2cc9f6ac":"IQR = df1.quantile(0.75)-df1.quantile(0.25)\nIQR","117dd4cc":"ct= pd.crosstab(df['average_rating'],df['language_code'],normalize=False)\nct.head()","b94c6a5a":"df[df['average_rating']==0]","6589140a":"df[df['average_rating']==0].count().loc['bookID']","cb7576a3":"df.groupby('language_code')['average_rating'].agg(['mean'])","ec96f03c":"df.groupby('language_code')['bookID'].agg(['count'])","e290d1a1":"df['Ranks']=df['average_rating'].rank(ascending=0,method='dense')","c4fa579f":"df","4689f431":"df.sort_values(by='average_rating',ascending=False)","aa2e0bc7":"df['Rank By Language']=df.groupby('language_code')['average_rating'].rank(ascending=0,method='dense')\n","d418e366":"df.sort_values(by='average_rating',ascending=False)","1136be65":"plt.figure(figsize=(10,10))\nsns.regplot(data=df,y=\"average_rating\",x=\"# num_pages\",marker='*',color='k')\nplt.xlabel('No. of Pages')\nplt.ylabel('Average Rating')\nplt.show()","7d07fe5a":"df.head()","2b8f3958":"df1 = df.drop(['bookID','title','authors','isbn','isbn13','Ranks','Rank By Language'],axis=1)\ndf1.head()","62ac3999":"lang = list(df1['language_code'].value_counts().head(6).index)","7598e9d8":"df1['language_code']=np.where(df1['language_code'].isin(lang),df1['language_code'],'others')","41a766ff":"df1['language_code'].value_counts()","00c9dae1":"df1 = pd.get_dummies(df1, columns=['language_code'],drop_first=True)","1a493345":"df1.head()","823667ef":"import statsmodels.api as sm\nX = df1.drop('average_rating',axis=1)\ny =df1['average_rating']\nxc = sm.add_constant(X)\nlr = sm.OLS(y,xc).fit()\nlr.summary()","a1df02da":"from statsmodels.stats.outliers_influence import variance_inflation_factor\nvif = [variance_inflation_factor(X.values,i) for i in range (X.shape[1])]\npd.DataFrame({'vif':vif}, index = X.columns)","86953e3d":"X.head()","421d32e8":"X = X.drop('text_reviews_count',axis=1)\nX.head()","666e0d31":"xc = sm.add_constant(X)\nlr = sm.OLS(y,xc).fit()\nlr.summary()","3c7a11db":"X = X.drop('language_code_en-US',axis=1)","b2309b7f":"xc = sm.add_constant(X)\nlr = sm.OLS(y,X).fit()\nlr.summary()","8113fd4b":"X = X.drop('ratings_count',axis=1)","29078268":"xc = sm.add_constant(X)\nlr = sm.OLS(y,X).fit()\nlr.summary()","702f21b4":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.30, random_state=42)","85b4f091":"xc = sm.add_constant(X_train)\nlr = sm.OLS(y_train,X_train).fit()\nlr.summary()","6188935c":"y_pred = lr.predict(X_test)","faa5c36a":"xc = sm.add_constant(X_test)\nlr = sm.OLS(y_test,X_test).fit()\nlr.summary()","41e7cfc6":"plt.figure(figsize=(7,5))\nplt.scatter(y_test,y_pred, color='y')\nplt.plot(y,y,color='b')\nplt.show()","58b29b2c":"from sklearn.metrics import r2_score, mean_squared_error\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.model_selection import RandomizedSearchCV\n\nrf = RandomForestRegressor()\nrf.fit(X_train, y_train)\ny_pred = rf.predict(X_test)","5500dd53":"print('RMSE: ',np.sqrt(mean_squared_error(y_test,y_pred)))\nprint('R-squared', r2_score(y_test,y_pred))","2d949215":"n_estimators = [int(x) for x in np.linspace(start = 10, stop=200, num=10)]\nmax_depth = [int(x) for x in np.linspace(10,100,num=10)]\nmin_samples_split = [2, 3, 4, 5, 10]\nmin_samples_leaf = [1, 2, 4, 10]\n\nrandom_grid = {'n_estimators': n_estimators,\n              'max_depth': max_depth,\n              'min_samples_leaf': min_samples_leaf,\n              'min_samples_split': min_samples_split}\n\nprint(random_grid)","7112232c":"rf = RandomForestRegressor()\nrf_random = RandomizedSearchCV(estimator=rf,param_distributions=random_grid, cv=3)\n\nrf_random.fit(X_train, y_train)","51322e55":"rf_random.best_params_","bcd28bdc":"rf = RandomForestRegressor(**rf_random.best_params_)\nrf","786e2f29":"rf.fit(X_train,y_train)\ny_pred = rf.predict(X_test) \n\n# Predict values of y by applying the Random Forest model generated through train data to test data.","af52bb32":"print('RMSE:',np.sqrt(mean_squared_error(y_test,y_pred)))\nprint('R-squared:',r2_score(y_test,y_pred))","6a65865b":"plt.figure(figsize=(7,5))\nplt.scatter(y_test,y_pred, color='r')\nplt.plot(y,y,color='b')\nplt.show()","9b69dd8e":"#### Observation: There are 34 books with zero rating as Average.","b34a2709":"### Feature Selection","2dbd5d8b":"#### We performed hyperparametric tuning by running the cross-validation search and found the best values for random forest parameters (n_estimators, min_samples_split, min_samples_leaf, max_depth). Now we'll run the Random Forest model again and check if r-square value has improved or not.","dfc9498c":"#### Distribution Plot for the Number of Pages:","4217a906":"#### To Count no. of books with Average Rating = 0:","1ca500f2":"#### Plot for Observing Distribution of Average Ratings","a2715d4e":"#### The r-squared value of the model on the training data is 88.1%, while on the test data, the r-squared is 88.4%. Therefore, the model has a good accuracy.","6bfaaead":"#### To count the number of books in each language:","4c097316":"#### The value of r-squared is equal to -0.0698.","6771532f":"#### Before tuning, the r-squared value was negative (implying negative correlation) but now the r-squared value has improved to 0.0214. This is still less accurate than the Linear Regression Model done before. Also, as seen in the plot below, the model does not fit as good as the one plotted in Linear Regression above.","fdc635fa":"#### Observation: The books written in Welsch language have the highest average ratings while the ones written in Catalan language have the lowest average ratings.","10f1d9f4":"#### Range","7db738d8":"#### Barplot between Language and Average Rating:","44c99387":"## Exploratory Analysis on the Dataset","fcf97655":"#### Observation: The majority of average ratings is distributed between 3.25 to 4.75.","aa4407ca":"#### Crosstable between Language and Average Rating","efb737e1":"#### Observation: The highest correlation exists between 'text_reviews_count' and 'ratings_count', while the lowest correlation is between 'average_rating' and 'bookID' (which stands to reason)","d07d5919":"#### Statistical Analysis of Data Frame:","aa80b1c2":"#### Interquartile Range:","13763ce4":"#### To rank the Titles based on Average Rating:","33a19add":"#### Regression Plot between Number of Pages and Average Rating:","585a3cb7":"### Linear Regression Model","21327f8b":"#### To rank books of each Language as per Average Rating:","93987d2c":"#### Observation: 'wel' language books have the highest average rating while 'cat' language books have the lowest (as depicted in the distribution plot earlier)","451ee3b3":"### Random Forest Model","a5ac11b8":"#### Hyperparametric Tuning","70d123ec":"#### Observation: 'Eng' language has the highest number of books avaialbe, i.e. 10594, while 'wel' language (which has the highest average rating) has the lowest number of books avalable, i.e. only 1.","ce2aa186":"#### Boxplot for the No. of Pages by Language:","33b940b2":"#### Scatter of Average Rating w.r.t. No. of Pages","44b2d7ac":"#### Correlation between various columns in the Data Frame:","1fde7648":"#### To find Average Rating of books by Language:","5cd3e99e":"#### Observation: English language books have the maximum number of outliers in terms of the number of pages."}}