{"cell_type":{"307e1721":"code","614821aa":"code","9ddcf8ed":"code","6c221c08":"code","955dee44":"code","498891bb":"code","90d5ff23":"code","f88ef5ed":"code","cf56131c":"code","1e0a8eb5":"code","4bc2f274":"code","13ae40e2":"code","f384c53c":"code","e3d791d3":"code","91d902a6":"code","55a174d7":"code","2813c23b":"code","b2680993":"code","6b64e9a2":"code","6caee1ba":"code","392adb68":"code","c667360d":"code","187c4339":"code","799477b6":"code","548124a8":"code","4d1adcfa":"code","f9ff1992":"code","7645dab4":"code","becf2857":"code","23d74f6e":"code","857d69b9":"code","b975fae6":"markdown"},"source":{"307e1721":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline","614821aa":"from tensorflow.keras.datasets import mnist","9ddcf8ed":"(x_train,y_train),(x_test,y_test)=mnist.load_data()","6c221c08":"x_train.shape","955dee44":"y_test.shape","498891bb":"#First image\nimg1=x_train[0]","90d5ff23":"plt.imshow(img1)\n#note- mnist consists of greyscale images, since we are using matplotlib to plot it uses the default color","f88ef5ed":"y_train[0]","cf56131c":"from tensorflow.keras.utils import to_categorical","1e0a8eb5":"y_train_cat = to_categorical(y_train,10)\ny_test_cat = to_categorical(y_test,10)","4bc2f274":"y_train_cat[0]","13ae40e2":"x_train=x_train\/255\nx_test=x_test\/255","f384c53c":"plt.imshow(x_train[0])","e3d791d3":"x_train.shape","91d902a6":"x_train=x_train.reshape(60000,28,28,1)","55a174d7":"x_test=x_test.reshape(10000,28,28,1)","2813c23b":"from tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense,Conv2D,MaxPool2D,Flatten","b2680993":"model=Sequential()\n\nmodel.add(Conv2D(filters=32,kernel_size=(4,4),activation='relu'))\nmodel.add(MaxPool2D(pool_size=(2,2)))\n\nmodel.add(Flatten())\nmodel.add(Dense(128, activation='relu'))\n\nmodel.add(Dense(10,activation='softmax'))\n\n\nmodel.compile(loss='categorical_crossentropy',\n              optimizer='adam',\n              metrics=['accuracy']) ","6b64e9a2":"from tensorflow.keras.callbacks import EarlyStopping","6caee1ba":"early_stop = EarlyStopping(monitor='val_loss',patience=2)","392adb68":"model.fit(x_train,y_train_cat,epochs=100,validation_data=(x_test,y_test_cat),callbacks=[early_stop])","c667360d":"Trained=pd.DataFrame(model.history.history)","187c4339":"Trained","799477b6":"Trained['accuracy'].plot()","548124a8":"Trained[['loss','val_loss']].plot()","4d1adcfa":"test=x_test[555]\nmodel.predict_classes(test.reshape(1,28,28,1))","f9ff1992":"y_test[555]","7645dab4":"plt.imshow(test.reshape(28,28))","becf2857":"from sklearn.metrics import classification_report","23d74f6e":"predictions = model.predict_classes(x_test)","857d69b9":"print(classification_report(y_test,predictions))","b975fae6":"Data Preprocessing"}}