{"cell_type":{"d1ffe35c":"code","8a711a15":"code","3f772b2e":"code","624c32c5":"code","d244f83d":"code","0cda52bf":"code","83d8c0a2":"code","b5e562f7":"code","571eea39":"code","f08c8cb8":"code","93733799":"code","7938d293":"code","43b56db8":"code","fef512b7":"code","11772052":"code","d267e47e":"code","201475a2":"code","0377b6a5":"code","e96a613c":"code","5891a010":"code","c469e1ab":"code","3682c465":"code","cf740fd8":"code","4b451d34":"code","732dd784":"code","ffa8dd92":"code","2f4afa65":"code","75ca59e1":"code","c1f13f64":"code","e78b552b":"code","70a97a7c":"code","ea0d898c":"code","f1b13dab":"code","61fe3b90":"code","f1f299d5":"code","458e7027":"code","e7764d98":"code","6090f7ee":"code","e9255433":"code","c8be7e08":"code","12cded85":"code","f5b26803":"code","b3adf443":"code","e1389661":"code","3e918e38":"code","bf1585b2":"code","e68815e7":"code","7409dfe7":"code","b30bca4e":"code","dc14a5ce":"code","db28cc5a":"code","9e331821":"code","5cda6ab6":"code","f8530ea3":"code","55e9eb46":"code","fbe4a109":"code","846368f7":"code","6d3f3aa9":"markdown","16bfea59":"markdown","cfa1e7bc":"markdown","e0081faf":"markdown","d38fecb6":"markdown","ee91c415":"markdown","981e51b1":"markdown","5dbc3c5e":"markdown"},"source":{"d1ffe35c":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.metrics import accuracy_score, confusion_matrix\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import svm\nimport seaborn as sns\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn import linear_model\nfrom sklearn.neural_network import MLPClassifier","8a711a15":"df = pd.read_csv(\"..\/input\/creditcardfraud\/creditcard.csv\")","3f772b2e":"df.shape","624c32c5":"df.head()","d244f83d":"df.info()","0cda52bf":"df.isna().sum()","83d8c0a2":"df.describe()","b5e562f7":"df1 = df.drop(['Time', 'Amount', 'Class'], axis = 1)","571eea39":"df1.boxplot(figsize = (20,10))\nplt.ylim(-50,50)\nplt.title(\"Boxplots of PCA Variables\", fontsize = 20)","f08c8cb8":"df['Time'].hist(color = 'm', bins = 100)","93733799":"df['Amount'].hist(color = 'g', bins = 1000)\nplt.xlim(0,1500)","7938d293":"sns.boxplot(x=df['Time'], orient = \"v\", fliersize=.7, color = 'm')","43b56db8":"sns.boxplot(x=df['Amount'], orient = \"v\", fliersize=.7, color = 'g')\nplt.ylim(-100,1000)","fef512b7":"df['Class'].value_counts()","11772052":"labels = 'Not Fraud', 'Fraud'\nsizes = [284315, 492]\nexplode = (0, 0.1)  \n\nfig1, ax1 = plt.subplots()\nax1.pie(sizes, explode=explode, labels=labels, autopct='%1.1f%%',\n        shadow=True, startangle=90)\nax1.axis('equal') \n\nplt.show()","d267e47e":"corr = df.corr()","201475a2":"fig, ax = plt.subplots(figsize=(15,15))\nsns.heatmap(corr, \n        xticklabels=corr.columns,\n        yticklabels=corr.columns,\n        vmin = -1.0, vmax = 1.0,\n        center = -.5, annot = False)\n","0377b6a5":"X = df.drop([\"Class\"], axis = 1)","e96a613c":"X.shape","5891a010":"y = df['Class']","c469e1ab":"y.shape","3682c465":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = .3, random_state=9)","cf740fd8":"scaler = StandardScaler().fit(X_train)","4b451d34":"X_train = scaler.transform(X_train)\nX_test = scaler.transform(X_test)","732dd784":"X_train.shape","ffa8dd92":"X_test.shape","2f4afa65":"log_reg = linear_model.LogisticRegression(solver = \"newton-cg\", C=.05)\nlog_reg.fit(X_train, y_train)\nlog_pred = log_reg.predict(X_test)","75ca59e1":"log_acc = accuracy_score(y_test, log_pred)\nprint(log_acc)","c1f13f64":"log_conf = confusion_matrix(y_test, log_pred)\nlog_conf\nlog_df = pd.DataFrame(data=log_conf, columns=[[\"Pred: Legit\",\"Pred: Fraud\"]], index=[[\"Act: Legit\",\"Act: Fraud\"]])\nlog_df","e78b552b":"log_fraud_acc = 88\/(88+68)\nlog_fraud_acc","70a97a7c":"rf = RandomForestClassifier(max_depth=15, random_state=9, n_estimators=100)\nrf.fit(X_train, y_train)\n","ea0d898c":"rf_pred = rf.predict(X_test)","f1b13dab":"rf_acc = accuracy_score(y_test, rf_pred)\nprint(rf_acc)","61fe3b90":"rf_conf = confusion_matrix(y_test, rf_pred)\nrf_conf\nrf_df = pd.DataFrame(data = rf_conf, columns = [['Pred: Legit', 'Pred: Fraud']], index = [['Act: Legit', 'Act: Fraud']])\nrf_df","f1f299d5":"rf_fraud_acc = 118\/(118 + 38)\nrf_fraud_acc","458e7027":"mlp = MLPClassifier(solver = \"sgd\", hidden_layer_sizes=(30,30,30), max_iter=8000, learning_rate=\"adaptive\")\nmlp.fit(X_train, y_train)\n","e7764d98":"mlp_predict = mlp.predict(X_test)","6090f7ee":"mlp_acc = accuracy_score(y_test, mlp_predict)\nmlp_acc","e9255433":"mlp_conf = confusion_matrix(y_test, mlp_predict)\nmlp_conf\nmlp_df = pd.DataFrame(data = mlp_conf, columns = [['Pred: Legit', 'Pred: Fraud']], index = [['Act: Legit', 'Act: Fraud']])\nmlp_df","c8be7e08":"mlp_fraud_acc = 115\/(115 + 41)\nmlp_fraud_acc","12cded85":"# Reducing Sample size do to computational restraints\ndf_sample = df.sample(frac=0.2)","f5b26803":"df_sample.shape","b3adf443":"df_sample['Class'].value_counts()","e1389661":"Xs = df_sample.drop(['Class'], axis=1)","3e918e38":"ys = df_sample['Class']","bf1585b2":"Xs_train, Xs_test, ys_train, ys_test = train_test_split(Xs, ys, test_size = .2, random_state = 9)","e68815e7":"scaler_s = StandardScaler().fit(Xs_train)\nXs_train = scaler_s.transform(Xs_train)\nXs_test = scaler_s.transform(Xs_test)","7409dfe7":"svc = svm.SVC(kernel = 'rbf', gamma = 2, C = 10)","b30bca4e":"svc.fit(Xs_train, ys_train)","dc14a5ce":"svc_pred = svc.predict(Xs_test)","db28cc5a":"svc_acc = accuracy_score(ys_test, svc_pred)\nsvc_acc","9e331821":"svc_conf = confusion_matrix(ys_test, svc_pred)\nsvc_conf\nsvc_df = pd.DataFrame(data = svc_conf, columns = [['Pred: Legit', 'Pred: Fraud']], index = [['Act: Legit', 'Act: Fraud']])\nsvc_df","5cda6ab6":"svc_fraud_acc = 1\/21\nsvc_fraud_acc","f8530ea3":"results = pd.DataFrame({\n    \"Model\":[\"Logistic Regression\",\n            \"Random Forest Classifer\",\n            \"Artificial Neural Network\",\n            \"Support Vector Machine\"],\n    \"Accuracy Score\":[log_acc, rf_acc,\n                     mlp_acc, svc_acc],\n    \"Fraud Accuracy\":[log_fraud_acc, rf_fraud_acc,\n                     mlp_fraud_acc, svc_fraud_acc]\n})","55e9eb46":"results","fbe4a109":"results1 = results.set_index(\"Model\")\nresults2 = results1.sort_values(by=\"Fraud Accuracy\", ascending=False)","846368f7":"ax = results2.plot(kind='bar', title =\"Model Results\", figsize=(7, 5), legend=True, fontsize=12)","6d3f3aa9":"# Results","16bfea59":"# Artificial Neural Network Classifier","cfa1e7bc":"# Exploratory Data Analysis","e0081faf":"# Support Vector Machine","d38fecb6":"# Load Data and Libraries","ee91c415":"# Preprocessing","981e51b1":"# Logistic Regression","5dbc3c5e":"# Random Forest Classifier"}}