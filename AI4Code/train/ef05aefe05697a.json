{"cell_type":{"a5ab0906":"code","e9ff0949":"code","cb6f3333":"code","5d93c6ef":"markdown"},"source":{"a5ab0906":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import mean_absolute_error\nfrom sklearn.tree import DecisionTreeRegressor\n\n\nttrain_data = pd.read_csv(\"..\/input\/petfinder-pawpularity-score\/train.csv\")\nttrain_data.head\n\ntrain_data = ttrain_data.dropna(axis=0)\n\nttest_data = pd.read_csv(\"..\/input\/petfinder-pawpularity-score\/test.csv\")\nttest_data.head()\n\ntest_data = ttest_data.dropna(axis=0)\n\nsubmission_data = pd.read_csv(\"..\/input\/petfinder-pawpularity-score\/sample_submission.csv\")\n\ny = train_data.Pawpularity\n\nfeatures = ['Subject Focus', 'Eyes', 'Face', 'Near', 'Action', 'Accessory','Group', 'Collage','Occlusion', 'Human','Info','Blur']\nX = pd.get_dummies(train_data[features])\nX_train = train_data[features]\n\nmodel = RandomForestClassifier(n_estimators=33,max_depth=2, random_state=1)\nmodel.fit(X, y)\nmodel_predictions = model.predict(X)\nmodel_mae = mean_absolute_error(model_predictions, y)\nprint(\"model MAE for Random Forest Model: {}\".format(model_mae))\n\n# Define the model. Set random_state to 1\nrf_model = DecisionTreeRegressor(max_leaf_nodes=1000, random_state=1)\nrf_model.fit(X_train, y)\nrf_val_predictions = rf_model.predict(X)\nrf_val_mae = mean_absolute_error(rf_val_predictions, y)\nprint(\"rf MAE for Random Forest Model: {}\".format(rf_val_mae))\n\n\npredictions = rf_model.predict(X)\noutput = pd.DataFrame({'Id': train_data.Id, 'Pawpularity': predictions})\noutput.to_csv('submission.csv', index=False)\nprint(\"Your submission was successfully saved!\")\n\n\nprint(\"First in-sample predictions:\", model.predict(X.head()))\nprint(\"First rf in-sample predictions:\", rf_model.predict(X.head()))\nprint(\"Actual target values for those homes:\", y.head().tolist())\n\n\n","e9ff0949":"test_data.describe","cb6f3333":"test","5d93c6ef":"This is my first attempt in \"competing\" for my first competition. As a beginner i have some basic understanding in A.I models and understand the functions of some code. However submitting my csv file, there is a \"Submission Scoring Error\". Any sort of insight or comments on how i can improve would be much appreciated."}}