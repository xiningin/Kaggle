{"cell_type":{"b22eb220":"code","0c820b75":"code","873f8ed1":"code","f9d094da":"code","e1aa716b":"code","923d8a6c":"code","4658a032":"code","35051cdc":"code","687a8eda":"code","98b44ef8":"code","b6488579":"code","4ca86740":"code","83ebbe82":"code","a5dbb3c4":"code","c09d24b8":"code","86a97b76":"code","5c88cdf5":"code","30712915":"code","224bd7ff":"code","97997e7b":"code","32e95146":"code","58ca9a84":"code","9f74c043":"code","5f9e1d05":"code","faf99214":"code","758c5acd":"code","ab3ea37e":"code","0ab6bc83":"code","50350548":"code","3789d6bc":"code","4939b12b":"code","46d3376c":"code","c4f67645":"code","996e8644":"code","9f4a549a":"code","31bc9082":"code","97e781c8":"code","3ab345f4":"code","688e60f4":"code","a763e595":"code","51a4a25b":"code","f781c287":"markdown","e018805a":"markdown","5a050047":"markdown","701b6f06":"markdown","909d5e40":"markdown","a2d5e2e2":"markdown","881af576":"markdown","d9ebd6cd":"markdown","e0a52000":"markdown","249905e5":"markdown","237c916f":"markdown","a3e2f957":"markdown","950870df":"markdown","6b74f62c":"markdown","d2dc41f2":"markdown","604b42ef":"markdown","5f145ab4":"markdown","1fe2d341":"markdown","455444d4":"markdown","58b1c643":"markdown","ec744724":"markdown","e702508b":"markdown","95f1bedb":"markdown","daf52c9f":"markdown","1d8e4500":"markdown","7864d6cd":"markdown","5bb29a0b":"markdown","27ce6957":"markdown"},"source":{"b22eb220":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline","0c820b75":"year_2015 = pd.read_csv(\"\/kaggle\/input\/world-happiness-report\/2015.csv\")\nyear_2016 = pd.read_csv(\"\/kaggle\/input\/world-happiness-report\/2016.csv\")\nyear_2017 = pd.read_csv(\"\/kaggle\/input\/world-happiness-report\/2017.csv\")\nyear_2018 = pd.read_csv(\"\/kaggle\/input\/world-happiness-report\/2018.csv\")\nyear_2019 = pd.read_csv(\"\/kaggle\/input\/world-happiness-report\/2019.csv\")\nyear_2020 = pd.read_csv(\"\/kaggle\/input\/world-happiness-report\/2020.csv\")","873f8ed1":"year_2015 = year_2015[['Country','Happiness Score','Economy (GDP per Capita)', 'Family',\n                       'Health (Life Expectancy)', 'Freedom', 'Trust (Government Corruption)',\n                       'Generosity']]\nyear_2015['Year'] = 2015\nyear_2015.rename(columns = {'Happiness Score': 'Score', 'Economy (GDP per Capita)': 'Economy',\n                                                        'Health (Life Expectancy)': 'Health', \n                                                        'Trust (Government Corruption)': 'Trust'}, inplace = True)\n\n\n\nyear_2016 = year_2016[['Country', 'Happiness Score','Economy (GDP per Capita)', 'Family', \n                       'Health (Life Expectancy)','Freedom', 'Trust (Government Corruption)', \n                       'Generosity']]\nyear_2016['Year'] = 2016\nyear_2016.rename(columns = {'Happiness Score': 'Score', 'Economy (GDP per Capita)': 'Economy',\n                            'Health (Life Expectancy)': 'Health','Trust (Government Corruption)': 'Trust'}, \n                 inplace = True)\n\n\n\nyear_2017 = year_2017[['Country', 'Happiness.Score', 'Economy..GDP.per.Capita.', 'Family',\n                       'Health..Life.Expectancy.', 'Freedom', 'Trust..Government.Corruption.',\n                       'Generosity']]\nyear_2017['Year'] = 2017\nyear_2017.rename(columns = {'Happiness.Score': 'Score', 'Economy..GDP.per.Capita.': 'Economy',\n                            'Health..Life.Expectancy.': 'Health','Trust..Government.Corruption.': 'Trust'}, \n                 inplace = True)\n\n\n\nyear_2018 = year_2018[['Country or region', 'Score', 'GDP per capita', 'Social support', \n                       'Healthy life expectancy','Freedom to make life choices','Perceptions of corruption',\n                       'Generosity']]\nyear_2018['Year'] = 2018\nyear_2018.rename(columns = {'Country or region': 'Country', 'GDP per capita': 'Economy','Social support':'Family',\n                            'Healthy life expectancy': 'Health', 'Freedom to make life choices':'Freedom',\n                            'Perceptions of corruption': 'Trust'}, inplace = True)\n\n\n\nyear_2019 = year_2019[['Country or region', 'Score', 'GDP per capita','Social support',\n                       'Healthy life expectancy','Freedom to make life choices','Perceptions of corruption',\n                       'Generosity']]\nyear_2019['Year'] = 2019\nyear_2019.rename(columns = {'Country or region': 'Country', 'GDP per capita': 'Economy','Social support':'Family',\n                            'Healthy life expectancy': 'Health', 'Freedom to make life choices':'Freedom',\n                            'Perceptions of corruption': 'Trust'}, inplace = True)\n\n\n\nyear_2020 = year_2020[['Country name', 'Ladder score','Logged GDP per capita', 'Social support', \n                       'Healthy life expectancy', 'Freedom to make life choices', 'Perceptions of corruption',\n                       'Generosity']]\nyear_2020['Year'] = 2020\nyear_2020.rename(columns = {'Country name': 'Country','Ladder score': 'Score', 'Logged GDP per capita': 'Economy',\n                            'Social support':'Family', 'Healthy life expectancy': 'Health', \n                            'Freedom to make life choices':'Freedom','Perceptions of corruption': 'Trust'},\n                 inplace = True)","f9d094da":"frames = [year_2015, year_2016, year_2017, year_2018, year_2019, year_2020]\ndf = pd.concat(frames)","e1aa716b":"df.head()","923d8a6c":"df.shape","4658a032":"df['Positive'] = df ['Family'] + df['Health'] + df ['Freedom'] + df ['Generosity']\ndf['Negative'] = df['Trust'] + df['Economy'] ","35051cdc":"sns.boxplot('Year','Score',data=df)","687a8eda":"Top = df.groupby('Country').sum().sort_values(by='Score',ascending=False).drop('Year', axis=1)[:10]\nplt.figure(figsize=(10,3))\nTop['Score'].plot()","98b44ef8":"fig = plt.figure(figsize = (16, 8))\n(ax1, ax2,ax3), (ax4,ax5, ax6) = fig.subplots(2,3)\n\n\nax1.set_title(\"Trust in the government 2015\")\ndf[df['Year'] == 2015][['Country','Trust']][:10].set_index('Country').plot(kind='bar', ax=ax1, legend=False)\n\nax2.set_title(\"Trust in the government 2016\")\ndf[df['Year'] == 2016][['Country','Trust']][:10].set_index('Country').plot(kind='bar', ax=ax2, legend=False)\n\nax3.set_title(\"Trust in the government 2017\")\ndf[df['Year'] == 2017][['Country','Trust']][:10].set_index('Country').plot(kind='bar', ax=ax3, legend=False)\n\nax4.set_title(\"Trust in the government 2018\")\ndf[df['Year'] == 2018][['Country','Trust']][:10].set_index('Country').plot(kind='bar', ax=ax4, legend=False)\n\nax5.set_title(\"Trust in the government 2019\")\ndf[df['Year'] == 2019][['Country','Trust']][:10].set_index('Country').plot(kind='bar', ax=ax5, legend=False)\n\nax6.set_title(\"Trust in the government 2020\")\ndf[df['Year'] == 2020][['Country','Trust']][:10].set_index('Country').plot(kind='bar', ax=ax6, legend=False)\n\nplt.tight_layout(pad=0.3)","b6488579":"table = pd.pivot_table(df, values=['Freedom','Trust','Family'], index=['Year'],aggfunc=np.sum)\ntable.plot(kind='bar',figsize=(8,4))\nplt.legend(shadow=True)","4ca86740":"plt.figure(figsize=(8,3))\nsns.lineplot(x = \"Year\", y = \"Economy\", data=df, label='Economy')\nsns.lineplot(x = \"Year\", y = \"Family\", data=df, label='Family')\nplt.legend(shadow=True)","83ebbe82":"plt.figure(figsize=(8,4))\nsns.lineplot(x='Year', y='Freedom', data=df, label='Freedom')\nsns.lineplot(x='Year', y='Trust', data=df, label='Trust')\nsns.lineplot(x='Year', y='Generosity', data=df, label='Generosity') \nplt.legend(shadow=True)","a5dbb3c4":"plt.figure(figsize=(10,3))\n\nplt.subplot(1,2,1)\ndf.Freedom.hist(bins=10)\nplt.xlabel(\"Freedom\")\nplt.title(\"Freedom range and its frequency\")\n\nplt.subplot(1,2,2)\ndf.Family.hist(bins=10)\nplt.xlabel(\"Family\")\nplt.title(\"Family range and its frequency\")\n\nplt.tight_layout(pad=0.3)","c09d24b8":"plt.figure(figsize=(10,3))\n\nplt.subplot(1,2,1)\ndf.Trust.hist(bins=10)\nplt.xlabel(\"Trust\")\nplt.title(\"Trust range and its frequency\")\n\nplt.subplot(1,2,2)\ndf.Generosity.hist(bins=10)\nplt.xlabel(\"Generosity\")\nplt.title(\"Generosity range and its frequency\")\n\nplt.tight_layout(pad=0.3)","86a97b76":"sns.boxplot('Year','Generosity',data=df)","5c88cdf5":"Happy = df.groupby('Country').sum().sort_values(by='Score',ascending=False).drop('Year', axis=1)[:50]\nLeast = df.groupby('Country').sum().sort_values(by='Score',ascending=False).drop('Year', axis=1)[-50:]","30712915":"plt.figure(figsize=(10,8))\n\nplt.subplot(2,2,1)\nplt.title(\"Economy of top 10 Happy countries\")\nHappy['Economy'][:10].plot(kind='bar')\n\nplt.subplot(2,2,2)\nplt.title(\"Trust in government of top 10 Happy countries\")\nHappy['Trust'][:10].plot(kind='bar')\n\nplt.subplot(2,2,3)\nplt.title(\"Economy of top 10 least happy countries\")\nLeast['Economy'][-10:].plot(kind='bar')\n\n\nplt.subplot(2,2,4)\nplt.title(\"Trust in government of top 10 least happy countries\")\nLeast['Trust'][-10:].plot(kind='bar')\n\nplt.tight_layout(pad=0.3)","224bd7ff":"plt.figure(figsize=(10,3))\n\nplt.subplot(1,2,1)\nplt.title(\"Generosity of top 10 Happy countries\")\nHappy['Generosity'][:10].plot(kind='barh')\n\nplt.subplot(1,2,2)\nplt.title(\"Generosity of top 10 least happy countries\")\nLeast['Generosity'][-10:].plot(kind='barh')\n\nplt.tight_layout(pad=0.3)","97997e7b":"plt.figure(figsize=(14,5))\n\nplt.subplot(1,2,1)\nplt.title(\"Relation of variables in happy countries\")\ncorrealtion_happy = Happy.corr()\nsns.heatmap(correaltion_happy)\n\nplt.subplot(1,2,2)\nplt.title(\"Relation of variables in least happy countries\")\ncorrealtion_Least = Least.corr()\nsns.heatmap(correaltion_Least)\n\nplt.tight_layout(pad=0.3)","32e95146":"plt.figure(figsize=(15,3))\n\nplt.suptitle(\"Correlation Between Attributes\")\n\nplt.subplot(1,2,1)\nplt.title(\"Postive Correlation\")\nplt.scatter(Happy['Health'],Happy['Positive'], marker='v')\nplt.xlabel(\"Health\")\nplt.ylabel(\"Positive\")\n\nplt.subplot(1,2,2)\nplt.title(\"No Correlation\")\nplt.scatter(Happy['Economy'],Happy['Freedom'], marker='v')\nplt.xlabel(\"Economy\")\nplt.ylabel(\"Freedom\")","58ca9a84":"plt.figure(figsize=(15,3))\n\nplt.suptitle(\"Correlation Between Attributes\")\n\nplt.subplot(1,2,1)\nplt.title(\"Postive Correlation\")\nplt.scatter(Least['Economy'],Least['Negative'], marker='v')\nplt.xlabel(\"Economy\")\nplt.ylabel(\"Negative\")\n\nplt.subplot(1,2,2)\nplt.title(\"No Correlation\")\nplt.scatter(Least['Economy'],Least['Health'], marker='v')\nplt.xlabel(\"Economy\")\nplt.ylabel(\"Health\")","9f74c043":"def showbox():\n    \n    plt.figure(figsize = (16, 5))\n\n    plt.subplot(2,3,1)\n    sns.boxplot('Score',data=df)\n\n    plt.subplot(2,3,2)\n    sns.boxplot('Economy',data=df)\n\n    plt.subplot(2,3,3)\n    sns.boxplot('Family',data=df)\n\n    plt.subplot(2,3,4)\n    sns.boxplot('Health',data=df)\n\n    plt.subplot(2,3,5)\n    sns.boxplot('Freedom',data=df)\n\n    plt.subplot(2,3,6)\n    sns.boxplot('Trust',data=df)\n\n    plt.tight_layout(pad=0.3)","5f9e1d05":"showbox()","faf99214":"outlier = 1\nwhile outlier > 0:\n    Q1 = df.quantile(0.25)\n    Q3 = df.quantile(0.75)\n    IQR = Q3 - Q1\n    lower_bound = Q1 - (IQR * 1.5)\n    upper_bound = Q3 + (IQR * 1.5)\n    outlier = len(np.where((df > upper_bound) | (df < lower_bound))[0]) \n    df = df[~((df < (Q1 - 1.5 * IQR)) |(df > (Q3 + 1.5 * IQR))).any(axis=1)]","758c5acd":"from sklearn.preprocessing import LabelEncoder\nencoder = LabelEncoder()\n\ndf['Year'] = encoder.fit_transform(df['Year'])","ab3ea37e":"df.head()","0ab6bc83":"from sklearn.model_selection import train_test_split \nfrom sklearn.preprocessing import RobustScaler\n\nfrom sklearn.pipeline import make_pipeline\n\nfrom sklearn.linear_model import Lasso, LinearRegression, RidgeCV\nfrom sklearn.ensemble import GradientBoostingRegressor\nfrom sklearn.kernel_ridge import KernelRidge\nimport xgboost as xgb","50350548":"X = df.drop(['Score','Country'], axis=1)\ny = df['Score']\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.30, random_state=42)","3789d6bc":"lrm = LinearRegression(normalize=True)\nlrm.fit(X_train,y_train)\npredictionslrm = lrm.predict(X_test)","4939b12b":"scorelrm = round((lrm.score(X_test, y_test)*100),2)\nprint (\"Model Score:\",scorelrm,\"%\")","46d3376c":"model_RFR = RidgeCV(cv=3)\nmodel_RFR.fit(X_train, y_train)\npredictionsRFR = model_RFR.predict(X_test)","c4f67645":"scoreRFR = round((model_RFR.score(X_test, y_test)*100),2)\nprint (\"Model Score:\",scoreRFR,\"%\")","996e8644":"lasso = make_pipeline(RobustScaler(), Lasso(alpha =0.0005, random_state=42, max_iter=4000))\nlasso.fit(X_train, y_train)\npredictionslasso = lasso.predict(X_test)","9f4a549a":"scorelasso = round((lasso.score(X_test, y_test)*100),2)\nprint (\"Model Score:\",scorelasso,\"%\")","31bc9082":"KRR = KernelRidge(alpha=0.6, kernel='polynomial', degree=2)\nKRR.fit(X_train, y_train)\npredictionsKRR = KRR.predict(X_test)","97e781c8":"scoreKRR = round((KRR.score(X_test, y_test)*100),2)\nprint (\"Model Score:\",scoreKRR,\"%\")","3ab345f4":"GBoost = GradientBoostingRegressor(learning_rate=0.005, max_depth=3,n_estimators=2200,\n                                   random_state =42)\nGBoost.fit(X_train, y_train)\npredictionsGBoost = GBoost.predict(X_test)","688e60f4":"scoreGBoost = round((GBoost.score(X_test, y_test)*100),2)\nprint (\"Model Score:\",scoreGBoost,\"%\")","a763e595":"model_xgb = xgb.XGBRegressor(learning_rate=0.005, max_depth=3, \n                             min_child_weight=1.7, n_estimators=2200,\n                             random_state =42)\nmodel_xgb.fit(X_train, y_train)\npredictionsxgb = model_xgb.predict(X_test)","51a4a25b":"scorexgb = round((model_xgb.score(X_test, y_test)*100),2)\nprint (\"Model Score:\",scorexgb,\"%\")","f781c287":"The above is a depiction of the top 10 happiest countries in the world and their trust in the government. We observe in the year 2020, many countries have lost their trust in the government. Iceland is the only country that has an increasing trust in their government over the years.","e018805a":"## Data Cleaning","5a050047":"# World Happiness ","701b6f06":"\nThe world happiness report is an annual report that is published by the United Nations Sustainable Development Solutions Network. This survey was formerly taken in the year 2012. The world happiness report records the happiness score for 156 countries based on various attributes.  The attributes used in this notebook are as follows:<br>\n<li>Country\n<li>Score\n<li>Economy\n<li>Family\n<li>Health\n<li>Freedom\n<li>Trust\n<li>Generosity\n<li>Year<br>\nIn this notebook, we use the \"World Happiness\" dataset for the year 2015-2020 and try to understand the factors that influence the score of happiness. Later, we will play around with the dataset and build a predictive model.<br> A detailed visual report can be viewed in the below Tableau Public links.<br><br>\n1. <a href=\"https:\/\/public.tableau.com\/profile\/ginelle.d.souza#!\/vizhome\/1WorldHappiness\/Happinesswithrespecttocountries\">Happiness per country<\/a><br>\n2. <a href=\"https:\/\/public.tableau.com\/profile\/ginelle.d.souza#!\/vizhome\/2WorldHappiness\/Relationofattributeswithoneanother\">Relation between attributes<\/a><br>\n3. <a href=\"https:\/\/public.tableau.com\/profile\/ginelle.d.souza#!\/vizhome\/3WorldHappiness\/Impactoftrustandeconomyonhappiness\">Impact of trust and economy<\/a><br>\n4. <a href=\"https:\/\/public.tableau.com\/profile\/ginelle.d.souza#!\/vizhome\/4WorldHappiness\/EffectofEconomyonFreedom\">Effect of Economy on Freedom<\/a>","909d5e40":"## 5. Gradient Boosting Regression","a2d5e2e2":"For the purpose of Data Modeling we need to split our data into training and test set. Once the split is done we can put our data into various models and check the precision of each model. We select the model with the highest precision score.","881af576":"![image.png](attachment:image.png)","d9ebd6cd":"The economy has increased over time.","e0a52000":"## 1. LinearRegression","249905e5":"## 2.Ridge Cross-Validation","237c916f":"Generosity among people experiences a downfall. Negative values are observed that indicate our generosity does not exist this year.","a3e2f957":"# Data Modeling","950870df":"We observe that there may not be many factors that influence the happiness score for happier countries. But certainly, many factors determine the score for other countries such as health, economy, freedom, positives, and negatives.","6b74f62c":"In countries that have a higher happiness score, we observe that they have a well-built economy than those with a lower happiness score. Comparatively, the trust in the government among higher and lower scored countries, the countries with low happiness scores have less than the average trust in their government. Whereas some countries with a higher have good faith in their government.","d2dc41f2":"<li>Although for some the happiness score may have increased in the year 2020 many countries faced a downfall of score never seen in 5 years.\n<li>Finland ranks first for 3 consecutive years with the highest score being 7.5.\n<li>Trust in the government and support of family has fallen over the years.\n<li>In the year 2020, generosity among people has faced a sharp impact.\n<li>There is a vast difference in the economic state of countries, which may be a big factor impacting the happiness of the countries.\n<li>New Zealand and Iceland are the most generous country whereas The Gambia, although having a lower happiness are very generous to their people.\n<li>Many factors influence the happiness score some of them are: health, economy, and freedom.","604b42ef":"Over the years, freedom and generosity have perpetually been more than trust in governments. The last year has made drastic changes in these attributes. Generosity among people experiences an abrupt fall. Whereas, Freedom and Trust in the government have increased.  ","5f145ab4":"Over the years, for the four attributes: freedom, family, trust, and generosity, we can assert that many countries endured about 40-55% freedom in their countries. Trusting a government differs from nations, but it appears like many countries have very low faith in their government. People are generosity scales between 10-25%. Whereas, the support given by families is large.","1fe2d341":"There is a massive drop in the number of family support received by individuals in 2020, but we observe an increase in freedom of speech among the people and trust in the government.","455444d4":"## Data Visualization","58b1c643":"## 3. Lasso Regression","ec744724":"# Summary Of Observations","e702508b":"Finland has the highest cummulative happiness score for the given 6 years.","95f1bedb":"The year 2020 has the lowest happiness score as compared to the rest of the years  ","daf52c9f":"## 6. XGBoost","1d8e4500":"Realations between attributes.","7864d6cd":"New Zealand and Iceland prove to be the most generous country. The Gambia, although having a lower happiness score does not hold back at being generous to their people.","5bb29a0b":"We see there are many outliers present in our dataset. Thus before modeling the data, we deal with these outliers.","27ce6957":"## 4. Kernel Ridge Regression"}}