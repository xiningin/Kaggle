{"cell_type":{"913fea37":"code","a3b15a1d":"code","44795c4f":"code","746aed18":"code","eec604f8":"code","d119bc6d":"code","214f5093":"code","7c513fd9":"code","04b4660e":"code","c73fd8b5":"code","c0bcf2ac":"code","69652e9e":"code","cffa2a70":"code","80a82bd4":"code","42cdb4fb":"code","c60da13c":"code","0f7b7147":"code","826b6452":"code","6ae511d3":"code","5d90a022":"code","97e648a8":"code","b481ce6a":"code","958cd6ad":"code","2f305659":"code","2747697b":"code","44474f60":"code","cb9a9401":"code","595fb78d":"code","24c990da":"code","724ac5b7":"code","06e17a2c":"code","18ef80b9":"code","05c0ebf4":"code","dd4eb362":"code","7a279b9b":"markdown","e517330d":"markdown","4073781d":"markdown","68821e86":"markdown","f51e796f":"markdown","97c77cad":"markdown","36f3c345":"markdown","c9da26d6":"markdown","9d3f7745":"markdown","b5a55fc9":"markdown","818efb63":"markdown","fdf79776":"markdown","48b829bc":"markdown"},"source":{"913fea37":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score, classification_report, confusion_matrix\n\nfrom sklearn.svm import SVC\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier","a3b15a1d":"data_frame = pd.read_csv(\"\/kaggle\/input\/heart-disease-uci\/heart.csv\")","44795c4f":"data_frame.head()","746aed18":"data_frame.describe()","eec604f8":"data_frame.info()","d119bc6d":"data_frame.rename(columns={\"age\": \"Age\", \"sex\": \"Gender\", \"cp\": \"ChestPainType\", \"trestbps\": \"RestingBP\",\n                          \"chol\": \"SerumCholestoral\", \"fbs\": \"FastingBP\", \"restecg\": \"RestingECG\", \"thalach\": \"MaxHeartRate\",\n                          \"exang\": \"Excercise\", \"oldpeak\": \"Depression\", \"slope\": \"Slope\", \"ca\": \"Vessels\", \"thal\": \"Thalassemia\",\n                          \"target\": \"Target\"}, inplace=True)","214f5093":"data_frame.hist(figsize=(15,10))\nplt.show()","7c513fd9":"plt.figure(figsize=(5, 5))\nsns.countplot(x=\"Target\", data=data_frame)\nplt.title(\"Target Count Plot\")\nplt.show()","04b4660e":"plt.figure(figsize=(10,5))\nplt.subplot(1,2,1)\nsns.countplot(x=\"ChestPainType\", data=data_frame)\nplt.title(\"Chest Pain Types Count\")\nplt.subplot(1,2,2)\nsns.countplot(x=\"ChestPainType\", hue=\"Target\", data=data_frame)\nplt.title(\"Chest Pain Type vs Target\")\nplt.show()","c73fd8b5":"plt.figure(figsize=(10, 5))\nsns.countplot(x=\"Excercise\", hue=\"Target\", data=data_frame)","c0bcf2ac":"plt.figure(figsize=(10, 5))\nsns.countplot(x=\"Gender\", hue=\"Target\", data=data_frame, palette=\"bwr\")\nplt.title(\"Gender Count vs Target\")\nplt.show()","69652e9e":"plt.figure(figsize=(10, 5))\nsns.scatterplot(x=\"Age\", y=\"MaxHeartRate\", hue=\"Target\", data=data_frame)\nplt.title(\"Age vs Max Heart Rate\")\nplt.show()","cffa2a70":"plt.figure(figsize=(10,5))\nsns.distplot(data_frame[\"Age\"], bins=50)\nplt.title(\"Age Ditribution\")\nplt.show()","80a82bd4":"young_age = data_frame[(data_frame[\"Age\"] >= 29) & (data_frame[\"Age\"] < 40)]\nmiddle_age = data_frame[(data_frame[\"Age\"] >= 40) & (data_frame[\"Age\"] < 55)]\nelder_age = data_frame[(data_frame[\"Age\"] > 55)]","42cdb4fb":"plt.figure(figsize=(15,10))\nplt.subplot(2,2,1)\nsns.barplot(x=[\"Young Age\", \"Middle Age\", \"Elder Age\"], y=[len(young_age), len(middle_age), len(elder_age)], palette=\"rocket\")\nplt.title(\"Different Age Counts\")\nplt.subplot(2,2,2)\nsns.countplot(x=young_age[\"Age\"], hue=young_age[\"Target\"], data=data_frame, palette=\"husl\")\nplt.title(\"Young Age Count Plot\")\nplt.subplot(2,2,3)\nsns.countplot(x=middle_age[\"Age\"], hue=middle_age[\"Target\"], data=data_frame, palette=\"deep\")\nplt.title(\"Middle Age Count Plot\")\nplt.subplot(2,2,4)\nsns.countplot(x=elder_age[\"Age\"], hue=elder_age[\"Target\"], data=data_frame, palette=\"hls\")\nplt.title(\"Elder Age Count Plot\")\nplt.show()","c60da13c":"plt.figure(figsize=(12,10))\nsns.heatmap(data_frame.corr(), linewidths=0.05, fmt= \".2f\", cmap=\"YlGnBu\", annot=True)\nplt.title(\"Correlation Plot\")\nplt.show()","0f7b7147":"data_frame = pd.get_dummies(data_frame, columns=[\"ChestPainType\", \"RestingECG\", \"Excercise\", \"Vessels\", \"Slope\", \"Thalassemia\"])","826b6452":"X = data_frame.drop(\"Target\", axis=1)\nY = data_frame[\"Target\"]","6ae511d3":"min_max_scaler = MinMaxScaler()\ndata_frame[\"RestingBP\"] = min_max_scaler.fit_transform(data_frame[\"RestingBP\"].values.reshape(-1, 1))\ndata_frame[\"Depression\"] = min_max_scaler.fit_transform(data_frame[\"Depression\"].values.reshape(-1, 1))\ndata_frame[\"MaxHeartRate\"] = min_max_scaler.fit_transform(data_frame[\"MaxHeartRate\"].values.reshape(-1, 1))\ndata_frame[\"SerumCholestoral\"] = min_max_scaler.fit_transform(data_frame[\"SerumCholestoral\"].values.reshape(-1, 1))","5d90a022":"X_Scale = data_frame.drop(\"Target\", axis=1)\nY_Scale = data_frame[\"Target\"]","97e648a8":"x_train, x_test, y_train, y_test = train_test_split(X, Y, test_size=0.2, random_state=42)\nx_train_scale, x_test_scale, y_train_scale, y_test_scale = train_test_split(X_Scale, Y_Scale, test_size=0.2, random_state=42)","b481ce6a":"def model_evaluation(y_test, y_preds, model_name):\n    \n    accuracy = accuracy_score(y_test, y_preds) * 100\n    print(\"************ Accuracy Score ************\")\n    print(accuracy)\n    print(\"\\n\\n************ Classification Report ************\")\n    print(classification_report(y_test, y_preds))\n    print(\"\\n\\n************ Confusion Matrix ************\")\n    sns.heatmap(confusion_matrix(y_preds, y_test), annot = True, fmt = \".0f\", cmap = \"YlGnBu\")\n    plt.title(\"{} Validation Matrix\\n\\n\".format(model_name))\n    plt.show()\n    \n    return accuracy","958cd6ad":"random_forest_model = RandomForestClassifier(criterion=\"entropy\", max_depth=5)\nrandom_forest_model.fit(x_train, y_train)\nrandom_forest_pred = random_forest_model.predict(x_test)","2f305659":"rf_accuracy = model_evaluation(y_test, random_forest_pred, \"Random Forest\")","2747697b":"logistic_regression_model = LogisticRegression()\nlogistic_regression_model.fit(x_train, y_train)\nlr_model_preds = logistic_regression_model.predict(x_test)","44474f60":"lr_accuracy = model_evaluation(y_test, lr_model_preds, \"Logistic Regression\")","cb9a9401":"svm_model = SVC(kernel=\"linear\")\nsvm_model.fit(x_train, y_train)\nsvm_preds = svm_model.predict(x_test)","595fb78d":"svm_accuracy = model_evaluation(y_test, svm_preds, \"SVM\")","24c990da":"decision_tree_model = DecisionTreeClassifier(criterion=\"entropy\")\ndecision_tree_model.fit(x_train, y_train)\ndt_preds = decision_tree_model.predict(x_test)","724ac5b7":"dt_accuracy = model_evaluation(y_test, dt_preds, \"Decision Tree\")","06e17a2c":"score_list = []\nfor i in range(1,20):\n    knn_model = KNeighborsClassifier(n_neighbors=i)\n    knn_model.fit(x_train_scale, y_train_scale)\n    score_list.append(knn_model.score(x_test_scale, y_test_scale))\n    \nplt.plot(range(1,20), score_list)\nplt.xticks(np.arange(1,20,1))\nplt.xlabel(\"K value\")\nplt.ylabel(\"Score\")\nplt.show()\n\naccuracy = max(score_list)\nbest_k = score_list.index(accuracy) + 1\nprint(\"Best KNN Model Score: {}\".format(accuracy * 100))\nprint(\"Best K Value: {}\".format(best_k))\n","18ef80b9":"knn_model = KNeighborsClassifier(n_neighbors = 3)\nknn_model.fit(x_train_scale, y_train_scale)\nknn_preds = knn_model.predict(x_test_scale)","05c0ebf4":"knn_accuracy = model_evaluation(y_test_scale, knn_preds, \"KNN\")","dd4eb362":"x = [\"Random Forest\", \"Logistic Regression\", \"Decision Tree\", \"SVM\", \"KNN\"]\ny = [rf_accuracy, lr_accuracy, dt_accuracy, svm_accuracy, knn_accuracy]\nplt.bar(x=x, height=y)\nplt.title(\"Algorithm Accuracy Comparison\")\nplt.xticks(rotation=15)\nplt.xlabel(\"Algorithms\")\nplt.ylabel(\"Accuracy\")\nplt.show()","7a279b9b":"### Rename Columns","e517330d":"## 2. Load Data Set","4073781d":"#### Random Forest Classifier","68821e86":"## 4. Basic EDA","f51e796f":"## 1. Import Required Libraries","97c77cad":"## 5. Feature Engineering","36f3c345":"#### KNN","c9da26d6":"#### Support Vector Classifier","9d3f7745":"## 6. Model Fitting","b5a55fc9":"### Few column values are scaled, these scaled values will be used for KNN algorithm","818efb63":"#### Logistic Regression","fdf79776":"## 3. Preview And Understand Data","48b829bc":"#### Decision Tree Classifier"}}