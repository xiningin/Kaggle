{"cell_type":{"4210c206":"code","fe47ac72":"code","e9fb51a4":"code","5ded0ce4":"code","2c2f6728":"code","270bd73c":"code","c2f0ab11":"code","116a23d7":"code","837d3110":"markdown"},"source":{"4210c206":"import numpy as np\nimport pandas as pd\nfrom pandas.io.json import json_normalize\n\nfrom requests import Request, Session\nfrom requests.exceptions import ConnectionError, Timeout, TooManyRedirects\nimport json\n\nfrom bs4 import BeautifulSoup\nimport requests\n\nfrom tqdm import tqdm_notebook as tqdm\nimport time","fe47ac72":"def get_data(c,start='20130428',end='20190528'):\n    url = 'https:\/\/coinmarketcap.com\/currencies\/'+c+'\/historical-data\/?start='+start+'&end='+end\n    url=url.replace(' ','-')\n    content = requests.get(url).content\n    soup = BeautifulSoup(content,'html.parser')\n\n    #         time.sleep(1)\n\n    table = soup.find('table', {'class': 'table'})\n    data = [[td.text.strip() for td in tr.findChildren('td')] \n            for tr in table.findChildren('tr')]\n    df = pd.DataFrame(data)\n    df.drop(df.index[0], inplace=True) # first row is empty\n    df[0] =  pd.to_datetime(df[0]) # date\n    for i in range(1,7):\n        df[i] = pd.to_numeric(df[i].str.replace(\",\",\"\").str.replace(\"-\",\"\")) # some vol is missing and has -\n    df.columns = ['Date','Open','High','Low','Close','Volume','Market Cap']\n    df['Name']=c\n    return df\n","e9fb51a4":"df_total=pd.DataFrame() \ndf_list=[]\nfor c in tqdm(['bitcoin-cash','bitcoin','dash','dogecoin','ethereum','iota','litecoin','nem','neo']):\n    print(c)\n    try:\n        df_tmp=get_data(c)\n        df_list.append(df_tmp)\n    except:\n        print('failed to parse for :%s'%(c))\n        \n# df_total=pd.concat(df_list)\n# df_total=df_total.sort_values(by=['Name','Date']).reset_index()\n# df_total\nprint(len(df_list))","5ded0ce4":"df_total=pd.concat(df_list)\ndf_total=df_total.sort_values(by=['Name','Date']).reset_index(drop=True)\ndf_total.to_csv('crypto_amit_may28.csv', index=False)","2c2f6728":"df_total[df_total.Name=='bitcoin'].reset_index()['Market Cap'].plot()\ndf_total[df_total.Name=='ethereum'].reset_index()['Market Cap'].plot()","270bd73c":"print(df_total[df_total.Name=='bitcoin'].shape)\nprint(df_total[df_total.Name=='ethereum'].shape)","c2f0ab11":"!ls ","116a23d7":"df_total","837d3110":"## the following blocks of codes collect cryptocurrency related data by webscrapping and finally a dataframe is produced."}}