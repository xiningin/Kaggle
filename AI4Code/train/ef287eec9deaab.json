{"cell_type":{"1cb3ce98":"code","fbae4710":"code","4448f049":"code","8b1685fe":"code","9db316fe":"code","27640fd7":"code","a14aa3f4":"code","085df627":"code","4cbccb41":"code","153b746e":"code","8f3a6ccc":"code","34c60f1a":"code","24df4843":"code","5e70285a":"code","aae47b19":"code","b7f7da6c":"code","b9e32df9":"code","376d2e82":"code","d3427d47":"code","6ff47776":"code","02be3448":"code","c3dd1d4d":"code","04972ae9":"code","9996ac07":"code","d99ef246":"code","919454db":"code","ce717c0f":"code","23da975a":"code","8e2f8564":"code","d8e59c3a":"code","d4d79bce":"code","64741db5":"code","48f08fdf":"code","13be5002":"code","73be6486":"code","0afc1611":"code","4cae3927":"code","f52e4cba":"code","82bf7f8f":"code","430ed141":"code","acc57b55":"code","8c3b0488":"code","3e4ddfbe":"code","50ee1d0b":"code","699f77a1":"code","7fda6d2a":"code","21a9b1ca":"code","dbf0a7e1":"code","6e967970":"code","e056a8ce":"code","5c1d065d":"markdown","3048061c":"markdown","32e9aca2":"markdown","43c27057":"markdown","7b040c10":"markdown","30fec882":"markdown","5e6d3aa2":"markdown","2ac32eba":"markdown","9d49e0c7":"markdown","36e8b73d":"markdown","c0b411f9":"markdown","2aaa6eb8":"markdown","c71a354d":"markdown","046ecbe5":"markdown","27041e2b":"markdown","2e3ca9b5":"markdown","d88eb23c":"markdown","b739e329":"markdown","eabb3dda":"markdown"},"source":{"1cb3ce98":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","fbae4710":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","4448f049":"df = pd.read_excel('\/kaggle\/input\/global-super-store-dataset\/Global_Superstore2.xlsx')","8b1685fe":"df.head()","9db316fe":"df.info()","27640fd7":"df.shape","a14aa3f4":"df.describe()\n# can see that there is negetive trend in profit\n# in sales  data is either right skewed or there are too many outliers\n# the discount falls in the range of 75% - 100%","085df627":"df.isnull().sum()","4cbccb41":"# We can see that only the postal code attribute has 41,296 null vlues. Thats almost 80 % of the values in the column are null","153b746e":"df.isnull().sum()","8f3a6ccc":"cat_cols = df.select_dtypes(exclude=['int64','float64']).columns\ncat_cols","34c60f1a":"# num_cols = df.select_dtypes(include=['int64', 'float64']).columns\nnum_colms = df._get_numeric_data()\nnum_colms.head()\n# df['Ship Mode'].unique()\n# df['Ship Mode'].value_counts()\n# df['Segment'].value_counts()\n# df['Market'].value_counts()\n# df['Region'].value_counts()\n# df['Category'].value_counts()\n# df['Sub-Category'].value_counts()\n# df['Product Name'].value_counts()\n# df['Order Priority'].value_counts()","24df4843":"# purchase frequency = no of orders \/ no of unique customers (365 days)\n# df['Order ID'].groupby('Customer ID').count()","5e70285a":"df.nunique()","aae47b19":"df_customer = df[['Customer ID','Order ID','Order Date', 'Ship Date', 'Ship Mode','Country']]\n# .drop_duplicates()\ndf_customer.count()","b7f7da6c":"df_customer1 = df[['Customer ID','Order ID','Order Date', 'Ship Date', 'Ship Mode','Country']].drop_duplicates()\ndf_customer1.count()","b9e32df9":"# df2 = df.drop_duplicates()\n# df2.shape\n# df_customer[[df_customer['Customer ID','Order ID','Order Date']].duplicated() == True]\n# df_customer['Customer ID'].nunique()\ndf_customer1.head()","376d2e82":"df_customer1['Customer ID'].nunique()\n# there are only 1590 unique customer ids out of 25754 rows in the customer data","d3427d47":"# First_Purchase_Date = pd.to_datetime(df['Order Date']).min()\n# latest_purchase_date = pd.to_datetime(df['Order Date']).max()\n# Total_shipping_cost = df['Shipping Cost'].sum()\n# total_sales = df['Sales'].sum()\n# unique_order_id = df['Order_id'].nunique()\n\n\ndef new_features(x):\n    d = []\n    d.append(x['Order ID'].nunique())\n    d.append(x['Sales'].sum())\n    d.append(x['Shipping Cost'].sum())\n    d.append(pd.to_datetime(x['Order Date']).min())\n    d.append(pd.to_datetime(x['Order Date']).max())\n    d.append(x['City'].nunique())\n    return pd.Series(d, index=['Purchases','Total_Sales','Total_Cost','First_Purchase_Date','Latest_Purchase_Date','Location_Count'])\n\ndf_customer_new = df.groupby('Customer ID').apply(new_features)","6ff47776":"df_customer_new.columns","02be3448":"from datetime import datetime\ndf_customer_new['Duration'] = (df_customer_new['Latest_Purchase_Date'] - df_customer_new['First_Purchase_Date']).dt.days","c3dd1d4d":"df_customer_new['Frequency'] = df_customer_new['Duration']\/df_customer_new['Purchases']\ndf_customer_new['Frequency'].head()","04972ae9":"df_customer_new.head()","9996ac07":"df_customer_new['Frequency'].describe()","d99ef246":"# df_customer_new['Duration'].describe()\n# Total time duration = approx 3.7 years","919454db":"# 1. Profile the customers based on their frequency of purchase - calculate frequency of purchase for\n# each customer and plot a histogram to get the threshold for Low\/Mid\/High frequency customers\n\nplt.hist(df_customer_new['Frequency'], bins=3)\nplt.xlabel('frequency of purchase')\nplt.show()","ce717c0f":"# bucketing continuous data\ndef freq(x):\n    if x < 219:\n        return 'Low' \n    elif x < 436:\n        return 'Mid' \n    else:\n        return 'High'\n\ndf_customer_new['freq_range'] = df_customer_new.Frequency.apply(freq)\n\ndf_customer_new['freq_range'].value_counts()","23da975a":"# profiling based on purchase frequency\ndf_customer_new.head()","8e2f8564":"result = df.groupby([\"Customer Name\"])['Profit'].aggregate(np.sum).reset_index().sort_values('Profit',ascending = False).head(20)","d8e59c3a":"# revenue = sales *  quantity ","d4d79bce":"df_customer_new['Revenue'] = df_customer_new['Purchases'] *  df_customer_new['Total_Sales']","64741db5":"sns.catplot(x=\"freq_range\", y=\"Revenue\", kind=\"bar\", data=df_customer_new);","48f08fdf":"profit_margin = df_customer_new.groupby('freq_range')","13be5002":"profit_margin","73be6486":"# 4. Which customer segment is most profitable in each year ( there is a column called customer segment","0afc1611":"df.Segment.value_counts()","4cae3927":"sns.countplot(x=\"Segment\",data = df)","f52e4cba":"df_x = df\ndf_x['year'] = pd.DatetimeIndex(df['Order Date']).year\ndf_x.head()","82bf7f8f":"plt.figure(figsize=(24,15))\nsns.catplot(x=\"Segment\", col=\"year\", data=df_x, kind=\"count\")\nplt.show()","430ed141":"# 5. How the customers are distributed across the countries - pie chart ","acc57b55":"customer_country = pd.DataFrame({'Count' : df.groupby([\"Country\"]).size()}).reset_index().sort_values('Count',ascending = False).head(10)","8c3b0488":"customer_country","3e4ddfbe":"from matplotlib import pyplot as plt\nimport numpy as np\nfig = plt.figure()\nax = fig.add_axes([0,0,1,1])\nax.axis('equal')\nCountries = customer_country['Country']\ncust_count = customer_country['Count']\nax.pie(cust_count, labels = Countries,autopct='%1.2f%%')\nplt.show()","50ee1d0b":"# def new_dataframe(x):\n#     d = []\n#     return pd.Series(d, index= df.columns)\n\n\n# df_new_dataframe = df.groupby('Country').apply(new_dataframe)\n\nfor i, g in df.groupby('Country'):\n    globals()['df_' + str(i)] =  g\n    \nprint (df_China)","699f77a1":"grouped = df.groupby(df.Country)\n\nChina = grouped.get_group(\"China\")","7fda6d2a":"plt.figure(figsize=(16,8))\ncountries = df.groupby('Country')['Sales'].count().sort_values(ascending=False)\ncountries = countries [:60]\ncountries.plot(kind='bar', color='orange')\nplt.title('Top 60 Countries in Sales')\nplt.ylabel('Sales')\nplt.xlabel('Countries')","21a9b1ca":"products = df.groupby('Product Name')['Profit'].count().sort_values(ascending=False)\n# top_5_products = products[:5]\n# top_5_products\nproducts.head()","dbf0a7e1":"df_x = df.drop_duplicates()\n\ndf_x['Order_to_Ship_Days'] = (pd.to_datetime(df_x['Ship Date']) \n                                           - pd.to_datetime(df_x['Order Date'])).dt.days\n\n# # df_customer1.head()\n#days_taken = df_x.groupby('Order ID')['Order_to_Ship_Days'].mean()\n# total_days = days_taken.to_frame()\n# total_days.head()","6e967970":"df_x.head()","e056a8ce":"plt.figure(figsize=(16,8))\ncountries = df_x.groupby('Country')['Order_to_Ship_Days'].mean().sort_values(ascending=False)\ncountries = countries [:60]\ncountries.plot(kind='bar', color='red')\nplt.title('Top 60 Countries in Sales')\nplt.ylabel('Average shipment date')\nplt.xlabel('Countries')","5c1d065d":"From the graph we can see that the high frequent customers are contrinuting less","3048061c":"#1. Profile the customers based on their frequency of purchase - calculate frequency of purchase for each customer and \n#plot a histogram to get the threshold \n#for Low\/Mid\/High frequency customers","32e9aca2":"2.Are the high frequent customers contributing more revenue","43c27057":"--- To Be continued ---","7b040c10":"<!-- 2. How the product price is varying with sales - Is there any increase in sales with \ndecrease in price at a day level (Plot a chart with maximum & minimum price increase \nat any day and also that day sales). Price change is calculated from previous day. -->","30fec882":"EDA (To get a better understanding of thr data)","5e6d3aa2":"3. What is the average delivery date across the countries - bar plot\n","2ac32eba":"### Customer Analysis","9d49e0c7":"6. Write a function to split the global store data into different unique data \nframes based on the unique values in country column \n[Means, we should have one data frame for one country as function output ]  ","36e8b73d":"1. Plot the countries with their total sales  - bar plot","c0b411f9":"### Product Analysis","2aaa6eb8":"Customers Analysis:\n\n1. Profile the customers based on their frequency of purchase - calculate frequency of purchase for each customer and plot a histogram to get the threshold for Low\/Mid\/High frequency customers\n\n2. Does the high frequent customers are contributing more revenue\n\n3. Are they also profitable - what is the profit margin across the buckets\n\n4. Which customer segment is most profitable in each year ( there is a column called customer segment)\n\n5. How the customers are distributed across the countries - pie chart \n\n6. Write a function to split the global store data into different unique data frames based on the unique values in country column [Means, we should have one data frame for one country as function output ]  ","c71a354d":"1. What are top 5 profit making product types on a yearly basis","046ecbe5":"We can see that the data has 51290 data entries with 24 features.","27041e2b":"# Descriptive analysis on global Super Store Data","2e3ca9b5":"lets understand how many of them are categorical and how many unique values each categorical columns have,","d88eb23c":"3. Are they also profitable - what is the profit margin across the buckets","b739e329":"Shopping online is currently the need of the hour. Because of this COVID, it's not easy to walk in a store randomly and buy anything you want. I this I am trying to understand a few things like\n\n**Customers Analysis**\n\n* Profile the customers based on their frequency of purchase - calculate frequency of purchase for each customer\n* Do the high frequent customers are contributing more revenue\n* Are they also profitable - what is the profit margin across the buckets\n* Which customer segment is most profitable in each year.\n* How the customers are distributed across the countries- -\n\n**Product Analysis**\n\n* Which country has top sales?\n* Which are the top 5 profit-making product types on a yearly basis\n* How is the product price varying with sales - Is there any increase in sales with the decrease in price at a day level\n* What is the average delivery time across the counties - bar plot\n\nI will keep updating the analysis.","eabb3dda":"![image.png](attachment:image.png)"}}