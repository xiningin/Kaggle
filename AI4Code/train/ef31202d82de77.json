{"cell_type":{"758e4729":"code","3719fb95":"code","616e0191":"code","ec502f91":"code","e4056d33":"code","c64fb707":"code","ef3c8754":"code","84ca645a":"code","98f5d9c0":"code","d6b3dd8e":"code","05f7775e":"code","78b46e05":"code","9a9f12d1":"code","3cdb5f30":"code","1ef24080":"code","c453730f":"code","7dd8c6f8":"code","dc89317a":"code","efb608c4":"code","9564f50c":"code","0080880f":"markdown","c8bc01f0":"markdown","0599c5ee":"markdown","9d28ebfd":"markdown","8fd3ee36":"markdown","340aaa88":"markdown","aac52ea7":"markdown","99cd0f3f":"markdown","a76fadd7":"markdown","8adec433":"markdown","0a5fb1df":"markdown","001c62e5":"markdown","89fcf07c":"markdown","2130c6f4":"markdown","317d5475":"markdown","5edc80b7":"markdown","99c01f22":"markdown"},"source":{"758e4729":"import numpy as np\nimport pandas as pd ","3719fb95":"# Importing the dataset\nmissing_value=[\"Undefined\"]\ndata_path = \"..\/input\/hotel-booking-demand\/hotel_bookings.csv\"\nhotel = pd.read_csv(data_path, na_values=missing_value)","616e0191":"hotel.head()","ec502f91":"hotel.shape","e4056d33":"hotel.info()","c64fb707":"hotel['reservation_status_date'] = pd.to_datetime(hotel['reservation_status_date'])","ef3c8754":"type(hotel['reservation_status_date'][0])","84ca645a":"hotel['arrival_date'] = pd.to_datetime(hotel.arrival_date_year.astype(str) + '\/' + hotel.arrival_date_month.astype(str) + '\/' + hotel.arrival_date_day_of_month.astype(str))","98f5d9c0":"hotel['arrival_date']","d6b3dd8e":"hotel.shape","05f7775e":"# Checking for the converted datatype\nhotel['arrival_date'][0]","78b46e05":"np.sum(hotel.isnull())","9a9f12d1":"hotel.children[hotel.children != hotel.children].index.values","3cdb5f30":"for col in hotel.columns:\n    if np.sum(hotel[col].isnull())>(hotel.shape[0] * 0.7):\n        hotel.drop(columns=col, inplace=True, axis=1)\nprint(hotel.shape)","1ef24080":"hotel.drop(columns=[\"arrival_date_week_number\", \"arrival_date_year\", \"arrival_date_month\", \"arrival_date_day_of_month\"],\n           inplace=True, axis=1)\n","c453730f":"hotel.shape","7dd8c6f8":"hotel.dropna(subset=[\"agent\"], inplace=True)\nhotel.shape","dc89317a":"hotel[\"children\"].fillna(value = hotel[\"children\"].mean(), inplace=True)\nhotel[\"children\"] = hotel[\"children\"].apply(np.floor)\nprint(f\"Total missing values in children column after filling = {np.sum(hotel.children.isnull())}\")\n","efb608c4":"arr=[\"market_segment\", \"distribution_channel\", \"meal\", \"country\"]\nprint(\"No of missing values are\")\nfor x in arr:\n    hotel[x].fillna(method=\"bfill\", inplace=True)\n    print(f\"{x}: {np.sum(hotel[x].isnull())}\")","9564f50c":"np.sum(hotel.isnull())","0080880f":"**4) Removing the unwanted rows**","c8bc01f0":"Usually if more than 70% of values in a column are missing and there is no way to fill in the missing values, then the column can be dropped completely from the dataset. 70% of 110390 is 83573","0599c5ee":"**Checking how many missing values each column contains**","9d28ebfd":"**5) Filling the missing values of columns**","8fd3ee36":"**Creating a new column by combining the year, month and date of arrival together.**","340aaa88":"**Converting the object datatype of \"reservation_status_date\" to datetime datatype**","aac52ea7":"**3) Removing the unwanted columns**","99cd0f3f":"*Thus, we did some column alterations, filled the missing values, reduced some unwanted rows, changed some datatypes into the appropriate ones and now our data is pretty cleaned to be fed to our model*","a76fadd7":"Depending upon what values we are predicting, we can either remove the entire agent id column or remove the rows\nhaving empty values.\nAs I gave already showed how to remove a column, lets remove all rows having a missing value in the agent column","8adec433":"**1) Finding the number of missing values**","0a5fb1df":"The \"arrival_date_week_number\" column is of no use as we already have 3 columns of year, month and day giving us\nthe date of arrival.Also as we have created a new column showing the date, we no more need the 3 seperate\ncolumns. Hence lets remove these columns","001c62e5":"Checking if the columns contain any null value","89fcf07c":"**2) To find the indexes of the missing value**","2130c6f4":"# Hotel Booking Demand (Data Cleaning)","317d5475":"First let us fill the children column\nHere I have used mean as a value to be replaced with missing values\nAs mean can be a float, I have taken the lowest nearest integer using the floor method","5edc80b7":"**Eg. Finding 4 missing value indexes of children column**","99c01f22":"Now, lets fill market_segment and distribution_channel\nAs the method of filling used is same for both, a for loop is used"}}