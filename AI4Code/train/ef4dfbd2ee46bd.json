{"cell_type":{"a5c68d85":"code","6b352886":"code","cdeb7943":"code","d6607cf3":"code","11d9093a":"code","aadc02d8":"code","e9100e27":"code","d89211ed":"code","828e08b3":"code","e00b779b":"code","e331977f":"code","e532c27c":"code","dad5c403":"code","66691b34":"code","e933af5a":"code","d21cdd26":"markdown","50030b3f":"markdown","f6bc4af9":"markdown","80ec1cc7":"markdown","2c5a9a44":"markdown","26a8f142":"markdown","136d1e38":"markdown","ba9cb9a9":"markdown","6612ffd1":"markdown","2227de35":"markdown","daaef023":"markdown","985e7e59":"markdown"},"source":{"a5c68d85":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n\ndf_original = pd.read_csv('..\/input\/chemicals-in-cosmetics\/chemicals-in-cosmetics.csv')\ndf = df_original.drop_duplicates()\nprint('The original database shape:', df_original.shape)\nprint('Database without duplicates:', df.shape)","6b352886":"df.head()","cdeb7943":"df['ChemicalName'].value_counts().size","d6607cf3":"df['ChemicalCount'].describe()","11d9093a":"df.loc[df.ChemicalCount==0].head()","aadc02d8":"# when the result is False, there are no NaN values\ndf.loc[df.ChemicalCount==0]['ChemicalDateRemoved'].isnull().max()","e9100e27":"df_n0 = df.loc[(df.ChemicalCount>0) & (df['DiscontinuedDate'].isna())]","d89211ed":"df_n0.loc[df.ChemicalCount==9]","828e08b3":"df_n0.loc[df['CDPHId']==26]","e00b779b":"data = df_n0.groupby(['ChemicalCount']).nunique()['CDPHId']\n\nfig = plt.figure(figsize=(9,7))\nax = plt.subplot(111)\nax.bar(data.index, data.values, log=True, align='center', alpha=0.5, edgecolor='k')\n\nax.spines['top'].set_visible(False)\nax.spines['right'].set_visible(False)\nax.yaxis.set_ticks_position('left')\nax.xaxis.set_ticks_position('bottom')\nax.set_xticks(np.arange(1,10))\n\nfor x,y in zip(data.index,data.values):\n    plt.annotate(y, (x,y), textcoords=\"offset points\", xytext=(0,4), ha='center') \n\nax.set_title('Number of reported products containing chemicals', fontsize=15)\nax.title.set_position([.5, 1.05])\nax.set_xlabel('Number of chemicals', fontsize=12)\nax.set_ylabel('Number of products (log scale)', fontsize=12)\n\nplt.show()","e331977f":"baby_prod = df_n0.loc[df_n0['PrimaryCategory']=='Baby Products']\nbaby_prod.head()","e532c27c":"baby_prod_chem = baby_prod['ChemicalName'].value_counts()\nprint(baby_prod_chem)","dad5c403":"long_text = baby_prod_chem.index[2]\nprint('Old chemical name: ', long_text)\nprint()\nbaby_prod_chem.rename({baby_prod_chem.index[2]: 'Retinol *'}, inplace=True)\nprint('New chemical name: ', baby_prod_chem.index[2])","66691b34":"fig = plt.figure(figsize=(10, 6))\nax = plt.subplot(111)\nax.barh(baby_prod_chem.index, baby_prod_chem.values, color='red', alpha=0.6)\n\nax.xaxis.grid(linestyle='--', linewidth=0.5)\n\nfor x,y in zip(baby_prod_chem.values,baby_prod_chem.index):\n    ax.annotate(x, (x,y), textcoords=\"offset points\", xytext=(4,0), va='center') \n\nax.set_title('Chemicals in baby products', fontsize=15)\nax.title.set_position([0.5,1.02])\nax.set_xlabel('Number of baby products', fontsize=12)\nax.set_xticks(np.arange(0,18,5))\nplt.text(-0.15,-0.2, \"* \"+long_text, size=12, transform=ax.transAxes)\n\nplt.show()","e933af5a":"reported_baby_prod = baby_prod[['ProductName', 'CompanyName', 'SubCategory']].sort_values('SubCategory')\nreported_baby_prod.columns=['Baby product', 'Company', 'Type of product']\nreported_baby_prod.style.hide_index()","d21cdd26":"## Chemicals in baby products\n\nBaby products represent one of the primary categories in this dataset. ","50030b3f":"In average, products contain at least one chemical. Notice there are products with 0 chemicals, and there are products with 9 reported chemicals.\n\nLet's first investigate products where 'ChemicalCount'=0.","f6bc4af9":"In the sequel, we will focus on products that have reported at least one chemical and that are still in use (not discontinued).","80ec1cc7":"## Investigating chemical counts","2c5a9a44":"It turns out it is only one product, where each chemical is separately reported.\n\nThe following code is used to generate the bar chart showing the number of products per number of chemicals. In counting the number of products, different color, scent and\/or flavor of the product are neglected (e.g. 'Professional Eyeshadow Base' can be beige or bright, but it is counted only once with the identification number 'CDPHId'=26).","26a8f142":"The maximum number of chemicals that is reported in a product is 9. We can find these products:","136d1e38":"The number of chemicals being equal to zero suggests that the chemicals were removed from the product (reported in 'ChemicalDateRemoved'). This can be verified by checking if there are NaN values in this column.","ba9cb9a9":"Overall there are 123 different chemicals that are reported.\n\nBased on the description, each entry in column 'ChemicalCount' is the total number of current chemicals reported for a product. This number does not include chemicals that have been removed from a product.","6612ffd1":"List of all baby product names, containing at least one chemical, sorted by subcategory.","2227de35":"## Reading data\n\nFirst we remove duplicates in this dataset.","daaef023":"The long name 'Retinol\/retinyl esters, when in daily dosages ...' will be replaced with 'Retinol'. The long name is stored in 'long_text', and a remark is given below the graph.","985e7e59":"The next code is used to find all chemicals present in baby products (listed and in a graph)."}}