{"cell_type":{"b82a4b52":"code","97293e5a":"code","1bfd2834":"code","e95a7903":"code","c14557b6":"code","c6352fcc":"code","885c3979":"code","880bea11":"code","5bb2ec29":"code","ab748489":"code","07ea2614":"code","e8a82478":"code","227c2661":"code","d99829fb":"code","a345bffa":"code","93fa6c62":"code","4a2bbe06":"code","0f64c75c":"code","78177428":"code","457fc7c4":"code","401004e0":"code","775a071a":"code","ddd225d4":"code","95a04700":"code","edfe6346":"code","cb927e2a":"code","3a54bee1":"code","f0e15797":"code","3d2f76f0":"code","5da6813a":"code","547ca387":"code","3231c936":"code","908f01b8":"code","0501b813":"code","58709c96":"code","c6cfbae3":"code","8b71e8a6":"code","b10f7e5f":"markdown","118db50b":"markdown","9203310a":"markdown","cbde18c3":"markdown","4455bbf5":"markdown","8aa2570b":"markdown","ec89f385":"markdown","b9262ea7":"markdown","f49ce440":"markdown","6f2e2a63":"markdown","fa5a50f6":"markdown"},"source":{"b82a4b52":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","97293e5a":"import matplotlib.pyplot as plt\nimport seaborn as sns \n%matplotlib inline","1bfd2834":"train_df = pd.read_csv('..\/input\/fake-news\/train.csv')\ntest_df = pd.read_csv('..\/input\/fake-news\/test.csv')","e95a7903":"train_df.head()","c14557b6":"train_df.shape","c6352fcc":"train_df.isnull().sum()","885c3979":"train_df.shape","880bea11":"train_df[train_df['title'].isna()]","5bb2ec29":"train_df.isna().sum()","ab748489":"# fill values with: 'missing_values' for train_df\ntrain_df['title'].fillna('missing_values', inplace=True)\ntrain_df['author'].fillna('missing_values', inplace=True)\ntrain_df['text'].fillna('missing_values', inplace=True)","07ea2614":"train_df.isna().sum()","e8a82478":"# view  missing values for test_df\ntest_df.isna().sum()","227c2661":"# fill values with: 'missing_values' for test_df\ntest_df['title'].fillna('missing_values', inplace=True)\ntest_df['author'].fillna('missing_values', inplace=True)\ntest_df['text'].fillna('missing_values', inplace=True)","d99829fb":"train_df['combined'] = train_df['author'] + ' ' + train_df['title']\ntest_df['combined'] = test_df['author'] + ' ' + test_df['title']","a345bffa":"train_df.head(2)","93fa6c62":"!pip install neattext","4a2bbe06":"import neattext.functions as nfx","0f64c75c":"train_df['combined'] = train_df['combined'].apply(nfx.remove_shortwords)\ntrain_df['combined'] = train_df['combined'].apply(nfx.remove_puncts)\ntrain_df['combined'] = train_df['combined'].apply(nfx.remove_punctuations)","78177428":"train_df.head(2)","457fc7c4":"# fior test_df\ntest_df['combined'] = test_df['combined'].apply(nfx.remove_shortwords)\ntest_df['combined'] = test_df['combined'].apply(nfx.remove_puncts)\ntest_df['combined'] = test_df['combined'].apply(nfx.remove_punctuations)","401004e0":"test_df.head(2)","775a071a":"from sklearn.feature_extraction.text import CountVectorizer","ddd225d4":"vect = CountVectorizer()\ntrain_message = vect.fit_transform(train_df['combined'])\ntest_emssage = vect.transform(test_df['combined'])","95a04700":"train_df['label'].value_counts()","edfe6346":"train_df['label'].value_counts().plot.pie(autopct= '% .2f');","cb927e2a":"from sklearn.naive_bayes import MultinomialNB","3a54bee1":"nb = MultinomialNB()\nnb.fit(train_message, train_df['label'])","f0e15797":"y_pred = nb.predict(train_message)","3d2f76f0":"from sklearn.metrics import accuracy_score","5da6813a":"accuracy_score(train_df['label'], y_pred)","547ca387":"from sklearn.ensemble import RandomForestClassifier","3231c936":"rf = RandomForestClassifier(random_state=42)\nrf.fit(train_message, train_df['label'])\nrf_pred = rf.predict(train_message)\naccuracy_score(train_df['label'], rf_pred)","908f01b8":"predictions_rf = rf.predict(test_emssage)","0501b813":"test_df['Label'] = predictions_rf\ntest_df","58709c96":"sub_rf = test_df[['id', 'Label']]\nsub_rf.columns = ['id', 'label']\nsub_rf.head()","c6cfbae3":"sub_rf.shape","8b71e8a6":"sub_rf.to_csv('sub_random_forest.csv', index=False)","b10f7e5f":"### Vectorizer","118db50b":"### Predictions Base Test_df","9203310a":"### Clean Data","cbde18c3":"###  Handling with missing values","4455bbf5":"###  Feature Engineering","8aa2570b":"Our dataset is balanced","ec89f385":"## Read datasets","b9262ea7":"#### View distribution of targe","f49ce440":"## Model","6f2e2a63":"### Random Forest","fa5a50f6":"### Libraries"}}