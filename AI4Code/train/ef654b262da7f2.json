{"cell_type":{"41e45d3d":"code","8115f57f":"code","bb4edcad":"code","210ef502":"code","e29f36c7":"code","2c43ba19":"code","5d315327":"code","d4c6558b":"code","dd54f9fc":"code","f3dbf917":"code","cd393c70":"code","cdd4a9c4":"code","092abd1a":"code","4b34c177":"code","92850df4":"code","2377c8db":"code","00414e50":"code","9f661de5":"code","cc5d8d27":"code","58d1ba81":"code","d131751f":"code","a7d191e3":"code","4cbac5d4":"code","b425ff0c":"code","d310313c":"code","b1c12e86":"code","4f4c1d11":"code","e988125d":"code","e8a4d41d":"markdown","a68e174a":"markdown","392f9782":"markdown"},"source":{"41e45d3d":"import pandas as pd\nimport numpy as np\nfrom sklearn.decomposition import TruncatedSVD","8115f57f":"elec = pd.read_csv(\"..\/input\/market-bias\/electronics.csv\")\nmod = pd.read_csv(\"..\/input\/market-bias\/modcloth.csv\")","bb4edcad":"mod.info()","210ef502":"mod=mod.drop(columns=['brand'],axis=1)\nmod.dropna(subset=['user_id'],inplace=True)","e29f36c7":"mod.item_id.nunique()","2c43ba19":"mod.user_id.nunique()","5d315327":"new_df_mod=mod.groupby(\"item_id\").filter(lambda x:x['rating'].count() >=20)\nnew_df_mod.head()","d4c6558b":"ratings_matrix_mod = new_df_mod.pivot_table(values='rating', index='user_id', columns='item_id', fill_value=0)\nratings_matrix_mod.head()","dd54f9fc":"X_mod = ratings_matrix_mod.T\nX_mod.head()","f3dbf917":"SVD_mod = TruncatedSVD(n_components=10)\ndecomposed_matrix_mod = SVD_mod.fit_transform(X_mod)\ndecomposed_matrix_mod.shape","cd393c70":"#Finding Correlation between users\ncorrelation_matrix_mod = np.corrcoef(decomposed_matrix_mod)\ncorrelation_matrix_mod.shape","cdd4a9c4":"def recommend_items_mod(item):\n    item_ids = list(X_mod.index)\n    item_id = item_ids.index(item)\n    corr_item_id = correlation_matrix_mod[item_id]\n    recommend = list(X_mod.index[corr_item_id > 0.65])\n    recommend.remove(item)\n    return recommend[0:20]","092abd1a":"recommend_items_mod(7443)","4b34c177":"elec.head()","92850df4":"elec.info()","2377c8db":"#we dont need users who haven't buyed multiple products\na=elec.user_id.value_counts()\na","00414e50":"indexes = []\nfor i in a.index:\n    if a[i] > 2:\n        indexes.append(i)\nlen(indexes)","9f661de5":"elec2 = elec[elec.user_id.isin(indexes)]","cc5d8d27":"elec2.info()","58d1ba81":"new_df_elec=elec2.groupby(\"item_id\").filter(lambda x:x['rating'].count() >=20)","d131751f":"ratings_matrix_elec = new_df_elec.pivot_table(values='rating', index='user_id', columns='item_id', fill_value=0)\nratings_matrix_elec.head()","a7d191e3":"ratings_matrix_elec.shape","4cbac5d4":"#as the matrix is sparse, apply transpose\nX_elec = ratings_matrix_elec.T\nX_elec.head()","b425ff0c":"X_elec.shape","d310313c":"SVD_elec = TruncatedSVD(n_components=10)\ndecomposed_matrix_elec = SVD_elec.fit_transform(X_elec)\ndecomposed_matrix_elec.shape","b1c12e86":"correlation_matrix_elec = np.corrcoef(decomposed_matrix_elec)\ncorrelation_matrix_elec.shape","4f4c1d11":"def recommend_items_elec(item):\n    item_ids = list(X_elec.index)\n    item_id = item_ids.index(item)\n    corr_item_id = correlation_matrix_elec[item_id]\n    recommend = list(X_elec.index[corr_item_id > 0.65])\n    recommend.remove(item)\n    return recommend[0:20]","e988125d":"recommend_items_elec(2)","e8a4d41d":"### **Modcloth**","a68e174a":"# Electronics Dataset","392f9782":"# **Recommendaion System**"}}