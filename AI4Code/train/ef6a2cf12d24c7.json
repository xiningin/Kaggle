{"cell_type":{"924b64b7":"code","9308aaf0":"code","4446f423":"code","07427e98":"code","f67842c1":"code","c344941a":"code","b4f555bb":"code","76864713":"code","2cc27f95":"code","1855bcdc":"code","fd539f96":"code","ae260587":"code","e82cfc69":"code","6c177429":"code","1c301bc8":"code","34dc2fe4":"code","e882ec71":"markdown","6d9dfd42":"markdown","9ca72e34":"markdown"},"source":{"924b64b7":"from sklearn.cluster import DBSCAN \nfrom sklearn.datasets import make_moons\nfrom sklearn.preprocessing import MinMaxScaler\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nplt.style.use('seaborn')\nplt.rcParams['figure.figsize'] = 20, 15\nimport warnings\nwarnings.simplefilter(action=\"ignore\", category=FutureWarning)\nfrom sklearn.neighbors import KNeighborsClassifier, LocalOutlierFactor\nfrom sklearn.ensemble import IsolationForest\n\nfrom sklearn.metrics import accuracy_score, confusion_matrix","9308aaf0":"df1 = pd.read_csv('..\/input\/creditcardfraud\/creditcard.csv')\ndf1","4446f423":"df1.info()","07427e98":"#df1 = df.sample(frac=.1) # Full dataset could not be handled by system so I had to reduce","f67842c1":"#df.Class.value_counts(normalize=True), df1.Class.value_counts(normalize=True)","c344941a":"outlier_fraction = df1.Class.value_counts(normalize=True)[1]\/df1.Class.value_counts(normalize=True)[0]\noutlier_fraction","b4f555bb":"X, y = df1.drop('Class', axis=1).values, df1.Class.values\nX.shape, y.shape","76864713":"isofor = IsolationForest()","2cc27f95":"isofor.fit(X)","1855bcdc":"isopreds = isofor.predict(X)\nisopreds[isopreds == -1] = 1\nisopreds[isopreds == 1] = 0","fd539f96":"accuracy_score(isopreds, y)","ae260587":"lof = LocalOutlierFactor()","e82cfc69":"lofpreds = lof.fit_predict(X)\nlofpreds","6c177429":"lof.negative_outlier_factor_","1c301bc8":"lofpreds[lofpreds == -1] = 1\nlofpreds[lofpreds == 1] = 0","34dc2fe4":"accuracy_score(lofpreds, y)","e882ec71":"# Local Outlier Factor","6d9dfd42":"We shall do credit card fraud detection.\n\n# IMPORTS","9ca72e34":"# Isolation Forest"}}