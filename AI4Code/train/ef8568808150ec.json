{"cell_type":{"7e38b33b":"code","689a50e1":"code","f1807e6d":"code","acc9c4aa":"code","40e06e38":"code","0de952a3":"code","75e0bbaf":"code","a28b4125":"code","5300b04e":"code","2d8bd153":"code","22aaa3a9":"code","f59f8801":"code","aaf700a2":"code","dba691e8":"code","9080ca81":"code","4c76f44f":"code","1346cc25":"code","e1c74596":"code","56750be7":"code","66418776":"code","56776e2c":"code","30394f1c":"code","d9eccbee":"code","332d7f50":"code","04446767":"code","29308bc4":"code","1ff15d98":"code","4a42f899":"code","2fd06681":"code","2f0bb8b6":"code","3b0358d2":"code","21ceabf9":"code","540cb1d1":"markdown","0fe46bf5":"markdown","74ddb374":"markdown","19e7a15b":"markdown","b84d54cb":"markdown","2c7a28a3":"markdown","5cac9e78":"markdown","403a9f65":"markdown","79135988":"markdown","ab3ca621":"markdown","0470345b":"markdown"},"source":{"7e38b33b":"import pandas as pd\nimport numpy as np\nfrom pandas import Series,DataFrame\n\nimport string\nfrom nltk.corpus import stopwords\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n%matplotlib inline","689a50e1":"df = pd.read_csv('..\/input\/shopee-code-league-20\/_DS_Sentiment_Analysis\/train.csv',names=['message','rating'])\ndf = df.iloc[1:]","f1807e6d":"df.head()","acc9c4aa":"df.info()","40e06e38":"df.describe()","0de952a3":"df.groupby('rating').describe()","75e0bbaf":"df['length'] = df['message'].apply(len)\ndf.head()","a28b4125":"df['length'].plot(bins=50,kind='hist')","5300b04e":"df['length'].describe()","2d8bd153":"df[df['length']==1249]['message'].iloc[0]","22aaa3a9":"df.hist(column='length',by='rating',bins=50,figsize=(10,8))","f59f8801":"def textprocess(mess):\n    \"\"\"Removing punctuation \"\"\"\n    nonpunc = [char for char in mess if char not in string.punctuation]\n    nonpunc = ''.join(nonpunc)\n    \n    \"\"\"Removing stopwords\"\"\"\n    clean_mess = [word for word in nonpunc.split() if word.lower() not in stopwords.words('english')]\n    \n    return clean_mess","aaf700a2":"from sklearn.feature_extraction.text import CountVectorizer","dba691e8":"bow_transformer = CountVectorizer(analyzer=textprocess).fit(df['message'])","9080ca81":"print(len(bow_transformer.vocabulary_))","4c76f44f":"messages_bow = bow_transformer.transform(df['message'])","1346cc25":"from sklearn.feature_extraction.text import TfidfTransformer","e1c74596":"tfidf_transformer = TfidfTransformer().fit(messages_bow)\nmessages_tfidf = tfidf_transformer.transform(messages_bow)","56750be7":"from sklearn.naive_bayes import MultinomialNB","66418776":"senti_analysis = MultinomialNB().fit(messages_tfidf,df['rating'])","56776e2c":"all_predictions = senti_analysis.predict(messages_tfidf)","30394f1c":"d = {'Predicted':all_predictions,'Actual':df['rating']}\ndf_analysis = DataFrame(d)","d9eccbee":"from sklearn.metrics import classification_report","332d7f50":"print(classification_report(df['rating'],all_predictions))","04446767":"from sklearn.model_selection import train_test_split\n\nmsg_train,msg_test,rating_train,rating_test = train_test_split(df['message'],df['rating'])\n\nprint(len(msg_train), len(msg_test), len(msg_train),len(msg_test))","29308bc4":"from sklearn.pipeline import Pipeline\n\npipeline = Pipeline([\n    ('bow', CountVectorizer(analyzer=textprocess)),\n    ('tfidf', TfidfTransformer()),\n    ('classifier', MultinomialNB())\n])","1ff15d98":"pipeline.fit(msg_train,rating_train)","4a42f899":"pred_rate = pipeline.predict(msg_test)","2fd06681":"print(classification_report(rating_test,pred_rate))","2f0bb8b6":"df1 = pd.read_csv('..\/input\/shopee-code-league-20\/_DS_Sentiment_Analysis\/test.csv',index_col=['review_id'])\ndf1 = df1.rename(columns={'review':'message'})","3b0358d2":"prediction = pipeline.predict(df1['message'])","21ceabf9":"df1['Rating'] = prediction\ndf1","540cb1d1":"# Training a Model","0fe46bf5":"Seems like a lot of spamming in reviews.","74ddb374":"# Model Analysis [train data]","19e7a15b":"# Tf-idf vectorizer","b84d54cb":"# Prediction","2c7a28a3":"# Count_Vectorizer","5cac9e78":"The graphs implies, there is no much relation between length of message and the rating corresponding to it.","403a9f65":"# Text Pre-processing","79135988":"# Model Analysis [test accuracy]","ab3ca621":"# Basic Exploratory Analysis","0470345b":"Let's check if the length of message has any impact on rating."}}