{"cell_type":{"43abe2e4":"code","cf0a3d92":"code","57389216":"code","bc541191":"code","77cbc166":"code","b392a32f":"code","555a15fc":"code","54bccae9":"code","33bcbdaf":"code","316fdda7":"code","cc902846":"code","35ddb9c2":"code","af1d2d93":"code","28b9a0b5":"code","6ac39f84":"code","e790d960":"code","52bd2513":"code","acc0a5d8":"code","2bff1102":"code","a17a79f2":"code","a6a80997":"code","a32234b3":"code","b85e1005":"code","b70a037c":"code","6bbcd5e1":"code","7bd51269":"code","bc49ab2f":"code","d07927cf":"code","ef107e04":"code","4e6209df":"code","bd763e19":"code","b38f1b64":"code","4563912b":"code","269dd1fd":"code","3ca2fbc7":"code","39861d58":"code","1de875a5":"code","e3087d5b":"code","19565237":"code","1a346543":"code","08524a5d":"code","cf1d179d":"code","db03d7c2":"code","b1f6f3ab":"code","a2081215":"code","55e5a8d4":"code","bc99a6ff":"code","5e59094c":"code","acc87cc9":"code","7f80f60c":"code","2784bcdb":"markdown","4bd136ee":"markdown","18faea66":"markdown","e2edf47c":"markdown","c5d107c0":"markdown","91d2e259":"markdown"},"source":{"43abe2e4":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline","cf0a3d92":"hsp = pd.read_csv('..\/input\/housesalesprediction\/kc_house_data.csv')\nhsp","57389216":"hsp.isnull().sum()","bc541191":"hsp.columns","77cbc166":"hsp.dtypes","b392a32f":"plt.figure(figsize=(15,8))\nsns.distplot(hsp['price'])","555a15fc":"plt.figure(figsize= (15,8))\nsns.countplot(hsp['bedrooms'])","54bccae9":"hsp.corr()['price'].sort_values()","33bcbdaf":"plt.figure(figsize=(15,8))\nsns.scatterplot(x= 'price', y= 'sqft_living', data= hsp)","316fdda7":"plt.figure(figsize=(15,8))\nsns.scatterplot(x= 'price', y= 'lat', data= hsp)","cc902846":"plt.figure(figsize=(15,8))\nsns.scatterplot(x= 'price', y= 'long', data= hsp)","35ddb9c2":"plt.figure(figsize=(15,8))\nsns.scatterplot(x= 'long', y= 'lat', data= hsp, palette= 'Spectral', alpha= 0.2, edgecolor=None, hue= 'price')","af1d2d93":"len(hsp)*0.01","28b9a0b5":"top_1_percent = hsp.sort_values('price', ascending=False).iloc[:217]","6ac39f84":"plt.figure(figsize=(15,8))\nsns.scatterplot(x= 'long', y= 'lat', data= top_1_percent, palette= 'icefire', alpha= 0.5, hue= 'price', edgecolor= None)","e790d960":"sns.boxplot(x= 'waterfront', y= 'price', data= hsp)","52bd2513":"hsp = hsp.drop('id', axis=1)","acc0a5d8":"hsp['date'] = pd.to_datetime(hsp['date'])","2bff1102":"hsp['date']","a17a79f2":"def year_extraction(date):\n    return date.year\n\nhsp['year']= hsp['date'].apply(lambda date: date.year)\nhsp['month']= hsp['date'].apply(lambda date: date.month)","a6a80997":"hsp.head()","a32234b3":"plt.figure(figsize=(15,8))\nsns.boxplot(x= 'month', y= 'price', data= hsp)","b85e1005":"hsp.groupby('month').mean()['price'].plot()","b70a037c":"hsp.groupby('year').mean()['price'].plot()","6bbcd5e1":"hsp['yr_renovated'].sort_values()","7bd51269":"hsp['sqft_basement'].sort_values()","bc49ab2f":"X= hsp.drop(['price', 'date'], axis=1).values\ny = hsp['price'].values","d07927cf":"from sklearn.model_selection import train_test_split","ef107e04":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=101)","4e6209df":"from sklearn.preprocessing import MinMaxScaler","bd763e19":"scaler= MinMaxScaler()","b38f1b64":"X_train= scaler.fit_transform(X_train)","4563912b":"X_test= scaler.transform(X_test)","269dd1fd":"from tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense ","3ca2fbc7":"X_train.shape","39861d58":"model = Sequential()\n\nmodel.add(Dense(19, activation= 'relu'))\nmodel.add(Dense(19, activation= 'relu'))\nmodel.add(Dense(19, activation= 'relu'))\nmodel.add(Dense(19, activation= 'relu'))\n\nmodel.add(Dense(1))\n\nmodel.compile(optimizer= 'adam',loss= 'mse')","1de875a5":"model.fit(x= X_train, y= y_train, validation_data= (X_test, y_test), batch_size= 128,epochs=400)","e3087d5b":"losses = pd.DataFrame(model.history.history)\nlosses","19565237":"losses.plot()","1a346543":"from sklearn.metrics import mean_absolute_error, mean_squared_error, explained_variance_score","08524a5d":"prediction = model.predict(X_test)","cf1d179d":"mean_absolute_error(y_test, prediction)","db03d7c2":"mean_squared_error(y_test, prediction)","b1f6f3ab":"explained_variance_score(y_test, prediction)","a2081215":"hsp['price'].describe()","55e5a8d4":"plt.figure(figsize=(15,8))\nplt.scatter(y_test, prediction)\nplt.plot(y_test,y_test,'r')","bc99a6ff":"predict_price= hsp.drop(['price', 'date'], axis=1).iloc[0]\npredict_price","5e59094c":"predict_price = scaler.transform(predict_price.values.reshape(-1,20))","acc87cc9":"model.predict(predict_price)","7f80f60c":"hsp.head(1)","2784bcdb":"NOW LETS PREDICT THE PRICE OF SPECIFIC HOUSE","4bd136ee":"Here price has most correlated relationship with sqft_living, we will plot scatter with these two ","18faea66":"Best possible score is 1.0, but 0.8 seems good in terms of predicting the value of houses","e2edf47c":"LOOKS LIKE WE ARE OVERSHOOTING HERE, THE PREDICTED PRICE IS 271754.3 COMPARE TO 221900.0\n\n(THIS IS RELATIVE RESONABLE MODEL TO PREDICT THE MODEL PRICE OF THE HOUSE AS THIS MODEL IS IN RANGE FOR PREIDICTING THE PRICE OF HOUSE)","c5d107c0":"The original mean value of house price was \"540088.1\" with respect to mean absolute error \"103885.67\".","91d2e259":"PLEASE UPVOTE IF YOU LIKE,\nIF ANY SUGGESTION PLS FEEL FREE TO COMMENT\nBEST WISHES!!"}}