{"cell_type":{"1151a973":"code","2bad3355":"code","09cd5bca":"code","771db8b9":"code","7259dd07":"code","e188a541":"markdown","e9ed10de":"markdown","29f634d1":"markdown","50092d04":"markdown"},"source":{"1151a973":"import pandas as pd\nfrom matplotlib import pyplot\nfrom fbprophet import Prophet\nfrom sklearn.metrics import mean_absolute_error\nfrom fbprophet.plot import plot_plotly, plot_components_plotly","2bad3355":"def predictData(DATA_PATH,DS_COL,DATA_COL):\n    df = pd.read_csv(DATA_PATH, header=0)\n    \n    new_df = pd.DataFrame()\n    \n    new_df['ds'] = df[DS_COL]\n    new_df['y'] = df[DATA_COL]\n    new_df['ds']= pd.to_datetime(new_df['ds'])\n    \n    new_df.plot()\n    pyplot.show()\n    \n    model = Prophet()\n    model.fit(new_df)\n    \n    return model,new_df","09cd5bca":"DATA_PATH = \"https:\/\/raw.githubusercontent.com\/jbrownlee\/Datasets\/master\/monthly-car-sales.csv\"\nDS_COL = 'Month'\nDATA_COL = 'Sales'\n\nmodel,new_df = predictData(DATA_PATH,DS_COL,DATA_COL)","771db8b9":"last_1year = list()\nfor i in range(1, 13):\n    last_1year.append(['1968-%02d' % i])\nlast_1year = pd.DataFrame(last_1year, columns = ['ds'])\nlast_1year['ds']= pd.to_datetime(last_1year['ds'])\n\npred_test = model.predict(last_1year)\n\nprint(pred_test[['ds', 'yhat', 'yhat_lower', 'yhat_upper']].head())\n\nmodel.plot(pred_test)\npyplot.show()","7259dd07":"last_1year = list()\nfor i in range(1, 13):\n    last_1year.append(['1969-%02d' % i])\nlast_1year = pd.DataFrame(last_1year, columns = ['ds'])\nlast_1year['ds']= pd.to_datetime(last_1year['ds'])\n\npred_test = model.predict(last_1year)\n\nmodel.plot(pred_test)\npyplot.show()\n\ntrain = new_df.drop(new_df.index[-12:])\ny_true = new_df['y'][-12:].values\n\nmodel = Prophet()\nmodel.fit(train)\n\npyplot.plot(y_true, label='Actual')\npyplot.plot(pred_test, label='Predicted')\npyplot.legend()\npyplot.show()\n\nmodel.plot_components(pred_test)\n\nplot_plotly(model, pred_test)\n","e188a541":"# build model","e9ed10de":"# predict last year","29f634d1":"# predict next year","50092d04":"# imports"}}