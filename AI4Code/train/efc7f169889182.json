{"cell_type":{"fa0894ff":"code","5c0c5b1f":"code","5f17c478":"code","cf08b3da":"code","a50a13ce":"code","8aede964":"code","3c11f6fd":"code","b4e3683f":"code","4641c9d3":"markdown","7bab3bd4":"markdown","6a9af6ee":"markdown","5e187fce":"markdown","dc8dac39":"markdown","82428d77":"markdown","2b02b390":"markdown"},"source":{"fa0894ff":"\nimport numpy as np \nimport pandas as pd \nimport glob #library for navigating file structure\nimport re #regular expressions\n\n#path to submission files\nfps = \"..\/input\/kaggle-days-top-ten-submission-files\/multiplesubmissions\/multiplesubmissions\/**\/*.csv\"\n#path to solution file\nfs = \"..\/input\/hackathon-solution\/derived.csv\"\n","5c0c5b1f":"\n#iterate through submission files and add to dataframe\nneed_to_setup_dataframe = True\nfor filename in glob.iglob(fps, recursive=True):\n\n    df_tmp = pd.read_csv(filename,index_col='id' )\n        \n    if need_to_setup_dataframe == True:\n        df_submission_files = df_tmp\n        need_to_setup_dataframe = False\n        \n    else:\n        df_submission_files = df_submission_files.join(df_tmp)   \n    \n    df_submission_files[re.search('000[0-9].*\\\/',filename)[0][5:-1]] = df_submission_files['target']\n    del(df_submission_files['target'])\n    \n\n","5f17c478":"#Read in solution file and \ndf_solution = pd.read_csv(fs,index_col='id')\n\n","cf08b3da":"df_submission_files = df_submission_files.reindex(sorted(df_submission_files.columns), axis=1)\ndf_submission_files= df_submission_files.join(df_solution['Usage'])\n\ndf_submission_files = df_submission_files[df_submission_files['Usage'] == 'Private']\ndf_solution = df_solution[df_solution['Usage'] == 'Private']\n\ndel(df_submission_files['Usage'])\n","a50a13ce":"df_submission_files.columns = ['9hr Overfitness','ALDAPOP','Arno Candel @ H2O.ai','Erin (H2O AutoML 100 mins)','Erkut & Mark','Google AutoML','Shlandryn','Sweet Deal']","8aede964":"#calculate AUC to replicate leaderboard and try a few ensembles\nfrom sklearn import metrics\n\ndf_ensemble_results = pd.DataFrame(columns=['team','score'])\n\nfor team in df_submission_files.columns:\n    fpr, tpr, thresholds = metrics.roc_curve(df_solution['target'],df_submission_files[team])\n    df_ensemble_results = df_ensemble_results.append({'team':team,\"score\":metrics.auc(fpr,tpr)},ignore_index=True)\n\n","3c11f6fd":"fpr, tpr, thresholds = metrics.roc_curve(df_solution['target'],df_submission_files[['Erkut & Mark','Google AutoML','Sweet Deal']].mean(axis=1)\n)\ndf_ensemble_results = df_ensemble_results.append({'team':'Erkut & Mark,Google AutoML,Sweet Deal',\"score\":metrics.auc(fpr,tpr)},ignore_index=True)\n\nfpr, tpr, thresholds = metrics.roc_curve(df_solution['target'],df_submission_files[['Erkut & Mark','Google AutoML']].mean(axis=1)\n)\ndf_ensemble_results = df_ensemble_results.append({'team':'Erkut & Mark,Google AutoML',\"score\":metrics.auc(fpr,tpr)},ignore_index=True)\n\nfpr, tpr, thresholds = metrics.roc_curve(df_solution['target'],df_submission_files[['Erin (H2O AutoML 100 mins)','Google AutoML']].mean(axis=1)\n)\ndf_ensemble_results = df_ensemble_results.append({'team':'Erin (H2O AutoML 100 mins),Google AutoML',\"score\":metrics.auc(fpr,tpr)},ignore_index=True)\n","b4e3683f":"#Display leaderboard\ndf_ensemble_results.index = df_ensemble_results['team'] \ndel(df_ensemble_results['team'] )\ndf_ensemble_results.sort_values(by='score',ascending=False)","4641c9d3":"### Calculate AUC for the top eight teams\nDoing this as a sanity check to make sure I match the private leaderboard scores","7bab3bd4":"### Display the leaderboard adding in the scores for the ensembles","6a9af6ee":"### Name teams so they match the team names on the leaderboard","5e187fce":"### Load the solution file into a dataframe","dc8dac39":"### Load the top performing submission files into a Dataframe","82428d77":"### Create a few ensembles by average the submission files for the top two teams and top three teams\n","2b02b390":"### Select the private leaderboard rows "}}