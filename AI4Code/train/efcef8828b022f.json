{"cell_type":{"35090dd7":"code","bcc01c92":"code","dba2dcd0":"code","16e4d6ea":"code","ca89577f":"code","56b3815d":"code","976bf7ad":"code","79048cde":"code","08248276":"code","8f723f6a":"code","c6825e5f":"code","1dbdf692":"code","77be086b":"code","0465006c":"code","5ad36cee":"code","184c5cb7":"code","e8d9e974":"code","93def8d6":"code","43413171":"code","9d0f383b":"code","477586a3":"code","3b80be0a":"code","bda2db8d":"code","d89890fb":"code","7a6da4e9":"code","a87d4733":"markdown","735d10bb":"markdown","af08308b":"markdown","a4e74cf5":"markdown"},"source":{"35090dd7":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport math\nfrom sklearn.model_selection import train_test_split\n# from sklearn.ensemble import GradientBoostingClassifier\n# from sklearn.preprocessing import MinMaxScaler\n# from sklearn.svm import SVC\nfrom sklearn.ensemble import RandomForestClassifier\n# from sklearn.model_selection import GridSearchCV","bcc01c92":"df=pd.read_csv(\"\/kaggle\/input\/titanic\/train.csv\")","dba2dcd0":"df.head()","16e4d6ea":"df.info()","ca89577f":"df.Age.plot(kind=\"kde\")\n#to fill age","56b3815d":"df[\"Age\"]=df[\"Age\"].fillna(df[\"Age\"].mean())","976bf7ad":"df.describe().T","79048cde":"# y=(df.Ticket.value_counts()>1).reset_index()\n# y.columns=[\"Ticket\",\"ingroup\"]\n# df=pd.merge(df,y ,on=\"Ticket\") #idea got bad result","08248276":"df=df.drop(columns=[\"Cabin\",\"Name\",\"Ticket\",\"PassengerId\",\"Fare\"])\ndf=df.dropna()","8f723f6a":"df=pd.get_dummies(df,columns=[\"Sex\",\"Embarked\"])","c6825e5f":"df.info()","1dbdf692":"# sorted(df.Age.unique())","77be086b":"df[\"Age\"]=df[\"Age\"].apply(math.ceil)","0465006c":"# sns.pairplot(data=df,\n#              hue='Survived')","5ad36cee":"X=df.drop(columns=\"Survived\")\nY=df[\"Survived\"]\nX_train, X_val, y_train, y_val = train_test_split(X, Y\n                                                  , test_size = .2, random_state = 0,stratify=df[\"Pclass\"])","184c5cb7":"# model_1=GradientBoostingClassifier(n_estimators=400, learning_rate=.01,subsample=0.8\n#                                    ,max_depth=4, random_state=0)\n# model_1.fit(X_train, y_train)\n# model_1.score(X_val, y_val)\n#0.8539325842696629 overfited","e8d9e974":"# scaler=MinMaxScaler()\n# X_train=pd.DataFrame(scaler.fit_transform(X_train),columns=X.columns)\n# X_val=pd.DataFrame(scaler.transform(X_val),columns=X.columns)\n# X_train=np.sqrt(X_train)\n# X_val=np.sqrt(X_val)\n\n# model_2=SVC(kernel=\"poly\",degree=5,class_weight='balanced', random_state=0)\n# model_2.fit(X_train, y_train)\n# model_2.score(X_val, y_val)\n# 0.8314606741573034 overfited","93def8d6":"model_1=RandomForestClassifier(n_estimators=200\n                               ,max_depth=4, random_state=0)\nmodel_1.fit(X_train, y_train)","43413171":"model_1.score(X_val, y_val)","9d0f383b":"# parameters={\"n_estimators\":[200,300,400,450],\"max_depth\":[3,4,5]}\n# gs=GridSearchCV(RandomForestClassifier(random_state=0),parameters).fit(X_train, y_train)","477586a3":"# gs.best_params_\n# {'max_depth': 4, 'n_estimators': 200}\n","3b80be0a":"df2=pd.read_csv(\"\/kaggle\/input\/titanic\/test.csv\")","bda2db8d":"df2.info()","d89890fb":"ids=df2[[\"PassengerId\"]]\ndf2[\"Age\"]=df2[\"Age\"].fillna(df2[\"Age\"].mean())\ndf2=df2.drop(columns=[\"Cabin\",\"Name\",\"Ticket\",\"PassengerId\",\"Fare\"])\ndf2=df2.dropna()\ndf2=pd.get_dummies(df2,columns=[\"Sex\",\"Embarked\"])\ndf2[\"Age\"]=df2[\"Age\"].apply(math.ceil)","7a6da4e9":"y_pdic=model_1.predict(df2)\nids[\"Survived\"]=y_pdic\nids.to_csv('\/kaggle\/working\/submission.csv', index=False)","a87d4733":"# choosing model","735d10bb":"# importing modules","af08308b":"# **split data**","a4e74cf5":"# analysing data"}}