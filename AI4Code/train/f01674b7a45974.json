{"cell_type":{"54a8f643":"code","56f6cb0b":"code","2a21b31c":"code","6b9d8b49":"code","3f5bc29e":"code","3e1e9110":"code","48f11062":"code","06726540":"code","1ce721fb":"code","272b78c8":"code","986eb4b9":"code","1e8ef547":"code","20219b7d":"code","4c00e430":"code","b8e9d1a8":"code","3a577674":"code","1c59acaf":"code","1b649a83":"code","2ae9c9af":"code","3b910957":"code","269045f8":"code","646822db":"code","23af4b0a":"code","201403a3":"code","127688c3":"code","7739d81b":"code","42ed755a":"code","d8a1f624":"code","eac5554d":"code","88ab39c4":"code","301ee97e":"code","9e77315a":"code","8ffa4e5c":"code","8f908256":"code","4aaf6540":"code","05804b68":"code","3dca6ab2":"code","73f48a6e":"code","e6919882":"code","9d3a3bf1":"code","c13c5487":"code","57e111de":"code","14a162d6":"code","670a2a64":"code","0130b195":"code","9b9ee938":"code","9d2d1f7c":"code","a2d25ccc":"code","8063cc01":"code","77914603":"code","ccaad883":"code","f7184786":"code","77b4458a":"code","eb85cd05":"code","41b439bb":"code","80f78447":"code","fa700332":"code","255cb90c":"code","22a61684":"code","76126444":"code","8cd909be":"code","08995971":"code","b07ab0ed":"code","4a0f2054":"code","c4f3f31a":"code","eef641c8":"code","d916f588":"code","cc9bd1d0":"code","7e96cec8":"code","580e7036":"code","f80feae4":"code","1606e41b":"code","e90767be":"code","65ec1a70":"code","15926acf":"code","384b7c1f":"code","0d201eee":"code","16599c15":"code","3440b188":"code","19956a43":"code","ef2906ef":"code","1bbc1c3a":"code","6b2a02bd":"code","006f74fc":"code","657bb02b":"code","a1b465d6":"code","7a99013b":"code","657a6704":"code","e4f8ec86":"code","47fa8fac":"code","bdc78f8f":"code","61b6335a":"code","91614e19":"code","15bc2bb6":"code","4972dbd9":"code","50d4d6d9":"code","5787be30":"code","087c3525":"code","03ba0259":"code","78a40749":"code","a3be75c7":"code","f0c89933":"code","c6d2ffb2":"code","9d087b76":"code","fa456d78":"code","c3aa36ad":"code","4c11e7c6":"code","24ddedee":"code","536d0731":"code","4b320615":"code","99369ca1":"code","94d888d9":"code","40824ec6":"code","76a5a83a":"code","10e83d79":"code","653bcdb0":"code","fc1a1cfa":"code","48b8095f":"code","b6fe60fe":"code","03744315":"code","108d3345":"code","6df3e4f1":"code","02607436":"code","b2e25aed":"code","ed6f2692":"code","3cdfa132":"code","bb90f561":"code","b70beab6":"code","6a61fa6a":"code","7945816a":"code","32c85898":"code","93ce3869":"code","df31bd54":"code","5597e2a5":"code","97fe3c16":"code","a931d465":"code","49ccc35b":"code","3cd55a83":"code","bebec184":"code","39a41d0b":"code","6c731eca":"code","66942523":"code","471574ab":"code","6f292cd8":"code","60ab15ad":"code","ee7ffba4":"code","ddbb2172":"code","0c04857d":"code","e558fc03":"code","8892214f":"code","920df13e":"code","c48d15fa":"code","79c06d44":"code","4a4e9351":"code","d394a412":"code","5230890b":"code","ccaf4dab":"code","6da22cb8":"code","3698a090":"code","beb29397":"code","03221551":"markdown","89ad152b":"markdown","42eff9b2":"markdown","c8f5763a":"markdown","bfb06e6b":"markdown","81837c6d":"markdown","13e2facf":"markdown","2b47d390":"markdown","da6bcc11":"markdown","00265809":"markdown","cc473834":"markdown","2c3b3098":"markdown","5bd4295e":"markdown","7f48eea9":"markdown","90554c8d":"markdown","81d1c476":"markdown","558a3dd1":"markdown","010f4144":"markdown","8561a185":"markdown","1463bb4f":"markdown","8b406b26":"markdown"},"source":{"54a8f643":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport numpy as np\n\n%matplotlib inline\nsns.set(color_codes=True)","56f6cb0b":"Train_data=pd.read_csv(\"..\/input\/Train_UWu5bXk.csv\")\nTest_data=pd.read_csv(\"..\/input\/Test_u94Q5KV.csv\")","2a21b31c":"Train_data.head()","6b9d8b49":"Test_data.head()","3f5bc29e":"print(Train_data.shape)\nprint(Test_data.shape)","3e1e9110":"Train_data.info()","48f11062":"['Item_Fat_Content','Item_Type','Outlet_Size','Outlet_Location_Type','Outlet_Type']","06726540":"Train_data.isnull().sum()","1ce721fb":"Data=Train_data.append(Test_data,sort=False)","272b78c8":"Data.isnull().sum()","986eb4b9":"Train_data.describe()","1e8ef547":"Train_data.describe().columns","20219b7d":"for i in Train_data.describe().columns:\n    sns.distplot(Data[i].dropna())\n    plt.show()","4c00e430":"for i in Train_data.describe().columns:\n    sns.boxplot(Data[i].dropna())\n    plt.show()","b8e9d1a8":"sns.boxplot(Data['Item_Visibility'])","3a577674":"Data['Item_Visibility'].describe()","1c59acaf":"sns.boxplot(y=Data['Item_Weight'],x=Data['Outlet_Identifier'])\nplt.xticks(rotation='vertical')","1b649a83":"Data['Item_Fat_Content'].value_counts()","2ae9c9af":"Data['Item_Fat_Content'] = Data['Item_Fat_Content'].replace({'LF':'Low Fat','reg':'Regular','low fat':'Low Fat'})","3b910957":"Data.groupby('Item_Identifier')['Item_Weight'].mean().head(5)","269045f8":"for i in Data.groupby('Item_Identifier')['Item_Weight'].mean().index:\n    Data.loc[Data.loc[:,'Item_Identifier']==i,'Item_Weight']=Data.groupby('Item_Identifier')['Item_Weight'].mean()[i]","646822db":"Data['Outlet_Type'].value_counts()","23af4b0a":"Data.Outlet_Size[Data['Outlet_Type']=='Grocery Store'].value_counts()","201403a3":"Data.Outlet_Size[Data['Outlet_Type']=='Supermarket Type1'].value_counts()","127688c3":"Data.Outlet_Size[Data['Outlet_Type']=='Supermarket Type2'].value_counts()","7739d81b":"Data.Outlet_Size[Data['Outlet_Type']=='Supermarket Type3'].value_counts()","42ed755a":"#Data['Outlet_Size'].fillna(Data['Outlet_Size'].mode()[0],inplace=True)\nData.Outlet_Size.fillna(Data.Outlet_Size[Data['Outlet_Type']=='Grocery Store'].mode()[0],inplace=True)","d8a1f624":"Data.Outlet_Size.fillna(Data.Outlet_Size[Data['Outlet_Type']=='Supermarket Type1'].mode()[0],inplace=True)","eac5554d":"Data.Outlet_Size.fillna(Data.Outlet_Size[Data['Outlet_Type']=='Supermarket Type2'].mode()[0],inplace=True)","88ab39c4":"Data.Outlet_Size.fillna(Data.Outlet_Size[Data['Outlet_Type']=='Supermarket Type3'].mode()[0],inplace=True)","301ee97e":"for i in Data.groupby('Item_Identifier')['Item_Visibility'].mean().index:\n    Data.loc[Data.loc[:,'Item_Identifier']==i,'Item_Visibility']=Data.groupby('Item_Identifier')['Item_Visibility'].mean()[i]","9e77315a":"Data['Outlet_Establishment_Year']=2013-Data['Outlet_Establishment_Year']","8ffa4e5c":"Data","8f908256":"Data.isnull().sum()","4aaf6540":"Train_data=Data.dropna()","05804b68":"Test_Data=Data[Data['Item_Outlet_Sales'].isnull()]\nTest_Data.drop('Item_Outlet_Sales',axis=1,inplace=True)","3dca6ab2":"sns.boxplot(Train_data['Item_Visibility'])\n\n# Remove outliers from Item visiblity","73f48a6e":"Train_data['Item_Visibility'].describe()","e6919882":"print(Test_Data.shape)\nprint(Train_data.shape)","9d3a3bf1":"len(Train_data)","c13c5487":"len(Test_data)","57e111de":"from sklearn.preprocessing import LabelEncoder","14a162d6":"categorical_list=['Item_Fat_Content','Item_Type','Outlet_Identifier','Outlet_Size','Outlet_Location_Type','Outlet_Type','Outlet_Establishment_Year']","670a2a64":"'''le = LabelEncoder()\nfor i in categorical_list:\n    Data[i]=le.fit_transform(Data[i])\n    Data[i]=Data[i].astype('category')'''","0130b195":"le = LabelEncoder()\nfor i in categorical_list:\n    Train_data[i]=le.fit_transform(Train_data[i])\n    Train_data[i]=Train_data[i].astype('category')\n    Test_Data[i]=le.fit_transform(Test_Data[i])\n    Test_Data[i]=Test_Data[i].astype('category')","9b9ee938":"Data","9d2d1f7c":"Test_Data.head()","a2d25ccc":"Train_data.head()","8063cc01":"Train_data.corr()","77914603":"#from sklearn.model_selection import train_test_split","ccaad883":"#X_train, x_test, Y_train, y_test = train_test_split(Data.drop(['Item_Outlet_Sales','Item_Identifier'],axis=1), Data['Item_Outlet_Sales'], test_size = 0.3)","f7184786":"#Data.Item_Visibility[Data['Item_Visibility']==0].value_counts()","77b4458a":"from sklearn.linear_model import LinearRegression as LR","eb85cd05":"Lm=LR(normalize=True)","41b439bb":"Lm.fit(Train_data.drop(['Item_Outlet_Sales','Outlet_Identifier','Item_Identifier'],axis=1),Train_data['Item_Outlet_Sales'])","80f78447":"#Lm.score(x_test,y_test)","fa700332":"#pred_train=Lm.predict(X_train)","255cb90c":"#pred_test=Lm.predict(x_test)","22a61684":"#from sklearn import metrics","76126444":"#metrics.mean_squared_error(Y_train,pred_train)","8cd909be":"#metrics.mean_squared_error(y_test,pred_test)","08995971":"#metrics.mean_squared_error(Y_train,pred_train)-metrics.mean_squared_error(y_test,pred_test)","b07ab0ed":"Train_data","4a0f2054":"Y_train=Train_data['Item_Outlet_Sales']\nX_train=Train_data.drop('Item_Outlet_Sales',axis=1)","c4f3f31a":"train=Train_data.drop(['Item_Outlet_Sales'],axis=1)\npredictions=Train_data['Item_Outlet_Sales']\nout=[]\nLM_model=LR(normalize=True)\nfor i in range(len(Test_Data)):\n    LM_fit=LM_model.fit(train.drop(['Outlet_Identifier','Item_Identifier'],axis=1),predictions)\n    Output=LM_fit.predict(Test_Data.drop(['Item_Identifier','Outlet_Identifier'],axis=1)[Test_Data.index==i])\n    out.append(Output)\n    train.append(Test_Data[Test_Data.index==i])\n    predictions.append(pd.Series(Output))\n    \n    ","eef641c8":"len(out)","d916f588":"len(Test_Data)","cc9bd1d0":"outp=np.vstack(out)","7e96cec8":"ansp=pd.Series(data=outp[:,0],index=Test_Data.index,name='Item_Outlet_Sales')","580e7036":"Outp_df=pd.DataFrame([Test_data['Item_Identifier'],Test_data['Outlet_Identifier'],ansp]).T","f80feae4":"Outp_df.to_csv('UploadLMP.csv',index=False)","1606e41b":"mod1_train_pred=Lm.predict(Train_data.drop(['Item_Identifier','Outlet_Identifier','Item_Outlet_Sales'],axis=1))","e90767be":"from sklearn import metrics\nfrom math import sqrt","65ec1a70":"sqrt(metrics.mean_squared_error(Train_data['Item_Outlet_Sales'],mod1_train_pred))\/np.mean(Train_data['Item_Outlet_Sales'])","15926acf":"# analytics vidhya score\n#1273.7483459686","384b7c1f":"ans=Lm.predict(Test_Data.drop(['Item_Identifier','Outlet_Identifier'],axis=1))","0d201eee":"answer=pd.Series(data=ans,index=Test_Data.index,name='Item_Outlet_Sales')","16599c15":"#len(ans)","3440b188":"#pd.DataFrame(np.array([[Test_Data['Item_Identifier']],[Test_Data['Outlet_Identifier']],[answer]]),index=Test_Data.index,columns=['Item_Identifier','Outlet_Identifier','Item_Outlet_Sales'])","19956a43":"#dict(ItemTest_Data['Item_Identifier'],Test_Data['Outlet_Identifier'],ans)","ef2906ef":"#(pd.DataFrame(Test_data['Item_Identifier'],Test_data['Outlet_Identifier'],answer).T).to_csv(\"upload.csv\",encoding='utf-8', index=False)","1bbc1c3a":"#Out_df=pd.DataFrame([Test_data['Item_Identifier'],Test_data['Outlet_Identifier'],answer]).T","6b2a02bd":"#Out_df","006f74fc":"#Out_df.to_csv('Upload2.csv',index=False)","657bb02b":"from sklearn.linear_model import Ridge","a1b465d6":"#predictors = [x for x in train.columns if x not in [target]+IDcol]","7a99013b":"rr=Ridge(alpha=0.5,fit_intercept=True,normalize=True)","657a6704":"rr.fit(Train_data.drop(['Item_Outlet_Sales','Outlet_Identifier','Item_Identifier'],axis=1),Train_data['Item_Outlet_Sales'])","e4f8ec86":"rr_pred=rr.predict(Test_Data.drop(['Item_Identifier','Outlet_Identifier'],axis=1))","47fa8fac":"rr_pred_train=rr.predict(Train_data.drop(['Item_Identifier','Outlet_Identifier','Item_Outlet_Sales'],axis=1))","bdc78f8f":"rr_ans=pd.Series(data=rr_pred,index=Test_Data.index,name='Item_Outlet_Sales')","61b6335a":"len(ans)","91614e19":"rr_out=pd.DataFrame([Test_data['Item_Identifier'],Test_data['Outlet_Identifier'],rr_ans]).T","15bc2bb6":"#rr_out.to_csv('Uploadrr.csv',index=False)","4972dbd9":"sqrt(metrics.mean_squared_error(Train_data['Item_Outlet_Sales'],rr_pred_train))\/np.mean(Train_data['Item_Outlet_Sales'])","50d4d6d9":"from sklearn.linear_model import Lasso","5787be30":"lasso=Lasso(alpha=0.5,fit_intercept=True,normalize=True)","087c3525":"lasso.fit(Train_data.drop(['Item_Outlet_Sales','Outlet_Identifier','Item_Identifier'],axis=1),Train_data['Item_Outlet_Sales'])","03ba0259":"lasso_pred=lasso.predict(Test_Data.drop(['Item_Identifier','Outlet_Identifier'],axis=1))","78a40749":"lasso_pred_train=lasso.predict(Train_data.drop(['Item_Outlet_Sales','Outlet_Identifier','Item_Identifier'],axis=1))","a3be75c7":"lasso_ans=pd.Series(data=lasso_pred,index=Test_Data.index,name='Item_Outlet_Sales')","f0c89933":"len(lasso_pred)","c6d2ffb2":"lasso_out=pd.DataFrame([Test_data['Item_Identifier'],Test_data['Outlet_Identifier'],rr_ans]).T","9d087b76":"#lasso_out.to_csv('Uploadlasso.csv',index=False)","fa456d78":"sqrt(metrics.mean_squared_error(Train_data['Item_Outlet_Sales'],lasso_pred_train))\/np.mean(Train_data['Item_Outlet_Sales'])","c3aa36ad":"from sklearn.svm import SVR","4c11e7c6":"svr=SVR(kernel='linear',gamma='auto',C=5,epsilon=1.2)","24ddedee":"svr.fit(Train_data.drop(['Item_Outlet_Sales','Outlet_Identifier','Item_Identifier'],axis=1),Train_data['Item_Outlet_Sales'])","536d0731":"svr_pred=svr.predict(Test_Data.drop(['Item_Identifier','Outlet_Identifier'],axis=1))","4b320615":"svr_pred_train=svr.predict(Train_data.drop(['Item_Outlet_Sales','Outlet_Identifier','Item_Identifier'],axis=1))","99369ca1":"svr_ans=pd.Series(data=svr_pred,index=Test_Data.index,name='Item_Outlet_Sales')","94d888d9":"svr_out=pd.DataFrame([Test_data['Item_Identifier'],Test_data['Outlet_Identifier'],svr_ans]).T","40824ec6":"#svr_out.to_csv('Uploadsvr.csv',index=False)","76a5a83a":"sqrt(metrics.mean_squared_error(Train_data['Item_Outlet_Sales'],svr_pred_train))\/np.mean(Train_data['Item_Outlet_Sales'])","10e83d79":"sqrt(metrics.mean_squared_error(Train_data['Item_Outlet_Sales'],svr_pred_train))","653bcdb0":"svr_pred_train","fc1a1cfa":"#Train_data['Item_Outlet_Sales']","48b8095f":"from sklearn.tree import DecisionTreeRegressor","b6fe60fe":"DTR=DecisionTreeRegressor()\n","03744315":"DTR.fit(Train_data.drop(['Item_Outlet_Sales','Outlet_Identifier','Item_Identifier'],axis=1),Train_data['Item_Outlet_Sales'])","108d3345":"dtr_pred_train=DTR.predict(Train_data.drop(['Item_Outlet_Sales','Outlet_Identifier','Item_Identifier'],axis=1))","6df3e4f1":"sqrt(metrics.mean_squared_error(Train_data['Item_Outlet_Sales'],dtr_pred_train))\/np.mean(Train_data['Item_Outlet_Sales'])","02607436":"sqrt(metrics.mean_squared_error(Train_data['Item_Outlet_Sales'],dtr_pred_train))","b2e25aed":"dtr_pred_train","ed6f2692":"dtr_pred=DTR.predict(Test_Data.drop(['Item_Identifier','Outlet_Identifier'],axis=1))","3cdfa132":"dtr_ans=pd.Series(data=dtr_pred,index=Test_Data.index,name='Item_Outlet_Sales')","bb90f561":"dtr_out=pd.DataFrame([Test_data['Item_Identifier'],Test_data['Outlet_Identifier'],dtr_ans]).T","b70beab6":"#dtr_out.to_csv('Uploaddtr.csv',index=False)","6a61fa6a":"from sklearn.metrics import r2_score","7945816a":"r2_score(Train_data['Item_Outlet_Sales'],dtr_pred_train)","32c85898":"from sklearn.neural_network import MLPRegressor","93ce3869":"ann=MLPRegressor(activation='relu',alpha=2.0,learning_rate='adaptive',warm_start=True,hidden_layer_sizes=(2500,),max_iter=1000)","df31bd54":"ann.fit(Train_data.drop(['Item_Outlet_Sales','Outlet_Identifier','Item_Identifier'],axis=1),Train_data['Item_Outlet_Sales'])","5597e2a5":"ann_train_pred=ann.predict(Train_data.drop(['Item_Outlet_Sales','Outlet_Identifier','Item_Identifier'],axis=1))","97fe3c16":"ann_train_pred","a931d465":"r2_score(Train_data['Item_Outlet_Sales'],ann_train_pred)","49ccc35b":"sqrt(metrics.mean_squared_error(Train_data['Item_Outlet_Sales'],ann_train_pred))\/np.mean(Train_data['Item_Outlet_Sales'])","3cd55a83":"ann_pred=ann.predict(Test_Data.drop(['Item_Identifier','Outlet_Identifier'],axis=1))","bebec184":"ann_ans=pd.Series(data=ann_pred,index=Test_Data.index,name='Item_Outlet_Sales')","39a41d0b":"ann_out=pd.DataFrame([Test_data['Item_Identifier'],Test_data['Outlet_Identifier'],ann_ans]).T","6c731eca":"ann_out.to_csv('Uploadann.csv',index=False)","66942523":"from keras.models import Sequential\nfrom keras.layers import Dense\nfrom keras.layers import LSTM\nfrom keras.wrappers.scikit_learn import KerasRegressor\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.model_selection import KFold\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.pipeline import Pipeline","471574ab":"X_train=np.array(Train_data.drop(['Item_Outlet_Sales','Outlet_Identifier','Item_Identifier'],axis=1))\ny_train=np.array(Train_data['Item_Outlet_Sales'])","6f292cd8":"#X_train = np.reshape(X_train, (X_train.shape[0], 1, X_train.shape[1]))\n#X_test = np.reshape(X_test, (X_test.shape[0], 1,))","60ab15ad":"# define base model\ndef baseline_model():\n    # create model\n    model = Sequential()\n    model.add(Dense(91, input_dim=9, kernel_initializer='Orthogonal', activation='elu'))\n    model.add(Dense(78,activation='relu',kernel_initializer='Orthogonal'))\n    model.add(Dense(65,activation='relu',kernel_initializer='Orthogonal'))\n    model.add(Dense(52,activation='relu',kernel_initializer='Orthogonal'))\n    model.add(Dense(39,activation='relu',kernel_initializer='Orthogonal'))    \n    model.add(Dense(26,activation='relu',kernel_initializer='Orthogonal'))\n    model.add(Dense(1,activation='relu',kernel_initializer='Orthogonal'))   \n    # Compile model\n    model.compile(loss='mean_squared_error', optimizer='adam')\n    return model","ee7ffba4":"seed = 7\nnp.random.seed(seed)\nestimator = KerasRegressor(build_fn=baseline_model, epochs=50, batch_size=20, verbose=0)","ddbb2172":"estimator.fit(X_train,y_train, batch_size = 50, epochs = 200)","0c04857d":"ann1_pred_train=estimator.predict(X_train)","e558fc03":"r2_score(Train_data['Item_Outlet_Sales'],ann1_pred_train)","8892214f":"sqrt(metrics.mean_squared_error(Train_data['Item_Outlet_Sales'],ann1_pred_train))\/np.mean(Train_data['Item_Outlet_Sales'])","920df13e":"#X_test=np.array(Test_Data.drop(['Item_Identifier','Outlet_Identifier'],axis=1))","c48d15fa":"#X_test = np.reshape(X_test, (X_test.shape[0], 1, X_test.shape[1]))","79c06d44":"X_train","4a4e9351":"Test_Data.head()\n","d394a412":"Test_Data.shape","5230890b":"Train_data.shape","ccaf4dab":"ann1_pred=estimator.predict(np.array(Test_Data.drop(['Outlet_Identifier','Item_Identifier'],axis=1)))","6da22cb8":"ann1_ans=pd.Series(data=ann1_pred,index=Test_Data.index,name='Item_Outlet_Sales')","3698a090":"ann1_out=pd.DataFrame([Test_data['Item_Identifier'],Test_data['Outlet_Identifier'],ann1_ans]).T","beb29397":"ann1_out.to_csv('Uploadann1.csv',index=False)","03221551":"---\n---","89ad152b":"---\n---","42eff9b2":"# Model 4 (SVR)","c8f5763a":"# Dealing with outlet establishment year","bfb06e6b":"# ANN using keras","81837c6d":"## Prediction Using Regression","13e2facf":"# Decision Tree","2b47d390":"## Model 1","da6bcc11":"# Model 3","00265809":"---\n---","cc473834":"---\n---","2c3b3098":"## Imputing Item Visibltiy values via mean","5bd4295e":"---\n---","7f48eea9":"---\n---","90554c8d":"---\n---","81d1c476":"---\n---","558a3dd1":"### Result\n + Ridge regression with alpha=0.1, socre is 1284\n + Ridge regression with alpha=0.5 score is 1338","010f4144":"# imputing Item visiblity","8561a185":"# Model 2\n","1463bb4f":"# Lasso results\n+ with alpha=0.1, is 1338\n+ with alpha=0.5, is 1338","8b406b26":"# MLP"}}