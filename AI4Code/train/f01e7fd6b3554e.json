{"cell_type":{"2daf461f":"code","34436df7":"code","343afc44":"code","b9305005":"code","bd2c6b38":"code","bb8cb22f":"code","2ab09126":"code","7c31d7f4":"code","faecde6d":"code","a139e807":"code","3b982045":"code","79040189":"code","ddb88042":"code","c1994491":"code","fe12995c":"code","7673c488":"code","c3d68332":"code","1ebc8a14":"code","acb5645e":"code","e0a437b8":"code","37f0a3ec":"code","7a523abf":"code","ff53573a":"code","4e5c26b7":"code","7aed588d":"code","7961c6bb":"code","5441aae6":"code","1728a5c5":"code","288a5786":"code","76b2e5aa":"code","0851e08d":"code","5dfc7611":"code","59e015ca":"code","d90182c0":"code","05b09e3b":"code","ff1011e4":"code","1a2ab15b":"code","15f83443":"code","7189c3a2":"code","c6a76920":"code","18e09b56":"code","368da109":"markdown","8bb4afd0":"markdown","6a616c8b":"markdown","9f88e794":"markdown","9cf8ab09":"markdown","c0b4ce6a":"markdown","1df73b00":"markdown","a4ddd8c3":"markdown","ec069221":"markdown","93ec5ffe":"markdown","4d06d623":"markdown","954b3e6a":"markdown","1307dbb9":"markdown","7eae638e":"markdown","5fa3a716":"markdown","8d0ce9d0":"markdown","313da583":"markdown","d3de5015":"markdown","73095225":"markdown","d3a370a5":"markdown","12a94dc9":"markdown","ea3a6b31":"markdown","f349a164":"markdown","ef672027":"markdown","1d1ffdff":"markdown"},"source":{"2daf461f":"import pandas as pd\nimport sqlite3 \nimport os","34436df7":"conn = sqlite3.connect('..\/input\/chinook-music-store-data\/chinook.db')\nc = conn.cursor()","343afc44":"def sq(q):\n    return pd.read_sql_query(q, conn).rename(columns = lambda x:x.replace(' ','_').capitalize())","b9305005":"#Lets show our tables ","bd2c6b38":"tables = sq('''select Name,type\n               from sqlite_master \n               where type='table' ''')\ntables","bb8cb22f":"album = sq('''select * from album''')\nalbum.head()","2ab09126":"artist = sq('''select * from Artist''')\nartist.head()","7c31d7f4":"customer = sq('''select * from customer''')\ncustomer.head()","faecde6d":"employee = sq('''select * from Employee''')\nemployee.head()","a139e807":"genre = sq('''select *from Genre''')\ngenre.head()","3b982045":"invoice_line = sq('''select * from invoice_line''')\ninvoice_line.head()","79040189":"invoice = sq('''select * from Invoice''')\ninvoice.head()","ddb88042":"media_type = sq('''select * from Media_Type''')\nmedia_type.head()","c1994491":"playlist = sq('''select * from Playlist''')\nplaylist.head()","fe12995c":"playlist_track = sq('''select * from Playlist_Track''')\nplaylist_track.head()","7673c488":"track = sq('''select * from Track''')\ntrack.head()","c3d68332":"sq('''select First_name||' '||Last_name as Name, country, customer_id\n    from customer \n    where Country <> 'USA' ''').head() #OR (where Country != 'USA')","1ebc8a14":"sq('''select customer_id ,first_name||' '||last_name as Name,country \n    from customer\n    where country is 'Brazil' ''') #is ---> =","acb5645e":"sq('''select c.customer_id, c.first_name||' '||c.last_name as Name, i.invoice_id, i.invoice_date, i.billing_country\n    from customer as c\n    join invoice as i on c.customer_id = i.customer_id \n    where country is \"Brazil\" ''').head()","e0a437b8":"sq('''select *\n    from employee\n    where title like \"%Sales%Agent%\" ''')","37f0a3ec":"sq('''select distinct Billing_country \n    from invoice ''').head() #OR (group by billingcountry)","7a523abf":"sq('''select i.invoice_id ,e.first_name||' '||e.last_name as Name\n    from customer as c\n    left join invoice as i on i.customer_id = c.customer_id\n    left join employee as e on e.employee_id = c.Support_rep_id ''')","ff53573a":"sq('''select c.first_name||' '||c.last_name as Customer_Name,\n             e.first_name||' '||e.last_name as Employee_Name,\n             i.Total ,c.country ,e.title\n    from customer as c\n    left join invoice as i on i.customer_id = c.customer_id \n    left join employee as e on e.employee_id = c.support_rep_id''')","4e5c26b7":"sq('''select  strftime('%Y',Invoice_Date) as Year, count(*) as invoices_by_year\n      from invoice\n      group by 1''')#strftime(format, timestring, modifier, modifier, ...)","7aed588d":"# Using subquery\nsq('''select\n  (select count(*)\n  from invoice i\n  where substr(i.invoice_date, 0, 5) = \"2009\") as Invoices_2009,\n  (select count(*)\n    from invoice i\n    where substr(i.invoice_date, 0, 5) = \"2011\") as Invoices_2011 ''') #SUBSTR(string, start, length)","7961c6bb":"sq('''select count(*) as line_items_ID_37\n    from invoice_line\n    where Invoice_Id is 37''')","5441aae6":"sq('''select invoice_id ,count(*) as Count\n    from invoice \n    group by invoice_id''')","1728a5c5":"sq('''select t.Name as Track_name, i.*\n    from  invoice_line as i\n    left join track as t on i.track_id=t.track_id \n    ''')","288a5786":"sq('''select  t.name as Track_name ,art.Name as artist ,a.artist_id as Artist_id,il.*\n    from invoice_line as il\n    left join track as t on t.track_id = il.track_id \n    left join album as a on a.album_id = t.album_id \n    left join artist as art on art.artist_id = a.artist_id\n    ''')","76b2e5aa":"sq('''select billing_country ,count(*) as invoices_count\n    from invoice \n    group by billing_country\n    order by 2 desc\n    ''').head()","0851e08d":"sq('''select p.Name as Playlist_Name ,count(*) as number_of_tracks\n    from playlist_track as pt \n    left join playlist as p on p.playlist_id = pt.playlist_id \n    group by pt.playlist_id\n    order by 2 desc''')","5dfc7611":"sq('''select t.Name as Track_name, a.title as Album_title ,m.name ,g.name as Genre\n    from track as t \n    left join media_type as m on m.media_type_id = t.media_type_id\n    left join genre as g on g.genre_id = t.genre_id\n    left join album as a on a.album_id = t.album_id ''').head()","59e015ca":"sq('''select i.invoice_id ,count(*) as invoice_count\n    from invoice as i \n    left join invoice_line as il on il.invoice_id = i.invoice_id\n    group by 1''')","d90182c0":"sq('''select  e.First_Name || \" \" || e.last_Name as Name, count(*) as Toltal_Sales\n    from employee as e\n    left join customer as c on c.Support_Rep_Id  = e.employee_id \n    left join invoice as i on c.Customer_Id = i.Customer_Id\n    group by employee_id\n    order by 2 desc''')","05b09e3b":"sq('''select i.billing_country ,sum(total) as country_sales\n    from invoice as i\n    group by billing_country \n    order by 2 desc\n    limit 1''')","ff1011e4":"sq('''select  e.First_Name||' '||e.last_Name as Agent_Name,count(*) as Total_Sales\n    from employee as e\n    left join customer as c on e.employee_id = c.Support_Rep_Id\n    left join invoice as i on i.customer_id = c.customer_id \n    where substr(i.invoice_date ,0,5) = \"2009\"\n    group by e.employee_id\n    order by 2''')","1a2ab15b":"sq('''select e.first_name||' '||e.last_name as Employee_name, count(*) as Total_sales\n    from employee as e \n    left join customer as c on c.support_rep_id = e.employee_id\n    left join invoice as i on i.customer_id = c.customer_id \n    where substr(i.invoice_date ,0,5) = \"2010\"\n    group by e.employee_id\n    order by 2 desc''')","15f83443":"sq('''select e.first_name||' '||e.last_name as Agent_name, count(*) as Total_sales\n    from employee as e\n    left join customer as c on c.support_rep_id = e.employee_id\n    left join invoice as i on c.customer_id = i.customer_id\n    group by e.employee_id\n    order by 2 desc''')","7189c3a2":"sq('''select t.name as Track_name,count(*) as Track_sales\n    from invoice as i\n    left join invoice_line as il on il.invoice_id = i.invoice_id\n    left join track as t on t.track_id = il.track_id\n    where invoice_date in ('2013')\n    group by t.track_id\n    order by 2 desc''')","c6a76920":"sq('''select t.name as Track_name ,count(*) as Tack_sales\n    from invoice_line as il\n    left join track as t on t.track_id = il.track_id\n    group by t.track_id\n    order by 2 desc ''')","18e09b56":"sq('''select art.Name as Artist_name ,count(*) as Artist_sales\n    from invoice_line as i\n    left join track as t on i.track_id = i.track_id\n    left join album as a on a.album_id = t.album_id\n    left join artist as art on art.artist_id = a.artist_id \n    group by art.artist_id\n    order by 2 desc \n    limit 3''')","368da109":"### 13-Provide a query that shows the total number of tracks in each playlist. The Playlist name should be included on the resultant table.","8bb4afd0":"### 1-Provide a query showing Customers (just their full names, customer ID and country) who are not in the US.","6a616c8b":"### 11-Provide a query that includes the purchased track name AND artist name with each invoice line item.","9f88e794":"### 5-Provide a query that shows the invoices associated with each sales agent. The resultant table should include the Sales Agent's full name.","9cf8ab09":"### 18-Which sales agent made the most in sales in 2009?","c0b4ce6a":"### 12-Provide a query that shows the number of invoices per country.","1df73b00":"### 4-Provide a query showing only the Employees who are Sales Agents.","a4ddd8c3":"### 10-Provide a query that includes the track name with each invoice line item.","ec069221":"### 22-Provide a query that shows the top 5 most purchased tracks over all.","93ec5ffe":"### 14-Provide a query that shows all the Tracks, but displays no IDs. The resultant table should include the Album name, Media type and Genre.","4d06d623":"### 23-Provide a query that shows the top 3 best selling artists.","954b3e6a":"### 9-Looking at the InvoiceLine table, provide a query that COUNTs the number of line items for each Invoice. ","1307dbb9":"### 4-Provide a query showing a unique list of billing countries from the Invoice table.","7eae638e":"<h3>Chinook Questions<\/h3><br>\n<b><li>This database includes several tables on invoice information, track, album, artist and genre data, and employee and customer information related to the store's sales. We will use this database and the sqlite3 module in order to explore and answer some questions.<\/li><b>\n<img src=\"https:\/\/docs.yugabyte.com\/images\/sample-data\/chinook\/chinook-er-diagram.png\" alt=\"Chinook sample database\">","5fa3a716":"### 15-Provide a query that shows all Invoices but includes the number of invoice line items.","8d0ce9d0":"### 6-Provide a query that shows the Invoice Total, Customer name, Country and Sale Agent name for all invoices and customers.","313da583":"### 21-Provide a query that shows the most purchased track of 2013.","d3de5015":"### 3-Provide a query showing the Invoices of customers who are from Brazil. The resultant table should show the customer's full name, Invoice ID, Date of the invoice and billing country.","73095225":"### 16-Provide a query that shows total sales made by each sales agent.","d3a370a5":"### 2-Provide a query only showing the Customers from Brazil.\n","12a94dc9":"### 19-Which sales agent made the most in sales in 2010?","ea3a6b31":"###  8-Looking at the InvoiceLine table, provide a query that COUNTs the number of line items for Invoice ID 37.","f349a164":"###  7-How many Invoices were there in 2009 and 2011? What are the respective total sales for each of those years?","ef672027":"###  17-Provide a query that shows the total sales per country. Which country's customers spent the most?","1d1ffdff":"### 20-Which sales agent made the most in sales over all?"}}