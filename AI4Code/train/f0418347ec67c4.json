{"cell_type":{"4a75d15d":"code","43336d1b":"code","fac611a0":"code","456e4113":"code","1cfbb00a":"code","c226157b":"code","41696890":"code","5bce0563":"code","546f5f59":"code","fbfbf187":"code","dd89b82b":"code","b6000800":"code","b54309f5":"code","a6490de9":"code","bdc44066":"code","a5e77cbc":"code","5ec0b913":"code","2a936e87":"code","3e123565":"code","780f2df4":"code","228626ec":"code","2ddb3009":"code","b7b8b8fd":"code","0e4f7b24":"code","3fa9a744":"code","7b32f051":"markdown","c0d3b13e":"markdown","434bdc38":"markdown","41d2ff66":"markdown","9850dc94":"markdown","a0c19938":"markdown","03844657":"markdown","892d8bd5":"markdown","83c75c82":"markdown","98433c81":"markdown","8e54fc94":"markdown","388c5ed1":"markdown","5546fc32":"markdown","ef70f9fa":"markdown","123b2e11":"markdown","4d09c366":"markdown","d254ea6c":"markdown","253034c4":"markdown","01986150":"markdown","160d6104":"markdown"},"source":{"4a75d15d":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nfrom glob import glob\nimport cv2\n\n# import model \nfrom keras.preprocessing.image import ImageDataGenerator, img_to_array, load_img\nfrom keras.models import Sequential \nfrom keras.layers import Conv2D, MaxPooling2D, Activation, Dropout, Flatten, Dense\n\n#import warnings\nimport warnings\nwarnings.filterwarnings('ignore')\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","43336d1b":"train_dir = '\/kaggle\/input\/fruits\/fruits-360\/Training\/'\ntest_dir =  '\/kaggle\/input\/fruits\/fruits-360\/Test\/'","fac611a0":"fruits = []\nfruits_image = []\nfor i in os.listdir(train_dir):\n    for image_filename in os.listdir(train_dir + i):\n        fruits.append(i) # name of the fruit \n        fruits_image.append(i + '\/' + image_filename) # image of the fruit","456e4113":"train_fruits = pd.DataFrame(fruits, columns=[\"Fruits\"])\ntrain_fruits[\"Fruits Image\"] = fruits_image","1cfbb00a":"train_fruits","c226157b":"from collections import Counter\nnewData = Counter(train_fruits[\"Fruits\"])\nmost_fruits = newData.most_common(15)\n\nprint(\"The 15 most frequently found fruits in the data set and their number\")\nmost_fruits","41696890":"x,y = zip(*most_fruits)\nx,y = list(x),list(y)","5bce0563":"print(\"The 15 most frequently found fruits in the dataset -- > \\n \", x)","546f5f59":"plt.figure(figsize=(15,10))\nax= sns.barplot(x=x, y=y, palette=sns.color_palette(\"BuGn_r\", 15)) \nplt.xlabel('Fruits', size = 20) \nplt.ylabel('Number of Fruits', size = 20 )\nplt.xticks(rotation = 75)\nplt.title('The 15 most frequently found fruits in the data set and their number') \nplt.show()","fbfbf187":"plt.figure(figsize=(25,16))\nhow_many_fruits = len(x)\n\nfor i in range(how_many_fruits):\n    fruits = train_fruits[train_fruits[\"Fruits\"] == x[i]][\"Fruits Image\"].values [1]\n    \n    plt.subplot(3,5,i+1)\n    img = load_img(train_dir + fruits)\n    plt.imshow(img)\n    plt.title(x[i].upper(), color = \"green\", fontsize = 15 , fontweight = 600)\n    plt.axis(\"off\")\n\nplt.suptitle(\"The 15 Most Abundant Fruits\", fontsize = 25 , color = \"darkred\", fontweight = 'bold')\nplt.show()","dd89b82b":"img = load_img(train_dir + \"Cantaloupe 1\/r_234_100.jpg\")\nplt.imshow(img)\nplt.axis(\"off\")\nplt.show()","b6000800":"array_image = img_to_array(img)\nprint(\"Image Shape --> \", array_image.shape)","b54309f5":"fruitCountUnique = glob(train_dir + '\/*' )\nnumberOfClass = len(fruitCountUnique)\nprint(\"How many different fruits are there  -->  \",numberOfClass)","a6490de9":"model = Sequential()\nmodel.add(Conv2D(32,(3,3),input_shape = array_image.shape))\nmodel.add(Activation(\"relu\"))\nmodel.add(MaxPooling2D())\n\nmodel.add(Conv2D(32,(3,3)))\nmodel.add(Activation(\"relu\"))\nmodel.add(MaxPooling2D())\n\nmodel.add(Conv2D(64,(3,3)))\nmodel.add(Activation(\"relu\"))\nmodel.add(MaxPooling2D())\n\nmodel.add(Flatten())\nmodel.add(Dense(1024))\nmodel.add(Activation(\"relu\"))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(numberOfClass)) # output\nmodel.add(Activation(\"softmax\"))","bdc44066":"model.compile(loss = \"categorical_crossentropy\",\n              optimizer = \"rmsprop\",\n              metrics = [\"accuracy\"])","a5e77cbc":"epochs = 100  \nbatch_size = 32","5ec0b913":"print(\"Target Size --> \", array_image.shape[:2])","2a936e87":"train_datagen = ImageDataGenerator(rescale= 1.\/255,\n                   shear_range = 0.3,\n                   horizontal_flip=True,\n                   zoom_range = 0.3)\n\ntest_datagen = ImageDataGenerator(rescale= 1.\/255)","3e123565":"train_generator = train_datagen.flow_from_directory(\n        train_dir, \n        target_size= array_image.shape[:2],\n        batch_size = batch_size,\n        color_mode= \"rgb\",\n        class_mode= \"categorical\")","780f2df4":"test_generator = test_datagen.flow_from_directory(\n        test_dir, \n        target_size= array_image.shape[:2],\n        batch_size = batch_size,\n        color_mode= \"rgb\",\n        class_mode= \"categorical\")","228626ec":"for data_batch, labels_batch in train_generator:\n    print(\"data_batch shape --> \",data_batch.shape)\n    print(\"labels_batch shape --> \",labels_batch.shape)\n    break","2ddb3009":"hist = model.fit_generator(\n        generator = train_generator,\n        steps_per_epoch = 1600 \/\/ batch_size,\n        epochs=epochs,\n        validation_data = test_generator,\n        validation_steps = 800 \/\/ batch_size)","b7b8b8fd":"hist.history.keys()","0e4f7b24":"plt.figure()\nplt.plot(hist.history[\"loss\"],label = \"Train Loss\", color = \"black\")\nplt.plot(hist.history[\"val_loss\"],label = \"Validation Loss\", color = \"darkred\", linestyle=\"dashed\",markeredgecolor = \"purple\", markeredgewidth = 2)\nplt.title(\"Model Loss\", color = \"darkred\", size = 13)\nplt.legend()\nplt.show()","3fa9a744":"plt.figure()\nplt.plot(hist.history[\"accuracy\"],label = \"Train Accuracy\", color = \"black\")\nplt.plot(hist.history[\"val_accuracy\"],label = \"Validation Accuracy\", color = \"darkred\", linestyle=\"dashed\",markeredgecolor = \"purple\", markeredgewidth = 2)\nplt.title(\"Model Accuracy\", color = \"darkred\", size = 13)\nplt.legend()\nplt.show()","7b32f051":"<a id = \"5\" ><\/a>\n<ul>\n    <li style = 'color:green;font-size:16px'> <p style = 'font-weight:bold'> \ud83c\udf50 Epochs and Batch Size  <\/p> <\/li>\n<\/ul>","c0d3b13e":"<a id = \"8\" ><\/a>\n<h2 style = \"background-image:url('https:\/\/t1.pixers.pics\/img-1fb6f67c\/posterler-sari-meyveler-desen.jpg?H4sIAAAAAAAAA3VOW46DMAy8TpAAG0xi4AD97REQj9DNlkeUpLvVnn4TVf2s7JHtke0ZeBx-XDXM-gjawW6WZdOwmi1Ovnfamz8tpKxzzPrIbgIxduePdrM7rSgk5QkKOSHrf8d4uI_uLr5CsL4H8FRa84zfYpk9zLuHGisGZJCdopY6wkXxMtiteC0GM98LhU-JpT1uOabI3l4axLxJHoIzu4imzigXxLe9ZfBB8tVDvILLFagDblNKlajhcqWOW26lGpaVxknh1GhmqoiRkNdubLWeqqZe6zKq_ANn9tv0MQEAAA==');background-position: center;text-shadow: 12px 10px 4px #333;color:black;border:0;font-family:Palatino Linotype;font-weight:bold;font-size:25px;text-indent:10px\">Evaluate the model<\/h2>","434bdc38":"<a id = \"1\" ><\/a>\n<h2 style = \"background-image:url('https:\/\/t1.pixers.pics\/img-1fb6f67c\/posterler-sari-meyveler-desen.jpg?H4sIAAAAAAAAA3VOW46DMAy8TpAAG0xi4AD97REQj9DNlkeUpLvVnn4TVf2s7JHtke0ZeBx-XDXM-gjawW6WZdOwmi1Ovnfamz8tpKxzzPrIbgIxduePdrM7rSgk5QkKOSHrf8d4uI_uLr5CsL4H8FRa84zfYpk9zLuHGisGZJCdopY6wkXxMtiteC0GM98LhU-JpT1uOabI3l4axLxJHoIzu4imzigXxLe9ZfBB8tVDvILLFagDblNKlajhcqWOW26lGpaVxknh1GhmqoiRkNdubLWeqqZe6zKq_ANn9tv0MQEAAA==');background-position: center;text-shadow: 12px 10px 4px #333;color:black;border:0;font-family:Palatino Linotype;font-weight:bold;font-size:25px;text-indent:10px\">Load and Check Data<\/h2>","41d2ff66":"<a id = \"10\" ><\/a>\n<ul>\n    <li style = 'color:gray;font-size:16px'> <p style = 'font-weight:bold'> \ud83c\udf48 Accuracy Chart  <\/p> <\/li>\n<\/ul> ","9850dc94":"<a id = \"9\" ><\/a>\n<ul>\n    <li style = 'color:brown;font-size:16px'> <p style = 'font-weight:bold'> \ud83c\udf30 Loss Chart  <\/p> <\/li>\n<\/ul> ","a0c19938":"<ul>\n    <li style = 'color:red'> <p style = 'font-weight:bold;color:black'> \ud83c\udf49  Let's look at the shape of the pictures we have. <\/p> <\/li>\n    <li style = 'color:yellow'> <p style = 'font-weight:bold;color:black'> \ud83c\udf50  this is important to us because this will be the input value of our model. <\/p> <\/li>\n<\/ul>","03844657":"<ul>\n    <li style = 'color:darkred'> <p style = 'font-weight:bold;color:black'> \ud83c\udf4e File paths containing your test and training data <\/p> <\/li>\n<\/ul>","892d8bd5":"<ul>\n    <li style = 'color:yellow'> <p style = 'font-weight:bold;color:black'> \ud83c\udf4d Let's take a look at the 15 most common fruits among these fruits. <\/p> <\/li>\n<\/ul>","83c75c82":"<h2 style = \"background-image:url('https:\/\/t1.pixers.pics\/img-1fb6f67c\/posterler-sari-meyveler-desen.jpg?H4sIAAAAAAAAA3VOW46DMAy8TpAAG0xi4AD97REQj9DNlkeUpLvVnn4TVf2s7JHtke0ZeBx-XDXM-gjawW6WZdOwmi1Ovnfamz8tpKxzzPrIbgIxduePdrM7rSgk5QkKOSHrf8d4uI_uLr5CsL4H8FRa84zfYpk9zLuHGisGZJCdopY6wkXxMtiteC0GM98LhU-JpT1uOabI3l4axLxJHoIzu4imzigXxLe9ZfBB8tVDvILLFagDblNKlajhcqWOW26lGpaVxknh1GhmqoiRkNdubLWeqqZe6zKq_ANn9tv0MQEAAA==');background-position: center;text-shadow: 12px 10px 4px #333;color:black;border:0;font-family:Palatino Linotype;font-weight:bold;font-size:25px;text-indent:10px\">Import Library<\/h2>","98433c81":"<a id = \"6\" ><\/a>\n<ul>\n    <li style = 'color:red;font-size:16px'> <p style = 'font-weight:bold'> \ud83c\udf45 Data Augmentation  <\/p> <\/li>\n<\/ul> ","8e54fc94":"<a id = \"3\" ><\/a>\n<ul>\n    <li style = 'color:purple;font-size:16px'> <p style = 'font-weight:bold'> \ud83c\udf47 Create Model <\/p> <\/li>\n<\/ul>","388c5ed1":"<ul>\n    <li style = 'color:purple'> <p style = 'font-weight:bold;color:black'> \ud83c\udf47 Let's see better by visualizing the top 15 most common fruits you found above. <\/p> <\/li>\n<\/ul>","5546fc32":"<a id = \"4\" ><\/a>\n<ul>\n    <li style = 'color:darkred;font-size:16px'> <p style = 'font-weight:bold'> \ud83c\udf52 Compile Model <\/p> <\/li>\n<\/ul>","ef70f9fa":"<ul>\n    <li style = 'color:green'> <p style = 'font-weight:bold;color:black'> \ud83e\udd51  Let's take a look at the pictures of these fruits. <\/p> <\/li>\n<\/ul>","123b2e11":"<a id ='11' ><\/a>\n<h4 style = \"background:#0C0C0C ;color:white;border:0;font-family:Bahnschrift SemiBold;font-weight:bold\"> CONCLUSION<\/h4>\n\n<p style = \"color:darkred;font-family:Bahnschrift SemiBold;font-weight:bold\" > I am waiting for them if you have any questions or suggestions. <\/p>\n\n<p style = \"color:black;font-family:Bahnschrift SemiBold;font-weight:bold\" >  Seaborn Tutorial -->  \n    <a href = \"https:\/\/www.kaggle.com\/rafetcan\/visualization-tutorial-with-seaborn\" >https:\/\/www.kaggle.com\/rafetcan\/visualization-tutorial-with-seaborn<\/a>\n<\/p>\n<p style = \"color:black;font-family:Bahnschrift SemiBold;font-weight:bold\" >  Plotly Tutorial -->  \n    <a href = \"https:\/\/www.kaggle.com\/rafetcan\/plotly-tutorial-for-beginners\" >https:\/\/www.kaggle.com\/rafetcan\/plotly-tutorial-for-beginners<\/a>\n    <\/p>\n<p style = \"color:black;font-family:Bahnschrift SemiBold;font-weight:bold\" >      Convolutional Neural Network (CNN) Tutorial -->  \n    <a href = \"https:\/\/www.kaggle.com\/rafetcan\/convolutional-neural-network-cnn-tutorial\" >https:\/\/www.kaggle.com\/rafetcan\/convolutional-neural-network-cnn-tutorial<\/a>\n<\/p>","4d09c366":"<a id = \"2\" ><\/a>\n<h2 style = \"background-image:url('https:\/\/t1.pixers.pics\/img-1fb6f67c\/posterler-sari-meyveler-desen.jpg?H4sIAAAAAAAAA3VOW46DMAy8TpAAG0xi4AD97REQj9DNlkeUpLvVnn4TVf2s7JHtke0ZeBx-XDXM-gjawW6WZdOwmi1Ovnfamz8tpKxzzPrIbgIxduePdrM7rSgk5QkKOSHrf8d4uI_uLr5CsL4H8FRa84zfYpk9zLuHGisGZJCdopY6wkXxMtiteC0GM98LhU-JpT1uOabI3l4axLxJHoIzu4imzigXxLe9ZfBB8tVDvILLFagDblNKlajhcqWOW26lGpaVxknh1GhmqoiRkNdubLWeqqZe6zKq_ANn9tv0MQEAAA==');background-position: center;text-shadow: 12px 10px 4px #333;color:black;border:0;font-family:Palatino Linotype;font-weight:bold;font-size:25px;text-indent:10px\">Modeling <\/h2>","d254ea6c":"<a id = \"7\" ><\/a>\n<ul>\n    <li style = 'color:yellow;font-size:16px'> <p style = 'font-weight:bold'> \ud83c\udf4f Fit the model  <\/p> <\/li>\n<\/ul> ","253034c4":"<ul>\n    <li style = 'color:red'> <p style = 'font-weight:bold;color:black'> \ud83c\udf53 We make fruits more legible so that we can examine them better <\/p> <\/li>\n<\/ul>","01986150":"<ul>\n    <li style = 'color:gray'> <p style = 'font-weight:bold;color:black'> \ud83c\udf48  And before moving on to our model, let's take a look at how many different fruits we have. <\/p> <\/li>\n    <li style = 'color:orange'> <p style = 'font-weight:bold;color:black'> \ud83c\udf4a  this is also important to us, because this will be the output value of our model. <\/p> <\/li>\n<\/ul>","160d6104":"![fruits.PNG](attachment:6bf9e625-d126-4764-ac18-713f48b086af.PNG)\n\n<center><h1 style = \"background:#0C0C0C ;color:white;border:0;font-family:Bahnschrift SemiBold;font-weight:bold\">Introduction  <\/h1><\/center>\n<p style = \"color:black;font-family:Bahnschrift SemiBold;font-weight:bold;font-size:16px\"> Data consists of many fruits.Total number of images: 90483.Training set size: 67692 images (one fruit or vegetable per image).Test set size: 22688 images (one fruit or vegetable per image).Number of classes: 131 (fruits and vegetables).Image size: 100x100 pixels.Different varieties of the same fruit (apple for instance) are stored as belonging to different classes.<\/p>\n\n<p style = \"color:darkred;font-family:Bahnschrift SemiBold;font-weight:bold;font-size:16px\" > What are we going to do in this notebook? <\/p>\n\n<p style = \"color:black;font-family:Bahnschrift SemiBold;font-weight:bold;font-size:16px\">We will first examine the fruits. we will look at it as pictures and numbers of pictures. Next, we will create our CNN model.Then we will evaluate the results of the model we created and examine them on the graph. <\/p>\n\n<p style = \"color:darkred;font-family:Bahnschrift SemiBold;font-weight:bold;font-size:16px\" > So, let's get started. <\/p>\n    \n<h2 style = \"background:#0C0C0C ;color:white;border:0;font-family:Bahnschrift SemiBold;font-weight:bold\">Content :<\/h2>\n\n<ul>\n    <li style = \"color:gray;font-size:16px\"> <a href = \"#1\" style = \"color:black;font-family:Bahnschrift SemiBold;font-weight:bold\"> Load and Check Data <\/a> <\/li> \n         <li style = \"color:gray;font-size:16px\" ><a href = \"#2\" style = \"color:black;font-family:Bahnschrift SemiBold;font-weight:bold\"> Modeling <\/a>\n       <ul>\n            <li style = \"color:black;font-size:16px\" ><a href = \"#3\" style = \"color:darkred;font-family:Bahnschrift SemiBold;font-weight:bold\"> Create Model <\/a><\/li>      \n           <li style = \"color:black;font-size:16px\" ><a href = \"#4\" style = \"color:darkred;font-family:Bahnschrift SemiBold;font-weight:bold\"> Compile Model <\/a><\/li>\n           <li style = \"color:black;font-size:16px\" ><a href = \"#5\" style = \"color:darkred;font-family:Bahnschrift SemiBold;font-weight:bold\"> Epochs and Batch Size <\/a><\/li>\n           <li style = \"color:black;font-size:16px\" ><a href = \"#6\" style = \"color:darkred;font-family:Bahnschrift SemiBold;font-weight:bold\"> Data Augmentation <\/a><\/li>\n                      <li style = \"color:black;font-size:16px\" ><a href = \"#7\" style = \"color:darkred;font-family:Bahnschrift SemiBold;font-weight:bold\"> Fit the Model <\/a><\/li>\n                      <li style = \"color:black;font-size:16px\" ><a href = \"#8\" style = \"color:darkred;font-family:Bahnschrift SemiBold;font-weight:bold\"> Evaluate the model <\/a>\n           <ul>\n                                       <li style = \"color:grey;font-size:16px\" ><a href = \"#9\" style = \"color:#321414;font-family:Bahnschrift SemiBold;font-weight:bold\"> Loss Chart <\/a><\/li>\n                                       <li style = \"color:grey;font-size:16px\" ><a href = \"#10\" style = \"color:#321414;font-family:Bahnschrift SemiBold;font-weight:bold\"> Accuracy Chart <\/a><\/li>\n                    <\/ul>                      \n           <\/li>\n                                 <li style = \"color:black;font-size:16px\" ><a href = \"#11\" style = \"color:darkred;font-family:Bahnschrift SemiBold;font-weight:bold\"> CONCLUSION <\/a><\/li>\n       <\/ul>\n    <\/li>\n<\/ul>"}}