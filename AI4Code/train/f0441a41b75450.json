{"cell_type":{"e41b3b02":"code","72f04ce0":"code","b9f6bef2":"code","be6f1c18":"code","534967c1":"code","7b38b839":"code","232aa24e":"code","c8fce173":"code","14750225":"code","7aad1e7f":"code","2c86fd9e":"code","62d366bd":"code","3fe4fcb6":"code","9e79445e":"code","db9a8a62":"code","e966ce87":"code","d0b8748a":"code","5d6c7d58":"code","bd92b0b6":"code","98e9e6c6":"code","1a3ef65b":"code","6d1a15ed":"code","107eef03":"code","e65e7942":"code","c1723841":"code","9ec5c7bc":"code","f5095af5":"code","8ac56459":"code","9cb2909e":"code","c49a85dc":"code","8db9db73":"code","472bd705":"code","6759c1f2":"code","836da854":"code","1f53357f":"code","f36ce700":"code","89d7d753":"code","b500792f":"code","713ec952":"code","ffa06abc":"code","118ffd4a":"code","1cdaa6b3":"markdown","09b8e5ce":"markdown","40e77afc":"markdown","55ec8fcb":"markdown","3d58080a":"markdown","78da86be":"markdown","41dcdbde":"markdown","d947535a":"markdown","2870ec67":"markdown","634d8ba2":"markdown","f5ae202c":"markdown","e3354ac6":"markdown","be9fbb81":"markdown","a4ac3b57":"markdown","8cfe4afb":"markdown","1ed16f58":"markdown"},"source":{"e41b3b02":"import pandas as pd\nimport numpy as np","72f04ce0":"df = pd.read_csv(\"..\/input\/stock-market-dataset\/stocks\/AAPL.csv\")","b9f6bef2":"df.head()","be6f1c18":"df.shape","534967c1":"# Cash price as Close and the date can be selected to simplify the first trial\n# dc : date and close\ndc = df[[\"Date\",\"Close\"]]\n","7b38b839":"dc.shape","232aa24e":"dc_test = dc[len(dc)-300:]\ndc_train = dc[:-300]","c8fce173":"print(dc_test.shape)\nprint(dc_train.shape)","14750225":"import fbprophet\nfrom fbprophet import Prophet\nfrom fbprophet import forecaster","7aad1e7f":"print(fbprophet.__version__)","2c86fd9e":"import seaborn as sns\nimport  matplotlib.pyplot as plt\n%matplotlib inline","62d366bd":"sns.lineplot(x=dc_train.Date,y=dc_train.Close)","3fe4fcb6":"dc_train = dc_train.rename(columns={\"Date\":\"ds\",\"Close\":\"y\"})\ndc_test = dc_test.rename(columns={\"Date\":\"ds\",\"Close\":\"y\"})","9e79445e":"dc_train.info()","db9a8a62":"model = Prophet(daily_seasonality=True)","e966ce87":"model.fit(dc_train)","d0b8748a":"future = model.make_future_dataframe(periods=365, freq=\"D\")","5d6c7d58":"forecast = model.predict(future)","bd92b0b6":"from fbprophet.plot import plot_plotly","98e9e6c6":"plot_plotly(model, forecast)","1a3ef65b":"y_pred = forecast[\"yhat\"].values\ny_true = dc_train[\"y\"].values\nplt.plot(y_true, label='Actual')\nplt.plot(y_pred, label='Predicted')\nplt.legend()\nplt.show()","6d1a15ed":"test_fc = model.predict(dc_test)","107eef03":"plot_plotly(model, test_fc)","e65e7942":"df.info()","c1723841":"df.head()","9ec5c7bc":"apl = df[[\"Date\",\"Close\"]]","f5095af5":"apl.columns = [\"ds\",\"y\"]\napl.head()","8ac56459":"apl[\"ds\"] = pd.to_datetime(apl[\"ds\"])","9cb2909e":"apl.info()","c49a85dc":"apl.head()","8db9db73":"apl_10_15 = apl[(apl[\"ds\"]>= \"2010-01-01\") & (apl[\"ds\"] <= \"2016-01-01\")]","472bd705":"apl_10_15.tail()","6759c1f2":"apl_16_q1 = apl[(apl[\"ds\"] > \"2016-01-01\") & (apl[\"ds\"]<= \"2016-04-01\")]","836da854":"apl_16_q1.info()","1f53357f":"model_10_15 = Prophet()","f36ce700":"model_10_15.fit(apl_10_15)","89d7d753":"fc_16_q1 = model_10_15.predict(apl_16_q1)","b500792f":"plot_plotly(model_10_15, fc_16_q1)","713ec952":"fc_10_15 = model_10_15.predict(apl_10_15)\nplot_plotly(model_10_15, fc_10_15)","ffa06abc":"y_pred = fc_16_q1[\"yhat\"].values\ny_true = apl_16_q1[\"y\"].values\nplt.plot(y_true, label='Actual')\nplt.plot(y_pred, label='Predicted')\nplt.legend()\nplt.show()","118ffd4a":"from sklearn.metrics import mean_absolute_error\nprint(mean_absolute_error(y_pred, y_true))","1cdaa6b3":"We are going to use AAPL data only for this notebook and use only close values of the stock for prediction. This notebook is for coding practice not for predicting real market prices. ","09b8e5ce":"As you see above, our model predictied the prices will keep increasing trend through out 2016 Q1.","40e77afc":"Let's see the data, how close prices are changed from the very beginning.","55ec8fcb":"We can always check how our training model worked. It's almost perfect ofcourse :))","3d58080a":"You don't need to set this parameter to True in this case, but in order to grab your attention, Prophet classifier has different options, you can check it by simply pressing tab+shift.\n","78da86be":"This is a method to indicate day basis model fit. Do we need that? Later on, I will use simple date conversion. ","41dcdbde":"However, validation is not perfect. See above, price is varying between 95-105 for 62 days range. Model predicts 120-125 price range. This is due to overfitting on training data, which is increasing trend by time. ","d947535a":"Please check version, some functions may differ due to version upgrades.","2870ec67":"## More in deep","634d8ba2":"# Apple Stock Prediciton with Facebook Prophet - Beginner Level","f5ae202c":"Till now we just grab and throw data to model. In a simple logistic regression model it will result almost same. However, the hardest part of prediction is the peak to bottom shifts. From 1980 till 2020 price will increase for sure. How about the portion of this data?","e3354ac6":"So let's look the prices between 2010 to 2015. And finally based on this model, let's predict first quarter of the 2016.\n","be9fbb81":"As we examine the data we have seven variables and each of them meaningful for stock price prediction. However we are going to use date as ds and close as y variable for prophet api.","a4ac3b57":"We import very basic libraries for data manupulation and load data from the input folder.","8cfe4afb":"Just to take out some data for testing the model.","1ed16f58":"As I mentioned above, we change data -> ds and close -> y. And after prediction, based on history values we can check yhat, which is named as a default."}}