{"cell_type":{"80efcfe5":"code","54d3a5cc":"code","00511703":"code","b566aeb2":"code","c8540e00":"code","9a51f213":"code","ba75bcfa":"code","c4a92905":"code","b717d615":"code","35429694":"code","b7a2020d":"markdown","d162bd45":"markdown","6d6efbf4":"markdown","93026078":"markdown","d0bc0370":"markdown","4a611456":"markdown","4f76ba8d":"markdown","8ad4322a":"markdown","ad79885f":"markdown","958b3e77":"markdown","32327260":"markdown","43723e92":"markdown","95bed509":"markdown","37c2d419":"markdown","42fc0100":"markdown","652c40dc":"markdown"},"source":{"80efcfe5":"import pandas as pd\nimport numpy as np\n\ndf = pd.read_csv('\/kaggle\/input\/titanic\/train.csv',header=0)\ncolname = ['PassengerId','Pclass','Name','Sex','Age','SibSp','Parch','Ticket','Fare','Cabin','Embarked','Survived']\ndf = df[colname]\ndf.head()","54d3a5cc":"print(len(df))\ndf = df[df['Embarked'].notnull()]\nprint(len(df))","00511703":"#Initialize ChiSquare Class\ncolX = 'Embarked' # Variable to test\ncolY = 'Survived' # Prediction class\n\nX = df[colX].astype(str)\nY = df[colY].astype(str)","b566aeb2":"dfObserved = pd.crosstab(Y,X)\ndfObserved","c8540e00":"import scipy.stats as stats\nfrom scipy.stats import chi2_contingency\nfrom decimal import Decimal\nchi2, p, dof, expected = stats.chi2_contingency(dfObserved.values)","9a51f213":"dfExpected = pd.DataFrame(expected, columns=dfObserved.columns, index=dfObserved.index)\ndfExpected","ba75bcfa":"print(\"Chi2 value: \" + str(chi2))\nprint(\"p value: \" + str(Decimal(p))[:13])\nprint(\"Degree of freedom value: \" + str(dof))","c4a92905":"alpha=0.05 #Choose 95% confidence level\n\nif p<alpha:\n    result=\"{0} is IMPORTANT for Prediction\".format(colX)\nelse:\n    result=\"{0} is NOT an important predictor. (Discard {0} from model)\".format(colX)\nprint(result)","b717d615":"class ChiSquare:\n    def __init__(self, dataframe):\n        self.df = dataframe\n        self.p = None #P-Value\n        self.chi2 = None #Chi Test Statistic\n        self.dof = None\n        \n        self.dfObserved = None\n        self.dfExpected = None\n        \n    def _print_chisquare_result(self, colX, alpha):\n        result = \"\"\n        if self.p<alpha:\n            result=\"{0} is IMPORTANT for Prediction\".format(colX)\n        else:\n            result=\"{0} is NOT an important predictor. (Discard {0} from model)\".format(colX)\n\n        print(result)\n        \n    def TestIndependence(self,colX,colY,alpha=0.05):\n        X = self.df[colX].astype(str)\n        Y = self.df[colY].astype(str)\n        \n        self.dfObserved = pd.crosstab(Y,X) \n        chi2, p, dof, expected = stats.chi2_contingency(self.dfObserved.values)\n        self.p = p\n        self.chi2 = chi2\n        self.dof = dof \n        \n        self.dfExpected = pd.DataFrame(expected, columns=self.dfObserved.columns, index = self.dfObserved.index)\n        \n        self._print_chisquare_result(colX,alpha)","35429694":"cT = ChiSquare(df)\n#Feature Selection\ntestColumns = ['Embarked','Cabin','Pclass','Age','Name']\nfor var in testColumns:\n    cT.TestIndependence(colX=var,colY='Survived')","b7a2020d":"* To start testing with Chi-square, we need to summarize the data by the category. This data is called contingency table","d162bd45":"### Chi-squared Test - A Statistical Test","6d6efbf4":"After all descriptive analysis step such as summarization, visualizing, etc, then we are closer to enter the modeling part. Before getting to modeling, a feature selection is needed \n\n#### Feature selection is one of machine learning problem that requires us to pick most relevant variable to the prediction label. This can be done by knowing which variable is dependent or independent with the problem\/prediction label\n\n* A Statistical test is done to determine the dependency of 2 variables\n* If a variable is independent with the prediction label, it may be irrelevant to the problem and we can remove from the dataset\n* For categorical variable, we can use Chi-squared test\n\n#### Chi square rules:\n* Variables are categorical\n* Frequency is at least 5\n* Variable are sampled independently","93026078":"* Null Hypothesis (H0): There is no association between Embark and Survive variables\n* Alternate Hypothesis (Ha): There is an association between Embark and Survive variables","d0bc0370":"<img src=\"https:\/\/i.ibb.co\/TtXWY9d\/Chisquare.png\" width=450 height=100><\/img>\n<img src=\"https:\/\/i.ibb.co\/xY69G4G\/dof.png\" width=450 height=100><\/img>\n<img src=\"https:\/\/i.ibb.co\/3TxD4Qs\/criticalvalue.png\" width=800 height=100><\/img>","4a611456":"Story: Titanic tragdey! Can we predict who is survived or not from Titanic tragedy? But first thing first, feature selection is needed. You can download the data from this site: https:\/\/www.kaggle.com\/c\/titanic\/data","4f76ba8d":"### Goals:\n1. Understand the chi-square test of independence\n2. Implement chi-square test in python\n3. Utilize chi-square test for feature selection","8ad4322a":"If test value > table value ===> Reject H0","ad79885f":"* https:\/\/machinelearningmastery.com\/chi-squared-test-for-machine-learning\/\n* http:\/\/www.insightsbot.com\/blog\/2AeuRL\/chi-square-feature-selection-in-python","958b3e77":"Chi-square table: https:\/\/people.smp.uq.edu.au\/YoniNazarathy\/stat_models_B_course_spring_07\/distributions\/chisqtab.pdf","32327260":"* Pclass: Passanger Class\n* Ticket: Tiket Type\n* Fare: Ticket Amount\n* Cabin: Cabin Number\n* Embarked: Port of Embarkation (C=Cherbourg, Q=Queenstown, S=Southampton)","43723e92":"* If p-value <= alpha (0.05): significant result, reject null hypothesis (H0), dependent.\n* If p-value > alpha (0.05): not significant result, fail to reject null hypothesis (H0), independent.","95bed509":"### Examples: Titanic Tragedy: Who is survived?","37c2d419":"* Chi2 value: Calculated based on observed and expected value\n* p Value: A value to determine dependency\n* Degree of Freedom: N-1 (N: Class)","42fc0100":"#### How to interpret?","652c40dc":"<img src=\"https:\/\/i.ibb.co\/rF5dGqy\/titanic.jpg\" width=450 height=100><\/img>"}}