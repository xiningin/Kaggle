{"cell_type":{"d60bfa00":"code","891f12f6":"code","3aaf16f8":"code","640d1c11":"code","b5930cb4":"code","e2e19cf3":"code","19f83658":"code","5b5c8d90":"code","4f37727a":"code","44dd995b":"code","edfcb52a":"code","622e0b74":"code","ab4d0c34":"code","5ea87310":"markdown"},"source":{"d60bfa00":"import numpy as np\nimport pandas as pd\nfrom matplotlib import pyplot as plt\nfrom sklearn.preprocessing import MinMaxScaler","891f12f6":"df = pd.read_csv('\/kaggle\/input\/nifty50-stock-market-data\/SBIN.csv')\ndf.describe()","3aaf16f8":"df.head()","640d1c11":"v = [0.001702175661619257, 0.011111923859485277]\nplt.bar([\"LR\", \"kNN\"], v)\nplt.show()","b5930cb4":"df['Date'] = pd.to_datetime(df.Date,format='%Y-%m-%d')\ndf.set_index(\"Date\", drop=False, inplace=True)\ndf.drop([\"Series\",\"Symbol\",\"Trades\",\"Deliverable Volume\",\"%Deliverble\"], axis=1, inplace=True)\ndf","e2e19cf3":"dates = df['Date']\ndf.drop(['Date'], axis=1, inplace=True)\nscaler = MinMaxScaler(feature_range=(0, 1))\ndata = scaler.fit_transform(df)\ndata = pd.DataFrame(data, index=df.index, columns=df.columns)\ndata['Date'] = dates\ndata","19f83658":"X = data\ncut = int(len(X)*0.8)\n\nX_train = X[:cut]\nX_test = X[cut:]\nX_train[['Date', 'Close']]","5b5c8d90":"from fbprophet import Prophet","4f37727a":"model = Prophet()\nmodel.fit(X_train[[\"Date\", \"Close\"]].rename(columns={\"Date\": \"ds\", \"Close\": \"y\"}))","44dd995b":"forecast = model.predict(X_test[[\"Date\", \"Close\"]].rename(columns={\"Date\": \"ds\"}))\nforecast","edfcb52a":"forecast.yhat","622e0b74":"plt.figure(figsize=(20, 5))\nplt.plot(X['Close'])\nplt.plot(X_test.index, forecast.yhat)\nplt.show()","ab4d0c34":"np.sqrt(np.mean(np.power((np.array(X_test['Close'])-np.array(forecast.yhat)),2)))","5ea87310":"# Prophet"}}