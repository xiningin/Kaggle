{"cell_type":{"e75ddb7f":"code","7a9955fb":"code","cf5d5eda":"code","8320df41":"code","b70c383f":"code","9da348d7":"code","febd1c31":"code","271feb19":"code","85bc13e2":"code","2ee83c62":"code","6c581378":"code","dade9060":"code","d52a46e5":"code","fe321e77":"code","afce2ed1":"code","0c0938fb":"code","e35701e2":"code","0354a897":"code","787a689e":"code","edba71ae":"code","98c39a71":"code","68829482":"code","50cf8eae":"code","5e528acf":"markdown","c47890a8":"markdown","e03ac8e4":"markdown","87090be5":"markdown","27dc85c6":"markdown","82c7ab33":"markdown","af801a63":"markdown","af0dbff3":"markdown","1ba38653":"markdown","cbbb24b6":"markdown","4c39ea87":"markdown"},"source":{"e75ddb7f":"!pip install pycaret","7a9955fb":"import pandas as pd\nimport numpy as np\nfrom pycaret.regression import *\nimport category_encoders as ce\nfrom sklearn.discriminant_analysis import QuadraticDiscriminantAnalysis\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import r2_score,mean_squared_log_error,mean_absolute_error,mean_squared_error\nfrom pandas_profiling import ProfileReport\nimport pickle\nfrom sklearn.ensemble import ExtraTreesRegressor","cf5d5eda":"df = pd.read_csv(\"..\/input\/bmi-data\/bmi_data.csv\")","8320df41":"df","b70c383f":"df.isnull().sum()","9da348d7":"for i in df:\n    print(df[i].value_counts())","febd1c31":"df = df.dropna()\ndf.reset_index(inplace=True,drop=True)","271feb19":"ProfileReport(df)","85bc13e2":"def ordinal_encoding(df,col,mapping):\n    ordinal_encoder = ce.OrdinalEncoder(cols = [col],return_df = True,mapping = [{'col':col,'mapping':mapping}])\n    df_final = ordinal_encoder.fit_transform(df)\n    return df_final\nmapping = {\"Male\":0,\"Female\":1}\ndf_final = ordinal_encoding(df,\"Sex\",mapping)\ndf_final","2ee83c62":"df_final[\"BMI\"].describe()","6c581378":"df_final[\"Height(Inches)\"] = df_final[\"Height(Inches)\"].apply(lambda hei:hei*2.54)\ndf_final[\"Weight(Pounds)\"] = df_final[\"Weight(Pounds)\"].apply(lambda wei:wei\/2.205)","dade9060":"df_final.rename(columns = {\"Height(Inches)\":\"Height\",\"Weight(Pounds)\":\"Weight\"},inplace = True)","d52a46e5":"df_final","fe321e77":"experiment = setup(df_final,target=\"BMI\")","afce2ed1":"compare_models()","0c0938fb":"X = df_final.drop(\"BMI\",axis = 1)\nY = df_final[\"BMI\"]","e35701e2":"X_train,X_test,Y_train,Y_test = train_test_split(X,Y,random_state=27,test_size = 0.2)","0354a897":"reg = ExtraTreesRegressor()\nreg.fit(X_train,Y_train)\n","787a689e":"Y_pred = reg.predict(X_test)\nY_pred","edba71ae":"r2_score(Y_pred,Y_test)","98c39a71":"print(mean_squared_error(Y_pred,Y_test))","68829482":"print(mean_squared_log_error(Y_pred,Y_test))","50cf8eae":"pickle.dump(reg,open(\"model_bmi.pkl\",\"wb\"))","5e528acf":"# Evaluation Metrics","c47890a8":"<center>\n<h1 class=\"list-group-item list-group-item-success\" style=\"color:rgb(0,0,150)\">\nPREDICTION OF BODY MASS INDEX\n<\/h1>\n\n<img\nsrc=\"https:\/\/us.123rf.com\/450wm\/anatolymas\/anatolymas1707\/anatolymas170700002\/81594462-3d-small-person-reaches-for-help-button-3d-image-white-background-.jpg?ver=6\"\nstyle=\"width: 30%\"\n\/>\n<\/center>\n<h3 style=\"font-weight: bold\">Context<\/h3>\n<p>\nBody mass index is a value derived from the mass and height of a person. The BMI is defined as the body mass divided by the square of the body height, and is expressed in units of kg\/m\u00b2, resulting from mass in kilograms and height in metres.\n<\/p>\n\n<h3 style=\"font-weight: bold\">Content<\/h3>\n\n<p>\nThe dataset contains information about gender, height, weight and BMI index of\nindividuals\n<\/p>\n<p><\/p>\n\n<p><span style=\"font-weight: bold\">Gender :<\/span> Male \/ Female<\/p>\n<p><span style=\"font-weight: bold\">Height :<\/span> Age (cm)<\/p>\n<p><span style=\"font-weight: bold\">Height :<\/span> Number (cm)<\/p>\n<p><span style=\"font-weight: bold\">Weight :<\/span> Number (Kg)<\/p>\n<p><span style=\"font-weight: bold\">Index :<\/span><\/p>\n<ul type=\"square\">\n<li>less than 18.5 - Under Weight<\/li>\n<li>18.5 to 24.9 - Normal<\/li>\n<li>25.0 to 29.9 - Overweight<\/li>\n<li>30.0 to 34.9 - Obese<\/li>\n<li>more than 35.0 - Extremely Obese<\/li>\n<\/ul>\n\n<h3 style=\"font-weight: bold\">Contents:<\/h3>\n<ul type=\"square\" style=\"color:blue\">\n<li>Importing Packages<\/li>\n<li>Importing Data<\/li>\n<li>Analysing Data<\/li>\n<li>Data Overview<\/li>\n<li>Ordinal encoding<\/li>\n<li>Model Comparsion<\/li>\n<li>Data Transformation<\/li>\n<li>Predicting the BMI Index<\/li>\n<li>Evaluation Metrics<\/li>\n<\/ul>","e03ac8e4":"# Model Comparsion","87090be5":"# Analysing Data","27dc85c6":"# Predicting the BMI Index","82c7ab33":"# Data Overview","af801a63":"# Importing Data","af0dbff3":"# Data Transformation","1ba38653":"# Ordinal encoding","cbbb24b6":"<center><img src=\"https:\/\/encrypted-tbn0.gstatic.com\/images?q=tbn:ANd9GcRWDgteV-sNXVRkc0xwyodmJt18ImebZ1UcKA&amp;usqp=CAU\"><\/center>","4c39ea87":"# Importing Packages"}}