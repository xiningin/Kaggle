{"cell_type":{"26f165b3":"code","8b059b79":"code","dbcb1a59":"code","e1939c80":"code","69bdedad":"code","b9898527":"code","d2ffbfe3":"code","a66153aa":"code","d011b561":"code","f01c2372":"code","e60f4f00":"code","0e892b19":"code","df7757d6":"code","ae53283f":"code","d66e40f9":"code","abcf2651":"code","7fd9188a":"code","9cc4e51d":"code","036e193e":"code","88cc7d55":"code","1cea4482":"code","63077f34":"code","29ead0ed":"code","29cc0113":"code","4ce7c17e":"code","a4677313":"code","0d3f95d8":"code","937b59a0":"code","8fabb07d":"code","9e6a31b7":"code","ce432866":"code","3a56e009":"code","4ec3eee0":"code","18120151":"code","6fca0ea4":"code","81502409":"code","6200e226":"code","8e892268":"markdown","597d2d41":"markdown","7c6db7d8":"markdown","f1513e7c":"markdown","f4b27917":"markdown","5afa8ca0":"markdown","96d41362":"markdown","2b84e6f8":"markdown","3f7bbbb8":"markdown","eefe664a":"markdown","a590dfb1":"markdown","02a90271":"markdown","6a66171e":"markdown","663804fb":"markdown","e93abfdc":"markdown","4e0c01a8":"markdown","d2d263b8":"markdown","f485556b":"markdown","8a6ef29e":"markdown","9726b62a":"markdown","b7d329b2":"markdown","6891256a":"markdown","afa20b26":"markdown","9b95056e":"markdown","62861948":"markdown","da50e634":"markdown","a61885d7":"markdown","ecc1c333":"markdown","f6388bc6":"markdown","1ba00336":"markdown","bae93a7e":"markdown","ea4eeb50":"markdown","d478f7f4":"markdown","0ef28a4b":"markdown","5c5ba588":"markdown"},"source":{"26f165b3":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nimport cv2\nimport matplotlib.pyplot as plt\n\n#To retrieve image from numpy array\nfrom PIL import Image \nfrom matplotlib import cm\n\n%matplotlib inline","8b059b79":"DATASET_PATH = \"\/kaggle\/input\/fashion-product-images-dataset\/fashion-dataset\/fashion-dataset\/\"\nprint(os.listdir(DATASET_PATH))","dbcb1a59":"# what is inside the main directory\nlist_directory = os.listdir(DATASET_PATH)\nprint(list_directory)\n\n# each time directory files gets reordered. That's why needed to find where images folder is.\nindex=0\nfor i in range (len(list_directory)):\n    if list_directory[i]==\"images\":\n        index=i\n        break\n\n# what is in the image directory\nimageIndex = os.listdir(DATASET_PATH+list_directory[index])\n# print(type(imageIndex))\nhead = 10\n\n# collecting some samples in list\nsampleImages = []\n\n# showing indices\nfor i in range (head):\n    sampleImages.append(imageIndex[i])\n    print(sampleImages[i])\n\n# choosing some samples to observe\nfig=plt.figure()\nfig.set_figheight(15)\nfig.set_figwidth(15)\naxis=[]\nrow = len(sampleImages)\/2\ncol = row+1\n\nfor i in range (0,len(sampleImages)):\n    Image_path=DATASET_PATH+list_directory[index]+\"\/\"+sampleImages[i]\n    src = cv2.imread(Image_path)\n    image = cv2.cvtColor(src, cv2.COLOR_BGR2RGB) \n    axis.append(fig.add_subplot(row, col, i+1))\n    subplot_title=sampleImages[i]\n    axis[-1].set_title(subplot_title)  \n    plt.imshow(image)\n\nfig.tight_layout()\nplt.show()","e1939c80":"df = pd.read_csv(DATASET_PATH + \"styles.csv\", nrows=10000, error_bad_lines=False)\ndf.head(10)","69bdedad":"df['image'] = df.apply(lambda row: str(row['id']) + \".jpg\", axis=1)\ndf.head(10)","b9898527":"augmentedDataframe = pd.DataFrame({\n    'filename': df['image'],\n    'type': df['articleType']\n})\n\n# total number of entries in the dataframe\ntotal_row = len(augmentedDataframe)\nprint('total row count: ', total_row)\n\naugmentedDataframe.head(10)","d2ffbfe3":"augmentedDataframe['type'].value_counts()","a66153aa":"plt.figure(figsize=(20,5))\naugmentedDataframe['type'].value_counts().plot(kind='bar',x='type',y='filename')\nplt.show()","d011b561":"def getData(start,stop):\n    x_data = []\n    y_data = []\n    #start = 0 #setting start parameter\n    #stop = int(0.001*total_row) #setting stop parameter \n    \n    for i in range(start, stop): \n        Image_path=DATASET_PATH+list_directory[index]+\"\/\"+augmentedDataframe.loc[i,'filename']\n#         print(augmentedDataframe.loc[i,'filename'])\n        image = cv2.imread(Image_path,cv2.IMREAD_GRAYSCALE)\n        try:\n            resized_img = cv2.resize(image, dsize=(28, 28))\n        except:\n            print(\"Rejected Image: \"+augmentedDataframe.loc[i,'filename'])\n            continue\n        resized_img = cv2.resize(image, dsize=(80, 80))\n        x_data.append(resized_img) \n        y_values = augmentedDataframe.loc[i,'type']\n        y_data.append(y_values)\n                \n    return x_data, y_data","f01c2372":"def getImage(it):\n    list_directory = os.listdir(DATASET_PATH)\n    index=0\n    for i in range (len(list_directory)):\n        if list_directory[i]==\"images\":\n            index=i\n            break\n    Image_path=DATASET_PATH+list_directory[index]+\"\/\"+augmentedDataframe.loc[it,'filename']\n    image = cv2.imread(Image_path,cv2.IMREAD_GRAYSCALE)\n    resized_img = cv2.resize(image, dsize=(80, 80))\n#     plt.imshow(resized_img)\n    return resized_img","e60f4f00":"X=[]\nY=[]\n# for now start=0,stop=(0.001*total_row)\n# total_row=count of rows in augmented data frame\nstart = 0\nstop = int(0.001*total_row) # testing with 0.1% image of the dataset\nX,Y=getData(start,stop)","0e892b19":"print(type(X))\nprint(X[0])\nplt.title(Y[0])\nplt.imshow(X[0])","df7757d6":"X = np.array(X).reshape(-1, 80,80,1)\nY = np.array(Y)","ae53283f":"X = X\/255.0","d66e40f9":"Y = Y.reshape(len(X), 1)","abcf2651":"print(type(X))\nprint(X.shape)\nprint(Y.shape)\nprint(X[0])\nprint(Y[0])","7fd9188a":"X_train=[]\nY_train=[]\nstart = 0\nstop = int(0.8*total_row)\nX_train,Y_train=getData(start,stop)\n\n# conversion into numpy array\nX_train = np.array(X_train).reshape(-1, 80,80,1)\nY_train = np.array(Y_train)\n\n# normalizing\nX_train = X_train\/255\n\n# processing Y_train for dimension matching\nY_train = Y_train.reshape(len(X_train),1)","9cc4e51d":"print('Train Image Data Shape: ',X_train.shape)\nprint('Train Label Data Shape: ',Y_train.shape)\nprint('Dimension of Train Data: ',X_train.ndim)","036e193e":"X_test=[]\nY_test=[]\nstart = int(0.8*total_row)\nstop = total_row \nX_test,Y_test=getData(start,stop)\n\n# conversion into numpy array\nX_test = np.array(X_test).reshape(-1, 80,80,1)\nY_test = np.array(Y_test)\n\n# normalizing\nX_test = X_test\/255\n\n# processing Y_train for dimension matching\nY_test = Y_test.reshape(len(X_test),1)","88cc7d55":"print('Test Image Data Shape: ',X_test.shape)\nprint('Test Label Data Shape: ',Y_test.shape)","1cea4482":"number_of_train_samples=X_train.shape[0]\nnumber_of_test_samples=X_test.shape[0]\nnx=80\nny=80\n# print(number_of_train_samples)\nX_train_reshaped = X_train.reshape((number_of_train_samples,nx*ny))\nprint(X_train_reshaped.shape)\nX_test_reshaped = X_test.reshape((number_of_test_samples,nx*ny))\nprint(X_test_reshaped.shape)","63077f34":"from sklearn.tree import DecisionTreeClassifier ","29ead0ed":"dtree_model = DecisionTreeClassifier(max_depth = 8).fit(X_train_reshaped, Y_train) ","29cc0113":"accuracy = dtree_model.score(X_test_reshaped, Y_test)\nprint(accuracy)","4ce7c17e":"dtree_predictions = dtree_model.predict(X_test_reshaped)\nprint(type(dtree_predictions))\nprint(dtree_predictions.shape)\nprint(X_test_reshaped.shape)\nprint(X_test_reshaped[0])","a4677313":"nsample=0 # index of test sample\nindex=number_of_train_samples+nsample # index of the row of dataframe the image we want to show\n#print(index)\nimage = getImage(index)\n# plt.title()\nplt.title(f\"PC = {dtree_predictions[nsample]}\\n TC = {Y_test[nsample]}\")\nplt.imshow(image)","0d3f95d8":"#PC=PredictedClass #TC=TrueClass\nL = 5\nW = 5\nfig, axes = plt.subplots(L, W, figsize = (12,12))\naxes = axes.ravel()\n\nfor i in np.arange(0, L * W): \n    src = X_test[i].reshape(80,80)\n    im = Image.fromarray(np.uint8(cm.gist_earth(src)*255))\n    axes[i].imshow(im)\n    axes[i].set_title(f\"PC = {dtree_predictions[i]}\\n TC = {Y_test[i]}\") #predicted_classes[i]:0.1f #Y_test[i]:0.1f\n    axes[i].axis('off')\nplt.subplots_adjust(wspace=0.6)","937b59a0":"from sklearn.svm import SVC","8fabb07d":"print(Y_train.shape)\nflat_Y_train=np.ravel(Y_train)","9e6a31b7":"print(flat_Y_train)\nprint(flat_Y_train.shape)","ce432866":"svm_model_linear = SVC(kernel = 'linear', C = 1).fit(X_train_reshaped, flat_Y_train)","3a56e009":"svm_predictions = svm_model_linear.predict(X_test_reshaped)","4ec3eee0":"accuracy = svm_model_linear.score(X_test_reshaped, Y_test) \nprint(accuracy)","18120151":"nsample=0 # index of test sample\nindex=number_of_train_samples+nsample # index of the row of dataframe the image we want to show\n#print(index)\nimage = getImage(index)\nplt.title(f\"PC = {svm_predictions[nsample]}\\n TC = {Y_test[nsample]}\")\nplt.imshow(image)","6fca0ea4":"#PC=PredictedClass #TC=TrueClass\nL = 5\nW = 5\nfig, axes = plt.subplots(L, W, figsize = (12,12))\naxes = axes.ravel()\n\nfor i in np.arange(0, L * W):  \n    src = X_test[i].reshape(80,80)\n    im = Image.fromarray(np.uint8(cm.gist_earth(src)*255))\n    axes[i].imshow(im)\n    axes[i].set_title(f\"PC = {svm_predictions[i]}\\n TC = {Y_test[i]}\") #predicted_classes[i]:0.1f #Y_test[i]:0.1f\n    axes[i].axis('off')\nplt.subplots_adjust(wspace=0.6)","81502409":"nsample=511 # index of test sample\nindex=number_of_train_samples+nsample # index of the row of dataframe the image we want to show\n#print(index)\nimage = getImage(index)\n\nplt.imshow(image)","6200e226":"nx=80\nny=80\nsingle_reshaped = image.reshape((1,nx*ny))\nsingle_reshaped = single_reshaped\/255\nprint(single_reshaped)\nprint(single_reshaped.shape)\n\nsvm_predictions = svm_model_linear.predict(single_reshaped)\nprint(type(svm_predictions))\nprint(svm_predictions[0])","8e892268":"# Showing Directories with List","597d2d41":"# Change into numpy array","7c6db7d8":"# What is inside the image directory\n## Observing some sample image","f1513e7c":"# Image id matches with styles.csv file Id column. \n## For ease of access, adding another column naming 'id.jpg'","f4b27917":"# Starting with train and test data\n## Inserting Image and Labels in numpy array","5afa8ca0":"# Here total counting length is 108. Total number of type classes available 108.","96d41362":"# Building another dataframe with columns- image and article type","2b84e6f8":"# Utility function to extract image from dataframe according to index","3f7bbbb8":"> # Problem2->How to convert image from numpy array\n> ## solve-getting image from index of dataframe","eefe664a":"# Processing labels for dimension matching","a590dfb1":"> # Model accuracy","02a90271":"> # As the function takes only 2-Dimensional matrix.","6a66171e":"> # Creating model->Support Vector Machine","663804fb":"# Starting with decision tree classifier algorithom","e93abfdc":"# Successful insertion of images in the array. Also we got the labels required.","4e0c01a8":"# Normalizing by 255","d2d263b8":"> # Showing image and label from predicted data set","f485556b":"> # Showing image and label from predicted test_set","8a6ef29e":"# Importing the Libraries","9726b62a":"# Utility Function to get images and inserted into image array\n## Start and Stop parameters will be useful train and test separation\n\n## Here all X=image_data, Y=label_data","b7d329b2":"> ## Splitting done with train and test set.","6891256a":"# Starting with decision tree and support vector machine","afa20b26":"# Problem1->We have no labeled data. Exploring styles.csv for more info. ","9b95056e":"# Testing with support vector machine","62861948":"> # Creating model->Decision Tree","da50e634":"## Spliting 80% image for training","a61885d7":"> # Prediction of test data","ecc1c333":"> # Accuracy of the model","f6388bc6":"# Sample printing","1ba00336":"## Rest 20% image for testing","bae93a7e":"# Test of the function","ea4eeb50":"> # Each model we will train later works with only array size of 2D in shape. Prerocessing is required. According to the documentation of sklearn library.","d478f7f4":"> # Done with decision tree model","0ef28a4b":"# Now we got our Function working. Next will be Spliting both train and test data.","5c5ba588":"# Single Image Prediction"}}