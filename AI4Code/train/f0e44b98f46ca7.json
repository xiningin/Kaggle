{"cell_type":{"92ff6a96":"code","27dcf2ae":"code","93d155f8":"code","ff157858":"code","4ce7e76f":"code","ee722efa":"code","a43fb3aa":"code","b7fcc8a9":"code","aeea8995":"code","5539943a":"code","06652de4":"code","d2842953":"code","aa96eefc":"code","084c641f":"code","eed5cd85":"code","8936c292":"code","ce7efce7":"code","b3efac5b":"code","297b62a8":"code","d1c83563":"markdown","2f129fb4":"markdown","fbaa7b2d":"markdown","9f51b23a":"markdown","ccaad838":"markdown","cbaa3bc1":"markdown","be65aa82":"markdown","a906de54":"markdown","e8efbf2f":"markdown","dd1cc1e1":"markdown","8b925f71":"markdown","2a747913":"markdown","1b67bef6":"markdown","cab0df4f":"markdown","46c8f5b2":"markdown","3c6117cf":"markdown","82d76a90":"markdown","97bbb112":"markdown","7eb4a548":"markdown","8e7717db":"markdown","64724cc4":"markdown","aada9a98":"markdown","ace9d73c":"markdown","1e9ba1b9":"markdown","23548d76":"markdown","986eb4a6":"markdown"},"source":{"92ff6a96":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport statsmodels.formula.api as smf\nimport statsmodels.stats.multicomp as multi\nimport missingno as msno\n\nimport matplotlib as mpl\n%matplotlib inline\n\nimport warnings\nwarnings.filterwarnings(action=\"ignore\", category=DeprecationWarning)\nwarnings.simplefilter(action='ignore', category=FutureWarning)\n\n# Customize Matplotlib\nmpl.rcParams['font.size'] = 14\nmpl.rcParams[\"figure.figsize\"] = (10,8)","27dcf2ae":"df = pd.read_csv('..\/input\/winemag-data_first150k.csv',index_col=0)","93d155f8":"df.head()","ff157858":"msno.bar(df)","4ce7e76f":"sns.countplot(y=\"country\", data=df, order=df.country.value_counts().iloc[:10].index)\nplt.show()","ee722efa":"sns.countplot(y=\"variety\", data=df, order=df.variety.value_counts().iloc[:10].index)\nplt.show()","a43fb3aa":"groupby_variety = df.groupby([\"country\", \"variety\"])[\"variety\"].count()\n\ntop_variety = groupby_variety.groupby(level=0, group_keys=False)\ntop3_variety = top_variety.nlargest(3)\n\ndf_top3_variety = top3_variety.loc[[\"US\", \"Italy\", \"France\", \"Spain\",\"Chile\"],:].to_frame()\n\ndf_top3_variety.columns = [\"Frequency\"]\ndf_top3_variety.index.names = ['Countries','Variety']\ndf_top3_variety.reset_index(inplace=True)\n\nsns.catplot(x=\"Countries\", y=\"Frequency\", hue=\"Variety\", data=df_top3_variety,\n                height=7, kind=\"bar\", palette=\"muted\")","b7fcc8a9":"percentage_NaN_price = round(df.price.isnull().sum() \/ df.shape[0], 2)\nprint(\"Percentage of NaN Price: {}\".format(percentage_NaN_price))\n\ndf.price.fillna(0, inplace=True)\n\nax = sns.distplot(np.log10(df.price + 1))\nplt.title(\"Price Log distribution\")\nplt.show()","aeea8995":"df.points.describe()","5539943a":"ax = sns.distplot(df.points)\nplt.show()","06652de4":"points_percentage = df.points.value_counts(normalize=True) * 100\ngreat_wines_percentage = round(points_percentage.loc[95:100].sum(), 2)\nprint(\"Proportion of great Wines>= 95: {}\".format(great_wines_percentage))","d2842953":"ax = sns.boxplot(x=\"points\", y=\"price\", data=df)\nplt.title(\"Wine Reviews vs Price\")\nplt.show()\n\nsubset_ratings_step5 = df.loc[df.points.isin([80, 85, 90, 95, 100]), [\"price\",\"points\"]]\nax = sns.boxplot(x=\"points\", y=\"price\", data=subset_ratings_step5)\nplt.ylim([0,1000])\nplt.show()\n\nsubset_ratings_step2 = df.loc[df.points.isin([80, 82, 84, 86, 88, 90]), [\"price\",\"points\"]]\nax = sns.boxplot(x=\"points\", y=\"price\", data=subset_ratings_step2)\nplt.ylim([0,200])\nplt.show()","aa96eefc":"#ANOVA\nmodel = smf.ols(formula='points ~ price', data=df)\nresults = model.fit()\nprint(\"The ANOVA Test find a significant difference between these 2 variables. \\n\"\n      \"F-statistic: {} F-pvalue: {}\".format(results.fvalue, results.f_pvalue))","084c641f":"median_top20_variety = df.loc[:, [\"variety\", \"price\"]] \\\n         .groupby(\"variety\") \\\n         .median() \\\n         .sort_values(by=\"price\", ascending= False)  \\\n         .index[:20] \\\n         .values\nplt.figure(figsize=(10,8))\nax = sns.boxplot(x=\"price\", y=\"variety\",\n                 data=df.loc[df[\"variety\"].isin(median_top20_variety),:],\n                 order=median_top20_variety\n                )\nax = sns.swarmplot(x=\"price\", y=\"variety\", \n                   data=df.loc[df[\"variety\"].isin(median_top20_variety),:],\n                   color=\".25\")\nplt.title(\"Price Distribution by Variety\")\nplt.xlim([0,800])\nplt.show()","eed5cd85":"top20_wineries = df.winery.value_counts(normalize=True).nlargest(20) \\\n.sort_values(ascending= False).index\n\nplt.figure(figsize=(12,8))\nsns.countplot(y=\"winery\", data=df[df.winery.isin(top20_wineries)],\n              order=top20_wineries, hue=\"country\")\nplt.show()","8936c292":"french_df = df.loc[df[\"country\"] == \"France\",:]\nfrench_df.shape","ce7efce7":"median_price_variety_fr = french_df.loc[:, [\"variety\", \"price\"]] \\\n         .groupby(\"variety\") \\\n         .median() \\\n         .sort_values(by=\"price\", ascending= False)      \nmedian_price_top10_variety_fr = median_price_variety_fr.index[:10]\n\nplt.figure(figsize=(10,8))\nax = sns.boxplot(x=\"price\", y=\"variety\",\n                 data=french_df.loc[french_df[\"variety\"].isin(median_price_top10_variety_fr),:],\n                 order=median_price_top10_variety_fr\n                )\nplt.title(\"Price Distribution by Variety\")\nplt.xlim([0,800])\nplt.show()","b3efac5b":"top10_variety_fr = french_df.variety.value_counts(normalize=True).nlargest(10) \\\n.sort_values(ascending= False).index\nmedian_ratings_top10_variety_fr = french_df.loc[french_df[\"variety\"]\n         .isin(top10_variety_fr), [\"variety\", \"points\"]] \\\n         .groupby(\"variety\") \\\n         .median() \\\n         .sort_values(by=\"points\", ascending= False) \\\n         .index\n\nplt.figure(figsize=(10,8))\nax = sns.boxplot(x=\"points\", y=\"variety\",\n                 data=french_df.loc[french_df[\"variety\"].isin(top10_variety_fr),:],\n                 order=median_ratings_top10_variety_fr\n                )\nplt.title(\"Ratings by Variety\")\nplt.show()","297b62a8":"top20_wineries_fr = french_df.winery.value_counts(normalize=True).nlargest(20) \\\n.sort_values(ascending= False).index\n\nplt.figure(figsize=(12,8))\nsns.countplot(y=\"winery\", data=french_df[french_df.winery.isin(top20_wineries_fr)],\n              order=top20_wineries_fr, hue=\"province\")\nplt.show()","d1c83563":"Champagne, White and Read Bordeaux get the higghest ratings: 90.\n\nChampagne ratings tends to be higher than others variety, the whisker is more\nshifted to the right.","2f129fb4":" <a id=\"1.4\"><\/a>\n## Influence of Wine Ratings over Price","fbaa7b2d":"<a id=\"2.3\"><\/a>\n## Wineries with the biggest number of unique wines","9f51b23a":"WineEnthusiast only post wines with a range >= 80.\nThe following scale rating is used:\n* 95-100 Classic: a great wine\n* 90-94 Outstanding: a wine of superior character and style\n* 85-89 Very good: a wine with special qualities\n* 80-84 Good: a solid, well-made wine\n\nWine reviews are based on blind tastings. Different editors cover the same region year to year.\nThis rating is not a famous one, like Robert Parker or Revue du Vin de France.\n\n\n50% of wine reviews are between 86-90 points. As we could imagine there is very small number of great wines >= 95.","ccaad838":"# Wine Review Analysis: Worldwide & France","cbaa3bc1":"Country: The country that the wine is from description\n\ndesignation: The vineyard within the winery where the grapes that made the wine are from\n\npoints: The number of points WineEnthusiast rated the wine on a scale of 1-100 (though they say they only post reviews for wines that score >=80)\n\nprice: The cost for a bottle of the wine\n\nprovince: The province or state that the wine is from\n\nregion_1: The wine growing area in a province or state (ie Napa)\n\nregion_2: Sometimes there are more specific regions specified within a wine growing area (ie Rutherford inside the Napa Valley), but this value can sometimes be blank\n\nvariety: The type of grapes used to make the wine (ie Pinot Noir)\n\nwinery: The winery that made the wine","be65aa82":"I notice that there is some mistakes in the fied *Variety*. Some wine reviewers has labeled variety with:\n* A mix of grap variety like **Cabernet Shiraz**\n* Name of vineyards.\nA variety should be a variety of graps and that's it.\n\nVery few wine reviews for some variety, high dispersion. we can't really say with precision which variety is the most expensive","a906de54":"### Variety Distribution","e8efbf2f":"Burgundy (Bourgogne in French) is over represented, it came from the particularity of \"climat\" from this region.\n\nA climat is a wine terroir, a small parcel of land with it's own particularities: climatic and geologic. There is more than 1000 different climat in Burgundy. ","dd1cc1e1":" <a id=\"2\"><\/a>\n# 2) Zoom on the vineyard of France","8b925f71":"### Country Distribution","2a747913":"We don't see a clear influence of low ratings <= 88 over prices, whereas high ratings influence clearly price.\n\nLet's do an ANOVA Test to find relationships between ratings and prices.\n\nANOVA will find if there is a real difference between price means and ratings by testing if there is a significant difference between ratings.","1b67bef6":" <a id=\"1.1\"><\/a>\n### TOP3 Variety by Country","cab0df4f":"## Table of Contents:\n- [1) Overall Exploration](#1)\n    - [1.1) TOP3 variety by country](#1.1)\n    - [1.2) Price distribution](#1.2)\n    - [1.3) Points distribution](#1.3)\n    - [1.4) Influence of Wine Ratings over Price](#1.4)\n    - [1.5) Most expensive variety](#1.5)\n    - [1.6) Wineries with the biggest number of unique wines](#1.6)\n- [2) Zoom on the vineyard of France](#2)\n    - [2.1) Which variety is the most expensive ?](#2.1)\n    - [2.2) Which variety has the best ratings for the most frequent variety ?](#2.2)\n    - [2.3) Wineries with the biggest number of unique wines](#2.3)","46c8f5b2":"* **Carignan-Syrah** and **Muscadelle** has too few observations to say it's really an expensive variety.\n* So **Marsanne** is the most expensive variety considering it's Median and it's InterQuartile Range. It's a white wine variety, not a famous variety, that's surprising !\n* **Champagne** worldwide famous, associated to the French luxury, is not the most expensive as I thought. There is always an opportunity to drink champagne, as Lily Bollinger said - \u201cI only drink champagne when I\u2019m happy, and when I\u2019m sad. Sometimes I drink it when I\u2019m alone. When I have company, I consider it obligatory. I trifle with it if I am not hungry and drink it when I am. Otherwise I never touch it\u2014unless I\u2019m thirsty.\u201d ","3c6117cf":" <a id=\"1\"><\/a>\n# 1) Overall Exploration","82d76a90":"US and France wineries get a lot of different wines.\nCameron Hughes winery is the only with wine produced all over the world.","97bbb112":"<a id=\"2.1\"><\/a>\n## Which variety is the most expensive ?","7eb4a548":"**Data: **  \n\n[Source of Data](https:\/\/www.kaggle.com\/zynicide\/wine-reviews)\nDimension:  10 columns and 150k rows of wine reviews.\n\n**Context:**\n\nThe data was scraped from WineEnthusiast on November 22nd, 2017 by [zackthoutt](https:\/\/www.kaggle.com\/zynicide).\nWineEnthusiast collect wine reviews from a team of experienced wine taster, the dataset represent a set of wine reviews with ratings and description of the wine tasted.\n\n**Goal: **\n\nExploratory Analysis of wines: \n- Distributions.\n- Influence of wine ratings over prices.\n- Most expensive variety.\n- Best variety rating.","8e7717db":"<a id=\"2.2\"><\/a>\n## Which variety has the best ratings for the most frequent variety ?","64724cc4":"### Visualize nullity by column","aada9a98":" <a id=\"1.5\"><\/a>\n ## Most expensive variety","ace9d73c":" <a id=\"1.6\"><\/a>\n ## Wineries with the biggest number of unique wines TOP20","1e9ba1b9":" <a id=\"1.2\"><\/a>\n### Price Distribution ","23548d76":" <a id=\"1.3\"><\/a>\n### Points Distribution","986eb4a6":"The majority of wine prices are between 10 and 100$(logarithm base 10)."}}