{"cell_type":{"345f616f":"code","dc6c1f81":"code","b3ef6c0c":"code","4147a883":"code","4e688f97":"code","2edd4d2b":"code","a13d4bc0":"code","a29988c8":"code","4970ab19":"code","59100399":"code","61aa151c":"code","72058cdf":"code","d253e330":"code","561ab481":"code","387ecbe4":"markdown","453aa6a9":"markdown"},"source":{"345f616f":"import xarray as xr\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport datetime as dt","dc6c1f81":"level = 'isobar'              #vertical level (height or isobar)\nfile_date = dt.datetime(2017, 2, 14) # Day example \n#parameter name in the file (cf cells below to know the parameter names -> exploration of metadata)\nif level == 'isobar':\n    param = 'w'\n    level_name = 'isobaricInhPa'     #name of the vertical level  \n    level_value = 850\nelse:\n    param = 'pres'\n    level_name = 'heightAboveGround'\n    level_value = 20","b3ef6c0c":"fname = \"\/kaggle\/input\/defi-ia-2022-test\/Train\/Train\/X_forecast\/arpege_3D_%s_%s.nc\" %(level,file_date.strftime('%Y%m%d'))\ndata = xr.open_dataset(fname)","4147a883":"data","4e688f97":"coord = 'longitude'\ndata[coord]","2edd4d2b":"data[coord].values[0:10]","a13d4bc0":"run_date = data['time']\n#run_date.values     #get the values\nrun_date","a29988c8":"range_forecasts_dates = data['valid_time']\nrange_forecasts_dates[0:10]","4970ab19":"info_level = data[level_name]\nlevel_vals=info_level.values     #get the values\ninfo_level","59100399":"d = data[param]     #param : parameter name defined at the beginning of the Notebook \nd_vals=d.values     #get the values\n###examples to get the information from attributes\n#d.units                      #unit\n#d.long_name                      #long name\nd_vals[0:1,0:2,0:2,0:2]","61aa151c":"d_vals.shape","72058cdf":"import cartopy.crs as ccrs\nimport cartopy.feature as cfeature","d253e330":"forecast_date = dt.datetime(2017, 2, 14,12,0)","561ab481":"# Coordinates of studied area boundaries (in \u00b0N and \u00b0E)\nlllat = 46.25  #lower left latitude\nurlat = 51.896  #upper right latitude\nlllon = -5.842  #lower left longitude\nurlon = 2  #upper right longitude\nextent = [lllon, urlon, lllat, urlat]\n\nfig=plt.figure(figsize=(9,10))\n\n# Select projection\nax = plt.axes(projection=ccrs.PlateCarree())\n\n#plot the data and the background map (coastlines and borders)\nif level_name == 'heightAboveGround':\n    img = ax.imshow(data.sel(valid_time=forecast_date,heightAboveGround=level_value)[param], interpolation='none', origin='upper', extent=extent)\nelse:\n    img = ax.imshow(data.sel(valid_time=forecast_date,isobaricInhPa=level_value)[param], interpolation='none', origin='upper', extent=extent)\nax.coastlines(resolution='50m', linewidth=1)\nax.add_feature(cfeature.BORDERS.with_scale('50m'))\n\nplt.colorbar(img, orientation= 'horizontal').set_label(d.long_name+ ' (in '+d.units+ ')')\nplt.title(\"arpege model - \"+str(forecast_date) + ' - ' + 'level ' + str(level_value) + ' ' + level_name)\nplt.show()","387ecbe4":"# Weather models : 3D parameters\n\nThe aim of this notebook is to indicate how to read the 3D data from the large-mesh french weather model called 'ARPEGE' (spatial resolution of 0.1\u00b0).\n\nPer day, you have the weather model run of 00h with range forecasts from 00h to 24h. The time step is different according to days : it is 1h from 0h to 12h and rises to 3h after 12h (from 12h to 24h of range forecasts).\n\nFinally, the 3D data are stored in 2 different netcdf files, according to the vertical levels:\n* height levels (height in the file name) : 20, 100, 500, 875, 1375, 2000 and 3000 m\n* isobar levels (isobar in the file name) : 1000, 950, 925, 850, 700, 600 and 500 hPa\n\nThe parameters are as follows:\n* height levels (height in the file name) : pressure (in Pa)\n* isobar levels (isobar in the file name) : temperature (in K), *pseudo-adiabatic potential temperature of the wet bulb* (in K), relative humidity (in %), wind speed (in m.s-1), wind direction (in \u00b0), *U and V wind components* (in m.s-1), *vertical velocity* (in Pa.s-1), *geopotential* (in m2.s-2)\n\nFor more information, cf [documentation](https:\/\/meteofrance.github.io\/meteonet\/english\/data\/weather-models\/).\n\n*Physical sense of variables*\n* *pseudo-adiabatic potential temperature of the wet bulb* : temperature affected to an air particle brought back to its condensation level. It is about a near-conversative parameter. It allows to follow the state of an air particle in a satured atmosphere and then allows to follow the evolution of a perturbation, depression (or a satured air mass). For example, this parameter at 850hPa is very useful to know the depression structure and to follow its evolution.\n* *horizontal wind speed components:*, U : from west to east and V : from south to north.\n* *vertical velocity*: vertical speed; the displacement is expressed in Pa (in meteorology, the vertical levels are often expressed in isobar levels, cf weather_models_explanations.md for more details); The higher the height is, the lower the pressure is. If the vertical velocity is positive, there is an upward current (ex : the earth surface is warmed by the sun). The opposite corresponds to a downdraft (ex : an cold air mass passes above a warmer ground).\n* *geopotential*: it is used to compute the pressure and takes account the local gravity variations of the Earth. The height of the geopotential is interesting in meteorology : it allows to get the constant pressure heights. A high geopotential (pressure levels have high heights) is often associated to an anticyclone and a low geopotential (pressure levels have low heights) corresponds to a depression.\n\n","453aa6a9":"The structure of the parameter (4 dimensions):\n* number of steps or range forecasts\n* number of vertical levels\n* number of points in latitude\n* number of points in longitude"}}