{"cell_type":{"6525d607":"code","0d66c4fc":"code","aa155ef1":"code","574f313b":"code","0df7fa3a":"code","aca3c12e":"code","9a068eae":"code","4ece71ba":"code","588357c5":"code","94be65ef":"code","730f76fa":"code","42b3cd7e":"code","498ce2e9":"code","818917ba":"code","75cbe6bc":"markdown","d5faeb83":"markdown","83407116":"markdown","2d0fe9ef":"markdown","f1f8e488":"markdown","72e6c32c":"markdown","fae73212":"markdown","6ec41929":"markdown","ce3f790f":"markdown","ed40d1d7":"markdown","f1f5f650":"markdown","54e3044e":"markdown","92981be0":"markdown"},"source":{"6525d607":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","0d66c4fc":"import pandas as pd","aa155ef1":"data_df = pd.read_csv(\"\/kaggle\/input\/production-in-industry-annual-data\/sts_inpr_a.tsv\", sep='\\t')","574f313b":"print(list(data_df.columns))","0df7fa3a":"data_df.head()","aca3c12e":"data_df.tail()","9a068eae":"pivot_data_col = data_df.columns[0]\nyear_columns = data_df.columns[1:]","4ece71ba":"data_df['indic_bt'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[0])\ndata_df['nace_r2'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[1])\ndata_df['s_adj'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[2])\ndata_df['unit'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[3])\ndata_df['geo']     = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[4])","588357c5":"selected_columns = list(['indic_bt', 'nace_r2', 's_adj', 'unit', 'geo']) +  list(year_columns)\ndata_df = data_df[selected_columns]","94be65ef":"data_tr_df = data_df.melt(id_vars=['indic_bt', 'nace_r2', 's_adj', 'unit', 'geo'], \n        var_name=\"year\", \n        value_name=\"value\")\ndata_tr_df['geo'] = data_tr_df['geo'].apply(lambda x: str(x))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"e\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"b\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"u\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"c\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"d\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"z\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"p\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"s\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\": \", \"NAN\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: float(x))","730f76fa":"print(f\"Transformed data shape: {data_tr_df.shape} (rows\/columns)\")\ndata_tr_df.head()","42b3cd7e":"data_tr_df.tail()","498ce2e9":"import pandas_profiling\npandas_profiling.ProfileReport(data_tr_df)","818917ba":"data_tr_df.to_csv(\"eu_production_in_industry_annual_data.csv\", index=False)","75cbe6bc":"We select now only the new columns resulted from splitting the `pivot_data_col` and the time columns.","d5faeb83":"Let's inspect the result.","83407116":"# Introduction\n\nWe show in this Kernel how we can process the data to prepare it for easier processing. Let's check the data files.","2d0fe9ef":"Then, we split from `pivot_data_col` the 5 separate fields:\n* indic_bt;\n* nace_r2;   \n* s_adj;\n* unit;\n* geo;","f1f8e488":"The first column is a composed one, containing 5 different information (indic_bt, nace_r2, s_adj, unit,geo \\ time). The next columns are temporal values, the years value.","72e6c32c":"Let's also take a look to few of the rows.","fae73212":"## Load the data\n\nThe datafiles are in TSV format. We will read the files using pandas, just include in the function call the `sep` (tab separator data).\nWe demonstrate first how to read and process the Annual data.","6ec41929":"# Export data in csv format","ce3f790f":"Next, we pivot the time columns using `melt` operation in pandas.  \nWe also make sure we transform `date` to be an integer (here is a year data).  \nWe set `value` to be a float, after we replace \": \" (for N\/A) with `NAN`.","ed40d1d7":"# A very preliminary exploratory data analysis\n\nThis would be a very short exploratory data analysis. The role of this Kernel is just to show how we can prepare the annual data for analysis and we already did this.","f1f5f650":"Let's glimpse the data columns.","54e3044e":"# Data pre-processing\n\nWe start by defining two working lists.","92981be0":"# Analysis preparation\n\n## Load packages"}}