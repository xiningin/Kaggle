{"cell_type":{"e10d7a61":"code","12fddcf0":"code","083e38e4":"code","89e64cdd":"code","c0b5c76a":"code","74b83080":"code","794c0ab0":"code","32e2e5c1":"code","a12c6e54":"code","cad4ac4e":"code","52b053e2":"code","8eab755f":"code","542cd6eb":"code","bfba18ec":"code","dedff4b0":"code","fec7ce20":"code","8be23140":"code","512eb5c5":"code","9cf1e15e":"code","1a215e5c":"code","57406775":"code","0b046e90":"code","8641f178":"code","9fcd9679":"code","88d9c26a":"code","97d23a06":"code","ca74b28f":"code","f65ee98d":"code","86c837f9":"code","6bbf7b8e":"code","50eeea90":"code","dcda692c":"code","f256cfc3":"code","4ec2c19d":"code","cdf9e996":"code","89fc9d2f":"code","06b65d36":"code","35ebc2d2":"code","27072ae2":"code","ff4dc7cd":"markdown","42841f99":"markdown","9105bace":"markdown","a5741d44":"markdown","7706844f":"markdown","a88bc1dd":"markdown","f5c7465f":"markdown","3404e23a":"markdown","94ce909e":"markdown","d388ec6a":"markdown","7382f7fb":"markdown","02ed7c4b":"markdown","835b1c89":"markdown","9cefb44f":"markdown","5caeafbc":"markdown","b86b2282":"markdown","1a6eaa64":"markdown","4e298db1":"markdown","e85cac2a":"markdown","aa381787":"markdown","c241437c":"markdown","06cd901a":"markdown","6c6495f7":"markdown","5e6e170d":"markdown","1f45eba5":"markdown"},"source":{"e10d7a61":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport folium\nimport matplotlib.pyplot as plt","12fddcf0":"df = pd.read_csv(\"..\/input\/house-pricing-in-belo-horizonte\/data.csv\")","083e38e4":"np.round((df.isna().sum() \/ df.shape[0]) * 100, 2)","89e64cdd":"df.dropna(subset=[\"price\"], inplace=True)","c0b5c76a":"df.price.describe()","74b83080":"print(f\"The most expensive house worths R$ {df.price.max()}\")","794c0ab0":"df_wo_outliers = df[df.price < df.price.quantile(0.95)]","32e2e5c1":"print(f\"The cheapest property worths R$ {df.price.min()}\")","a12c6e54":"df_wo_outliers = df_wo_outliers[df_wo_outliers.price >= 1e5]","cad4ac4e":"sns.displot(df_wo_outliers.price\/1e6)\nplt.title(\"Price distribution\")\nplt.xlabel(\"Price (per million)\")\n\nplt.show()","52b053e2":"print(f\"There's still {df_wo_outliers.shape[0]} properties\")","8eab755f":"df_wo_outliers.rooms.value_counts().sort_index()","542cd6eb":"df_wo_outliers = df_wo_outliers[~df_wo_outliers.rooms.str.contains('-')]","bfba18ec":"df_wo_outliers[\"rooms\"] = df_wo_outliers[\"rooms\"].astype(int)","dedff4b0":"rooms_count = df_wo_outliers.rooms.value_counts().sort_index()\n\nplt.bar([str(value) for value in rooms_count.index], rooms_count.values\/df_wo_outliers.shape[0])\nplt.title(\"Distribution of the Number of Rooms\")\nplt.xlabel(\"Number of Rooms\")\nplt.ylabel(\"Percentage\")\nplt.show()","fec7ce20":"print(f\"There's still {df_wo_outliers.shape[0]} properties\")","8be23140":"df_wo_outliers = df_wo_outliers[\n    (~df_wo_outliers[\"square-foot\"].str.contains('-'))\n    & (~df_wo_outliers[\"garage-places\"].str.contains('-'))\n]\n\ndf_wo_outliers.loc[:, [\"garage-places\", \"square-foot\"]] = (\n    df_wo_outliers[[\"garage-places\", \"square-foot\"]].astype(int)\n)","512eb5c5":"plt.hist(df_wo_outliers[\"square-foot\"], bins=50)\nplt.title(\"Square Footage Distribution\")\nplt.show()","9cf1e15e":"garage_counts = df_wo_outliers[\"garage-places\"].value_counts().sort_index()\n\nplt.bar([str(label) for label in garage_counts.index], garage_counts.values)\nplt.title(\"Garage Places Distribution\")\nplt.show()","1a215e5c":"print(f\"There's still {df_wo_outliers.shape[0]} properties\")","57406775":"df_wo_outliers.dropna(subset=[\"neighborhood\"], inplace=True)\ndf_wo_outliers[\"adm-fees\"] = df_wo_outliers[\"adm-fees\"].fillna(0)\n\nprint(f\"There's still {df_wo_outliers.shape[0]} properties\")","0b046e90":"print(f\"There are {df_wo_outliers.neighborhood.nunique()} different neighborhood\")","8641f178":"def mode(s):\n    return s.value_counts().index[0]","9fcd9679":"grouped_by_neighborhood = (\n    df_wo_outliers.groupby(\"neighborhood\")\n    .agg(\n        {\n            \"price\": \"median\",\n            \"garage-places\": mode,\n            \"rooms\": mode,\n            \"square-foot\": \"median\",\n            \"adm-fees\": \"median\"\n        }\n    )\n)","88d9c26a":"cols = [\"price\", \"square-foot\", \"rooms\", \"garage-places\", \"adm-fees\"]\n\ngrouped_by_neighborhood = grouped_by_neighborhood.sort_values(\n    by=cols,\n    ascending=[\n        True,\n        False,\n        False,\n        False,\n        True\n    ]\n)","97d23a06":"figure, axs = plt.subplots(5, 1, sharex=True, figsize=(12,7))\n\ntop10 = grouped_by_neighborhood.iloc[:10]\nfor i, col in enumerate(cols):\n    axs[i].bar(top10.index, top10[col].values)\n    axs[i].set_ylabel(col)\n\nplt.xticks(rotation=90)\nfigure.suptitle(\"Caracteristics per Neighborhood - 10 Least Expensive\")\nplt.show()","ca74b28f":"figure, axs = plt.subplots(5, 1, sharex=True, figsize=(12,7))\n\ntop10 = grouped_by_neighborhood.iloc[-10:]\nfor i, col in enumerate(cols):\n    axs[i].bar(top10.index, top10[col].values)\n    axs[i].set_ylabel(col)\n\nplt.xticks(rotation=90)\nfigure.suptitle(\"Caracteristics per Neighborhood - 10 Least Expensive\")\nplt.show()","f65ee98d":"df_wo_outliers[\"price-m2\"] = df_wo_outliers[\"price\"] \/ df_wo_outliers[\"square-foot\"]\ngrouped_m2_price = df_wo_outliers.groupby(\"neighborhood\").agg({\"price-m2\": \"mean\"}).sort_values(by=\"price-m2\")","86c837f9":"plt.barh(grouped_m2_price[:10].index, grouped_m2_price[:10].values.reshape(-1))\nplt.title(\"Least Expensive Square Meter - Belo Horizonte\")\nplt.xlabel(\"Price - $m^2$\")\nplt.ylabel(\"Neighborhood\")\nplt.show()","6bbf7b8e":"plt.barh(grouped_m2_price[-10:].index, grouped_m2_price[-10:].values.reshape(-1))\nplt.title(\"Most Expensive Square Meter - Belo Horizonte\")\nplt.xlabel(\"Price - $m^2$\")\nplt.ylabel(\"Neighborhood\")\nplt.show()","50eeea90":"df_wo_outliers[\"property-type\"] = \"Apartment\"\ndf_wo_outliers.loc[df_wo_outliers[\"adm-fees\"] == 0, \"property-type\"] = \"House\"","dcda692c":"df_wo_outliers.groupby(\"property-type\")[\"price-m2\"].mean()","f256cfc3":"df_wo_outliers.groupby(\"property-type\")[\"price\"].mean()","4ec2c19d":"n_rooms = 3\nn_garage_places = 2","cdf9e996":"df_wo_outliers = df_wo_outliers[\n    (df_wo_outliers[\"rooms\"] >= n_rooms)\n    & (df_wo_outliers[\"garage-places\"] >= n_garage_places)\n]","89fc9d2f":"min_price = 250000\nmax_price = 420000\n\ndf_ap = df_wo_outliers[\n    (df_wo_outliers[\"property-type\"] == \"Apartment\")\n    & (df_wo_outliers[\"price\"].between(min_price, max_price))\n]\ndf_ap = df_ap.sort_values(by=[\"square-foot\", \"price\"], ascending=[False, True]).iloc[:10]","06b65d36":"ap_map = folium.Map(location=[-19.913948065929585, -43.951483374892256], zoom_start=11)\n\nfor _, row in df_ap.iterrows():\n    folium.Marker(\n        location=[\n            row.latitude,\n            row.longitude],\n        popup=f\" n_rooms: {row.rooms}\\n price: {row.price}\\n neighborhood: {row.neighborhood}\"\n    ).add_to(ap_map)\n\nap_map","35ebc2d2":"min_price = 350000\nmax_price = 500000\n\ndf_house = df_wo_outliers[\n    (df_wo_outliers[\"property-type\"] == \"House\")\n    & (df_wo_outliers[\"price\"].between(min_price, max_price))\n]\ndf_house = df_house.sort_values(by=[\"square-foot\", \"price\"], ascending=[False, True]).iloc[:10]","27072ae2":"house_map = folium.Map(location=[-19.913948065929585, -43.951483374892256], zoom_start=11)\n\nfor _, row in df_house.iterrows():\n    folium.Marker(\n        location=[\n            row.latitude,\n            row.longitude],\n        popup=f\" n_rooms: {row.rooms}\\n price: {row.price}\\n neighborhood: {row.neighborhood}\"\n    ).add_to(house_map)\n\nhouse_map","ff4dc7cd":"### Directed Analysis\n\nNow lets just take a quick look at the records and see what is the greatest properties according to some specific characteristics","42841f99":"### What is the top 5 most expensive neighborhoods?","9105bace":"There are also strangely small values that wouldn't be enough to buy some dogs' houses, what quite probably are errors. Hence, let's establish a pertinent minimum value to filter on the dataframe (for example, 100k).","a5741d44":"#### What is the percentage of null values per column?","7706844f":"Now we are ready to go. As we can see, there is still a considerable amount of properties in our dataframe.\n\n### What is the top 5 least expensive neighborhoods?","a88bc1dd":"After this quick filtering, how many points there left in the data?","f5c7465f":"As we saw, only one column has a significant amount of null values. This column regards costs that usually are related to condominiums. In that case, the absence of cost represents no cost at all and, hence, there's no information loss.\n\nThe remaining two fields with null values, on the other hand, might be problematic. For the purpose of this analysis, I decided to simply discard every item without an aggregated `price`. However, records with missing `neighborhoods` will be kept.","3404e23a":"Interestingly, it seems that the square meter price for apartments is more expensive than for houses.","94ce909e":"### What is the most expensive square meter?","d388ec6a":"How many data points there's left in the dataset?","7382f7fb":"The previous plots suggests that most of the properties in cheaper neighborhood are similar in their characteristics. We can derive an important information with the visualization of `adm-fees` column. Since 6 out of 10 neighborhoods have a median value equal to zero, we mgith expect such places to have bigger numbers of apartments instead of houses (or condominium houses) in sale. Considering only condominium properties to have administrative costs.","02ed7c4b":"## Introduction\n\nIn this notebook we'll develop an exploratory data analysis with real estate data from a brazilian city named Belo Horizonte. The extraction of the data was made with Scrapy and Selenium, and performed by November 2021.","835b1c89":"---\n\n## More Advanced Analysis\n\nIn this slightly more complex analysis, we'll dive a little bit into the statistics from each neighrborhood, and cost-benefit investigations. Initially, lets just remove every record without the neighborhood specification.","9cefb44f":"---\n\n## Basic Explorations and Data Cleaning","5caeafbc":"A geographic visualization of the top 10 greatest houses in terms of square footage and price","b86b2282":"In the most expensive places, on the other hand, we have a bit more differentiation. Differently, from the least expensive neighborhoods, here we have a predominance of houses instead of apartments, and no property with only one garage place.\n\n### What is the least expensive square meter?","1a6eaa64":"### How does the price distribution looks like?","4e298db1":"### What is the average price per property type (House or Apartment)?","e85cac2a":"Nonetheless, the average price for house properties is bigger.","aa381787":"Apparently, and not surprisingly, there are some pretty extreme outliers in the data. For the purpose of this analysis, lets consider only data points bellow the 95-th percentile.","c241437c":"As we can see, there are records where the number of rooms is not informed, whereas others inform more than one value. Since both cases can be source of uncertainty, lets just remove these items and see what we get.","06cd901a":"A geographic visualization of the top 10 greatest apartments in terms of square footage and price\n\n**NOTE: by clicking on the pins we are able to see more informations about the property beeing analyzed**","6c6495f7":"---\n## Conclusion\n\nSo, that's it. Here we went through some exploratory data analysis over the dataset I've scrapped on a real estate site with Belo Horizonte's properties. We saw some very interesting characteristics such as bigger structural differences on more expensive properties, as well as a tendency to have more houses than apartments in the more expensive neighborhoods.\n\nI also intend to perform further improvements in the dataset (aggregating external sources) so we become able to perform deeper analysis with regard to life quality, and criminality of the neighborhoods.\n\n\nThanks for the reading. Any feedback is more than welcome. If you enjoyed, please give a thumbs up.","5e6e170d":"### How does the distribution of rooms look like?","1f45eba5":"### How is the distribution of `Garage Places` and `Square Footage`?"}}