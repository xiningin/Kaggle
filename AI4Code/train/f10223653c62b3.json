{"cell_type":{"bade53d0":"code","84116ee2":"code","2d48ff69":"code","32373b56":"code","49cfca34":"code","884318ff":"markdown"},"source":{"bade53d0":"!pip install lets-plot==2.0.2","84116ee2":"import geopandas as gpd\nfrom shapely import wkt\nfrom google.cloud import bigquery\nfrom lets_plot import *; LetsPlot.setup_html()","2d48ff69":"PROJECT_ID = 'eng-copilot-314215'\nbigquery_client = bigquery.Client(project=PROJECT_ID)","32373b56":"query = '''\n    SELECT ST_GeogPoint(longitude, latitude) as WKT, num_bikes_available\n    FROM `bigquery-public-data.new_york.citibike_stations`\n    WHERE num_bikes_available > 30\n'''\n\ndf = bigquery_client.query(query).to_dataframe()\ndf['WKT'] = df['WKT'].apply(wkt.loads)\ngdf = gpd.GeoDataFrame(df, geometry='WKT')","49cfca34":"ggplot() + \\\n    geom_livemap(zoom=11) + \\\n    geom_point(aes(size='num_bikes_available'), data=gdf, color='#0000ff', alpha=.5) + \\\n    scale_size(range=[4, 8], name='available bikes') + \\\n    ggtitle('Number of Bikes Available at the Location of NYC') + \\\n    ggsize(800, 600)","884318ff":"# Getting started with BigQuery GIS and Lets-Plot\n\nThis notebook is based on the page [\"Getting started with BigQuery GIS\"](https:\/\/cloud.google.com\/bigquery\/docs\/gis-getting-started). For visualization I picked the [Lets-Plot](https:\/\/lets-plot.org) library for declaratively creating graphics - like [ggplot2](https:\/\/ggplot2.tidyverse.org), but for Python."}}