{"cell_type":{"85bc4659":"code","4ea7958c":"code","83147136":"code","510c574b":"code","ca8e743d":"code","8b1df2a3":"code","09a585f0":"code","53223710":"code","8fa59869":"code","3a3671c2":"code","fe6d5dd0":"code","477a124c":"code","84e6ec13":"code","67870092":"code","8cde3383":"code","764d1ed3":"code","726c7bdf":"code","11459d53":"code","2a33597c":"markdown","7e59ae8e":"markdown","d40375a7":"markdown","d6fc1bfa":"markdown","7241f48d":"markdown","b5a87b57":"markdown","0a2c96c6":"markdown","3fafe3e8":"markdown","238a2a4c":"markdown","de4b32d3":"markdown","f222eb7f":"markdown","f53c9d79":"markdown","7e5a62bd":"markdown"},"source":{"85bc4659":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","4ea7958c":"import numpy as np\nimport pandas as pd\nimport os\nimport h2o\nfrom h2o.estimators.deeplearning import H2ODeepLearningEstimator\nfrom sklearn.preprocessing import StandardScaler as ss\nfrom time import time","83147136":"pd.options.display.max_columns = 800\nos.chdir(\"..\/input\")","510c574b":"h2o.init()","ca8e743d":"tr_data=h2o.import_file(\"fashion-mnist_train.csv\")\ntype(tr_data)\ntst_data = h2o.import_file(\"fashion-mnist_test.csv\")","8b1df2a3":"tr_data[\"label\"]=tr_data[\"label\"].asfactor()\ntr_data['label'].levels()\nX_columns = tr_data.col_names[1:785]\nY_columns = tr_data.col_names[0]\nY_columns","09a585f0":"train,test = tr_data.split_frame(ratios= [0.7])\ntrain.shape","53223710":"test.shape","8fa59869":"Model = H2ODeepLearningEstimator(\n                             distribution=\"multinomial\",\n                             activation = \"RectifierWithDropout\",\n                             hidden = [50,50,50],\n                             input_dropout_ratio=0.2,\n                            standardize=True,\n                             epochs = 100\n                             )","3a3671c2":"start=time()\nModel.train(x = X_columns,\n           y = Y_columns,\n           training_frame=train\n           )\nStop=time()\nf\"Processing Time = {(Stop-start)\/60} min\"","fe6d5dd0":"Out=Model.predict(test[:,1:785])\nOut.shape","477a124c":"act=test['label'].as_data_frame()\nact['predict'] = Out[0].as_data_frame()\nact.head()","84e6ec13":"act.columns","67870092":"check=(act['label'] == act['predict'])\nAccuracy=np.sum(check)\/check.size\nf\"The Prediction is {Accuracy*100} % accurate\"","8cde3383":"Out=Model.predict(tst_data[:,1:785])\nOut.shape","764d1ed3":"act=tst_data['label'].as_data_frame()\nact['predict'] = Out[0].as_data_frame()\nact.head()","726c7bdf":"act.columns","11459d53":"check=(act['label'] == act['predict'])\nAccuracy=np.sum(check)\/check.size\nf\"The Prediction is {Accuracy*100} % accurate\"","2a33597c":"### Step 7 Predicting Test.csv Data","7e59ae8e":"##Define Working Directory and set diplay number of colm limit","d40375a7":"### Step 4 Seperate the Predictor (X=> col 2 to 785: pixels) and Target Data set (Y=> col 1 : label)","d6fc1bfa":"### Step 5 Scale X using StandardScaler() \n##### As the Data has no categorical Variable, Standardization is not required.\n\n### Step 6 Splitting Data in Train and Test set using split_frame","7241f48d":"### Check the actual v\/s Predicted","b5a87b57":"#### Start H2o","0a2c96c6":"### Read the Zipped dataset","3fafe3e8":"##### Train the Model","238a2a4c":"# Predict the test data","de4b32d3":"### Data collection for Validating Prediction","f222eb7f":"### Step 7 Modelling and Training using train Data from Train csv","f53c9d79":"### Data collection for Validating Prediction","7e5a62bd":"Accuracy of Prediction for Test.csv"}}