{"cell_type":{"fe018788":"code","1dd1cd3e":"code","33148c4f":"code","b832ba95":"code","10c552b7":"code","5fd39d8e":"code","0acbe884":"code","d97a87ff":"code","64347917":"code","97ca2b65":"code","360c2a37":"code","6ecff330":"code","1d84cea0":"code","33888281":"code","3fdeb459":"code","895b2b11":"code","8a169602":"code","73f745d6":"code","8216f34a":"code","0da7937d":"code","da27e7e5":"code","d5c66e97":"markdown","e47f864f":"markdown","4adda69d":"markdown","4f49d041":"markdown","ee88156f":"markdown","a018b02c":"markdown","878a3383":"markdown","224b11a8":"markdown","7e4e62fa":"markdown","376e5419":"markdown","ac2caead":"markdown","576dcbb8":"markdown","fdeb265d":"markdown","6979167d":"markdown","45e5abcf":"markdown","149f56af":"markdown","c9f0370f":"markdown","38d939df":"markdown","46a9b877":"markdown","fb730bfa":"markdown","d839f05d":"markdown","cdb389cd":"markdown","20c6b5f9":"markdown","40d71f93":"markdown","a36f84e6":"markdown"},"source":{"fe018788":"import pandas as pd\n\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\n# to use plotly offline\nfrom plotly.offline import iplot\nimport plotly.express as px\n\n\nimport cufflinks\ncufflinks.go_offline()\ncufflinks.set_config_file(world_readable=True, theme='pearl')\n\n# to ignore warnings\nimport warnings\nwarnings.filterwarnings('ignore')\n\n# for Markdown printing\nfrom IPython.display import Markdown, display\ndef printmd(string, color=None):\n    colorstr = \"<span style='color:{}'>{}<\/span>\".format(color, string)\n    display(Markdown(colorstr))","1dd1cd3e":"data_path = '\/kaggle\/input\/cdp-unlocking-climate-solutions'","33148c4f":"Cities_Disclosing_2018 = pd.read_csv(data_path+'\/Cities\/Cities Disclosing\/2018_Cities_Disclosing_to_CDP.csv')\nCities_Disclosing_2019 = pd.read_csv(data_path+'\/Cities\/Cities Disclosing\/2019_Cities_Disclosing_to_CDP.csv')\nCities_Disclosing_2020 = pd.read_csv(data_path+'\/Cities\/Cities Disclosing\/2020_Cities_Disclosing_to_CDP.csv')\n\ndf_cd = pd.concat([Cities_Disclosing_2018,Cities_Disclosing_2019,Cities_Disclosing_2020],0, ignore_index=True)","b832ba95":"Cities_Responses_2018 = pd.read_csv(data_path+'\/Cities\/Cities Responses\/2018_Full_Cities_Dataset.csv')\nCities_Responses_2019 = pd.read_csv(data_path+'\/Cities\/Cities Responses\/2019_Full_Cities_Dataset.csv')\nCities_Responses_2020 = pd.read_csv(data_path+'\/Cities\/Cities Responses\/2020_Full_Cities_Dataset.csv')\n\ndf_cr = pd.concat([Cities_Responses_2018,Cities_Responses_2019,Cities_Responses_2020],0, ignore_index=True)","10c552b7":"Corporates_Disclosing_to_CDP_Climate_Change_2018 = pd.read_csv(data_path+'\/Corporations\/Corporations Disclosing\/Climate Change\/2018_Corporates_Disclosing_to_CDP_Climate_Change.csv')\nCorporates_Disclosing_to_CDP_Climate_Change_2019 = pd.read_csv(data_path+'\/Corporations\/Corporations Disclosing\/Climate Change\/2019_Corporates_Disclosing_to_CDP_Climate_Change.csv')\nCorporates_Disclosing_to_CDP_Climate_Change_2020 = pd.read_csv(data_path+'\/Corporations\/Corporations Disclosing\/Climate Change\/2020_Corporates_Disclosing_to_CDP_Climate_Change.csv')\n\ndf1 = pd.concat([Corporates_Disclosing_to_CDP_Climate_Change_2018,Corporates_Disclosing_to_CDP_Climate_Change_2019,Corporates_Disclosing_to_CDP_Climate_Change_2020],0, ignore_index=True)","5fd39d8e":"Corporations_Responses_to_Climate_Change_2018 = pd.read_csv(data_path+'\/Corporations\/Corporations Responses\/Climate Change\/2018_Full_Climate_Change_Dataset.csv')\nCorporations_Responses_to_Climate_Change_2019 = pd.read_csv(data_path+'\/Corporations\/Corporations Responses\/Climate Change\/2019_Full_Climate_Change_Dataset.csv')\nCorporations_Responses_to_Climate_Change_2020 = pd.read_csv(data_path+'\/Corporations\/Corporations Responses\/Climate Change\/2020_Full_Climate_Change_Dataset.csv')\n\ndf2 = pd.concat([Corporations_Responses_to_Climate_Change_2018,Corporations_Responses_to_Climate_Change_2019,Corporations_Responses_to_Climate_Change_2020],0, ignore_index=True)","0acbe884":"def clean_text_round1(text):\n    '''Vietnam, VietNam, Viet nam to Viet Nam'''\n    \n    text = text.replace(\"Vietnam\",  \"Viet Nam\")\n    text = text.replace(\"VietNam\",  \"Viet Nam\")\n    text = text.replace(\"Viet nam\", \"Viet Nam\")\n\n    return text\n\nround1 = lambda x: clean_text_round1(x)","d97a87ff":"df_cd = pd.DataFrame(df_cd.apply(round1))\ndf_cr = pd.DataFrame(df_cr.apply(round1))\ndf1 = pd.DataFrame(df1.apply(round1))\ndf2 = pd.DataFrame(df2.apply(round1))","64347917":"df_cd.loc[df_cd.Country == 'Viet Nam']","97ca2b65":"printmd('All sections in cities responses on climate change', color=\"#255483\")\nprint(df_cr['Section'].unique())","360c2a37":"tmp = df_cr.loc[df_cr.Country =='Viet Nam'].Organization.value_counts().to_frame('')\nfig = px.bar(tmp,color_discrete_sequence=[\"#67a9cf\"])\n\nfig.update_layout(\n    title = dict(text='Number of responses from Viet Nam cities'),\n    font  = dict(family=\"Calibri\",size=13,color=\"RebeccaPurple\"),\n    xaxis = dict(title='',tickmode='auto'),\n    yaxis = dict(title='Count',tickmode='auto'),\n#     legend = dict(yanchor=\"middle\",y=0,xanchor=\"center\",x=1),\n    width=900, height=500)","6ecff330":"hcm_energy = df_cr.loc[(df_cr.Organization =='Ho Chi Minh City') & (df_cr['Section'] =='Energy')]\nanswers_columns = ['Year Reported to CDP','Column Name','Response Answer',]\nfor i,q in enumerate(hcm_energy['Question Name'].unique()):\n    statement = str(i+1)+ '. ' + q\n    printmd(statement, color=\"#255483\")\n    display(hcm_energy[answers_columns].loc[hcm_energy['Question Name'] ==q].reset_index(drop=True))","1d84cea0":"df2_countries = df2[['account_number','organization','response_value']].loc[df2.question_number =='C0.3'].reset_index(drop=True)\n\nprint(df2_countries.shape)\ndf2_countries.head()","33888281":"df2.module_name.value_counts()","3fdeb459":"v = []\nfor i in range(df2_countries.shape[0]):\n    if ('Viet Nam' in str(df2_countries.iloc[i,2])): \n        v.append(i)\n\nvn_corps = df2_countries[['account_number','organization']].iloc[v].drop_duplicates()\nvn_corps.reset_index(drop=True,inplace=True)\n\nstatement = \"There are \" + str(vn_corps.shape[0]) + ' companies that might have climate change action in Viet Nam'\nprintmd(statement, color=\"#255483\")\nvn_corps.head()","895b2b11":"v = []\nfor i in range(df2.shape[0]):\n    tmp = int(df2.iloc[i,0])\n    if tmp in vn_corps.account_number.to_list():\n        v.append(i)\ndf2_vn = df2.iloc[v]\ndf2_vn.head()","8a169602":"df2_vn_en = df2_vn.loc[df2_vn['module_name'] =='C8. Energy']\ndf2_vn_en.head()","73f745d6":"df2_vn_en.loc[(df2_vn_en['question_number']=='C8.1')]['response_value'].value_counts()","8216f34a":"df2_vn_en.loc[(df2_vn_en['question_number']=='C8.1')] = df2_vn_en.loc[(df2_vn_en['question_number']=='C8.1')].fillna(\"Don't know\")\ndf2_vn_en.loc[(df2_vn_en['question_number']=='C8.1')]['response_value'].value_counts()","0da7937d":"tmp = df2_vn_en.loc[(df2_vn_en['question_number']=='C8.1') & (df2_vn_en['survey_year'] == 2020)].response_value.value_counts().to_frame('')\nfig = px.bar(tmp,color_discrete_sequence=[\"#67a9cf\"])\n\nfig.update_layout(\n    title = dict(text='Percentage of total operational spend in the reporting year was on energy, 2020'),\n    font  = dict(family=\"Calibri\",size=13,color=\"RebeccaPurple\"),\n    xaxis = dict(title='',tickmode='auto'),\n    yaxis = dict(title='Number of companies',tickmode='auto'),\n    \n    width=900, height=600)","da27e7e5":"tmp = df2_vn_en.loc[df2_vn_en['question_number']=='C8.2']\nfor i in tmp['row_name'].unique():\n    tmp.loc[tmp['row_name'] ==i].response_value.value_counts().iplot(kind='bar',yTitle='Number of companies', \n                                                                     linecolor='black',color='#67a9cf',bargap=0.8,\n                                                                     title=i)","d5c66e97":"<a id=\"co_cc\"><\/a>\n## Corporations responses to climate change\nLike cities responses, a lot of questions have been answered by companies, one of them is: `Question number C0.3: Select the countries\/regions for which you will be supplying data.` <br>This is where we can look for information whether companies have climate action in a country <br>\n=> ***df2_countries***: dataframe that contains all the answers for question C0.3\n\nOther column is `module_name` that indicates which field question the question belong to (energy or emissions or...)\n\n","e47f864f":"`vn_corps`: dataframe of all companies that have climate change activity in Viet Nam","4adda69d":"## Viet Nam cities disclosing","4f49d041":"<a id=\"co_cc_vn\"><\/a>\n## Companies with climate change activities in Vietnam\n\n109 companies declare that they have climate change actitity in Viet Nam, we will look on information they provided, especially on energy sector","ee88156f":"<a id=\"fo\"><\/a>\n<center><h1>Focuses of this notebook<\/h1><\/center>\n\n### Responses of cities in Viet Nam\n* Ho Chi Minh City on energy sector\n \n### Companies with climate change activities in Viet Nam\n \n","a018b02c":"<a id=\"ci_re\"><\/a>\n## Cities responses - df_cr","878a3383":"<a id=\"vi_vi\"><\/a>\n## Viet Nam, Vietnam?\nThere are inconsistences in calling my country name. In Vietnamese, it's 2 seperated words, so it should be Viet Nam","224b11a8":"Other column is `module_name` that indicates which field question the question belong to (energy or emissions or...)<br>\nA lot of questions belong to the module `C8. Energy`","7e4e62fa":"<a id=\"109vn\"><\/a>\n#### Energy questions\nThere are 8 questions being asked in energy module\n\n| question_number| question_unique_reference| \n|---|:---:| \n| C8.1  |What percentage of your total operational spend in the reporting year was on energy? |  \n| C8.2  |Select which energy-related activities your organization has undertaken. |  \n| C8.2a |Report your organization energy consumption totals (excluding feedstocks) in MWh. | \n| C8.2b |Select the applications of your organization consumption of fuel. | \n| C8.2c |State how much fuel in MWh your organization has consumed (excluding feedstocks) by fuel type.| \n| C8.2d |List the average emission factors of the fuels reported in C8.2c.|\n| C8.2e |Provide details on the electricity, heat, steam, and cooling your organization has generated and consumed in the reporting year.|\n| C8.2f |Provide details on the electricity, heat, steam and\/or cooling amounts that were accounted for at a low-carbon emission factor in the market-based Scope 2 figure reported in C6.3|","376e5419":"<a id=\"eda\"><\/a>\n<center><h1> Exploratory Data Analysis<\/h1><\/center>","ac2caead":"<a id=\"import\"><\/a>\n<center><h1>Import libraries<\/h1><\/center>","576dcbb8":"<a id=\"ci_re_cc\"><\/a>\n## Cities responses on climate change, what's in there?\nIn cities responses, there are a lot of information about different fields (energy, GHG emissions data, water supply,...). These information store in `Section` column","fdeb265d":"### Responses from those 109 companies, particularly on energy questions\n\n`df2_vn`: all answers from 109 companies that have actitity in Viet Nam\n\n`df2_vn_en`: energy answers from those 109 companies","6979167d":"<a id=\"data\"><\/a>\n<center><h1>Data<\/h1><\/center>","45e5abcf":"<a id=\"co_re_cc\"><\/a>\n## Corporations responses to climate change - df2","149f56af":"# Table of Contents\n* [Dataset overview](#data_overview)\n* [Focus of this notebook](#fo)\n* [Import libraries](#import)\n* [Data](#data)\n    * [Cities disclosing - df_cd](#ci_di)\n    * [Cities responses - df_cr](#ci_re)\n    * [Corporations disclosing to climate change - df1](#co_di_cc)\n    * [Corporations responses to climate change - df2](#co_re_cc)\n* [Exploratory Data Analysis](#eda)\n    * [Viet Nam](#vi_vi)\n    * [Cities responses on climate change, what's in there?](#ci_re_cc)\n    * [Viet Nam cities responses on climate change](#vi_ci_cc)\n        * [Ho Chi Minh City answers on energy sector](#sg_en)\n    * [Corporations responses to climate change](#co_cc)\n        * [Companies with climate change activities in Vietnam](#co_cc_vn)\n            * [Energy questions](#109vn)","c9f0370f":"<a id=\"data_overview\"><\/a>\n<center><h1>Dataset overview<\/h1><\/center>\n\n### Cities\n- Cities disclosing: General information of cities for 3 years 2018, 2019, 2020\n- Cities responses: Questions answered by cities for 3 years 2018, 2019, 2020\n\n### Corporations\n- Corporations disclosing to climate change or water security: General information of corporations for 3 years 2018, 2019, 2020\n- Corporations responses to climate change: Questions answered by corporations for 3 years 2018, 2019, 2020 regarding climate change issues\n- Corporations responses to water security: Questions answered by corporations for 3 years 2018, 2019, 2020 regarding water security issues\n","38d939df":"Fill empty answers with `Don't know`","46a9b877":"<a id=\"vi_ci_cc\"><\/a>\n## Viet Nam cities responses on climate change","fb730bfa":"<a id=\"co_di_cc\"><\/a>\n## Corporations disclosing to climate change - df1","d839f05d":"**`C8.1`**\n\nPercentage of total operational spend in the reporting year was on energy","cdb389cd":"<a id=\"sg_en\"><\/a>\n### Ho Chi Minh City answers on energy questions\n- All answers are from 2018\n- Energy mix: only some types of energy have percentage value which are\n\n| Energy type| Percentage| \n|---|:---:| \n| Biomass  |8.1|\n| Coal  |27.5|\n| Gas  |1.9|\n| Oil  |47|\n\n- Question 3 is about decision from Prime Miniter back to 2017: The electricity from solar grid connected with the electricity purchase price at VND 2,086 per kWh (excluding VAT, equivalent to 9.35 cents \/ kWh) <br>\n***Please note that:***\n    - This price has changed severel times until now\n    - Electricity of Vietnam (EVN) is a state owned company that covers almost all elements from generation to retail. ","20c6b5f9":"2020 answer on question `C8.1`","40d71f93":"**`C8.2`**\n\nSelect which energy-related activities your organization has undertaken. Yes\/No question\n\n| row_number| row_name| \n|---|:---:| \n| 1  |Consumption of fuel (excluding feedstocks)|\n| 2  |Consumption of purchased or acquired electricity|\n| 3  |Consumption of purchased or acquired heat|\n| 4  |Consumption of purchased or acquired steam|\n| 5  |Consumption of purchased or acquired cooling|\n| 6  |Generation of electricity, heat, steam, or cooling|","a36f84e6":"<a id=\"ci_di\"><\/a>\n## Cities disclosing - df_cd"}}