{"cell_type":{"bd5bd641":"code","1cee0f79":"code","2ff44fa7":"code","01a05591":"code","b3412dfa":"code","af921e5d":"code","4dadf6fd":"code","7bcb2f09":"code","37e53a0c":"code","d990f844":"code","bf00e0cd":"markdown","3737f049":"markdown","7534c5d1":"markdown","a249db1a":"markdown","d84d2d89":"markdown","d52fe8d2":"markdown","d9deafbf":"markdown","10cd1dc0":"markdown","af873d1c":"markdown"},"source":{"bd5bd641":"import pandas as pd\nimport numpy as np\n\ndf = pd.read_csv('..\/input\/fish-dataset\/Fish.csv')\ndf","1cee0f79":"new = {'Bream':0, 'Roach':1, 'Whitefish':2, 'Parkki':3, 'Perch':4, 'Pike':5, 'Smelt':6}\ndf['Species'] = df['Species'].map(new)\ndf","2ff44fa7":"import statsmodels.api as sm\ntarget = df.iloc[:, 1]\ninput = sm.add_constant(df[['Species', 'Length1', 'Length2', 'Length3', 'Height', 'Width']])\nprint(input, target)","01a05591":"B_ols = np.linalg.inv(input.T.dot(input)).dot(input.T.dot(target))\nB_ols","b3412dfa":"def pre_weight(x1,x2,x3,x4,x5, x6):\n    target_pre = B_ols[1]*x1 + B_ols[2]*x2 + B_ols[3]*x3 + B_ols[4]*x4 + B_ols[5]*x5 + B_ols[6]*x6 + B_ols[0]\n    return target_pre","af921e5d":"ex1 = pre_weight(1, 21.1, 22.5, 25, 6.4, 3.8)\nex1","4dadf6fd":"ex2 = pre_weight(2, 33.7, 36.4, 39.6, 11.7612, 6.5736)\nex2","7bcb2f09":"y_hat = pre_weight(df['Species'], df['Length1'], df['Length2'], df['Length3'], df['Height'], df['Width'])\ny_hat","37e53a0c":"r_square = 1 - sum((target - y_hat)*(target - y_hat))\/sum((target - target.mean())*(target - target.mean()))\nr_square","d990f844":"import plotly.figure_factory as ff\ndf_data = df.loc[:,['Species', 'Length1', 'Length2', 'Length3', 'Height', 'Width']]\ndf_data['index'] = np.arange(1, len(df_data)+1)\nfig = ff.create_scatterplotmatrix(df_data, diag = 'box', index = 'index')\nimport plotly.offline as pyo\npyo.plot(fig)\nfig","bf00e0cd":"<h1 style = \"color:purple; font-size:50px; text-align:center; font-weight:bolder;\">Predicting weight of fishes using Multivariate Linear Regression by Ordinary Least Square<\/h1>","3737f049":"So, I have got the list of all coefficients of the equation. Now let's define the function to predict the weight of the fish.","7534c5d1":"Now I will call the above function to predict the weight of the fish.","a249db1a":"<center>Thank you<\/center>","d84d2d89":"We have seen the equation and formula to find coefficients in the previous notebook. You can check it out once [here](https:\/\/www.kaggle.com\/omkarsantoshraut\/multivariate-linear-regression-by-gradient-descent). So, now I will directly build a model. Let's put input features and target features in two different variables in the form of matrix.","d52fe8d2":"Now I will read a csv file which contains the data about fishes.","d9deafbf":"Here, we have got the value of R<sup>2<\/sup>. It is near 1. So, we can say that this model is efficient.","10cd1dc0":"Here, I have tried to plot the scatter plot for our example.","af873d1c":"**In this notebook, I will build a model that can predict the weight of the fish by taking input as some features of the fishes such as height, width, length, etc. You can check it out in the dataset.**"}}