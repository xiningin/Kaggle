{"cell_type":{"68758c09":"code","fce0d5e8":"code","10a98f53":"code","1cbd0382":"code","e4d6413e":"code","3200f1e6":"code","028dd51b":"code","60191b1d":"code","45a6ae11":"markdown","9c32024f":"markdown","67ced2cd":"markdown","254f5e6e":"markdown"},"source":{"68758c09":"import os\nimport random\nimport tensorflow_hub as hub\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport tensorflow as tf\nimport seaborn as sns","fce0d5e8":"model = hub.load('https:\/\/tfhub.dev\/google\/magenta\/arbitrary-image-stylization-v1-256\/2')","10a98f53":"def load_image(img_path):\n    img = tf.io.read_file(img_path)\n    img = tf.image.decode_image(img, channels = 3)\n    img = tf.image.convert_image_dtype(img, tf.float32)\n    img = img[tf.newaxis,:]\n    return img","1cbd0382":"content_image = load_image('..\/input\/ffhq-face-data-set\/thumbnails128x128\/00001.png')\n\nplt.figure(figsize = (5,5))\nplt.subplot(1,1,1)\nplt.title(\"content_image\")\nplt.imshow(np.squeeze(content_image))\nplt.axis('off')","e4d6413e":"portraint_dir='..\/input\/portrait-paintings\/Images'\npaths=[]\nfor item in os.listdir(portraint_dir):\n    paths+=[os.path.join(portraint_dir,item)]\npaths[0:5]","3200f1e6":"selects=random.sample(range(len(paths)),k=9)\nselects","028dd51b":"fig,axs = plt.subplots(3,3,figsize=(15,15))\nfor i in range(9):\n    r=i\/\/3\n    c=i%3 \n    ax=axs[r][c].axis(\"off\")\n    style_image=load_image(paths[selects[i]])\n    ax=axs[r][c].imshow(np.squeeze(style_image))\nplt.show()","60191b1d":"fig,axs = plt.subplots(3,3,figsize=(15,15))\nfor i in range(9):\n    r=i\/\/3\n    c=i%3 \n    ax=axs[r][c].axis(\"off\")\n    style_image=load_image(paths[selects[i]])\n    stylized_image = model(tf.constant(content_image),tf.constant(style_image))[0]\n    ax=axs[r][c].imshow(np.squeeze(stylized_image))\nplt.show()","45a6ae11":"# Select 9 Style Images","9c32024f":"## 9 Stylized images ","67ced2cd":"# Pre-trained model","254f5e6e":"# Content Image"}}