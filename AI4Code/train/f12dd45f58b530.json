{"cell_type":{"ec09d442":"code","b491b5e1":"code","2e0dc9bb":"code","d7a8fb09":"code","b578f242":"code","59f0e0fa":"code","23712695":"code","f1dd3796":"code","ea75e8aa":"code","fe216880":"code","24294f36":"code","3230acea":"code","b103f305":"code","490d9638":"code","741c9d5a":"code","912d59f5":"code","774aa494":"markdown","37dcf0c8":"markdown"},"source":{"ec09d442":"import gc\nfrom tqdm import tqdm\nimport numpy as np\nimport pandas as pd\nfrom pylab import rcParams\nimport matplotlib.pyplot as plt\nfrom sklearn.metrics import mean_squared_error\nfrom scipy.stats import probplot\n\nimport datetime as dt\nfrom datetime import date\nfrom datetime import timedelta\nfrom fbprophet import Prophet\n\n%matplotlib inline\nimport os\nimport warnings\nwarnings.filterwarnings(\"ignore\")","b491b5e1":"data0 = pd.read_csv(\"..\/input\/ibovespa-stocks\/b3_stocks_1994_2020.csv\")\ndata0[-5:]","2e0dc9bb":"symbols=data0['ticker'].unique()\nprint(symbols[0:20])","d7a8fb09":"data1=data0[data0['ticker']=='ALP 3']\ndata1['date']=pd.to_datetime(data1['datetime'])\ndata1=data1.drop(['datetime','ticker'],axis=1).reset_index(drop=True)\ndata1","b578f242":"!pip install --upgrade mplfinance","59f0e0fa":"data1a=data1.copy()\ndata1a.index=data1a['date']\ndata1a=data1a.drop('date',axis=1)\ndata1a","23712695":"import mplfinance as mpf\nmpf.plot(data1a[-60:], type='candle',mav=(3,6))","f1dd3796":"data2=data1[['date','close']]\ndata2","ea75e8aa":"item1=data2\n\nitem1.columns = ['ds','y']\nitem1.y = item1.y.astype('float')\nitem1.ds = item1.ds.astype('datetime64')\n\nrcParams['figure.figsize'] = 20,5\nplt.plot(item1.ds, item1.y)","fe216880":"ph = Prophet()\nph.fit(item1)\nforecast1=ph.predict(item1)\nfigure = ph.plot(forecast1)\nfigure.show()","24294f36":"from datetime import timedelta\nstart0 = dt.datetime.strptime('1998-03-14','%Y-%m-%d').date()\nend0   = dt.datetime.strptime('2022-12-31','%Y-%m-%d').date()\nprint((end0-start0).days)","3230acea":"def daterange(start,end):\n    for i in range((end-start).days):\n        return start+timedelta(i)  ","b103f305":"dates0=[]\nfor i in range((end0-start0).days):\n    dates0+=[(start0+timedelta(i)).strftime('%Y-%m-%d') ]\nprint(dates0[0:10])","490d9638":"dates0_df=pd.DataFrame(dates0)\ndates0_df.columns=['ds']\ndates0_df","741c9d5a":"ph = Prophet()\nph.fit(item1)\nforecast3=ph.predict(dates0_df)\nfigure = ph.plot(forecast3)\nfigure.show()","912d59f5":"forecast3[['ds', 'yhat', 'yhat_lower', 'yhat_upper']].tail()","774aa494":"# fit past and predict past","37dcf0c8":"# fit past and predict future"}}