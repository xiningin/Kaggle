{"cell_type":{"d22f0428":"code","e331b0be":"code","e7f9cb10":"code","2ec70cde":"code","c6d0c549":"code","e04dc427":"code","ed8f95da":"code","a1f60cd2":"code","b9b53d5d":"code","86c3cbcc":"code","36cd1bf4":"code","6d3d785f":"markdown","5dd20ac1":"markdown"},"source":{"d22f0428":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt","e331b0be":"loading=pd.read_csv(\"..\/input\/train.csv\").drop('id', axis=1)\nloading2=pd.read_csv(\"..\/input\/test.csv\").drop('id',axis=1)","e7f9cb10":"y=loading['target']\nX=loading.drop('target', axis=1)\n","2ec70cde":"#Test -train splittting\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y,test_size=0.20,random_state = 0)","c6d0c549":"#from sklearn.svm import SVC\n#classifier=SVC(kernel='linear',class_weight='balanced',gamma='auto',probability=True)#This one overfit BEAUTIFULLY\nfrom sklearn.linear_model import LogisticRegression\nclassifier=LogisticRegression(class_weight='balanced',penalty='l1',C=0.1,random_state=0,solver='liblinear')#L1='Lasso',l2=\"Ridge\"\nclassifier.fit(X_train,y_train)\n#print(classifier.score(X_train,y_train))","e04dc427":"def auc_curve():\n    from sklearn import metrics\n    y_pred_proba=classifier.predict_proba(X_test)[::,1]\n    fpr,tpr,_=metrics.roc_curve(y_test,y_pred_proba)\n    auc=metrics.roc_auc_score(y_test,y_pred_proba)\n    plt.plot(fpr,tpr,label=\"auc=\"+str(auc))\n    plt.legend(loc=4)\n    plt.show()\n    return y_pred_proba\ny_pred_proba=auc_curve()","ed8f95da":"y_pred=classifier.predict(X_test)","a1f60cd2":"from sklearn.metrics import confusion_matrix\ncm=confusion_matrix(y_test,y_pred)\ncm","b9b53d5d":"    from sklearn.model_selection import cross_val_score\n    accuracies=cross_val_score(classifier,X_test,y_test,cv=10)\n    print(accuracies.mean())","86c3cbcc":"sub=pd.read_csv(\"..\/input\/sample_submission.csv\")","36cd1bf4":"sub['target']=classifier.predict_proba(loading2)[::,1]\nsub.to_csv('submission.csv', index=False)","6d3d785f":"\"\"\"State of the model fitting on Training Set\"\"\"\nfrom matplotlib.colors import ListedColormap\nX_set, y_set = X_train, y_train\nX1, X2 = np.meshgrid(np.arange(start = X_set[:, 0].min() - 1, stop = X_set[:, 0].max() + 1, step = 0.01),\n                     np.arange(start = X_set[:, 1].min() - 1, stop = X_set[:, 1].max() + 1, step = 0.01))\nplt.contourf(X1, X2, classifier.predict(np.array([X1.ravel(), X2.ravel()]).T).reshape(X1.shape),\n             alpha = 0.75, cmap = ListedColormap(('red', 'green')))\nplt.xlim(X1.min(), X1.max())\nplt.ylim(X2.min(), X2.max())\nfor i, j in enumerate(np.unique(y_set)):\n    plt.scatter(X_set[y_set == j, 0], X_set[y_set == j, 1],\n                c = ListedColormap(('yellow', 'green'))(i), label = j)\nplt.title('Model (Training Set)')\nplt.xlabel('X1')\nplt.ylabel('X2')\nplt.legend()\nplt.show()","5dd20ac1":"\"\"\"State of the model fitting on Test Set\"\"\"\nfrom matplotlib.colors import ListedColormap\nX_set, y_set = X_test, y_test\nX1, X2 = np.meshgrid(np.arange(start = X_set[:, 0].min() - 1, stop = X_set[:, 0].max() + 1, step = 0.01),\n                     np.arange(start = X_set[:, 1].min() - 1, stop = X_set[:, 1].max() + 1, step = 0.01))\nplt.contourf(X1, X2, classifier.predict(np.array([X1.ravel(), X2.ravel()]).T).reshape(X1.shape),\n             alpha = 0.75, cmap = ListedColormap(('red', 'green')))\nplt.xlim(X1.min(), X1.max())\nplt.ylim(X2.min(), X2.max())\nfor i, j in enumerate(np.unique(y_set)):\n    plt.scatter(X_set[y_set == j, 0], X_set[y_set == j, 1],\n                c = ListedColormap(('yellow', 'green'))(i), label = j)\nplt.title('Model (Training Set)')\nplt.xlabel('X1')\nplt.ylabel('X2')\nplt.legend()\nplt.show()"}}