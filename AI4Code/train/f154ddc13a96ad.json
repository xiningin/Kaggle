{"cell_type":{"fe73983d":"code","6c4acb3b":"code","0d3e5903":"code","80817456":"code","4bb01609":"code","d9b17e20":"code","8f8fd546":"code","ba26e05d":"code","6fdeabe4":"code","6cb155b8":"code","c622aefb":"code","f0c7494b":"code","a3d368c9":"code","ae6e0683":"code","1230fc57":"markdown","6aa55e46":"markdown","3dc093b8":"markdown","4c5fc6e5":"markdown","ac13a3b1":"markdown","c8abf959":"markdown"},"source":{"fe73983d":"!pip install fastai -q --upgrade","6c4acb3b":"import fastai\nprint(fastai.__version__)","0d3e5903":"from fastai.vision.all import *\npath = Path('..\/input\/star-wars-images')\npath.ls()","80817456":"def get_dls(bs, size):\n    dblock = DataBlock(blocks = (ImageBlock, CategoryBlock),\n                       get_items = get_image_files,\n                       get_y = parent_label,\n                       splitter = RandomSplitter(),\n                       item_tfms = Resize(size)\n                      )\n    return dblock.dataloaders(path, bs = bs)\n\n","4bb01609":"dls = get_dls(16, 128)","d9b17e20":"learn = cnn_learner(dls, resnet34, metrics=accuracy)","8f8fd546":"learn.lr_find()","ba26e05d":"learn = cnn_learner(dls, resnet34, metrics=accuracy)\nlearn.fit_one_cycle(10, 1e-3)","6fdeabe4":"learn.dls = get_dls(16, 224)\nlearn.fine_tune(5, 1e-3)","6cb155b8":"learn.show_results()","c622aefb":"interp = Interpretation.from_learner(learn)\ninterp.plot_top_losses(k=3)","f0c7494b":"learn.predict('..\/input\/star-wars-images\/Darth Vader\/image_20211118_161759.jpg')","a3d368c9":"learn.export(fname='model.pkl', pickle_module=pickle, pickle_protocol=2)","ae6e0683":"reload_model=load_learner('model.pkl', cpu=True, pickle_module=pickle)\nreload_model","1230fc57":"## Reload model","6aa55e46":"## Show results","3dc093b8":"## Interpretation","4c5fc6e5":"## Save model","ac13a3b1":"## Enjoy.","c8abf959":"## Predict"}}