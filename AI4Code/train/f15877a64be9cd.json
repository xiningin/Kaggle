{"cell_type":{"b713ca68":"code","a9fc5014":"code","f36a41d6":"code","efc792c3":"code","282c17a5":"code","cc414c43":"code","90c61cb8":"code","aec5375d":"code","6a6bdbd6":"code","925331f8":"code","46c87fa3":"code","110971f6":"code","ed2e0009":"code","52bca38e":"code","7ed1c54d":"code","f68e43f7":"code","4d40d201":"code","baec9685":"code","111bb59c":"code","912696f0":"code","e40b9d02":"code","655f7e2d":"code","a823adac":"code","0b3143c2":"code","6b016bb6":"code","e8752c6b":"code","93c2d7fa":"code","e12d68bb":"code","a7f1e454":"code","1cdd837e":"code","b37600a1":"code","14c5d074":"code","fde6c1e4":"code","f04d94cd":"code","ab33e8de":"code","ee9ef463":"code","68d52da4":"code","18a13e95":"code","37dc1fde":"code","6a869b10":"code","ed671ea0":"code","73160793":"code","32c5f6a9":"code","e82ac55f":"code","a0db63e9":"code","c045ee3a":"code","e929fcd9":"code","4dfd7563":"code","8769e7c8":"code","74de5741":"code","b520087a":"code","767ccbc2":"code","d19bc6f3":"code","69e26fb6":"code","562c7343":"code","bfa1018f":"code","80764b28":"code","41d43c82":"code","6196f86a":"code","54c8b6fd":"code","e48e768d":"code","bd8da0e7":"code","685d62a8":"code","3cf4a10d":"code","eec805be":"code","45309e47":"code","0b21210b":"code","ce17b084":"code","bb873964":"code","0b931a12":"code","bcf286d4":"code","bf7f77b6":"code","de4ac84c":"code","9b1a5f11":"code","c4eb27eb":"code","7311b25a":"code","5ea94721":"code","74ccc8b1":"code","25f3cc2f":"code","817d9185":"code","52568cb8":"code","3ff569b1":"code","c1cd7927":"code","0231b171":"code","7d423010":"code","a81b9625":"code","6cd061b3":"code","412373fe":"code","f2e7e73e":"code","54aafbfc":"code","9b5d9cfa":"code","c46e385b":"code","5a12bc37":"code","612d7346":"code","783c32fb":"code","e2f2ae27":"code","42d62903":"code","183ae045":"code","45b0b0dd":"code","c60e721c":"code","e492c748":"code","71d6a2b7":"code","3667d8f5":"code","5b1c5e4a":"code","d328fcde":"code","057e87b1":"code","7e5c190f":"code","30dd4f01":"code","121d11ea":"code","d3be7af6":"code","067b50cb":"code","8bef16d4":"code","e6bd6670":"code","add69716":"code","2cc6627e":"code","0f3ac5e8":"code","b949217f":"code","dead3fdf":"code","f49143f9":"code","85650fe2":"code","ffe58aa3":"code","830b37ef":"code","a4bdfd58":"code","557a68cf":"code","a5efcd45":"code","b3944434":"code","c04c736d":"code","7f8b2831":"code","50b9ce76":"code","cacd1d43":"code","5b5fd85c":"code","004d6be7":"code","fac3aa09":"code","fd8a18b1":"code","3f4beddc":"code","aae95622":"code","b0106f08":"code","850bccb1":"code","dd8925fd":"code","4aaa95e1":"code","29549c1c":"code","64dc29bb":"code","9dfabf11":"code","6a1fcb6d":"code","5cd45ce8":"code","e2c5ad32":"code","0dea3135":"code","22413405":"code","20873572":"markdown","5d6df7cf":"markdown","b2f5e05e":"markdown","d53f31ee":"markdown","f02286ee":"markdown","2f6c6845":"markdown","aff1c8f7":"markdown","97e9df3a":"markdown","327a9ff7":"markdown","6bfafd60":"markdown","bbaa0766":"markdown","bef84694":"markdown","a03d1715":"markdown","b00efb14":"markdown","2b9fcb0d":"markdown","786cdf42":"markdown","f468f9c3":"markdown","8dfc1d36":"markdown","59509093":"markdown","de6e04ce":"markdown","e6b7b4c0":"markdown","44dee18b":"markdown","0e83b3a8":"markdown","a24385de":"markdown","ab5681c2":"markdown","e688d042":"markdown","d6e8315a":"markdown","dc212d96":"markdown","5c278fc6":"markdown","b21a157e":"markdown","ad78fd9d":"markdown","9e0c13bd":"markdown","2a49c4d8":"markdown","a6699b78":"markdown","604951f8":"markdown","b8f926e1":"markdown","08a7c59e":"markdown","d466e6a4":"markdown","d134bbc9":"markdown","44e5a6f0":"markdown","61e34e7b":"markdown","d6012728":"markdown","667cf761":"markdown","e4364162":"markdown","42e6ac74":"markdown","4d58d12a":"markdown","cde80a8a":"markdown","f783545f":"markdown","75ea3c03":"markdown","b19762fa":"markdown","cdedaea0":"markdown","00eafe76":"markdown","3f5e2a03":"markdown","6765e22a":"markdown","00fb63c4":"markdown","7a301af9":"markdown","9fdb4f77":"markdown","46689893":"markdown","a71e25ee":"markdown","b82b4b69":"markdown","3c649d9d":"markdown","6b4bc7f1":"markdown","60c01a25":"markdown","1f068955":"markdown","48228cdb":"markdown","86fe9589":"markdown","26a74b4a":"markdown","e4c28123":"markdown","5c9dc357":"markdown","7f8be571":"markdown","1a4b28bb":"markdown","87d26884":"markdown","8cbc0a51":"markdown","fd023745":"markdown","21835eee":"markdown","3ed070da":"markdown","e2745a54":"markdown","b012f4e2":"markdown","cac06b49":"markdown","e2413b23":"markdown","54a115dd":"markdown","c89a799b":"markdown","fac23ebb":"markdown","879c6eb5":"markdown","817e7e91":"markdown","70bca0bf":"markdown","edecfac6":"markdown","cc131724":"markdown","2f1456e2":"markdown","badcf056":"markdown","d5952b25":"markdown","8a68bccd":"markdown","f5e83e13":"markdown","e7a4ff05":"markdown","bf58fcd0":"markdown","3c6b109d":"markdown","0ad44ba8":"markdown","8dc951fd":"markdown","f564e709":"markdown","69b3b4eb":"markdown","76391420":"markdown","d89f1744":"markdown","80acc48b":"markdown","c5bf853e":"markdown","016da577":"markdown","5e5b1f27":"markdown","5e2c17b1":"markdown","5ba870f7":"markdown","62bfc5a1":"markdown","85ab4ab9":"markdown","234d92a0":"markdown","d123465c":"markdown","2c72a55d":"markdown","7d01a834":"markdown","6c6293d0":"markdown","c0070ae6":"markdown","d18abab7":"markdown","88d2390d":"markdown","f76476cc":"markdown","3fd7a724":"markdown","be91b14b":"markdown","bb946570":"markdown","940bf6ef":"markdown","9a924f6d":"markdown","516cf4eb":"markdown","b1024172":"markdown","61648a25":"markdown","0530da64":"markdown","9acab685":"markdown","1123450d":"markdown","c2c1b66f":"markdown","045d2d78":"markdown","d212c18a":"markdown","f10aca4c":"markdown","d01aed0a":"markdown","caf0f593":"markdown","46b867d7":"markdown","56ce7712":"markdown","d3ebc76f":"markdown","a621db43":"markdown","8c950bd7":"markdown","b958175f":"markdown","0049820a":"markdown","ac1147a2":"markdown","8d2ad8f3":"markdown","56ed6423":"markdown","eb99e1fc":"markdown","ee4c335b":"markdown","9561a0c5":"markdown","010878e7":"markdown","9a303d7e":"markdown","c6e9da30":"markdown","dc26afb1":"markdown","d9c7841a":"markdown","65868f6b":"markdown","9ac75a71":"markdown","2fc0b34b":"markdown","7a15a3e1":"markdown","eee26ac6":"markdown","5e86515a":"markdown","c15c14a7":"markdown","7b76a40a":"markdown","178c78cf":"markdown","a7d63793":"markdown"},"source":{"b713ca68":"# !pip install geopandas\n# !pip install pyproj==1.9.6\n# !pip install geos\n# !pip install https:\/\/github.com\/matplotlib\/basemap\/archive\/master.zip\n# !pip install wordcloud","a9fc5014":"%matplotlib inline","f36a41d6":"import math\nimport numpy as np\nimport pandas as pd\nimport geopandas as gpd\n\nimport matplotlib.pyplot as plt\nimport matplotlib.cm as cm\n\nfrom mpl_toolkits.basemap import Basemap\nimport seaborn as sns\n\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.decomposition import PCA\nfrom sklearn.metrics import silhouette_samples, silhouette_score\nfrom sklearn.cluster import KMeans, AgglomerativeClustering, DBSCAN\nfrom sklearn import metrics\n\nfrom scipy.cluster.hierarchy import linkage, dendrogram\nfrom scipy.spatial import distance_matrix\nfrom datetime import datetime\n\nfrom os import path\nfrom PIL import Image\nfrom wordcloud import WordCloud, STOPWORDS, ImageColorGenerator","efc792c3":"pd.set_option('display.max_columns', None)\n# pd.set_option('display.max_rows', None)","282c17a5":"property_sales = gpd.read_file('..\/input\/property-sales-2002-2005-1-1.geo')\n# property_sales = gpd.read_file('https:\/\/query.data.world\/s\/fnwqogypfnsbz5m6nau7v4bwbbrfyi')","cc414c43":"property_sales.shape","90c61cb8":"property_sales.dtypes","aec5375d":"property_sales.columns = ['object_id', 'crv', 'pin', 'sale_date', 'in_rto_study', 'neighborhood','ward', 'prop_type', 'address', 'house_number', 'house_number_2', 'prefix_direction', 'street_name', 'street_type', 'suffix_direction', 'grantee', 'grantor', 'adjusted_sale_price', 'gross_sale_price', 'sale_date_2', 'downpayment', 'x', 'y', 'geometry']","6a6bdbd6":"property_sales.crv.duplicated().tail()","925331f8":"property_sales.tail()","46c87fa3":"property_sales[property_sales.crv == 798354.0]","110971f6":"property_sales_deduped = property_sales\nproperty_sales_deduped.sort_values(by=['crv'], inplace = True)","ed2e0009":"property_sales_deduped.drop_duplicates(subset = ['crv'], keep = False, inplace = True) \nproperty_sales_deduped.drop_duplicates(subset = ['pin'], keep = False, inplace = True) ","52bca38e":"property_sales_deduped.crv.duplicated().any()","7ed1c54d":"property_sales_deduped.pin.duplicated().any()","f68e43f7":"property_sales_deduped.sort_values(by=['object_id'], inplace = True)\nproperty_sales = property_sales_deduped.sort_index()","4d40d201":"property_sales.shape","baec9685":"len(property_sales.object_id.unique())","111bb59c":"len(property_sales.crv.unique())","912696f0":"len(property_sales.pin.unique())","e40b9d02":"len(property_sales.in_rto_study.unique())","655f7e2d":"property_sales[property_sales.in_rto_study.isna()].shape","a823adac":"ward_value_counts = property_sales.in_rto_study.value_counts(sort = False).plot.bar()","0b3143c2":"property_sales[property_sales.ward.isna()].shape","6b016bb6":"len(property_sales.ward.unique()) ","e8752c6b":"plt.figure(figsize=(12,5))\nward_value_counts = property_sales.ward.value_counts(sort = False).plot.bar()","93c2d7fa":"property_sales[property_sales.address.isna()].shape","e12d68bb":"len(property_sales.address.unique())","a7f1e454":"property_sales.address.unique()","1cdd837e":"property_sales.house_number.unique()","b37600a1":"len(property_sales.house_number.unique())\/len(property_sales)","14c5d074":"property_sales.house_number_2.unique()","fde6c1e4":"property_sales[property_sales.street_name.isna()].shape","f04d94cd":"len(property_sales.street_name.unique())","ab33e8de":"plt.figure(figsize=(140,20))\nproperty_sales.street_name.value_counts(sort = True).plot.bar()","ee9ef463":"property_sales[property_sales.neighborhood.isna()].shape","68d52da4":"len( property_sales.neighborhood.unique())","18a13e95":" property_sales.neighborhood.value_counts(sort=False)","37dc1fde":"plt.figure(figsize=(140,20))\nproperty_sales.neighborhood.value_counts(sort=True).plot.bar()","6a869b10":"property_sales[property_sales.prop_type.isna()].shape","ed671ea0":"len(property_sales.prop_type.unique())","73160793":"property_sales.prop_type.value_counts(sort=False).plot.bar()","32c5f6a9":"property_sales[property_sales.prefix_direction.isna()].shape","e82ac55f":"len(property_sales.prefix_direction.unique())","a0db63e9":"property_sales.prefix_direction.value_counts(sort=False).plot.bar()","c045ee3a":"property_sales[property_sales.street_type.isna()].shape","e929fcd9":"len(property_sales.street_type.unique())","4dfd7563":"property_sales.street_type.unique()","8769e7c8":"property_sales[property_sales['street_type'] == 'NULL'].shape ","74de5741":"property_sales.street_type.value_counts(sort=False).plot.bar()","b520087a":"property_sales.suffix_direction.unique()","767ccbc2":"property_sales[property_sales['suffix_direction'] == 'NULL'].shape","d19bc6f3":"len(property_sales[property_sales['suffix_direction'] == 'NULL'])\/len(property_sales) # 5% of the data is NULL","69e26fb6":"property_sales.suffix_direction.value_counts(sort=False).plot.bar()","562c7343":"property_sales[property_sales['sale_date'] != property_sales['sale_date_2']].shape","bfa1018f":"property_sales['sale_date'] = property_sales['sale_date'].apply(pd.to_datetime)","80764b28":"property_sales['year'] = property_sales.sale_date.dt.year","41d43c82":"property_sales.year.unique()","6196f86a":"plt.hist(property_sales.year, bins = 4)","54c8b6fd":"property_sales['month'] = property_sales['sale_date'].dt.month","e48e768d":"property_sales.month.unique()","bd8da0e7":"plt.hist(property_sales.month, bins = 12)","685d62a8":"property_sales['day'] = property_sales['sale_date'].dt.day","3cf4a10d":"plt.hist(property_sales.day, bins=31)","eec805be":"property_sales.grantee.unique()","45309e47":"property_sales[property_sales.grantee.isna()].shape","0b21210b":"len(property_sales.grantee.unique())\/len(property_sales)","ce17b084":"property_sales.grantor.unique()","bb873964":"property_sales[property_sales.grantor.isna()].shape","0b931a12":"len(property_sales.grantor.unique())\/len(property_sales)","bcf286d4":"property_sales.gross_sale_price.unique()","bf7f77b6":"property_sales[property_sales.gross_sale_price.isna()].shape","de4ac84c":"min(property_sales.gross_sale_price)","9b1a5f11":"property_sales.gross_sale_price = property_sales.gross_sale_price.fillna(-1)","c4eb27eb":"len(property_sales[property_sales.gross_sale_price == 0].gross_sale_price)\/len(property_sales)","7311b25a":"property_sales.gross_sale_price.unique()","5ea94721":"property_sales.gross_sale_price.value_counts(sort=True) #.plot.bar()","74ccc8b1":"property_sales.adjusted_sale_price.unique()","25f3cc2f":"property_sales[property_sales.adjusted_sale_price.isna()].shape","817d9185":"len(property_sales[property_sales.adjusted_sale_price < 0])","52568cb8":"property_sales.adjusted_sale_price = property_sales.adjusted_sale_price.fillna(-1)","3ff569b1":"property_sales.adjusted_sale_price.value_counts(sort=False)#.plot.bar()","c1cd7927":"property_sales[property_sales.adjusted_sale_price < 0].head()","0231b171":"property_sales.downpayment.unique()","7d423010":"len(property_sales[property_sales.downpayment == 'NULL'])\/len(property_sales) # 5% of the data is NULL","a81b9625":"property_sales[property_sales.geometry.isna()].shape","6cd061b3":"property_sales['lat'] = property_sales.geometry.x","412373fe":"property_sales['lon'] = property_sales.geometry.y","f2e7e73e":"# import warnings\n# warnings.filterwarnings('ignore')\n\n# figure = plt.figure(figsize=(15,15))\n# current_axis = figure.add_subplot(111)\n\n# map = Basemap(llcrnrlon=-93.356022, llcrnrlat=44.874466, urcrnrlon=-93.174347, urcrnrlat=45.063683, \\\n#               resolution='i', lat_0 = 46.392410, lon_0 = -94.636230, width=100, height=200)\n# map.fillcontinents(color = \"white\", lake_color = \"#7777ff\", ax = current_axis)\n\n# earth_x, earth_y = map(property_sales.lat.tolist(), property_sales.lon.tolist())\n\n# map.scatter(earth_x, earth_y, color=\"darkgreen\", s = 1, zorder=10)\n# map.drawmapboundary(fill_color = \"#7777ff\")\n# map.drawstates()\n# map.drawcountries()\n# map.drawrivers()\n\n# plt.xlabel(\"Latitude\")\n# plt.ylabel(\"Longitude\")\n# plt.title(\"Properties Sold in Minnessota, 2002-2005\")\n\n# plt.show()","54aafbfc":"property_sales.shape","9b5d9cfa":"columns_for_removal = ['object_id', 'crv', 'pin', 'address', 'house_number', 'house_number_2', 'prefix_direction', \\\n                       'street_name', 'street_type', 'suffix_direction', 'sale_date_2', 'sale_date', 'year', 'month', \\\n                       'day', 'grantee', 'grantor', 'downpayment', 'x', 'y', 'geometry', 'adjusted_sale_price']","c46e385b":"property_sales_data = property_sales.drop(columns=columns_for_removal, axis=1)","5a12bc37":"property_sales_data.head()","612d7346":"property_sales_data.shape","783c32fb":"property_sales_data_dummies = pd.get_dummies(property_sales_data)","e2f2ae27":"property_sales_data_dummies.shape","42d62903":"property_sales_data_dummies.describe().T","183ae045":"scaler = MinMaxScaler()","45b0b0dd":"scaler.fit(property_sales_data_dummies)","c60e721c":"property_sales_data_dummies_scaled = scaler.transform(property_sales_data_dummies)","e492c748":"pca = PCA().fit(property_sales_data_dummies_scaled)","71d6a2b7":"property_sales_data_dummies_scaled_transformed = pca.transform(property_sales_data_dummies_scaled)","3667d8f5":"pca.explained_variance_ratio_","5b1c5e4a":"property_sales_data_dummies_scaled_transformed_reduced = property_sales_data_dummies_scaled_transformed[:, :2]","d328fcde":"property_sales_data_dummies_scaled_transformed_reduced.shape","057e87b1":"def plot_clusters(data, cluster_ids, title):\n    \"\"\"Plots clustered data in 2D format. \n\n    Parameters:\n    data (int): 2D data which will be scattered\n    cluster_ids: an array of cluster ids\n    title: Plot title\n   \"\"\"\n    plt.figure(figsize = (12,10))\n    plt.scatter(data[:, 0], data[:, 1], c = cluster_ids)\n    plt.title(title)\n    plt.show()","7e5c190f":"# Based on: https:\/\/scikit-learn.org\/stable\/auto_examples\/cluster\/plot_kmeans_silhouette_analysis.html\n\ndef plot_kmeans_cluster_silhouette_profiles(data, clusters, clusterer):\n\n    X = data\n    cluster_labels = clusters\n    # Labeling the clusters\n    centers = clusterer.cluster_centers_\n    n_clusters = len(centers)\n\n    # Create a subplot with 1 row and 2 columns\n    fig, (ax1, ax2) = plt.subplots(1, 2)\n    fig.set_size_inches(18, 7)\n\n    # The 1st subplot is the silhouette plot\n    # The silhouette coefficient can range from -1, 1 but in this example all\n    # lie within [-0.1, 1]\n    ax1.set_xlim([-0.1, 1])\n    # The (n_clusters+1)*10 is for inserting blank space between silhouette\n    # plots of individual clusters, to demarcate them clearly.\n    ax1.set_ylim([0, len(X) + (n_clusters + 1) * 10])\n\n\n\n    # The silhouette_score gives the average value for all the samples.\n    # This gives a perspective into the density and separation of the formed\n    # clusters\n    silhouette_avg = silhouette_score(X, cluster_labels)\n\n    # Compute the silhouette scores for each sample\n    sample_silhouette_values = silhouette_samples(X, cluster_labels)\n\n    y_lower = 10\n    for i in range(n_clusters):\n        # Aggregate the silhouette scores for samples belonging to\n        # cluster i, and sort them\n        ith_cluster_silhouette_values = \\\n            sample_silhouette_values[cluster_labels == i]\n\n        ith_cluster_silhouette_values.sort()\n\n        size_cluster_i = ith_cluster_silhouette_values.shape[0]\n        y_upper = y_lower + size_cluster_i\n\n        color = cm.nipy_spectral(float(i) \/ n_clusters)\n        ax1.fill_betweenx(np.arange(y_lower, y_upper),\n                          0, ith_cluster_silhouette_values,\n                          facecolor=color, edgecolor=color, alpha=0.7)\n\n        # Label the silhouette plots with their cluster numbers at the middle\n        ax1.text(-0.05, y_lower + 0.5 * size_cluster_i, str(i))\n\n        # Compute the new y_lower for next plot\n        y_lower = y_upper + 10  # 10 for the 0 samples\n\n    ax1.set_title(\"The silhouette plot for the various clusters.\")\n    ax1.set_xlabel(\"The silhouette coefficient values\")\n    ax1.set_ylabel(\"Cluster label\")\n\n    # The vertical line for average silhouette score of all the values\n    ax1.axvline(x=silhouette_avg, color=\"red\", linestyle=\"--\")\n\n    ax1.set_yticks([])  # Clear the yaxis labels \/ ticks\n    ax1.set_xticks([-0.1, 0, 0.2, 0.4, 0.6, 0.8, 1])\n\n    # 2nd Plot showing the actual clusters formed\n    colors = cm.nipy_spectral(cluster_labels.astype(float) \/ n_clusters)\n    ax2.scatter(X[:, 0], X[:, 1], marker='.', s=30, lw=0, alpha=0.7,\n                c=colors, edgecolor='k')\n\n\n    # Draw white circles at cluster centers\n    ax2.scatter(centers[:, 0], centers[:, 1], marker='o',\n                c=\"white\", alpha=1, s=200, edgecolor='k')\n\n    for i, c in enumerate(centers):\n        ax2.scatter(c[0], c[1], marker='$%d$' % i, alpha=1,\n                    s=50, edgecolor='k')\n\n    ax2.set_title(\"The visualization of the clustered data.\")\n    ax2.set_xlabel(\"Feature space for the 1st feature\")\n    ax2.set_ylabel(\"Feature space for the 2nd feature\")\n\n    plt.suptitle((\"Silhouette analysis for KMeans clustering on sample data \"\n                  \"with n_clusters = %d\" % n_clusters),\n                 fontsize=14, fontweight='bold')\n\n    plt.show()","30dd4f01":"def plot_dendrogram(agglomerative_linkage, title):\n    plt.figure(figsize = (12,10))\n    dendrogram(agglomerative_linkage, leaf_rotation=0, orientation='right')\n    \n    ax = plt.gca()\n    bounds = ax.get_ybound()\n    ax.plot([1.1,1.1],bounds,'--', c='k', )\n    plt.title(title)\n    plt.show()","121d11ea":"def create_dbscan_diagram_title(dbscan_cluster_number, dbscan_eps, dbscan_min_samples):\n    return \"Density Based (DBSCAN) Clusters: Clusters {}, for eps={}, min_samples={}\"\\\n                .format(dbscan_cluster_number, dbscan_eps, dbscan_min_samples)","d3be7af6":"plt.figure(figsize = (10,10))\nplt.scatter(property_sales_data_dummies_scaled_transformed_reduced[:, 0], \n            property_sales_data_dummies_scaled_transformed_reduced[:, 1])\nplt.xlabel(\"Feature 0\")\nplt.ylabel(\"Feature 1\")\nplt.title(\"Attempt to Visually Identify Clusters Plotting the Two PCA Features\")\nplt.show()","067b50cb":"inertias = []\nfor i in range(1, 11):\n    km = KMeans(n_clusters = i)\n    km.fit(property_sales_data_dummies_scaled_transformed_reduced)\n    inertias.append(km.inertia_)","8bef16d4":"plt.figure(figsize = (12,10))\nplt.plot(range(1, 11), inertias, marker = \"o\")\nplt.xlabel(\"Number of clusters\")\nplt.ylabel(\"Inertia\")\nplt.title(\"KMeans++ Clustering: Elbow Method\")\nplt.show()","e6bd6670":"for number_of_clusters in [3, 4, 5]:\n    kmeans_clusterer = KMeans(n_clusters = number_of_clusters)\n    kmeans_clusterer.fit(property_sales_data_dummies_scaled_transformed_reduced)\n    kmeans_clusters = kmeans_clusterer.predict(property_sales_data_dummies_scaled_transformed_reduced)\n    plot_kmeans_cluster_silhouette_profiles(property_sales_data_dummies_scaled_transformed_reduced, \\\n                                        kmeans_clusters, kmeans_clusterer)","add69716":"default_agglomerative_linkage = linkage(property_sales_data_dummies_scaled_transformed_reduced, \\\n                                    method = \"complete\", metric = \"euclidean\")\n\nplot_dendrogram(default_agglomerative_linkage, \"Agglomerative Clustering Dendrogram of Sold Properties\")","2cc6627e":"g = sns.clustermap(property_sales_data_dummies_scaled_transformed_reduced, \\\n                   method=\"complete\", col_cluster=False,\\\n                   cmap=\"Paired\", robust = True, figsize=(12, 10))","0f3ac5e8":"for dbscan_eps in [0.1, 0.3, 0.5, 0.7]:\n    for dbscan_min_samples in [5, 50, 200, 1000, 10000]:\n        \n        dbscan = DBSCAN(eps = dbscan_eps, min_samples = dbscan_min_samples)\\\n                            .fit(property_sales_data_dummies_scaled_transformed_reduced)\n        \n        dbscan_clusters = dbscan.labels_\n\n        dbscan_cluster_number = len(pd.Series(dbscan_clusters).unique().tolist())\n\n        plot_clusters(property_sales_data_dummies_scaled_transformed_reduced, dbscan_clusters, \n              create_dbscan_diagram_title(dbscan_cluster_number, dbscan_eps, dbscan_min_samples))","b949217f":"def clustered_samples(data, clusters):\n    clustered_data = data\n    clustered_data['cluster'] = clusters\n    return clustered_data","dead3fdf":"def create_cluster_name(cluster, category):\n    size = len(cluster[cluster.cluster == category])\n    ratio = (size \/ len(cluster)) * 100\n    title = \"Cluster {} [size: {}, ratio: {:.2f}%]\".format(category, size, ratio)\n    return title","f49143f9":"def print_cluster_info(cluster):\n    categories = pd.Series(cluster.cluster).unique()\n    for category in categories:\n        print(create_cluster_name(cluster, category))","85650fe2":"def plot_clustered_properties_by_geo_location(data, title):\n    \"\"\"Plots clustered data using geo coordinates (without plotting the map itself). \n    The assumptions is that the number of records in the `property_sales_data` must match those in \n    `predicted_clusters`.\n    \n    Parameters:\n    property_sales_data: Dataset which contains geo coordinates of sold properties\n    predicted_clusters: The cluster type of a property\n    title: Plot title\n    \"\"\"\n    plt.figure(figsize = (12, 10))\n    sns.scatterplot(data.lat, data.lon, hue = data.cluster, \n                palette = sns.color_palette('hls', np.unique(data.cluster).shape[0]))\n    plt.title(title)\n    plt.show()","ffe58aa3":"def plot_clustered_properties_by_geo_location_in_separate_plot(data, feature_x_axis, feature_y_axis):\n    sns.lmplot(feature_x_axis, feature_y_axis, data=data, hue=\"cluster\", fit_reg = False, \n               col = 'cluster', col_wrap=2)","830b37ef":"def convert_clustered_samples_to_text(clustered_data):\n    x = clustered_data.to_string(header=False,\n                                 index=False,\n                                 index_names=False,\n                                 formatters={\n                                     \"ward\": lambda x: \"ward_{}\".format(x),\n                                     \"neighborhood\": lambda x: x.replace(\" \", \"\"),\n                                     \"prop_type\": lambda x: x.replace(\" \", \"\"),\n                                     \"gross_sale_price\": lambda x: \"${:,.0f}grs_price\".format(x),\n                                     \"position\" : lambda point : \"({:.2f},{:.2f})\".format(point.x, point.y),\n                                     # ignoring features below:\n                                     \"in_rto_study\": lambda x: \"\",\n                                     \"cluster\" : lambda x: \"\",\n                                     \"category\": lambda x: \"\",\n                                     \"lat\" : lambda x : \"\",\n                                     \"lon\": lambda x: \"\"\n                                 }).split('\\n')\n    lines = [' '.join(ele.split()) for ele in x]\n    text = \" \".join(line for line in lines)\n    return text","a4bdfd58":"def create_wordcloud(text):\n    stopwords = set(STOPWORDS)\n    stopwords.update(['hbhd', 'ward', 'lat', 'lon', 'POINT'])\n    wordcloud = WordCloud(stopwords=stopwords, background_color=\"white\", \\\n                          collocations = False, max_font_size=40,\n                          max_words=30).generate(text)\n    # print(wordcloud.words_)\n    return wordcloud","557a68cf":"def plot_wordcloud(wordcloud, title):\n    plt.imshow(wordcloud, interpolation='bilinear')\n    plt.axis(\"off\")\n    plt.title(title, fontsize=20)\n    plt.show()","a5efcd45":"def plot_wordcloud_for_clusters(data):   \n    clusters = pd.Series(data.cluster).unique()\n    for cluster in clusters:\n        cluster_title = create_cluster_name(data, cluster)\n        text = convert_clustered_samples_to_text(data)\n        wordcloud = create_wordcloud(text)\n        plot_wordcloud(wordcloud, cluster_title)","b3944434":"def plot_geolocation_and_wordcloud_for_clusters(data, title):  \n    clusters = pd.Series(data.cluster).unique()\n    clusters_number = len(clusters)\n    diagrams_number = 2\n\n    fig = plt.figure(figsize=(30,45))\n    plot_index = 1\n    plt.title(title, fontsize=25, fontweight='bold', pad=20)\n    plt.axis(\"off\")\n    \n    for cluster_number in range(1,clusters_number+1):\n        cluster_index = cluster_number - 1\n        clustered_samples = data[data.cluster == cluster_index]\n        cluster = data[data.cluster == cluster_index].cluster\n        \n        cluster_title = create_cluster_name(data, cluster_index)\n        \n        axisId1 = clusters_number*100 + diagrams_number*10 + plot_index\n        plot_index = plot_index + 1\n        ax1 = fig.add_subplot(axisId1)\n  \n        colour = cm.nipy_spectral(float(cluster_index) \/ clusters_number)\n        sns.scatterplot(clustered_samples.lat, clustered_samples.lon, hue = cluster, \n                        ax=ax1, facecolor= colour, edgecolor=colour, alpha=0.7)\n        ax1.set_title(cluster_title, fontsize=14, fontweight='bold')\n        \n        axisId2 = clusters_number*100 + diagrams_number*10 + plot_index\n        plot_index = plot_index + 1\n        \n        ax2 = fig.add_subplot(axisId2)\n        \n        # print(\"Cluster: {}\".format(cluster_index))\n        text = convert_clustered_samples_to_text(clustered_samples)\n        wordcloud = create_wordcloud(text)\n        ax2.imshow(wordcloud, interpolation='bilinear')\n        ax2.axis(\"off\")","c04c736d":"def pivot_plot(clustered_data, index_feature, x_label, fig_size_x, fig_size_y):\n    sns.set(rc={'figure.figsize':(fig_size_x,fig_size_y)})\n    pd.pivot_table(clustered_data, \n                   index = [index_feature], \n                   columns= 'cluster', \n                   values=['gross_sale_price'],\n                   fill_value= 0,\n                   aggfunc=np.sum)\\\n        .plot(kind='bar')\n\n    plt.xlabel(x_label)\n    plt.ylabel('Gross Sale Price')\n    plt.title('Pivot Plot: Cluster Gross Price Comparison by '+ x_label)","7f8b2831":"def default_sized_pivot_plot(clustered_data, index_feature, x_label):\n    fig_size_x = 20\n    fig_size_y = 10\n    pivot_plot(clustered_data, index_feature, x_label, fig_size_x, fig_size_y)","50b9ce76":"def pivot_plot_aggregated_data(data, aggregation):\n    sns.set(rc={'figure.figsize':(10,5)})\n    pivot_table = pd.pivot_table(data, \n                                index = ['cluster'], \n                               columns= 'cluster', \n                               values=['total'],\n                               fill_value= 0)\\\n                    .plot(kind='bar')\n\n    plt.xlabel('Cluster')\n    plt.ylabel('{} Gross Sale Price ($)'.format(aggregation))\n    plt.title('Pivot Plot: Cluster Gross Price Comparison by {} Gross Price'.format(aggregation))","cacd1d43":"kmeans_clusterer_4_clusters = KMeans(n_clusters = 4)\nkmeans_clusterer_4_clusters.fit(property_sales_data_dummies_scaled_transformed_reduced)\nkmeans_4_clusters = kmeans_clusterer_4_clusters.predict(property_sales_data_dummies_scaled_transformed_reduced)","5b5fd85c":"agglomerative_clusterer_4_clusters = AgglomerativeClustering(n_clusters=4)\nagglomerative_clusterer_4_clusters.fit(property_sales_data_dummies_scaled_transformed_reduced)\nagglomerative_4_clusters = agglomerative_clusterer_4_clusters.labels_","004d6be7":"dbscan_clusterer_4_clusters = DBSCAN(eps=0.3, min_samples=200).fit(property_sales_data_dummies_scaled_transformed_reduced)\ndbscan_4_clusters = dbscan_clusterer_4_clusters.labels_","fac3aa09":"clustered_property_sales_data_kmeans = clustered_samples(property_sales_data, kmeans_4_clusters)","fd8a18b1":"clustered_property_sales_data_aggl = clustered_samples(property_sales_data, agglomerative_4_clusters)","3f4beddc":"clustered_property_sales_data_dbscan = clustered_samples(property_sales_data, dbscan_4_clusters)","aae95622":"print_cluster_info(clustered_property_sales_data_kmeans)","b0106f08":"print_cluster_info(clustered_property_sales_data_aggl)","850bccb1":"print_cluster_info(clustered_property_sales_data_dbscan)","dd8925fd":"np.array_equal(clustered_property_sales_data_kmeans['cluster'].tolist(), \n               clustered_property_sales_data_aggl['cluster'].tolist())","4aaa95e1":"np.array_equal(clustered_property_sales_data_kmeans['cluster'].tolist(), \n               clustered_property_sales_data_dbscan['cluster'].tolist())","29549c1c":"plot_clustered_properties_by_geo_location(clustered_property_sales_data_kmeans, \n                                          \"KMeans++ Clustering of Sold Properties: 4 Clusters\")","64dc29bb":"plot_clustered_properties_by_geo_location_in_separate_plot(clustered_property_sales_data_kmeans, 'lat', 'lon')","9dfabf11":"plot_geolocation_and_wordcloud_for_clusters(clustered_property_sales_data_kmeans, \n                                            \"Properties Sales Clusters: n_clusters=4\")","6a1fcb6d":"default_sized_pivot_plot(clustered_property_sales_data_kmeans, 'prop_type', 'Property Type')","5cd45ce8":"default_sized_pivot_plot(clustered_property_sales_data_kmeans, 'ward', 'Ward')","e2c5ad32":"fig_size_x = 140\nfig_size_y = 20\n\npivot_plot(clustered_property_sales_data_kmeans, 'neighborhood', 'Neighbourhood', fig_size_x, fig_size_y)","0dea3135":"gross_price_sum = clustered_property_sales_data_kmeans.groupby('cluster')\\\n                    .gross_sale_price.sum()\\\n                    .reset_index(name='total')\n\npivot_plot_aggregated_data(gross_price_sum, 'Total')","22413405":"gross_price_mean = clustered_property_sales_data_kmeans.groupby('cluster')\\\n                    .gross_sale_price.mean()\\\n                    .reset_index(name='total')\n\npivot_plot_aggregated_data(gross_price_mean, 'Mean')","20873572":"Apparently, perhaps due to the structure of the data (i.e. well defined groups without overlapping), the sizes of the clusters produced by each of the algorithms are the same.","5d6df7cf":"KMeans++ clustering algorithm expects number of clusters to be provided upfront. \n\nIn order to select the most optimal number of clusters which properties sales dataset could be organised into, we will first calculate cluster intertias for the various configuration in terms of numbers of clusters and then apply the Elbow Method to define the most optimal clusters configuration (if the intertias\/elbow function is good enough to alow it).","b2f5e05e":"#### Functions for Pivot Plots","d53f31ee":"It does not look like we will need `sale_date` and `year` properties, so we are going to remove them from the feature set as well.","f02286ee":"Another approach which could be used for finding the optimal number of clusters for a given dataset using the KMeans++ Clustering approach is the Silhouette Profiles, where such number of clusters is sought for which the distances of the points in the clusters to the centroid of the cluster are fairly equal, as well as the size of the clusters is ideally the same.\n\nWe will analyse the silhouette profiles of the various number of clusters in order to prove that `4` seems to be the best choice.","2f6c6845":"##### `crv`","aff1c8f7":"Now-a-days property market is hard to be imagined without the usage of information technologies and yet too few actors on the market use data-driven approach when purchasing new properties. One of the advantages of the age we are living in is the abundance of data available to us and the data-processing tools which are at our disposal which we could use to harness the insights we could find in that data.\n\nThe Minneapolis Assessor's Office tracks and records every real property transaction in the city as also it makes this information public. The goal of this work is to use the means of Machine Learning clustering and to establish a standarised way of identifying what are the key factors which defines the property market structure and help real estate agents, investors and future buyers take better informed decisions.\n\nAt the moment on the market there are close to none analisys on the properties sales market. This research found only two public analysis on the property data [Minneapolis Area Realtors Market Data](https:\/\/www.mplsrealtor.com\/market-data\/) and [Grouping Minnesota Cities Using Cluster Analysis](https:\/\/www.house.leg.state.mn.us\/hrd\/pubs\/groupmncity.pdf). The first one uses rather vanila statistics analysis to find insights for the trend on the market, while the latter applies clustered and non-clustered analysis but rather for Minnesota cities. \n\nThe rest of the document is organised in several sections as follows: _Methodology_ section briefly describes what Machine Learning tools are used for the clustering analysis of the property data and how they are applied; _Data Pre-processing_ part of this document follows all steps for data preparation and sanitisation; _Finding Optimal Number of Clusters_ is the core of this work, where various Machine Learning clustering algorithms are employed to find the best organisation of the property sales in clusters; _Clustering Results: Analysis_ attempts to categorise the clusters found in order to provide a mental map to the potential consumers of this study through the property market of the city; _Conclusions_ part of this document sumarises the findings from the analysis in the previous section; in _Future Work_ a few ideas for improvement and further development of this study are listed.","97e9df3a":"One approach to analyse the clustered data is to convert its feautres to text and analyse statistically which are the most frequent words\/strings met in the text for each cluster. \n\nThe auxilliary function we have defined above `convert_clustered_samples_to_text(...)` does exactly that, as the features which are not defining the properties in a cluster such as `in_rto_study`, `latitude` and `longitude` are excluded, and those which are used are the following:\n* `ward`\n* `neighborhood`\n* `prop_type`\n* `gross_sale_price`","327a9ff7":"This work attempts to create a framework for clustering analysis using publicly available property sales data from Minneapolis, Minnesota, USA, for the period 2002-2005. The goal is to establish a scientific approach in the data analysis which could help investors and market players take informed decisions and also to pave the road for automated approach\/framework of property sales data analysis\/clustering.\n\nThe clustering applied highlighted four main clusters of propeties, as the characteristics which are defining them are not purely geographical but other factors such as property type are important as well.\n\n_**Keywords**: machine learning, clustering analysis, feature selection, feature creation, de-duplication, scaling, PCA, principal component analysis, KMeans++ clustering, agglomerative clustering, density based clustering analysis, DBSCAN, elbow method, dendrogram, cluster silhouette profile, word cloud, pivot table_","6bfafd60":"Although the `NULL` values are negligibly small, after the initial iterations of our analysis we came to the conclusion that the impact of this feature to the outcome of our clustering is minimal, therefore we are removing it for further use.","bbaa0766":"`object_id` values are unique, therefore they are not influencing the clustering results, hence they would not be included in the clustering analysis.","bef84694":"Once we have identified that the most optimal number of clusters for our dataset is `4` we would like to analyse what are the corresponding characteristics of the sold properties in each of the clusters.\n\nFor the purpose, we are going to attempt analysing the data in each of the clusters from various standpoints, namely:\n\n**Geographical Location**\nThis means that we will plot the clustered properties sales using their geographical coordinates to attempt understand visually whether geographical location of the properties is a significant factor in the clustering\n\n**Word Cloud** \nAs the clustering could be difined as a categorisation without category labels, we will try to generate word cloud for each cluster with the features of the sold properties which are statistically significant\n\n**Pivot Plots**\nUltimately we will approach the clustered data using the pivot tables for the highly expressed features in order to find any rules of the way how the clusters are organised","a03d1715":"### Creating Indicator Variables\/Features (Dummies)","b00efb14":"### Cluster Generation","2b9fcb0d":"Ward-wise, we could identify the clear rule which we observed in the geo-location analysis, that:\n* **cluster `0` and `1` overlap** in their core wards, i.e.:\n    * the majority of the properties belonging to these clusters share the same wards:\n        * `Ward 3`\n        * `Ward 7` \n        * `Ward 10`\n        * `Ward 1` and `Ward 5`\n* **cluster `2` and `3` overlap** in their core wards, i.e.:\n    * the majority of the properties belonging to these clusters share the same wards:\n        * `Ward 4`\n        * `Ward 5` \n        * `Ward 12`\n        * `Ward 13`\n        * `Ward 1`\n        * `Ward 8` and `Ward 9`\n* clusters `0` and `1` **do not overlap** with clusters `2` and `3` in their core wards","786cdf42":"### Principal Component Analysis (PCA)","f468f9c3":"It does not look like the sales have major changes throughout the years, hence we would not create a new feature for year.","8dfc1d36":"In the following sections we will try to cluster the data using several clustering algorithms in order to find the most optimal clustering, thus finding the most optimal internal structure of the dataset. The algorithms used are the following: `KMeans++ Clustering`, `Agglomerative Clustering` and `Density Based Clustering Analysis (DBSCAN)`.\n\nBefore jumping to the actual analysis we will define some auxilliary functions which will help us visualise and work with the clustered data","59509093":"We observe that the first two ratios are highest, that is why we are going to limit our reduced features to them only. \n\nPlease note that both options with smaller and higher number of PCA-ed features were explored, but the optimal results are achieved with only two of them. That is why we are reducing the PCA-transformed data set to just two parameters:","de6e04ce":"## 2. Methodology","e6b7b4c0":"#### Processing Sale Date Related Features","44dee18b":"##### `pin`","0e83b3a8":"This is the dataset which we would use for clustering.","a24385de":"We could see that the most optimal data distribution of the data in clusters is when the number of clusters is `4`. In the case of `3` and `5` the clusters are not well shaped in the sense that there are points in the cluster which are closer to the centroids than others. In the case of `4` clusters, although the size of the clusters is not the same, the centroids are in a relatively equal distance from each point in the cluster.","ab5681c2":"Reviewing `house_number` and `house_number_2` columns we could see that both columns are irrelevant to our study.","e688d042":"#### Processing Address Related Features","d6e8315a":"## Abstract","dc212d96":"The initial idea during analysis of the input dataset was to preserve the `street_name` feature, as it seems that some streets are more popular than others, i.e. from domain point of view streets are important, but when we create indicator variables the number of dataset features is increasing several times, i.e. from `114` to `479`, which considering the small size of the dataset (`60906` before de-duplication and `20550` afterwards) is not a viable solution as it will decrease the precision of the clustering. \n\nThat is why, `street_name` would be removed from the list of features to be used for clustering. When there is more input data (e.g. samples number larger than at least `100000`), then we could reconsider our decision and include `street_name` as anoter feature to our analysis.","5c278fc6":"We could see that **geography** has **partial impact on the cluster structure**. \n\nOur observations are as follows:\n* Cluster `0` and `1` are:\n    * similar in shape\n    * have clear presence in the **central parts of the city**\n* Cluster `2` and `3` \n    * are similar in shape\n    * have clear presence in the **periphery of the city**","b21a157e":"##### `gross_sale_price`","ad78fd9d":"We would like to check whether converting `sale_date` to a `datetime` type would be of any use for our analysis:","9e0c13bd":"#### Property Type\nThere is a clear distinction between the property types of the different clusters:\n* **clusters `0` and `1`** are having **higher class properties**:\n    * `Condominium`s\n    * `Double Bungalow`s and `Apartment`s\n    * as well as `Compertial` properties\n* **clusters `2` and `3`** are having **`Residential`** type properties only","2a49c4d8":"### Data Loading\n\nThe Minneapolis Assessor's Office records of real property transaction in the city is public information which has the following attributes:\n\n* **CRV** - Certificate of Real Estate Value number. A unique identifier given to every certificate of real estate value\n* **PIN** - the 13-digit tax ID that uniquely identifies a taxable parcel\n* **Sale_Date** - the date of the sale\n* **InRTOStudy** - yes or no depending on whether the sale was used for the Minnesota Department of Revenue Sales Ratio Study. Only sales that are considered fair market value sales are included\n* **Neighborhood** - the name of the neighborhood the property is in\n* **Ward** - the number of the ward that the property is in\n* **Address** - the street address of the property\n* **Grantee** - the buyer name\n* **Grantor** - the seller name\n* **Adjusted_Sale_Price** - the sale price after accounting for seller-paid adjustments\n* **Gross_Sale_Price** - the unadjusted sale price\n* **Downpayment** - the dollar value of the initial downpayment \n* **X** - the X coordinate of the parcel centroid of the sold property \n* **Y** - the Y coordinate of the parcel centroid of the sold property \nThe coordinates are expressed in the NAD 83 Hennepin County HARN coordinate system (WKID: 103734)","a6699b78":"##### `prop_type`","604951f8":"Although the magnitude of teh residential properties sold is highly disproportionate to the rest of the property types on the market we will preserve this feauture as it seems important. ","b8f926e1":"### Features Pre-Processing","08a7c59e":"### Finding Right Number of Clusters ","d466e6a4":"Creating three new properties from the date - `year`, `month` and `day`:","d134bbc9":"Apparently overlaying all clusters on the same map does not give us very clear idea how strongly the geographical distribution of the properties influences the clusters structure. There is partial clarity on the presence of properties from cluster `0` and `1` in the central part of the city, while properties from clusters `2` and `3` are rather in the outscirts, but it is hard to read.\n\nWe will geographically plot the clusters each on its own and try to eventually find any relation:","44e5a6f0":"We will generate clusters using each of the algorithms explored above, so that we could analyse their output in the next section.","61e34e7b":"This is a category variable with fairly small number of categories (just `13`), so we are going to leave it during the clustering. If it makes the model computation difficult or incorrect, then we will exclude it at a later step.","d6012728":"Because of the amount of the sold residential properties in cluster `2` its share of the market is high (`49.89%`) hence the total amount (in terms of gross price) is highest, followed by cluster `1` and `0`.","667cf761":"### Auxilliary Functions for Clustering Analysis","e4364162":"### Removing Duplicate Samples","42e6ac74":"##### `grantee`","4d58d12a":"#### Ward","cde80a8a":"As `61%` of the `downpayment` values are missing, we remove this feature.","f783545f":"Another approach of drawing the dendrogram of the property sales dataset is to use `seaborn` out-of-the-box functionality:","75ea3c03":"#### Functions for Geo-Plotting Clusters","b19762fa":"## 7. Future Work","cdedaea0":"### Data Loading","00eafe76":"#### Functions for Statistical Labeling Clusters","3f5e2a03":"As per dataset features description:\n\n> _X ... and... Y ... coordinates are expressed in the NAD 83 Hennepin County HARN coordinate system (WKID: 103734)_\n\nwe are not interested at the moment in these features, so we are going to remove them.","6765e22a":"We could see that few of the last records in the datasets have duplicates, so we list them in order to examine one of them:","00fb63c4":"#### Functions for Non-Visual Analysis","7a301af9":"##### `house_number` and `house_number_2`","9fdb4f77":"We do a quick check whether the usage of the new latitude and longitude features are useful and whether we could gain some insights from plotting the properties on an actual geographical map","46689893":"The number of unavailable values for `adjusted_sale_price` is negligible (~`0.01%`), therefore filled in the missing values with `-1` in order to rectify the validity of the values in the column but there are a few values which are negative, which might mean that we cannot rely on this feature for the clustering phase, therefore we will remove this feature from the analysis.","a71e25ee":"##### `x` and `y`","b82b4b69":"##### Exploring `year`, `month`, `day` features ","3c649d9d":"## References","6b4bc7f1":"The **Elbow Method** is is a heuristic method of interpretation and validation the consistency within clusters analysis which is designed to help finding the optimal number of clusters to which a dataset could be split.","60c01a25":"We load only the `.geo` file from all available files as it contains the majority of features we need for our analysis. ","1f068955":"#### Processing Idenfier\/Category Related Features","48228cdb":"## 1. Introduction","86fe9589":"##### `in_rto_study`","26a74b4a":"After a brief exploration we observe that there are samples in the dataset which are semantically are identical with others. For the purpose we use `cvr` which is a unique identifier given to every certificate of real estate value as well as `pin`, which is a 13-digit tax ID that uniquely identifies a taxable parcel.","e4c28123":"Regarding neighbourhoods, the overlap is not fully replicated from the wards:\n* **cluster `0` and `1` overlap** in their core neighbo:\n    * the majority of the properties belonging to these clusters share the same wards:\n        * `NORTHLOOP`\n        * `DOWNTOWNWEST` \n* **cluster `2` and `3` overlap** in their core wards, i.e.:\n    * the majority of the properties belonging to these clusters share the same wards:\n        * `Ward 4`\n        * `Ward 5` \n        * `Ward 12`\n        * `Ward 13`\n        * `Ward 1`\n        * `Ward 8` and `Ward 9`\n* clusters `0` and `1` **do not overlap** with clusters `2` and `3` in their core wards","5c9dc357":"As we could see, for too small (`0.1`) or too large (i.e. `0.5` or larger) values of $\\epsilon$ the clustering is sub-optimal. For the rest of the cases, no matter what range the parameters of the DBSCAN algorithms are, it always identifies `4` clusters for our dataset.\n\nWe should note that opposite to the KMeans++ Clustering algorithm, DBSCAN behaves well with data which is not shaped in spherical\/well-shaped clusters, so this gives us additional confidence that the optimal number of clusters for our dataset is `4`. ","7f8be571":"As `geometry` is of type `Point`, it does seem to be an unhashable type, which would become an obstacle later on during the creation of indicator variables (dummies). That is why we create two numeric columns `lat` and `lon` respectively, which would represent lattitude and longitude:","1a4b28bb":"#### Processing Sale Price Features","87d26884":"We need to look into which of the variance ratios are highest in order to find new attributes, which could represent the data in the new dimensional space.","8cbc0a51":"As we could see the shape of the graph resembles elbow, which would mean that our data is well separated and allows for this method to be used. \n\nWe could identify **`4`** as **the optimal number of clusters** as on the left hand side of the \"point `4`\" the inertias function decreases quicker than on the right side of the point, which means that increasing the number of clusters to more than 4, we would unnecessarily break the data to smaller clusters, without actually gaining any benefit. In fact, the distances between the clusters will not be that big and we ultimately will create unnecessarily high number of cluster.\n\n\nAs this method is often ambiguous and not very reliable, despite its good indication in our case, to confirm\/disprove its output we will apply a couple of more approaches for determining the optimal number of clusters for our dataset, namely the Silhouette method for KMeans++ Clustering and Dendrogram Diagram for Agglomerative Clustering. ","fd023745":"##### `street_type`","21835eee":"#### Processing Geography Related Features","3ed070da":"### Scaling Features","e2745a54":"Similarly to the grantees, grantors seem to be `84%` unique, hence we will exclude this feature from the clustering as well.","b012f4e2":"### Clustering Results: Analysis by Statistical Labeling","cac06b49":"1. [Property Sales 2002-2005, Minneapolis, Minnesota, USA](https:\/\/data.world\/minneapolismn\/342cfcca2eae40838adf5602299dfcd4-0)\n2. [Open Minneapolis, Property Sales 2002-2005](http:\/\/opendata.minneapolismn.gov\/datasets\/342cfcca2eae40838adf5602299dfcd4_0)\n3. [Minneapolis City Council Wards](https:\/\/www.arcgis.com\/home\/item.html?id=0e9be43abc834e85bc6ad003d9358c76)\n4. [City of Minneapolis Communities & Neighbourhoods Map](http:\/\/www.minneapolismn.gov\/www\/groups\/public\/@cped\/documents\/maps\/convert_273414.pdf)","e2413b23":"Creating a `day` feature for potential use during the clustering:","54a115dd":"#### KMeans++ Clustering: Cluster Silhouette Profies Method ","c89a799b":"If we have to convert word clouds above into a tabular format, the data would look like the one below (please note that the order in the sells is important - top values are most frequent while the bottom ones - less):\n```\n                            Statistically Defined Cluster Labels\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502    Feature    \u2502   Cluster: 0    \u2502       Cluster 1       \u2502  Cluster 2  \u2502  Cluster 3  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Gross Price   \u2502 $0              \u2502 $0                    \u2502 $0          \u2502 $0          \u2502\n\u2502               \u2502 $900,000        \u2502 $900,000              \u2502 $900,000    \u2502 $500,000    \u2502\n\u2502               \u2502 $500,000        \u2502 $500,000              \u2502 $500,000    \u2502 $900,000    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Property Type \u2502 Condominium     \u2502 Condominium           \u2502 Residential \u2502 Residential \u2502\n\u2502               \u2502 Double Bungalow \u2502 Apartment             \u2502             \u2502             \u2502\n\u2502               \u2502 Apartment       \u2502 Double Bungalow       \u2502             \u2502             \u2502\n\u2502               \u2502 Townhouse       \u2502 Commercial            \u2502             \u2502             \u2502\n\u2502               \u2502 Commercial      \u2502 VacantLand            \u2502             \u2502             \u2502\n\u2502               \u2502 Triplex         \u2502 Residential           \u2502             \u2502             \u2502\n\u2502               \u2502                 \u2502 Apartment Condominium \u2502             \u2502             \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Ward          \u2502 Ward 3          \u2502 Ward 3                \u2502 Ward 4      \u2502 Ward 4      \u2502\n\u2502               \u2502 Ward 7          \u2502 Ward 7                \u2502 Ward 12     \u2502 Ward 5      \u2502\n\u2502               \u2502 Ward 10         \u2502 Ward 10               \u2502 Ward 13     \u2502 Ward 12     \u2502\n\u2502               \u2502 Ward 1          \u2502 Ward 5                \u2502 Ward 11     \u2502 Ward 13     \u2502\n\u2502               \u2502 Ward 5          \u2502 Ward 9                \u2502 Ward 1      \u2502 Ward 1      \u2502\n\u2502               \u2502 Ward 9          \u2502 Ward 6                \u2502 Ward 8      \u2502 Ward 9      \u2502\n\u2502               \u2502 Ward 8          \u2502 Ward 13               \u2502 Ward 5      \u2502 Ward 8      \u2502\n\u2502               \u2502 Ward 2          \u2502 Ward 8                \u2502 Ward 2      \u2502 Ward 11     \u2502\n\u2502               \u2502 Ward 13         \u2502 Ward 12               \u2502 Ward 9      \u2502 Ward 2      \u2502\n\u2502               \u2502 Ward 4          \u2502 Ward 1                \u2502 Ward 7      \u2502 Ward 3      \u2502\n\u2502               \u2502 Ward 6          \u2502 Ward 2                \u2502             \u2502 Ward 7      \u2502\n\u2502               \u2502 Ward 12         \u2502                       \u2502             \u2502 Ward 10     \u2502\n\u2502               \u2502 Ward 11         \u2502                       \u2502             \u2502             \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Neighbourhood \u2502 NORTHLOOP       \u2502 NORTHLOOP             \u2502 FULTON      \u2502 WILLARD     \u2502\n\u2502               \u2502 DOWNTOWNWEST    \u2502 DOWNTOWNWEST          \u2502 STANDISH    \u2502 HAY         \u2502\n\u2502               \u2502 LORINGPARK      \u2502 NICOLLETIS            \u2502 VICTORY     \u2502 JORDAN      \u2502\n\u2502               \u2502 WHITTIER        \u2502 EASTBANK              \u2502 WILLARD     \u2502 FOLWELL     \u2502\n\u2502               \u2502 ELLIOTPARK      \u2502 WHITTIER              \u2502 HAY         \u2502 HOWE        \u2502\n\u2502               \u2502 POWDERHORNPARK  \u2502 STEVENSSQ             \u2502 JORDAN      \u2502 HAWTHORNE   \u2502\n\u2502               \u2502 HOLLAND         \u2502 LORINGHGTS            \u2502 HOWE        \u2502 VICTORY     \u2502\n\u2502               \u2502 LOWRYHILLEAST   \u2502 ELLIOTPARK            \u2502 LINDENHILLS \u2502 LIND        \u2502\n\u2502               \u2502                 \u2502 DOWNTOWNEAST          \u2502 FOLWELL     \u2502 BOHANON     \u2502\n\u2502               \u2502                 \u2502                       \u2502 WAITEPARK   \u2502 WEBBER      \u2502\n\u2502               \u2502                 \u2502                       \u2502 LIND        \u2502 CAMDEN      \u2502\n\u2502               \u2502                 \u2502                       \u2502 BOHANON     \u2502 MCKINLEY    \u2502\n\u2502               \u2502                 \u2502                       \u2502 ARMATAGE    \u2502 CENTRAL     \u2502\n\u2502               \u2502                 \u2502                       \u2502 WEBBER      \u2502 LINDENHILLS \u2502\n\u2502               \u2502                 \u2502                       \u2502 CAMDEN      \u2502             \u2502\n\u2502               \u2502                 \u2502                       \u2502 LYNNHURST   \u2502             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```","fac23ebb":"Apparently, most of the values for this feature are missing, so it will not be taken into account for our analysis.","879c6eb5":"_Nikolay Vasilev, [nikolay.vasilev@gmail.com](mailto:nikolay.vasilev@gmail.com)_\n\n_Software University, Bulgaria_ \n\n_23 November 2019_\n\nSource: https:\/\/github.com\/nvasilev\/machine-learning-softuni-2019-project\n\nCopyright: CC-BY-NC-SA","817e7e91":"The price band of clusters `0` and `1` in general higher than the one of clusters `3` and `4`, as there are some outliers in each the clusters. ","70bca0bf":"As the values for the various feature values vary highly, we would like to put them in the same range so that our clustering analysis does not get skewed by the various scales of the feature. For the purpose we will use `MinMaxScaler` which will place all values in the `[0,1]` range.","edecfac6":"Before continuing our analysis let us add the found cluster numbers\/labels to our `property_sales_data` to help the analysis.","cc131724":"##### `grantor`","2f1456e2":"#### DBSAN Clustering: Visual Method","badcf056":"### Clustering Results: Analysis by Cluster Sizes and Cluster Identity","d5952b25":"The missing values for this categorisation variable are `26%`, which means that if we exclude these samples from the dataset, it would have too high (negative) impact on the clustering (as there would not be enough number of data samples but the number of features would be too high, i.e. due to the \"curse of dimensionality\" we could introduce too much noise in the output model). \n\nAlso, on a later step probably the missing `suffix_direction` values could be deduced\/populated based on the geo-related information. Also due to time restriction, this will be left as a future work. \n\nIn the meantime, this column will be removed from the modeling process.","8a68bccd":"Another way of assessing the most optimal number of clusters for a dataset is to use the agglomerative clustering approach and more specifically to use its **dendrogram** which similarly to the Elbow Method is based on the interias of the clusters. This approach is used to find out what is the number of clusters based on the larger distances between the points on the dendrogram.\n\nWe will use the default implementation of agglomerative linkage (with two clusters) provided by `scipy` to plot the dendrogram:","f5e83e13":"#### DBSCAN Clustering: 4 Clusters (eps = 0.3, min_samples = 200)","e7a4ff05":"#### KMeans++ Clustering: 4 Clusters","bf58fcd0":"### Clustering Results: Analysis by Pivot Tables","3c6b109d":"### Renaming Dataset Features","0ad44ba8":"### Clustering Results: Analysis by Geographical Location","8dc951fd":"It seems that `sale_date` and `sale_date_2` have identical values, hence we dismiss the second copy (`sale_date_2`) of the data:","f564e709":"#### Plotting Clustered Data","69b3b4eb":"##### `downpayment`","76391420":"`crv` (or Certificate of Real Estate Value number, a unique identifier given to every certificate of real estate value) is formally of a numeric type, but as its values are all unique, this makes it a category variable, which if later is converted into a list of indicator (dummy) variables it will increase the dimensionality of the dataset disproportionally to the number of samples available, thus reducing the precision. For that reason this feature, similarly to the `object_id` will be excluded from the analysis.\nA few checks below prove our reasoning.","d89f1744":"In the next sub-sections we will use several approaches to find the most optimal number of clusters for the provided dataset.","80acc48b":"It seems that `day` and `month` might be useful for the clustering, although there is high probability that they will introduce too many indicator variables, which might have an impact on the precision of the clustering (due to insufficient sample data). At first, we would exclude these features from the clustering.","c5bf853e":"# Property Sales 2002-2005, Minneapolis: A Clustering Analysis","016da577":"##### `suffix_direction`","5e5b1f27":"We could conclude that the **clusters identified by each of the algorithms** are **identical**, hence we could do the further analysis using the results generated by just one of the algorithms.\n\nFor the rest of the sections, unless stated otherwise, we will use the KMeans++ clustering results for generalising our conclusions for the properties sales data.","5e2c17b1":"##### `prefix_direction`","5ba870f7":"#### Processing Sale Participants Related Features","62bfc5a1":"### Auxilliary Functions for Cluster and Map Drawing","85ab4ab9":"##### `adjusted_sale_price`","234d92a0":"##### `neighbourhood`","d123465c":"As a conclusion, both features will not be included into the clustering analysis.","2c72a55d":"## 6. Conclusions","7d01a834":"Having too many features (i.e. high dimensionality), we cannot distinguish which are important ones for our analysis and which not, that is why we use Principal Component Analysis approach for linear dimensionality reduction to project it to a lower dimensional space.","6c6293d0":"As the column names are not following any specific naming convention and as we are using Python-based tools for the analysis, we are renaming them to be compliant with the Python naming convention (lowercase words separated by underscores) as well to increase the readability.","c0070ae6":"We can conclude that the properties sales market in Minneapolis for the period of 2002-2005 is shaped by two main factors - location and property types as the four main types of properties could be organised in four main groups\/clusters:\n* **Comercial and High-end Living Properties** \n    * Cluster `0`\n    * 20.46% of the market\n    * Consisting of Comercial Spaces, Apartments, Condominiums and Double Bungalows\n    * located mostly in the city centre and the outskirts of the city:\n        * Wards: 3, 7, 10, 1\n        * Neighbourhoods: Northloop, Downtown-West, Loring Park, Whittier\n* **High-end Living Properties with some Comercial Properties and Industrial Land** \n    * Cluster `1`\n    * 20.76% market share\n    * Consisting of Condominiums, Apartments, Comercial Properties, Industrial Vacant Land and Industrial Properties\n    * Similarly to the previous group the properties in this one are located mostly in the city centre and the outskirts of the city:\n        * Wards: 3, 7, 10, 5\n        * Neighbourhoods: Northloop, Downtown-West, Nicolletis, Eeast Bank \n* **Residential Properties** \n    * Cluster `2`\n    * 49.89% - highest market share\n    * Consisting mostly of Residential Properties\n    * The location of these properties are mostly out of the central part of the city:\n        * Wards: 4, 12, 13, 11, 1\n        * Neighbourhoods: Fulton, Standish, Victory, Willard, Hay\n* **Low-end Residential Properties** \n    * Cluster `3`\n    * 8.89% - highest market share\n    * Consisting mostly of low-end Residential Properties       \n    * The location of these properties are mostly out of the central part of the city:        \n        * Wards: 4, 5, 12, 13, 1\n        * Neighbourhoods: Willard, Hay, Jordan, Folwell, Howe\n\nFuture buyers and investors could use this data to make informed decisions and navigate on the property market of Minneapolis.","d18abab7":"##### `object_id`","88d2390d":"##### `address`","f76476cc":"#### Agglomerative Clustering: Dendrogram Diagram Method","3fd7a724":"Creating a `month` feature for potential use:","be91b14b":"`neighbourhood` is a category variable and although it has fairly high number of unique values (which later on would result in high number of indicator variables), it is important for the clustering from domain point of view, so we will not remove that feature.","bb946570":"In this sub-section we will try to find some rules which define the various clusters as for a tool we will use pivot plots to visualise the property gross pricess in relation to several features.\n\nThe features for which we would like to analyse the property gross price per cluster are subset of the properties considered in the labeled statistical analysis:\n* Property Type\n* Ward\n* Neighbourhood\n\nPlease note that the mean is used for rendering the prices in order to compact the graphics.","940bf6ef":"Let review what are the sizes of the clusters generated by each of the algorithms.","9a924f6d":"## 5. Clustering Results: Analysis","516cf4eb":"We observe that the property sale is the same, but there are four records for it, because there are two sellers (`grantor`s) and two buyers (`grantee`s) in the purchase.\n\nFirst we will sort the properties by `crv` and then we will de-duplicate by both `crv` and `pin`:","b1024172":"Similarly `house_number_2` contains values which do not seem relevant to our analysis:","61648a25":"##### `street_name`","0530da64":"We observe that the size of the data set now has reduced drasticaly to `33%` of the initial size:","9acab685":"## 4. Finding Optimal Number of Clusters","1123450d":"#### KMeans++ Clustering: Elbow Method","c2c1b66f":"The available values for `house_number` are only about `16%`:","045d2d78":"Similarly to `crv` and `object_id`, `pin` is an identifier, therefore we are excluding it it as a feasible feature for clustering:","d212c18a":"A concrete example of a duplicate sample is a property sale with `crv` equal to `798354`:","f10aca4c":"The set of initial features we end up with for clustering is as follows:","d01aed0a":"The highest end properties in terms of gross sale price are in cluster `0` and `1`.","caf0f593":"After the course exam some deficiencies of this work were pointed out which need to be addressed accordinlgy before developing it further:\n* Reducing the number of samples from `~70,000` to `~20,000` does not influence the clustering, as the duplicated samples would just project to the same cluster points later on.\n* PCA is not really needed for the clustering and the original set of features seem to be sufficient\n* Even if PCA is used, currently it uses just around `30%` of the new parameters which matter (ideally the aim should be to use at least `90%`). Please see `pca.explained_variance_ratio_` above\n* KMeans Clustering is not really applicable to this use case as the clusters discovered do not seem to be spherical, while KMeans need spherically distributed data\n* Looking at the silhouette profiles it is clearly visible that the clusters are not very similar in terms of shape and size hence, further exploration would need to be done, e.g. \n    * need to be verified how the silhouette profiles of 11 or 12 clusters look like\n\nOnce the main points above are addressed, this analysis could be extended further, as the main directions work could be done are as follows:\n* Generalising the analysis for newer data sets (e.g. 2010-2013)\n* Pre-processing the gross price of properties into price bands in order to be leverage statistically labeling as well as to add it to as characteristics of the property clusters\/groups\n* Automating the data analysis and pre-processing using Pandas Pipelines\n* Unifying the colours of the clusters across the Jupiter Notebook\n* Render ward and neighbourhood names on the map\/cluster plots","46b867d7":"In both cases we could see that the longest distances between clusters are achieved for cluster distances between `0.8` and `1.5`. If we draw a line perpendicular to the clustering lines, the number of intersection points gives us the optimal number of clusters the dataset could be split when using agglomerative clustering, which is again `4`.\n\nAs shortly would be shown, the dataset has well shaped clusters, so all clustering algorithms used identify the same clusters.","56ce7712":"As this feature is boolean in its nature from puerly technical perspective it is suitable to be used in the analysis. \n\nPlease note that from purely domain-related standpoint, it does not seem to influence the property sales, but as the we are not enough property sales domain-versed, we would leave this feature during the clustering with the idea that if it is not important it would be ignored after the PCA step anyway.   ","d3ebc76f":"We should note that KMeans++ works well but only if the data is well organised in clearly separated clusters. In our dataset it seems that we have well defined clusters which do not overlap which would mean that we could be fairly confident in using KMeans++ as a clustering approach.","a621db43":"Following the results from the initial data analysis, we are to remove the features which do not appear useful for our clustering analysis:\n* `object_id`\n* `crv`\n* `pin`\n* `address`\n* `house_number`\n* `house_number_2`\n* `prefix_direction`\n* `street_name`\n* `street_type`\n* `suffix_direction`\n* `sale_date_2`\n* `sale_date`\n* `year`\n* `grantee`\n* `grantor`\n* `adjusted_sale_price`\n* `downpayment`\n* `x`\n* `y`\n* `geometry`","8c950bd7":"###### Properties Plotted on a Geo Map","b958175f":"It seems that `91%` of the grantees are different people, which means that the values in that column are virtually unique, hence we will exclude this column from the clustering analysis.","0049820a":"### Enhance Sales Data With Cluster Information","ac1147a2":"Based on the total gross sale price of properties per property type, there is clear distinction of:\n* cluster `0` consists of high-end properties - `Comercial`, `Apartment`, `Condominium` and `Double Bungalow`\n* cluster `1` is characterised by properties mostly of type `Condominium`, `Apartment`, `Comercial`, `Vacant Land - Industrial` and less of types `Double Bungalow` and `Industrial` properties\n* cluster `2` is highly represented by properties of type `Residential`\n* cluster `3` is as well `Residential` properties but of lower price and quantity","8d2ad8f3":"#### Neighbourhood\n","56ed6423":"Unfortunately Density Based Spatial Clustering for Applications with Noise (DBSCAN) does not have any specific method for finding the number of clusters, so we will generate several clustering options changing the radius $\\epsilon$ of the vicinity and the number of noise points in order to visually identify the best number of clusters.","eb99e1fc":"##### `sale_date` and `sale_date_2`","ee4c335b":"In the next sections we go through each of the available features and analyse whether its data is in a sufficiently good shape for the follow-up clustering.\n\nFor convenience, we group the available features in six groups during the analysis, each of which correspond to the sections below:\n* identifiers\/category\n* address\n* sale date\n* sale participants\n* sale price\n* geo-related","9561a0c5":"We could observe that there are no duplicated records by none of the unique features of the dataset - `crv` and `pin`: ","010878e7":"In the sections below we will review whether the address related features from the input dataset are suitable for the clustering analysis.","9a303d7e":"##### `geometry`, `lat` and `lon`","c6e9da30":"This feature seems to be a combination of `house_number`, `street_name`, `street_type` and post code features. As it is hard to be used for clustering purposes, it will be excluded from the follow-up analysis.","dc26afb1":"The number of unavailable values for `gross_sale_price` is negligible (~`0.5%`), therefore filled in the missing values with `-1` in order to rectify the validity of the values in the column. It is true that we introduce bias in that way, but for now we consider it acceptable.","d9c7841a":"As some of the features are with category nature, e.g. `prop_type`, `ward`, `neighborhood`, based on their values we need to create indicator variables, so that we have all our features be of numerical types, thus easy to process later on.","65868f6b":"#### Gross Price\nWe could conclude that due to the small changes in each of the **property sale prices**, this feature **could not be used in statistical labeling** in its **raw form**. It needs to be pre-processed and replaced by price ranges first.","9ac75a71":"The methodology followed in this document is as follows: \n1. Initial data features are initially analysed and only a subset of them is selected for the actual analysis, based on the quality of the data available for each feature as well as their relevance to the conducted analysis\n1. A standard set of pre-processing actions follow, including data de-duplication, scaling, indicator variables creation and Principal Component Analysis (PCA)\n1. Clustering analysis is applied using various algorithms, namely KMeans++ Clustering, Agglomerative Clustering and Density Based Clustering Analysis (DBSCAN) with the accompanying visual methods for clustering verification such as Elbow Method, dendrogram diagrams and cluster silhouette profiles.\n1. After the identificaiton of the most optimal number of clusters for the dataset, characterisation of these clusters is attempted by using: (1) geographical distribution of the properties in each cluster, as well as (2) statistical labeling of the most frequent property features found in each cluster and (3) pivot plot analysis of the property prices for each cluster and their relation to several other properties such as ward, neighbourhood and property type.","2fc0b34b":"It seems that the property market jargon in USA the seller of the property is called grantor and the person who pruchases the property - grantee.","7a15a3e1":"We observe tenfold increase of the number of features, but the number is not too high. Also during the PCA step of the data pre-processing will help us discard the influence of the insignificant features for our clustering.","eee26ac6":"At first sight, visually screening the property sales plotted on a geo-map, we cannot obtain any insight on whether geo-defined clustering of the data is in place or not.","5e86515a":"#### Agglomerative Clusterring: 4 Clusters","c15c14a7":"Although we could visually identify `4` well separated clusters, we will need to use more quantative approaches to prove that this is the most optimal number of clusters which exist for the properties sales dataset.","7b76a40a":"### Removing Redundant Features ","178c78cf":"##### `ward`","a7d63793":"## 3. Data Pre-processing"}}