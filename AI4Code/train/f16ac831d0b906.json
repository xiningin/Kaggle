{"cell_type":{"1bd27057":"code","0c96841e":"code","afd315de":"code","24c407c4":"code","bd998561":"code","72eaa588":"code","f2ce24d0":"code","261449e3":"code","b33aaf51":"code","222177ac":"code","a73ec7cd":"code","7718196e":"code","ae6378e5":"code","23932383":"code","3c783da5":"code","e24b82ba":"code","73a20811":"code","3a66cdb7":"code","77297d3d":"code","3cf94040":"markdown","5fc2e9f4":"markdown","165a4f03":"markdown","4fd06400":"markdown","de118be0":"markdown","957db8c8":"markdown","6bff57c6":"markdown","599141d1":"markdown"},"source":{"1bd27057":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport os\nprint(os.listdir(\"..\/input\"))\nimport warnings\nwarnings.filterwarnings('ignore')\n%pylab inline","0c96841e":"data = pd.read_csv('..\/input\/student-mat.csv')","afd315de":"data.school.replace(['GP','MS'],[0,1],inplace=True)\ndata.sex.replace(['F','M'],[0,1],inplace=True)\ndata.address.replace(['U', 'R'],[0,1],inplace=True)\ndata.famsize.replace(['GT3', 'LE3'],[0,1],inplace=True)\ndata.Pstatus.replace(['A', 'T'],[0,1],inplace=True)\ndata.Mjob.replace(['at_home', 'health', 'other', 'services', 'teacher'],\\\n                 [0,1,2,3,4],inplace=True)\ndata.Fjob.replace(['teacher', 'other', 'services', 'health', 'at_home'],\\\n                 [0,1,2,3,4],inplace=True)\ndata.reason.replace(['course', 'other', 'home', 'reputation'],[0,1,2,3],inplace=True)\ndata.guardian.replace(['mother', 'father', 'other'],[0,1,2],inplace=True)\ndata.schoolsup.replace(['yes', 'no'],[0,1],inplace=True)\ndata.famsup.replace(['yes', 'no'],[0,1],inplace=True)\ndata.paid.replace(['yes', 'no'],[0,1],inplace=True)\ndata.activities.replace(['yes', 'no'],[0,1],inplace=True)\ndata.nursery.replace(['yes', 'no'],[0,1],inplace=True)\ndata.higher.replace(['yes', 'no'],[0,1],inplace=True)\ndata.internet.replace(['yes', 'no'],[0,1],inplace=True)\ndata.romantic.replace(['yes', 'no'],[0,1],inplace=True)","24c407c4":"print(data.shape)\ndata.head(5)\n","bd998561":"data.info()","72eaa588":"plt.figure(figsize=(20,7))\nsns.set(font_scale=2)\nsns.countplot(data.age);","f2ce24d0":"plt.figure(figsize=(20,7))\nsns.set(font_scale=2)\nsns.countplot(x=data.age,hue=data.sex);","261449e3":"plt.figure(figsize=(20,10))\nsns.set(font_scale=1.5)\npd.crosstab(data.school,data.sex).plot(kind='barh');","b33aaf51":"plt.figure(figsize=(20,20))\nsns.heatmap(data.corr(),cmap='hot');","222177ac":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import roc_curve,roc_auc_score\nfrom sklearn.metrics import classification_report\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.model_selection import train_test_split","a73ec7cd":"data_train, data_test, targ_train, targ_test = train_test_split(\\\n            data.drop(['Walc','Dalc'],axis=1), data.Dalc, test_size=0.2)","7718196e":"forest = RandomForestClassifier(criterion='gini', n_estimators=200, max_depth=4)\nforest.fit(data_train, targ_train)","ae6378e5":"scores = cross_val_score(forest, data.drop(['Walc','Dalc'],axis=1), data.Dalc, cv=5)\nprint(\"Accuracy: %0.2f (+\/- %0.2f)\" % (scores.mean(), scores.std() * 2))","23932383":"forest.feature_importances_","3c783da5":"ss = pd.DataFrame(np.hstack((np.array(list(data.drop(['Walc','Dalc'],axis=1).columns)).reshape(31,1),forest.feature_importances_.reshape(31,1))))","e24b82ba":"features = ss[0]\nimportances = forest.feature_importances_\nindices = np.argsort(importances)\n\nplt.figure(figsize=(15,15))\nplt.title('Feature Importances')\nplt.barh(range(len(indices)), importances[indices], color='b', align='center');\nplt.yticks(range(len(indices)), [features[i] for i in indices])\nplt.xlabel('Relative Importance');","73a20811":"data = pd.read_csv('..\/input\/student-mat.csv')","3a66cdb7":"plt.figure(figsize=(10,7))\nsns.set(font_scale=2)\nsns.countplot(x=data.sex,hue=data.Dalc);","77297d3d":"plt.figure(figsize=(10,7))\nsns.set(font_scale=2)\nsns.countplot(x=data.goout,hue=data.Dalc);","3cf94040":"Of course, we must try to build corrplot:","5fc2e9f4":"In this model we try to predict \"Dalc\" feature - Workday alcohol consumption (numeric: from 1 - very low to 5 - very high).","165a4f03":"Compare age distribution and sex feature:","4fd06400":"Look at the age distribution:","de118be0":"Firstly, Import data and transorm categorical features.","957db8c8":"Derive accuracy metric for this model:","6bff57c6":"But this corrplot doesn't show any interesting and high relations. So we can suppose, that relation is non-linear and apply complex model - RandomForest.","599141d1":"Here we can see that schools are just about equal by gender."}}