{"cell_type":{"d66bf828":"code","99cdcb4b":"code","690e20d0":"code","b5880847":"code","e9a7ab18":"code","c3460884":"code","c47dfc36":"code","e96a3c1e":"code","f7966b5e":"code","70016214":"code","dc627bbc":"code","781170dc":"code","a3735c17":"code","f860e7b5":"code","a53e1083":"code","a6a9cb2c":"code","c356cdb3":"code","91d932cc":"code","9d2fbfe6":"code","1dec3fdc":"code","7779889c":"code","2e5c2ade":"code","90bd9af9":"code","6bd57131":"code","ed3289cf":"code","b0e7758b":"code","d9a47ca3":"markdown","415a4b1b":"markdown","b053847e":"markdown","7ac97900":"markdown","4b15c342":"markdown","5053bf5d":"markdown","31c3cba0":"markdown","41d8d890":"markdown","6a011d77":"markdown","45952658":"markdown","afd2e3da":"markdown","ab3a5b2e":"markdown","29f99457":"markdown","a0535906":"markdown","275b14f7":"markdown","52b5589a":"markdown","09650060":"markdown","cb2170c5":"markdown"},"source":{"d66bf828":"import numpy as np\nimport pandas as pd\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set(style=\"darkgrid\")\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import cross_val_score\nfrom xgboost import XGBClassifier\n%matplotlib inline\nimport os\nprint(os.listdir(\"..\/input\"))","99cdcb4b":"train = pd.read_json('..\/input\/train.json')\ntrain.set_index('id' , inplace= True)\nlabel = train['cuisine']\ntrain.drop('cuisine' , axis = 1 , inplace= True)\ntest = pd.read_json('..\/input\/test.json')","690e20d0":"train.head()","b5880847":"test.head()","e9a7ab18":"print('Number of train data ' , len(train))\nprint('Number of test data ' , len(test))","c3460884":"len(label.unique())","c47dfc36":"plt.figure(figsize=(16, 6))\nsns.countplot(y = label , order = label.value_counts().index)","e96a3c1e":"type(train.ingredients[0])","f7966b5e":"print('Maximum ingredients used in a single cuisine' , train.ingredients.apply(len).max())\nprint('Minimum ingredients used in a single cuisine' , train.ingredients.apply(len).min())","70016214":"def list_to_text(data):\n    return (\" \".join(data)).lower()","dc627bbc":"list_to_text(['a' , 'b'])","781170dc":"train.ingredients = train.ingredients.apply(list_to_text )\ntest.ingredients = test.ingredients.apply(list_to_text)","a3735c17":"train.head()","f860e7b5":"test.head()","a53e1083":"\ntfidf = TfidfVectorizer()","a6a9cb2c":"X_train = tfidf.fit_transform(train.ingredients)\nX_test = tfidf.transform(test.ingredients)","c356cdb3":"l = LabelEncoder()\nlabel = l.fit_transform(label)","91d932cc":"label","9d2fbfe6":"clf = XGBClassifier()\nscores = cross_val_score(clf, X_train, label, cv=3).mean()\nscores","1dec3fdc":"clf.fit(X_train , label)\npre = clf.predict(X_test)","7779889c":"pre","2e5c2ade":"pre = l.inverse_transform(pre)\npre","90bd9af9":"submit = pd.read_csv('..\/input\/sample_submission.csv')\nsubmit.head()","6bd57131":"submit.cuisine = pre\nsubmit.id = test.id","ed3289cf":"submit.to_csv('submit.csv' , index= False)","b0e7758b":"!ls","d9a47ca3":"## ML","415a4b1b":"## What's Cooking","b053847e":"## EDA","7ac97900":"### Distribution of cuisines. ","4b15c342":"##### Lets test it","5053bf5d":"### Number of ingredient ","31c3cba0":"### Prepare the submission file.","41d8d890":"### Working with text features","6a011d77":"#### The datatype of values in the ingredients column is a list.","45952658":"There are 20 types of cuisine in this dataset.","afd2e3da":"Ok its working","ab3a5b2e":"### Converting ingredients columns from a list to string.","29f99457":"1. Most of the cuisines are Italian and Mexican.\n2. Least data is available for the Russian and Brazilian.\n3. Imbalanced dataset","a0535906":"### Let's define a function to convert a list to a string.","275b14f7":"### Loading data","52b5589a":"### Loading necessary libraries","09650060":"### Inverse the prediction to its name\/label using LabelEncoder's inverse_transform","cb2170c5":"### Numbers of cuisine"}}