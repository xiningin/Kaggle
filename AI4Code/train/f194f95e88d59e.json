{"cell_type":{"08ec6ff0":"code","f276fe81":"code","469446c3":"code","ca2bbecd":"code","7f5480be":"code","fd1ae96b":"code","df39d47f":"code","5805ef10":"code","b7e73a47":"code","c8daf644":"code","4f5555b7":"code","a7d9264f":"code","8c06421b":"code","1f570a19":"code","28ffa732":"code","e0be676d":"code","3ce77108":"code","8c5f85a3":"code","57171cb5":"code","88cb82f3":"markdown","34a9edf4":"markdown","d713ef2e":"markdown","50ee8eaa":"markdown","c8c6682a":"markdown","fde96756":"markdown"},"source":{"08ec6ff0":"!git clone https:\/\/github.com\/time-series-tools\/Activity2Vec","f276fe81":"!conda install -c maxibor tsne -y","469446c3":"! pip install \"more-itertools==7.1.0\"\n","ca2bbecd":"# Import packages\nimport os\nimport sys\nsys.path.insert(0, os.path.abspath('.\/Activity2Vec\/'))\nimport tensorflow as tf\nimport numpy as np\nfrom datasets.har import load_data\nfrom model.act2vec import Act2Vec\nfrom util.utils import plot_latent_space\nfrom util.utils import rf\nfrom util.utils import plot_confusion_matrix\nfrom util.utils import print_result","7f5480be":"# allow tenserflow to use GPU\nphysical_devices = tf.config.experimental.list_physical_devices('GPU')\nassert len(physical_devices) > 0, \"Not enough GPU hardware devices available\"\ntf.config.experimental.set_memory_growth(physical_devices[0], True)\nos.environ['AUTOGRAPH_VERBOSITY'] = '10'\ntf.autograph.set_verbosity(0)","fd1ae96b":"n_epochs = 600","df39d47f":"(x_train, y_train), (x_test, y_test) = load_data()","5805ef10":"print('x_train shape is: ', x_train.shape)\nprint('x_test shape is: ', x_test.shape)\nprint('Number of classes: ', len(np.unique(y_train)))","b7e73a47":"act2vec = Act2Vec(units=128, input_dim=x_train.shape)\nopt = tf.keras.optimizers.Adam(lr=2e-4, decay=2e-11)\nact2vec.compile(loss='mse',\n             optimizer=opt,\n             metrics=['mse'])","c8daf644":"# train the act2vec moedl\nact2vec.fit(x_train,x_train,\n         batch_size=32*6,\n         # epochs=4) # for testing\n         epochs=n_epochs)\nact2vec.save_weights('HAR-act2vec_model.h5')","4f5555b7":"X_train = act2vec.encoder(x_train)\nX_test = act2vec.encoder(x_test)","a7d9264f":"print('Encoded X_train shape is: ', X_train.shape)\nprint('Encoded X_test shape is: ', X_test.shape)","8c06421b":"plot_latent_space(X_train, y_train, 'UCI_HAR_Xtrain_latentspace')","1f570a19":"random_forest_en = rf(X_train, y_train, n_estimators=100) ","28ffa732":"print_result(random_forest_en, X_train, y_train, X_test, y_test)","e0be676d":"LABELS = ['WALKING', 'WALKING_UPSTAIRS', 'WALKING_DOWNSTAIRS', 'SITTING', 'STANDING', 'LAYING']\nplot_confusion_matrix(random_forest_en, X_test, y_test, class_names=LABELS, file_name='HAR_confusionmatrix_en', normalize=True)","3ce77108":"random_forest_raw = rf(x_train.reshape(X_train.shape[0], np.prod(x_train.shape[1:])), y_train, n_estimators=100) ","8c5f85a3":"print_result(random_forest_raw, x_train.reshape(x_train.shape[0], np.prod(x_train.shape[1:])), y_train, x_test.reshape(x_test.shape[0], np.prod(x_test.shape[1:])), y_test)","57171cb5":"LABELS = ['WALKING', 'WALKING_UPSTAIRS', 'WALKING_DOWNSTAIRS', 'SITTING', 'STANDING', 'LAYING']\nplot_confusion_matrix(random_forest_raw, x_test.reshape(x_test.shape[0], np.prod(x_test.shape[1:])), y_test, class_names=LABELS, file_name='HAR_confusionmatrix_raw', normalize=True)","88cb82f3":"### After taining the act2vec model, we can use it to extract fetures","34a9edf4":"Licensed under the MIT License.\n\n# Activity2Vec: Learning ADL Embeddings from Sensor Data with a Sequence-to-Sequence Model\n\nThis notebook provides an example of how to train an Act2Vec model to extract features. We will train an Act2Vec based model on the describe in the paper refrence blow.\n\nIn this notebook, we will train an Act2Vec model on UCI-HAR data, and then employ a random forest as our classifier.\n\nReference: https:\/\/arxiv.org\/abs\/1907.05597","d713ef2e":"### Train random forest on raw data","50ee8eaa":"## UCI-HAR dataset\n\nLet's start with downloading dataset, and load the datasets. ","c8c6682a":"## Encode the data by employing Act2Vec model\n\n### Building an Act2Vec Model","fde96756":"### Train random forest on encoded data"}}