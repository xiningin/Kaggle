{"cell_type":{"9ca572b3":"code","e3577f7c":"code","f8a70d59":"code","9ae7d67a":"code","7756bdb4":"code","07a60de6":"code","70035c31":"code","0c0f51f6":"code","ee80965b":"code","073a6b7f":"code","b4584485":"code","75b989ab":"code","314e1248":"code","7ba5bc1d":"code","5c1b5788":"code","f3cfab49":"markdown","c5139ae4":"markdown","84f80f44":"markdown","596cac0b":"markdown","83b3b4d4":"markdown"},"source":{"9ca572b3":"import pandas as pd\n\n# Feature extraction\nfrom tsfresh import extract_relevant_features\n\n# Model\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import classification_report","e3577f7c":"# Load data set to a pandas DataFrame\ntimeseries = pd.read_csv(\"\/kaggle\/input\/financial-distress\/Financial Distress.csv\")\n# Sort values by time\ntimeseries = timeseries.sort_values(\"Time\")\n\ntimeseries.head()","f8a70d59":"# General overview of the data\ntimeseries.describe()","9ae7d67a":"# Prepare the target variable using the Time,Compaby and target variable\ntarget = timeseries[[\"Time\",\"Company\",\"Financial Distress\"]].sort_values('Time').drop_duplicates(subset='Company',keep='last')\n# Keep the last  measure of Financial Distress for each company\ntarget = target.sort_values(\"Company\").drop(\"Time\",axis=1)\n\ntarget.head()","7756bdb4":"# Drop the target variable from the time series\ntimeseries = timeseries.drop(\"Financial Distress\", axis = 1)","07a60de6":"# Determine wether a company is healthy or not given the Financial Distress value\ndef Distress(row):\n    if row['Financial Distress'] > -.5:\n        return \"Healthy\"\n    else:\n        return \"Distress\"\n    ","70035c31":"# Determine the categorical label of the target variable\ntarget[\"Financial Distress\"] = target.apply(Distress, axis=1)\n#timeseries = timeseries[[\"Company\",\t\"Time\", \"x1\",\t\"x2\",\t\"x3\",\t\"x4\",\t\"x5\",\t\"x6\",\t\"x7\",\t\"x8\",\t\"x9\",\t\"x10\"]]","0c0f51f6":"# target data status\ntarget.head()","ee80965b":"# Set the Company as index\ntarget = target.set_index(\"Company\")","073a6b7f":"# Change the target type to a pandas Series \ntarget = pd.Series(target[\"Financial Distress\"].values, index=target.index,  name=\"Financial Distress\")","b4584485":"# target data status\ntarget.head()","75b989ab":"# Feature extraction and selection of all variables\nfeatures_filtered_direct = extract_relevant_features(timeseries, target, column_id='Company', column_sort='Time')","314e1248":"# Feature overview\nfeatures_filtered_direct.head()","7ba5bc1d":"# Split data\nX_full_train, X_full_test, y_train, y_test = train_test_split(features_filtered_direct, target, test_size=.3)","5c1b5788":"classifier_full = DecisionTreeClassifier()\nclassifier_full.fit(X_full_train, y_train)\nprint(classification_report(y_test, classifier_full.predict(X_full_test)))","f3cfab49":"## Load Data","c5139ae4":"# Multivariate Time Series Feature Extraction and Selection with TSFRESH","84f80f44":"## Feature Extraction and Selection","596cac0b":"In this notebook we will explore the TSFRESH library using a data set dealing with financial distress data for a sample of companies. \n\nThe following information is taken from the data set description. In this data set, each company is identified by a different number in the \"Company\" column. The time recorded for each company varies between 1 and 14.  The target variable is denoted by \"Financial Distress\", for which a company is said to be healthy (0) if the \"Financial Distress\" is greater than -0.50 or in financially distressed (1) otherwise. The temporal features are denoted by x1 to x83, which contain financial and non-financial characteristics of the sampled companies. Feature x80 is categorical.\n\nFor example, company 1 is financially distressed at time 4 but company 2 is still healthy at time 14.\n\nThis data set is imbalanced (there are 136 financially distressed companies against 286 healthy ones i.e., 136 firm-year are financially distressed while 3546 firm-year are healthy) and skewed, so f-score should be employed as the performance evaluation criterion.\n\nIt should be noted that 30% of this data set should be randomly assigned as hold-out test set so the remaining 70% is used for feature selection and model selection i.e., train set.\n\nWe will use the temporal features to determine whether a company is financially distressed at the end of the time series.","83b3b4d4":"## Model Training"}}