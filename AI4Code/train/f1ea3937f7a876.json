{"cell_type":{"7ba93d89":"code","67b9587f":"code","2d910505":"code","34b24bb9":"code","93f9a309":"code","a539d2a7":"code","1c774701":"code","144d1cb6":"code","8514f9cf":"code","a56a66a8":"code","80882420":"code","76c18c8b":"code","2c2ada98":"code","9922828a":"code","243aada3":"markdown","4b6a100a":"markdown","03a3593f":"markdown"},"source":{"7ba93d89":"!git clone https:\/\/github.com\/ultralytics\/yolov5  # clone repo\n%cd yolov5\n!pip install -qr requirements.txt  # install dependencies","67b9587f":"import torch\nfrom IPython.display import Image, clear_output  # to display images\n\nclear_output()\nprint('Setup complete. Using torch %s %s' % (torch.__version__, torch.cuda.get_device_properties(0) if torch.cuda.is_available() else 'CPU'))","2d910505":"import wandb\nfrom kaggle_secrets import UserSecretsClient\nuser_secrets = UserSecretsClient()\nwondb_key = user_secrets.get_secret(\"wondb_key\")\n# !wandb login\nwandb.login(key=wondb_key)","34b24bb9":"%mkdir -p \/kaggle\/dataset\n%cp -r \/kaggle\/input\/coco-vehicle-480\/* \/kaggle\/dataset","93f9a309":"!python train.py --img 416 \\\n--batch 128 \\\n--epochs 100 \\\n--data \"\/kaggle\/input\/coco-vehicle-480\/COCO.yaml\" \\\n--weights \"runs\/train\/exp2\/weights\/best.pt\" \\\n--cfg \"\/kaggle\/input\/coco-vehicle-480\/COCO_yolov5s.yaml\" \\\n--workers 48 \\\n--device 0 \\\n--cache","a539d2a7":"!ls \/kaggle\/dataset\/coco_vehicles_480\/coco_vehicles_480","1c774701":"# %ls runs\/detect\/\n%ls runs\/train\/exp2\/weights\n!ls \/kaggle\/dataset\/coco_vehicles_480\/coco_vehicles_480","144d1cb6":"%cd \/kaggle\/working\/yolov5\/\n!python detect.py --weights runs\/train\/exp2\/weights\/best.pt --img-size 416 --conf 0.4 --source \"\/kaggle\/dataset\/coco_vehicles_480\/coco_vehicles_480\/val\/images\/000000001584.jpg\"\nImage(filename='runs\/detect\/exp9\/000000001584.jpg', width=416)","8514f9cf":"!python models\/export.py --weights runs\/train\/exp2\/weights\/best.pt --img 416 --batch 1  # export at 640x640 with batch size 1","a56a66a8":"!ls runs\/train\/exp2\/weights\/","80882420":"%mkdir -p \"\/kaggle\/working\/yolov5\/models\"\n%cd \"\/kaggle\/working\/yolov5\/models\"\n!cp -r \/kaggle\/working\/yolov5\/runs\/train\/exp2\/weights\/* .\/","76c18c8b":"!chmod -R 777 \/kaggle\/working\/yolov5","2c2ada98":"!ls\n!pwd","9922828a":"import os\nfrom IPython.display import FileLink\nFileLink(r'best.onnx')\nFileLink(r'best.pt')\nFileLink(r'best.torchscript.pt')\nFileLink('last.pt')","243aada3":"## Next is not working","4b6a100a":"## Tests","03a3593f":"<a href=\"\/kaggle\/download\/weights\/best.onnx\"> Download onnx[](https:\/\/) <\/a>"}}