{"cell_type":{"7aa1078e":"code","93668db4":"code","8bb410e2":"code","9dad97c4":"code","12b98ff3":"code","5edc336e":"code","21d17cb4":"code","e2858b7f":"code","c1c373f6":"code","0de09a68":"code","4036f159":"code","f3986cd3":"code","46a30f36":"code","34d350c1":"code","933d05a2":"code","8c8ee5f5":"code","52cfd363":"code","94d1f785":"code","98cee754":"code","ccc17ec9":"code","cf28d44b":"code","117a0d7b":"code","54951dbc":"code","39c02902":"code","efa540e7":"code","6dd21abc":"code","e24eead7":"code","ba741ec0":"code","b01e063e":"code","cddc966f":"code","ddcd696a":"code","013ab790":"code","2268e095":"code","50b73929":"code","4dd15929":"code","48d957ca":"code","510c5df1":"code","b6adc376":"code","5a0ea0da":"code","5a61fe68":"code","a794065e":"markdown","ea8f9cbc":"markdown","b029a1a8":"markdown","e0c54198":"markdown","a2670ea7":"markdown","e2d149e0":"markdown","9ad59999":"markdown","435d6106":"markdown","359febca":"markdown","17d239e4":"markdown","245e197d":"markdown","592bb7d5":"markdown","5b217c29":"markdown","03a0ff72":"markdown","40084dec":"markdown","724ede90":"markdown","332d1fb6":"markdown","ce12ec7e":"markdown","0a4f1425":"markdown","b6ea37f8":"markdown","db9ecedf":"markdown","39e9d8ab":"markdown"},"source":{"7aa1078e":"import numpy as np\nimport pandas as pd","93668db4":"#Download dataset dari kaggle\nfrom google.colab import files\nfrom IPython.display import clear_output\n\nfiles.upload()\n\n! pip install -q kaggle\n! mkdir ~\/.kaggle\n! cp kaggle.json ~\/.kaggle\/\n! chmod 600 ~\/.kaggle\/kaggle.json\n! kaggle competitions download -c bigdata-bps-hackathon-2021\n\nclear_output()\n!ls \/content","8bb410e2":"train_online = pd.read_csv('train-online_booking_2020.csv')\ntrain_online.head(10)","9dad97c4":"train_online.info()","12b98ff3":"train_bps = pd.read_csv('train-TPK_Hotel_berbintang_2020.csv')\ntrain_bps","5edc336e":"train_bps.info()","21d17cb4":"test_bps = pd.read_csv('test-TPK_Hotel_berbintang_2021.csv')\ntest_bps","e2858b7f":"test_online = pd.read_csv('test-online_booking_2021.csv')\ntest_online.head()","c1c373f6":"test_online.info()","0de09a68":"submission = pd.read_csv('sample-submission.csv')\nsubmission","4036f159":"train_online['used_room'] = train_online.room_total-train_online.all_available_room\ntest_online['used_room']  = test_online.room_total - test_online.all_available_room","f3986cd3":"train_online['tanggal'] =  pd.to_datetime(train_online['tanggal'])\ntest_online['tanggal']  =  pd.to_datetime(test_online['tanggal'])","46a30f36":"train_online.head()","34d350c1":"train_online.info()","933d05a2":"import plotly.graph_objects as go\n\ndf  = train_online.set_index(['tanggal']).groupby(['tanggal']).sum()\nfig = go.Figure()\nfig.add_trace(go.Scatter(x=df.index, y=df['used_room'],\n                    mode='lines',\n                    name='Used Rooms'))","8c8ee5f5":"train_online_agg = train_online \\\n                    .set_index(['tanggal']) \\\n                    .groupby(pd.Grouper(freq='M')) \\\n                    .sum()\ntest_online_agg  = test_online \\\n                    .set_index(['tanggal']) \\\n                    .groupby(pd.Grouper(freq='M')) \\\n                    .sum()","52cfd363":"train_online_agg.head()","94d1f785":"test_online_agg.head()","98cee754":"train_online_agg['TPK_Online'] = train_online_agg['used_room']\/train_online_agg['room_total']*100\ntest_online_agg['TPK_Online']  = test_online_agg['used_room']\/test_online_agg['room_total']*100","ccc17ec9":"train_online_agg.head()","cf28d44b":"test_online_agg.head()","117a0d7b":"train_online_agg = train_online_agg.reset_index()\ntest_online_agg  = test_online_agg.reset_index()","54951dbc":"train_online_agg['Id'] = pd. DatetimeIndex(train_online_agg['tanggal']).month\ntest_online_agg['Id']  = pd. DatetimeIndex(test_online_agg['tanggal']).month","39c02902":"train_full = pd.merge(train_online_agg,train_bps,on='Id',how='left')\ntrain_full.head()","efa540e7":"test_full = pd.merge(test_online_agg,test_bps,on='Id',how='left')\ntest_full.head()","6dd21abc":"trainset = train_full[['TPK_Online','TPK']]\ntestset  = test_full[['TPK_Online','TPK']]","e24eead7":"trainset","ba741ec0":"testset","b01e063e":"from sklearn.preprocessing import MinMaxScaler\n# from sklearn.preprocessing import StandardScaler\n\nminmax_scaler_tpk = MinMaxScaler()\ntrainset['TPK_Minmax'] = minmax_scaler_tpk\\\n                        .fit_transform(trainset['TPK'].values.reshape(-1,1))\n\nminmax_scaler_tpk_online = MinMaxScaler()\ntrainset['TPK_O_Minmax'] = minmax_scaler_tpk_online\\\n                           .fit_transform(trainset['TPK_Online'].values.reshape(-1,1))\ntestset['TPK_O_Minmax'] = minmax_scaler_tpk_online\\\n                            .transform(testset['TPK_Online'].values.reshape(-1,1))","cddc966f":"trainset.head()","ddcd696a":"testset.head()","013ab790":"import plotly.graph_objects as go\n\nfig = go.Figure()\nfig.add_trace(go.Scatter(x=trainset.index, y=trainset['TPK'],\n                    mode='lines+markers',\n                    name='TPK BPS'))\nfig.add_trace(go.Scatter(x=trainset.index, y=trainset['TPK_Online'],\n                    mode='lines+markers',\n                    name='TPK Online'))\n\nfig.show()","2268e095":"from sklearn.model_selection import train_test_split\nrandom_seed = 42\n\nX_train, X_test, y_train, y_test = train_test_split(\n    trainset.TPK_O_Minmax,\n    trainset.TPK_Minmax,\n    test_size=0.17,\n    random_state=random_seed\n    )","50b73929":"X_train","4dd15929":"y_train","48d957ca":"X_test","510c5df1":"y_test","b6adc376":"trainset.to_csv('TRAINSET.csv')","5a0ea0da":"testset.to_csv('TESTSET.csv')","5a61fe68":"!ls \/content","a794065e":"### Minmax Scaler","ea8f9cbc":"### Training Data","b029a1a8":"First we need to reset the index and make 'Id' column for join purpose","e0c54198":"First we need to cast field 'tanggal' to datetime type","a2670ea7":"### Calculating Monthly Occupancy Rate","e2d149e0":"## Preprocessing","9ad59999":"### Agregating to Monthly Basis","435d6106":"Once both the data have 'Id' column, we can join them based on that column","359febca":"## Transformation","17d239e4":"## Exporting to CSV","245e197d":"## Load Libriaries","592bb7d5":"## Data Loading","5b217c29":"### Calculating Daily Used Room","03a0ff72":"What is `'Aggregate'` ?","40084dec":"What is `'Aggregate_var'` ?","724ede90":"### Join Datasets","332d1fb6":"### Testing Data","ce12ec7e":"Now we can agregate them","0a4f1425":"### Submission","b6ea37f8":"## Download Kaggle Data","db9ecedf":"As we saw above, we need to select only informative variable in our dataset","39e9d8ab":"## Train-Test Split"}}