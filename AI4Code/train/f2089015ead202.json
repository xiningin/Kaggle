{"cell_type":{"450ccc4e":"code","ba7f83b6":"code","85acca7b":"code","c2bdf22c":"code","10b71dc5":"code","76238b65":"code","1049ebb7":"code","af1719fe":"code","1ec535da":"code","ff9404ec":"code","a6928d8e":"code","3ace2c37":"code","518f4332":"code","973a1caf":"code","324b3cb4":"code","8acd355d":"code","2c1a2a55":"code","68881490":"code","30bf5156":"code","33829a21":"code","2399ee92":"code","b929020b":"code","d93e5842":"code","9494a881":"code","deb5d657":"code","92d34184":"code","ecb6f655":"code","26177ffa":"code","575ef510":"code","f649cf1f":"code","79ba39a1":"code","dd6418c5":"code","fc162b3d":"code","c128a4fa":"code","f8146173":"code","8f4d89c2":"code","e704d46f":"code","f45ee6a7":"code","8a29ee2d":"code","a6fabe98":"code","a0c13d47":"code","955f8376":"code","b649179f":"code","a974908d":"code","6978478e":"code","008da3db":"code","13a90e02":"code","5eae8449":"code","bba43841":"code","69b509cb":"code","b0815c9e":"code","4e5a7546":"code","a2ca8437":"code","f8904f6b":"code","3b65c76d":"code","68cec40d":"markdown","214a683c":"markdown","32620368":"markdown","1805de6e":"markdown","481434b0":"markdown","f791f863":"markdown","e2fe2b3e":"markdown","23760009":"markdown","49be3311":"markdown","5e6e7c0f":"markdown","fb380e04":"markdown","7d409cf5":"markdown","f7f5af56":"markdown","13580212":"markdown","d5807944":"markdown","3105cd5c":"markdown","3c918a16":"markdown","3586ebcf":"markdown","1b2c9215":"markdown","cd14d70a":"markdown","e7b52f4d":"markdown","62c4e964":"markdown","80627945":"markdown","690e7f38":"markdown","99d55e32":"markdown","00c9ea8f":"markdown","edeb6e38":"markdown","f9d84413":"markdown","8919337b":"markdown","52412be9":"markdown","c48935ad":"markdown","7257fa93":"markdown","2b81e72e":"markdown","ca6e69ac":"markdown","50eb5863":"markdown","6580252a":"markdown","23cae5dc":"markdown","c19356d2":"markdown","ceb3f5fb":"markdown","5ffb9080":"markdown","293a5499":"markdown","8a3505a4":"markdown","14a2033c":"markdown","d57c5155":"markdown","f27a7af2":"markdown","a19e6b82":"markdown","3234dd5f":"markdown","a79f20d6":"markdown","846dc2d9":"markdown","b5c72178":"markdown","008a310f":"markdown","5d6f9ba9":"markdown","4d07f1a6":"markdown","45f89d6c":"markdown","068be683":"markdown","e66a22ee":"markdown","cec975d2":"markdown","7a668175":"markdown","162aeb10":"markdown","a96d1ff0":"markdown","3250aebb":"markdown","9fa2c695":"markdown","004ef412":"markdown","106e9d86":"markdown","ec4f6a4b":"markdown","71cf5357":"markdown","9bad3b6c":"markdown","64e64ada":"markdown"},"source":{"450ccc4e":"import numpy as np\nimport pandas as pd\nimport sklearn\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.model_selection import cross_val_score\n","ba7f83b6":"data_train = pd.read_csv(\"..\/input\/adult-pmr3508\/train_data.csv\",\n        index_col=['Id'],engine='python', na_values=\"?\")","85acca7b":"data_train.shape","c2bdf22c":"data_train.head()","10b71dc5":"data_train.info()","76238b65":"data_train.describe()","1049ebb7":"data_test = pd.read_csv(\"..\/input\/adult-pmr3508\/test_data.csv\",\n        index_col=['Id'], na_values=\"?\")","af1719fe":"data_test.shape","1ec535da":"data_test.head()","ff9404ec":"data_test.info()","a6928d8e":"data_test.columns\n","3ace2c37":"data_train['income']","518f4332":"data_train['income'] = LabelEncoder().fit_transform(data_train['income'])","973a1caf":"data_train['income']","324b3cb4":"sns.pairplot(data_train, vars=['age','education.num', 'hours.per.week', 'fnlwgt'], hue=\"income\", palette=\"rocket\")","8acd355d":"plt.figure(figsize=(12, 6))\nsns.heatmap(data=data_train.corr(), cmap='rocket', linewidths=0.3, annot=True)","2c1a2a55":"sns.catplot(x=\"income\", y=\"age\", kind=\"boxen\", data=data_train)","68881490":"sns.catplot(x=\"income\", y=\"education.num\", kind=\"boxen\", data=data_train)","30bf5156":"sns.catplot(x=\"income\", y=\"capital.gain\", kind=\"boxen\", data=data_train)\nsns.catplot(x=\"income\", y=\"capital.gain\", data=data_train)","33829a21":"sns.catplot(x=\"income\", y=\"capital.loss\", kind=\"boxen\", data=data_train)\nsns.catplot(x=\"income\", y=\"capital.loss\", data=data_train)","2399ee92":"sns.catplot(y=\"workclass\", x=\"income\", kind=\"bar\", data=data_train);","b929020b":"sns.catplot(y=\"occupation\", x=\"income\", kind=\"bar\", data=data_train);","d93e5842":"sns.catplot(y=\"relationship\", x=\"income\", kind=\"bar\", data=data_train);","9494a881":"sns.catplot(y=\"race\", x=\"income\", kind=\"bar\", data=data_train);","deb5d657":"sns.catplot(y=\"sex\", x=\"income\", kind=\"bar\", data=data_train);","92d34184":"sns.catplot(y=\"native.country\", x=\"income\", kind=\"bar\", data=data_train);","ecb6f655":"data_train[\"native.country\"].value_counts()","26177ffa":"def native_country_col(value):\n    if value == 'United-States':\n      return 1\n    else:\n      return 0\n\ndata_train['native.country'] = data_train['native.country'].apply(native_country_col)","575ef510":"data_train[\"native.country\"].value_counts()","f649cf1f":"sns.catplot(y=\"native.country\", x=\"income\", kind=\"violin\", data=data_train);","79ba39a1":"data_train['native.country'].describe()","dd6418c5":"data_train.drop_duplicates(keep='first', inplace=True)","fc162b3d":"data_train[['education', 'education.num']].drop_duplicates(subset=['education', 'education.num']).sort_values(by='education.num', ascending=True)","c128a4fa":"data_train = data_train.drop(['fnlwgt', 'education'], axis=1)","f8146173":"plt.figure(figsize=(12, 6))\nsns.heatmap(data_train.isna(), yticklabels=False, cbar=False, cmap='rocket')","8f4d89c2":"data_train.isna().sum()","e704d46f":"data_train = data_train.dropna()\ndata_train.shape","f45ee6a7":"data_train.columns","8a29ee2d":"Y_train = data_train.pop('income')\n","a6fabe98":"num = data_train[['age', 'education.num', 'hours.per.week']].copy()\ncat = data_train[['workclass','marital.status', 'occupation', 'relationship', 'race', 'sex']].copy()\nsparse = data_train[['capital.gain', 'capital.loss', 'native.country']].copy()\n\nnum.reset_index(drop=True, inplace=True)\ncat.reset_index(drop=True, inplace=True)\nsparse.reset_index(drop=True, inplace=True)","a0c13d47":"cat = pd.get_dummies(cat)","955f8376":"cat.head()","b649179f":"cat.drop('sex_Female', axis=1, inplace=True)","a974908d":"def newtable(table, meia_tabela):\n    for i in meia_tabela.columns:\n        table[i] = meia_tabela[i]\n    return table","6978478e":"cat.reset_index(drop=True, inplace=True)\n\nX_train = pd.DataFrame()\n\nX_train = newtable(X_train, cat)\nX_train = newtable(X_train, num)\nX_train = newtable(X_train, sparse)","008da3db":"X_train.columns","13a90e02":"bestScore = 0\nfor i in range (10,36):\n  knn = KNeighborsClassifier(n_neighbors= i)\n  score = cross_val_score(knn, X_train, Y_train, cv = 5, scoring=\"accuracy\")\n  if score.mean() > bestScore:\n    bestScore = score.mean()\n    knnKey = i\n\nprint(\"Acur\u00e1cia com cross validation:\", bestScore.mean())\nprint(\"Melhor K:\",knnKey)\n  \n","5eae8449":"data_test.columns","bba43841":"data_test['native.country'] = data_test['native.country'].apply(native_country_col)\ndata_test.drop_duplicates(keep='first', inplace=True)\ndata_test = data_test.drop(['fnlwgt', 'education'], axis=1)\ndata_test = data_test.dropna()\n\n\nnum_test = data_test[['age', 'education.num', 'hours.per.week']].copy()\ncat_test = data_test[['workclass','marital.status', 'occupation', 'relationship', 'race', 'sex']].copy()\nsparse_test = data_test[['capital.gain', 'capital.loss', 'native.country']].copy()\n\nnum_test.reset_index(drop=True, inplace=True)\ncat_test.reset_index(drop=True, inplace=True)\nsparse_test.reset_index(drop=True, inplace=True)\n\ncat_test = pd.get_dummies(cat_test)\n\ncat_test.drop('sex_Female', axis=1, inplace=True)\n\ncat_test.reset_index(drop=True, inplace=True)\n\nX_test = pd.DataFrame()\n\nX_test = newtable(X_test, cat_test)\nX_test = newtable(X_test, num_test)\nX_test = newtable(X_test, sparse_test)","69b509cb":"X_test.head()","b0815c9e":"knn = KNeighborsClassifier(n_neighbors=14)\nknn.fit(X_train, Y_train)\npredicao = knn.predict(X_test)","4e5a7546":"predict_df = pd.DataFrame()\npredict_df[0] = X_test.index\npredict_df[1] = predicao\npredict_df.columns = ['Id','Income']\npredict_df.set_index('Id', inplace=True)","a2ca8437":"predict_df[predict_df['Income'] == 0] = '<=50K'\npredict_df[predict_df['Income'] == 1] = '>50K'","f8904f6b":"predict_df.head()","3b65c76d":"predict_df.to_csv('predict_df.csv')","68cec40d":"Com o uso do <i>sns.plairplot<\/i>, \u00e9 poss\u00edvel entender a correla\u00e7\u00e3o entre as os dados num\u00e9ricos.\n\n","214a683c":"##Dados duplicados","32620368":"<p>Com a fun\u00e7\u00e3o <i>columns<\/i>, podemos obter a lista de colunas que o dataframe possui.<\/p>","1805de6e":"<p><strong>Capital.gain e Capital.loss<\/strong><\/p>","481434b0":"<p><\/p>\n<span>O n\u00famero de dados n\u00e3o nulos e o tipo de dado que \u00e9 oferecido:<\/span>","f791f863":"A priori, vamos excluir todos os dados duplicados.","e2fe2b3e":"Ao olhar os n\u00fameros, percebemos a predomin\u00e2ncia que os estadounidenses possuem. Para resolver isso, iremos separar entre estadounidenses e estrangeiros.","23760009":"J\u00e1 com a analise desta coluna, tamb\u00e9m \u00e9 poss\u00edvel afirmar que, quanto maior seu n\u00edvel educacional, maior \u00e9 a chance de ter uma renda alta.","49be3311":"<h1><strong>PMR 3508 - Aprendizado de m\u00e1quina e reconhecimento de padr\u00f5es<\/strong> <\/h1>\n<p> An\u00e1lise e classifica\u00e7\u00e3o a partir de uma base de dados.<\/p>\n<span>Maria Fernanda Fernandes Rezende<\/span>\n\n\n","5e6e7c0f":"##Predi\u00e7\u00e3o","fb380e04":"A partir da an\u00e1lise do gr\u00e1fico e da matriz, \u00e9 percept\u00edvel que a tabela *fnlwgt* n\u00e3o \u00e9 muito relevante, em contraste com *education.num* e *age*.","7d409cf5":"Apesar das varia\u00e7\u00f5es, \u00e9 poss\u00edvel afirmar que pessoas que trabalham autonomamente enquanto associadas a uma empresa s\u00e3o as que tem mais chance de ganhar bem.","f7f5af56":"##Missing data","13580212":"###Pairplot","d5807944":"Aqui a an\u00e1lise ser\u00e1 feita por meio de um gr\u00e1fico de barras. As linhas pretas representam as varia\u00e7\u00f5es dentro de uma certa *feature*","3105cd5c":"Como a tabela education e education.num se referem a mesma coisa, iremos excluir a tabela *education*","3c918a16":"<p>Al\u00e9m dos dados de treino, tamb\u00e9m vamos importar os dados de teste e fazer a mesma an\u00e1lise<\/p>","3586ebcf":"<p><strong>Race<\/strong><\/p>","1b2c9215":"E com a ajuda da fun\u00e7\u00e3o *pd.get_dummies* vamos transformar os dados categ\u00f3ricos em num\u00e9ricos","cd14d70a":"<p><strong>Relationship<\/strong><\/p>","e7b52f4d":"<p><strong>Sex<\/strong><\/p>","62c4e964":"Agora, \u00e9 preciso aglutinar as fun\u00e7\u00f5es. Para isso, criaremos uma fun\u00e7\u00e3o que far\u00e1 isso e iremos aplic\u00e1-la nas separa\u00e7\u00f5es feitas.","80627945":"<p><strong>Occupation<\/strong><\/p>","690e7f38":"###An\u00e1lise individual","99d55e32":"##Importando bibliotecas","00c9ea8f":"##Distribui\u00e7\u00e3o dos dados de acordo com o r\u00f3tulo","edeb6e38":"<p> <strong> Age <\/strong> <\/p>","f9d84413":"### Variaveis n\u00e3o num\u00e9ricas\n","8919337b":"<p>Aqui, iremos importar algumas bibliotecas necess\u00e1rias para a an\u00e1lise de dados. As bibliotecas utilizadas ser\u00e3o a <i>numpy, pandas, sklearn, seaborn e matplot <\/i> . Todas essas bibliotecas possuem fun\u00e7\u00f5es extremamente necess\u00e1rias para a an\u00e1lise de dados.<\/p>","52412be9":"Primeiramente, vamos separar o r\u00f3tulo das vari\u00e1veis","c48935ad":"Aqui, \u00e9 poss\u00edvel prever as profiss\u00f5es que ganham mais. Al\u00e9m disso, trabalhadores das for\u00e7as armadas costumam apresentar uma alta varia\u00e7\u00e3o de renda.","7257fa93":"Agora que j\u00e1 descobrimos qual \u00e9 o melhor K para ser usado no knn, iremos aplicar nos dados de teste.","2b81e72e":"Primeiro, iremos analisar a quantidade de dados faltantes existentes e aonde eles est\u00e3o.","ca6e69ac":"E, finalmente, iremos aplicas o KNN nos dados de teste","50eb5863":"Agora, \u00e9 s\u00f3 converter para um arquivo <i>.csv","6580252a":"#Explorando os dados","23cae5dc":"<p>Nesta se\u00e7\u00e3o ser\u00e1 feita uma an\u00e1lise mais profunda sobre os significados dos dados<\/p>","c19356d2":"Al\u00e9m disso, a tabela *fnlwgt* tamb\u00e9m j\u00e1 foi considerada como pouco relevante, ent\u00e3o tamb\u00e9m iremos exclu\u00ed-la","ceb3f5fb":"Ao analisar esta coluna, \u00e9 poss\u00edvel afirmar que as pessoas que tem entre 35 e 50 anos costumam ganhar mais que os mais novos.","5ffb9080":"<p><\/p>\n<span>Como ele se parece:<\/span>","293a5499":"<p><strong>Education.num<\/strong><\/p>","8a3505a4":"<p>A priori, vamos transformar a se\u00e7\u00e3o \"income\" em uma se\u00e7\u00e3o num\u00e9rica para tornar a tarefa de mapeamento de gr\u00e1ficos mais f\u00e1cil. Essa tarefa ser\u00e1 feita com a fun\u00e7\u00e3o <i>LabelEncoder<\/i>, importada na primeira se\u00e7\u00e3o. Assim, quem ganha mais de 50 mil por ano ter\u00e1 o n\u00famero 1<\/p>","14a2033c":"A partir disso, \u00e9 poss\u00edvel afirmar que as chances de estrangeiros e nativos ganharem uma renda alta s\u00e3o similares.","d57c5155":"J\u00e1 neste gr\u00e1fico, percebe-se uma grande disparidade. Enquanto brancos e americanos asi\u00e1ticos tem altas chances de ganhar bem, pessoas de outras etnias acabam tendo menos probabilidades de terem uma renda acima de 50 mil.","f27a7af2":"<p>Nesta se\u00e7\u00e3o, iremos ler o dataframe disponibilizado em csv. Para isso, utilizaremos a fun\u00e7\u00e3o <i>pd.read_csv()<\/i> que faz parte da biblioteca pandas e permite que o programa interprete os dados.<\/p>","a19e6b82":"<p>Apenas com o uso do <i>describe<\/i> \u00e9 poss\u00edvel perceber que algumas vari\u00e1veis s\u00e3o extremamente esparsas, como o <i> capital gain e capital loss<\/i><\/p>","3234dd5f":"Dado que a categoria \"sex_Female\" \u00e9 quase que um pleonasmo de \"sex_Male\". Portanto, iremos elimin\u00e1-la","a79f20d6":"Agora precisamos criar um novo dataframe com o Id e com a income prevista","846dc2d9":"##Lendo as informa\u00e7\u00f5es","b5c72178":"Lembra quando convertemos os dados da income para dados n\u00famerios? Ent\u00e3o, precisamos reverter esse ato","008a310f":"Assim, as features categ\u00f3ricas ter\u00e3o a seguinte face","5d6f9ba9":"#**Importando dados**\n<p>Antes de analisar e classificar os dados, \u00e9 necess\u00e1rio executar algumas tarefas rotineiras, como a importa\u00e7\u00e3o de bibliotecas e a importa\u00e7\u00e3o dos dados que ser\u00e3o analisados.<\/p>\n","4d07f1a6":"Aqui \u00e9 poss\u00edvel afirmar que pessoas casadas costumam ter uma renda maior.","45f89d6c":"<p><strong>Workclass<\/strong><\/p>","068be683":"Assim, a tabela fica da seguinte forma:","e66a22ee":"<p><\/p>\n<span>E algumas estat\u00edsticas sobre a varia\u00e7\u00e3o dos dados:<\/span>","cec975d2":"<p> Com as fun\u00e7\u00f5es <i>shape, head, info e describe<\/i> podemos descobrir algumas caracter\u00edsticas do dataframe<\/p>\n<span>Como seu tamanho de linhas e colunas, respectivamente<\/span>","7a668175":"Primeiramente, iremos aplicar todos os tratamentos que foram feitos anteriormente nos dados de teste.","162aeb10":"Aqui, al\u00e9m de existirem muitos pa\u00edses, a varia\u00e7\u00e3o dentro de cada feature \u00e9 gigantesca.\n\nPara melhor compreender a distribui\u00e7\u00e3o de nacionalidades, iremos usar a fun\u00e7\u00e3o *value_counts()*.\n","a96d1ff0":"#Limpeza e tratamento de dados de dados","3250aebb":"E neste gr\u00e1fico, outra desigualdade \u00e9 observada, uma vez que homens tem mais probabilidade de terem uma renda maior.","9fa2c695":"Durante a leitura das informa\u00e7\u00f5es, a esparsidade dessas colunas foi notada. Com a an\u00e1lise gr\u00e1fica isto se torna ainda mais vis\u00edvel.","004ef412":"Analisando isso, apesar de existirem modos de imputa\u00e7\u00e3o de dados, eu decidi excluir os dados faltantes.\n","106e9d86":"#Aplicando nos dados de teste","ec4f6a4b":"E o nosso dataframe ficou deste jeito:","71cf5357":"E agora, usando o KNN, iremos analisar os dados.","9bad3b6c":"<p><strong>Native.country<\/strong><\/p>","64e64ada":"E com o *heatmap* essas correla\u00e7\u00f5es s\u00e3o refor\u00e7adas"}}