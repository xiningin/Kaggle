{"cell_type":{"e4cc29b3":"code","03b17264":"code","667c09e4":"code","8d32d964":"code","b510ab44":"code","b525df61":"code","71d481e0":"code","8920b926":"code","250a001a":"code","3a57c903":"code","24abba0d":"code","c599b591":"code","0ed69202":"markdown"},"source":{"e4cc29b3":"import pandas as pd\nimport numpy as np\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import train_test_split\n#!pip install lightgbm\nimport lightgbm as lgb","03b17264":"#\uc790\uc2e0\uc758 \ub370\uc774\ud130\uacbd\ub85c\uc5d0 \ub9de\uac8c \uc218\uc815\ud558\uc2dc\uba74 \ub429\ub2c8\ub2e4\nX_train = pd.read_csv(\"..\/input\/kaistbme587\/X_train.csv\")\nX_test = pd.read_csv(\"..\/input\/kaistbme587\/X_test.csv\")","667c09e4":"X_test.head()","8d32d964":"X_train = X_train.fillna(-1)\nX_test = X_test.fillna(-1)","b510ab44":"for col in (X_train.columns):\n    if X_train[col].dtype == 'object':\n        enc = LabelEncoder()\n        enc.fit(list(X_train[col].values) + list(X_test[col].values))\n        X_train[col] = enc.transform(list(X_train[col].values))\n        X_test[col] = enc.transform(list(X_test[col].values)) ","b525df61":"X = X_train.iloc[:,1:]\ny = X_train.iloc[:,0]","71d481e0":"\nX_train, X_val, y_train, y_val = train_test_split(X, y, test_size=0.2, random_state=42)","8920b926":"params = {\n          'learning_rate': 0.005,\n          \"boosting_type\": \"gbdt\",\n          'objective': 'binary',\n          \"metric\": 'auc',\n          \"verbosity\": -1,\n          'random_state': 1028\n         }","250a001a":"trn_data = lgb.Dataset(X_train, label=y_train)\nval_data = lgb.Dataset(X_val, label=y_val)\nclf = lgb.train(params, trn_data, 10000, valid_sets = [trn_data, val_data], verbose_eval=1000, early_stopping_rounds=500)","3a57c903":"best_iter = clf.best_iteration","24abba0d":"clf = lgb.LGBMClassifier(**params, num_boost_round=best_iter)\nclf.fit(X, y)","c599b591":"sub = pd.read_csv(\"..\/input\/kaistbme587\/sample_submission.csv\")\nsub['Fraud'] = clf.predict_proba(X_test.iloc[:,1:])[:, 1]\nsub.to_csv('baseline4.csv', index=False)","0ed69202":"Light GBM \uc740 gradient boosting \uc744 \uc544\uc8fc \ud6a8\uc728\uc801\uc73c\ub85c \ud560 \uc218 \uc788\ub3c4\ub85d \uc124\uacc4\ub41c \ubaa8\ub378\uc774\ub2e4.\nRandomForest\ub3c4 \uad1c\ucc2e\uc740 \uc54c\uace0\ub9ac\uc998\uc774\uc9c0\ub9cc, general \ud55c \uc131\ub2a5 \uba74\uc5d0\uc11c Light GBM\uc774 \ud604\uc7ac Gradient Boosting \uc54c\uace0\ub9ac\uc998,\n\uc989 \uc774\ub7f0 \uc815\ud615\ud654\ub41c \ub370\uc774\ud130\uc5d0\uc11c prediction\uc744 \ud558\ub294\ub370 \ud604\uc874\ud558\ub294 \ubaa8\ub378\uc911\uc5d0 \uac00\uc7a5 \uc88b\uc740\ud3b8\uc5d0 \uc18d\ud558\uae30 \ub54c\ubb38\uc5d0 \uc0ac\uc6a9\ud558\ub294 \ubc29\ubc95\uc744 \uc18c\uac1c\ud55c\ub2e4.\n\nlightgbm\uc744 \uc0ac\uc6a9\ud558\uae30 \uc704\ud574\uc11c\ub294 \ud30c\uc774\uc36c\uc5d0\uc11c lightgbm \ud328\ud0a4\uc9c0\ub97c \uc6b0\uc120 \uc124\uce58\ud574\uc57c\ud55c\ub2e4.\n\nlightgbm\uc5d0 \uc5ec\ub7ec\uac00\uc9c0 \ud30c\ub77c\ubbf8\ud130\uac00\uc788\uc9c0\ub9cc, \uc6b0\uc120 \uc544\uc8fc \uac04\ub2e8\ud558\uac8c \ud30c\ub77c\ubbf8\ud130\ub97c \uc124\uc815\ud55c\ub2e4.\n\nlightgbm\uc5d0\uc11c\ub294 \ub370\uc774\ud130 \ud504\ub808\uc784\uad6c\uc870\ub97c lightgbm\uc5d0 \ub9de\ub294 \ub370\uc774\ud130\uc14b\uad6c\uc870\ub85c \ubcc0\ud654\uc2dc\ud0a4\ub294\uac83\uc744 \uc694\uad6c\ud558\uba70,\n\nlgb.Dataset() \uba85\ub839\uc5b4\ub85c \uc774\ub97c \ucc98\ub9ac\ud55c\ub2e4.\n\n\ub450\uce78 \ubc11\uc758 \uc140\uc744 \ubcf4\uba74 \uc774\ud574\ud560\uc218 \uc788\uc744 \uac83\uc774\ub2e4.\n\n\uadf8 \ud6c4 \ud559\uc2b5\uc740 lgb.train() \uc73c\ub85c \uc9c4\ud589\ud55c\ub2e4. boosting\uc744 \uba87\ubc88 \ud560 \uac83\uc778\uc9c0\ub97c \uacb0\uc815\ud574\uc57c\ud558\uba70, 10000\ubc88\uc744 \uae30\uc900\uc73c\ub85c valid set\uc758 auc\uac00 \uc904\uc5b4\ub4e4\uba74 stopping \ud558\ub3c4\ub85d \uc124\uacc4\ud588\ub2e4.\n\nLight GBM\uc744 \ucf54\ub4dc\uc5d0 \uc801\uc6a9\ud558\ub294 \uac70\ub9cc\uc73c\ub85c\ub3c4 Random Forest\ubcf4\ub2e4 \uc88b\uc740 \uacb0\uacfc\ub97c \ubf51\uc744 \ud655\ub960\uc774 \ub9e4\uc6b0 \ud06c\ub2e4.\n\n\ubc29\ubc95\ub860\ud558\ub098\uc815\ub3c4\ub294 get \ud558\uace0 \uac00\ub294\uac78\ub85c~~"}}