{"cell_type":{"633617d7":"code","4840e582":"code","29e7f1eb":"code","6f51f4da":"code","38c1264c":"code","b3479d8c":"code","51414bde":"code","17073b0d":"code","de842164":"code","d296c228":"code","f664c406":"code","486a6f34":"code","3639fa18":"code","aaab24fe":"code","51d88665":"code","333b5c19":"code","8399025c":"code","7040c2dc":"code","934ea28b":"code","8d87f62e":"code","4b57ad9f":"code","ee11ac0a":"code","0f96e9c7":"code","cee1b6f4":"code","4ea3ec7f":"code","7915adda":"code","6b062631":"code","14bf4cc7":"code","cb92474d":"code","a95451e1":"code","9ca24610":"code","2a6b1419":"code","7f4c4e26":"code","38a8c343":"code","7813bb1b":"code","3a000f6e":"code","7d114203":"code","ec7d3fab":"code","4e6a9e3b":"code","0a2624c2":"code","bcb8f058":"code","78ed5ee7":"code","3b8763dd":"markdown","e936aa57":"markdown","d61fbcee":"markdown","f8659cee":"markdown","f5de5a9a":"markdown","8e41e7a5":"markdown","ae0c0afa":"markdown","645010cd":"markdown","011323f1":"markdown","34185d58":"markdown","f9c7957a":"markdown","2bc621b6":"markdown","4b5be735":"markdown","cf2533ab":"markdown","a06aeca9":"markdown","b5fa274d":"markdown","d1233afc":"markdown"},"source":{"633617d7":"import pandas as pd\nimport sklearn\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.metrics import accuracy_score\nfrom sklearn import preprocessing\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nplt.rcParams[\"figure.figsize\"] = (10, 6)","4840e582":"adult_train = pd.read_csv(\"\/kaggle\/input\/adult-pmr3508\/train_data.csv\", na_values='?', index_col= 0)\nadult_test = pd.read_csv(\"\/kaggle\/input\/adult-pmr3508\/test_data.csv\", na_values='?', index_col= 0)","29e7f1eb":"#Mostra o formato da base de dados\nadult_train.shape","6f51f4da":"#Mostra algumas informa\u00e7\u00f5es das features\nadult_train.info()","38c1264c":"adult_test.shape","b3479d8c":"#Mostra o in\u00edcio da base de dados\nadult_train.head()","51414bde":"adult_test.tail()","17073b0d":"#Mostra o final da base de dados\nadult_train.tail()","de842164":"# Mudando a feature income para melhor tratamento\n# <=50k = 0, >50k = 1\n\n\nadult_train [\"income\"] = np.where(adult_train[\"income\"] == \"<=50K\", 0, 1)","d296c228":"#Verificando a mudan\u00e7a\nadult_train.head()","f664c406":"adult_train.isnull().sum()","486a6f34":"adult_test.isnull().sum()","3639fa18":"plt.figure(figsize = (20,10))\nsns.heatmap(adult_train.corr(), cmap='BuPu', annot = True, fmt = '.2f')\nplt.show()","aaab24fe":"# Retirando a coluna\nadult_train.drop('fnlwgt', axis = 1, inplace = True)","51d88665":"# Verificando a mudan\u00e7a\nadult_train.head()","333b5c19":"adult_test.drop('fnlwgt', axis = 1, inplace = True)","8399025c":"# Verifica o n\u00famero de pessoas que possuem cada tipo de income\n_ = adult_train[\"income\"].value_counts().plot(kind = \"bar\", color = \"purple\")\n_ = plt.title(\"N\u00b0 de pessoas por tipo de income\")","7040c2dc":"sns.catplot(y=\"age\", x=\"income\", kind=\"bar\", data= adult_train);","934ea28b":"sns.catplot(y=\"sex\", x=\"income\", kind=\"bar\", data= adult_train);","8d87f62e":"sns.catplot(y=\"workclass\", x=\"income\", kind=\"bar\", data= adult_train);","4b57ad9f":"sns.catplot(y=\"education\", x=\"income\", kind=\"bar\", data= adult_train);","ee11ac0a":"sns.catplot(y=\"marital.status\", x=\"income\", kind=\"bar\", data= adult_train);","0f96e9c7":"sns.catplot(y=\"occupation\", x=\"income\", kind=\"bar\", data= adult_train);","cee1b6f4":"sns.catplot(y=\"relationship\", x=\"income\", kind=\"bar\", data= adult_train);","4ea3ec7f":"sns.catplot(y=\"race\", x=\"income\", kind=\"bar\", data= adult_train);","7915adda":"sns.catplot(y=\"hours.per.week\", x=\"income\", kind=\"bar\", data= adult_train);","6b062631":"nadult_train = adult_train.fillna(\"0\")\nnadult_test = adult_test.fillna(\"0\")","14bf4cc7":"# Verificando a mudan\u00e7a\nnadult_train.isnull().sum()","cb92474d":"numadult_train = nadult_train.apply(preprocessing.LabelEncoder().fit_transform)\nnumadult_test = nadult_test.apply(preprocessing.LabelEncoder().fit_transform)","a95451e1":"Xadult_train = numadult_train[[\"age\",\"workclass\",\"education.num\",\"marital.status\",\"occupation\", \"relationship\", \"race\", \"sex\", \"capital.gain\",\"capital.loss\",\"hours.per.week\"]]\nYadult_train = numadult_train.income","9ca24610":"Xadult_test = numadult_test[[\"age\",\"workclass\",\"education.num\",\"marital.status\",\"occupation\", \"relationship\", \"race\", \"sex\", \"capital.gain\",\"capital.loss\",\"hours.per.week\"]]","2a6b1419":"Xadult_train.head()","7f4c4e26":"maior_acc = 0\nmaior_k = 0\nfor k in range (15, 31):\n    knn = KNeighborsClassifier(n_neighbors = k)\n    score = cross_val_score(knn, Xadult_train, Yadult_train, cv=10, scoring = 'accuracy').mean()\n    print(f\"k = {k}, acc = {score}\")\n    if score > maior_acc:\n        maior_k = k\n        maior_acc = score\n\nprint(\"Melhor K = \" + str(maior_k) + \" e acur\u00e1cia = \" + str(maior_acc))","38a8c343":"knn = KNeighborsClassifier(n_neighbors = maior_k)","7813bb1b":"knn.fit(Xadult_train, Yadult_train)","3a000f6e":"Xadult_train.head()","7d114203":"Xadult_test.head()","ec7d3fab":"Xadult_test.tail()","4e6a9e3b":"YPrediction = knn.predict(Xadult_test)\nYPrediction","0a2624c2":"incomes = []\nfor income in YPrediction:\n    if income == 0:\n        incomes.append('<=50K')\n    else:\n        incomes.append('>50K')\n\nAdultsubmission = pd.DataFrame()\nAdultsubmission[0] = Xadult_test.index\nAdultsubmission[1] = incomes\nAdultsubmission.columns = ['Id', 'income']\nAdultsubmission.head()","bcb8f058":"Adultsubmission.tail()","78ed5ee7":"# Salvando o csv\nAdultsubmission.to_csv('adultsubmission.csv', index = False)","3b8763dd":"Transformando dados n\u00e3o num\u00e9ricos para num\u00e9ricos","e936aa57":"## Classificador","d61fbcee":"Gr\u00e1fico de correla\u00e7\u00e3o para analisar a rela\u00e7\u00e3o entre as features","f8659cee":"## Verifica\u00e7\u00e3o de dados faltantes","f5de5a9a":"## Importando Pacotes e settings","8e41e7a5":"Nota-se que a coluna \"fnlwgt\" n\u00e3o possui uma rela\u00e7\u00e3o boa com income, dentre as vari\u00e1veis num\u00e9ricas, portanto, ela ser\u00e1 retirada","ae0c0afa":"### Analisando rela\u00e7\u00f5es entre algumas vari\u00e1veis e o income","645010cd":"## An\u00e1lise explorat\u00f3ria dos dados","011323f1":"Prevendo os valores do income da base de teste","34185d58":"Sele\u00e7\u00e3o de atributos","f9c7957a":"Fazendo o mesmo com os dados de teste","2bc621b6":"Ajustando o dataframe","4b5be735":"# Classifica\u00e7\u00e3o com Adult set\n","cf2533ab":"## Visualizando algumas informa\u00e7\u00f5es do Dataset","a06aeca9":"## Coletando as bases de dados de treino e teste","b5fa274d":"Retirando dados faltantes","d1233afc":"Tratando dados faltantes"}}