{"cell_type":{"1a0dc5db":"code","996989f5":"code","afc7144b":"code","0e231515":"code","000fa745":"code","1de9a344":"code","cbf7e363":"code","0ab322ae":"code","8a54caed":"code","84fab831":"code","97fb8b0b":"code","66e818bd":"code","25396cf9":"code","70b80487":"code","b6f938b9":"code","76ab77c0":"code","1b0e9484":"code","05a35678":"code","ef13362d":"code","d5855f2a":"code","a2b78081":"code","5c298094":"code","cfec5f07":"code","f8d0580e":"code","f6dc1e93":"code","042710d1":"code","1781209b":"code","b83d3e50":"code","5bc11278":"code","c186c6e7":"code","f9710f6b":"code","6c1126c1":"code","ab8f8ae0":"code","00faea9d":"code","4bb5518f":"code","0e120063":"code","2c64bb64":"code","a0ecb06c":"code","01af7a9a":"code","ce7db645":"code","6870610f":"code","a5440c8b":"code","7068e700":"code","86a08484":"code","3031faf3":"code","ce6e6e1f":"code","253e2619":"code","718d47c1":"code","9100e561":"code","f340f2a9":"code","e324bf0f":"code","96f38a47":"code","5f548b24":"code","a61bbb70":"code","93b3ff4b":"code","5f7d5005":"code","bf207581":"code","cd3d96b5":"code","3c40d8d9":"code","cc792f93":"code","de562548":"markdown"},"source":{"1a0dc5db":"#https:\/\/www.kaggle.com\/valleyzw\/petfinder-duplicate-images\n\nsims = ['13d215b4c71c3dc603cd13fc3ec80181_373c763f5218610e9b3f82b12ada8ae5',\n       '5ef7ba98fc97917aec56ded5d5c2b099_67e97de8ec7ddcda59a58b027263cdcc',\n       '839087a28fa67bf97cdcaf4c8db458ef_a8f044478dba8040cc410e3ec7514da1',\n       '1feb99c2a4cac3f3c4f8a4510421d6f5_264845a4236bc9b95123dde3fb809a88',\n       '3c50a7050df30197e47865d08762f041_def7b2f2685468751f711cc63611e65b',\n       '37ae1a5164cd9ab4007427b08ea2c5a3_3f0222f5310e4184a60a7030da8dc84b',\n       '5a642ecc14e9c57a05b8e010414011f2_c504568822c53675a4f425c8e5800a36',\n       '2a8409a5f82061e823d06e913dee591c_86a71a412f662212fe8dcd40fdaee8e6',\n       '3c602cbcb19db7a0998e1411082c487d_a8bb509cd1bd09b27ff5343e3f36bf9e',\n       '0422cd506773b78a6f19416c98952407_0b04f9560a1f429b7c48e049bcaffcca',\n       '68e55574e523cf1cdc17b60ce6cc2f60_9b3267c1652691240d78b7b3d072baf3',\n       '1059231cf2948216fcc2ac6afb4f8db8_bca6811ee0a78bdcc41b659624608125',\n       '5da97b511389a1b62ef7a55b0a19a532_8ffde3ae7ab3726cff7ca28697687a42',\n       '78a02b3cb6ed38b2772215c0c0a7f78e_c25384f6d93ca6b802925da84dfa453e',\n       '08440f8c2c040cf2941687de6dc5462f_bf8501acaeeedc2a421bac3d9af58bb7',\n       '0c4d454d8f09c90c655bd0e2af6eb2e5_fe47539e989df047507eaa60a16bc3fd',\n       '5a5c229e1340c0da7798b26edf86d180_dd042410dc7f02e648162d7764b50900',\n       '871bb3cbdf48bd3bfd5a6779e752613e_988b31dd48a1bc867dbc9e14d21b05f6',\n       'dbf25ce0b2a5d3cb43af95b2bd855718_e359704524fa26d6a3dcd8bfeeaedd2e',\n       '43bd09ca68b3bcdc2b0c549fd309d1ba_6ae42b731c00756ddd291fa615c822a1',\n       '43ab682adde9c14adb7c05435e5f2e0e_9a0238499efb15551f06ad583a6fa951',\n       'a9513f7f0c93e179b87c01be847b3e4c_b86589c3e85f784a5278e377b726a4d4',\n       '38426ba3cbf5484555f2b5e9504a6b03_6cb18e0936faa730077732a25c3dfb94',\n       '589286d5bfdc1b26ad0bf7d4b7f74816_cd909abf8f425d7e646eebe4d3bf4769',\n       '9f5a457ce7e22eecd0992f4ea17b6107_b967656eb7e648a524ca4ffbbc172c06',\n       'b148cbea87c3dcc65a05b15f78910715_e09a818b7534422fb4c688f12566e38f',\n       '3877f2981e502fe1812af38d4f511fd2_902786862cbae94e890a090e5700298b',\n       '8f20c67f8b1230d1488138e2adbb0e64_b190f25b33bd52a8aae8fd81bd069888',\n       '221b2b852e65fe407ad5fd2c8e9965ef_94c823294d542af6e660423f0348bf31',\n       '2b737750362ef6b31068c4a4194909ed_41c85c2c974cc15ca77f5ababb652f84',\n       '01430d6ae02e79774b651175edd40842_6dc1ae625a3bfb50571efedc0afc297c',\n       '72b33c9c368d86648b756143ab19baeb_763d66b9cf01069602a968e573feb334',\n       '03d82e64d1b4d99f457259f03ebe604d_dbc47155644aeb3edd1bd39dba9b6953',\n       '851c7427071afd2eaf38af0def360987_b49ad3aac4296376d7520445a27726de',\n       '54563ff51aa70ea8c6a9325c15f55399_b956edfd0677dd6d95de6cb29a85db9c',\n       '87c6a8f85af93b84594a36f8ffd5d6b8_d050e78384bd8b20e7291b3efedf6a5b',\n       '04201c5191c3b980ae307b20113c8853_16d8e12207ede187e65ab45d7def117b']","996989f5":"import pandas as pd\nimport sys\nsys.path.append('..\/input\/timm-pytorch-image-models\/pytorch-image-models-master')\nfrom timm import create_model","afc7144b":"from fastai.vision.all import *","0e231515":"dataset_path = Path('..\/input\/petfinder-pawpularity-score')\ntrain_df = pd.read_csv(dataset_path\/'train.csv')\ntrain_df.head()","000fa745":"get_id = []\nid_1_list = []\nid_2_list = []\nfor s in sims:\n    id_1, id_2 = s.split('_')[0], s.split('_')[1]\n    id_1_list.append(id_1)\n    id_2_list.append(id_2)\n    id_1_paw = train_df[train_df['Id'] == id_1]['Pawpularity'].iloc[-1]\n    id_2_paw = train_df[train_df['Id'] == id_2]['Pawpularity'].iloc[-1]","1de9a344":"train_df['path'] = train_df['Id'].map(lambda x:str(dataset_path\/'train'\/x)+'.jpg')\n#train_df = train_df.drop(columns=['Id'])\n#train_df = train_df.sample(frac=1).reset_index(drop=True) #shuffle dataframe\ntrain_df.head()","cbf7e363":"def get_concat_h(im1, im2):\n    im1 = im1.resize((224,224))\n    im2 = im2.resize((224,224))\n    dst = Image.new('RGB', (im1.width + im2.width, im1.height))\n    dst.paste(im1, (0, 0))\n    dst.paste(im2, (im1.width, 0))\n    return dst","0ab322ae":"print(id_1_list[0], id_2_list[0])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[0]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[0]]['path'].iloc[0])\nget_concat_h(im1, im2)","8a54caed":"print(train_df[train_df['Id']=='5ef7ba98fc97917aec56ded5d5c2b099']['Pawpularity'])\nprint(train_df[train_df['Id']=='67e97de8ec7ddcda59a58b027263cdcc']['Pawpularity'])","84fab831":"print(id_1_list[1], id_2_list[1])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[1]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[1]]['path'].iloc[0])\nget_concat_h(im1, im2)","97fb8b0b":"print(id_1_list[2], id_2_list[2])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[2]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[2]]['path'].iloc[0])\nget_concat_h(im1, im2)","66e818bd":"print(id_1_list[3], id_2_list[3])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[3]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[3]]['path'].iloc[0])\nget_concat_h(im1, im2)","25396cf9":"print(id_1_list[4], id_2_list[4])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[4]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[4]]['path'].iloc[0])\nget_concat_h(im1, im2)","70b80487":"print(id_1_list[5], id_2_list[5])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[5]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[5]]['path'].iloc[0])\nget_concat_h(im1, im2)","b6f938b9":"print(id_1_list[6], id_2_list[6])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[6]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[6]]['path'].iloc[0])\nget_concat_h(im1, im2)","76ab77c0":"print(id_1_list[7], id_2_list[7])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[7]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[7]]['path'].iloc[0])\nget_concat_h(im1, im2)","1b0e9484":"print(id_1_list[8], id_2_list[8])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[8]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[8]]['path'].iloc[0])\nget_concat_h(im1, im2)","05a35678":"print(id_1_list[9], id_2_list[9])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[9]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[9]]['path'].iloc[0])\nget_concat_h(im1, im2)","ef13362d":"print(id_1_list[10], id_2_list[10])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[10]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[10]]['path'].iloc[0])\nget_concat_h(im1, im2)","d5855f2a":"print(id_1_list[11], id_2_list[11])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[11]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[11]]['path'].iloc[0])\nget_concat_h(im1, im2)","a2b78081":"print(id_1_list[12], id_2_list[12])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[12]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[12]]['path'].iloc[0])\nget_concat_h(im1, im2)","5c298094":"print(id_1_list[13], id_2_list[13])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[13]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[13]]['path'].iloc[0])\nget_concat_h(im1, im2)","cfec5f07":"print(id_1_list[14], id_2_list[14])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[14]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[14]]['path'].iloc[0])\nget_concat_h(im1, im2)","f8d0580e":"print(id_1_list[15], id_2_list[15])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[15]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[15]]['path'].iloc[0])\nget_concat_h(im1, im2)","f6dc1e93":"print(id_1_list[16], id_2_list[16])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[16]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[16]]['path'].iloc[0])\nget_concat_h(im1, im2)","042710d1":"print(id_1_list[17], id_2_list[17])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[17]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[17]]['path'].iloc[0])\nget_concat_h(im1, im2)","1781209b":"print(id_1_list[18], id_2_list[18])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[18]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[18]]['path'].iloc[0])\nget_concat_h(im1, im2)","b83d3e50":"print(id_1_list[19], id_2_list[19])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[19]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[19]]['path'].iloc[0])\nget_concat_h(im1, im2)","5bc11278":"print(id_1_list[20], id_2_list[20])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[20]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[20]]['path'].iloc[0])\nget_concat_h(im1, im2)","c186c6e7":"print(id_1_list[21], id_2_list[21])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[21]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[21]]['path'].iloc[0])\nget_concat_h(im1, im2)","f9710f6b":"print(id_1_list[22], id_2_list[22])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[22]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[22]]['path'].iloc[0])\nget_concat_h(im1, im2)","6c1126c1":"print(id_1_list[23], id_2_list[23])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[23]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[23]]['path'].iloc[0])\nget_concat_h(im1, im2)","ab8f8ae0":"print(id_1_list[24], id_2_list[24])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[24]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[24]]['path'].iloc[0])\nget_concat_h(im1, im2)","00faea9d":"print(id_1_list[25], id_2_list[25])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[25]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[25]]['path'].iloc[0])\nget_concat_h(im1, im2)","4bb5518f":"print(id_1_list[26], id_2_list[26])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[26]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[26]]['path'].iloc[0])\nget_concat_h(im1, im2)","0e120063":"print(id_1_list[27], id_2_list[27])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[27]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[27]]['path'].iloc[0])\nget_concat_h(im1, im2)","2c64bb64":"print(id_1_list[28], id_2_list[28])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[28]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[28]]['path'].iloc[0])\nget_concat_h(im1, im2)","a0ecb06c":"print(id_1_list[29], id_2_list[29])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[29]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[29]]['path'].iloc[0])\nget_concat_h(im1, im2)","01af7a9a":"print(id_1_list[30], id_2_list[30])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[30]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[30]]['path'].iloc[0])\nget_concat_h(im1, im2)","ce7db645":"print(id_1_list[31], id_2_list[31])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[31]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[31]]['path'].iloc[0])\nget_concat_h(im1, im2)","6870610f":"print(id_1_list[32], id_2_list[32])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[32]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[32]]['path'].iloc[0])\nget_concat_h(im1, im2)","a5440c8b":"print(id_1_list[33], id_2_list[33])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[33]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[33]]['path'].iloc[0])\nget_concat_h(im1, im2)","7068e700":"print(id_1_list[34], id_2_list[34])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[34]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[34]]['path'].iloc[0])\nget_concat_h(im1, im2)","86a08484":"print(id_1_list[35], id_2_list[35])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[35]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[35]]['path'].iloc[0])\nget_concat_h(im1, im2)","3031faf3":"print(id_1_list[36], id_2_list[36])\nim1 = Image.open(train_df[train_df['Id']==id_1_list[36]]['path'].iloc[0])\nim2 = Image.open(train_df[train_df['Id']==id_2_list[36]]['path'].iloc[0])\nget_concat_h(im1, im2)","ce6e6e1f":"excluded_id_index = [0,25]\nkeeped_id_index = [2,4,5,7,8]\ncompared_id_index = [1,3,6,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,26,27,28,29,30,31,32,33,34,35,36]","253e2619":"# removed_id = []\n# for i in removed_id_index:\n#     removed_id.append(get_id[i])\n\nremoved_id = []\nfor i in compared_id_index:\n    id_1_paw = train_df[train_df['Id']==id_1_list[i]]['Pawpularity'].iloc[-1]\n    id_2_paw = train_df[train_df['Id']==id_2_list[i]]['Pawpularity'].iloc[-1]\n        \n    if id_1_paw > id_2_paw:\n        removed_id.append(id_2_list[i])\n    else:\n        removed_id.append(id_1_list[i])","718d47c1":"removed_id","9100e561":"removed_id\nprint(len(removed_id))","f340f2a9":"train_df","e324bf0f":"excluded_id_index = [0,25]\nexcluded_id = removed_id.copy()\nfor i in excluded_id_index:\n    excluded_id.append(id_1_list[i])\n    excluded_id.append(id_2_list[i])\n    ","96f38a47":"excluded_id","5f548b24":"len(excluded_id)","a61bbb70":"len(removed_id)","93b3ff4b":"train_df['Pawpularity'].hist(figsize = (10, 5))\nprint(f\"The mean Pawpularity score is {train_df['Pawpularity'].mean()}\")\nprint(f\"The median Pawpularity score is {train_df['Pawpularity'].median()}\")\nprint(f\"The standard deviation of the Pawpularity score is {train_df['Pawpularity'].std()}\")","5f7d5005":"train_df.head()","bf207581":"cleaned_train_df = train_df[~train_df['Id'].isin(removed_id)]\nprint(len(cleaned_train_df))\nprint(len(train_df)-len(cleaned_train_df))","cd3d96b5":"cleaned_train_df['Pawpularity'].hist(figsize = (10, 5))\nprint(f\"The mean Pawpularity score is {cleaned_train_df['Pawpularity'].mean()}\")\nprint(f\"The median Pawpularity score is {cleaned_train_df['Pawpularity'].median()}\")\nprint(f\"The standard deviation of the Pawpularity score is {cleaned_train_df['Pawpularity'].std()}\")","3c40d8d9":"train_df.describe()","cc792f93":"cleaned_train_df.describe()","de562548":"## Check statistic info"}}