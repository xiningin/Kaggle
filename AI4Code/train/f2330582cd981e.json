{"cell_type":{"526eddab":"code","1a630306":"code","862135cc":"code","7bcf7543":"code","d85cde02":"code","4fa4b2ee":"code","4c0fe9ee":"code","7fb1ce97":"code","4b6fcb10":"code","42a4b5cf":"code","3028f6b6":"code","8f3ebdc8":"markdown","ce9afb3d":"markdown","451641d3":"markdown","8c5f49c8":"markdown","39d076e0":"markdown","bc38fba2":"markdown","50a5e2e5":"markdown","db04ee6e":"markdown","8ad0c391":"markdown","2f6c0b64":"markdown"},"source":{"526eddab":"from IPython.display import YouTubeVideo\nvid = YouTubeVideo('mVbkSD5FHOw')\ndisplay(vid)","1a630306":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom matplotlib import pyplot as plt\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","862135cc":"train = pd.read_csv('\/kaggle\/input\/liverpool-ion-switching\/train.csv')\ntest = pd.read_csv('\/kaggle\/input\/liverpool-ion-switching\/test.csv')\nsample_sub = pd.read_csv('\/kaggle\/input\/liverpool-ion-switching\/sample_submission.csv')\n\nprint('Train Data')\nprint('No of train data samples:', len(train.index))\nprint('No of batches are 10')\ndisplay(train.head())\nprint('Test Data')\nprint('No of test data samples:', len(test.index))\ndisplay(test.head())\nprint('sample_submission_file')\ndisplay(sample_sub.head())","7bcf7543":"train_t = train['time']\ntrain_x = train['signal']\ntrain_ch = train['open_channels']\nprint('Different values of open channels: ', set(train_ch))\n\nplt.plot(train_t,train_x)\nplt.plot(train_t,train_ch,'.')\nfor i in range(10): plt.plot([train_t[i*500000], train_t[i*500000]],[-5,12.5],'r')\nfor j in range(10): plt.text(train_t[j*500000+200000],10,str(j+1),size=20)\nplt.xlabel('Time')\nplt.ylabel('Signal Amplitude')\n\n# What are the open channels in every batch\nprint('Open channels in every batch:')\nfor i in range(10):\n    print('Batch ', i+1, ':',set(train.loc[0+i*500000:500000+i*500000,'open_channels']))","d85cde02":"import seaborn as sns\nsns.set(style=\"darkgrid\")\n# analysing first batch data\nplt.figure(figsize=(10,10))\nax = sns.countplot(x='open_channels', data=train)","4fa4b2ee":"import seaborn as sns\nsns.set(style=\"ticks\")\n# analysing first batch data\nplt.figure(figsize=(10,10))\nfor i in range(10):\n    plt.subplot(3,4,i+1)\n    train_batch = train.loc[0+i*500000:500000+i*500000,['signal','open_channels']]\n    ax = sns.countplot(x='open_channels', data=train_batch)\nplt.subplots_adjust(hspace=0.9, wspace= 0.9)  ","4c0fe9ee":"plt.plot(train_ch[0:5000000],train_x[0:5000000],'.')\nplt.title('Signal Amplitude variation over different open channels')\nplt.xlabel('Open Channel #')\nplt.ylabel('Signal Amplitude')\nplt.xticks(np.arange(0, 11, step=1))\nplt.yticks(np.arange(-6, 14, step=2))","7fb1ce97":"plt.figure(figsize=(10,10))\nfor i in range(11):\n    train_ch0 = train[train['open_channels']==i]\n    train_ch0_t = train_ch0['time']\n    train_ch0_x = train_ch0['signal']\n    train_ch0_ch = train_ch0['open_channels']\n    plt.subplot(4,3,i+1)\n    plt.plot(train_ch0_t,train_ch0_x,'.')\n    plt.plot(train_ch0_t,train_ch0_ch,'.')\n    plt.title('Channel# '+str(i))\n    plt.xlabel('Time')\n    plt.ylabel('Signal Amplitude')\n    plt.yticks(np.arange(-6, 12, step=2))\nplt.subplots_adjust(hspace=0.9, wspace= 0.9) ","4b6fcb10":"fs = 100000\ntrain_x_batch5 = train_x[5*500000:100+5*500000]\ntrain_t_batch5 = train_t[5*500000:100+5*500000]\ntrain_ch_batch5 = train_ch[5*500000:100+5*500000]\nplt.plot(train_x_batch5)\nplt.xlabel('Time')\nplt.ylabel('Signal Amplitude')\nfrom scipy import signal\n# train_x_batch5_filt = signal.detrend(train_x_batch5)\n# plt.subplot(2,1,2)\n# plt.plot(train_x_batch5_filt)\n\nsig = train_x_batch5\ntime_step = 1\/fs\nperiod = 5.0\ntime_vec = train_t_batch5\nfrom scipy import fftpack\n# The FFT of the signal\nsig_fft = fftpack.fft(sig)\n\n# And the power (sig_fft is of complex dtype)\npower = np.abs(sig_fft)\n\n# The corresponding frequencies\nsample_freq = fftpack.fftfreq(sig.size, d=time_step)\n\n# Plot the FFT power\nplt.figure(figsize=(6, 5))\nplt.plot(sample_freq, power)\nplt.xlabel('Frequency [Hz]')\nplt.ylabel('plower')\n\n# Find the peak frequency: we can focus on only the positive frequencies\npos_mask = np.where(sample_freq > 0)\nfreqs = sample_freq[pos_mask]\npeak_freq = freqs[power[pos_mask].argmax()]\n\n# Check that it does indeed correspond to the frequency that we generate\n# the signal with\nnp.allclose(peak_freq, 1.\/period)\n\n# An inner plot to show the peak frequency\naxes = plt.axes([0.55, 0.3, 0.3, 0.5])\nplt.title('Peak frequency')\nplt.plot(freqs[:8], power[:8])\nplt.setp(axes, yticks=[])\n\n# scipy.signal.find_peaks_cwt can also be used for more advanced\n# peak detection","42a4b5cf":"high_freq_fft = sig_fft.copy()\nhigh_freq_fft[np.abs(sample_freq) > peak_freq] = 0\nfiltered_sig = fftpack.ifft(high_freq_fft)\n\nplt.figure(figsize=(6, 5))\nplt.subplot(2,1,1)\nplt.plot(time_vec, sig, label='Original signal')\nplt.plot(time_vec, filtered_sig, linewidth=3, label='Filtered signal')\nplt.xlabel('Time [s]')\nplt.ylabel('Amplitude')\n\nplt.legend(loc='best')\nplt.subplot(2,1,2)\nplt.plot(train_ch_batch5)\nplt.xlabel('Time [s]')\nplt.ylabel('Open Channels')","3028f6b6":"test_t = test['time']\ntest_x = test['signal']\n# test_ch = test['open_channels']\n# print('Different values of open channels: ', set(train_ch))\n\nplt.plot(test_t,test_x)\n# plt.plot(test_t,test_ch,'.')\nfor i in range(4): plt.plot([test_t[i*500000], test_t[i*500000]],[-5,12.5],'r')\nfor j in range(4): plt.text(test_t[j*500000+200000],4,str(j+1),size=20)\nplt.xlabel('Time')\nplt.ylabel('Signal Amplitude')","8f3ebdc8":"* Following plots shows the first 100 samples from the 5th Batch and frequency spectrum for the same","ce9afb3d":"### Correlation between Signal Amplitute and Open channels\n* Following graphs shows the signal amplitute for different open channels\n* It is clear that there is no linear relation between signal amplitute and number of open channels","451641d3":"#### Training Data\n* Following plot displays the 10 batches of the trainng data\n* Each batch has different open channels \n","8c5f49c8":"* The test data consist of 4 recordings, each 50 secs duration","39d076e0":"* Following plot shows the orignal and filtered signals. A low pass filtering is applied.\n* By examining the open channels during this time it is clear that application of any smoothing filter is not appropriate.","bc38fba2":"* Following plot displays the distribution of signal values for training data","50a5e2e5":"### Batch 5 in the training data has the maximum variations in open channels. Let's examin the Batch 5 data closely.","db04ee6e":"* Following graphs displays the distribution of signal values for different open channels, for every training data batch","8ad0c391":"## Analyzing the test data","2f6c0b64":"### Overview \n#### In this competetion Time domain signal is given and task is to predict the number of open channels.\n#### Sampling frequency of the recorded signal is 100KHz, meaning 100,000 cycles in 1 sec of data\n#### The training data consist of 10 recordings, each 50 secs duration\n#### Following YouTube video gives explaination of how the signals are recorded"}}