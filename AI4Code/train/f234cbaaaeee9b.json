{"cell_type":{"3232bd22":"code","aa3a319c":"code","c9f30d53":"code","0fb06d77":"code","3dbee2ca":"code","27200c65":"code","15ac0778":"markdown"},"source":{"3232bd22":"import numpy as np\nimport pandas as pd\nfrom tensorflow.keras.models import load_model\nimport cv2\nimport skimage.io\nimport os\nimport sys\nimport tensorflow as tf\nfrom tensorflow import keras\nfrom tensorflow.keras.metrics import Metric\nimport tensorflow.keras.backend as K\nsys.path.insert(0, '\/kaggle\/input\/efficientnet-keras-source-code\/')\nimport efficientnet.tfkeras as efn","aa3a319c":"img_size = 512\ntest_dir = '\/kaggle\/input\/prostate-cancer-grade-assessment\/test_images'\nmodel = load_model('..\/input\/pandas-training-file\/model.h5', compile=False)","c9f30d53":"def get_image(img_name):\n    img_path = os.path.join(test_dir, f'{img_name}.tiff')    \n    img = skimage.io.MultiImage(img_path)        \n    img = cv2.resize(img[-1], (img_size, img_size))    \n    img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)\n    img = img \/ 255\n    return img","0fb06d77":"sub = pd.read_csv('\/kaggle\/input\/prostate-cancer-grade-assessment\/sample_submission.csv')\ntest_images = sub['image_id'].values","3dbee2ca":"labels = []\ntry:\n    for image in test_images:                \n        img = get_image(image)    \n        im1 = img.reshape((1, img_size, img_size, 3))    \n        preds = model.predict(im1, batch_size=1)    \n        result = np.argmax(preds ,axis = 1)               \n        labels.append(result)\n    sub['isup_grade'] = labels\nexcept:\n    print('exception')","27200c65":"sub['isup_grade'] = sub['isup_grade'].astype(int)\nsub.to_csv('submission.csv', index=False)\nsub.head()","15ac0778":"Training File Link :- https:\/\/www.kaggle.com\/karrak3256\/pandas-training-file"}}