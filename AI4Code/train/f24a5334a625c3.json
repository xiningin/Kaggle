{"cell_type":{"234194f6":"code","124b93a3":"code","8b0e994d":"code","1283f39b":"code","39093366":"code","d6433f72":"code","68e066c9":"code","98b88694":"code","28cb6f09":"code","8773998c":"code","e95e0a3e":"code","86e3c8b3":"code","c37b7df2":"code","95c1ba11":"code","54ae3434":"code","ba7518c5":"code","766d31a7":"code","492c1dc1":"code","309db825":"code","9a25f4c5":"code","19e95111":"markdown","59db81ef":"markdown","546fca7b":"markdown","d506f7e2":"markdown","d411a75a":"markdown","080ff086":"markdown"},"source":{"234194f6":"import numpy as np \nimport pandas as pd\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.model_selection import train_test_split\n\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn import svm\nfrom sklearn.linear_model import LogisticRegression\n\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import confusion_matrix\n\n# plt.style.use('default')\ncolor_pallete = ['#2a2a2a', '#ff0000']\nsns.set_palette(color_pallete, 2)\nsns.set_style(\"whitegrid\")","124b93a3":"df = pd.read_csv('..\/input\/heart.csv')\ndf.head()","8b0e994d":"# data.describe()","1283f39b":"# df.info()","39093366":"# df.sample(5)","d6433f72":"df.isna().sum()","68e066c9":"sns.countplot(x='target', data=df)\nplt.show()","98b88694":"plt.figure(figsize=(10,10))\nsns.heatmap(df.corr(), annot=True, fmt='.1f', cmap='RdBu', vmax=0.8, vmin=-0.8)\nplt.show()","28cb6f09":"# plt.figure(figsize=(8, 8))\n# sns.pairplot(df, hue=\"target\")\n# plt.plot()","8773998c":"cat_cols = ['sex', 'cp', 'fbs', 'restecg', 'exang', 'slope', 'ca', 'thal']\ndis_cols = ['age', 'trestbps', 'chol', 'thalach', 'oldpeak']\n\nfor i in cat_cols:\n    df[i] = df[i].astype('category')","e95e0a3e":"for i in dis_cols:\n    ax = sns.kdeplot(df[df['target']==1][i], shade=True, )\n    ax = sns.kdeplot(df[df['target']==0][i], shade=True)\n    ax.set_xlabel(i)\n    plt.legend(['Absent', 'Present'])\n    plt.show()","86e3c8b3":"for i in cat_cols:\n    sns.countplot(x=i, hue='target', data=df)\n    ax.set_xlabel(i)\n    plt.legend(['Absent', 'Present'])\n    plt.show()","c37b7df2":"df['age_cat'] = pd.cut(df['age'], \n                       bins = [0, 40, 55, 90],\n                       labels = ['young', 'mid', 'old'],\n                       include_lowest=True)\n\nax = sns.countplot(x=\"age_cat\", hue='target', data=df)\nplt.plot()","95c1ba11":"from sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\n\nfor i in ['age', 'sex', 'cp', 'trestbps', 'chol', 'fbs', 'restecg', 'thalach' , 'exang', 'oldpeak', 'slope', 'ca', 'thal']:\n    df[i] = df[i].astype('float64')\n    df[i] =  sc.fit_transform(df[i].values.reshape(-1,1))\n    \ndf.head()","54ae3434":"df = pd.get_dummies(df, drop_first=True)\ndf.head()","ba7518c5":"df.columns","766d31a7":"X = df[['age', 'sex', 'cp', 'trestbps', 'chol', 'fbs', 'restecg', 'thalach',\n       'exang', 'oldpeak', 'slope', 'ca', 'thal', 'age_cat_mid',\n       'age_cat_old']]\ny = df['target']\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)","492c1dc1":"nbc = GaussianNB()\nnbc.fit(X_train, y_train)\npred = nbc.predict(X_test)\n\nprint(accuracy_score(pred, y_test))\nprint(confusion_matrix(pred, y_test))","309db825":"import eli5\nfrom eli5.sklearn import PermutationImportance\n\nperm = PermutationImportance(nbc, random_state=1).fit(X_test, y_test)\neli5.show_weights(perm, feature_names = X_test.columns.tolist(), )","9a25f4c5":"# decision tree\n# tree visualization\n# auc, roc plot\n# heatmap - confusion matrix\n# neural network","19e95111":"# Libraries","59db81ef":"# EDA","546fca7b":"* AGE (age in years)  \n* SEX (1 = male; 0 = female)  \n* CP (chest pain type)  \n* TRESTBPS (resting blood pressure (in mm Hg on admission to the hospital))  \n* CHOL (serum cholestoral in mg\/dl)  \n* FPS (fasting blood sugar > 120 mg\/dl) (1 = true; 0 = false)  \n* RESTECH (resting electrocardiographic results)  \n* THALACH (maximum heart rate achieved)  \n* EXANG (exercise induced angina (1 = yes; 0 = no))  \n* OLDPEAK (ST depression induced by exercise relative to rest)  \n* SLOPE (the slope of the peak exercise ST segment)  \n* CA (number of major vessels (0-3) colored by flourosopy)  \n* THAL (3 = normal; 6 = fixed defect; 7 = reversable defect)  \n* TARGET (1 = presense or 0 = absence)","d506f7e2":"# Model","d411a75a":"# Preprocessing","080ff086":"# Data"}}