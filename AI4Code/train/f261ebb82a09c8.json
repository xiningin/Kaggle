{"cell_type":{"f3c0666b":"code","3057eedc":"code","0ac14feb":"code","82a1a6d4":"code","78a478bb":"code","fb5d288b":"code","af406931":"code","e3afe6c3":"code","accb4e93":"code","820cf2db":"code","6da0ea97":"code","a1753f9b":"code","111afc2e":"code","9c2bec51":"code","e00e4665":"code","cf2a5830":"code","070e3314":"code","338818c6":"code","aa3a5a97":"code","692022f6":"code","c3d56c2d":"code","d34ab419":"code","253732d2":"code","aeaeecd3":"code","638e88bb":"code","bc68424c":"code","6ae4d700":"code","75a39629":"code","456179de":"markdown","4ad56d8f":"markdown","56383977":"markdown","20667c42":"markdown","66548856":"markdown","55275327":"markdown","b97a814e":"markdown","ced511ac":"markdown","25f9467f":"markdown","edd4649d":"markdown","2ac45f14":"markdown","161a5213":"markdown","9704ef5c":"markdown","7206e11c":"markdown","8ace3de3":"markdown","dffa70a9":"markdown","e53edfa6":"markdown","58c89b9c":"markdown","d8ff039b":"markdown","3d4206a5":"markdown","e8510f9a":"markdown","c5f1d0b6":"markdown","733d715b":"markdown","0b056d4d":"markdown","326e4922":"markdown","be203880":"markdown","f7afb238":"markdown","19ec1092":"markdown","937979e0":"markdown","74ad18e8":"markdown","89a1d0e1":"markdown"},"source":{"f3c0666b":"import numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.cluster import KMeans\n\nimport datetime as dt","3057eedc":"df = pd.read_csv('..\/input\/customer-personality-analysis\/marketing_campaign.csv',sep='\\t')\ndf.head()","0ac14feb":"df.isnull().sum()","82a1a6d4":"df = df.dropna()    #Dropping rows with null values","78a478bb":"df['Total_kids']= df['Kidhome'] + df['Teenhome']\n\ndf['Spending'] = df['MntWines'] + df['MntFruits'] + df['MntMeatProducts'] + df['MntFishProducts'] + df['MntSweetProducts'] + df['MntGoldProds'] #Combining all types of spendind in one feature\n\ndf['Age'] = 2015 - df.Year_Birth","fb5d288b":"df.Marital_Status = df.Marital_Status.replace({'Together': 'Married',\n                                                'Divorced': 'Single',\n                                                'Widow': 'Single', \n                                                'Alone': 'Single',\n                                                'Absurd': 'Single',\n                                                'YOLO': 'Single'}) #Converting the Marital_Status into a binary feature","af406931":"df.describe()","e3afe6c3":"df = df[df.Age < 100]\ndf = df[df.Income < 120000]","accb4e93":"maritalstatus = df.Marital_Status.value_counts()\nplt.pie(maritalstatus, \n             labels = maritalstatus.index,\n             explode=(0.05,0.05),\n             autopct='%1.1f%%')\nplt.title('Marital Status Distribution')","820cf2db":"plt.figure(figsize=(15,7))\nsns.scatterplot(data=df, y='Spending', x='Income')\nplt.title('Spending vs Income')","6da0ea97":"campaign = df[['AcceptedCmp1', 'AcceptedCmp2', 'AcceptedCmp3', 'AcceptedCmp4', \n                                                  'AcceptedCmp5', 'Response']].sum()\n\ncampaign.plot(kind='bar', figsize=(15,10))\nplt.title('Campaign Analysis')","a1753f9b":"df.columns","111afc2e":"X = df.drop(['ID', 'Year_Birth','Kidhome','Education', 'Marital_Status',\n       'Teenhome', 'Dt_Customer', 'Recency', 'MntWines', 'MntFruits',\n       'MntMeatProducts', 'MntFishProducts', 'MntSweetProducts',\n       'MntGoldProds', 'NumDealsPurchases', 'NumWebPurchases',\n       'NumCatalogPurchases', 'NumStorePurchases', 'NumWebVisitsMonth',\n       'AcceptedCmp3', 'AcceptedCmp4', 'AcceptedCmp5', 'AcceptedCmp1',\n       'AcceptedCmp2', 'Complain', 'Z_CostContact', 'Z_Revenue', 'Response'], axis=1)    #Dropping the irrelevant columns\n\nX.columns","9c2bec51":"options = range(2,9)\ninertias = []\n\nfor n_clusters in options:\n    model = KMeans(n_clusters, random_state=42).fit(X)\n    inertias.append(model.inertia_)\n\n\nplt.figure(figsize=(15,5))\nplt.plot(options, inertias, '-o')","e00e4665":"model = KMeans(n_clusters=4, init='k-means++', random_state=42).fit(X)\n\npreds = model.predict(X)\n\nsegmented_customers = X.copy()\nsegmented_customers['clusters'] = preds\ndf['clusters'] = preds","cf2a5830":"segmented_customers.head()","070e3314":"sns.violinplot(data=segmented_customers, y= 'Income', x= 'clusters')","338818c6":"sns.violinplot(data=segmented_customers, y= 'Total_kids', x= 'clusters')","aa3a5a97":"sns.boxplot(data=segmented_customers, y= 'Spending', x= 'clusters')","692022f6":"sns.violinplot(data=segmented_customers, y= 'Age', x= 'clusters')","c3d56c2d":"segmented_customers.clusters = segmented_customers.clusters.replace({0 : 'Upper Middle Class',\n                                                           1 : 'Lower Class',\n                                                           2 : 'Upper Class',\n                                                           3 : 'Lower Middle Class'})\n\ndf.clusters = df.clusters.replace({0 : 'Upper Middle Class',\n                                                           1 : 'Lower Class',\n                                                           2 : 'Upper Class',\n                                                           3 : 'Lower Middle Class'})","d34ab419":"segmented_customers.head()","253732d2":"cluster_count= segmented_customers['clusters'].value_counts()\n\nplt.figure(figsize=(20,10))\nplt.pie(cluster_count, labels= cluster_count.index, explode=(0.05, 0.05, 0.05, 0.05), autopct='%1.1f%%')\nplt.title('Division of Clusters')","aeaeecd3":"plt.figure(figsize=(10,7))\nsns.scatterplot(data=segmented_customers, y='Spending', x='Income', hue='clusters')\nplt.title('Spending and Income based on Clusters')\nplt.xlabel('Income')\nplt.ylabel('Spending')","638e88bb":"cluster_total_spend = df.groupby('clusters')['Spending'].sum()\n\nplt.figure(figsize=(20,10))\nplt.pie(cluster_total_spend, labels= cluster_total_spend.index, explode=(0.05, 0.05, 0.05, 0.05), autopct='%1.1f%%')\nplt.title('Total Spending by Cluster')","bc68424c":"cluster_spendings = df.groupby('clusters')[['MntWines', 'MntFruits','MntMeatProducts', \n                                                  'MntFishProducts', 'MntSweetProducts', 'MntGoldProds']].sum()\n\ncluster_spendings.plot(kind='bar', stacked=True,figsize=(20,10))\nplt.title('Cluster wise Spendings')","6ae4d700":"cluster_purchases = df.groupby('clusters')[['NumDealsPurchases', 'NumWebPurchases', 'NumCatalogPurchases',\n                                                  'NumStorePurchases', 'NumWebVisitsMonth']].sum()\n\ncluster_purchases.plot(kind='bar', figsize=(20,10))\nplt.title('Cluster wise Purchasing habits')","75a39629":"cluster_campaign = df.groupby('clusters')[['AcceptedCmp1', 'AcceptedCmp2', 'AcceptedCmp3', 'AcceptedCmp4', \n                                                  'AcceptedCmp5', 'Response']].sum()\n\ncluster_campaign.plot(kind='bar', figsize=(20,10))\nplt.title('Cluster wise Marketing Results')","456179de":"By careful analysis of the above plots we can conclude the following for the store owners:\n1. While the lower and lower middle classes account for close to 50% of the consumer base they generate only around 12 % of the revenue. The store owners need to roll out policies so that the customers belonging to the lower strata of the society buy more number of products and contribute significantly to revenue generation.\n\n2. On similar lines, the lower and lower middle class customers account for the majority of the website visits for the store. However, these segments fall way behind in terms of web purchases. This shows that the store has been unable to cater to the needs and requirements of the people from these segments although they are lured by it.\n\n3. We see a major divide in the response to the marketing campaign as well. The customers from the upper class have responded well to the offers whereas the same is not visible from the other segments.\n\n4. In order to resolve this issue of lack of sales to the lower section of the society, the store needs to cater more to their needs. It was seen earlier that the people of these segments were attracted towards the offers and sales of the store. Increasing the frequency of such attractive sales should help the store in increasing sales.\n\n5. In addition to this the store should also focus on the disparity in the sales of its different products. The sales of sweets,fruits,fish and gold is very less when compared with the sales of wine and meat. The store needs to improve its marketing strategies for these products so that it can reach out to the market base of these products","4ad56d8f":"**Understanding the Clusters**","56383977":"The main source of revenue for this store is the sale of wine and mear whereas other products such as fruit, fish, sweets and gold are unable to come up with a similar contribution","20667c42":"Careful observation of the above plots leads us to the conclusion that the clusters can be named as follows :\n\n**1 ---> Upper Middle Class**\n\n**2 ---> Lower Class**\n\n**3 ---> Upper Class**\n\n**4 ---> Upper Middle Class**\n","66548856":"# Conclusion","55275327":"**Analyzing the Clusters**","b97a814e":"**Exploratory Data Analysis**","ced511ac":"The above plot reinstates that our understanding of the clusters is correct","25f9467f":"# Customer Segmentation","edd4649d":"Importing the necessary libraries","2ac45f14":"While these graphs are useful in understanding diversity of the customers who have bought from the store, they do not give us an idea of the categories in which the customers can be divided and the interests or spending habits of these customers. We will have to perform customer segmentation to get this kind of additional information","161a5213":"**KNN Clustering**","9704ef5c":"This plot gives us some very useful information about the spending habits of the different segments of the customer base:\n1. The lower and middle class customers have made more purchases with the help of discounts\n2. The Upper and Upper Middle classes have made more web purchases despite being the less frequent visitors to the website.\n3. The Upper and Upper Middle classes are the one with the most store and catalog purchases","7206e11c":"The KNN model has distributed the customers into 4 different clusters. However we will have to analyze this distribution in order to undertand the meaning of each cluster and which section of the customers it represents","8ace3de3":"In this notebook we will analyze and segment the customers of a store in order to help them in increasing revenue","dffa70a9":"A good personalised relationship with the customers is crucial for the success of a company. Customer segmentation helps a firm to segment its customers into different categories based on their needs, spending habits, financial condition and other relevant factors. This helps a firm to analyze the requirements of it customer base and along with their interests, lifestyles, priorities and learn their spending habits which can be used in planning its customer acquisition and retention plans. Customer Segmentation is a key step in the process of fine tuning marketing strategies and helps in increasing revenues of the firm as customers recieve marketing policies for only those products which they need.","e53edfa6":"We try to understand the behaviour of cutomers with the help of a some graphs","58c89b9c":"Removing Outliers","d8ff039b":"By using the output above, we can conclude that the Age and Income columns have outliers which have to be removed before working further","3d4206a5":"Now that we have segmented the customers into four different clusters we analyze the clusters and try to understand their behaviours and requirements,","e8510f9a":"**Data Pre Processing**","c5f1d0b6":"Extracting Features","733d715b":"Finding the number of clusters using elbow method","0b056d4d":"Making new features by combining existing ones","326e4922":"As we can see the dataset has too many columns which are not required for the purpose of dividing the customers into different segments. Therefore we extract the relevant columns from this dataframe into a different dataframe and keep the other columns for later analysis","be203880":"Handling the Null values","f7afb238":"Reading the Dataset","19ec1092":"We can see that the marketing campaigns of the store have more impact on the upper class than on the lower and middle classes","937979e0":"The amount of money spent by the customers from the upper class far outnumbers the amount of money spent by the lower classes. Lets analyze this spending based on the product on which the money is spent","74ad18e8":"From the above graph we can conclude that 4 is the ideal number of clusters into which the customers can be divided to get the most accurate information.","89a1d0e1":"# THANK YOU\n\nPlease comment your views and upvote if you liked the notebook"}}