{"cell_type":{"24f25e2f":"code","e0e7d84a":"code","969ee399":"code","872a5995":"code","331be2fb":"code","bdd2c0ae":"code","e956355d":"code","46af187c":"code","a1ab5399":"code","2da036ee":"code","e393b484":"code","9f4a9465":"code","a4d7a0ea":"code","3a2c29f7":"code","5936dbfc":"code","4a79146c":"code","742fcdb7":"code","d8b51630":"code","c13986a3":"code","a249b037":"code","ced7bd29":"code","701cd155":"code","a5242be8":"code","8e27b51f":"code","cac43a87":"code","94a53237":"code","df95872b":"code","f6f86526":"code","35370538":"code","aa989f0b":"code","01b6402a":"code","b8d97345":"code","8144ffbc":"code","b0b23229":"code","c7a3b188":"code","ae97c560":"code","0ab45826":"code","e3ffecda":"code","49633002":"code","a0a652cd":"markdown","4df2ed64":"markdown","b0f1c28a":"markdown","ebe7d02f":"markdown","473cffd5":"markdown","c9800e49":"markdown","362d6691":"markdown","26f5a1d3":"markdown","5e72b17d":"markdown","77f8f4be":"markdown","021b4cd5":"markdown","6900f4c1":"markdown","49694607":"markdown","5f8ae8f5":"markdown"},"source":{"24f25e2f":"import numpy as np\nimport keras\nfrom  keras.preprocessing.text import Tokenizer\nfrom keras.preprocessing.sequence import pad_sequences\nimport os\nimport pandas as pd\nfrom keras.utils import to_categorical\nimport matplotlib.pyplot as plt\nfrom sklearn.metrics import classification_report\nimport scikitplot\nfrom scikitplot.metrics import plot_confusion_matrix","e0e7d84a":"df_train = pd.read_csv('..\/input\/emotions-dataset-for-nlp\/train.txt', header =None, sep =';', names = ['Input','Sentiment'], encoding='utf-8')\ndf_test = pd.read_csv('..\/input\/emotions-dataset-for-nlp\/test.txt', header = None, sep =';', names = ['Input','Sentiment'],encoding='utf-8')\ndf_val=pd.read_csv('..\/input\/emotions-dataset-for-nlp\/val.txt',header=None,sep=';',names=['Input','Sentiment'],encoding='utf-8')","969ee399":"df_train.Sentiment.value_counts()","872a5995":"X=df_train['Input']\n","331be2fb":"lst=[]\nfor i in X:\n  lst.append(len(i))\n","bdd2c0ae":"len1=pd.DataFrame(lst)\nlen1.describe()","e956355d":"cts=[]\nfor i in range(7,301):\n   ct=0\n   for k in lst:\n     if k==i:\n       ct+=1\n   cts.append(ct)","46af187c":"plt.bar(range(7,301),cts)\nplt.show()","a1ab5399":"tokenizer=Tokenizer(15212,lower=True,oov_token='UNK')\ntokenizer.fit_on_texts(X)","2da036ee":"len(tokenizer.word_index)","e393b484":"X_train=tokenizer.texts_to_sequences(X)\nX_train_pad=pad_sequences(X_train,maxlen=80,padding='post')","9f4a9465":"df_train['Sentiment']=df_train.Sentiment.replace({'joy':0,'anger':1,'love':2,'sadness':3,'fear':4,'surprise':5})","a4d7a0ea":"Y_train=df_train['Sentiment'].values\n","3a2c29f7":"Y_train_f=to_categorical(Y_train)","5936dbfc":"Y_train_f[:6]","4a79146c":"X_val=df_val['Input']\nY_val=df_val.Sentiment.replace({'joy':0,'anger':1,'love':2,'sadness':3,'fear':4,'surprise':5})","742fcdb7":"X_val_f=tokenizer.texts_to_sequences(X_val)\nX_val_pad=pad_sequences(X_val_f,maxlen=80,padding='post')","d8b51630":"Y_val_f=to_categorical(Y_val)","c13986a3":"Y_val_f[:6]","a249b037":"from keras.models import Sequential\nfrom keras.layers import LSTM,Bidirectional,Dense,Embedding,Dropout\n","ced7bd29":"model=Sequential()\nmodel.add(Embedding(15212,64,input_length=80))\nmodel.add(Dropout(0.6))\nmodel.add(Bidirectional(LSTM(80,return_sequences=True)))\nmodel.add(Bidirectional(LSTM(160)))\nmodel.add(Dense(6,activation='softmax'))\nprint(model.summary())","701cd155":"model.compile(optimizer='adam',loss='categorical_crossentropy',metrics=['accuracy'])","a5242be8":"hist=model.fit(X_train_pad,Y_train_f,epochs=12,validation_data=(X_val_pad,Y_val_f))","8e27b51f":"plt.plot(hist.history['accuracy'],c='b',label='train')\nplt.plot(hist.history['val_accuracy'],c='r',label='validation')\nplt.legend(loc='lower right')\nplt.show()","cac43a87":"plt.plot(hist.history['loss'],c='orange',label='train')\nplt.plot(hist.history['val_loss'],c='g',label='validation')\nplt.legend(loc='upper right')\nplt.show()","94a53237":"X_test=df_test['Input']\nY_test=df_test.Sentiment.replace({'joy':0,'anger':1,'love':2,'sadness':3,'fear':4,'surprise':5})","df95872b":"X_test_f=tokenizer.texts_to_sequences(X_test)\nX_test_pad=pad_sequences(X_test_f,maxlen=80,padding='post')","f6f86526":"Y_test_f=to_categorical(Y_test)","35370538":"X_test_pad.shape","aa989f0b":"Y_test_f[:7]","01b6402a":"model.evaluate(X_test_pad,Y_test_f)","b8d97345":"Y_pred=model.predict_classes(X_test_pad)","8144ffbc":"plot_confusion_matrix(Y_test,Y_pred)","b0b23229":"print(classification_report(Y_test,Y_pred))","c7a3b188":"def get_key(value):\n    dictionary={'joy':0,'anger':1,'love':2,'sadness':3,'fear':4,'surprise':5}\n    for key,val in dictionary.items():\n          if (val==value):\n            return key\n\n","ae97c560":"def predict(sentence):\n  sentence_lst=[]\n  sentence_lst.append(sentence)\n  sentence_seq=tokenizer.texts_to_sequences(sentence_lst)\n  sentence_padded=pad_sequences(sentence_seq,maxlen=80,padding='post')\n  ans=get_key(model.predict_classes(sentence_padded))\n  print(\"The emotion predicted is\",ans)","0ab45826":"predict(str(input('Enter a sentence : ')))\n","e3ffecda":"predict(str(input('Enter a sentence : ')))\n","49633002":"predict(str(input('Enter a sentence : ')))\n","a0a652cd":"# Create a Dataframe for reading and analysing the text files easily","4df2ed64":"# Trying to fix a length for the embedding layers' input","b0f1c28a":"# Checking for Test Data","ebe7d02f":"# Using The tokenizer Class to convert the sentences into word vectors","473cffd5":"# Creating a Model","c9800e49":"# Plotting the Confusion matrix ","362d6691":"# Creating a Function to check for Your own Sentence","26f5a1d3":"# Check for Your Own Sentence","5e72b17d":"## Reading the Train and Validation Data","77f8f4be":"# Compiling and running the model","021b4cd5":"# One hot Encoding the Emotion Values","6900f4c1":"# Plotting the Loss and Accuracy Curves","49694607":"#Accuracy for Test Data","5f8ae8f5":"## Import Necessary Libraries"}}