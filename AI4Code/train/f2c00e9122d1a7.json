{"cell_type":{"525528fe":"code","e5513329":"code","e24c9327":"code","fbc3d2bb":"code","3ba4ccb5":"code","b5c2d603":"code","b03c4b96":"code","fca5397a":"code","b538676c":"code","031c2951":"code","428471cd":"code","3bac39bd":"code","7c1cf837":"code","62b29143":"code","248c8238":"code","1b59cdcc":"code","c78776c3":"code","8f4a47af":"code","25311d8c":"code","e8a35a41":"code","883c5d07":"code","ebda9d55":"code","331dbe9d":"code","bb06eb42":"code","76a5b0ed":"code","4b3a1061":"code","7ec6f65f":"code","77904830":"code","171d36a0":"code","24f48218":"code","7726995c":"code","3c2c8726":"code","c675222b":"code","1a1bce82":"code","92d68acf":"markdown","68c5604e":"markdown","7eb06ef5":"markdown","02d70b7c":"markdown","eadbeb75":"markdown","fe105bb6":"markdown","e643fa1b":"markdown","2f3350a3":"markdown"},"source":{"525528fe":"'''Importing libraries'''\nimport pandas as pd\nimport numpy as np\nimport warnings\nwarnings.filterwarnings('ignore')\npd.set_option('display.max_columns', None)\nimport scipy.stats\n\n# visuals\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.express as px\nfrom plotly.subplots import make_subplots\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n","e5513329":"market = pd.read_csv('..\/input\/customer-personality-analysis\/marketing_campaign.csv', delimiter=\"\\t\")\nmarket = market.drop(['ID','Dt_Customer'], axis=1)","e24c9327":"market.head(n=10)","fbc3d2bb":"market.shape","3ba4ccb5":"market.info()","b5c2d603":"# total number of children\nmarket['no_children'] = market['Kidhome'] + market['Teenhome']\n# total items bought\nmarket['total_items_bought'] = market['MntWines'] + market['MntFruits'] + market['MntMeatProducts'] + market['MntFishProducts'] + market['MntSweetProducts'] + market['MntGoldProds']\n# total number of purchases\nmarket['total_nbr_purchases'] = market['NumDealsPurchases'] + market['NumWebPurchases'] + market['NumCatalogPurchases'] + market['NumStorePurchases']\n#customer age\nmarket['age'] = 2021 - market['Year_Birth']","b03c4b96":"market.describe()","fca5397a":"market[market['Income']>600000]","b538676c":"market[market['age']>90]","031c2951":"market = market[market['Income']<600000]\nmarket = market[market['age']<90]","428471cd":"def hist_with_vline(data, column):\n    \"\"\"This function gets data and column name.\n    Plots a histogram with 100 bins, draws a Vline of the column mean\"\"\"\n   \n    plt.figure(figsize=(12,6))\n    _ = sns.histplot(market[column], bins= 100)\n    plt.title('Histogram of ' + column)\n    miny, y_lim = plt.ylim()\n    plt.text(s = f\"Mean  {column} : {market[column].mean():.2f}\", x =market[column].mean() * 1.1,  y = y_lim * 0.95)\n    _ =plt.axvline(market[column].mean(), color = 'r')","3bac39bd":"hist_with_vline(market, 'Income')","7c1cf837":"hist_with_vline(market, 'total_items_bought')","62b29143":"columns = ['MntWines', 'MntFruits', 'MntMeatProducts','MntFishProducts', 'MntSweetProducts','MntGoldProds']\ntitles = ['Wines Sold', 'Fruits Sold', 'Meat Products Sold', 'Fish Products Sold', 'Sweets Sold', 'Gold Sold']\ncolors = ['blue', 'green', 'darkblue','red','orange','yellow']\n\nfig, ax = plt.subplots(2,3, figsize=(24,12))\nfor i in range(len(columns)):\n    sns.histplot(market[columns[i]], bins= 100, ax = ax[i\/\/3, i%3],color=colors[i])\n    ax[i\/\/3, i%3].set_title('Distribution of ' + titles[i])\n    ax[i\/\/3, i%3].set_xlabel(titles[i])\n    ","248c8238":"plt.figure(figsize=(12,6))\n\n_ = sns.scatterplot(y ='Income',x = 'total_items_bought', data = market)","1b59cdcc":"plt.figure(figsize=(12,6))\n_= sns.barplot(x = 'Marital_Status', y = 'Income', data = market,)","c78776c3":"plt.figure(figsize=(12,6))\n\n_ = sns.scatterplot(y ='Income',x = 'total_items_bought', data = market, hue = 'Marital_Status')","8f4a47af":"plt.figure(figsize=(12,6))\n_= sns.barplot(x = 'Education', y = 'Income', data = market,)","25311d8c":"plt.figure(figsize=(12,6))\n\n_ = sns.scatterplot(y ='Income',x = 'total_items_bought', data = market, hue= 'Education')","e8a35a41":"from sklearn.preprocessing import StandardScaler, LabelEncoder, MinMaxScaler","883c5d07":"le = LabelEncoder()\nss = StandardScaler()\nmm = MinMaxScaler()","ebda9d55":"market['Education'] = le.fit_transform(market['Education'])\nmarket[ 'Marital_Status'] = le.fit_transform(market[ 'Marital_Status'])","331dbe9d":"ss_market = pd.DataFrame(ss.fit_transform(market), columns = market.columns)","bb06eb42":"from sklearn.cluster import KMeans\nfrom sklearn.metrics import silhouette_score","76a5b0ed":"# elbow method for neighbors\nneighbors = pd.DataFrame(columns=['clusters','intertia','silhouette_score'])\nfor i in range(2,20):\n    kmeans = KMeans(n_clusters=i, init='k-means++', random_state=42)\n    kmeans.fit(ss_market)\n    score_silhouette = silhouette_score(ss_market, kmeans.labels_, metric='euclidean') \n    neighbors = neighbors.append({'clusters':i,\n                              'intertia': kmeans.inertia_,\n                              'silhouette_score':score_silhouette }, ignore_index=True)","4b3a1061":"fig, (ax0,ax1) = plt.subplots(1,2, figsize=(12,6), sharex=True)\nax0.bar(x = 'clusters', height= 'intertia', data=neighbors)\nax0.set_xlabel('Number of Clusters')\nax1.bar(x='clusters',height='silhouette_score', data=neighbors)\nax1.set_xlabel('Silhouette Scores of Clusters')\n_ = plt.xticks(range(2,20,1))","7ec6f65f":"# Kmeans tuned\n\nkmeans = KMeans(n_clusters= 3, init='k-means++', random_state=42,)\n\nkmeans_labels = kmeans.fit_predict(ss_market)\n\npd.Series(kmeans_labels).value_counts()","77904830":"market_kmeans = market.copy()\nmarket_kmeans['clusters'] = kmeans_labels","171d36a0":"plt.figure(figsize=(12,6))\n\n_ = sns.scatterplot(y ='Income',x = 'total_items_bought', data = market_kmeans, hue= 'clusters')","24f48218":"plt.figure(figsize=(12,6))\n\nsns.boxplot(y = 'total_items_bought', x='clusters', data=market_kmeans)","7726995c":"plt.figure(figsize=(12,6))\n\nsns.boxplot(y = 'Income', x='clusters', data=market_kmeans)","3c2c8726":"plt.figure(figsize=(12,6))\n\n_ = sns.scatterplot(y ='Income',x = 'MntMeatProducts', data = market_kmeans, hue= 'clusters')","c675222b":"plt.figure(figsize=(12,6))\n\n_ = sns.scatterplot(y ='Income',x = 'MntFishProducts', data = market_kmeans, hue= 'clusters')","1a1bce82":"plt.figure(figsize=(12,6))\n\n_ = sns.scatterplot(y ='Income',x = 'age', data = market_kmeans, hue= 'clusters')\n","92d68acf":"I am stuck between 3 or 4 clusters. I would go for 3, according to silhouette scores","68c5604e":"Now our clusters are set, we need to visualize and get descriptives of the data according to clusters.\n\nHowever, from what I got we can conclude that, there are 3 clusters of the customers.\n0 - Whales (one with more money and buys more things)\n1 - Low-buyers (one who buys less than any other group)\n2 - Medium sized buyers","7eb06ef5":"128 years old, earns 666666k money. The first one is not likely to occur, second one is outlier. Lets see who is earning 66666k money.","02d70b7c":"# **Visuals:**","eadbeb75":"In this project, we are going to classify the customers into segments and analyse their values and future growth to the company. This method is useful for a company because it is efficient for a company to know its customers and needs. The major benefits and importances of segmenting the customers are as follows,\n1. **Targeted Customers:** \nThe company can target its product that is specific to the customer's needs. Analysing the trends of their lifestyles would make the company target its potential buyers and make it cost-efficient as the company's Marketing cost would cut down effectively.\n\n2. **Retain & Provide value to the customers:**\nAnalysing the financial and social needs and backgrounds of the customers and providing them the products that they need would make the customers stay loyal to the company and retain the existing customers. This better customer service would make new potential custmers get into the company and the generation of Revenue would then be increased.\n","fe105bb6":"All the sold products histograms are right skewed. Majority of the customers buys items lower than certain amounts.\n","e643fa1b":"# **Clustering**\n**Scaling the data**","2f3350a3":"**Introduction to Data**\n\nThe customer data has 2240 rows and 28 columns. I checked and deleted the cell after, each row is for a different customer, there are no duplicates in the data.\n\nFrom the descriptives table, we see none of the columns have missings, and no values below 0.\n\nHowever, we might need a deeper knowledge about what the columns are ; such as AcceptedCmp, Recency, Z_CostContact and Response. We don't know what these columns are.\n\nQuick insights : Income column's higher value is 6666666, and percentiles are in between 35k to 68k. The highest value is a possible outlier.\n\nMean Web site visits per month is 5 for 2k customers. The max value is 20.\n\nAcceptedCmp columns are binomial, 0 and 1."}}