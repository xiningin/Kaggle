{"cell_type":{"b71a8c00":"code","4e8ae5d3":"code","4c0de0e3":"code","f443f220":"code","8d3e8910":"code","65f3a70a":"code","38e163d2":"code","e1760d01":"code","0e1a8912":"code","e08749e8":"code","a20f36b5":"code","d5ed48ce":"markdown"},"source":{"b71a8c00":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","4e8ae5d3":"#importing libraries\nfrom fastai import *\nfrom fastai.vision import *\nfrom fastai.metrics import error_rate\nimport os\nimport pandas as pd\nimport numpy as np","4c0de0e3":"x  = '\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/train'\npath = Path(x)\npath.ls()","f443f220":"np.random.seed(40)\ndata = ImageDataBunch.from_folder(path, train = '.', valid_pct=0.2,\n                                  ds_tfms=get_transforms(), size=224,\n                                  num_workers=4).normalize(imagenet_stats)","8d3e8910":"data.show_batch(rows=3, figsize=(7,6),recompute_scale_factor=True)","65f3a70a":"#analysis about the data we have\ndata","38e163d2":"#print classes in the data\nprint(data.classes)\nlen(data.classes),data.c","e1760d01":"#using transfer learning model resnet18\n#whatever data you download, gets stored in the output folder\nlearn = cnn_learner(data, models.resnet18, metrics=[accuracy], model_dir = Path('..\/kaggle\/working'),path = Path(\".\"))","0e1a8912":"learn.lr_find()\nlearn.recorder.plot(suggestions=True)","e08749e8":"lr1 = 1e-3\nlr2 = 1e-1\nlearn.fit_one_cycle(4,slice(lr1,lr2))","a20f36b5":"img = open_image('\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/test\/PNEUMONIA\/person87_bacteria_434.jpeg')\nprint(learn.predict(img)[0])\nimg","d5ed48ce":"Testing the model on test data.\n"}}