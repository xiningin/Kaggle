{"cell_type":{"838363ea":"code","db50f0ae":"code","9286d65a":"code","d1f92b1b":"code","66046e90":"code","773e260a":"code","28ee7410":"code","6dbabdb2":"code","a80c2915":"code","9b08c8f2":"code","e83680be":"code","daaf1933":"code","7af2866a":"markdown","0b2f42f5":"markdown","b9e6efc1":"markdown","b21e4e75":"markdown"},"source":{"838363ea":"from fastai import *\nfrom fastai.vision import *","db50f0ae":"# Always check and update your fastai version\nimport fastai\nfastai.__version__","9286d65a":"path = Path('..\/input')","d1f92b1b":"data = (ImageList.from_csv(path, 'labels.csv', folder='train')\n        .random_split_by_pct()\n        .label_from_df()\n        .add_test_folder()\n        .transform(get_transforms(), size=112)\n        .databunch()\n       )","66046e90":"data.show_batch(3)","773e260a":"learn = create_cnn(data, models.resnet18, path=\"\", metrics=accuracy)","28ee7410":"learn.fit_one_cycle(3,1e-2)","6dbabdb2":"preds,_ = learn.TTA(ds_type=DatasetType.Test)\npreds.shape","a80c2915":"subm = pd.DataFrame(preds.numpy())\nsubm.columns = data.classes","9b08c8f2":"fnames = os.listdir(path\/'test')\nsubm.insert(0, 'id', fnames)","e83680be":"subm.head()","daaf1933":"subm.to_csv('subm.csv', index=None)","7af2866a":"## Get the Data\n\nThe data is in the `..\/input` directory by default on Kaggle. It contains a `train` folder and a `test` folder. The file `labels.csv` contains the labels for the training set.","0b2f42f5":"## Create a Submission for Kaggle\nThis section creates a file called `subm.csv` that you can submit to Kaggle and join the leaderboard. If you're on Kaggle kernels, click `commit` in the top right and then you'll be able to submit your predictions from your kernel.","b9e6efc1":"## Create a Model\nHere we'll create a resnet18 for demonstration.","b21e4e75":"## Setup"}}