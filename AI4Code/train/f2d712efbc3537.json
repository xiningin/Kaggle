{"cell_type":{"0ae1695f":"code","9b80a08d":"code","bb6a455c":"code","1cac633c":"code","967ceb51":"code","2b33367c":"code","c0df678c":"code","dcd45769":"code","13d48d86":"code","04a9f74e":"code","43da3a41":"code","5e45c1a8":"code","2a878796":"code","56b1ba1d":"code","02ad2190":"code","976dcdd2":"code","58665877":"code","59cdd629":"code","a280119c":"code","15ecf22c":"code","a1ae0af5":"code","38f5cd5f":"code","05227607":"code","8fb04673":"code","e16e05f0":"code","bda5e18d":"code","fe70f716":"code","4ac7612d":"code","b1442f1c":"code","4d000241":"code","5d7fa264":"code","dba831b6":"code","2f907d9c":"code","2fd52d03":"code","a12dd79d":"code","d3631e3d":"code","7447e783":"code","65ee7789":"code","139f35dc":"code","6a793346":"code","d560edb9":"code","4fb1f0a4":"code","8fc91763":"code","b77fadfc":"code","b7d1591e":"code","c50ae4e7":"code","210e71d6":"code","d8904e01":"code","d42379ac":"code","52da9e4b":"code","50d2d539":"code","af2659cb":"code","523e9cd0":"code","814db8ed":"code","685cf183":"code","b821af37":"code","f182c3c3":"code","5f277439":"code","35604dd7":"code","0ca10d18":"code","97abe3da":"code","9185c395":"markdown","7b2ac5a6":"markdown","08a192b5":"markdown","3f322d23":"markdown","21d48b38":"markdown","9dc80b36":"markdown","e1cfc06f":"markdown","c04ee9e4":"markdown","9fc3c8c6":"markdown"},"source":{"0ae1695f":"from shapely.geometry import Point\nimport pandas as pd\nimport geopandas as gpd\nimport contextily\nimport folium\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nimport os\nfrom urllib.request import urlretrieve\nimport zipfile","9b80a08d":"sns.set(font_scale=1.4)\nsns.set_style({'font.family': 'serif',\n               'fontname': 'Times New Roman'})","bb6a455c":"if not os.path.exists('\/kaggle\/working\/mapas'):\n    os.makedirs('\/kaggle\/working\/mapas')","1cac633c":"url_setores_censitarios = 'https:\/\/geoftp.ibge.gov.br\/organizacao_do_territorio\/malhas_territoriais\/malhas_de_setores_censitarios__divisoes_intramunicipais\/censo_2010\/setores_censitarios_shp\/am\/am_setores_censitarios.zip'","967ceb51":"%%time\n\nurlretrieve(url_setores_censitarios, '\/kaggle\/working\/mapas\/am_setores_censitarios.zip')","2b33367c":"with zipfile.ZipFile('\/kaggle\/working\/mapas\/am_setores_censitarios.zip', 'r') as zip_ref:\n    zip_ref.extractall('\/kaggle\/working\/mapas\/')","c0df678c":"os.remove('\/kaggle\/working\/mapas\/am_setores_censitarios.zip')","dcd45769":"am_setores_gdf = gpd.read_file('\/kaggle\/working\/mapas\/13SEE250GC_SIR.shp')","13d48d86":"am_setores_gdf.shape","04a9f74e":"am_setores_gdf.head()","43da3a41":"am_setores_gdf.iloc[0].geometry","5e45c1a8":"am_setores_gdf.crs.to_string()","2a878796":"am_setores_gdf = am_setores_gdf.to_crs(crs='EPSG:3857')","56b1ba1d":"am_setores_gdf.crs.to_string()","02ad2190":"am_setores_gdf.head()","976dcdd2":"ax = am_setores_gdf.plot(figsize=(15, 10), edgecolor='black', facecolor='none')\ncontextily.add_basemap(ax)\nax.set_axis_off()\nplt.show()","58665877":"mao_setores_gdf = am_setores_gdf[am_setores_gdf['NM_MUNICIP'] == 'MANAUS']","59cdd629":"mao_setores_gdf.shape","a280119c":"ax = mao_setores_gdf.plot(figsize=(15, 10), edgecolor='black', facecolor='none')\ncontextily.add_basemap(ax)\nax.set_axis_off()\nplt.show()","15ecf22c":"ax = mao_setores_gdf.plot(figsize=(15, 10), edgecolor='black', column='TIPO', legend=True)\ncontextily.add_basemap(ax)\nax.set_axis_off()\nplt.show()","a1ae0af5":"mao_setores_urb_gdf = mao_setores_gdf[mao_setores_gdf['TIPO'] == 'URBANO']","38f5cd5f":"mao_setores_urb_gdf.shape","05227607":"ax = mao_setores_urb_gdf.plot(figsize=(15, 10), edgecolor='black', facecolor='none')\ncontextily.add_basemap(ax)\nax.set_axis_off()\nplt.show()","8fb04673":"mao_setores_urb_gdf.head()","e16e05f0":"mao_setores_urb_gdf['NM_BAIRRO'].unique()","bda5e18d":"plt.figure(figsize=(50,8))\n\nax = sns.countplot(x='NM_BAIRRO', \n                   data=mao_setores_urb_gdf, \n                   order=mao_setores_urb_gdf['NM_BAIRRO'].value_counts().index)\n\nlabels = [item.get_text().replace(' ', '\\n') for item in ax.get_xticklabels()]\nax.set_xticklabels(labels, rotation = 90)\n\nax.set_xlabel('Bairros de Manaus (AM)')\nax.set_ylabel('Qtd. de setores censit\u00e1rios')\n\nplt.show()","fe70f716":"ax = mao_setores_urb_gdf.plot(figsize=(50, 30), edgecolor='black', column='NM_BAIRRO', legend=True)\ncontextily.add_basemap(ax)\nax.set_axis_off()\nplt.show()","4ac7612d":"mao_setores_urb_gdf.to_file('\/kaggle\/working\/mapas\/mao_setores_urb.json', driver='GeoJSON')","b1442f1c":"if not os.path.exists('\/kaggle\/working\/censo2010'):\n    os.makedirs('\/kaggle\/working\/censo2010')","4d000241":"url_censo_2010_am = 'https:\/\/ftp.ibge.gov.br\/Censos\/Censo_Demografico_2010\/Resultados_do_Universo\/Agregados_por_Setores_Censitarios\/AM_20171016.zip'","5d7fa264":"%%time\n\nurlretrieve(url_censo_2010_am, '\/kaggle\/working\/censo2010\/AM_20171016.zip')","dba831b6":"with zipfile.ZipFile('\/kaggle\/working\/censo2010\/AM_20171016.zip', 'r') as zip_ref:\n    zip_ref.extractall('\/kaggle\/working\/censo2010\/')","2f907d9c":"os.remove('\/kaggle\/working\/censo2010\/AM_20171016.zip')","2fd52d03":"am_censo_entorno01_df = pd.read_csv('\/kaggle\/working\/censo2010\/AM\/Base informa\u00e7oes setores2010 universo AM\/CSV\/Entorno01_AM.csv', sep=';')","a12dd79d":"am_censo_entorno01_df.shape","d3631e3d":"am_censo_entorno01_df.head()","7447e783":"am_censo_entorno01_df.dtypes","65ee7789":"colunas = [\n    'V001', # Domic\u00edlios\n    'V008', 'V010', 'V012', # Ilumina\u00e7\u00e3o p\u00fablica\n    'V014', 'V016', 'V018', # Pavimenta\u00e7\u00e3o\n    'V020', 'V022', 'V024', # Cal\u00e7ada\n    'V038', 'V040', 'V042', # Rampa para cadeirante\n    'V044', 'V046', 'V048' # Arboriza\u00e7\u00e3o\n          ]  \nam_censo_entorno01_df[colunas] = am_censo_entorno01_df[colunas].replace('X', '0')","139f35dc":"am_censo_entorno01_df[colunas] = am_censo_entorno01_df[colunas].astype(int, copy=False)","6a793346":"am_censo_entorno01_df.dtypes","d560edb9":"am_gdf = am_censo_entorno01_df[['Cod_setor'] + colunas]\nam_gdf.head()","4fb1f0a4":"%%capture\n\nam_gdf['ILUMINACAO'] = am_gdf.loc[:, 'V008':'V012'].sum(axis=1)\nam_gdf['PAVIMENTACAO'] = am_gdf.loc[:, 'V014':'V018'].sum(axis=1)\nam_gdf['CALCADA'] = am_gdf.loc[:, 'V020':'V024'].sum(axis=1)\nam_gdf['RAMPA_CADEIRANTE'] = am_gdf.loc[:, 'V038':'V042'].sum(axis=1)\nam_gdf['ARBORIZACAO'] = am_gdf.loc[:, 'V044':'V048'].sum(axis=1)","8fc91763":"am_gdf.head()","b77fadfc":"am_gdf = am_gdf.drop(columns=colunas[1:]).copy()\nam_gdf.head()","b7d1591e":"am_gdf.columns = ['CD_GEOCODI', 'DOMICILIOS', 'ILUMINACAO', 'PAVIMENTACAO', 'CALCADA', 'RAMPA_CADEIRANTE', 'ARBORIZACAO']\nam_gdf.head()","c50ae4e7":"%%capture\n\nmao_setores_urb_gdf['CD_GEOCODI'] = mao_setores_urb_gdf['CD_GEOCODI'].astype(int, copy=False)","210e71d6":"am_gdf = pd.merge(mao_setores_urb_gdf[['CD_GEOCODI', 'NM_BAIRRO', 'geometry']], am_gdf, on='CD_GEOCODI')\nam_gdf = am_gdf.dropna().copy()\nam_gdf.head()","d8904e01":"am_gdf.shape","d42379ac":"am_gdf.crs.to_string()","52da9e4b":"am_gdf = am_gdf.to_crs(crs='EPSG:4326')","50d2d539":"am_gdf.crs.to_string()","af2659cb":"am_gdf.head()","523e9cd0":"coord_centro_manaus = [-3.1019400, -60.0250000]\nmapa_manaus = folium.Map(location=coord_centro_manaus, zoom_start=12)","814db8ed":"mapa_manaus","685cf183":"resolution, width, height = 100, 5, 5\n\nfor row in am_gdf.values:\n    setor_geo = folium.GeoJson(row[2])\n    \n    setor_geo_id = row[0]\n    setor_geo_bairro = row[1]\n    \n    html = '<h2>{}<\/h2>'.format('Setor Censit\u00e1rio: ' + str(setor_geo_id))\n    html += '<hr>'\n    html += '<p>{}<\/p>'.format('Bairro: ' + setor_geo_bairro)\n    html += '<hr>'\n    html += am_gdf[am_gdf['CD_GEOCODI'] == setor_geo_id][['DOMICILIOS', \n                                                          'ILUMINACAO', \n                                                          'PAVIMENTACAO']].to_html(index=False)\n    html += am_gdf[am_gdf['CD_GEOCODI'] == setor_geo_id][['CALCADA',\n                                                          'RAMPA_CADEIRANTE',\n                                                          'ARBORIZACAO']].to_html(index=False)\n    \n    iframe = folium.IFrame(html, width=(width*resolution)+20, height=(height*resolution)+20)\n    setor_geo.add_child(folium.Popup(iframe, max_width=2650))\n    \n    mapa_manaus.add_child(setor_geo)","b821af37":"mapa_manaus","f182c3c3":"mapa_manaus.save('mapa_manaus_setores_censitarios.html')","5f277439":"am_gdf","35604dd7":"coord_centro_manaus = [-3.1019400, -60.0250000]\nmapa_manaus = folium.Map(location=coord_centro_manaus, zoom_start=12)","0ca10d18":"folium.Choropleth(geo_data = am_gdf,\n                  name = 'Domic\u00edlios',\n                  data = am_gdf,\n                  columns = ['CD_GEOCODI', 'DOMICILIOS'],\n                  key_on = 'feature.properties.CD_GEOCODI',\n                  fill_color = 'RdGy',\n                  fill_opacity = 0.75,\n                  line_opacity = 0.75,\n                  legend_name = 'Domic\u00edlios').add_to(mapa_manaus)\n\nfolium.Choropleth(geo_data = am_gdf,\n                  name = 'Ilumina\u00e7\u00e3o P\u00fablica',\n                  data = am_gdf,\n                  columns = ['CD_GEOCODI', 'ILUMINACAO'],\n                  key_on = 'feature.properties.CD_GEOCODI',\n                  fill_color = 'RdGy',\n                  fill_opacity = 0.75,\n                  line_opacity = 0.75,\n                  legend_name = 'Ilumina\u00e7\u00e3o P\u00fablica').add_to(mapa_manaus)\n\nfolium.Choropleth(geo_data = am_gdf,\n                  name = 'Rampas para cadeirantes',\n                  data = am_gdf,\n                  columns = ['CD_GEOCODI', 'RAMPA_CADEIRANTE'],\n                  key_on = 'feature.properties.CD_GEOCODI',\n                  fill_color = 'RdGy',\n                  fill_opacity = 0.75,\n                  line_opacity = 0.75,\n                  legend_name = 'Rampas para cadeirantes').add_to(mapa_manaus)\n\nfolium.Choropleth(geo_data = am_gdf,\n                  name = 'Arboriza\u00e7\u00e3o',\n                  data = am_gdf,\n                  columns = ['CD_GEOCODI', 'ARBORIZACAO'],\n                  key_on = 'feature.properties.CD_GEOCODI',\n                  fill_color = 'RdGy',\n                  fill_opacity = 0.75,\n                  line_opacity = 0.75,\n                  legend_name = 'Arboriza\u00e7\u00e3o').add_to(mapa_manaus)\n\nfolium.LayerControl().add_to(mapa_manaus)","97abe3da":"mapa_manaus.save('mapa_manaus_entorno.html')","9185c395":"### 1.2) Censo de 2010\n\n* Fonte: [Instituto Brasileiro de Geografia e Estat\u00edstica (IBGE)](https:\/\/www.ibge.gov.br\/geociencias\/downloads-geociencias.html)","7b2ac5a6":"## 1) Fontes de dados","08a192b5":"![Arquivos da Base de Informa\u00e7\u00f5es por Setores Censit\u00e1rios.png](attachment:ba5691fd-ed95-4aea-8188-570a11fbd7a3.png)","3f322d23":"### 2.2) Visualizando informa\u00e7\u00f5es de bairros","21d48b38":"### 2.3) Cria\u00e7\u00e3o de mapas coropl\u00e9ticos com os dados do IBGE","9dc80b36":"### 1.1) Setores censit\u00e1rios\n\n* Fonte: [Instituto Brasileiro de Geografia e Estat\u00edstica (IBGE)](https:\/\/www.ibge.gov.br\/geociencias\/organizacao-do-territorio\/malhas-territoriais\/26565-malhas-de-setores-censitarios-divisoes-intramunicipais.html?=&t=downloads)","e1cfc06f":"## 2) O que podemos extrair de informa\u00e7\u00f5es dos dados?","c04ee9e4":"# An\u00e1lise de dados do IBGE para a cidade de Manaus-AM\n\n## Resumo\n\nNeste notebook, iremos explorar dados do Censo de 2010 do IBGE utilizando a linguagem Python e as bibliotecas Folium e GeoPandas.","9fc3c8c6":"### 2.1) Limpeza e transforma\u00e7\u00e3o de dados"}}