{"cell_type":{"f1d491dc":"code","15b24b14":"code","0cbc1f6c":"code","47260081":"code","e5a6469a":"code","5b2946ee":"code","59025531":"code","e516f8cb":"code","f8b6209a":"code","a750b8ae":"code","ad499244":"code","03521ffb":"code","ff7311cc":"code","fc4da023":"code","565b39cc":"code","247c5656":"code","c845996a":"code","3f569aac":"code","0d227ca7":"code","83a9c0c7":"code","59877b81":"code","c3cae0d3":"code","29903410":"code","116e6e53":"code","96fd00b6":"code","892c637a":"code","e9e52b5b":"code","26a75ddd":"code","b2e55c28":"code","08840e3f":"code","4c2f62c6":"code","179a59d9":"code","ff38fd8c":"code","39a3494f":"code","e92e882d":"code","cf235d0f":"code","fca004de":"code","0010d0e4":"code","f58ce32e":"code","2813e292":"code","2a83756e":"code","bcfcb7d4":"code","cd159cd9":"code","ad20c7c4":"code","d17e9848":"code","753d5a26":"code","2571b4b4":"code","84d845e9":"code","3d8d0860":"code","fbc53a7b":"code","d0814274":"code","d1ba4c82":"code","4d34e493":"code","fad5a5ad":"code","ba0bf893":"code","3fe35f35":"code","18ecf218":"code","8f25aa6a":"code","bf476280":"code","f867d3ff":"code","06e4e798":"code","76969527":"code","77ac1d50":"code","9155e87e":"markdown","339c2aee":"markdown","7a1599d5":"markdown","63eacac1":"markdown","eb56532f":"markdown","19181d97":"markdown","010dc414":"markdown","cebb2c95":"markdown","1c488995":"markdown","fb9d7622":"markdown","35f4a2cf":"markdown","1ccac2dc":"markdown","9c47ea45":"markdown","73048c7c":"markdown","21f65130":"markdown","5ff11118":"markdown","b60e7145":"markdown","c0b43836":"markdown","6865bf4d":"markdown","b7911e09":"markdown","e0976795":"markdown","44eee784":"markdown","44203373":"markdown","0518c6f2":"markdown","e7ed59d3":"markdown","43cdee33":"markdown","1bdf07d2":"markdown","4863f374":"markdown","f0047a21":"markdown","57576f9d":"markdown","b91e77e9":"markdown","eaac07ba":"markdown","8feab917":"markdown","2a59ea10":"markdown","f15d3b37":"markdown","f78fe961":"markdown","704d592c":"markdown","76f8108a":"markdown","132d285d":"markdown"},"source":{"f1d491dc":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","15b24b14":"import matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\nfrom sklearn import preprocessing","0cbc1f6c":"df =  pd.read_csv('\/kaggle\/input\/africa-economic-banking-and-systemic-crisis-data\/african_crises.csv')","47260081":"df.head()","e5a6469a":"df.info()","5b2946ee":"df[pd.isnull(df).any(axis=1)]","59025531":"df.nunique().sort_values()","e516f8cb":"df['banking_crisis'] = df['banking_crisis'] .apply(lambda x: 1 if x == 'crisis' else 0)","f8b6209a":"df.head()","a750b8ae":"def_palette = sns.color_palette()\ncat_palette = sns.color_palette(\"hls\", 16)\nfig, ax = plt.subplots(figsize = (12,6)) \nfig = sns.lineplot(x='year', y='banking_crisis', data=df, palette=cat_palette, ax=ax).set_title('Strength of crisis in Africa')\n","ad499244":"con_columns = ['exch_usd','inflation_annual_cpi'] #columns with continuous variables","03521ffb":"sns.set(style='whitegrid')\nplt.figure(figsize=(10,10))\ncount = 1\n\nfor col in con_columns:\n    plt.subplot(2,1,count)\n    count += 1\n    sns.distplot(df[col])","ff7311cc":"q1 = df[con_columns].quantile(0.25)\nq3 = df[con_columns].quantile(0.75)\niqr = q3 - q1\n\ndf[con_columns] = df[con_columns].clip(q1 - 1.5*iqr, q3 + 1.5*iqr, axis=1)","fc4da023":"sns.set(style='whitegrid')\nplt.figure(figsize=(10,10))\ncount = 1\n\nfor col in df[con_columns]:\n    plt.subplot(2,1,count)\n    count += 1\n    sns.distplot(df[col])","565b39cc":"df.groupby(['country', 'banking_crisis']).size().sort_values(ascending=False)","247c5656":"individual_countries = list(df['country'].unique())","c845996a":"sns.set(style='whitegrid')\nplt.figure(figsize=(30,30))\n\ncount = 1\n\nfor country in individual_countries:\n    plt.subplot(5,3,count)\n    count+=1\n    \n    sns.lineplot(df[df.country==country]['year'],\n                 df[df.country==country]['exch_usd'],\n                 label=country)              \n            \n    plt.plot([(df[np.logical_and(df.country==country,df.banking_crisis==1)]['year'].unique()),\n                  (df[np.logical_and(df.country==country,df.banking_crisis==1)]['year']).unique()],\n                 [0,np.max(df[df.country==country]['exch_usd'])],\n                 color='black',\n                 linestyle='dotted',\n                 alpha = 0.8)    \n    ","3f569aac":"sns.set(style='whitegrid')\nplt.figure(figsize=(30,30))\ncount = 1\n\nfor country in individual_countries:\n    plt.subplot(5,3,count)\n    count+=1\n    \n    sns.lineplot(df[df.country==country]['year'],\n                 df[df.country==country]['exch_usd'],\n                 label=country)\n                 \n  \n    plt.plot([np.min(df[np.logical_and(df.country==country,df.independence==1)]['year']),\n              np.min(df[np.logical_and(df.country==country,df.independence==1)]['year'])],\n             [0,\n              np.max(df[df.country==country]['exch_usd'])],\n             color='black',\n             linestyle='dotted',\n             alpha=0.8)\n    plt.text(np.min(df[np.logical_and(df.country==country,df.independence==1)]['year']),np.max(df[df.country==country]['exch_usd'])\/2,\n             'Independence',\n             rotation=-90)\n\n    \n   \n    plt.tight_layout()","0d227ca7":"sns.set(style='whitegrid')\nplt.figure(figsize=(30,30))\ncount = 1\n\nfor country in individual_countries:\n    plt.subplot(5,3,count)\n    count+=1\n    \n    sns.lineplot(df[df.country==country]['year'],\n                 df[df.country==country]['inflation_annual_cpi'],\n                 label=country)\n                 \n  \n    plt.plot([np.min(df[np.logical_and(df.country==country,df.independence==1)]['year']),\n              np.min(df[np.logical_and(df.country==country,df.independence==1)]['year'])],\n             [0,\n              np.max(df[df.country==country]['inflation_annual_cpi'])],\n             color='black',\n             linestyle='dotted',\n             alpha=0.8)\n    plt.text(np.min(df[np.logical_and(df.country==country,df.independence==1)]['year']),np.max(df[df.country==country]['inflation_annual_cpi'])\/2,\n             'Independence',\n             rotation=-90)\n\n    \n   \n    plt.tight_layout()","83a9c0c7":"sns.set(style='whitegrid')\ncols_countplot=['systemic_crisis','domestic_debt_in_default','sovereign_external_debt_default','currency_crises','inflation_crises']\nplt.figure(figsize=(20,20))\ncount = 1\ndf_bank_crisis = df.loc[df['banking_crisis'] == 1]\n\nfor col in cols_countplot:\n    plt.subplot(3,2,count)    \n    count+= 1\n    sns.countplot(y='country', hue = col, data = df_bank_crisis).set_title(col)    \n    plt.legend(loc = 0)","59877b81":"sns.set(style='whitegrid')\ncols_countplot=['systemic_crisis','domestic_debt_in_default','sovereign_external_debt_default','currency_crises','inflation_crises']\nplt.figure(figsize=(20,20))\ncount = 1\ndf_no_bank_crisis = df.loc[df['banking_crisis'] == 0]\n\nfor col in cols_countplot:\n    plt.subplot(3,2,count)    \n    count+= 1\n    sns.countplot(y='country', hue = col, data = df_no_bank_crisis).set_title(col)    \n    plt.legend(loc = 0)","c3cae0d3":"plt.figure(figsize=(10,10))\nsns.heatmap(df.corr(), annot = True)","29903410":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import metrics\nfrom sklearn.metrics import classification_report, confusion_matrix","116e6e53":"X = df.drop(['banking_crisis','cc3','country','year','case'], axis = 1)\ny = df['banking_crisis'] ","96fd00b6":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.30, random_state=42) ","892c637a":"logistic_model = LogisticRegression()","e9e52b5b":"logistic_model.fit(X_train,y_train)","26a75ddd":"y_predict_logm = logistic_model.predict(X_test)","b2e55c28":"column_label = list(X_train.columns)\nmodel_Coeff = pd.DataFrame(logistic_model.coef_, columns = column_label)\nmodel_Coeff['intercept'] = logistic_model.intercept_\nprint(\"Coefficient Values Of The Surface Are: \", model_Coeff)","08840e3f":"logmodel_score = logistic_model.score(X_test,y_test)\nprint('Model score:\\n', logmodel_score)","4c2f62c6":"print(metrics.confusion_matrix(y_test, y_predict_logm)) #22 = true positive, 291 = true negative, 2 = false positive, 3 = false negative","179a59d9":"print(classification_report(y_test,y_predict_logm))","ff38fd8c":"from sklearn.tree import DecisionTreeClassifier","39a3494f":"decision_tree = DecisionTreeClassifier()","e92e882d":"decision_tree.fit(X_train,y_train)","cf235d0f":"y_predict_tree = decision_tree.predict(X_test)","fca004de":"print(metrics.confusion_matrix(y_test, y_predict_tree))","0010d0e4":"print(classification_report(y_test,y_predict_tree))","f58ce32e":"from IPython.display import Image  \nfrom sklearn.externals.six import StringIO  \nfrom sklearn.tree import export_graphviz\nimport pydot \n\nfeatures = list( df.drop(['banking_crisis','cc3','country','year','case'], axis = 1))","2813e292":"dot_data = StringIO()  \nexport_graphviz(decision_tree, out_file=dot_data,feature_names=features,filled=True,rounded=True)\n\ngraph = pydot.graph_from_dot_data(dot_data.getvalue())  \nImage(graph[0].create_png())  ","2a83756e":"from sklearn.ensemble import RandomForestClassifier\nrfc = RandomForestClassifier(n_estimators=100)\nrfc.fit(X_train, y_train)","bcfcb7d4":"rfc_pred = rfc.predict(X_test)","cd159cd9":"print(confusion_matrix(y_test,rfc_pred))","ad20c7c4":"print(classification_report(y_test,rfc_pred))","d17e9848":"from sklearn.svm import SVC","753d5a26":"svc_model = SVC() #with predefined parameters","2571b4b4":"svc_model.fit(X_train,y_train)","84d845e9":"svm_pred = svc_model.predict(X_test)","3d8d0860":"print(confusion_matrix(y_test,svm_pred))","fbc53a7b":"print(classification_report(y_test,svm_pred))","d0814274":"from sklearn.model_selection import GridSearchCV","d1ba4c82":"param_grid = {'C': [0.1,1, 10, 100], 'gamma': [1,0.1,0.01,0.001]} ","4d34e493":"grid = GridSearchCV(SVC(),param_grid,refit=True,verbose=2)\ngrid.fit(X_train,y_train)","fad5a5ad":"grid.best_params_ ","ba0bf893":"grid_pred = grid.predict(X_test)","3fe35f35":"print(confusion_matrix(y_test,grid_pred))","18ecf218":"print(classification_report(y_test,grid_pred))","8f25aa6a":"from sklearn.cluster import KMeans","bf476280":"kmeans = KMeans(n_clusters=2)","f867d3ff":"kmeans.fit(df.drop(['banking_crisis','cc3','country','year','case'], axis = 1))","06e4e798":"kmeans.cluster_centers_","76969527":"df['Cluster'] = df['banking_crisis']","77ac1d50":"from sklearn.metrics import confusion_matrix,classification_report\nprint(confusion_matrix(df['Cluster'],kmeans.labels_))\nprint(classification_report(df['Cluster'],kmeans.labels_))","9155e87e":"**SVM**","339c2aee":"**Decision tree**","7a1599d5":"We can see improvement in results with new parameters and work with SVM as suitable modelling approach for this dataset","63eacac1":"Now it's usefull to check for unique values within every column in order to see columns just with 0,1 values ","eb56532f":"**Logistic regression**","19181d97":"Coefficients of the sigmoid function for logistic model","010dc414":"Systemic crisis seems to be (not) occuring when banking crisis ( does not) occurs. Simoutaneosly, based just on these graphics I would assume that domestic debt in default has no effect at all on banking crisis whether it occurs or not. We should check this with a correlation matrix.","cebb2c95":"We run again the model with parameters we found as best in the grid search ","1c488995":"We see an inclination of values towards 0 which can eventually provide incorrect information about dataset. This we can remove by taking values (outliers) within first and third quantile (removing minimum and maximum values).","fb9d7622":"* Checking top 10 rows for of the dataset","35f4a2cf":"According to below codes we don't have null values in our dataset","1ccac2dc":"*When I compare above models, SVM with adjusted parameters (C:100, gamma :0.01) performs the best for the dataset. Simoutaneosly, random forests and logistic regression can be also used without modifications. Remaining models would need more feature engineering in order to improve their results*","9c47ea45":"**Exploratory data analysis**","73048c7c":"The data are still skewed but the range of y axis has improved. ","21f65130":"Keeping just relevant columns for dependent X variables and independent y variable","5ff11118":"**Modelling**","b60e7145":"Looking closer at number of events (occured vs. not-occured) in binary columns when country faced banking crisis.","c0b43836":"Looking just on the banking crisis row we can see positive correlation between banking crisis and systemic crisis. This means when one of them appears the second one most probably follows. Investopedia also writes about relationship between systemic crisis and banking crisis (https:\/\/www.investopedia.com\/terms\/s\/systemic-risk.asp)\nOther indicators seem to have nor strong positive or negative correlation with the crisis.","6865bf4d":"*Best parameters*","b7911e09":"*First I start with logistic regression as the basic technique for classifying binary data*","e0976795":"Distribution of continuous columns","44eee784":"When we run the score of the model we see that model achieves high number and thus have high explanatory power","44203373":"Without any futher data manipulation applying K-means (cluster) model on the dataset results in poor numbers for precision, recall f1-score and accuracy. Model isn't suitable in this setting.","0518c6f2":"The same can be done also when country didn't face a crisis.","e7ed59d3":"Is there any pattern in trend lines for countries and their exchange rate\/inflation when banking crisis occur? There seems to be no strong evidence when looking at the visuals below.","43cdee33":"First hint on number of crises in individual African countries","1bdf07d2":"**Random Forests**","4863f374":"We can see that splitting happens with relativily low Gini coefficients (majority of values belongs to one class, if the division would be even we would 0.5 Gini index)","f0047a21":"We can search for the best parameters with the help of Grid Search","57576f9d":"Does indepedence have an effect on inflaction and exchange rate? This also doesn't seem to be the case. ","b91e77e9":"Let's run the data against several classification models","eaac07ba":"We get quite good results with logistic model (we don't have a robust sample therefore results show the model accuracy high)","8feab917":"When applying Random tree on the dataset we receive very good results.","2a59ea10":"Splitting columns for train and test samples","f15d3b37":"**K Means clustering**","f78fe961":"With regards to values in the columns, none of the numeric columns needs to be converted into categorical only the banking_crisis.","704d592c":"Compared to logistic model, decision tree model show lower results.","76f8108a":"First we should look on the overall crisis 'occurence' in African states. It hit Africa strongly 3 times before 1970. Since 1970 the crises have started and were occuring repeatedly, hitting hardest around 1990s.","132d285d":"We've got quite good results with predefined parameters"}}