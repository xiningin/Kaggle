{"cell_type":{"4c827f59":"code","14651d53":"code","bcaa5e9d":"code","bf144083":"code","6933f8f3":"code","5d40939b":"code","de7e4208":"code","d7c4776f":"code","b919c01b":"code","224e6362":"code","8b1fc446":"code","3a111f57":"code","97dff41a":"code","0c830517":"code","387c7ba4":"markdown","1c4b7c68":"markdown","73ba2313":"markdown","93fef30c":"markdown","26ade320":"markdown"},"source":{"4c827f59":"!pip install tensorflow-gpu==1.15.0 tensorflow==1.15.0 stable-baselines gym-anytrading gym","14651d53":"import gym\nimport gym_anytrading\n\n#Stable baselines  RL stuff\n\nfrom stable_baselines.common.vec_env import DummyVecEnv\nfrom stable_baselines import A2C # the algo we will using\n\n#Processing libraries\nimport numpy as np \nimport pandas as pd\nfrom matplotlib import pyplot as plt \n","bcaa5e9d":"df=pd.read_csv('..\/input\/gmedata\/gmedata.csv')","bf144083":"df.head()","6933f8f3":"df.dtypes","5d40939b":"df[\"Date\"]=pd.to_datetime(df['Date'])\ndf.dtypes","de7e4208":"#Set the Date column as index \n\ndf.set_index('Date', inplace=True)\ndf.head()","d7c4776f":"env=gym.make('stocks-v0',df=df,frame_bound=(5,100),window_size=5)","b919c01b":"env.signal_features","224e6362":"env.action_space","8b1fc446":"# Action :{ buy or sell}\n\nstate=env.reset()\nwhile True:\n    action =env.action_space.sample()\n    n_state ,reward,done, info=env.step(action)\n    if done:\n        print('info',info)\n        break\nplt.figure(figsize=(15,6))\nplt.cla()\nenv.render_all()\nplt.show()","3a111f57":"env_maker=lambda: gym.make('stocks-v0',df=df,frame_bound=(5,100),window_size=5)\n\nenv=DummyVecEnv([env_maker])","97dff41a":"model=A2C('MlpLstmPolicy',env,verbose=1)\nmodel.learn(total_timesteps=100000)","0c830517":"#Setting up the Agent Environment\nenv = gym.make('stocks-v0', df=df, frame_bound=(90,110), window_size=5)\nobs = env.reset()\nwhile True: \n    obs = obs[np.newaxis, ...]\n    action, _states = model.predict(obs)\n    obs, rewards, done, info = env.step(action)\n    if done:\n        print(\"info\", info)\n        break\n\n\n#Plotting our Model for Trained Trades\nplt.figure(figsize=(15,6))\nplt.cla()\nenv.render_all()\nplt.show()","387c7ba4":"Convert Date column to datetime","1c4b7c68":"## 4. Evluation ","73ba2313":"## 2. Build Enviroment","93fef30c":"## 3.Build Environment and Train","26ade320":"## 1. Bring in Marketwatch GME data"}}