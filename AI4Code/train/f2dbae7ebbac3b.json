{"cell_type":{"f104e53e":"code","03266471":"code","2e92e944":"code","16a3b6f0":"code","c037ce1e":"code","ad655221":"code","45aa5257":"code","961375cd":"code","0676208f":"code","799443d0":"code","384a9958":"code","b5855902":"code","e8a70653":"code","15a1b01a":"code","8a54624a":"code","54fcbd56":"markdown","8ba254d3":"markdown","07bd11a7":"markdown","777e95c6":"markdown"},"source":{"f104e53e":"import pandas as pd\nimport numpy as np\nfrom collections import Counter\nfrom tqdm.notebook import tqdm","03266471":"\"\"\"\npd.__version__: 1.3.4\nnp.__version__: 1.19.2\nscipy.__version__: 1.5.2\ntqdm.__version__: 4.50.2\n\"\"\"","2e92e944":"PATH = \"\/kaggle\/input\/wb-item-recommendation\/\"","16a3b6f0":"data_train = pd.read_csv(PATH + \"train.csv\")\ndata_train.head()","c037ce1e":"data_test = pd.read_csv(PATH + \"test.csv\")\ndata_test.head()","ad655221":"data_train.shape[0], data_test.shape[0]","45aa5257":"submission = pd.read_csv(PATH + \"submission.csv\")\nsubmission.head()","961375cd":"data_lst = []\ntarget_lst = []\n\nfor _, row in tqdm(data_train.iterrows(), total=data_train.shape[0]):\n    data_lst.append(list(row[\"Data\"].split()))\n    target_lst.append(list(row[\"Target\"].split()))\n    \ndata_train[\"Data\"] = data_lst\ndata_train[\"Target\"] = target_lst","0676208f":"data_train.head()","799443d0":"intersect_df = data_train.explode(\"Data\").explode(\"Target\")\nintersect_df[\"Data\"] = intersect_df[\"Data\"].astype(int)\nintersect_df[\"Target\"] = intersect_df[\"Target\"].astype(int)\nintersect_df.head(10)","384a9958":"intersect_df.shape[0]","b5855902":"cnt_target = Counter(intersect_df[\"Target\"])","e8a70653":"cnt_target.most_common(10)","15a1b01a":"rec_ids = list(map(lambda x: x[0], cnt_target.most_common(10)))\nbase_rec = \" \".join([str(id) for id in rec_ids])\n\nbase_rec","8a54624a":"submission[\"Predicted\"] = base_rec\nsubmission.to_csv(\"\/kaggle\/working\/baseline_1.csv\", index=False)","54fcbd56":"## Baseline #1: \u0421\u0430\u043c\u044b\u0435 \u043f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0435 \u0442\u043e\u0432\u0430\u0440\u044b","8ba254d3":"## \u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445","07bd11a7":"\u0421\u043e\u0437\u0434\u0430\u0434\u0438\u043c \u0434\u0430\u0442\u0430\u0444\u0440\u0435\u0439\u043c, \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0449\u0438\u0439 \u0432\u0441\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u043f\u0435\u0440\u0435\u0441\u0435\u0447\u0435\u043d\u0438\u044f \u0432\u0438\u0434\u0430<br>\n**\u0422\u043e\u0432\u0430\u0440 \u0438\u0437 Data** - **\u0422\u043e\u0432\u0430\u0440 \u0438\u0437 Target**","777e95c6":"## \u041f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445"}}