{"cell_type":{"d7653d13":"code","917de917":"code","45b34bec":"code","338041f4":"code","6692acc9":"code","f1d4c290":"code","59338766":"code","e5eea250":"code","157024d2":"code","39c2ab31":"code","84b2778f":"code","20959bf3":"code","3dfdd0cb":"code","a5073740":"code","6898993f":"code","9abbfe63":"code","b3dcb0f9":"code","c9d557e6":"code","3b36aa5e":"code","91ba98f8":"code","784f7b6e":"code","2b24839e":"code","5407a9e7":"code","997e072a":"code","09c6e69a":"code","51e8715a":"code","f688e22b":"code","b2df2d8b":"code","bc1661de":"code","522151f2":"code","0d8f003d":"code","476e3de5":"code","e9507d8d":"code","ad91e3b1":"markdown","4706dc81":"markdown","cab5cd69":"markdown","f0b484e0":"markdown","05a9f538":"markdown","e6d6f4d6":"markdown","1f44c4bc":"markdown","5fef3b9e":"markdown","c56f0d9b":"markdown","d976ed7d":"markdown","48c68319":"markdown","7be012c8":"markdown","4b4b0dc6":"markdown","51c585fd":"markdown","47b5f758":"markdown","b26ccea9":"markdown","0c3208fa":"markdown","c1462469":"markdown","79b005a0":"markdown","adced10d":"markdown","347549da":"markdown","cb64bbad":"markdown","8d30ca9e":"markdown","a494dbf7":"markdown","8c0e8711":"markdown","ed6f15e1":"markdown","6b1774f4":"markdown","1b3e78b3":"markdown","f40168a6":"markdown","dde10657":"markdown","9c65ea4f":"markdown","126ee31c":"markdown"},"source":{"d7653d13":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set_style('dark')\nimport pickle\nimport os\nimport tarfile\nimport urllib","917de917":"housing_data = pd.read_csv(\"..\/input\/california-housing-prices\/housing.csv\")\nhousing_data","45b34bec":"housing_data[housing_data['median_house_value']==500001.0]","338041f4":"housing_data.info()","6692acc9":"housing_data[housing_data['total_bedrooms'].isna()]","f1d4c290":"housing_data['total_bedrooms']=housing_data['total_bedrooms'].fillna(housing_data['total_bedrooms'].dropna().mean())","59338766":"housing_data.info()","e5eea250":"housing_data","157024d2":"housing_data[housing_data.duplicated()==True].count()","39c2ab31":"housing_data.describe()","84b2778f":"plt.style.use(\"dark_background\")\nplt.figure(figsize=(18, 10))\nsns.histplot(housing_data.median_house_value, bins = 45, color='red')\nplt.xlabel('Housing Prices in $')\nplt.ylabel('Number of Houses')\nplt.title('Median Price of Housing in a Block', fontsize=16)\nplt.show()","20959bf3":"plt.figure(figsize=(18,10))\nplt.scatter(housing_data['latitude'],housing_data['longitude'],c=housing_data['population'], cmap='Spectral')\nplt.colorbar().set_label(\"Population\")\nplt.title('Population Magnitude in Different Areas')\nplt.xlabel('Latitude')\nplt.ylabel('Longitude')\nplt.show()","3dfdd0cb":"plt.figure(figsize=(18,10))\nhousing_data['housing_median_age'].value_counts().plot(kind='bar',color='orange')\nplt.xlabel(\"Age\")\nplt.ylabel(\"No. of Houses\")\nplt.title(\"Median Age of Housing\")","a5073740":"plt.figure(figsize=(9,5))\nhousing_data['ocean_proximity'].value_counts().plot(kind='pie',autopct='%1.2f%%')\nplt.title('Preferred Proximity from Ocean')","6898993f":"sns.heatmap(housing_data.iloc[:,2:9].corr(),annot=True)\nplt.title(\"Correlation Matrix\")","9abbfe63":"plt.figure(figsize=(16, 10))\nplt.scatter(housing_data['median_house_value'],housing_data['median_income'], alpha=0.2,color='white')\nplt.xlabel('Median House Value')\nplt.ylabel('Median Income')\nplt.title('Median Price vs Median Income')\nplt.show()","b3dcb0f9":"sns.pairplot(housing_data.iloc[:,2:9])","c9d557e6":"housing_data['rooms_per_household']=housing_data['total_rooms']\/housing_data['households']\nhousing_data['bedrooms_per_room']=housing_data['total_bedrooms']\/housing_data['total_rooms']\nhousing_data['bedrooms_per_household']=housing_data['total_bedrooms']\/housing_data['households']\nhousing_data['household_per_population']=housing_data['households']\/housing_data['population']\nhousing_data['population_per_room']=housing_data['population']\/housing_data['total_rooms']\nhousing_data['population_per_bedroom']=housing_data['population']\/housing_data['total_bedrooms']\nhousing_data=housing_data.drop(columns=['households'])\nhousing_data=housing_data.drop(columns=['total_bedrooms'])","3b36aa5e":"list(housing_data.columns.values)","91ba98f8":"housing_data=housing_data[['longitude','latitude',\n 'housing_median_age',\n 'total_rooms',\n 'population',\n 'median_income',\n 'rooms_per_household',\n 'bedrooms_per_room',\n'bedrooms_per_household',\n 'household_per_population',\n'population_per_room',\n'population_per_bedroom',\n'ocean_proximity',\n 'median_house_value'\n ]]","784f7b6e":"housing_data","2b24839e":"X=housing_data.iloc[:,:-1].values\ny=housing_data.iloc[:,-1].values\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.preprocessing import OneHotEncoder\nct=ColumnTransformer(transformers=[('encoder',OneHotEncoder(),[12])],remainder='passthrough')","5407a9e7":"X=np.array(ct.fit_transform(X))","997e072a":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.2)","09c6e69a":"from sklearn.preprocessing import StandardScaler\nscaler=StandardScaler()\nX_train[:,5:]=scaler.fit_transform(X_train[:,5:])\nX_test[:,5:]=scaler.transform(X_test[:,5:])","51e8715a":"from sklearn.ensemble import RandomForestRegressor\nregressor=RandomForestRegressor(n_estimators=50)\nregressor.fit(X_train,y_train)","f688e22b":"y_pred=regressor.predict(X_test)\nnp.set_printoptions(precision=2)\ncompare=(np.concatenate((y_pred.reshape(len(y_pred),1),y_test.reshape(len(y_test),1)),axis=1))","b2df2d8b":"compare","bc1661de":"from sklearn.metrics import r2_score\nr2_score(y_test, y_pred)","522151f2":"from sklearn.metrics import mean_absolute_error\nmean_absolute_error(y_test, y_pred)","0d8f003d":"from sklearn.metrics import mean_squared_error\nfrom math import sqrt\nprint(sqrt(mean_squared_error(y_test, y_pred)))","476e3de5":"pickle.dump(regressor,open('model.pkl','wb'))","e9507d8d":"pickle.load(open('model.pkl','rb'))","ad91e3b1":"Hence, the prediction by this model is on an average off by this value","4706dc81":"### **Saving model to disk**","cab5cd69":"This shows most of the houses are in **<1H proximity** from the ocean.\n\n**Island** has the least number of houses.","f0b484e0":"**Data Cleaning**","05a9f538":"As mentioned earlier, **ocean_proximity** needs to be encoded as it is a categorical data.","e6d6f4d6":"**Splitting into Train set and Test set**","1f44c4bc":"This is the accuracy of the model in predicting the housing prices given the parameters. ","5fef3b9e":"Added more features.","c56f0d9b":"Using the **R-Squared** metric.","d976ed7d":"### **Predicting Test Set Results**","48c68319":"### **EDA**","7be012c8":"**One Hot Encoding**","4b4b0dc6":"### **Loading model to compare results**","51c585fd":"The maximum number of houses are **52** years old.","47b5f758":"### **Importing Libraries and Dataset**","b26ccea9":"This is the comparision between the predicted(left) and the original(right) values corresponding to the test set.\n\nSome values are very close while some have a significant difference.","0c3208fa":"# **Estimation of House Value in California**","c1462469":"**Plots**","79b005a0":"Using the **Root Mean Squared Error** metric","adced10d":"No duplicates.","347549da":"Here **median_house_value** is the dependent attribute and **longitude, latitude, housing_median_age, total_rooms, total_bedrooms, population, households and median_income** are independent attributes.\n\n**ocean_proximity** needs to be encoded to train the model which will be dealt with later.","cb64bbad":"The RMSE metric squares the error before it is averaged and so higher weight is given to larger errors. The presence of ouliers significantly affects the performance.","8d30ca9e":"The correlation between all the factors is depicted by this.\n\nIt is clear from this that the price of the houses don't vary linearly with any of the parameters.","a494dbf7":"It can be inferred that most of the places have **Population<5000**.\n\nThere are very few places with **Population>15000**.","8c0e8711":"Using the **Mean Absolute Error** metric","ed6f15e1":"### **Feature Engineering**","6b1774f4":"### **Fitting Random Forest Regression Model**","1b3e78b3":"**Scaling the Features**","f40168a6":"### **Measuring the Accuracy**","dde10657":"Many features have negligible correlation between them.\n\nFeatures like **population,total_bedrooms,total_rooms,households** are highly correlated.\n\nMaximum correlation is seen between **households and total_bedrooms**.\n\n**median_house_value** has maximum correlation with **median_income**.","9c65ea4f":"**Modifying the Features to get a Better Model**","126ee31c":"**total_bedrooms** have 207 null values."}}