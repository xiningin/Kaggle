{"cell_type":{"e936fe50":"code","da07898e":"code","a6ac9651":"code","9280a018":"code","38b830be":"code","84d24a2d":"code","10ba8d19":"code","45b304c3":"code","2d40d62f":"code","cf9f64ea":"code","d95964d5":"code","4258d7d3":"code","8a1b6318":"code","9d26aabd":"code","bad7a19a":"code","6ab39ee0":"code","b8f173c9":"code","0de4a513":"code","a926fee7":"code","bfcea5e8":"code","ca75dccb":"markdown","15d38cd4":"markdown","0a59bfc9":"markdown","75f3eb85":"markdown","1dacfe80":"markdown","0299f6e5":"markdown","f0100999":"markdown","adf73d4e":"markdown","ae802c94":"markdown","12229948":"markdown","8736f07e":"markdown","603f4632":"markdown","1c889e36":"markdown","b630787f":"markdown","2318ce47":"markdown","c0161614":"markdown","fb116ebf":"markdown"},"source":{"e936fe50":"# This data is on csv because i cannot run the anaconda on my computer due to performance issue, i save the public data to csv and import it into \n# kaggle system, but for this is not an excuse, i will list the following code IF i run the bigquery in my anaconda environtment \n#(it will not be compileable if you run it now, but the gist will be delivered perfectly)\n\n#from google.cloud import bigquery\n\n# Create a \"Client\" object\n#client = bigquery.Client()\n\n# Construct a reference to the \"iowa_liquor_sales\" dataset\n#dataset_ref = client.dataset(\"iowa_liquor_sales\", project=\"bigquery-public-data\")\n\n# API request - fetch the dataset\n#dataset = client.get_dataset(dataset_ref)\n\n\n# Construct a reference to the \"sales\" table\n#table_ref = dataset_ref.table(\"sales\")\n\n# API request - fetch the table\n#table = client.get_table(table_ref)\n\n# Preview the first five lines of the \"global_air_quality\" table\n#client.list_rows(table, max_results=5).to_dataframe()","da07898e":"# Query to load the dataset\n#first_query = \"\"\"\n       # SELECT *\n       # FROM `bigquery-public-data.iowa_liquor_sales.sales`\n       # ORDER BY date\n        #LIMIT 15000;\n        #\"\"\"\n# Set up the query (cancel the query if it would use too much of \n# your quota, with the limit set to 10 GB)\n#safe_config = bigquery.QueryJobConfig(maximum_bytes_billed=10**10)\n#first_query_job = client.query(first_query, job_config=safe_config)\n\n# API request - run the query, and return a pandas DataFrame\n#first_results = first_query_job.to_dataframe()\n\n# View top few rows of results\n#print(first_results.head())","a6ac9651":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","9280a018":"#loading datasets\ndf=pd.read_csv(\"\/kaggle\/input\/iowa-minimized\/Iowa.csv\")\nprint(df.head())","38b830be":"# Checking datatypes\ndf.dtypes","84d24a2d":"df.info()\n","10ba8d19":"#checking missing value\ndf.isnull().sum()\n#since most of the missing data are in store location column, it might be better to just drop the whole column since the whole \n#columns contain only coordinates for the store, which will be processed by tableau\n# i drop invoice and item number due to redundancy issue\ndf.drop(['store_location','invoice_and_item_number'],axis=1)\n","45b304c3":"df.category_name.unique()","2d40d62f":"df['category_name'].value_counts()","cf9f64ea":"liq_sell = df.groupby(by=['category_name'])['sale_dollars'].sum()\nliq_sell = liq_sell.reset_index()\nliq_sell = liq_sell.sort_values(by=['sale_dollars'], ascending=False)\nliq_sell = liq_sell.head(10)\nprint(liq_sell.head(10)) \n","d95964d5":"import matplotlib.pyplot as plt\nimport seaborn as sns\n\nplt.figure(figsize=(15, 10))\nsns.barplot(x=\"category_name\", y=\"sale_dollars\", data=liq_sell,palette='crest')\nplt.xticks(rotation=90)","4258d7d3":"df['item_description'].value_counts()","8a1b6318":"top_brands = df.groupby(by=['item_description'])['sale_dollars'].sum()\ntop_brands = top_brands.reset_index()\ntop_brands = top_brands.sort_values(by=['sale_dollars'], ascending=False)\ntop_brands = top_brands.head(10)\nprint(top_brands.head(10))","9d26aabd":"plt.figure(figsize=(15, 10))\nsns.barplot(x=\"item_description\", y=\"sale_dollars\", data=top_brands,palette='mako')\nplt.xticks(rotation=90)","bad7a19a":"city_sell = df.groupby(by=['city'])['sale_dollars'].sum()\ncity_sell = city_sell.reset_index()\ncity_sell = city_sell.sort_values(by=['sale_dollars'], ascending=False)\ncity_sell = city_sell.head(10)\nprint(city_sell.head(10))","6ab39ee0":"plt.figure(figsize=(15, 10))\nsns.barplot(x=\"city\", y=\"sale_dollars\", data=city_sell,palette='rocket')\nplt.xticks(rotation=90)","b8f173c9":"top_store = df.groupby(by=['store_name'])['sale_dollars'].sum()\ntop_store = top_store.reset_index()\ntop_store = top_store.sort_values(by=['sale_dollars'], ascending=False)\ntop_store = top_store.head(10)\nprint(top_store.head(10))","0de4a513":"plt.figure(figsize=(15, 10))\nsns.barplot(x=\"store_name\", y=\"sale_dollars\", data=top_store,palette ='magma')\nplt.xticks(rotation=90)","a926fee7":"county_sell = df.groupby(by=['county'])['sale_dollars'].sum()\ncounty_sell = county_sell.reset_index()\ncounty_sell = county_sell.sort_values(by=['sale_dollars'], ascending=False)\ncounty_sell = county_sell.head(10)\nprint(county_sell.head(10))","bfcea5e8":"plt.figure(figsize=(15, 10))\nsns.barplot(x=\"county\", y=\"sale_dollars\", data=county_sell,palette ='icefire')\nplt.xticks(rotation=90)","ca75dccb":"Somehow some ofthe data from the CSV didnt transfer well, most of the item become object from the normal one is String,it may be wise to transfer them to str and float type data later on.","15d38cd4":"Well this is interesting, althought the most consumed type of booze are canadian whiskies and vodka, the #1 spot belong to captain morgan spiced rum, which is a number 3 place in categorical mean\n\nBut regarding to data nearly all the following data are in the same range.","0a59bfc9":"now we will explore which city do the most liquor purchase","75f3eb85":"The most sucessfull business in the city goes to Sam's Club 8238  at Davenport, while the most profitable store chain goes to Hy-Vee chain.\n\nit might be a good idea to make a customer satisfaction research several hy vee store and implemenent it on local store \n\nwhile it is great to see a local business in the top 10 , cental city liquor inc sure are a great store to hold their place beside the supermarket size store.","1dacfe80":"well from the graphs we can saw that top 2 didnt vary that far, while number 3 and 4 is basically tie at that point (#4 is basically the capital and davenport is arguably closer to other states.)\n\nNow let us plot which store had the most business in term of liquor sales.","0299f6e5":"seeing there is nothing of such (but there are some data that technically same type of spirit, but i let this on because with this not only we can saw which type of spirit that many people buy on daily basis), we can move on to next step","f0100999":"The line below is the data type of each columns in the sql form","adf73d4e":"the most prevalent data are Black velvet, hawkeye and 5'o clock vodka, but we are giving them the same query as before.","ae802c94":"Moving into the data itself","12229948":"well another weird discoveries, council bluffs win the city with the most highest liquor sales in the state of iowa, they won so much that the capital (des moines) are 3 ranks below them\n\nbut let us plot it now.","8736f07e":"Well this is shown that vodka 80 proof is really prevalent in the dataset but does it prove to be the number 1 selling liquor category ?","603f4632":"invoice_and_item_number\tSTRING\tNULLABLE\t\nConcatenated invoice and line number associated with the liquor order. This provides a unique identifier for the individual liquor products included in the store order.\n\ndate\tDATE\tNULLABLE\t\nDate of order\n\nstore_number\tSTRING\tNULLABLE\t\nUnique number assigned to the store who ordered the liquor.\n\nstore_name\tSTRING\tNULLABLE\t\nName of store who ordered the liquor.\n\naddress\tSTRING\tNULLABLE\t\nAddress of store who ordered the liquor.\n\ncity\tSTRING\tNULLABLE\t\nCity where the store who ordered the liquor is located\n\nzip_code\tSTRING\tNULLABLE\t\nZip code where the store who ordered the liquor is located\n\nstore_location\tSTRING\tNULLABLE\t\nLocation of store who ordered the liquor. The Address, City, State and Zip Code are geocoded to provide geographic coordinates. Accuracy of geocoding is dependent on how well the address is interpreted and the completeness of the reference data used.\n\ncounty_number\tSTRING\tNULLABLE\t\nIowa county number for the county where store who ordered the liquor is located\n\ncounty\tSTRING\tNULLABLE\t\nCounty where the store who ordered the liquor is located\n\ncategory\tSTRING\tNULLABLE\t\nCategory code associated with the liquor ordered\n\ncategory_name\tSTRING\tNULLABLE\t\nCategory of the liquor ordered.\n\nvendor_number\tSTRING\tNULLABLE\t\nThe vendor number of the company for the brand of liquor ordered\n\nvendor_name\tSTRING\tNULLABLE\t\nThe vendor name of the company for the brand of liquor ordered\n\nitem_number\tSTRING\tNULLABLE\t\nItem number for the individual liquor product ordered.\n\nitem_description\tSTRING\tNULLABLE\t\nDescription of the individual liquor product ordered.\n\npack\tINTEGER\tNULLABLE\t\nThe number of bottles in a case for the liquor ordered\n\nbottle_volume_ml\tINTEGER\tNULLABLE\t\nVolume of each liquor bottle ordered in milliliters.\n\nstate_bottle_cost\tFLOAT\tNULLABLE\t\nThe amount that Alcoholic Beverages Division paid for each bottle of liquor ordered\n\nstate_bottle_retail\tFLOAT\tNULLABLE\t\nThe amount the store paid for each bottle of liquor ordered\n\nbottles_sold\tINTEGER\tNULLABLE\t\nThe number of bottles of liquor ordered by the store\n\nsale_dollars\tFLOAT\tNULLABLE\t\nTotal cost of liquor order (number of bottles multiplied by the state bottle retail)\n\nvolume_sold_liters\tFLOAT\tNULLABLE\t\nTotal volume of liquor ordered in liters. (i.e. (Bottle Volume (ml) x Bottles Sold)\/1,000)\n\nvolume_sold_gallons\tFLOAT\tNULLABLE\t\nTotal volume of liquor ordered in gallons. (i.e. (Bottle Volume (ml) x Bottles Sold)\/3785.411784)","1c889e36":"seeing there is category of liquor type, it will be good as a index beside location to sort this data, to make it work we need to see the data for if there is redundancy issue (such as double entry due to lowercase letter)","b630787f":"now we will explore which county had the most biggest sale in iowa","2318ce47":"by this line i realize : 16000 lines only covers about 2 days worth of record operation on the whole state of iowa (a little surprising but we are talking on state level data).\n\nnevertheless you can make daily report out of it","c0161614":"From the data we can see that top 5 are canadian whiskies, vodka 80 proof, spiced rum , imported vodka , tequila, and Straight bourbon.\n\n\nnext we will sort what is the most consumed liquor in iowa","fb116ebf":"lets plot it"}}