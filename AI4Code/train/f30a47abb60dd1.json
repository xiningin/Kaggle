{"cell_type":{"ab254cab":"code","555d51fe":"code","38c090f4":"code","75465027":"code","31987f1a":"code","96d44b0c":"code","ac18b2b8":"code","a0a482ae":"code","dd6bd172":"code","ec1378b2":"code","8f37e1c4":"markdown","63930786":"markdown"},"source":{"ab254cab":"import numpy as np \nimport pandas as pd\nimport os\nimport matplotlib.pyplot as plt\nimport sys\nfrom scipy.signal import hilbert\nfrom PyEMD import EMD\npd.options.display.precision = 10\nfrom os import listdir\nprint(listdir(\"..\/input\"))\n","555d51fe":"def instant_phase(imfs):\n    \"\"\"Extract analytical signal through Hilbert Transform.\"\"\"\n    analytic_signal = hilbert(imfs)  # Apply Hilbert transform to each row\n    # Compute angle between img and real\n    phase = np.unwrap(np.angle(analytic_signal))\n    return phase","38c090f4":"signal = pd.read_csv('..\/input\/Signal01.csv')\nprint(signal.head())\nS = signal.signal.values[::10]\nt = signal.quaketime.values[::10]\nprint('S shape: ', S.shape)\nprint('t shape: ', t.shape)","75465027":"dt = t[0] - t[1]\nprint(dt)","31987f1a":"# Compute IMFs with EMD\nconfig = {'spline_kind':'linear', 'MAX_ITERATION':100}\nemd = EMD(**config)\nimfs = emd(S, max_imf=10)\nprint('imfs = ' + f'{imfs.shape[0]:4d}')","96d44b0c":"# Extract instantaneous phases and frequencies using Hilbert transform\ninstant_phases = instant_phase(imfs)\ninstant_freqs = np.diff(instant_phases)\/(2*np.pi*dt)","ac18b2b8":"# Create a figure consisting of 3 panels which from the top are the input \n# signal, IMFs and instantaneous frequencies\nfig, axes = plt.subplots(3, figsize=(12, 12))\n\n# The top panel shows the input signal\nax = axes[0]\nax.plot(t, S)\nax.set_ylabel(\"Amplitude [arbitrary units]\")\nax.set_title(\"Input signal\")\n\n# The middle panel shows all IMFs\nax = axes[1]\nfor num, imf in enumerate(imfs):\n    ax.plot(t, imf, label='IMF %s' %( num + 1 ))\n\n# Label the figure\n#ax.legend()\nax.set_ylabel(\"Amplitude [arb. u.]\")\nax.set_title(\"IMFs\")\n\n# The bottom panel shows all instantaneous frequencies\nax = axes[2]\nfor num, instant_freq in enumerate(instant_freqs):\n    ax.plot(t[:-1], instant_freq, label='IMF %s'%(num+1))\n\n# Label the figure\n#ax.legend()\nax.set_xlabel(\"Time [s]\")\nax.set_ylabel(\"Inst. Freq. [Hz]\")\nax.set_title(\"Huang-Hilbert Transform\")\n\nplt.tight_layout()\nplt.savefig('Signal-01-Amplitudes', dpi=120)\nplt.show()\n","a0a482ae":"# Plot results\nnIMFs = imfs.shape[0]\nplt.figure(figsize=(24,24))\nplt.subplot(nIMFs+1, 1, 1)\nplt.plot(S, 'r')\n\nfor n in range(nIMFs):\n    plt.subplot(nIMFs+1, 1, n+2)\n    plt.plot(imfs[n], 'g')\n    plt.ylabel(\"IMF %i\" %(n+1))\n    plt.locator_params(axis='y', nbins=5)\n\nplt.xlabel(\"Time [s]\")\n#plt.tight_layout()\nplt.savefig('Signal-01', dpi=120)\nplt.show()","dd6bd172":"# The top panel shows the input signal\nax = axes[0]\nax.plot(S)\nax.set_ylabel(\"Amplitude [arbitrary units]\")\nax.set_title(\"Input signal\")\nplt.show()","ec1378b2":"plt.plot(S)\nplt.show()","8f37e1c4":"I've configured the EMD class with the parameters seen below to save some computing time. ","63930786":"# **Introduction**\nI'm going to depart from the usual procedure of extracting statistical measures of the signal and then creating features from them. Instead, I'm going to apply a method called **Empirical Mode Decomposition** also known as the **Hilbert-Huang Transform**. This is a method which has been already applied to geophysical signals (insert reference here) and that is chiefly applied to non-linear, non-stationary signals. Seismic signals usually fall on this category.\n\n## **Empirical Mode Decomposition**\nThe Empirical Mode Decomposition (EMD) method is way of analyzing a non-linear, non-stationary signal by decomposing it into a series of zero-mean, oscillating components known as **intrinsic mode functions** (IMFs). The instantaneous frequency of these components is then obtained by applying the Hilbert transform to get a physically meaningful characterization of the signal. \nThe EMD method was introduced in 1998 by Norden Huang and collaborators as a method of analyzing various geophysical signals obtained in the course of their investigations.\n\n## **Library PyEMD**\nThe library used to compute the EMD of the 16 earthquake signals was the excellent PyEMD (*Dawid Laszuk (2017-), Python implementation of Empirical Mode Decomposition algorithm. http:\/\/www.laszukdawid.com\/codes.*). This library is the Python implementation of a previously implemented MATLAB code. Thanks very much to Dawid Laszuk for making this available.\n\n## **Approach**\nThe tactic I'm taking is to compute the first 20 IMFs of each signal, compute the usual statistical subjects, and then use these as features for each signal. Let's see what happens."}}