{"cell_type":{"8d0a870b":"code","2af47993":"code","290f14d5":"code","a891c180":"code","0cf261db":"code","83448bef":"code","9f2012f0":"code","648d4272":"code","ac385e19":"code","047d97e0":"code","db1cadf2":"code","c39e0037":"code","26708543":"markdown","972eb5e1":"markdown","00838066":"markdown","1aad4ccb":"markdown","ee0c2447":"markdown","d8d5af8e":"markdown","4638f6cd":"markdown"},"source":{"8d0a870b":"import numpy as np\nimport pandas as pd \nimport random as rand\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom matplotlib.pyplot import figure\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import mean_squared_error \nfrom IPython.display import display_html ","2af47993":"#Import training and testing data\ndf = pd.read_csv(\"..\/input\/titanic\/train.csv\", index_col=\"PassengerId\")","290f14d5":"#Cabin letter\ndf['Cabin_let'] = df['Cabin'].str[0]\n\n#Family size\ndf['Fam_size'] = [(df.Parch.iloc[i] + df.SibSp.iloc[i]) \n                          if ((df.Parch.iloc[i] + df.SibSp.iloc[i]) <= 4) \n                          else \"5+\" \n                          for i in range(0, len(df.Parch))]\n\ndf['Fam_size_bin'] = [\"Large\" if x > 4 else \"Alone\" if x == 0 else \"Small\" for x in (df.Parch + df.SibSp)]\n\n#Title\ndf['Title']=df.Name.str.extract('([A-Za-z]+)\\.')\ndf['Title_group'] = [\"Mr\" if x in [\"Mr\", \"Master\", \"Don\", \"Rev\", \"Dr\", \"Major\", \"Sir\", \"Col\", \"Capt\", \"Jonkheer\"] \n                     else \"Mrs\" if x in [\"Mrs\", \"Miss\", \"Mme\", \"Ms\", \"Lady\", \"Mlle\", \"Countess\"] \n                     else \"None\" for x in df.Title]\n\n\n#Embarked\/Class\ndf['Embark_class'] = df[\"Embarked\"] + \"_\" + df[\"Pclass\"].astype(str)\n\n#Sex\/Class\ndf['Sex_class'] = df['Sex'] + \"_\" + df[\"Pclass\"].astype(str)\n\n#Log Fare\ndf[\"log_Fare\"] = np.log(df.Fare + 1);","a891c180":"cat_cols = [cname for cname in df.columns if df[cname].dtype == \"object\"]\nnum_cols = [cname for cname in df.columns if df[cname].dtype in ['int64', 'float64']]","0cf261db":"df.head()","83448bef":"#Describe training data\ndf_cat = (df[cat_cols].describe()).T.sort_index()\ndf_num = (df[num_cols].describe()).T.sort_index()\n\ndf1_style = df_cat.style.set_table_attributes(\"style='display:inline'\").set_caption('Categorical Variables')\ndf2_style = df_num.style.set_table_attributes(\"style='display:inline'\").set_caption('Numerical Variables')\n\ndisplay_html(df1_style._repr_html_() + \"\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0\" + df2_style._repr_html_(), raw=True)","9f2012f0":"figure(figsize=(12, 12))\n\n#Does Pclass impact survival?\nplt.subplot(2,2,1)\np1_data = df.groupby('Pclass').Survived.mean()\np1 = sns.barplot(y=p1_data.values,\n                 x=p1_data.index, \n                 palette=[\"lightgrey\",\"grey\",\"black\"])\np1.set(ylabel='Survival Rate', \n       xlabel=' Pclass');\n\n#Does Embarked impact survival?\nplt.subplot(2,2,2)\np2_data = df.groupby('Embarked').Survived.mean()\np2 = sns.barplot(y=p2_data.values,\n                 x=p2_data.index, \n                 palette=[\"hotpink\",\"mediumorchid\",\"dodgerblue\"])\np2.set(ylabel='', \n       xlabel='Embarked');\n\n#Does Embark_class impact survival?\nplt.subplot(2,2,3)\np3_data = df.groupby('Embark_class').Survived.mean()\np3 = sns.barplot(y=p3_data.values,\n                 x=p3_data.index,\n                 palette=[\"pink\",\"hotpink\",\"deeppink\",\n                          \"violet\",\"mediumorchid\",\"darkviolet\",\n                          \"skyblue\",\"dodgerblue\",\"royalblue\"])\np3.set(ylabel='', \n       xlabel='Embarked_Pclass')\np3.axhline(p2_data[0], \n           xmin=0, xmax=1\/3, \n           color=\"hotpink\")\np3.axhline(p2_data[1], \n           xmin=1\/3, xmax=2\/3, \n           color=\"mediumorchid\")\np3.axhline(p2_data[2], \n           xmin=2\/3, xmax=1, \n           color=\"dodgerblue\");\n\n#Does Embark_class impact survival?\nplt.subplot(2,2,4)\np4_data = df.groupby('Embark_class').Survived.mean()\np4 = sns.barplot(y=p4_data.values,\n                 x=p4_data.index,\n                 palette=[\"pink\",\"skyblue\",\"violet\",\n                          \"hotpink\",\"dodgerblue\",\"mediumorchid\",\n                          \"deeppink\",\"royalblue\",\"darkviolet\"],\n                 order=[\"C_1\",\"S_1\",\"Q_1\",\n                        \"C_2\",\"S_2\",\"Q_2\",\n                        \"C_3\",\"S_3\",\"Q_3\"])\np4.set(ylabel='', \n       xlabel='Embarked_Pclass')\np4.axhline(p1_data[1], \n           xmin=0, xmax=1\/3, \n           color=\"lightgrey\")\np4.axhline(p1_data[2], \n           xmin=1\/3, xmax=2\/3, \n           color=\"grey\")\np4.axhline(p1_data[3], \n           xmin=2\/3, xmax=1, \n           color=\"black\");","648d4272":"figure(figsize=(12, 12))\n\n#Does SibSp (# Siblings\/Spouses) impact survival?\nplt.subplot(2,2,1)\np1_data = df.groupby('SibSp').Survived.mean()\np1 = sns.barplot(y=p1_data.values,\n                 x=p1_data.index,\n                 color=\"grey\")\np1.set(ylabel='Survival Rate', \n       xlabel='SibSp');\n\n#Does Parch (# Parents\/Children) impact survival?\nplt.subplot(2,2,2)\np2_data = df.groupby('Parch').Survived.mean()\np2 = sns.barplot(y=p2_data.values,\n                 x=p2_data.index,\n                 color=\"grey\")\np2.set(ylabel='Survival Rate', \n       xlabel='Parch');\n\n#Does Fam_size impact survival?\nplt.subplot(2,2,3)\np3_data = df.groupby('Fam_size').Survived.mean()\np3 = sns.barplot(y=p3_data.values,\n                 x=p3_data.index,\n                 color=\"grey\")\np3.set(ylabel='Survival Rate', \n      xlabel='Family Size');\n\n#Does Fam_size_bin impact survival?\nplt.subplot(2,2,4)\np4_data = df.groupby('Fam_size_bin').Survived.mean()\np4 = sns.barplot(y=p4_data.values,\n                 x=p4_data.index,\n                 color=\"grey\",\n                 order=[\"Alone\",\"Small\",\"Large\"])\np4.set(ylabel='Survival Rate', \n       xlabel='Family Size Bin');","ac385e19":"figure(figsize=(12, 12))\n\n#Does Title impact survival?\nplt.subplot(2,1,1)\np1_data = df.groupby('Title').Survived.mean()\np1 = sns.barplot(y=p1_data.values,\n                x=p1_data.index,\n                color=\"grey\")\np1.set(ylabel='Survival Rate', \n      xlabel='Title');\n\n#Does Title_group impact survival?\nplt.subplot(2,1,2)\np2_data = df.groupby('Title_group').Survived.mean()\np2 = sns.barplot(y=p2_data.values,\n                x=p2_data.index,\n                color=\"grey\")\np2.set(ylabel='Survival Rate', \n      xlabel='Title Group');","047d97e0":"figure(figsize=(12, 12))\n#Check distribution of Fare\nplt.subplot(2,2,1)\np1 = sns.kdeplot(df[\"Fare\"],\n                 shade=True);\n\n#Check distribution of log_Fare\nplt.subplot(2,2,2)\np2 = sns.kdeplot(df[\"log_Fare\"], \n                 shade=True);\n\n#Does Fare affect survival?\nplt.subplot(2,2,3)\np3 = sns.swarmplot(x = \"Survived\", \n                   y = \"Fare\", \n                   data = df);\n\n#Does log_Fare affect survival?\nplt.subplot(2,2,4)\np4 = sns.swarmplot(x = \"Survived\", \n                   y = \"log_Fare\", \n                   data = df);","db1cadf2":"figure(figsize=(12, 12))\n\n#Is there a difference in the average price by class?\nplt.subplot(2,2,1)\nsns.swarmplot(x=\"Pclass\", \n              y=\"Fare\", \n              data=df,\n              palette=[\"lightgrey\", \"grey\", \"black\"]);\n\nplt.subplot(2,2,2)\nsns.swarmplot(x=\"Pclass\", \n              y=\"log_Fare\", \n              data=df,\n              palette=[\"lightgrey\", \"grey\", \"black\"]);\n\n#Is there a difference in the average price by class and sex?\nplt.subplot(2,2,3)\nsns.swarmplot(x=\"Sex_class\", \n              y=\"Fare\", \n              data=df,\n              order=[\"male_1\",\"female_1\",\n                     \"male_2\",\"female_2\",\n                     \"male_3\",\"female_3\"],\n              palette=[\"skyblue\",\"pink\",\n                       \"dodgerblue\",\"hotpink\",\n                       \"royalblue\",\"deeppink\"]);\n\nplt.subplot(2,2,4)\nsns.swarmplot(x = \"Sex_class\", \n              y = \"log_Fare\", \n              data = df,\n              order=[\"male_1\",\"female_1\",\n                     \"male_2\",\"female_2\",\n                     \"male_3\",\"female_3\"],\n              palette=[\"skyblue\",\"pink\",\n                       \"dodgerblue\",\"hotpink\",\n                       \"royalblue\",\"deeppink\"]);","c39e0037":"figure(figsize=(16, 6))\n\n#Does Age affect survival?\nplt.subplot(1,3,1)\np1=sns.swarmplot(x=\"Survived\", \n                 y=\"Age\",\n                 data=df);\n\n#Does Age\/Sex affect survival?\nplt.subplot(1,3,2)\np2=sns.swarmplot(x = \"Survived\", \n                 y = \"Age\",\n                 hue=\"Sex\",\n                 palette=[\"dodgerblue\",\"hotpink\"],\n                 data = df);\n\n#Does Age\/Class affect survival?\nplt.subplot(1,3,3)\np2=sns.swarmplot(x = \"Survived\", \n                 y = \"Age\",\n                 hue=\"Pclass\",\n                 palette=[\"lightgrey\",\"grey\",\"black\"],\n                 data = df);","26708543":"## PClass\/Embarked","972eb5e1":"## Fare","00838066":"## Age","1aad4ccb":"## Feature Engineering","ee0c2447":"Models are built for this dataset here: \n\nhttps:\/\/www.kaggle.com\/db102291\/titanic-competition-ensemble-learning\nhttps:\/\/www.kaggle.com\/db102291\/titanic-xgboost-pipeline","d8d5af8e":"## Title","4638f6cd":"## Family Size"}}