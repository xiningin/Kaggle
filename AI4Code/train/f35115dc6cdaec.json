{"cell_type":{"a84741b0":"code","95388d90":"code","1ba9b607":"code","d2656ca1":"code","f42dd059":"code","c8bbcdb0":"code","9b363da1":"code","7738462e":"code","8a63159d":"markdown","0883f958":"markdown","c163a599":"markdown","0dc500ec":"markdown","b85640eb":"markdown","a6ff54be":"markdown"},"source":{"a84741b0":"!pip install seaborn==0.11\nimport seaborn as sns","95388d90":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\n\n\nfrom matplotlib.offsetbox import AnchoredText\nfrom mpl_toolkits.axes_grid1 import make_axes_locatable\n","1ba9b607":"train = pd.read_csv('\/kaggle\/input\/tabular-playground-series-feb-2021\/train.csv')\ntest = pd.read_csv('\/kaggle\/input\/tabular-playground-series-feb-2021\/test.csv')\n\ntrain.describe()","d2656ca1":"fig, ax = plt.subplots(3, 4, figsize=(15, 12))\nfig.set_facecolor('#d0d0d0') \n\nfor i in range(10):\n    # count \n    cnt_tmp = train[f'cat{i}'].value_counts().sort_index()\n    ax[i%3][i\/\/3].bar(cnt_tmp.index, cnt_tmp, color='#244747', label='Count')\n    ax[i%3][i\/\/3].set_yticks([])\n    ax[i%3][i\/\/3].margins(0.05, 0.2)\n    \n    # target\n    target_tmp = train.groupby(f'cat{i}').mean()['target']\n    ax2=ax[i%3][i\/\/3].twinx()\n    ax2.set_yticks([])\n    ax2.bar(target_tmp.index, target_tmp, color='#d4dddd', alpha=0.7, label='Mean of Target')\n    ax2.set_ylim(7, 8.4)\n    \n    divider = make_axes_locatable(ax[i%3][i\/\/3])\n    cax = divider.append_axes(\"top\", size=\"8%\", pad=0)\n    cax.get_xaxis().set_visible(False)\n    cax.get_yaxis().set_visible(False)\n    cax.set_facecolor('black')\n\n    at = AnchoredText(f'cat{i}', loc=10, \n                      prop=dict(backgroundcolor='black',\n                                size=10, color='white', weight='bold'))\n    cax.add_artist(at)\n    \nax[1][3].set_visible(False)\nax[2][3].set_visible(False)\n\nfig.text(0.018, 1.03, 'Categorical Feature Distribution', fontsize=20, fontweight='bold', fontfamily='serif')\nfig.text(0.018, 1, 'Gray is mean of target', fontsize=15, fontweight='light', fontfamily='serif')\n\n\n\nplt.tight_layout()\nplt.show()","f42dd059":"fig = plt.figure(figsize=(30, 30))\ngs = fig.add_gridspec(sum([len(train[f'cat{i}'].unique()) for i in range(1, 10)]), \n                     sum([len(train[f'cat{i}'].unique()) for i in range(10)]))\n\nidx = np.cumsum([0] + [len(train[f'cat{i}'].unique()) for i in range(10)])\n\n         \nfor i in range(10):\n    for j in range(10):\n        if i <= j : \n            continue\n        pivot_tmp = pd.pivot_table(train, values='target', index=[f'cat{i}'], columns=[f'cat{j}'], aggfunc=np.mean, fill_value=0)\n        ax = fig.add_subplot(gs[idx[i]-2:idx[i+1]-2, idx[j]:idx[j+1]])\n        \n        sns.heatmap(pivot_tmp, \n                    square=True, \n                    center=7.456, # mean of target\n                    cbar=False, \n                    cmap=sns.diverging_palette(240, 10),\n                    xticklabels=(i==9), yticklabels=(j==0),\n                    ax=ax)\n\n        if j : ax.set_ylabel('')    \n        if i<9 : ax.set_xlabel('')\n\nfig.text(0.125, 0.89, 'Categorical Feature Relation Heatmap', fontsize=20, fontweight='bold', fontfamily='serif')            \n\nplt.show()","c8bbcdb0":"fig, ax = plt.subplots(3, 5, figsize=(17, 12), sharex=True)\nfig.set_facecolor('#d0d0d0') \n\nfor i in range(14): \n    sns.kdeplot(data=train, x=f'cont{i}', \n                fill=True,\n                linewidth=0,\n                color='#244747', alpha=1,\n                ax=ax[i%3][i\/\/3])\n    ax[i%3][i\/\/3].set_yticks([])\n    ax[i%3][i\/\/3].set_xlabel('',visible=False)\n    ax[i%3][i\/\/3].margins(0.05, 0.2)\n    \n    # dviider\n    divider = make_axes_locatable(ax[i%3][i\/\/3])\n    cax = divider.append_axes(\"top\", size=\"8%\", pad=0)\n    cax.get_xaxis().set_visible(False)\n    cax.get_yaxis().set_visible(False)\n    cax.set_facecolor('black')\n\n    at = AnchoredText(f'cont{i}', loc=10, \n                      prop=dict(backgroundcolor='black',\n                                size=10, color='white', weight='bold'))\n    cax.add_artist(at)\n    \nax[-1][-1].set_visible(False)\nfig.text(0.018, 1.03, 'Continuous Feature Density Plot', fontsize=20, fontweight='bold', fontfamily='serif')\n\nplt.tight_layout()\nplt.show()","9b363da1":"fig, ax = plt.subplots(1, 1, figsize=(10, 10))\nfig.set_facecolor('#d0d0d0') \ncorr = train.drop('id', axis=1).corr()\nmask = np.triu(np.ones_like(corr, dtype=bool))\n\nsns.heatmap(corr, \n            square=True, \n            linewidth=0.2,\n            cbar=False,\n            mask=mask,\n            annot=True,\n            center=0,\n            cmap=sns.diverging_palette(240, 10),\n            ax=ax)\n\nfig.text(0.075, 1, 'Correlation: Continuous Feature & Target', fontweight='bold', fontfamily='serif', fontsize=15) \nax.set_xticklabels(ax.get_xticklabels(), fontfamily='serif', rotation=90, fontsize=11)\nax.set_yticklabels(ax.get_yticklabels(), fontfamily='serif', rotation = 0, fontsize=11)\nplt.tight_layout()\nplt.show()","7738462e":"sns.pairplot(train.iloc[:,11:].sample(10000), kind=\"hist\", corner=True)","8a63159d":"## EDA & Visualization\n\n> Still WIP(Work in Progress)","0883f958":"## Categorical Value Relation Heatmap\n\n\nsome combination between `cat6`~`cat9` have **absolutly** lower value(mean of target).","c163a599":"## Continuous \n\n\n\nObviously, continuous variables also have a bias according to their central distribution.\n\nFor visualization, sample and visualize some.","0dc500ec":"For relation, check i use `pariplot`\n\nSampling is nice choices for Large data","b85640eb":"## Categorical Feature\n\nOne point of this competition is to encode the categorical value again, unlike the previous competition.","a6ff54be":"## Import Library & Dataset"}}