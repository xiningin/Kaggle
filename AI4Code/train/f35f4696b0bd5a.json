{"cell_type":{"1145f564":"code","29db634f":"code","acfdca0d":"code","eff5f00c":"code","89606aa8":"code","844462d6":"code","accff999":"code","cfd6d253":"code","968c94f5":"code","ae732bd3":"code","acc700bf":"code","306faa96":"code","4dd7a1f7":"code","7f7ef5f9":"code","6d242996":"code","3bc5da99":"code","747f002d":"code","69e2d117":"code","b416e511":"code","acca3647":"code","3c823a4a":"code","0bfd867e":"code","a4bab21f":"code","7907353a":"code","0290fc90":"code","97074bc0":"code","d578f98f":"code","45339b90":"code","94e83b5f":"code","64f66cbf":"code","55ced593":"code","25d7d8d9":"code","826efbb4":"code","3918dc9e":"code","f8720ee4":"code","cb0103c5":"code","a6702eaa":"code","9978d553":"code","042a6453":"code","510aa19d":"code","87f31533":"code","ead67ab8":"code","0641b19b":"code","a7581fd1":"code","5f976847":"code","e662bdc8":"code","435d0eaf":"code","0dcae1a8":"code","75d532d7":"code","e7de53f1":"markdown","64a9b841":"markdown","0ae98b1f":"markdown","e0859712":"markdown","86362249":"markdown","0ccbf60c":"markdown","9a971695":"markdown","d3a1ed48":"markdown","efbc2186":"markdown","5902504e":"markdown","6766d3fe":"markdown","7f17e1a1":"markdown","d2047f24":"markdown","c72c8e26":"markdown","a631c115":"markdown"},"source":{"1145f564":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.express as px\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","29db634f":"df=pd.read_csv(\"\/kaggle\/input\/usa-housing-listings\/housing.csv\")\ndf.head()","acfdca0d":"df.info()","eff5f00c":"df.isnull().sum()*100\/len(df)","89606aa8":"df[\"laundry_options\"]=df[\"laundry_options\"].fillna(df[\"laundry_options\"].mode()[0])\ndf[\"parking_options\"]=df[\"parking_options\"].fillna(df[\"parking_options\"].mode()[0])","844462d6":"df.fillna(0, inplace=True)","accff999":"df.drop(columns=[\"id\", \"url\", \"region_url\", \"image_url\", \n                 \"description\"],axis=1,inplace=True)","cfd6d253":"df.describe().T","968c94f5":"df=df[df[\"price\"]>100]\ndf=df[df[\"sqfeet\"]>=120]","ae732bd3":"sns.boxplot(x=\"price\", data=df)","acc700bf":"df=df[df[\"price\"]<5000]\nsns.boxplot(x=\"price\", data=df)","306faa96":"sns.boxplot(x=\"sqfeet\", data=df)","4dd7a1f7":"df=df[df[\"sqfeet\"]<4000]\nsns.boxplot(x=\"sqfeet\", data=df)","7f7ef5f9":"sns.distplot(df[\"price\"])","6d242996":"sns.distplot(df[\"sqfeet\"])","3bc5da99":"df_val_count=['region', 'type', 'beds', 'baths',  'laundry_options',\n       'parking_options', 'state']\nfor i in df_val_count:\n    print(df[i].value_counts())","747f002d":"df=df[df[\"beds\"]<=4]\ndf=df[df[\"baths\"]<7.5]","69e2d117":"one_or_zero=[\"cats_allowed\", \"dogs_allowed\", \"smoking_allowed\",\n            \"wheelchair_access\", \"electric_vehicle_charge\", \n            \"comes_furnished\"]\n\nfor i in one_or_zero:\n    a=df[i].value_counts().reset_index()\n    fig=px.bar(a, x=\"index\", y=i, color=i)\n    fig.show()","b416e511":"plt.figure(figsize=(12,8))\nsns.boxplot(data=df, x=\"beds\", y=\"price\")","acca3647":"plt.figure(figsize=(12,8))\nsns.boxplot(data=df, x=\"laundry_options\", y=\"price\")","3c823a4a":"plt.figure(figsize=(12,8))\nsns.boxplot(data=df, x=\"parking_options\", y=\"price\")","0bfd867e":"plt.figure(figsize=(12,8))\nsns.boxplot(data=df, x=\"baths\", y=\"price\")","a4bab21f":"plt.figure(figsize=(12,8))\nsns.scatterplot(data=df, x=\"sqfeet\", y=\"price\")","7907353a":"fig=px.density_mapbox(df, lat=\"lat\", lon=\"long\",\n                     z=\"price\", center=dict(lat=38.4883, lon=-88.1746),\n                     zoom=0,\n                     mapbox_style=\"open-street-map\")\nfig.show()","0290fc90":"from sklearn.preprocessing import LabelEncoder\nle=LabelEncoder()\ndf[\"state\"]=le.fit_transform(df[\"state\"])\ndf[\"region\"]=le.fit_transform(df[\"region\"])\ndf[\"laundry_options\"]=le.fit_transform(df[\"laundry_options\"])\ndf[\"parking_options\"]=le.fit_transform(df[\"parking_options\"])\ndf[\"type\"]=le.fit_transform(df[\"type\"])","97074bc0":"correlation=df.corr()[\"price\"].reset_index().sort_values(\"price\",ascending=False)\nfig=px.bar(correlation, x=\"index\", y=\"price\")\nfig.show()","d578f98f":"df.drop(\"region\", axis=1, inplace=True)","45339b90":"plt.figure(figsize=(18,18))\nsns.heatmap(df.corr(), annot=True)","94e83b5f":"y=df[\"price\"]\nx=df.drop(\"price\", axis=1)","64f66cbf":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(x,y, test_size = 0.3, random_state = 0)","55ced593":"from sklearn import metrics\nfrom sklearn.linear_model import LinearRegression\nlr=LinearRegression()\nlr.fit(X_train, y_train)\ny_pred=lr.predict(X_test)\nlr_r2=metrics.r2_score(y_test, y_pred)\nlr_MSE=metrics.mean_squared_error(y_test, y_pred)\nlr_RMSE=np.sqrt(metrics.mean_squared_error(y_test, y_pred))","25d7d8d9":"print(\"R^2 Score:\", lr_r2)\nprint(\"MSE Score:\", lr_MSE)\nprint(\"RMSE Score:\", lr_RMSE)","826efbb4":"pred_graph_lr=pd.DataFrame({\"True Values\":y_test, \"Predicted Values\":y_pred})\npred_graph_lr","3918dc9e":"fig=px.scatter(pred_graph_lr, x=\"True Values\", y=\"Predicted Values\")\nfig.show()","f8720ee4":"from xgboost import XGBRegressor\nxgb=XGBRegressor()\nxgb.fit(X_train, y_train)\ny_pred=xgb.predict(X_test)\nxgb_r2=metrics.r2_score(y_test, y_pred)\nxgb_MSE=metrics.mean_squared_error(y_test, y_pred)\nxgb_RMSE=np.sqrt(metrics.mean_squared_error(y_test, y_pred))","cb0103c5":"print(\"R^2 Score:\", xgb_r2)\nprint(\"MSE Score:\", xgb_MSE)\nprint(\"RMSE Score:\", xgb_RMSE)","a6702eaa":"pred_graph_xgb=pd.DataFrame({\"True Values\":y_test, \"Predicted Values\":y_pred})\npred_graph_xgb","9978d553":"fig=px.scatter(pred_graph_xgb, x=\"True Values\", y=\"Predicted Values\")\nfig.show()","042a6453":"from sklearn.ensemble import GradientBoostingRegressor\ngbr=GradientBoostingRegressor(n_estimators=100)\ngbr.fit(X_train,y_train)\ny_pred= gbr.predict(X_test)\ngbr_r2=metrics.r2_score(y_test, y_pred)\ngbr_MSE=metrics.mean_squared_error(y_test, y_pred)\ngbr_RMSE=np.sqrt(metrics.mean_squared_error(y_test, y_pred))","510aa19d":"print(\"R^2 Score:\", gbr_r2)\nprint(\"MSE Score:\", gbr_MSE)\nprint(\"RMSE Score:\", gbr_RMSE)","87f31533":"pred_graph_gbr=pd.DataFrame({\"True Values\":y_test, \"Predicted Values\":y_pred})\npred_graph_gbr","ead67ab8":"fig=px.scatter(pred_graph_gbr, x=\"True Values\", y=\"Predicted Values\")\nfig.show()","0641b19b":"from sklearn.ensemble import RandomForestRegressor\nran=RandomForestRegressor()\nran.fit(X_train, y_train)\ny_pred= ran.predict(X_test)\nran_r2=metrics.r2_score(y_test, y_pred)\nran_MSE=metrics.mean_squared_error(y_test, y_pred)\nran_RMSE=np.sqrt(metrics.mean_squared_error(y_test, y_pred))","a7581fd1":"print(\"R^2 Score:\", ran_r2)\nprint(\"MSE Score:\", ran_MSE)\nprint(\"RMSE Score:\", ran_RMSE)","5f976847":"pred_graph_ran=pd.DataFrame({\"True Values\":y_test, \"Predicted Values\":y_pred})\npred_graph_ran","e662bdc8":"fig=px.scatter(pred_graph_ran, x=\"True Values\", y=\"Predicted Values\")\nfig.show()","435d0eaf":"models={\"LR\":[lr_r2, lr_MSE , lr_RMSE],\n       \"XGB\":[xgb_r2, xgb_MSE, xgb_RMSE],\n       \"GBR\":[gbr_r2, gbr_MSE , gbr_RMSE],\n       \"RAN\":[ran_r2, ran_MSE , ran_RMSE],}\nmodels=pd.DataFrame(models)\nmodels=models.rename(index={0:\"R^2\", 1:\"MSE\", 2:\"RMSE\"})","0dcae1a8":"models","75d532d7":"fig , axes= plt.subplots(2, 2, figsize=(12,12))\n\nsns.scatterplot(ax=axes[0,0], data=pred_graph_lr, x=\"True Values\", \n                y=\"Predicted Values\").set_title(\"LR\")\n\nsns.scatterplot(ax=axes[0,1], data=pred_graph_xgb, x=\"True Values\",\n                y=\"Predicted Values\").set_title(\"XGB\")\n\nsns.scatterplot(ax=axes[1,0], data=pred_graph_gbr, x=\"True Values\",\n                y=\"Predicted Values\").set_title(\"GBR\")\n\nsns.scatterplot(ax=axes[1,1], data=pred_graph_ran, x=\"True Values\",\n                y=\"Predicted Values\").set_title(\"RAN\")\n","e7de53f1":"### Models","64a9b841":"### Model Comparison","0ae98b1f":"**Region and state are almost same columns. That's why i'll drop region which has low corr.**","e0859712":"#### Linear Regression","86362249":"### Knowing the Data and Cleaning","0ccbf60c":"#### Random Forest Regressor","9a971695":"**We see that the values are very scattered. For the regression model to work better, we need to clear the clutter.**","d3a1ed48":"**Dropping the columns which are not necessary**","efbc2186":"#### GradientBoostingRegressor","5902504e":"**We are again faced with the same situation that we have just encountered.**","6766d3fe":"**Price and sqfeet has lots of 0 values. We need to fix it.**","7f17e1a1":"### Visualizations","d2047f24":"**Dealing with nan values**","c72c8e26":"**According this graph, we can say that sqfeet and price have correlation but not strong enough.**","a631c115":"#### XGBRegressor"}}