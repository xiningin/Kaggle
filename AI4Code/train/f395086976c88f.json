{"cell_type":{"08df2808":"code","140e5d30":"code","7a0fbf59":"code","99dc143a":"code","472628ce":"code","5f5d73c9":"code","5501a2ce":"code","ac2c136e":"code","73a93089":"markdown","0235a3a1":"markdown","ab5f80ab":"markdown","969a0d66":"markdown","51c44f4d":"markdown"},"source":{"08df2808":"import pandas as pd\nimport numpy as np","140e5d30":"train_df = pd.read_csv('..\/input\/train.csv')","7a0fbf59":"n_all = train_df.shape[0]\nn_new_whale = train_df[train_df['Id'] == 'new_whale'].shape[0]\nprint(\"We have {}\/{} ({:.2f}%) `new_whale` in the training set.\".format(n_new_whale, n_all, n_new_whale\/n_all*100))","99dc143a":"res = []\nfor i in range(10):\n    tmp_df = train_df.sample(frac=.2)\n    n_all = tmp_df.shape[0]\n    n_new_whale = tmp_df[tmp_df['Id'] == 'new_whale'].shape[0]\n    res.append(n_new_whale\/n_all)\n    print(\"We have {}\/{} ({:.2f}%) `new_whale` in the random subset #{}.\".format(n_new_whale, n_all, n_new_whale\/n_all*100, i))\n    \nprint(\"Average: {:.4f}, std: {:.4f}\".format(np.mean(res), np.std(res)))","472628ce":"test_df = pd.read_csv('..\/input\/sample_submission.csv')\ntest_df.head()","5f5d73c9":"test_df['Id'] = 'new_whale'\ntest_df.head()","5501a2ce":"n_all = test_df.shape[0]\n# After submission (public LB score: 0.276)\nn_new_whale = 2197\nprint(\"We have {}\/{} ({:.2f}%) `new_whale` in the test set.\".format(n_new_whale, n_all, n_new_whale\/n_all*100))","ac2c136e":"test_df.to_csv('new_whale_benchmark.csv', index=False)","73a93089":"I got `0.276` LB score when I submitted the `new_whale` predictions. For every image I either got `P(1) = 0` or `1` score, see [my MAP@5 explanation kernel](https:\/\/www.kaggle.com\/pestipeti\/explanation-of-map5-scoring-metric) for more details.","0235a3a1":"**Thanks for reading.**","ab5f80ab":"Let's see if we get similar distribution if we use a random fraction of the data.","969a0d66":"# Benchmark\nThis is a very simple benchmark to find out how many `new_whales` are in the test set.","51c44f4d":"*I assume a similar 'new_whale' distribution between the public (20%) and the private (80%) set.*"}}