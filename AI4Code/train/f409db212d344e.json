{"cell_type":{"839af291":"code","86087d0b":"code","9fe770ee":"code","848d761d":"code","67f23507":"code","431bef99":"code","0afbe261":"code","56d6c907":"code","4854bcb6":"code","24d46841":"code","be891b11":"code","2ec7858b":"code","75af9727":"code","555692d0":"code","12f89090":"code","dcd893d3":"code","dd7e319b":"code","46baa35e":"code","a912d3f1":"code","be8b0f29":"code","857ef14a":"markdown","917ee521":"markdown","6091a64a":"markdown"},"source":{"839af291":"from fastai.vision import *\nfrom fastai.metrics import accuracy","86087d0b":"# Copy for FastAI\n!mkdir -p data\n!cp -R ..\/input\/dsnet-kaggledays-hackathon\/train\/train data\/train\n!cp -R ..\/input\/dsnet-kaggledays-hackathon\/test\/test data\/test\n!cp ..\/input\/dsnet-kaggledays-hackathon\/sample_submission.csv data\/sample_submission.csv","9fe770ee":"DATA_DIR = Path('data')","848d761d":"bs = 64","67f23507":"data = ImageDataBunch.from_folder(DATA_DIR, valid_pct=0.2, ds_tfms=get_transforms(), bs=bs, size=224)","431bef99":"data.show_batch(rows=3, figsize=(7,6))","0afbe261":"learn = cnn_learner(data, models.resnet18, pretrained=False, metrics=accuracy)","56d6c907":"learn.model","4854bcb6":"learn.lr_find()","24d46841":"learn.recorder.plot()","be891b11":"learn.fit_one_cycle(4, 3e-3)","2ec7858b":"# Save the model\nlearn.save('simple-model')","75af9727":"# Load the model\nlearn.load('simple-model');","555692d0":"# Load submission file\nsample_df = pd.read_csv(DATA_DIR\/'sample_submission.csv')\nsample_df.head()","12f89090":"# Generate test predictions\nlearn.data.add_test(ImageList.from_df(sample_df,DATA_DIR,folder='test'))","dcd893d3":"# Load up submission file\npreds,y = learn.get_preds(DatasetType.Test)","dd7e319b":"# Convert predictions to classes\npred_classes = [data.classes[c] for c in list(preds.argmax(dim=1).numpy())]\npred_classes[:10]","46baa35e":"# Add the prediction\nsample_df.predicted_class = pred_classes\nsample_df.head()","a912d3f1":"# Save the submission file\nsample_df.to_csv('submission.csv',index=False)\n\nfrom IPython.display import FileLink\nFileLink('submission.csv')","be8b0f29":"# Clean up (for commit)\n!cp -R data\/models models # Move the models out\n!rm -rf data # Delete the data","857ef14a":"## Inference","917ee521":"## Data","6091a64a":"## Model"}}