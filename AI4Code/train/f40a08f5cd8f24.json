{"cell_type":{"82a1bbe8":"code","96cb8988":"code","35129885":"code","5f86ec70":"code","a1df1331":"code","9ac711f9":"code","4d282920":"code","84301e6d":"code","f42bf38b":"code","4b1f460f":"code","1a2d59a6":"code","f8b26bf8":"code","e88a8f51":"code","bb214429":"code","7de8fb17":"markdown","c2bdc9ff":"markdown"},"source":{"82a1bbe8":"from sklearn.model_selection import train_test_split\nfrom keras.utils import to_categorical\nfrom keras.callbacks import ModelCheckpoint \nfrom keras.models import Sequential\nfrom keras.layers.core import Dense, Dropout, Activation, Flatten\nfrom keras.layers.normalization import BatchNormalization\nfrom keras import optimizers\nfrom keras import initializers\nimport numpy as np\nfrom matplotlib import pyplot as plt","96cb8988":"classes = ['T-shirt\/top', 'Trouser', 'Pullover', 'Dress', 'Coat', 'Sandal', 'Shirt', 'Sneaker', 'Bag', 'Ankle boot']","35129885":"folder = '\/kaggle\/input\/fashion-mnist-itba-lab-2020q2\/'\nx = np.load(folder+'train_images.npy')\ny = np.loadtxt(folder+'train_labels.csv', delimiter=',', skiprows=1)\nx_test = np.load(folder+'test_images.npy')","5f86ec70":"x_train, x_valid, y_train, y_valid = train_test_split(x, y, test_size = 0.1)","a1df1331":"y_train_categorical = to_categorical(y_train)\ny_val_categorical = to_categorical(y_valid)","9ac711f9":"alto = 4\nancho = 8\nf, axs = plt.subplots(alto, ancho, figsize=(30,4*alto))\naxs = axs.reshape(-1)\nfor i in range(alto*ancho):\n    axs[i].imshow(x_train[i], cmap='gray')\n    axs[i].set_title(f'{classes[int(y_train[i])]} - class: {int(y_train[i])}\\n{y_train_categorical[i]}')\n    axs[i].axis('off')","4d282920":"output_size = 10\nmodel_single_layer = Sequential()\nmodel_single_layer.add(Flatten(input_shape=x_train.shape[1:]))\nmodel_single_layer.add(Dense(output_size, name='Salida'))\nmodel_single_layer.add(Activation('softmax'))\nmodel_single_layer.summary()","84301e6d":"lr = 0.000001 \nSGD = optimizers.SGD(lr=lr)\nmodel_single_layer.compile(loss = 'categorical_crossentropy', optimizer=SGD, metrics=['accuracy'])","f42bf38b":"batch_size = 512\nmodel_single_layer.fit(x_train, \n                       y_train_categorical,\n                       epochs=20, batch_size=batch_size, \n                       verbose=1, \n                       validation_data = (x_valid, y_val_categorical)\n                      )","4b1f460f":"f, (ax1, ax2) = plt.subplots(1, 2, figsize=(20,6))\nax1.plot(model_single_layer.history.history['loss'], label='train')\nax1.plot(model_single_layer.history.history['val_loss'], label='val')\nax1.set_title('Loss - Cross Entropy')\nax1.legend()\nax2.plot(model_single_layer.history.history['accuracy'], label='train')\nax2.plot(model_single_layer.history.history['val_accuracy'], label='val')\nax2.set_title('Metric - Accuracy')\nax2.legend()\nplt.show()","1a2d59a6":"loss, acc = model_single_layer.evaluate(x_valid, y_val_categorical, verbose=0)\nprint(acc, loss)","f8b26bf8":"# Calculo probabilidades de cada clase para cada observaci\u00f3n\ntest_prediction = model_single_layer.predict(x_test)\nprint(test_prediction.shape)","e88a8f51":"# Calculo clase\ntest_labels = np.argmax(test_prediction, axis = 1)\nprint(test_labels)","bb214429":"import pandas\ndf = pandas.DataFrame(data={\"Category\": test_labels}).astype(int)\ndf.to_csv(\".\/submission.csv\", sep=',',index=True,  index_label='Id')","7de8fb17":"# Cargo Data","c2bdc9ff":"# Armo CSV para submitear"}}