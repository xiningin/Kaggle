{"cell_type":{"ff3a9ab1":"code","d181f59a":"code","44f8c311":"code","202857ff":"code","ee3e51fc":"code","91aca8c1":"code","77bca030":"code","9ab8d7a3":"code","c404d3db":"code","d86a79fb":"code","33628744":"code","60319b43":"code","4a91426c":"code","084afeb1":"code","1b407893":"code","4e660032":"code","b1d7bd47":"code","60aa8ace":"code","3fde3b5f":"code","19eae65a":"markdown","550e6861":"markdown","0fc8f4b5":"markdown","5febb5b2":"markdown","f2dfe870":"markdown","acc02e08":"markdown","ef39e246":"markdown","f29b792c":"markdown","1d2b152d":"markdown","c29abd86":"markdown","5f8d17df":"markdown"},"source":{"ff3a9ab1":"#importing libraries\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","d181f59a":"#reading dataset\nds = pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')\nds.head()","44f8c311":"#getting dimensions\nds.shape","202857ff":"ds.isnull().any()","ee3e51fc":"plt.figure(figsize=(14,6))\nplt.subplot(1, 2, 1)\nsns.set(style = 'whitegrid')\nsns.distplot(ds['Annual Income (k$)'])\nplt.title('Distribution of Annual Income', fontsize = 20)\nplt.xlabel('Range of Annual Income')\nplt.ylabel('Count')\n\n\nplt.subplot(1, 2, 2)\nsns.set(style = 'whitegrid')\nsns.distplot(ds['Age'], color = 'red')\nplt.title('Distribution of Age', fontsize = 20)\nplt.xlabel('Range of Age')\nplt.ylabel('Count')\nplt.show()","91aca8c1":"plt.figure(figsize=(8,5))\nsns.countplot(x = 'Gender',data = ds)","77bca030":"plt.figure(figsize=(20,8))\nsns.countplot(ds['Spending Score (1-100)'])","9ab8d7a3":"#Pairplot for the Data\nsns.pairplot(ds,hue = 'Gender')\nplt.subplots_adjust(hspace = 0.8)","c404d3db":"plt.figure(figsize=(10,8))\nsns.heatmap(ds.corr(), cmap = 'Wistia', annot = True)\nplt.title('Heatmap for the Data', fontsize = 20)\nplt.show()","d86a79fb":"sns.jointplot(x = 'Age',y = 'Spending Score (1-100)',data = ds, hue = 'Gender')","33628744":"plt.figure(figsize=(10,6))\nsns.stripplot(x = 'Gender',y = 'Spending Score (1-100)',data = ds,)","60319b43":"#defining dependent variable\nx = ds.iloc[:,[3,4]].values","4a91426c":"#ELBOW METHOD TO FIND OPTIMAL NUMBER OF CLUSTERS\nfrom sklearn.cluster import KMeans\nwcss = []\nfor i in range(1,11):\n    kmeans = KMeans(n_clusters = i, init = 'k-means++')\n    kmeans.fit(x)\n    wcss.append(kmeans.inertia_)\nplt.plot(range(1,11),wcss)","084afeb1":"#training model\nkmeans = KMeans(n_clusters = 5, init = 'k-means++')\ny_pred = kmeans.fit_predict(x)","1b407893":"#visualizing clusters\nplt.figure(figsize=(12,8))\nplt.scatter(x[y_pred == 0,0],x[y_pred == 0,1],label = 'Cluster-1', s = 100)\nplt.scatter(x[y_pred == 1,0],x[y_pred == 1,1],label = 'Cluster-2', s = 100)\nplt.scatter(x[y_pred == 2,0],x[y_pred == 2,1],label = 'Cluster-3', s = 100)\nplt.scatter(x[y_pred == 3,0],x[y_pred == 3,1],label = 'Cluster-4', s = 100)\nplt.scatter(x[y_pred == 4,0],x[y_pred == 4,1],label = 'Cluster-5', s = 100)\nplt.scatter(kmeans.cluster_centers_[:,0], kmeans.cluster_centers_[:, 1], s = 50, c = 'black' , label = 'centeroid')\nplt.legend()\nplt.xlabel('Annual Income')\nplt.ylabel('Spending Score')","4e660032":"#defining dependent variable\nx = ds.iloc[:,[3,4]].values","b1d7bd47":"#getting optimal number of clusters using dendogram\nfrom scipy.cluster.hierarchy import dendrogram, linkage\nplt.figure(figsize = (12,6))\ndendo = dendrogram(linkage(x,method = 'ward'))\nplt.title('Dendrogam', fontsize = 20)\nplt.xlabel('Customers')\nplt.ylabel('Ecuclidean Distance')\n\nplt.show()","60aa8ace":"from sklearn.cluster import AgglomerativeClustering\nac = AgglomerativeClustering(n_clusters = 5, affinity = 'euclidean', linkage = 'ward')\ny_pred = ac.fit_predict(x)","3fde3b5f":"#visualizing clusters\nplt.figure(figsize=(12,8))\nplt.scatter(x[y_pred == 0,0],x[y_pred == 0,1],label = 'Cluster-1', s = 100)\nplt.scatter(x[y_pred == 1,0],x[y_pred == 1,1],label = 'Cluster-2', s = 100)\nplt.scatter(x[y_pred == 2,0],x[y_pred == 2,1],label = 'Cluster-3', s = 100)\nplt.scatter(x[y_pred == 3,0],x[y_pred == 3,1],label = 'Cluster-4', s = 100)\nplt.scatter(x[y_pred == 4,0],x[y_pred == 4,1],label = 'Cluster-5', s = 100)\nplt.legend()\nplt.xlabel('Annual Income')\nplt.ylabel('Spending Score')","19eae65a":"**NO MISSING VALUES**","550e6861":"**VISUALIZING DATESET**","0fc8f4b5":"**2. HIERARCHICAL CLUSTERING(AGGLOMERATIVE)**\n","5febb5b2":"* people earning between 50-75 is maximum.\n* people with ages 20-40 are the most frequent mall customers.","f2dfe870":"**MALL CUSTOMERS CLUSTERING**\n\n<img src= \"https:\/\/thumbs.gfycat.com\/ChillyAshamedIrishredandwhitesetter-max-1mb.gif\"  style='width: 500px;'>","acc02e08":"NUMBER OF CLUSTERS = 5","ef39e246":"**FEMALE CUSTOMERS ARE MORE AS COMPARED TO MALE ONES**","f29b792c":"# APPLYING CLUSTERING","1d2b152d":"**NO SIGNIFICANT CORRELATION**","c29abd86":"**1. K-MEANS CLUSTERING**","5f8d17df":"**OPTIMAL CLUSTERS = 3,5**\n\n**BUT I'LL BE TAKING 5**"}}