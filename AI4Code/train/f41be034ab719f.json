{"cell_type":{"d4ed0d2a":"code","74bad2ae":"code","994f270d":"code","44693f2c":"code","a17ce1ed":"code","bf9a6950":"code","868e7940":"code","717db1a1":"code","6781408a":"code","9613c56e":"code","032e1701":"code","6844a4a0":"code","2101bdf0":"code","7d795608":"code","3ffc58bf":"code","4027743d":"code","5c96e2bd":"code","ad910136":"code","d707f645":"code","fcead74d":"code","464b193a":"code","3173aaa5":"code","9ada25ca":"code","fdb1c5bc":"code","d6701aff":"code","c6cd4c04":"code","a8bfcbfd":"code","f424a6b5":"code","572fa3a5":"code","103db440":"code","8bfdb420":"code","31961107":"code","4f26cec7":"code","ff54d05c":"code","8450134c":"code","b791d66f":"code","282c75e8":"code","c8604e9a":"code","ff5be912":"markdown","182f8e0e":"markdown","47784b72":"markdown"},"source":{"d4ed0d2a":"#Imporing important libraries\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns \nimport warnings\nwarnings.filterwarnings(\"ignore\")\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import preprocessing\nfrom lightgbm import LGBMRegressor\nfrom xgboost import XGBRegressor\nimport sklearn.metrics as metrics\nimport math","74bad2ae":"df_train = pd.read_csv(\"..\/input\/house-prices-advanced-regression-techniques\/train.csv\")\ndf_test = pd.read_csv(\"..\/input\/house-prices-advanced-regression-techniques\/test.csv\")\n\n#Making copr of the train and test dataset\nc_test  = df_test.copy()\nc_train  = df_train.copy()","994f270d":"#To display first 5 entries\ndf_train.head()","44693f2c":"#To display first 5 entries\ndf_test.head()","a17ce1ed":"#concatenating Train and test dataset\n\nc_train['train']  = 1\nc_test['train']  = 0\n\ndf = pd.concat([c_train, c_test], axis=0,sort=False)\n\ndf.head()","bf9a6950":"#Percentage of null values\n\ndf_col_name = df.columns\nvalues = []\n\nfor col in df_col_name:\n    values.append(((df[col].isnull().sum()\/df.shape[0])*100))\n\ndf_nan = pd.DataFrame(df_col_name,columns=['Feature'])\ndf_nan['percent'] = values \ndf_nan","868e7940":"#No. of features with more than 50% of missing values \n\ndf_nan = df_nan[df_nan.percent > 50]\ndf_nan.sort_values(\"percent\", ascending=False)","717db1a1":"#Droping columns with more than 50% of missing values \n\ndf = df.drop(['Alley','PoolQC','Fence','MiscFeature'],axis=1)","6781408a":"#Separating object and numerical feature\n\ndf_object = df.select_dtypes(include=['object'])\ndf_numerical =df.select_dtypes(exclude=['object'])","9613c56e":"#Number of null values in each feature\n\nnull_counts = df_object.isnull().sum()\nnull_counts","032e1701":"#Filling missing values with 'none'\nnone_col = ['BsmtQual','BsmtCond','BsmtExposure','BsmtFinType1','BsmtFinType2','GarageType','GarageFinish','GarageQual',\n            'FireplaceQu','GarageCond']\ndf_object[none_col]= df_object[none_col].fillna('None')\n\n#Filling missing value with mode\ndf_object = df_object.fillna('mode()')","6844a4a0":"#Number of null values in each feature\n\nnull_counts = df_numerical.isnull().sum()\nnull_counts","2101bdf0":"#Filling missing values with forward_fill\n\ndf_numerical['LotFrontage'] = df_numerical['LotFrontage'].fillna(method='ffill')\n\n#Filling missing values of 'GarageYrBlt' with 'YrSold'\n\ndf_numerical['GarageYrBlt'].fillna(df_numerical['YrSold'],inplace=True)\n\n#Filling missing values with zero\n\ndf_numerical.fillna(0,inplace=True)","7d795608":"#Creating new column 'Age_House'\n\ndf_numerical['Age_House']= (df_numerical['YrSold']-df_numerical['YearBuilt'])","3ffc58bf":"#To find if any negative value in Age_House\n\ndf_numerical[df_numerical['Age_House'] < 0]","4027743d":"#Since the Age_House is -1 filling its value with 2009\n\ndf_numerical.loc[df_numerical['YrSold'] < df_numerical['YearBuilt'],'YrSold' ] = 2009\ndf_numerical['Age_House']= (df_numerical['YrSold']-df_numerical['YearBuilt'])","5c96e2bd":"from sklearn.preprocessing import StandardScaler, LabelEncoder\n\nle = LabelEncoder()","ad910136":"#Label encoding the object feature\n\nfor col in df_object.columns.tolist():\n    df_object[col] = le.fit_transform(df_object[col])","d707f645":"#Concatenating object and numberical features\n\ndf_final = pd.concat([df_object, df_numerical], axis=1,sort=False)\ndf_final.head()","fcead74d":"#Droping column 'Id'\ndf_final = df_final.drop(['Id',],axis=1)\n\n#Separating train dataset and droping train column\ndf_train = df_final[df_final['train'] == 1]\ndf_train = df_train.drop(['train',],axis=1)\n\n#Separating test dataset and droping train and SalePrice column\ndf_test = df_final[df_final['train'] == 0]\ndf_test = df_test.drop(['SalePrice'],axis=1)\ndf_test = df_test.drop(['train',],axis=1)","464b193a":"#Separting df_train in independent and dependent variable\nX=df_train.drop(['SalePrice'],axis=1)\ny=df_train['SalePrice']","3173aaa5":"#Splitting df_train in train and test\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=1)","9ada25ca":"# Importing LinearRegression from sklearn\nfrom sklearn.linear_model import LinearRegression\n\n# Creating object and fitting the model\nlin_reg = LinearRegression()\nmodel = lin_reg.fit(X_train,y_train)\n","fdb1c5bc":"# Predicting for test dataset\ny_pred = model.predict(X_test)","d6701aff":"# Creating Actual and Predicted dataset \ndf1 = pd.DataFrame({'Actual': y_test, 'Predicted': y_pred})\ndf1","c6cd4c04":"# Model Evaluation \n\n# Importing metrics from sklearn \nfrom sklearn.metrics import mean_squared_error,r2_score,mean_absolute_error\n\n# To find Mean Absolute Error(mse)\nmse = (mean_absolute_error(y_test, y_pred))\nprint(\"MAE:\",mse)\n\n# To find Root Mean Squared Error(rmse)\nrmse = (np.sqrt(mean_squared_error(y_test, y_pred)))\nprint(\"RMSE:\",rmse)\n\n# To find coefficient of determination\nr2 =  r2_score(y_test, y_pred)\nprint(\"R-Square:\",r2)","a8bfcbfd":"xgb =XGBRegressor( booster='gbtree', colsample_bylevel=1,\n             colsample_bynode=1, colsample_bytree=0.6, gamma=0,\n             importance_type='gain', learning_rate=0.01, max_delta_step=0,\n             max_depth=4, min_child_weight=1.5, n_estimators=2400,\n             n_jobs=1, nthread=None, objective='reg:linear',\n             reg_alpha=0.6, reg_lambda=0.6, scale_pos_weight=1, \n             silent=None, subsample=0.8, verbosity=1)\n\nxgb.fit(X_train, y_train)\n","f424a6b5":"predict1 = xgb.predict(X_test)\n\nprint('RMSE using XGBoost: ',math.sqrt(metrics.mean_squared_error(y_test, predict1)))","572fa3a5":"lgbm = LGBMRegressor(objective='regression', \n                                       num_leaves=4,\n                                       learning_rate=0.01, \n                                       n_estimators=12000, \n                                       max_bin=200, \n                                       bagging_fraction=0.75,\n                                       bagging_freq=5, \n                                       bagging_seed=7,\n                                       feature_fraction=0.4, \n                                       )\n\nlgbm.fit(X_train, y_train,eval_metric='rmse')\n","103db440":"predict2 = lgbm.predict(X_test)\n\nprint('RMSE using LGBM: ',math.sqrt(metrics.mean_squared_error(y_test, predict2)))","8bfdb420":"xgb.fit(X, y)\nlgbm.fit(X, y,eval_metric='rmse')","31961107":"predict3 = lgbm.predict(df_test)\npredict4 = xgb.predict(df_test)","4f26cec7":"#Combining LGBM and XGBoost\npredict5 = ( predict4*0.45 + predict3*0.55)","ff54d05c":"#To compare the predicted value from all the three predict\npd.DataFrame({'predict3' : predict3,'predict4' : predict4,'predict5' : predict5 },\n             columns=['predict3','predict4', 'predict5'])","8450134c":"df_test = pd.read_csv(\"..\/input\/house-prices-advanced-regression-techniques\/test.csv\")","b791d66f":"#To csv\nsubmission = pd.DataFrame({\n        \"Id\": df_test[\"Id\"],\n        \"SalePrice\": predict3\n    })\nsubmission.to_csv('submission3.csv', index=False)","282c75e8":"#To csv\nsubmission = pd.DataFrame({\n        \"Id\": df_test[\"Id\"],\n        \"SalePrice\": predict4\n    })\nsubmission.to_csv('submission4.csv', index=False)","c8604e9a":"#To csv\nsubmission = pd.DataFrame({\n        \"Id\": df_test[\"Id\"],\n        \"SalePrice\": predict5\n    })\nsubmission.to_csv('submission5.csv', index=False)","ff5be912":"#### Building model with Linear Regression:","182f8e0e":"# **House Prices: Data Cleaning, Feature Engineering and Modeling**","47784b72":"#### Using XGBoost and LGBM:"}}