{"cell_type":{"c627effe":"code","5448db0d":"code","4e787ade":"code","b38b4c8e":"code","570b0b74":"code","f9621745":"code","85f5d603":"code","7a2be8e5":"code","0e775fc5":"code","97871de4":"code","ed0de9b4":"code","0af42038":"code","53de0c43":"code","aab0c685":"code","1adb77aa":"code","1cf0b19a":"code","5e91f0e2":"code","39f0956f":"code","da56e4a1":"code","840c6982":"code","6f6f828f":"code","5b2c0555":"code","ab8ac3f2":"code","2960b79c":"code","bafc2a45":"code","abce42a2":"code","890f2c92":"code","3291178d":"code","caea8afc":"markdown","3225e970":"markdown","ddd46f2a":"markdown","5684e1ef":"markdown","bdfbf0af":"markdown","7744f84f":"markdown","a0670022":"markdown","e76e3738":"markdown","f6060312":"markdown","812774a2":"markdown","2b041bce":"markdown","833dba19":"markdown","e0924cc2":"markdown","6b2e31b0":"markdown","942654c6":"markdown","ff6cc0f0":"markdown","14112a2d":"markdown","969d6af7":"markdown","ff5b6325":"markdown"},"source":{"c627effe":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n%matplotlib inline","5448db0d":"white_wine = pd.read_csv('..\/input\/winequality-white.csv')","4e787ade":"white_wine.head()","b38b4c8e":"white_wine.info()","570b0b74":"white_wine.apply(lambda x: sum(x.isnull()), axis=0)","f9621745":"white_wine['quality'].unique()","85f5d603":"white_wine['quality'].value_counts()","7a2be8e5":"sns.countplot(x='quality', data=white_wine)","0e775fc5":"def classify_wine_quality(quality):\n    if quality < 6:\n        return 'poor quality'\n    elif quality == 6:\n        return 'normal quality'\n    else:\n        return 'excellent quality'\n    \nwhite_wine['quality classification'] = white_wine['quality'].apply(classify_wine_quality)","97871de4":"sns.set_style('darkgrid')\nsns.set(rc={'figure.figsize':(10,5)})\nsns.countplot(x='quality classification', data=white_wine)","ed0de9b4":"sns.barplot(x='quality', y='fixed acidity', data=white_wine)","0af42038":"sns.barplot(x='quality', y='pH', data=white_wine)","53de0c43":"sns.barplot(x='quality', y='sulphates', data=white_wine)","aab0c685":"sns.barplot(x='quality', y='alcohol', data=white_wine)","1adb77aa":"sns.set(rc={'figure.figsize':(10,5)})\nsns.boxplot(y='alcohol', x='quality classification', hue='quality classification', data=white_wine)","1cf0b19a":"sns.boxplot(y='pH', x='quality classification', data=white_wine, hue='quality classification')","5e91f0e2":"sns.boxplot(y='sulphates', x='quality classification', data=white_wine, hue='quality classification')","39f0956f":"sns.boxplot(y='fixed acidity', x='quality classification', data=white_wine, hue='quality classification')","da56e4a1":"correlation = white_wine.corr()['quality'].drop('quality')\nprint(correlation.sort_values(kind='quicksort', ascending=False))","840c6982":"#use LabelEncoder for the categorigal values\nfrom sklearn.preprocessing import LabelEncoder","6f6f828f":"le = LabelEncoder()\nwhite_wine['quality classification'] = le.fit_transform(white_wine['quality classification'])\nwhite_wine['quality classification'].dtypes","5b2c0555":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import confusion_matrix, classification_report\nfrom sklearn.model_selection import train_test_split","ab8ac3f2":"X_train, X_test, y_train, y_test = train_test_split(white_wine.drop(['quality classification', 'quality'], axis=1 ), white_wine['quality classification'], test_size=0.40)","2960b79c":"rfc = RandomForestClassifier(n_estimators=10)","bafc2a45":"rfc.fit(X_train, y_train)","abce42a2":"predictions = rfc.predict(X_test)","890f2c92":"print(classification_report(predictions, y_test))","3291178d":"print(confusion_matrix(predictions, y_test))","caea8afc":"#### Wine Quality Prediction","3225e970":"#### Import the libraries","ddd46f2a":"**Observation from the above plots**\n* fixed acidity has no significant effect on quality\n* increase in **alcohol** also increases the wine quality\n* increase in **sulphates** also increases the wine quality\n* increase in **pH** also the wine quality\n\nThis observation is also validated by the below correlation of the feature variable with regards to quality","5684e1ef":"Now, lets examine the unique values we have for **quality**","bdfbf0af":"There we have it. The the random forest model achieved a 66 % acuracy with the f1-score percentage. This model could be further improve by feature selection or feature engineering. We could also try a different model and compare the results.","7744f84f":"Hello and welcome. This is my second Kernel which serves as my personal notes in doing the machine learning exercise. The aim is to be able to acquire skills to perform Machine Learning and Data Science work. \nIn today's exercise, I will be working with wine quality dataset, perform some exploratory data analysis and eventually create a machine learning that will predict wine quality.","a0670022":"The dependent variable is the **quality** while the features or the independent variables are as follows:<br><\/br>\n* fixed acidity<br><\/br>\n* volatile acidity<br><\/br>\n* citric acid<br><\/br>\n* residual sugar<br><\/br>\n* chlorides<br><\/br>\n* free sulfur dioxide<br><\/br>\n* total sulfur dioxide<br><\/br>\n* density<br><\/br>\n* pH<br><\/br>\n* sulphates<br><\/br>\n* alcohol<br><\/br>","e76e3738":"#### Step 3: Create an instance of the Random Forest Classifier Model","f6060312":"**Observations**\n* No missing data\n* All columns are numeric\n\nAnother way to check if a column has a missing value or if a column contain a null value is to use the isnull method. To get the total count of null value or the missing data we will combine the **isnull()** method with the **sum()** method.","812774a2":"#### EDA - Bivariate Analysis\nIn this section, we will perform the EDA using bivariate analysis. The intention is to get to know how a specific feature affects the quality of wine.","2b041bce":"Next step is to run the pandas **info()** method to check the datatypes of each columns. It will also give us the numnber of entries per columns. ","833dba19":"Let's do a count plot to visualize the above data","e0924cc2":"#### Step 1: Import the needed scikit learn libraries","6b2e31b0":"#### Load the White Wine Dataset","942654c6":"There 6 wine quality values based from the results above. Minimum is 3 and maximum is 9. We can create 3 wine quality categories namely **poor quality**, **normal quality**, **excellent quality**.\n\n* if quality < 6 - **poor quality**\n* if quality = 6 - **normal quality**\n* if quality > 6 - **excellent quality**","ff6cc0f0":"#### Step 2: Divide the dataset into training data and test data","14112a2d":"#### Step 4: Train the Random Forest Classifier Model","969d6af7":"#### Step 5: Make Prediction","ff5b6325":"#### Create Machine Learning Model\n\nBefore we create the model, we will first perform label encode the categoral variable that we have created to classify the wine quality into 3 groups. The LabelEncoder will convert these values into its equivalent numerical values"}}