{"cell_type":{"fd7422ed":"code","eea51076":"code","4fc34815":"code","7ee79419":"code","80ec038c":"code","49046685":"code","30ed2e3e":"code","c68d7890":"code","e3eae018":"code","43538e1f":"code","89e5fc9e":"code","55e07955":"code","08e624dd":"code","51f45c6c":"code","4471e3b2":"code","4508867a":"code","387a5682":"code","6b5d50a6":"code","82be0083":"code","757393e8":"code","8c680337":"code","93ca2c54":"code","6d8c14ab":"code","12ce97d3":"code","be86c73a":"code","e8d301a0":"code","8677be2c":"code","fd0253af":"code","10b46691":"code","23beab16":"code","d80439fb":"code","7c4bc9f2":"code","ffb3297d":"code","40ce65f2":"code","4eaaff44":"code","ff0fce96":"code","8ad19a60":"code","e4a86ca4":"code","16063fa7":"code","c2908cb0":"code","9ffaab36":"code","6ba284ff":"code","60cbc887":"code","64df2ad0":"code","7ddd0d00":"code","5e9b26e1":"code","4a79de91":"code","2561b6f9":"code","7cdc1a34":"code","2dc9f356":"code","4668d06d":"code","05274fb2":"code","d99433b9":"code","006169cb":"code","8e3aed5a":"code","66a35c0c":"code","890b7c1e":"code","8808be79":"code","1b5ad967":"code","8035a063":"code","9cf7f894":"code","de6df44c":"code","0d41e316":"code","f6ab424f":"code","d04ef652":"code","aaf95cc8":"code","edabf9cc":"code","9e5bacc6":"code","2db4be6a":"code","aaf6b41c":"code","6356b18b":"code","c3810e3d":"code","c96cddeb":"code","1bd844a6":"code","e3434944":"code","84815a47":"code","51bc810a":"code","1c5104c5":"code","cba42da2":"code","3213ea1a":"code","622e1ba6":"markdown","03d43545":"markdown","7e0a8984":"markdown","c60a674b":"markdown","dfaa8e2b":"markdown","4a759502":"markdown","77bfa6b7":"markdown","a3f52094":"markdown","d0041ab4":"markdown","2988e7c2":"markdown","2078e6ae":"markdown","eca8dbfa":"markdown","d00afd55":"markdown","45cfbb22":"markdown","913ae0ee":"markdown","5d5bf264":"markdown","37045f3d":"markdown","bc86fc6e":"markdown","e67c6875":"markdown","c70df6eb":"markdown","4a79729e":"markdown","449b6cdc":"markdown","ac552273":"markdown","c53a583b":"markdown","78b2afc1":"markdown","c72d90f6":"markdown","768246bd":"markdown","eb10a6db":"markdown","0ed06f3c":"markdown","a1c70929":"markdown","f69f28b5":"markdown","0b67551d":"markdown","0713b581":"markdown","71ffadb4":"markdown","a1942cb9":"markdown","bbc47dd5":"markdown","3d641eee":"markdown","8b24db41":"markdown","072db874":"markdown","1a0801d8":"markdown","66cdf3ac":"markdown","d3311531":"markdown","3a6ff3ec":"markdown","e8a48d52":"markdown","84d56d5b":"markdown","96c085a1":"markdown","73fca2be":"markdown","23917514":"markdown","683f0418":"markdown","bf89e35d":"markdown","3cb1040b":"markdown","0fe9458d":"markdown","18bdf186":"markdown","8a3e1045":"markdown","b643120b":"markdown"},"source":{"fd7422ed":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set()","eea51076":"#path of your csv file\npath='..\/input\/bank-loan-modelling\/Bank_Personal_Loan_Modelling.xlsx'\ndf=pd.read_excel(path,'Data')\ndf.head()","4fc34815":"df.shape","7ee79419":"df.describe()","80ec038c":"df.isnull().sum()","49046685":"df.info()","30ed2e3e":"df.nunique()","c68d7890":"categorical_variables=[col for col in df.columns if df[col].nunique()<=5]\nprint(categorical_variables)\ncontinuous_variables=[col for col in df.columns if df[col].nunique()>5]\nprint(continuous_variables)","e3eae018":"categorical_variables.remove(\"Personal Loan\")\nprint(categorical_variables)\ncontinuous_variables.remove(\"ID\")\nprint(continuous_variables)","43538e1f":"fig=plt.figure(figsize=(20,10))\n#fig.subplots_adjust(wspace=0.4,hspace=0.4)\nfor i,col in enumerate(continuous_variables):\n    ax=fig.add_subplot(2,3,i+1)\n    sns.distplot(df[col])","89e5fc9e":"fig=plt.figure(figsize=(20,10))\n#fig.subplots_adjust(wspace=0.4,hspace=0.4)\nfor i,col in enumerate(categorical_variables):\n    ax=fig.add_subplot(2,3,i+1)\n    sns.countplot(df[col])","55e07955":"fig=plt.figure(figsize=(20,10))\nfor i,col in enumerate(continuous_variables):\n    ax=fig.add_subplot(2,3,i+1)\n    sns.boxplot(y=df[col],x=df['Personal Loan'])","08e624dd":"fig=plt.figure(figsize=(20,10))\nfor i,col in enumerate(continuous_variables):\n    ax=fig.add_subplot(2,3,i+1)\n    ax1=sns.distplot(df[col][df['Personal Loan']==0],hist=False,label='No Personal Lone')\n    sns.distplot(df[col][df['Personal Loan']==1],hist=False,ax=ax1,label='Personal Lone')","51f45c6c":"fig=plt.figure(figsize=(20,10))\nfor i,col in enumerate(categorical_variables):\n    ax=fig.add_subplot(2,3,i+1)\n    sns.barplot(x=col,y='Personal Loan',data=df,ci=None)","4471e3b2":"con=continuous_variables.copy()\ncon.remove('Income')","4508867a":"fig=plt.figure(figsize=(20,10))\nfor i,col in enumerate(con):\n    ax=fig.add_subplot(2,3,i+1)\n    sns.scatterplot('Income',col,hue='Personal Loan',data=df)","387a5682":"fig=plt.figure(figsize=(20,10))\nfor i,col in enumerate(categorical_variables):\n    ax=fig.add_subplot(2,3,i+1)\n    sns.scatterplot(col,'Income',hue='Personal Loan',data=df)","6b5d50a6":"con.remove('CCAvg')","82be0083":"fig=plt.figure(figsize=(20,10))\nfor i,col in enumerate(con):\n    ax=fig.add_subplot(2,2,i+1)\n    sns.scatterplot('CCAvg',col,hue='Personal Loan',data=df)","757393e8":"fig=plt.figure(figsize=(20,10))\nfor i,col in enumerate(categorical_variables):\n    ax=fig.add_subplot(2,3,i+1)\n    sns.scatterplot(col,'CCAvg',hue='Personal Loan',data=df)","8c680337":"fig=plt.figure(figsize=(20,10))\nfor i,col in enumerate(categorical_variables):\n    ax=fig.add_subplot(2,3,i+1)\n    sns.countplot(x=col,hue='Personal Loan',data=df)","93ca2c54":"df.drop_duplicates(inplace=True)","6d8c14ab":"df.shape","12ce97d3":"df.set_index(\"ID\",inplace=True)","be86c73a":"df.drop('ZIP Code',axis=1,inplace=True)","e8d301a0":"corr=df.corr()\nplt.figure(figsize=(10,10))\nplt.title('Correlation')\nsns.heatmap(corr > 0.90, annot=True, square=True)","8677be2c":"df[['Age','Experience','Personal Loan']].corr()","fd0253af":"df.drop('Experience',axis=1,inplace=True)","10b46691":"df['Account']=df['CD Account']+df['Securities Account']","23beab16":"df[['CD Account','Securities Account','Account','Personal Loan']].corr()","d80439fb":"df.drop('Account',axis=1,inplace=True)","7c4bc9f2":"df['Facilities']=df['Online']+df['CreditCard']","ffb3297d":"df[['Facilities','Online','CreditCard','Personal Loan']].corr()","40ce65f2":"df.drop(['Online','CreditCard'],axis=1,inplace=True)","4eaaff44":"df.head()","ff0fce96":"from sklearn.preprocessing import StandardScaler\nscaler=StandardScaler()","8ad19a60":"scaled_df=scaler.fit_transform(df.drop('Personal Loan',axis=1))","e4a86ca4":"scaled_df=pd.DataFrame(scaled_df)","16063fa7":"scaled_df.columns=df.drop('Personal Loan',axis=1).columns\nscaled_df.head()","c2908cb0":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.metrics import accuracy_score,confusion_matrix\nfrom sklearn.metrics import classification_report\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import f1_score","9ffaab36":"X=scaled_df\ny=df['Personal Loan']","6ba284ff":"x_train,x_test,y_train,y_test=train_test_split(X,y,test_size=0.3,random_state=100)","60cbc887":"model_list=[]\nmodel_f1_score=[]\nmodel_accuracy_score=[]","64df2ad0":"model_list.append('LogisticRegression')\nlm=LogisticRegression()","7ddd0d00":"lm.fit(x_train,y_train)","5e9b26e1":"yhat_lm=lm.predict(x_test)","4a79de91":"lm_score=f1_score(y_test,yhat_lm)\nmodel_f1_score.append(lm_score)\nlm_score","2561b6f9":"lm_accuracy=accuracy_score(y_test,yhat_lm)\nmodel_accuracy_score.append(lm_accuracy)\nlm_accuracy","7cdc1a34":"print(classification_report(y_test,yhat_lm))","2dc9f356":"sns.heatmap(confusion_matrix(y_test,yhat_lm),annot=True,fmt='',cmap='YlGnBu')","4668d06d":"model_list.append('DecisionTreeClassifier')\ntree=DecisionTreeClassifier()","05274fb2":"tree.fit(x_train,y_train)","d99433b9":"yhat_tree=tree.predict(x_test)","006169cb":"tree_score=f1_score(y_test,yhat_tree)\nmodel_f1_score.append(tree_score)\ntree_score","8e3aed5a":"tree_accuracy=accuracy_score(y_test,yhat_tree)\nmodel_accuracy_score.append(tree_accuracy)\ntree_accuracy","66a35c0c":"print(classification_report(y_test,yhat_tree))","890b7c1e":"sns.heatmap(confusion_matrix(y_test,yhat_tree),annot=True,fmt='',cmap='YlGnBu')","8808be79":"model_list.append('RandomForestClassifier')\nforest=RandomForestClassifier()","1b5ad967":"forest.fit(x_train,y_train)","8035a063":"yhat_forest=forest.predict(x_test)","9cf7f894":"forest_score=f1_score(y_test,yhat_forest)\nmodel_f1_score.append(forest_score)\nforest_score","de6df44c":"forest_accuracy=accuracy_score(y_test,yhat_forest)\nmodel_accuracy_score.append(forest_accuracy)\nforest_accuracy","0d41e316":"print(classification_report(y_test,yhat_forest))","f6ab424f":"sns.heatmap(confusion_matrix(y_test,yhat_forest),annot=True,fmt='',cmap='YlGnBu')","d04ef652":"model_list.append('SVC')\nsvc=SVC()","aaf95cc8":"svc.fit(x_train,y_train)","edabf9cc":"yhat_svc=svc.predict(x_test)","9e5bacc6":"svc_score=f1_score(y_test,yhat_svc)\nmodel_f1_score.append(svc_score)\nsvc_score","2db4be6a":"svc_accuracy=accuracy_score(y_test,yhat_svc)\nmodel_accuracy_score.append(svc_accuracy)\nsvc_accuracy","aaf6b41c":"print(classification_report(y_test,yhat_svc))","6356b18b":"sns.heatmap(confusion_matrix(y_test,yhat_svc),annot=True,fmt='',cmap='YlGnBu')","c3810e3d":"model_list.append('KNeighborsClassifier')\nneighbour=KNeighborsClassifier()","c96cddeb":"neighbour.fit(x_train,y_train)","1bd844a6":"yhat_neighbour=neighbour.predict(x_test)","e3434944":"neighbour_score=f1_score(y_test,yhat_neighbour)\nmodel_f1_score.append(neighbour_score)\nneighbour_score","84815a47":"neighbour_accuracy=accuracy_score(y_test,yhat_neighbour)\nmodel_accuracy_score.append(neighbour_accuracy)\nneighbour_accuracy","51bc810a":"print(classification_report(y_test,yhat_neighbour))","1c5104c5":"sns.heatmap(confusion_matrix(y_test,yhat_neighbour),annot=True,fmt='',cmap='YlGnBu')","cba42da2":"fig,ax=plt.subplots(figsize=(10,8))\nsns.barplot(model_list,model_f1_score)\nax.set_title(\"F1 Score of  Test Data\",pad=20)\nax.set_xlabel(\"Models\",labelpad=20)\nax.set_ylabel(\"F1_Score\",labelpad=20)\nplt.xticks(rotation=90)\n\nfor p in ax.patches:\n    width, height = p.get_width(), p.get_height()\n    x, y = p.get_xy() \n    ax.annotate('{:.0%}'.format(height), (x+0.25, y + height + 0.01))","3213ea1a":"fig,ax=plt.subplots(figsize=(10,6))\nsns.barplot(model_list,model_accuracy_score)\nax.set_title(\"Accuracy of Models on Test Data\",pad=20)\nax.set_xlabel(\"Models\",labelpad=20)\nax.set_ylabel(\"Accuracy\",labelpad=20)\nplt.xticks(rotation=90)\n\nfor p in ax.patches:\n    width, height = p.get_width(), p.get_height()\n    x, y = p.get_xy() \n    ax.annotate('{:.0%}'.format(height), (x+0.25, y + height + 0.01))","622e1ba6":"<b>Income is a strong attribute which effect the chances of having Personl Loan High the Income High the chances of having Personal Loan. So we will analysise Income with other attributes","03d43545":"<b>Finding relationship between Experience and Age","7e0a8984":"### RandomForestClassifier","c60a674b":"<b>Analysing each column (Independent Attribute) first in regard with Personal Loan (Dependent attribute) and then relating them with one another for finding patterns in data","dfaa8e2b":"<b>Applying Scaling","4a759502":"<b>Creating Attributes","77bfa6b7":"1. Most of the customer doesn't have Securities Account, CD Account and CreditCard\n2. More number of customer use internet banking facilities.\n3. More number of customer are Undergrad and have family size one.","a3f52094":"1. Experience contains some negative values and experience can't be negative\n2. The max of Income, Experience, CCAvg, Mortgage, Security Account, CD Accounts, CreditCard is much high then their mean it means they contains some extream values","d0041ab4":"1. CCAvg Shows similar trends as shown by Income","2988e7c2":"### Univarient Analysis","2078e6ae":"<b> Since ZIP Code doesn't show any effect on the chances of Personal Loan it is better to remove it form our data","eca8dbfa":"# Conclusion","d00afd55":"<b> these graph clearly depicts the facts that we had observed previously above like person with CD Account have more chances of having Personal Loan","45cfbb22":"# Data Visualization","913ae0ee":"<b>Analysing the distribution of particular attributes","5d5bf264":"# Feature Engineering","37045f3d":"1. We can see that Age and Experience are uniformaly distributed and show a good similarities in distribution.\n2. Income, CCAvg, Mortgage are positive Skew\n3. ZIP code is negative Skew or it contain values from single region.\n4. Mortgage contain most of the values as 0","bc86fc6e":"<B>We will remove the Personal Loan from categorical variable list as it is the target variable (Dependent Variable) and ID from the continuous variable list as it doesn't take part in data modeling","e67c6875":"<b>Each attribute is in proper datatype i.e., int or float attributes doesn't contain character or object data","c70df6eb":" <b>Attributes Information<\/b>\n    \n    1. ID: Customer ID\n    2. Age: Customer's age in completed years\n    3. Experience: #years of professional experience\n    4. Income: Annual income of the customer\n    5. ZIP Code: Home Address ZIP code.\n    6. Family: Family size of the customer\n    7. CCAvg: Avg. spending on credit cards per month\n    8. Education: Education Level. 1: Undergrad; 2: Graduate; 3:Advanced\/Professional\n    9. Mortgage: Value of house mortgage if any.\n    10. Personal Loan: Did this customer accept the personal loan offered in the last campaign?\n    11. Securities Account: Does the customer have a securities account with the bank?\n    12. CD Account: Does the customer have a certificate of deposit (CD) account with the bank?\n    13. Online: Does the customer use internet banking facilities?\n    14. Credit card: Does the customer use a credit card issued by the bank?","4a79729e":"### LogisticRegression","449b6cdc":"# Understanding the Data","ac552273":"<b>The classification goal is to predict the likelihood of a liability customer buying personal\nloans.","c53a583b":"### Data Cleaning","78b2afc1":"### DecisionTreeClassifier","c72d90f6":"### KNeighborsClassifier","768246bd":"<b>Categorical variables","eb10a6db":"Since it shows a week correlation as compaired to CD Account we will drop it ","0ed06f3c":"### Bivariate Analysis ","a1c70929":"dataset: https:\/\/www.kaggle.com\/itsmesunil\/bank-loan-modelling\/download","f69f28b5":"1. Customers with high Degrees and having family size greater then 3 with high income have personal loan.\n2. Customers with CD Accounts have chances of having Personal Loan","0b67551d":"We will keep the Facilities attribute and drop the Online and CreditCard attributes","0713b581":"<b>Accuracy Score","71ffadb4":"Among the 5 models that we have implemented DecisionTreeClassifier and RandomForestClassifier gives the same and best F1 Score and accuracy score with almost accuracy of 98% and F1-Score of 91%","a1942cb9":"### SVC","bbc47dd5":"1. Age and Experience have not effect much as customer with high income no matter of what age group have chances of having Personal Loan.\n2. ZIP Code shows that all the customers are of particular area and they have no pattern in chances of having personal loan.\n3. Customers with high income and having personal loan shows high Avg. spending on credit cards per month and high Value of house mortgage","3d641eee":"### Ploting the Results","8b24db41":"# Model Development","072db874":"We will try to create a new feature Account contain 1 if any customer is having either CD Account or Security Account or zero if customer have none of them and will try to find its relation with target variable if it shows a better relation compaired to other two then we will keep it otherwise we will remove it","1a0801d8":"<b>On the basis of number of unique values we can seperate the continuous and categorical data","66cdf3ac":"we will now try to create a attribute facilities which will contain 1 if customer uses the bank facilities like online banking or credit card else it will contain 0 and then we will check for relation with the target variable if it is better then the previous one we will keep that attribute","d3311531":"<b>F1-Score","3a6ff3ec":"<b>Data doesn't contain any null values so now lets find either they are in proper datatypes or not","e8a48d52":"1. Personal Loan doesn't show variations with Age and Experience.\n2. Income has a good effect on Personal Loan Customers with High Income have more chances of having Personal Loan.\n3. CCAvg also show a good relationship with Personal Loan customers with personal loan have high Avg. spending on credit cards per month\n4. Customers want to have high Mortgage have opted for Personal Loan","84d56d5b":"1. Age and Experience show same patterns on customers with personal loan or not.\n2. high CCAvg and Mortgage have more chances of customer having Personal Loan","96c085a1":"<b> After income we will find relation of CCAvg with other attributes","73fca2be":"# Bank Loan Modelling","23917514":"<b>Continious Variables","683f0418":"Zip code contain data of particular area so it contain minimum variations so we removed it.","bf89e35d":"<b>Categorical Variable","3cb1040b":"since Age shows a little better correlation with Personal loan we will drop the Experience attribute","0fe9458d":"<b>Since there are no duplicate enteries or row in data so we can set ID as index of dataframe","18bdf186":"## Importing modules and data","8a3e1045":"1. Customers with family size equal to 3 have more chances of having Personal Loan.\n2. Customers with Undergrad degree have less chances of having Personal Loan as compaired to other customers having Graduate or Advanced\/Professional degree\n3. Customers with CD Account and Securities Account have more chances of having Personal Loan.\n4. Customers using online Facitilies or not, having credit card or not doesn't effect much in chances of having Personal Loan","b643120b":"<b>Continuous variable"}}