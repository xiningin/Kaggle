{"cell_type":{"23f70890":"code","74624a5b":"code","3fd9f6b0":"code","0d71536c":"code","19acfd06":"code","90cb394b":"code","22c9d675":"code","211bc2d4":"code","7a74e6b0":"code","968f6340":"code","ebcba238":"code","6d422af1":"code","491f7cb7":"code","0b651f56":"code","6ad766e5":"code","be06ceac":"code","cec27609":"code","9f9d0785":"code","4e79f339":"markdown","563e601c":"markdown","7315d121":"markdown","4a23f70e":"markdown","7246cf30":"markdown","cfe9d80a":"markdown","1c43b4f5":"markdown"},"source":{"23f70890":"from keras.preprocessing.image import ImageDataGenerator\nfrom keras.applications.vgg16 import preprocess_input\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import ConfusionMatrixDisplay\nfrom sklearn.metrics import confusion_matrix\nimport matplotlib.pyplot as plt\nimport tensorflow as tf\nfrom tensorflow import keras\ntf.compat.v1.set_random_seed(0)\nimport pandas as pd\nimport numpy as np\nnp.random.seed(0)\nimport cv2\nimport os","74624a5b":"plt.figure(figsize=(20,5))\nplt.subplot(1,2,1)\nplt.bar([\"Buildings\",\"Forest\",\"Glacier\",\"Mountain\",\"Sea\",\"Street\"],\n         [len(os.listdir(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/buildings\")),\n          len(os.listdir(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/forest\")),\n          len(os.listdir(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/glacier\")),\n          len(os.listdir(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/mountain\")),\n          len(os.listdir(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/sea\")),\n          len(os.listdir(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/street\"))])\nplt.title(\"Classes with count for training\")\nplt.xlabel(\"Class\")\nplt.ylabel(\"Count\")\n\nplt.subplot(1,2,2)\nplt.bar([\"Buildings\",\"Forest\",\"Glacier\",\"Mountain\",\"Sea\",\"Street\"],\n         [len(os.listdir(\"..\/input\/intel-image-classification\/seg_test\/seg_test\/buildings\")),\n          len(os.listdir(\"..\/input\/intel-image-classification\/seg_test\/seg_test\/forest\")),\n          len(os.listdir(\"..\/input\/intel-image-classification\/seg_test\/seg_test\/glacier\")),\n          len(os.listdir(\"..\/input\/intel-image-classification\/seg_test\/seg_test\/mountain\")),\n          len(os.listdir(\"..\/input\/intel-image-classification\/seg_test\/seg_test\/sea\")),\n          len(os.listdir(\"..\/input\/intel-image-classification\/seg_test\/seg_test\/street\"))])\nplt.title(\"Classes with count for testing\")\nplt.xlabel(\"Class\")\nplt.ylabel(\"Count\")\nplt.show()","3fd9f6b0":"plt.figure(figsize=(80,80))\nplt.subplot(6,4,1)\nplt.title(\"Building\",fontdict={'fontsize' : 50})\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/buildings\/0.jpg\",1))\nplt.subplot(6,4,2)\nplt.title(\"Building\",fontdict={'fontsize' : 50})\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/buildings\/1001.jpg\",1))\nplt.subplot(6,4,3)\nplt.title(\"Building\",fontdict={'fontsize' : 50})\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/buildings\/10014.jpg\",1))\nplt.subplot(6,4,4)\nplt.title(\"Building\",fontdict={'fontsize' : 50})\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/buildings\/10029.jpg\",1))\n\nplt.subplot(6,4,5)\nplt.title(\"Forest\",fontdict={'fontsize' : 50})\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/forest\/10007.jpg\",1))\nplt.subplot(6,4,6)\nplt.title(\"Forest\",fontdict={'fontsize' : 50})\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/forest\/10010.jpg\",1))\nplt.subplot(6,4,7)\nplt.title(\"Forest\",fontdict={'fontsize' : 50})\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/forest\/10020.jpg\",1))\nplt.subplot(6,4,8)\nplt.title(\"Forest\",fontdict={'fontsize' : 50})\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/forest\/10030.jpg\",1))\n\nplt.subplot(6,4,9)\nplt.title(\"Glacier\",fontdict={'fontsize' : 50})\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/glacier\/10.jpg\",1))\nplt.subplot(6,4,10)\nplt.title(\"Glacier\",fontdict={'fontsize' : 50})\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/glacier\/100.jpg\",1))\nplt.subplot(6,4,11)\nplt.title(\"Glacier\",fontdict={'fontsize' : 50})\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/glacier\/10003.jpg\",1))\nplt.subplot(6,4,12)\nplt.title(\"Glacier\",fontdict={'fontsize' : 50})\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/glacier\/10011.jpg\",1))\n\nplt.subplot(6,4,13)\nplt.title(\"Mountain\",fontdict={'fontsize' : 50})\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/mountain\/10000.jpg\",1))\nplt.subplot(6,4,14)\nplt.title(\"Mountain\",fontdict={'fontsize' : 50})\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/mountain\/10001.jpg\",1))\nplt.subplot(6,4,15)\nplt.title(\"Mountain\",fontdict={'fontsize' : 50})\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/mountain\/10002.jpg\",1))\nplt.subplot(6,4,16)\nplt.title(\"Mountain\",fontdict={'fontsize' : 50})\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/mountain\/10008.jpg\",1))\n\nplt.subplot(6,4,17)\nplt.title(\"Sea\",fontdict={'fontsize' : 50})\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/sea\/1.jpg\",1))\nplt.subplot(6,4,18)\nplt.title(\"Sea\",fontdict={'fontsize' : 50})\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/sea\/10016.jpg\",1))\nplt.subplot(6,4,19)\nplt.title(\"Sea\",fontdict={'fontsize' : 50})\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/sea\/10041.jpg\",1))\nplt.subplot(6,4,20)\nplt.title(\"Sea\",fontdict={'fontsize' : 50})\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/sea\/10053.jpg\",1))\n\nplt.subplot(6,4,21)\nplt.title(\"Street\",fontdict={'fontsize' : 50})\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/street\/1000.jpg\",1))\nplt.subplot(6,4,22)\nplt.title(\"Street\",fontdict={'fontsize' : 50})\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/street\/10015.jpg\",1))\nplt.subplot(6,4,23)\nplt.title(\"Street\",fontdict={'fontsize' : 50})\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/street\/10019.jpg\",1))\nplt.subplot(6,4,24)\nplt.title(\"Street\",fontdict={'fontsize' : 50})\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_train\/seg_train\/street\/10022.jpg\",1))","0d71536c":"#Epochs for training\nep=4","19acfd06":"train_datagen = ImageDataGenerator(rescale=1.\/255,\n                                   horizontal_flip=True)\ntrain_generator = train_datagen.flow_from_directory('..\/input\/intel-image-classification\/seg_train\/seg_train',\n                                                    target_size=(150, 150),\n                                                    batch_size=64,\n                                                    class_mode='categorical')","90cb394b":"test_datagen = ImageDataGenerator(rescale=1.\/255,\n                                   horizontal_flip=True)\ntest_generator = test_datagen.flow_from_directory('..\/input\/intel-image-classification\/seg_test\/seg_test',\n                                                    target_size=(150, 150),\n                                                    batch_size=64,\n                                                    class_mode='categorical')","22c9d675":"new_input = keras.Input(shape=(150, 150, 3))\nmodel_base = keras.applications.VGG16(weights='imagenet',include_top=False,input_tensor=new_input)\nfor layer in model_base.layers:\n    layer.trainable=False\nmodel_base.summary()","211bc2d4":"model_base.layers[-1].trainable=True\nmodel_base.layers[-2].trainable=True\nmodel_base.layers[-3].trainable=True\nmodel_base.layers[-4].trainable=True","7a74e6b0":"model = keras.models.Sequential()\nmodel.add(model_base)\nmodel.add(keras.layers.Flatten())\nmodel.add(keras.layers.Dense(250, activation='relu'))\nmodel.add(keras.layers.Dropout(0.5))\nmodel.add(keras.layers.Dense(6, activation='softmax'))","968f6340":"model.summary()","ebcba238":"model.compile(optimizer=keras.optimizers.Adam(0.0002),loss='categorical_crossentropy',metrics=['accuracy'])","6d422af1":"history = model.fit_generator(train_generator,\n                    validation_data=test_generator,\n                    epochs=ep)","491f7cb7":"plt.figure(figsize=(15,5))\nplt.subplot(1,2,1)\nplt.plot([str(i) for i in range(1,ep+1)],history.history['accuracy'],label=\"Train Accuracy\")\nplt.plot([str(i) for i in range(1,ep+1)],history.history['val_accuracy'],label=\"Test Accuracy\")\nplt.xlabel(\"Epoch\")\nplt.ylabel(\"Accuracy\")\nplt.title(\"Accuracy Curves\")\nplt.legend()\n\nplt.subplot(1,2,2)\nplt.plot([str(i) for i in range(1,ep+1)],history.history['loss'],label=\"Train loss\")\nplt.plot([str(i) for i in range(1,ep+1)],history.history['val_loss'],label=\"Test loss\")\nplt.xlabel(\"Epoch\")\nplt.ylabel(\"Accuracy\")\nplt.title(\"Loss\")\nplt.legend()\nplt.show()","0b651f56":"y_pred = model.predict_generator(test_generator)\ny_pred = np.argmax(y_pred,1)","6ad766e5":"evals = model.evaluate(test_generator)\nprint(\"Test Loss : {:.2f}\".format(evals[0]))\nprint(\"Test Accuracy : {:.2f} %\".format(evals[1]*100))","be06ceac":"classes = [\"Buildings\",\"Forest\",\"Glacier\",\"Mountain\",\"Sea\",\"Street\"]\ncm = confusion_matrix(y_pred,test_generator.classes)","cec27609":"\ndisp = ConfusionMatrixDisplay(confusion_matrix=cm,\n                              display_labels=classes)\nfig, ax = plt.subplots(figsize=(10,10))\nplt.title(\"Confusion Matrix\")\ndisp = disp.plot(ax=ax)\nplt.show()","9f9d0785":"img = 0\nplt.figure(figsize=(30,30))\nplt.subplot(6,4,1)\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10004.jpg\",1))\nimg = np.array(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10004.jpg\",1)) \/ 255.0\nimg = np.expand_dims(img,0)\nplt.title(classes[np.argmax(model.predict(img),1)[0]],fontdict={'fontsize' : 25})\n\nplt.subplot(6,4,2)\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10017.jpg\",1))\nimg = np.array(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10017.jpg\",1)) \/ 255.0\nimg = np.expand_dims(img,0)\nplt.title(classes[np.argmax(model.predict(img),1)[0]],fontdict={'fontsize' : 25})\n\nplt.subplot(6,4,3)\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/1003.jpg\",1))\nimg = np.array(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/1003.jpg\",1)) \/ 255.0\nimg = np.expand_dims(img,0)\nplt.title(classes[np.argmax(model.predict(img),1)[0]],fontdict={'fontsize' : 25})\n\nplt.subplot(6,4,4)\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10069.jpg\",1))\nimg = np.array(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10069.jpg\",1)) \/ 255.0\nimg = np.expand_dims(img,0)\nplt.title(classes[np.argmax(model.predict(img),1)[0]],fontdict={'fontsize' : 25})\n\nplt.subplot(6,4,5)\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10082.jpg\",1))\nimg = np.array(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10082.jpg\",1)) \/ 255.0\nimg = np.expand_dims(img,0)\nplt.title(classes[np.argmax(model.predict(img),1)[0]],fontdict={'fontsize' : 25})\n          \nplt.subplot(6,4,6)\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10092.jpg\",1))\nimg = np.array(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10092.jpg\",1)) \/ 255.0\nimg = np.expand_dims(img,0)\nplt.title(classes[np.argmax(model.predict(img),1)[0]],fontdict={'fontsize' : 25})\n\nplt.subplot(6,4,7)\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10059.jpg\",1))\nimg = np.array(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10059.jpg\",1)) \/ 255.0\nimg = np.expand_dims(img,0)\nplt.title(classes[np.argmax(model.predict(img),1)[0]],fontdict={'fontsize' : 25})\n\nplt.subplot(6,4,8)\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10100.jpg\",1))\nimg = np.array(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10100.jpg\",1)) \/ 255.0\nimg = np.expand_dims(img,0)\nplt.title(classes[np.argmax(model.predict(img),1)[0]],fontdict={'fontsize' : 25})\n\nplt.subplot(6,4,9)\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10106.jpg\",1))\nimg = np.array(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10106.jpg\",1)) \/ 255.0\nimg = np.expand_dims(img,0)\nplt.title(classes[np.argmax(model.predict(img),1)[0]],fontdict={'fontsize' : 25})\n          \nplt.subplot(6,4,10)\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10090.jpg\",1))\nimg = np.array(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10090.jpg\",1)) \/ 255.0\nimg = np.expand_dims(img,0)\nplt.title(classes[np.argmax(model.predict(img),1)[0]],fontdict={'fontsize' : 25})\n          \nplt.subplot(6,4,11)\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10124.jpg\",1))\nimg = np.array(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10124.jpg\",1)) \/ 255.0\nimg = np.expand_dims(img,0)\nplt.title(classes[np.argmax(model.predict(img),1)[0]],fontdict={'fontsize' : 25})\n          \nplt.subplot(6,4,12)\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10179.jpg\",1))\nimg = np.array(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10179.jpg\",1)) \/ 255.0\nimg = np.expand_dims(img,0)\nplt.title(classes[np.argmax(model.predict(img),1)[0]],fontdict={'fontsize' : 25})\n\nplt.subplot(6,4,13)\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10021.jpg\",1))\nimg = np.array(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10021.jpg\",1)) \/ 255.0\nimg = np.expand_dims(img,0)\nplt.title(classes[np.argmax(model.predict(img),1)[0]],fontdict={'fontsize' : 25})\n          \nplt.subplot(6,4,14)\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/1018.jpg\",1))\nimg = np.array(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/1018.jpg\",1)) \/ 255.0\nimg = np.expand_dims(img,0)\nplt.title(classes[np.argmax(model.predict(img),1)[0]],fontdict={'fontsize' : 25})\n          \nplt.subplot(6,4,15)\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/1018.jpg\",1))\nimg = np.array(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/1018.jpg\",1)) \/ 255.0\nimg = np.expand_dims(img,0)\nplt.title(classes[np.argmax(model.predict(img),1)[0]],fontdict={'fontsize' : 25})\n          \nplt.subplot(6,4,16)\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10233.jpg\",1))\nimg = np.array(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10233.jpg\",1)) \/ 255.0\nimg = np.expand_dims(img,0)\nplt.title(classes[np.argmax(model.predict(img),1)[0]],fontdict={'fontsize' : 25})\n\nplt.subplot(6,4,17)\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/101.jpg\",1))\nimg = np.array(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/101.jpg\",1)) \/ 255.0\nimg = np.expand_dims(img,0)\nplt.title(classes[np.argmax(model.predict(img),1)[0]],fontdict={'fontsize' : 25})\n          \nplt.subplot(6,4,18)\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10178.jpg\",1))\nimg = np.array(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10178.jpg\",1)) \/ 255.0\nimg = np.expand_dims(img,0)\nplt.title(classes[np.argmax(model.predict(img),1)[0]],fontdict={'fontsize' : 25})\n          \nplt.subplot(6,4,19)\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10287.jpg\",1))\nimg = np.array(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10287.jpg\",1)) \/ 255.0\nimg = np.expand_dims(img,0)\nplt.title(classes[np.argmax(model.predict(img),1)[0]],fontdict={'fontsize' : 25})\n          \nplt.subplot(6,4,20)\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/1018.jpg\",1))\nimg = np.array(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/1018.jpg\",1)) \/ 255.0\nimg = np.expand_dims(img,0)\nplt.title(classes[np.argmax(model.predict(img),1)[0]],fontdict={'fontsize' : 25})\n          \nplt.subplot(6,4,21)\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/1018.jpg\",1))\nimg = np.array(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/1018.jpg\",1)) \/ 255.0\nimg = np.expand_dims(img,0)\nplt.title(classes[np.argmax(model.predict(img),1)[0]],fontdict={'fontsize' : 25})\n          \nplt.subplot(6,4,22)\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10293.jpg\",1))\nimg = np.array(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10293.jpg\",1)) \/ 255.0\nimg = np.expand_dims(img,0)\nplt.title(classes[np.argmax(model.predict(img),1)[0]],fontdict={'fontsize' : 25})\n          \nplt.subplot(6,4,23)\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10288.jpg\",1))\nimg = np.array(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10288.jpg\",1)) \/ 255.0\nimg = np.expand_dims(img,0)\nplt.title(classes[np.argmax(model.predict(img),1)[0]],fontdict={'fontsize' : 25})\n          \nplt.subplot(6,4,24)\nplt.imshow(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10401.jpg\",1))\nimg = np.array(cv2.imread(\"..\/input\/intel-image-classification\/seg_pred\/seg_pred\/10401.jpg\",1)) \/ 255.0\nimg = np.expand_dims(img,0)\nplt.title(classes[np.argmax(model.predict(img),1)[0]],fontdict={'fontsize' : 25})","4e79f339":"<p>We will freeze the weighs of VGG16 model and further unfreeze last 4 layers - 3 Convolution and 1 Maxpooling. (Obtained through experimentation). Unfreezing last few layers will help learn the higher level features of our dataset.","563e601c":"VGG16 contains only the convolution part - we will add the FC layer and output layer here.","7315d121":"<p>From the visualization it is clear that images contain a lot of variety, hence might require deeper models for better accuracy. Kaggle kernel gets disrupted when using large models because of resource exhaustion. Transfer learning seems to be a good fit here - We will initialize a VGG16 model with the weights that it learnt for imagenet database. Imagenent contains similar classes as to this dataset. ","4a23f70e":"<p>The images are spread across folders containing the name of thier classes. It will be resource efficient to use a data generator<\/p>","7246cf30":"<p><\/p>Let us visualize the class balancing of the dataset. This ensures that model does not lean towards the class with majority samples<\/p>","cfe9d80a":"<p>Let us visualize each sample and see what images look like. This will give us an idea on model building at a later stage<\/p>","1c43b4f5":"<p> A good enoug model but not that great, there are quite a lot of misclassifications. This can be due to the similarit in images. Further optimizing the model will yield good results<\/p>"}}