{"cell_type":{"1fa59801":"code","8484ec36":"code","a0d773e8":"code","9cecd406":"code","c6bb5cbe":"code","8b4117b9":"code","b41ffcb6":"code","47d5c6b5":"code","4828e392":"code","811281c2":"code","223e8c9f":"code","6f72abf4":"code","3979f160":"code","12544639":"code","ad354e7f":"code","388d5447":"code","1ed1b25b":"code","fb47236f":"code","9db1af93":"markdown","5d588470":"markdown","c06161fa":"markdown","b1fe2536":"markdown"},"source":{"1fa59801":"!pip install pycaret","8484ec36":"!pip install shap","a0d773e8":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nimport missingno as msno\n\nimport warnings\nwarnings.simplefilter(action='ignore', category=FutureWarning)\n\nfrom pycaret.regression import setup, create_model, tune_model, finalize_model, blend_models, predict_model, plot_model, interpret_model\nimport shap","9cecd406":"df_train = pd.read_csv('..\/input\/tabular-playground-series-aug-2021\/train.csv')\ndf_test = pd.read_csv('..\/input\/tabular-playground-series-aug-2021\/test.csv')","c6bb5cbe":"df_train.head()","8b4117b9":"df_train.info()","b41ffcb6":"msno.matrix(df_train)","47d5c6b5":"plt.figure(figsize=(16,16))\nsns.heatmap(df_train.corr(),cmap='PuRd')\nplt.show()","4828e392":"cols = df_train.columns.values\nfig, ax = plt.subplots(25, 4, figsize=(16,100))\ncnt = 0\nfor i in cols:\n    if i == 'loss':\n        break\n    elif i == 'id':\n        continue\n    else:\n        sns.histplot(df_train[i], ax=ax[cnt\/\/4, cnt%4], color='lightskyblue')\n        cnt += 1\n    \nplt.show()","811281c2":"def do_pycaret(target, train, test):\n    reg = setup(data=train, target=target,normalize=True, silent=True, session_id=42)\n    catboost = create_model(\"catboost\", fold=5)\n    lightgbm = create_model(\"lightgbm\", fold=5)\n    blended = blend_models(estimator_list= [catboost, lightgbm], fold=5, optimize='RMSE')\n    predh = predict_model(blended)\n    final = finalize_model(blended)\n    pred = predict_model(final, data=test)\n    return(pred, catboost, lightgbm)","223e8c9f":"pred, catboost, lightgbm = do_pycaret('loss', df_train, df_test)","6f72abf4":"pred","3979f160":"plot_model(catboost, plot='feature')","12544639":"plot_model(lightgbm, plot='feature')","ad354e7f":"interpret_model(catboost)","388d5447":"interpret_model(lightgbm)","1ed1b25b":"submission = pd.read_csv('..\/input\/..\/input\/tabular-playground-series-aug-2021\/sample_submission.csv')\nsubmission.loss = pred.Label\nsubmission","fb47236f":"submission.to_csv('PyCaret_blend_sub.csv',index=False)","9db1af93":"## Predict and check SHAP with PyCaret\nWe want to check the importance of the features in SHAP, so once we do, we will use PyCaret to predict them in CatBoost and display SHAP.","5d588470":"## Overview\nThere are no missing values and there seems to be no correlation with loss for any of the features. It's so abstract, I don't even know where to begin! I would like to gradually investigate this from now on.I'm not sure we'll know anything within a month.","c06161fa":"# Tabular Playground Series - Aug 2021\nA quick review of the data, predictions in PyCaret, and SHAP.","b1fe2536":"## Submission"}}