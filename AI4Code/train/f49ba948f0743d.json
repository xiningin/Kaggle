{"cell_type":{"63ec3b18":"code","cd2b12d3":"code","660d5fee":"code","e1853a83":"code","26e85efa":"code","6c87bc3f":"code","947ccdac":"code","20ec13e1":"code","230934ff":"code","3da8d4a5":"code","493f510b":"code","466d9750":"code","837cf534":"code","8dc29f55":"code","d305ae78":"code","d5e961eb":"code","2a7fa7a8":"code","1ebb95a5":"code","ce66c906":"code","606ffb79":"code","1ff10fe6":"code","f81504e7":"code","385d4837":"code","9ac1528b":"code","e993762f":"code","fef875a0":"code","f43fd479":"code","bcb4e2e2":"code","e4b720ae":"code","dc26a485":"code","4ccaa4ac":"code","9600e31d":"code","a06c0dec":"markdown","83ae5af1":"markdown","4898cfee":"markdown","8b4637c4":"markdown","e8c779a1":"markdown","3a753fce":"markdown","2599a4d1":"markdown","7a5dea45":"markdown","8b7b47f0":"markdown","8344c27f":"markdown","1a5143c8":"markdown","ece1bc13":"markdown","3f70a509":"markdown","c874db36":"markdown","41d9868f":"markdown","0249fecb":"markdown","bc6fd9ad":"markdown","2454edb8":"markdown","98f3592c":"markdown","c346ca4a":"markdown","94e26bf7":"markdown","c1dfba88":"markdown","5fbe2fb7":"markdown","59af43f1":"markdown","ee8dade1":"markdown","832fcbfc":"markdown","f0539dd6":"markdown"},"source":{"63ec3b18":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport plotly\nimport seaborn as sb\nimport squarify\nimport plotly.offline as py\nfrom plotly.offline import iplot, init_notebook_mode\nimport plotly.graph_objs as go\nfrom datetime import datetime\nfrom sklearn.feature_extraction.text import CountVectorizer \nimport matplotlib.style as style \n!pip install rake-nltk\nfrom rake_nltk import Rake","cd2b12d3":"df = pd.read_csv(\"..\/input\/netflix-shows\/netflix_titles.csv\")\ndf.head(5)","660d5fee":"plt.figure(figsize=(6,6))\nplt.pie([df.groupby('type').show_id.count()['Movie'],df.groupby('type').show_id.count()['TV Show']],\n        labels = ['Movie', 'TV Shows'], colors=['mediumseagreen', 'khaki'],\n       startangle = 0, shadow=True, counterclock=False,\n       textprops = {'size':13}, autopct = '%1.1f%%')\ncentercircle = plt.Circle((0,0), 0.7, fc='white')\nfig = plt.gcf()\nfig.gca().add_artist(centercircle)\n\n\nplt.title('Type of Content', fontsize=15, fontweight='bold')\nplt.show()","e1853a83":"genremovies = []\nfor i in df[df['type']=='Movie'].listed_in.apply(lambda x: x.split(',')):\n    genremovies = genremovies + i\n\nallgenremovies = list(map(lambda x: x[1:] if x[0]==' ' else x, genremovies))\ngenremovies = list(set(allgenremovies))\ngenremovies.sort()","26e85efa":"genretv = []\nfor i in df[df['type']=='TV Show'].listed_in.apply(lambda x: x.split(',')):\n    genretv = genretv + i\n\nallgenretv = list(map(lambda x: x[1:] if x[0]==' ' else x, genretv))\ngenretv = list(set(allgenretv))\ngenretv.sort()","6c87bc3f":"ngenmov= []\nfor i in genremovies:\n    ngenmov.append(allgenremovies.count(i))\n    \nngentv= []\nfor i in genretv:\n    ngentv.append(allgenretv.count(i))","947ccdac":"labelmov= []\nfor i in range(len(ngenmov)):\n    labelmov.append(genremovies[i] + ' ' +str(round(ngenmov[i]\/len(allgenremovies)*100, 2)) + '%')\n    \nlabeltv= []\nfor i in range(len(ngentv)):\n    labeltv.append(genretv[i] + ' ' + str(round(ngentv[i]\/len(allgenretv)*100, 2)) + '%')","20ec13e1":"plt.figure(figsize=(16,16))\n\nplt.suptitle('Genres in Netflix', fontsize=20, fontweight='bold')\nplt.subplot(2,1,1)\nplt.title('Genre of Movies in Netflix', fontsize=14, fontweight='bold')\nsquarify.plot(sizes=ngenmov, label=labelmov, alpha=.6, edgecolor=\"black\",\n              linewidth=2, text_kwargs={'fontsize':12})\n\nplt.subplot(2,1,2)\nplt.title('Genre of TV Show in Netflix', fontsize=14, fontweight='bold')\nsquarify.plot(sizes=ngentv, label=labeltv, alpha=.6, edgecolor=\"black\",\n              linewidth=2, text_kwargs={'fontsize':12})\n\nplt.show()","230934ff":"df =df.dropna(subset=['date_added'])\ndf.head(3)","3da8d4a5":"df['date_added']=df.date_added.apply(lambda x: datetime.strptime(x, ' %B %d, %Y') if x[0]==' ' else datetime.strptime(x, '%B %d, %Y'))\ndf['date_added']=df.date_added.apply(lambda x: datetime.strftime(x, '%B %d, %Y'))\ndf['date_added']=df.date_added.apply(lambda x: datetime.strptime(x, '%B %d, %Y'))","493f510b":"df['year_added']=df.date_added.apply(lambda x: x.year)","466d9750":"df.head(3)","837cf534":"dfym = pd.DataFrame()\ndfym['genre'] = genremovies\nyearmovie = list(df.year_added.unique())\nyearmovie.sort()\n\nfor i in yearmovie:\n    dfym[f'{i}'] = dfym['genre'].apply(lambda x: list(df.groupby(['year_added', 'type']).agg({'listed_in': ','.join}).loc[i].loc['Movie'])[0].replace(', ', ',').split(',').count(x))\n    \ndfym","8dc29f55":"dfytv = pd.DataFrame()\ndfytv['genre'] = genretv\n\nyeartv = list(df[df['type']=='TV Show']['year_added'])\n\nfor i in yearmovie:\n    if i in yeartv: \n        dfytv[f'{i}'] = dfytv['genre'].apply(lambda x: list(df.groupby(['year_added', 'type']).agg({'listed_in': ','.join}).loc[i].loc['TV Show'])[0].replace(', ', ',').split(',').count(x))\n    else:\n        dfytv[f'{i}'] = [0] * len(genretv)\ndfytv","d305ae78":"dfymA = dfym.copy()","d5e961eb":"for i in range(2,len(dfymA.columns)):\n    dfymA[f'{dfymA.columns[i]}'] = dfym[f'{dfymA.columns[i]}'] + dfymA[f'{dfymA.columns[i-1]}']\ndfymA","2a7fa7a8":"dfytvA = dfytv.copy()","1ebb95a5":"for i in range(2,len(dfytvA.columns)):\n    dfytvA[f'{dfytvA.columns[i]}'] = dfytv[f'{dfytvA.columns[i]}'] + dfytvA[f'{dfytvA.columns[i-1]}']\ndfytvA","ce66c906":"plt.figure(figsize=(16,16))\nplt.style.use('ggplot')\nplt.suptitle('Rise of Genres in Netflix', family='sans-serif', size=20)\n\n\nplt.subplot(2,1,1)\nplt.title('Movie')\nfor i in range(len(genremovies)): \n    plt.scatter(range(2008,2021),dfymA.iloc[i, 1:], marker= 'D', s=30, color='yellow', edgecolor='black', zorder = 3)\n    plt.plot(range(2008,2021), dfymA.iloc[i, 1:])\nplt.xticks(range(2008,2021))\nplt.grid(linestyle='--')\nplt.legend(dfymA['genre'])\n\n\n\nplt.subplot(2,1,2)\nplt.title('TV Shows')\nfor i in range(len(genretv)): \n    plt.plot(range(2008,2021), dfytvA.iloc[i, 1:])\n    plt.scatter(range(2008,2021),dfytvA.iloc[i, 1:], marker= 'D', s=30, color='yellow', edgecolor='black', zorder = 3)\nplt.xticks(range(2008,2021))\nplt.grid(linestyle='--')\nplt.legend(dfytvA['genre'])\n\n\n\nplt.show()","606ffb79":"dfr = df.copy()\ndfr.head(2)","1ff10fe6":"dfr['cast'] = dfr['cast'].apply(lambda x: str(x).replace(' ', ''))\ndfr['cast'] = dfr['cast'].apply(lambda x: str(x).replace(',',' '))\n\ndfr['director'] = dfr['director'].apply(lambda x: str(x).replace(' ', ''))\ndfr['director'] = dfr['director'].apply(lambda x: str(x).replace(',',' '))\n\ndfr['genre'] = dfr['listed_in'].apply(lambda x: str(x).replace(' ', ''))\ndfr['genre'] = dfr['genre'].apply(lambda x: str(x).replace(',',' '))","f81504e7":"dfr.head(2)","385d4837":"keyw = []\nfor index, row in dfr.iterrows():\n    desc = row['description']\n    r = Rake()\n    r.extract_keywords_from_text(desc)\n    keywordsdict = r.get_word_degrees()\n    keyw.append(' '.join(list(keywordsdict.keys())))\n    \ndfr['keywords']= keyw","9ac1528b":"dfr.drop(['duration', 'description', 'listed_in'], axis =1, inplace=True)","e993762f":"dfr['keybag'] = dfr['cast'] + ' ' + dfr['director'] + ' ' + dfr['genre'] + ' ' + dfr['keywords']","fef875a0":"dfr2 = dfr.copy()\ndfr2 = dfr2[['show_id','title', 'keybag', 'type',  'rating']]\ndfr2['title2'] = dfr2['title'].apply(lambda x: x.lower())\ndfr2['type'] = dfr2['type'].apply(lambda x: x.lower())","f43fd479":"dfr2.head(3)","bcb4e2e2":"extractor = CountVectorizer()\nextracted = extractor.fit_transform(dfr2['keybag'])","e4b720ae":"from sklearn.metrics.pairwise import cosine_similarity \n\nscore = cosine_similarity(extracted)","dc26a485":"def recnflix (name, n, types):\n    if name.lower() in list(dfr2['title2']):\n        fav_index = dfr2[dfr2['title2']==name.lower()].index[0]\n        n=int(n)\n        types = types.lower()\n        rec = sorted(list(enumerate(score[fav_index])), key=lambda x:x[1], reverse=True)\n        index_rec = []\n        i= 1\n        while len(index_rec) < n:\n            if dfr2.iloc[rec[i][0]]['type'] == types:\n                index_rec.append(rec[i][0])\n            i += 1\n        return df.iloc[index_rec]\n    else: \n        return ('The Title You Entered is Wrong')","4ccaa4ac":"recnflix('Saudi Arabia Uncovered', 3, 'TV Show')","9600e31d":"recnflix('The Outsider', 4, 'Movie')","a06c0dec":"Counting the number for each genre","83ae5af1":"<b>Plotting <\/b>","4898cfee":"We're gonna make a simple function named <b>recnflix<\/b> which will recommend you several tv show\/movies based on the similiarity to your favorite tv show\/movies. In this function you can choose how many tv shows\/movies you want to get recommended to, and whether you want the recommendation to include TV Show\/Movies. If you call the function it will return a dataframe that shows the recommended tv show\/movies","8b4637c4":"# 1. Data Visualization","e8c779a1":"# 2. Recommender System","3a753fce":"Based on the graphic above we can see that Netflix started adding TV Shows and Movies in larger scale in 2016. Movie genre that Netflix added the most is Classic Movies, while on the TV Show Netflix aggresively adds the International TV Shows genre. From the line chart above we can also see that there hasn't been any big changes in the increase of movies\/tv shows added per genre. Netflix adds more movies and tv shows in each genres rather steadily. ","2599a4d1":"<b>Data Cleaning for Director, Cast, Genre<\/b><br> \neliminating the space between first name and last name, or 2-or-more-words-genre so that the extractor wouldn't split them into two different keywords.","7a5dea45":"Squarify Visualization","8b7b47f0":"<b>Accumulate<\/b> the number of <b>movies<\/b> per genre per year","8344c27f":"To see the trend over the year, we need to see add a column of year added","1a5143c8":"<b>Number of TV Shows Released per Genre per Year <\/b>","ece1bc13":"## B. Growth of The Genres","3f70a509":"Getting the unique values for TV Shows Genre ","c874db36":"<b>CountVectorizer<\/b>","41d9868f":"<b>Cosinus Similiarity<\/b>","0249fecb":"Getting the unique values for Movie Genre ","bc6fd9ad":"### Based on Similiarity","2454edb8":"<b>Recommendation Function <\/b>","98f3592c":"<b>Accumulate<\/b> the number of <b>TV Shows<\/b> per genre per year\n","c346ca4a":"# Netflix Data Visualization and Recommender System\n- Data Visualization using Squarify and simple Matplotlib\n- Recommender System using Rake, CountVectorizer, CosinusSimiliarity","94e26bf7":"Making the label","c1dfba88":"<b>Bagging The Keywords <\/b>","5fbe2fb7":"Using <b>Rake<\/b> to extract the keywords from the <b>description<\/b> since the description is too long","59af43f1":"<b>Calling the Function<\/b> (for example)","ee8dade1":"## A. Proportion of Genre in Movies and TV Show","832fcbfc":"<b>Number of Movies Released per Genre per Year <\/b>","f0539dd6":"We're going to build a simple recommender system based on the similiarity of a movie\/tv show genre, description, cast, and directors. "}}