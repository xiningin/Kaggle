{"cell_type":{"e9238d7a":"code","67fe7edd":"code","bdb12526":"code","c5b21d01":"code","4d473276":"code","b7cf8904":"code","fdda7463":"code","b1f0a6c7":"code","968e41eb":"code","be694ca0":"code","166c3747":"code","ee3e1347":"code","1c6bf492":"code","ad812fc4":"code","e3547dd5":"code","9180c989":"code","2b2216e7":"markdown","f0d66879":"markdown","96c59014":"markdown","aa26ccd4":"markdown","922d8880":"markdown","e97ee8f4":"markdown","cdfe8bae":"markdown"},"source":{"e9238d7a":"filename_train = '..\/input\/house-prices-advanced-regression-techniques\/train.csv'\nfilename_test  = '..\/input\/house-prices-advanced-regression-techniques\/test.csv'","67fe7edd":"import pandas as pd\n\ndf_train = pd.read_csv(filename_train, index_col='Id')\ndf_test  = pd.read_csv(filename_test, index_col='Id')","bdb12526":"df_train","c5b21d01":"df_test","4d473276":"obj_col = 'SalePrice'","b7cf8904":"X_train = df_train.drop([obj_col], axis=1)\nX_train","fdda7463":"X_test = df_test\nX_test","b1f0a6c7":"y_train = df_train['SalePrice']\ny_train","968e41eb":"def to_category(df):\n    for col, type in zip(df.columns, df.dtypes):\n        if type == object:\n            df[col] = df[col].astype('category')\n    \n    return df","be694ca0":"X_train = to_category(X_train)\nX_test  = to_category(X_test)","166c3747":"X_train.dtypes","ee3e1347":"import numpy as np\nimport lightgbm as lgb\nfrom sklearn.metrics import accuracy_score\n\nlgb_train = lgb.Dataset(X_train, y_train)\n\nparams = {\n    'objective': 'regression_l1',    \n    'force_row_wise': True,\n}\n\ncv_rslt = lgb.cv(params, \n                 lgb_train, \n                 nfold=5, \n                 num_boost_round=10000, \n                 early_stopping_rounds=100,\n                 return_cvbooster=True)","1c6bf492":"cvbooster = cv_rslt['cvbooster']","ad812fc4":"import scipy\n\ny_test = np.mean(cvbooster.predict(X_test, num_iteration=cvbooster.best_iteration), axis=0)\ny_test = pd.Series(y_test, name='SalePrice')\ny_test","e3547dd5":"answer = pd.concat([df_test.index.to_series().reset_index(drop=True), y_test], axis=1)\nanswer","9180c989":"fname_output = '.\/submission.csv'\nanswer.to_csv(fname_output, index=False)","2b2216e7":"# Modeling","f0d66879":"# Prediction","96c59014":"# Load files","aa26ccd4":"## Change object-type to category-type","922d8880":"## Objective variables","e97ee8f4":"# Preprocessing","cdfe8bae":"## Explanatory variables"}}