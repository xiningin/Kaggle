{"cell_type":{"1a9e227b":"code","e7c1fe73":"code","e28c4fb7":"code","b39d97b6":"code","64bdc2f3":"code","60bf0543":"code","638261e6":"code","9d0ec59b":"code","fee87b09":"code","0d0c9573":"code","a8eae279":"code","ab9477d7":"code","8e542362":"code","9437bfc1":"code","7580b492":"markdown","d25818a5":"markdown","13b6b508":"markdown","01c8383f":"markdown","38df7399":"markdown","8a3e9ed6":"markdown","9bf2f4a4":"markdown","ea38a364":"markdown","4bd3f099":"markdown","fb272ba0":"markdown","9ef6ea33":"markdown","960dac14":"markdown","42a355e7":"markdown","66226e07":"markdown"},"source":{"1a9e227b":"%matplotlib inline\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport os\n\nfrom fastai import *\nfrom fastai.vision import *\nfrom fastai.callbacks.hooks import *\n","e7c1fe73":"base_dir = '..\/input\/cell_images\/cell_images\/'\nbase_path = Path(base_dir)\nbase_path","e28c4fb7":"data = ImageDataBunch.from_folder(base_path,valid_pct=0.1,\n                                 train='.',\n                                 ds_tfms=get_transforms(max_warp=0,flip_vert=True),\n                                 size=128,bs=32,\n                                 num_workers=0).normalize(imagenet_stats)\n\nprint(f'Classes to classify: \\n {data.classes}')\ndata.show_batch(rows=5,figsize=(7,7))","b39d97b6":"learner = create_cnn(data,models.resnet50,metrics=accuracy,model_dir='\/tmp\/model\/')\nlearner.lr_find()\nlearner.recorder.plot()","64bdc2f3":"learner.fit_one_cycle(10,max_lr=slice(1e-4,1e-3))\nlearner.save('stage-1')","60bf0543":"learner.recorder.plot_losses()","638261e6":"inter = ClassificationInterpretation.from_learner(learner)\ninter.plot_top_losses(9,figsize=(20,20))","9d0ec59b":"inter.plot_confusion_matrix(figsize=(10,10),dpi=75)","fee87b09":"learner.unfreeze()\nlearner.fit_one_cycle(2)","0d0c9573":"learner.lr_find()\nlearner.recorder.plot()","a8eae279":"learner.fit_one_cycle(5, max_lr=slice(1e-6,1e-3))","ab9477d7":"learner.recorder.plot_losses()","8e542362":"inter = ClassificationInterpretation.from_learner(learner)\ninter.plot_top_losses(9,figsize=(20,20))","9437bfc1":"inter.plot_confusion_matrix(figsize=(10,10),dpi=75)\nlearner.save('malaria-fastai-V1')","7580b492":"# Import Libraries","d25818a5":"# Create the learner","13b6b508":"# Train the model","01c8383f":"# Plot confusion matrix","38df7399":"# Create a path to the images","8a3e9ed6":"# Plot the losses of the model","9bf2f4a4":"# Plot the losses of the train and validation sets","ea38a364":"# Plot the top losses","4bd3f099":"# Plot the top losses of the model after training","fb272ba0":"# Model Training","9ef6ea33":"# Unfreeze and train","960dac14":"# Plot a confusion matrix to see how well the model performs","42a355e7":"# find the learning rate and plot the learning rate","66226e07":"# Create a databunch to feed the data into the model"}}