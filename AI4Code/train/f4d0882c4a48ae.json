{"cell_type":{"7e997a49":"code","9623a572":"code","b848f4e9":"code","9a27d2f1":"code","916bfe8f":"code","f3b5ba67":"code","3536e6d1":"markdown","e50edc91":"markdown","a1cf433c":"markdown","52bc8eb4":"markdown","5271b1f1":"markdown"},"source":{"7e997a49":"import numpy   as np\nimport pandas  as pd\npd.set_option('display.max_columns', None)\n!pip install BorutaShap","9623a572":"train   = pd.read_csv('..\/input\/the-volcano-and-the-regularized-greedy-forest\/volcano_train.csv')\nX_train = train.drop([\"segment_id\",\"time_to_eruption\"],axis=1)\ny_train = train[\"time_to_eruption\"]\n\nfrom xgboost import XGBRegressor\nmodel = XGBRegressor()\n\nfrom BorutaShap import BorutaShap\nFeature_Selector = BorutaShap(model=model,importance_measure='shap', classification=False)\nFeature_Selector.fit(X=X_train, y=y_train, n_trials=35, random_state=0);","b848f4e9":"Feature_Selector.plot(which_features='accepted', figsize=(20,12))","9a27d2f1":"selected_features = Feature_Selector.Subset()\nselected_features","916bfe8f":"selected_features.to_csv('selected_features.csv',index=False)","f3b5ba67":"test   = pd.read_csv('..\/input\/the-volcano-and-the-regularized-greedy-forest\/volcano_test.csv')\nX_train          = selected_features\nselected_columns = selected_features.columns\nX_test           = test[selected_columns]\n\nfrom rgf.sklearn import RGFRegressor\nregressor = RGFRegressor(max_leaf=10000, \n                         algorithm=\"RGF_Sib\", \n                         test_interval=100, \n                         loss=\"LS\",\n                         verbose=False)\nregressor.fit(X_train, y_train)\npredictions = regressor.predict(X_test)\n\nsample = pd.read_csv('..\/input\/predict-volcanic-eruptions-ingv-oe\/sample_submission.csv')\nsample.iloc[:,1:] = predictions\nsample.to_csv('submission.csv',index=False)","3536e6d1":"Return a subset of the original data with the selected features","e50edc91":"write out a `selected_features.csv` file","a1cf433c":"# Volcanic feature importance using Boruta-SHAP\nIn this notebook we shall produce a selection of the most important features of the [INGV - Volcanic Eruption Prediction](https:\/\/www.kaggle.com\/c\/predict-volcanic-eruptions-ingv-oe) data using the [Boruta-SHAP](https:\/\/www.kaggle.com\/carlmcbrideellis\/feature-selection-using-the-borutashap-package) package.\nFor the input I use the `train.csv` produced by the excellent notebook [\"INGV Volcanic Eruption Prediction - LGBM Baseline\"](https:\/\/www.kaggle.com\/ajcostarino\/ingv-volcanic-eruption-prediction-lgbm-baseline) written by [Adam James](https:\/\/www.kaggle.com\/ajcostarino). I shall write the results of the feature selection to the file `selected_features.csv`.","52bc8eb4":"### Produce a `submission.csv` using the RGF\nFor completeness we shall produce a `submission.csv`, here using the [Regularized Greedy Forest](https:\/\/www.kaggle.com\/carlmcbrideellis\/introduction-to-the-regularized-greedy-forest) for the estimator:","5271b1f1":"Produce a box-plot of the accepted features"}}