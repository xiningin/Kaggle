{"cell_type":{"00daa176":"code","3016f2cb":"code","7203f9df":"code","9af592a2":"code","d9a2de49":"code","9c710abb":"code","4d3824e6":"code","203a20eb":"code","327562ab":"code","675d9d90":"code","d12ca027":"markdown","e2891871":"markdown","23dec436":"markdown","7c92b0ae":"markdown","e0257c38":"markdown","43061c30":"markdown","2c9001ce":"markdown","e415ada4":"markdown","7157560c":"markdown","be623b86":"markdown"},"source":{"00daa176":"import pandas as pd\n\npd.set_option('max_rows', 5)\ncrashes = pd.read_csv(\"..\/input\/planecrashinfo_20181121001952.csv\")\n# add year \ncrashes['CrashYear'] = pd.DatetimeIndex(pd.to_datetime(crashes['date'])).year\ncrashes['CrashMonth'] = pd.DatetimeIndex(pd.to_datetime(crashes['date'])).month\ncrashes['CrashDay'] = pd.DatetimeIndex(pd.to_datetime(crashes['date'])).day\ncrashes","3016f2cb":"crashes.groupby(\"CrashYear\").size().plot(figsize=(25, 6))","7203f9df":"crashes.groupby(\"CrashMonth\").size().plot.bar(figsize=(25, 6))","9af592a2":"#Top 50 operators\noperators = crashes.groupby(\"operator\").size()\nordered_operators = operators.sort_values(ascending = False)\nordered_operators = ordered_operators.iloc[:50]\nordered_operators.plot.bar(figsize=(25, 6))","d9a2de49":"#Top 50 models\nmodels = crashes.groupby(\"ac_type\").size()\nordered_models = models.sort_values(ascending = False)\nordered_models = ordered_models.iloc[:50]\nordered_models.plot.bar(figsize=(25, 6))","9c710abb":"aeroflot = crashes[crashes[\"operator\"] == \"Aeroflot\"]\naeroflot_ordered_models = aeroflot.groupby(\"ac_type\").size().sort_values(ascending = False)\naeroflot_ordered_models.plot.bar(figsize=(25, 6))","4d3824e6":"not_aeroflot_models = crashes[crashes[\"operator\"] != \"Aeroflot\"]\nnot_aeroflot_ordered_models = not_aeroflot_models.groupby(\"ac_type\").size().sort_values(ascending = False)\nnot_aeroflot_ordered_models.iloc[:50].plot.bar(figsize=(25, 6))","203a20eb":"aeroflot.groupby(\"CrashYear\").size().plot(figsize=(25, 6))","327562ab":"douglas_dc3 = crashes[crashes[\"ac_type\"] == \"Douglas DC-3\"]\ndouglas_dc3_ordered = douglas_dc3.groupby(\"operator\").size().sort_values(ascending = False)\ndouglas_dc3_ordered.iloc[:50].plot.bar(figsize=(25, 6))","675d9d90":"douglas_dc3.groupby(\"CrashYear\").size().plot(figsize=(25, 6))","d12ca027":"And now check the \"top 50\" plane models","e2891871":"Setup the environment and load data file","23dec436":"Year distribution for the crashes","7c92b0ae":"Let's find out what is the \"top 50\" operators","e0257c38":"Let's find the time distribution for \"Douglas DC-3\" crashes","43061c30":"Month :) distribution for crashes","2c9001ce":"Next would be to check how the top 50 model statistic looks without the \"Aeroflot\" crashes","e415ada4":"Let's find who was operating the \"Douglas DC-3\"","7157560c":"Let's find the time distribution for \"Aeroflot\" crashes","be623b86":"It looks like \"Aeroflot\" is the \"leader\" in the crashes. Let's find out the planes statistic for this operator"}}