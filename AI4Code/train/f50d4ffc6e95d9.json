{"cell_type":{"601f279c":"code","89e13a0a":"code","06e6d15e":"code","8869b72c":"code","44d4a066":"code","77868aa8":"code","bfa31adc":"code","f80d7aa2":"markdown","8d26dec2":"markdown","f34ec996":"markdown"},"source":{"601f279c":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport lightgbm as lgb\nfrom sklearn.model_selection import KFold\nfrom sklearn import model_selection, preprocessing, metrics","89e13a0a":"train = pd.read_csv('..\/input\/train.csv')\ntest = pd.read_csv('..\/input\/test.csv')\ntrain = train[train.columns[2:]]\ntest = test[test.columns[1:]]","06e6d15e":"features = train.columns\ntrain['target'] = 0\ntest['target'] = 1","8869b72c":"features","44d4a066":"train_test = pd.concat([train, test], axis =0)\n\ntarget = train_test['target'].values","77868aa8":"param = {'num_leaves': 40,\n         'min_data_in_leaf': 30, \n         'objective':'binary',\n         'max_depth': 4,\n         'learning_rate': 0.006,\n         \"min_child_samples\": 20,\n         \"boosting\": \"gbdt\",\n         \"feature_fraction\": 0.9,\n         \"bagging_freq\": 1,\n         \"bagging_fraction\": 0.9 ,\n         \"bagging_seed\": 27,\n         \"metric\": 'auc',\n         \"verbosity\": -1}\n\nfolds = KFold(n_splits=5, shuffle=True, random_state=15)\noof = np.zeros(len(train_test))\n\n\nfor fold_, (trn_idx, val_idx) in enumerate(folds.split(train_test.values, target)):\n    print(\"fold n\u00b0{}\".format(fold_))\n    trn_data = lgb.Dataset(train_test.iloc[trn_idx][features], label=target[trn_idx])\n    val_data = lgb.Dataset(train_test.iloc[val_idx][features], label=target[val_idx])\n\n    num_round = 30000\n    clf = lgb.train(param, trn_data, num_round, valid_sets = [trn_data, val_data], verbose_eval=1000, early_stopping_rounds = 1400)\n    oof[val_idx] = clf.predict(train_test.iloc[val_idx][features], num_iteration=clf.best_iteration)","bfa31adc":"metrics.roc_auc_score(target, oof)","f80d7aa2":"Even though the local-leaderboard CV congruence is pretty good, it's far from perfect. Most of the discrepancy seems to be con","8d26dec2":"AUC of 0.53 is overall not a major issue, but it **is** slightly over 0.50, which can have an impact when you are chasing the 4th decimal point.\n","f34ec996":"Let's take a look at the overall oof CV AUC:"}}