{"cell_type":{"f11b33fa":"code","4d5c36ab":"code","07aee3d3":"code","824106de":"code","a641f3ef":"code","caf6bba6":"code","7c5178d1":"code","87277b64":"code","20bfa8ca":"code","2bcbaba6":"code","aa01e3e1":"code","921c4e32":"code","93049d0d":"code","d02894b8":"code","765829b0":"code","4fec1b66":"code","623aea22":"code","206a8a34":"code","29bb225e":"code","539c8a92":"code","a5ba9172":"code","3bafeea8":"code","d59c3b17":"code","77529e7d":"code","07d16577":"code","9faf73a1":"code","3d00e0c5":"code","cd8567c6":"code","3c284c2e":"code","ea0962e6":"code","b70c94ca":"code","cbff2b61":"code","0b02b178":"code","2a9059c9":"code","cd156fb9":"code","c89ed77c":"code","27d09bec":"code","8d9c7a39":"markdown","5d181c4a":"markdown","437d0b87":"markdown","d1cc04e7":"markdown","9a672013":"markdown","8b7f78d0":"markdown","45341404":"markdown","e9f0183c":"markdown","6188f06e":"markdown","d4448717":"markdown"},"source":{"f11b33fa":"#Import all the necessary modules\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn import metrics\nimport scipy.stats\nimport os\nprint(os.listdir(\"..\/input\"))\n","4d5c36ab":"wine_data = pd.read_csv('..\/input\/winequality-red.csv')","07aee3d3":"wine_data.info()","824106de":"# checking whether column has any value other than numeric value\nwine_data[~wine_data.applymap(np.isreal).all(1)]","a641f3ef":"# checking for nan\nwine_data.isin([np.nan]).any()","caf6bba6":"# grouping data based on quality\n# since the problem explains wine quality range from 0 to 6 as 'bad' & quality range from 7 to 10 as 'good'\nwine_data.groupby([\"quality\"]).count()","7c5178d1":"wine_data.head(10)","87277b64":"# since i am going to build a decission tree to predict the wine quality as good or bad \n# I am replacing the vaules\n# less than 7 and above 0 with '0' \n# greater than 6 and less than 11 with '1'\n\nwine_data['quality']=wine_data['quality'].replace(3,0)\nwine_data['quality']=wine_data['quality'].replace(4,0)\nwine_data['quality']=wine_data['quality'].replace(5,0)\nwine_data['quality']=wine_data['quality'].replace(6,0)\nwine_data['quality']=wine_data['quality'].replace(7,1)\nwine_data['quality']=wine_data['quality'].replace(8,1)","20bfa8ca":"# after replacing the quality col with '0' and '1' inferring the count of data based on good(1) and bad(0) quality\n# as we can see we have more data for bad quality wine and less data for good quality wine\n# so the model ability to predict bad quality wine will be better than to predict good quality wine\nwine_data.groupby([\"quality\"]).count()","2bcbaba6":"wine_data.columns","aa01e3e1":"wine_data.dtypes","921c4e32":"wine_data.shape","93049d0d":"wine_data.describe().transpose()","d02894b8":"# positive values denotes more data is distributed around the tails [chlorides,residual sugar,sulphates]\n# negative value denotes less data is distributed around the tails [citric acid]\nwine_data.kurtosis(numeric_only=True)","765829b0":"print(scipy.stats.mstats.normaltest(wine_data['chlorides']))\nprint(scipy.stats.kurtosis(wine_data['chlorides']))\nprint(scipy.stats.kurtosistest(wine_data['chlorides']))","4fec1b66":"# positive skew denotes right tail is longer\n# negative skew denotes left tail is longer\nwine_data.skew(numeric_only=True)","623aea22":"print(scipy.stats.skew(wine_data['chlorides']))\nprint(scipy.stats.skewtest(wine_data['chlorides']))","206a8a34":"sns.boxplot(x='chlorides',data=wine_data,orient='h')\n# as you can see it is right skewed","29bb225e":"sns.boxplot(x='residual sugar',data=wine_data,orient='h')\n# as you can see it is right skewed","539c8a92":"print(scipy.stats.mstats.normaltest(wine_data['citric acid']))\nprint(scipy.stats.kurtosis(wine_data['citric acid']))\nprint(scipy.stats.kurtosistest(wine_data['citric acid']))","a5ba9172":"print(scipy.stats.skew(wine_data['citric acid']))\nprint(scipy.stats.skewtest(wine_data['citric acid']))","3bafeea8":"sns.boxplot(x='citric acid',data=wine_data,orient='h')\n# kurtosis gives a negative value which means less data is distributed around the data","d59c3b17":"sns.boxplot(x='fixed acidity',data=wine_data,orient='h')","77529e7d":"sns.boxplot(x='pH',data=wine_data,orient='h')","07d16577":"sns.pairplot(wine_data, hue=\"quality\",diag_kind=\"kde\")","9faf73a1":"# Attributes which look normally distributed (density, pH).\n# Some of the attributes look like they may have an exponential distribution (residual sugar, chlorides ,etc).","3d00e0c5":"# finding the correlation with each and every feature\n\n# as you can see 'alcohol' is less highly correlated with the 'quality' of the wine when compared to other fetures\n# 'volatile acidity , chlorides , free sulfur dioxide , total sulfur dioxide , density & pH' are weakly correlated \n# with 'quality' of the wine\n\nwine_data.corr()","cd8567c6":"X = wine_data[['fixed acidity', 'volatile acidity', 'citric acid', 'residual sugar',\n       'chlorides', 'free sulfur dioxide', 'total sulfur dioxide', 'density',\n       'pH', 'sulphates', 'alcohol']]\nY = wine_data['quality']\nX_train, X_test, y_train, y_test = train_test_split(X, Y, test_size=0.30, random_state=7)","3c284c2e":"dt_model = DecisionTreeClassifier(criterion=\"entropy\")\ndt_model.fit(X_train,y_train)","ea0962e6":"print(dt_model.score(X_train , y_train))\nprint(dt_model.score(X_test , y_test))","b70c94ca":"y_predict = dt_model.predict(X_test)\nprint(metrics.confusion_matrix(y_test, y_predict))","cbff2b61":"from IPython.display import Image  \nfrom sklearn import tree\nfrom os import system\n\nCredit_Tree_File = open('wine_tree.dot','w')\ndot_data = tree.export_graphviz(dt_model, out_file=Credit_Tree_File, feature_names = list(X_train))\n\nCredit_Tree_File.close()\n","0b02b178":"print (pd.DataFrame(dt_model.feature_importances_, columns = [\"Imp\"], index = X_train.columns))","2a9059c9":"system(\"dot -Tpng wine_tree.dot -o wine_tree.png\")\nImage(\"wine_tree.png\")","cd156fb9":"dt_model = DecisionTreeClassifier(criterion = 'entropy',max_depth = 9)\ndt_model.fit(X_train, y_train)","c89ed77c":"Credit_Tree_File = open('wine_tree_regularized.dot','w')\n\ndot_data = tree.export_graphviz(dt_model, out_file=Credit_Tree_File, feature_names = list(X_train))\n\nCredit_Tree_File.close()\n\nsystem(\"dot -Tpng wine_tree_regularized.dot -o wine_tree_regularized.png\")\nImage(\"wine_tree_regularized.png\")","27d09bec":"print(dt_model.score(X_train , y_train))\nprint(dt_model.score(X_test , y_test))","8d9c7a39":"Let us assume the data frame is named wine_df\n","5d181c4a":"# Regularizing the decision tree by limiting the max. depth of trees and printing the accuracy.","437d0b87":"# Data Preprocessing","d1cc04e7":"The wine dataset is a classic and very easy multi-class classification dataset.\nFind more about data here - https:\/\/www.kaggle.com\/uciml\/red-wine-quality-cortez-et-al-2009","9a672013":"# Decision tree model using \u201centropy\u201d method of finding the split columns and fit it to training data.","8b7f78d0":"#  Load the Wine Data file into Python DataFrame. \n","45341404":"It is always a good practice to eye-ball raw data to get a feel of the data in terms of number of structure of the file, number of attributes, types of attributes and a general idea of likely challenges in the dataset.","e9f0183c":"# Using univariate analysis check the individual attributes for their basic statistic such as central values, spread, tails ","6188f06e":"# Problem Statement\n\nWine Quality Prediction-\nHere, we will apply a method of assessing wine quality using a decision tree, and test it against the wine-quality dataset from the UC Irvine Machine Learning Repository.\n\n","d4448717":"# Using pairplots and correlation method to observe the relationship between different variables and state your insights."}}