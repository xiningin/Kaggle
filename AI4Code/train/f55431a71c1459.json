{"cell_type":{"00f9f112":"code","6ef52e85":"code","885ba0c8":"code","c8c313d0":"code","1c17350e":"code","bb340250":"code","2d8cb9c4":"code","a1ab0b65":"code","cf9f5dc8":"code","19b612f9":"code","40aa5c25":"code","794853ad":"code","3baf9ec3":"code","aa97c49d":"code","51cf0c21":"code","33ea5456":"code","439b21e9":"code","5174995a":"code","7e775c94":"code","9dd85241":"code","c7883a7c":"code","6ac40b9f":"code","604d971e":"code","fa991213":"code","434b1481":"code","7fd7ec6c":"code","6961e2f3":"code","7890058c":"code","42c69676":"markdown","14744e6c":"markdown","c29894d2":"markdown","e890ba95":"markdown","400ba4f2":"markdown"},"source":{"00f9f112":"import pandas as pd\nimport seaborn as sb\nimport matplotlib.pyplot as plt","6ef52e85":"data = pd.read_csv('..\/input\/diamonds\/diamonds.csv',index_col=0)","885ba0c8":"data.head()","c8c313d0":"data.info()","1c17350e":"data.describe()","bb340250":"data.describe(include='O')","2d8cb9c4":"data.corr()","a1ab0b65":"data['cut'].value_counts()","cf9f5dc8":"data['color'].value_counts()","19b612f9":"data['clarity'].value_counts()","40aa5c25":"sb.violinplot(y='price',x='clarity',data=data)","794853ad":"sb.violinplot(y='price',x='cut',data=data)","3baf9ec3":"sb.displot(data=data,x='price',hue='cut',kind='kde',height=6,multiple=\"fill\",clip=(0,None),palette=\"ch:rot=-.25,hue=1,light=.75\")","aa97c49d":"features=['table','depth']\nsb.lineplot(data=data[features],palette=\"tab10\")","51cf0c21":"sb.displot(data=data,x=\"carat\", hue=\"cut\",kind=\"kde\", height=6,multiple=\"fill\", clip=(0, None),palette=\"ch:rot=-.25,hue=1,light=.75\",)","33ea5456":"sb.pairplot(data=data,hue='cut')\nplt.show()","439b21e9":"# converting categorical variables to dummy variables\ndata1 = pd.get_dummies(data)","5174995a":"data1.info()","7e775c94":"data1.head()","9dd85241":"from sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.metrics import mean_absolute_error\nfrom sklearn.metrics import r2_score","c7883a7c":"x = data1.drop(['price'],axis=1)","6ac40b9f":"y=data1['price']","604d971e":"x_train,x_test,y_train,y_test = train_test_split(x,y,random_state=4,test_size=0.3)","fa991213":"lin = LinearRegression()","434b1481":"lin.fit(x_train,y_train)","7fd7ec6c":"lin_pred = lin.predict(x_test)","6961e2f3":"sb.jointplot(x=y_test,y=lin_pred,kind='reg',line_kws={\"color\": \"red\"})\nplt.title('actual vs predicted output')\nplt.show()","7890058c":"print('Linear regression accuracy: ')\ncrossl = cross_val_score(estimator = lin, X = x_train, y = y_train, cv = 4,verbose = 0)\nmsel = mean_squared_error(y_test, lin_pred)\nrmsel = mean_squared_error(y_test, lin_pred)**0.5\nmael = mean_absolute_error(y_test, lin_pred)\nr2l = r2_score(y_test, lin_pred)\n\nprint('Cross val     : ',crossl)\nprint('MAE           : ', mael)\nprint('MSE (RMSE)    : ', msel,' (',rmsel,')')\nprint('R2 score      : ', r2l)","42c69676":"### This model predicts the diamonds price with 92% accuracy","14744e6c":"### plotting predicted vs actual price","c29894d2":"## Linear Regression","e890ba95":"## *visualizing trends between attributes*","400ba4f2":"# *Diamonds Price Prediction*\n\n![](https:\/\/www.anglodiamond.com\/media\/wysiwyg\/Anglo-DiamondAnatomy_03.jpg)\n\n### attribute information :\n*price* price in US dollars (\\$326--\\$18,823)\n\n*carat* weight of the diamond (0.2--5.01)\n\n*cut* quality of the cut (Fair, Good, Very Good, Premium, Ideal)\n\n*color* diamond colour, from J (worst) to D (best)\n\n*clarity* a measurement of how clear the diamond is (I1 (worst), SI2, SI1, VS2, VS1, VVS2, VVS1, IF (best))\n\n*x* length in mm (0--10.74)\n\n*y* width in mm (0--58.9)\n\n*z* depth in mm (0--31.8)\n\n*depth* total depth percentage = z \/ mean(x, y) = 2 * z \/ (x + y) (43--79)\n\n*table* width of top of diamond relative to widest point (43--95)"}}