{"cell_type":{"4a9e08bb":"code","0ab76799":"code","fe14ea61":"code","c8b73fc0":"code","e290b6ca":"code","381f39ca":"code","33bb3ab5":"code","333e950b":"code","d463859c":"code","097c3036":"code","63d7a010":"code","0a0ded81":"code","364d36c9":"code","d4dd9a3d":"code","6fc18aac":"code","f9b3e86e":"code","4baeb5b1":"code","65708a56":"code","e085cf7e":"code","0a312c61":"code","c9349dcc":"code","6b5d6927":"code","3e704035":"code","e966c152":"code","45c04a31":"code","98ebdecc":"code","06c97487":"code","4cc6032a":"code","ce937e3c":"code","c090ad78":"code","48c3894b":"code","8aeef1cb":"code","174a718a":"code","990e23d2":"code","2d57fe88":"code","f6315d95":"code","685033ec":"code","8ecd7be5":"code","585dfbeb":"code","f0fb0cd0":"code","3d98c45a":"code","5cc26b05":"code","8c2b86ea":"code","7e9eaa18":"code","15d2ff87":"code","5fe557f0":"code","41edf5b1":"code","85b6983f":"code","4e41542c":"code","270b37ab":"code","3f6998b6":"code","1c55d51d":"code","e26e4073":"code","48b852c4":"code","3e79b702":"markdown","e71e53b1":"markdown","c7e170fa":"markdown","88cd4f54":"markdown","577c4631":"markdown"},"source":{"4a9e08bb":"import pandas as pd\nimport numpy as np ","0ab76799":"Data=pd.DataFrame({'BMI':[75,126,63,154,187,106,110],'AGE':[38,52,40,45,55,30,50],'OUT':[0,1,0,1,1,0,0]})","fe14ea61":"Data","c8b73fc0":"B1=np.cov(Data['BMI'],Data['OUT'],ddof=1)\/np.var(Data['BMI'],ddof=1)\nB1=B1[1:,0]\nB1","e290b6ca":"B2=np.cov(Data['AGE'],Data['OUT'],ddof=1)\/np.var(Data['AGE'],ddof=1)\nB2=B2[1:,0]\nB2","381f39ca":"B0=np.mean(Data['OUT'])-(B1*np.mean(Data['BMI']))-(B2*np.mean(Data['AGE']))\nB0","33bb3ab5":"x=np.arange(-9,14)\nx","333e950b":"y=1\/(1+np.exp(-x))\ny","d463859c":"import matplotlib.pyplot as plt","097c3036":"plt.plot(x,y)","63d7a010":"k=B0+B1*(Data['BMI'])+B2*(Data['AGE'])","0a0ded81":"y=1\/(1+np.exp(-k))","364d36c9":"y","d4dd9a3d":"Data=pd.read_csv('..\/input\/pima-indians-diabetes-database\/diabetes.csv')","6fc18aac":"Data.head()","f9b3e86e":"x=Data.drop('Outcome',axis=1)\ny=Data[['Outcome']]","4baeb5b1":"import seaborn as sns","65708a56":"sns.heatmap(Data.corr(),annot=True)","e085cf7e":"Data.Outcome.value_counts()","0a312c61":"G=Data.groupby(['Outcome'])","c9349dcc":"g0=G.get_group(0)\ng0.shape","6b5d6927":"g1=G.get_group(1)\ng1.shape","3e704035":"Data.columns","e966c152":"x1=g0['Outcome']\nx2=g1['Outcome']","45c04a31":"from scipy.stats import ttest_ind","98ebdecc":"ttest_ind(x1,x2)","06c97487":"x=Data[['Pregnancies','Glucose','SkinThickness','Insulin','BMI','DiabetesPedigreeFunction','Age']]","4cc6032a":"y=Data['Outcome']","ce937e3c":"from sklearn.model_selection import train_test_split","c090ad78":"X_train,X_test,Y_train,Y_test=train_test_split(x,y,test_size=0.3,random_state=2)","48c3894b":"from sklearn.linear_model import LogisticRegression","8aeef1cb":"model=LogisticRegression()\nmodel.fit(X_train,Y_train)","174a718a":"y_pred=model.predict(X_test)","990e23d2":"from sklearn import metrics","2d57fe88":"cm=metrics.confusion_matrix(Y_test,y_pred) # standerd  Y_test,y_pred","f6315d95":"cm","685033ec":"#cm=metrics.confusion_matrix(y_pred,Y_test)","8ecd7be5":"TPR=31\/(45+31)\nTPR","585dfbeb":"FRP=19\/(136+19)\nFRP","f0fb0cd0":"#sensitivity\nTPR=(cm[1,1]\/cm[1,].sum())*100","3d98c45a":"TPR","5cc26b05":"TNR=(cm[0,0]\/cm[0,].sum())*100\nTNR","8c2b86ea":"from sklearn.metrics import roc_curve,auc","7e9eaa18":"fpr,tpr,_=roc_curve(Y_test,y_pred)\nroc_auc=auc(fpr,tpr)\nprint(roc_auc)\nplt.figure()\nplt.plot(fpr,tpr)\nplt.xlim([0.0,1.0])\nplt.ylim([0.0,1.0])\nplt.xlabel('FPR')\nplt.ylabel('TPR')\nplt.title('Receiver Operating Charecterstic')\nplt.show()","15d2ff87":"Data1=pd.DataFrame({'BMI':[7.5,12.6,63,15.4,18.7,10.6,11.0],'GENDER':['male','female','male','female','female','male','male'],'AGE':[38,52,40,45,55,30,50],'OUT':[0,1,0,1,1,0,0]})","5fe557f0":"Data1","41edf5b1":"from sklearn.preprocessing import LabelEncoder","85b6983f":"le=LabelEncoder()","4e41542c":"le.fit(Data1['GENDER'])\nData1['GENDER']=le.transform(Data1['GENDER'])","270b37ab":"Data1","3f6998b6":"Data.shape","1c55d51d":"x.shape","e26e4073":"from sklearn.model_selection import KFold","48b852c4":"kf=KFold (n_splits=5, shuffle=True, random_state=2)\nacc=[]\nau=[]\nfor train,test in kf.split(x,y):\n    M=LogisticRegression()\n    X_train,X_test=x.iloc[train,:],x.iloc[test,:]\n    Y_train,Y_test=y[train],y[test]\n    M.fit(X_train,Y_train)\n    Y_pred=M.predict(X_test)\n    acc.append(metrics.accuracy_score(Y_test,Y_pred))\n    fpr,tpr,_=roc_curve(Y_test,Y_pred)\n    au.append(auc(fpr,tpr))\nprint('cross VALIDATE AUC mean score %.2f%%'%np.mean(au))\nprint('cross VALIDATE AUC Variance score %.6f%%'%np.var(au,ddof=1))","3e79b702":"#### Shape of logistic curve","e71e53b1":"# Logistic regression","c7e170fa":"p Value for [BloodPreasure] =0.07151\np Value for [SkinThickness] =0.03834\np value for [Pregnancies]  = 5.065127298053476e-10\np value for [Glucose]      = 8.935431645289913e-43\np value for [Insulin]      = 0.00028618646\np value for [BMI]          = 1.2298074873116022e-16\np value for [DiabetesPedigreeFunction]= 1.254607010148809e-06\np value for [Age]          =2.2099754606654358e-11","88cd4f54":"now fitting the actual formula of logistic regression","577c4631":"here value above 0.5 taken as 1\nand below 0.5 taken as 0"}}