{"cell_type":{"3edf83ce":"code","6422f92d":"code","a71e2341":"code","6542fd9d":"code","240e68ab":"code","355afc98":"code","20735959":"code","0883d007":"code","82b2f95b":"code","3b3b0914":"code","4de7a4dd":"code","be8b5d51":"code","817a56a7":"code","22e7fa68":"code","78d70c06":"code","90e0e0b8":"code","2b542270":"code","6f3e973e":"code","c884705f":"code","3cf6096c":"code","c4fd515b":"code","0a7baf6d":"code","54179e63":"code","4b796b40":"markdown","f14344bf":"markdown","ee43dee9":"markdown","6a0816d6":"markdown","1e1edf80":"markdown","24176df6":"markdown","13edb022":"markdown","1d334ef7":"markdown","4843a026":"markdown","260442a0":"markdown","db12f1bc":"markdown","c2eb9777":"markdown","bf309442":"markdown","04e3de6b":"markdown","1e45b7d5":"markdown","8fe340e2":"markdown","e4689cfd":"markdown","bcddad35":"markdown"},"source":{"3edf83ce":"import pandas as pd \r\nimport numpy as np\r\nfrom pandas import DataFrame, Series\r\nimport matplotlib.pyplot as plt\r\nimport plotly.express as px","6422f92d":"netflix = pd.read_csv('..\/input\/netflix-shows\/netflix_titles.csv')","a71e2341":"netflix.info()","6542fd9d":"netflix['date_added'] = pd.to_datetime(netflix['date_added'])\r\nnetflix.info()","240e68ab":"netflix.head()","355afc98":"missing_value_count = netflix.isnull().sum()\r\n\r\nmissing_value_count","20735959":"show_number = netflix.type.value_counts()\r\nshow_number = pd.DataFrame(show_number).reset_index()\r\nshow_number.columns = ['type','number']\r\nshow_number","0883d007":"kids = [ 'TV-Y', 'G','TV-Y7','TV-Y7-FV', 'TV-G', 'PG', 'TV-PG']\r\nteens = [ 'PG-13', 'TV-14']\r\nadults = [ 'R', 'TV-MA', 'NC-17']\r\n\r\nnetflix_rating = pd.DataFrame(netflix ['rating'],columns = ['rating'])\r\n\r\ndef age(x):\r\n    if x in kids:\r\n        return 'Kids'\r\n    elif x in teens:\r\n        return 'Teens'\r\n    elif x in adults:\r\n        return 'Adults'\r\n    else:\r\n        return 'Not Rated'\r\n\r\nnetflix_rating['ages'] = netflix['rating'].apply(age)\r\n\r\nnetflix_rating","82b2f95b":"nr = netflix_rating.groupby(['rating','ages']).agg(number=('rating','count')).sort_values(by= 'ages').reset_index()\r\nnr","3b3b0914":"fig = px.sunburst(nr,path = ['ages','rating'],values = 'number')\r\nfig.show()","4de7a4dd":"netflix['listed_in'].head(3)","be8b5d51":"df = netflix\r\n#split rows and put to new dataframe\r\nnew_df = pd.DataFrame(df.listed_in.str.split(',').tolist()).stack()\r\nnew_df = pd.DataFrame(new_df).reset_index()\r\nnew_df.columns = ['a','b','genre']\r\nnew_df.drop(columns=['a','b'],inplace= True)\r\nnew_df['genre'] = new_df['genre'].str.strip()\r\nnew_df[:5]","817a56a7":"genre = pd.DataFrame(new_df[['genre']].value_counts()).reset_index()\r\ngenre.columns = ['genre','number']\r\ngenre[:10]","22e7fa68":"fig = px.bar(genre[:10],x='genre',y='number')\r\nfig.show()","78d70c06":"netflix['country'] = netflix['country'].fillna(\"null\")\r\nnetflix_country=pd.concat([Series(row['date_added'], row['country'].split(','))              \r\n                    for _, row in netflix.iterrows()]).reset_index()\r\nnetflix_country.columns = ['country','date_added']\r\nnetflix_country","90e0e0b8":"netflix_country['country'] = netflix_country['country'].str.strip()\r\nshows_by_country = netflix_country['country'].value_counts().to_frame().reset_index()\r\nshows_by_country.columns = ['country','shows']\r\nshows_by_country","2b542270":"shows_by_country.drop([3])","6f3e973e":"netflix_country = netflix_country.sort_values(by='date_added',ascending=False)\r\nnetflix_country['n'] = 1\r\ndate_country = netflix_country.groupby(['country','date_added']).sum().groupby(level=0).cumsum().reset_index()\r\ndate_country.sort_values(by = 'n')\r\n","c884705f":"netflix_country[netflix_country['country']=='United States']","3cf6096c":"date_country[date_country['date_added'].isnull()]","c4fd515b":"netflix_country[netflix_country['date_added'].isnull()]","0a7baf6d":"netflix_country['date_added'].fillna(pd.Timestamp('20140101'),inplace=True)\r\ndate_country = netflix_country.groupby(['country','date_added']).sum().groupby(level=0).cumsum().reset_index()\r\npd.DataFrame(date_country.groupby(['country'])['n'].max()).sort_values('n',ascending = False)","54179e63":"top10_country = shows_by_country[:10].set_index('country')\r\ndc = date_country[date_country['country'].isin(top10_country.index.tolist())]\r\nfig = px.line(dc,x='date_added',y='n',color = 'country')\r\nfig.show()\r\n","4b796b40":"## 3.Genre","f14344bf":"Country column have the same issue as genre one so i do the same thing with a bit difference method.","ee43dee9":"Replace NaT with 22\/10\/2009 (When Netflix Originals was launched).","6a0816d6":"Shows have multiple genre so i will split them into multiple rows.","1e1edf80":"have a look at data","24176df6":"date_added with NAT value is very suspicious.","13edb022":"count shows number for each rating","1d334ef7":"Shows number on the last rows(index=5005) for 'United States' is supposed to be 3297. It might be some problem on 'date_added' column.","4843a026":"It worked.","260442a0":"## 4.Country (making shows) ","db12f1bc":"Make visualization.","c2eb9777":"delete null row. (index =3)","bf309442":"## Netflix Show Data Exploatory Analysis","04e3de6b":"### Data Exploration  ","1e45b7d5":"## 2.Rating\r\n","8fe340e2":"## 1. Number of Shows","e4689cfd":"I also did same thing with SQL and then visualize with Tableau.\n\nSQL query code : [Click here](https:\/\/github.com\/saradpokleeb\/Netflix-Show-Data-Exploratory-Analysis\/blob\/main\/netflix.sql) <br \/>\nVisualization with Tableau : [Click here](https:\/\/public.tableau.com\/app\/profile\/sarad.pokleeb\/viz\/netflix_16289386537490\/Dashboard1)","bcddad35":"Data in the 'rating' column is quite confusing.So i make 'age' column with value ('Kids' or 'Teens' or 'Adult')."}}