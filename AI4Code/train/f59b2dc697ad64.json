{"cell_type":{"99a4b092":"code","db9975f9":"code","2d6360dd":"code","497741c2":"code","7f87b305":"code","8ada38f3":"code","a51975a4":"code","235251b7":"code","910447c8":"code","06d9916a":"code","d3718270":"code","50ba49ca":"code","5a7cd789":"code","2f134698":"code","b508c8cd":"code","09875bd2":"code","2850c9b4":"code","7f8c8a68":"code","829f8b0b":"code","5bace41e":"code","771665d5":"code","88460f40":"code","5596bdeb":"code","34a93647":"code","d4711fde":"code","2fa9a081":"code","434acdd1":"code","4ecec040":"code","abab2937":"code","28e99f02":"code","da81ce17":"code","a81b7ecd":"code","b4331299":"code","35d33302":"code","b6d1c138":"code","9c77e4da":"markdown","ef7fd45e":"markdown","ab668736":"markdown"},"source":{"99a4b092":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","db9975f9":"import pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport numpy as np\nimport seaborn as sns","2d6360dd":"train=pd.read_csv(\"..\/input\/tabular-playground-series-jan-2022\/train.csv\")\ntrain","497741c2":"test=pd.read_csv(\"..\/input\/tabular-playground-series-jan-2022\/test.csv\")\ntest","7f87b305":"sample_submission=pd.read_csv(\"..\/input\/tabular-playground-series-jan-2022\/sample_submission.csv\")\nsample_submission","8ada38f3":"train.describe()","a51975a4":"sns.countplot(x=\"country\",data=train)","235251b7":"sns.countplot(x=\"store\",data=train)","910447c8":"sns.countplot(x=\"product\",data=train)","06d9916a":"sns.countplot(x=\"product\",hue=\"country\",data=train)","d3718270":"sns.histplot(x=\"country\",y=\"num_sold\",data=train)","50ba49ca":"train.isnull().sum()","5a7cd789":"test.isnull().sum()","2f134698":"train_upd=train.drop([\"row_id\",\"date\"],axis=1)\ntrain_upd","b508c8cd":"dummy_data=pd.get_dummies(train_upd,columns=[\"country\",\"store\",\"product\"])\ndummy_data","09875bd2":"#dropping dummies of Finland, Kaggle_Mart, Kaggle_Hat to avoid dummy variable \nFinal_data=dummy_data.drop([\"country_Finland\",\"store_KaggleMart\",\"product_Kaggle Hat\"],axis=1)\nFinal_data","2850c9b4":"X=Final_data.drop([\"num_sold\"],axis=1)\ny=Final_data.num_sold","7f8c8a68":"#from sklearn.model_selection import train_test_split\n#X_train,X_test,y_train,y_test=train_test_split(X,y,train_size=0.80)\n#X_train.shape,X_test.shape,y_train.shape,y_test.shape","829f8b0b":"#from sklearn.ensemble import RandomForestClassifier\n#rf=RandomForestClassifier(n_estimators=88,bootstrap=True)\n#rf.fit(X,y)\n#pred=rf.predict(X)","5bace41e":"n_estimators=[int(x) for x in np.linspace(start=10,stop=110,num=10)]\nmax_features=[\"auto\",\"sqrt\"]\nmax_depth=[2,6]\nbootstrap=[True,False]","771665d5":"random_grid={\"n_estimators\": n_estimators, \n            \"max_features\": max_features, \n          \"max_depth\": max_depth,\n            \"bootstrap\": bootstrap }\nprint(random_grid)\n","88460f40":"from sklearn.ensemble import RandomForestClassifier\nmodel=RandomForestClassifier() \nfrom sklearn.model_selection import GridSearchCV\ngrid= GridSearchCV(estimator=model, param_grid=random_grid, cv=4,verbose=2,n_jobs=3)\ngrid.fit(X,y)\ngrid.best_params_","5596bdeb":"grid.score(X,y)","34a93647":"#pred.shape","d4711fde":"#y.shape,X.shape","2fa9a081":"#from sklearn.metrics import accuracy_score\n#accuracy_score(pred,y)","434acdd1":"test_data=test.drop([\"row_id\",\"date\"],axis=1)\ntest_data","4ecec040":"test_dummy=pd.get_dummies(test_data,columns=[\"country\",\"store\",\"product\"])\ntest_dummy","abab2937":"# droping one dummy of each country_Finland, store_KaggleMart, product_Kaggle Hat to avoid dummy variable trap\nfinal_test=test_dummy.drop([\"country_Finland\",\"store_KaggleMart\",\"product_Kaggle Hat\"],axis=1)\nfinal_test","28e99f02":"prediction=grid.predict(final_test)\nprediction","da81ce17":"submission=pd.DataFrame(prediction,columns=[\"num_sold\"])\nsubmission","a81b7ecd":"sample_submission=sample_submission.drop([\"num_sold\"],axis=1)\nsample_submission","b4331299":"submission=pd.concat([sample_submission,submission],axis=1)\nsubmission","35d33302":"submission.to_csv(\"submission.csv\",index=False)","b6d1c138":"!kaggle competitions submit -c tabular-playground-series-jan-2022 -f submission.csv -m \"Message\"","9c77e4da":"# Data Preprocessing","ef7fd45e":"# Reading Data","ab668736":"# Exploratory Data Analysis"}}