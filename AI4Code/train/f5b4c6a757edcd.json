{"cell_type":{"ede5ba44":"code","2158ea36":"code","d042cac4":"code","93812508":"code","6c57a059":"code","c0f215bf":"code","6f231c3c":"code","46c559a3":"code","cedbd6ad":"code","177cbf9c":"code","cd3a2d6b":"code","fe8a9a1f":"code","d3bd1943":"code","91357acc":"code","d2bf71fb":"code","94dcb4e0":"code","c05720e4":"code","8288c4b4":"code","87c4f03b":"code","a29ddd0b":"code","95e99ab5":"code","088ab5c3":"code","1295acbd":"code","bc08450d":"code","203c385a":"code","054e99d8":"code","a52b37a9":"code","95add10e":"code","b22e1ae7":"code","abdc0c52":"code","70365e01":"code","5589e238":"code","a7437be4":"code","dff5f213":"code","595c718b":"code","0448b205":"code","93f122b9":"code","e23e63c4":"markdown","32c6bebe":"markdown","d7cdbfdc":"markdown","afdaf027":"markdown","3df842f8":"markdown","88e494ba":"markdown","26202c55":"markdown","325fc1a1":"markdown","8f83af28":"markdown","81069c7c":"markdown","7703950c":"markdown","26d48388":"markdown","99e15b41":"markdown","b3afe516":"markdown","ef5b3a93":"markdown","3667286e":"markdown","daef0551":"markdown","da76467c":"markdown","59691be4":"markdown","5b8bf64d":"markdown","ef7241f4":"markdown","cedb8db3":"markdown","939486ac":"markdown"},"source":{"ede5ba44":"import numpy as np\nimport numpy.linalg as la\nimport matplotlib.pyplot as plt\nfrom mpl_toolkits.mplot3d import Axes3D\nfrom scipy.integrate import odeint\nimport pandas as pd","2158ea36":"pop_0 = [10, 0, 1]","d042cac4":"t = np.linspace(0, 100, num=1000)\nlambda_ = 1.5\nd = 0.4\nk = 0.2\ndelta = 0.6\np = 1.1\nc = 0.4\nparams = [lambda_, d, k, delta, p, c]","93812508":"def model(population, t, params):\n    T = population[0]\n    I = population[1]\n    V = population[2]\n    \n    lambda_ = params[0]\n    d = params[1]\n    k = params[2]\n    delta = params[3]\n    p = params[4]\n    c = params[5]\n    \n    T_ = lambda_ - (d * T) - k*V*T\n    I_ = k*V*T - delta*I\n    V_ = p*I - c*V\n    \n    return [T_, I_, V_]","6c57a059":"y = odeint(model, pop_0, t, args=(params,))","c0f215bf":"plt.plot(y)\nplt.xlabel(\"Time\")\nplt.ylabel(\"Population\")\nplt.title(\"Solution Curve\")\nplt.legend([\"Target cell\", \"Infected cell\", \"Virion\"])","6f231c3c":"fig = plt.figure()\nax = fig.gca(projection='3d')\nax.plot(y[:,0],y[:,1],y[:,2])\nax.set_xlabel('Target cells')\nax.set_ylabel('Infected cells')\nax.set_zlabel('Virions')\nax.text(y[0][0], y[0][1], y[0][2], \"Initial State\", color = \"red\")\nplt.title('Solution Trajectory')","46c559a3":"pop_0 = [10, 0, 1]\npop_1 = [8, 2, 1]\npop_2 = [5, 5, 1]\npop_3 = [2, 8, 1]\nt = np.linspace(0, 50, num=400)","cedbd6ad":"y0 = odeint(model, pop_0, t, args=(params,))\ny1 = odeint(model, pop_1, t, args=(params,))\ny2 = odeint(model, pop_2, t, args=(params,))\ny3 = odeint(model, pop_3, t, args=(params,))","177cbf9c":"plt.plot(y0[:,0])\nplt.plot(y1[:,0])\nplt.plot(y2[:,0])\nplt.plot(y3[:,0])\nplt.title(\"Trend of Target Cells with Time\")\nplt.xlabel(\"Time\")\nplt.ylabel(\"Population of Target Cells\")\nplt.legend([\"10T-0I\",\"8T-2I\", \"5T-5I\", \"2T-8I\"])","cd3a2d6b":"plt.plot(y0[:,1])\nplt.plot(y1[:,1])\nplt.plot(y2[:,1])\nplt.plot(y3[:,1])\nplt.title(\"Trend of Infected Cells with Time\")\nplt.xlabel(\"Time\")\nplt.ylabel(\"Population of Infected Cells\")\nplt.legend([\"10T-0I\",\"8T-2I\", \"5T-5I\", \"2T-8I\"])","fe8a9a1f":"fig = plt.figure()\nax = fig.gca(projection='3d')\nax.plot(y0[:,0],y0[:,1],y0[:,2])\nax.plot(y1[:,0],y1[:,1],y1[:,2])\nax.plot(y2[:,0],y2[:,1],y2[:,2])\nax.plot(y3[:,0],y3[:,1],y3[:,2])\nax.set_xlabel('Target cells')\nax.set_ylabel('Infected cells')\nax.set_zlabel('Virions')\nax.text(y0[-1][0], y[-1][1], y[-1][2], \"Final State\")\nplt.title('Solution Trajectory')\nplt.legend([\"10T-0I\",\"8T-2I\", \"5T-5I\", \"2T-8I\"])","d3bd1943":"pop_v1 = [8, 2, 1]\npop_v2 = [8, 2, 2]\npop_v3 = [8, 2, 3]\npop_v4 = [8, 2, 4]\npop_v5 = [8, 2, 5]","91357acc":"y_v1 = odeint(model, pop_v1, t, args=(params,))\ny_v2 = odeint(model, pop_v2, t, args=(params,))\ny_v3 = odeint(model, pop_v3, t, args=(params,))\ny_v4 = odeint(model, pop_v4, t, args=(params,))\ny_v5 = odeint(model, pop_v5, t, args=(params,))","d2bf71fb":"plt.plot(y_v1[:,0])\nplt.plot(y_v2[:,0])\nplt.plot(y_v3[:,0])\nplt.plot(y_v4[:,0])\nplt.plot(y_v5[:,0])\nplt.title(\"Trend of Target Cells with Time\")\nplt.xlabel(\"Time\")\nplt.ylabel(\"Population of Target Cells\")\nplt.legend([\"1V\", \"2V\", \"3V\", \"4V\", \"5V\"])","94dcb4e0":"plt.plot(y_v1[:,1])\nplt.plot(y_v2[:,1])\nplt.plot(y_v3[:,1])\nplt.plot(y_v4[:,1])\nplt.plot(y_v5[:,1])\nplt.title(\"Trend of Infected Cells with Time\")\nplt.xlabel(\"Time\")\nplt.ylabel(\"Population of Infected Cells\")\nplt.legend([\"1V\", \"2V\", \"3V\", \"4V\", \"5V\"])","c05720e4":"plt.plot(y_v1[:,2])\nplt.plot(y_v2[:,2])\nplt.plot(y_v3[:,2])\nplt.plot(y_v4[:,2])\nplt.plot(y_v5[:,2])\nplt.title(\"Trend of Virions with Time\")\nplt.xlabel(\"Time\")\nplt.ylabel(\"Population of Virions\")\nplt.legend([\"1V\", \"2V\", \"3V\", \"4V\", \"5V\"])","8288c4b4":"fig = plt.figure()\nax = fig.gca(projection='3d')\nax.plot(y_v1[:,0],y_v1[:,1],y_v1[:,2])\nax.plot(y_v2[:,0],y_v2[:,1],y_v2[:,2])\nax.plot(y_v3[:,0],y_v3[:,1],y_v3[:,2])\nax.plot(y_v4[:,0],y_v4[:,1],y_v4[:,2])\nax.plot(y_v5[:,0],y_v5[:,1],y_v5[:,2])\nax.set_xlabel('Target cells')\nax.set_ylabel('Infected cells')\nax.set_zlabel('Virions')\nax.text(y_v1[-1][0], y_v1[-1][1], y_v1[-1][2], \"Final State\")\nplt.title('Solution Trajectory')\nplt.legend([\"1V\", \"2V\", \"3V\", \"4V\", \"5V\"])","87c4f03b":"fig = plt.figure()\nax = fig.gca(projection='3d')\nax.plot(y_v1[:,0],y_v1[:,1],y_v1[:,2])\nax.plot(y_v2[:,0],y_v2[:,1],y_v2[:,2])\nax.plot(y_v5[:,0],y_v5[:,1],y_v5[:,2])\nax.plot(y0[:,0],y0[:,1],y0[:,2])\nax.plot(y2[:,0],y2[:,1],y2[:,2])\nax.plot(y3[:,0],y3[:,1],y3[:,2])\nplt.legend([\"8T-2I-1V\", \"8T-2I-2V\", \"8T-2I-5V\",\n           \"10T-0I-1V\", \"5T-5I-1V\", \"2T-8I-1V\"])\nax.set_xlabel('Target cells')\nax.set_ylabel('Infected cells')\nax.set_zlabel('Virions')\nax.text(y_v1[-1][0], y_v1[-1][1], y_v1[-1][2], \"Final State\")","a29ddd0b":"lambda_ = 1.2\nd = 0.2\nk = 0.4\ndelta = 0.3\np = 1\nc = 0.3\nparams2 = [lambda_, d, k, delta, p, c]","95e99ab5":"y0 = odeint(model, [10, 10, 10], t, args=(params,))\ny1 = odeint(model, [15, 15, 11], t, args=(params,))\ny2 = odeint(model, [20, 20, 12], t, args=(params,))\n\ny0_p2 = odeint(model, [8, 15, 10], t, args=(params2,))\ny1_p2 = odeint(model, [20, 10, 11], t, args=(params2,))\ny2_p2 = odeint(model, [15, 25, 12], t, args=(params2,))","088ab5c3":"plt.plot(y0[:,2], c=\"red\")\nplt.plot(y1[:,2], c=\"red\")\nplt.plot(y2[:,2], c=\"red\")\n\nplt.plot(y0_p2[:,2], c=\"blue\")\nplt.plot(y1_p2[:,2], c=\"blue\")\nplt.plot(y2_p2[:,2], c=\"blue\")\n\nplt.title(\"Trend of Virions with Time\")\nplt.xlabel(\"Time\")\nplt.ylabel(\"Population of Virions\")","1295acbd":"fig = plt.figure()\nax = fig.gca(projection='3d')\nax.plot(y0[:,0],y0[:,1],y0[:,2], c='red')\nax.plot(y1[:,0],y1[:,1],y1[:,2], c='red')\nax.plot(y2[:,0],y2[:,1],y2[:,2], c='red')\nax.plot(y0_p2[:,0],y0_p2[:,1],y0_p2[:,2], c='blue')\nax.plot(y1_p2[:,0],y1_p2[:,1],y1_p2[:,2], c='blue')\nax.plot(y2_p2[:,0],y2_p2[:,1],y2_p2[:,2], c='blue')\nax.text(y0[-1][0], y0[-1][1], y0[-1][2], \"Final State 1\")\nax.text(y0_p2[-1][0], y0_p2[-1][1], y0_p2[-1][2], \"Final State 2\")\nax.set_xlabel('Target cells')\nax.set_ylabel('Infected cells')\nax.set_zlabel('Virions')","bc08450d":"fig = plt.figure()\nax = fig.gca(projection='3d')\nax.plot(y0[:,1],y0[:,0],y0[:,2], c='red')\nax.plot(y1[:,1],y1[:,0],y1[:,2], c='red')\nax.plot(y2[:,1],y2[:,0],y2[:,2], c='red')\nax.plot(y0_p2[:,1],y0_p2[:,0],y0_p2[:,2], c='blue')\nax.plot(y1_p2[:,1],y1_p2[:,0],y1_p2[:,2], c='blue')\nax.plot(y2_p2[:,1],y2_p2[:,0],y2_p2[:,2], c='blue')\nax.set_ylabel('Target cells')\nax.set_xlabel('Infected cells')\nax.set_zlabel('Virions')\nax.text(y0[-1][0], y0[-1][1], y0[-1][2], \"Final State 1\")\nax.text(y0_p2[-1][0], y0_p2[-1][1], y0_p2[-1][2], \"Final State 2\")","203c385a":"fig = plt.figure()\nax = fig.gca(projection='3d')\nax.plot(y0[:,0],y0[:,2],y0[:,1], c='red')\nax.plot(y1[:,0],y1[:,2],y1[:,1], c='red')\nax.plot(y2[:,0],y2[:,2],y2[:,1], c='red')\nax.plot(y0_p2[:,0],y0_p2[:,2],y0_p2[:,1], c='blue')\nax.plot(y1_p2[:,0],y1_p2[:,2],y1_p2[:,1], c='blue')\nax.plot(y2_p2[:,0],y2_p2[:,2],y2_p2[:,1], c='blue')\nax.set_xlabel('Target cells')\nax.set_zlabel('Infected cells')\nax.set_ylabel('Virions')\nax.text(y0[-1][0], y0[-1][1], y0[-1][2], \"Final State 1\")\nax.text(y0_p2[-1][0], y0_p2[-1][1], y0_p2[-1][2], \"Final State 2\")","054e99d8":"t = np.linspace(0, 100, num=1000)\nlambda_ = 1.5\nd = 0.4\nepsilon_rt = 0.4\nk = 0.2\ndelta = 0.6\nepsilon_pi = 0.4\np = 1.1\nc = 0.4\nparams_inhib = [lambda_, d, epsilon_rt, k, delta, epsilon_pi, p, c]","a52b37a9":"def model_inhib(population, t, params_inhib):\n    T = population[0]\n    I = population[1]\n    V = population[2]\n    \n    lambda_ = params_inhib[0]\n    d = params_inhib[1]\n    epsilon_rt = params_inhib[2]\n    k = params_inhib[3]\n    delta = params_inhib[4]\n    epsilon_pi = params_inhib[5]\n    p = params_inhib[6]\n    c = params_inhib[7]\n    \n    T_ = lambda_ - (d * T) - (1-epsilon_rt)*k*V*T\n    I_ = (1-epsilon_rt)*k*V*T - delta*I\n    V_ = (1-epsilon_pi)*p*I - c*V\n    \n    return [T_, I_, V_]","95add10e":"pop_0 = [10, 0, 2]","b22e1ae7":"y = odeint(model, pop_0, t, args=(params,))\ny_inhib = odeint(model_inhib, pop_0, t, args=(params_inhib,))","abdc0c52":"plt.plot(y[:,2])\nplt.plot(y_inhib[:,2])\nplt.title(\"Infecting Viral Particle Trends\")\nplt.xlabel(\"Time\")\nplt.ylabel(\"Virions\")\nplt.legend([\"No inhibitor\", \"Inhibitor\"])","70365e01":"fig = plt.figure()\nax = fig.gca(projection='3d')\nax.plot(y[:,0],y[:,1],y[:,2])\nax.plot(y_inhib[:,0],y_inhib[:,1],y_inhib[:,2])\nax.set_xlabel('Target cells')\nax.set_ylabel('Infected cells')\nax.set_zlabel('Virions')\nplt.title('Solution Trajectory')\nplt.legend([\"No inhibitor\", \"Inhibitor\"])\nax.text(y[0][0], y[0][1], y[0][2], \"Same Initial State\", color = \"red\")","5589e238":"lambda_ = 0.3\nd = 0.8\nk = 0.1\ndelta = 0.7\np = 0.5\nc = 0.8\nparams = [lambda_, d, k, delta, p, c]","a7437be4":"y0 = odeint(model, [8,15,10], t, args=(params,))\ny1 = odeint(model, [10,10,20],t, args=(params,))\ny2 = odeint(model, [20,19,20],t, args=(params,))","dff5f213":"fig = plt.figure()\nax = fig.gca(projection='3d')\nax.plot(y0[:,0],y0[:,1],y0[:,2], c='red')\nax.plot(y1[:,0],y1[:,1],y1[:,2], c='red')\nax.plot(y2[:,0],y2[:,1],y2[:,2], c='red')\nax.plot(y0_p2[:,0],y0_p2[:,1],y0_p2[:,2], c='blue')\nax.plot(y1_p2[:,0],y1_p2[:,1],y1_p2[:,2], c='blue')\nax.plot(y2_p2[:,0],y2_p2[:,1],y2_p2[:,2], c='blue')\nax.set_xlabel('Target cells')\nax.set_ylabel('Infected cells')\nax.set_zlabel('Virions')\nax.text(y0[-1][0], y0[-1][1], y0[-1][2], \"P1\")\nax.text(y2_p2[-1][0], y2_p2[-1][1], y2_p2[-1][2], \"P2\")\nplt.title('Solution Trajectory')","595c718b":"abs(y0[-1] - [-lambda_\/d,0,0])","0448b205":"fig = plt.figure()\nax = fig.gca(projection='3d')\nax.plot(y0[:,1],y0[:,0],y0[:,2], c='red')\nax.plot(y1[:,1],y1[:,0],y1[:,2], c='red')\nax.plot(y2[:,1],y2[:,0],y2[:,2], c='red')\nax.plot(y0_p2[:,1],y0_p2[:,0],y0_p2[:,2], c='blue')\nax.plot(y1_p2[:,1],y1_p2[:,0],y1_p2[:,2], c='blue')\nax.plot(y2_p2[:,1],y2_p2[:,0],y2_p2[:,2], c='blue')\nax.set_xlabel('Infected cells')\nax.set_ylabel('Target cells')\nax.set_zlabel('Virions')\nax.text(y0[-1][0], y0[-1][1], y0[-1][2], \"P1\")\nax.text(y2_p2[-1][0], y2_p2[-1][1], y2_p2[-1][2], \"P2\")\nplt.title('Solution Trajectory')","93f122b9":"fig = plt.figure()\nax = fig.gca(projection='3d')\nax.plot(y0[:,0],y0[:,2],y0[:,1], c='red')\nax.plot(y1[:,0],y1[:,2],y1[:,1], c='red')\nax.plot(y2[:,0],y2[:,2],y2[:,1], c='red')\nax.plot(y0_p2[:,0],y0_p2[:,2],y0_p2[:,1], c='blue')\nax.plot(y1_p2[:,0],y1_p2[:,2],y1_p2[:,1], c='blue')\nax.plot(y2_p2[:,0],y2_p2[:,2],y2_p2[:,1], c='blue')\nax.set_xlabel('Target cells')\nax.set_ylabel('Virions')\nax.set_zlabel('Infected cells')\nax.text(y0[-1][0], y0[-1][1], y0[-1][2], \"P1\")\nax.text(y2_p2[-1][0], y2_p2[-1][1], y2_p2[-1][2], \"P2\")\nplt.title('Solution Trajectory')","e23e63c4":"There are 3 entities in the dynamics, the Target cells (T), the Virion (V) and the Infected cells (I). The rate of death of an infected cell is $\\delta$. Target cells are born at the rate of $\\lambda$ per cell and die at the rate of $d$ per cell. The rate of infection (i.e., transition from target cell to infected cell is $k$ and the rate of production of new virions is $p$.The clearance rate (per virion) is $c$. This dynamic is exhibited by:\n\n$$ \\frac{dT}{dt} = \\lambda - dT - kVT $$\n\n$$ \\frac{dI}{dt} = kVT - \\delta I $$\n\n$$ \\frac{dV}{dt} = pI - cV $$","32c6bebe":"An interesting question to ask here would be, \"Does the number of virions converge too?\" This is particularly an interesting question since we start with different number of virions initially.","d7cdbfdc":"I am starting to think that one will reach the same point, no matter where one starts.","afdaf027":"Experimentally, it was observed that the final state converges at point, i.e., the derivatives don't change. Therefore, all the three differential equations are equal to 0 (considering the one without viral inhibitors).\n\n$$ \\frac{dT}{dt} = \\lambda - dT - kVT = 0 $$\n\n$$ \\frac{dI}{dt} = kVT - \\delta I = 0 $$\n\n$$ \\frac{dV}{dt} = pI - cV = 0 $$\n\nThis means that $ pI = cV $, or $ I = \\frac{cV}{p} $\n\nFurther, $ kVT = \\delta I $, so, $ \\lambda - dT - \\delta I = 0 $\n\nso $ T = \\frac{\\lambda p - \\delta cV}{pd} $\n\nHowever, $ T = \\frac{\\delta I}{kV} = \\frac{\\delta cV}{pkV} = \\frac{\\delta c}{pk} $\n\nFrom both the equations of T, we get, $ V = \\frac{\\lambda p}{\\delta c} - d $\n\nand thus, $ I = \\frac{cV}{p} = \\frac{c}{p}(\\frac{\\lambda p}{\\delta c} - d) $\n\nSo, the two solutions are:\n\n$$ (\\frac{\\lambda}{d}, 0, 0) $$ and\n\n$$ (\\frac{\\delta c}{pk}, \\frac{\\lambda}{\\delta} - \\frac{cd}{p}, \\frac{\\lambda p}{\\delta c} - d) $$\n","3df842f8":"# Reproduction Rate for System Aggressivity","88e494ba":"We see that the numbers of target cells, infected cells and virions converge towards constants for large time as seen in the solution curve. This is further corroborated through the solution trajectory which converges towards a point.","26202c55":"# Dynamics without Viral Inhibitors","325fc1a1":"## Varying the Parameters of the Dynamics","8f83af28":"## Varying Initial Distributions of Target and Infected Cells","81069c7c":"Evidently, even though we start with different virion populations, we observe a convergence of the number of virions.","7703950c":"Antiretroviral drugs work in two ways, i.e. they have two kinds of inhibitors:\n1. Reverse Transcriptase (RT) helps in preventing a target cell from getting infected (efficacy = $\\epsilon_{RT}$).\n2. Protease Inhibitors (PI) facilitate the production of non-infectious viral particles (efficacy = $\\epsilon_{PI}$).\n\nSo we can say that we can inhibit right at the source (PI) as well as, prevent the cells from getting infected by the remaining infecting particles. Thus, the above dynamics change slightly.\n\n\n$$ \\frac{dT}{dt} = \\lambda - dT - (1-\\epsilon_{RT})kV_IT $$\n\n$$ \\frac{dI}{dt} = (1-\\epsilon_{RT})kVT - \\delta I $$\n\n$$ \\frac{dV_I}{dt} = (1-\\epsilon_{PI})pI - cV_I $$\n\n$$ \\frac{dV_{NI}}{dt} = \\epsilon_{PI}pI - cV_{NI} $$\n\n","26d48388":"Note that since the dynamics with inhibitors is a dynamics of 4 variables, here the orange plot can be considered as a 3d projection of a 4d curve. Thus, the concern for non-infecting viral particles is beyond this scope.","99e15b41":"## Varying Initial Virion Population","b3afe516":"An interesting point would be to determine if this convergence point is same or different for different distributions of target and infected cells, and also, how it is influenced by the number of virions.","ef5b3a93":"# Steady States","3667286e":"Again, the observations above are corroborated by this solution trajectory.","daef0551":"Assuming that at $t=t_0$, there are 10 target cells, 0 infected cells and 1 virion.","da76467c":"Yes! No matter where one starts, the model will converge at the same point. One can vary the virion population or the target and infected cell distribution, it does not affect the final state. So, what does the final state actually depend on? What happens if one changes the paramters of the dynamics?","59691be4":"## $R_0$ < 1","5b8bf64d":"So, we see that no matter where the curves start, if the parameters of the dynamics are the same (either red or blue), then the curves end at the same point.","ef7241f4":"# Dynamics with Viral Inhibitors","cedb8db3":"$$ R_0 = \\frac{\\lambda pk}{\\delta dc} $$","939486ac":"Untill now, we have seen for $R_0 > 1$. So, we set parameters for $R_0 < 1$"}}