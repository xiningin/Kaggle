{"cell_type":{"65eaaf76":"code","fff7ff94":"code","471d3901":"code","a7846f9e":"code","2f1946d5":"code","4674affd":"code","9e8d7468":"code","f4de679d":"code","15943423":"code","f084a818":"code","06f34edf":"code","8f2d58bd":"code","413e596d":"code","ff5f3b96":"code","9293ed47":"code","04362bf0":"code","90a50de9":"code","dd16cd19":"code","9416ee24":"code","c21e09b5":"code","7c5d0672":"code","27c9fc65":"code","b1c4bc62":"code","0c890939":"code","4285c81c":"code","4489954c":"code","2faa6073":"code","29fcce0b":"code","f3e7fe6d":"code","970cfb8c":"code","cfcaccc6":"code","f5f573fd":"code","7f13c844":"code","b6406fe5":"markdown","8687b3d7":"markdown","d497bddd":"markdown","9b11ddec":"markdown","86ddd419":"markdown","54ff9d63":"markdown","d03c8013":"markdown","34452f42":"markdown","b66a27d3":"markdown","1ce84fd8":"markdown","09875e72":"markdown","f57c60c1":"markdown","5f8ec491":"markdown","84abba97":"markdown","9ca15c58":"markdown"},"source":{"65eaaf76":"import numpy as np \nimport pandas as pd\nimport json\n\nimport seaborn as sns\nsns.set_style('whitegrid')\nimport matplotlib.pyplot as plt\n\nimport warnings\nwarnings.filterwarnings(action=\"ignore\")","fff7ff94":"df = pd.read_csv('..\/input\/youtube-new\/USvideos.csv')","471d3901":"df.head()","a7846f9e":"df['trending_date'] = pd.to_datetime(df['trending_date'], format='%y.%d.%m')","2f1946d5":"df['trending_date'].head()","4674affd":"df['publish_time'] = pd.to_datetime(df['publish_time'], format='%Y-%m-%dT%H:%M:%S.%fZ')","9e8d7468":"df['publish_time'].head()","f4de679d":"df.insert(5, 'publish_date', df['publish_time'].dt.date)","15943423":"df['publish_time'] = df['publish_time'].dt.time","f084a818":"df['publish_date'] = pd.to_datetime(df['publish_date'])","06f34edf":"id_to_cat = {}\n\nwith open('..\/input\/youtube-new\/US_category_id.json', 'r') as f:\n    data = json.load(f)\n    for category in data['items']:\n        id_to_cat[category['id']] = category['snippet']['title']","8f2d58bd":"id_to_cat","413e596d":"df['category_id'] = df['category_id'].astype(str)","ff5f3b96":"df.insert(5, 'category', df['category_id'].map(id_to_cat))","9293ed47":"df['video_id'].nunique()","04362bf0":"len(df['video_id'])","90a50de9":"print(df.shape)\ndf_last = df.drop_duplicates(subset=['video_id'], keep='last', inplace=False)\ndf_first = df.drop_duplicates(subset=['video_id'], keep='first', inplace=False)\nprint(df_last.shape)\nprint(df_first.shape)","dd16cd19":"print(df['video_id'].duplicated().any())\nprint(df_last['video_id'].duplicated().any())\nprint(df_first['video_id'].duplicated().any())","9416ee24":"df_last.head()","c21e09b5":"def top_10(df, col, num=10):\n    sort_df = df.sort_values(col, ascending=False).iloc[:num]\n    \n    ax = sort_df[col].plot.bar()\n   \n    labels = []\n    for item in sort_df['title']:\n        labels.append(item[:10] + '...')\n        \n    ax.set_title(col.upper(), fontsize=16)\n    ax.set_xticklabels(labels, rotation=45, fontsize=10)\n    \n    return sort_df[['video_id', 'title', 'channel_title', col]]","7c5d0672":"top_10(df_last, 'views', 10)","27c9fc65":"top_10(df_last, 'comment_count')","b1c4bc62":"def bottom_10(df, col, num=10):\n    sort_df = df.sort_values(col, ascending=True).iloc[:num]\n    \n    ax1 = sort_df[col].plot.bar()\n    \n    labels = []\n    for item in sort_df['title']:\n        labels.append(item[:10] + '...')\n        \n    ax1.set_title('Bottom {} {} for videos'.format(num, col))\n    ax1.set_xticklabels(labels, rotation=45)\n    \n    return sort_df[['title', 'channel_title', col]]","0c890939":"bottom_10(df_last, 'views')","4285c81c":"def channel_stats(df, channel, num=5, arrange_by='views'):\n    target_df = df.loc[df['channel_title'] == channel].sort_values(arrange_by, ascending=False)[:num]\n    \n    ax1 = target_df[['views']].plot.bar()\n    \n    ax2 = target_df[['likes', 'dislikes', 'comment_count']].plot.bar()\n    \n    labels = []\n    for item in target_df['title']:\n        labels.append(item[:15] + '...')\n    \n    ax1.set_title('Top {} views for channel {} arranged by {}'.format(num, channel, arrange_by))\n    ax1.set_xticklabels(labels, rotation=45)\n    \n    ax2.set_title('Top {} Likes\/Dislikes\/Comments for channel {} arranged by {}'.format(num, channel, arrange_by))\n    ax2.set_xticklabels(labels, rotation=45)\n    \n    return df.loc[df['channel_title'] == channel]","4489954c":"channel_stats(df_last, 'Logan Paul Vlogs', num=10, arrange_by='likes')","2faa6073":"def find_videos_by_trending_date(df, date, num=10, arrange_by='views', category=False):\n    \n    target_df = df.loc[df['trending_date'] == date][:num].sort_values(arrange_by, ascending=False)\n    \n    if category==True:\n        cat_target = df.loc[df['trending_date'] == date].sort_values(arrange_by, ascending=False)\n        cat = cat_target.groupby(['category'])['video_id'].count().sort_values(ascending=False).head()\n        print('The categories with the most videos on this trending date:', cat)\n    \n    ax1 = target_df[['views']].plot.bar()\n    \n    ax2 = target_df[['likes', 'dislikes', 'comment_count']].plot.bar()\n    \n    labels = []\n    for item in target_df['title']:\n        labels.append(item[:10] + '...')\n        \n    ax1.set_title('Top {} views for videos trending on date {} arranged by {}'.format(num, date, arrange_by))\n    ax1.set_xticklabels(labels, rotation=45)\n    \n    ax2.set_title('Top {} likes\/dislikes\/comments for videos trending on date {} arranged by {}'.format(num, date, arrange_by))\n    ax2.set_xticklabels(labels, rotation=45)\n    \n    return target_df","29fcce0b":"find_videos_by_trending_date(df_last, '2017-11-14', 5, category=True)","f3e7fe6d":"def find_videos_by_publish_date(df, date, num=5, arrange_by='views', publish_to_trend_time=False):\n    \n    target_df = df.loc[df['publish_date'] == date][:num].sort_values(arrange_by, ascending=False)\n    \n    if publish_to_trend_time==True:\n        target_df.insert(6, 'publish_to_trend_time', target_df['trending_date'] - target_df['publish_date'])\n    \n    ax1 = target_df[['views']].plot.bar()\n    \n    ax2 = target_df[['likes', 'dislikes', 'comment_count']].plot.bar()\n    \n    labels = []\n    for item in target_df['title']:\n        labels.append(item[:10] + '...')\n        \n    ax1.set_title('Top {} views for videos published on date {} arranged by {}'.format(num, date, arrange_by))\n    ax1.set_xticklabels(labels, rotation=45)\n    \n    ax2.set_title('Top {} likes\/dislikes\/comments for videos published on date {} arranged by {}'.format(num, date, arrange_by))\n    ax2.set_xticklabels(labels, rotation=45\n                       )\n    return target_df","970cfb8c":"find_videos_by_publish_date(df_last, '2017-11-13', publish_to_trend_time=True)","cfcaccc6":"find_videos_by_publish_date(df_last, '2017-11-10', 2, 'comment_count')","f5f573fd":"def find_videos_by_category(df, cat, num=5, arrange_by='views'):\n    \n    target_df = df.loc[df['category'] == cat][:num].sort_values(arrange_by, ascending=False)\n    \n    ax1 = target_df[['views']].plot.bar()\n    \n    ax2 = target_df[['likes', 'dislikes', 'comment_count']].plot.bar()\n    \n    labels = []\n    for item in target_df['title']:\n        labels.append(item[:10] + '...')\n        \n    ax1.set_title('Top {} views for videos in category {} arranged by {}'.format(num, cat, arrange_by))\n    ax1.set_xticklabels(labels, rotation=45)\n    \n    ax2.set_title('Top {} likes\/dislikes\/comments for videos in category {} arranged by {}'.format(num, cat, arrange_by))\n    ax2.set_xticklabels(labels, rotation=45)\n    \n    return target_df","7f13c844":"find_videos_by_category(df_last, 'Entertainment', 5)","b6406fe5":"### Function to display channel stats","8687b3d7":"# Data Preprocessing","d497bddd":"# Functions","9b11ddec":"### Function to find videos by trending date","86ddd419":"df has a lot of repetitions as many videos were trending for multiple days. We split the df into df_last to keep the updated stats on the last day it was trending and df_first for the first day it was trending.","54ff9d63":"This notebook is about creating functions for the USvideos EDA. It goes through some basic data preprocessing like formatting datetime features, processing category_id and splitting dataset based on last and first trending date. It then heads into creating functions and basic documentation for explaining the parameters in the functions and how they can be used. \n\nThese functions are pretty universal and can be applied to any of the csv files in the YouTube dataset. I'll be going into a more in depth analysis in my next notebook.","d03c8013":"### Processing category_id","34452f42":"### Documentation\n\nFunctions:\n- top_10 ( df, col, num=10 )\n- bottom_10 ( df, col, num=10 )\n- channel_stats ( df, channel, num=5, arrange_by='views' )\n- find_videos_by_trending_date ( df, date, num=5, arrange_by='views', category=False )\n- find_videos_by_publish_date ( df, date, num=5, arrange_by='views', publish_to_trend_time=False )\n- find_videos_by_category ( df, cat, num=5, arrange_by='views' )\n\nParameters:\n- df: The dataframe that you wsih to extract the data from. It could be the entire dataframe or the dataframes created based on first and last trending dates.\n- col: views, likes, dislikes, comment_count\n    - Prescribe the parameter based on which the top_10 and bottom_10 function will parse the data\n- num: (default=10 or 5)\n    - The number of observations you wish to view\n- channel: (for channel_stats) \n    - The channel_title for which you would like to see the stats\n- arrange_by: views, likes, dislikes, comment_count (default='views')\n    - The parameter based on which you would like to arrange the data\n- category: boolean, optional (default=False)\n    - Set True to print category with the highest number of trending videos on that date\n- publish_to_trend_time: boolean, optional (default=False)\n    - Set True to include a column in the df with the number of days it to took for the video to trend","b66a27d3":"### Converting date and time columns to datetime","1ce84fd8":"### Find videos by Category","09875e72":"Out of 40949 videos, only 6351 are unique as these videos were trending on multiple days.","f57c60c1":"### Function to find videos by publish date","5f8ec491":"### Visualize top 10 by feature\n\nWe'll be using df_last for all these functions as df_last has all the videos with the updates stats while it was trending. Though you can use any dataframe and plug it into these functions for data analysis","84abba97":"### Duplicated entries","9ca15c58":"### Visualize bottom 10 by feature"}}