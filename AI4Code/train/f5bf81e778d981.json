{"cell_type":{"579ed9f5":"code","f6ff6407":"code","a6a3d563":"code","14789655":"code","8e144426":"code","4c386fd3":"code","c85edb4f":"code","864b5476":"code","dd47e7ff":"code","b30b7e1f":"code","b16b090a":"code","46d254f0":"code","b818c7ab":"code","ab6702ad":"code","2c763c62":"code","5702e0cd":"code","0501ea03":"code","0900056e":"code","3b46e651":"code","27d46c09":"code","625320e2":"code","d7e7e555":"code","6fbd33a1":"markdown","e28dba7a":"markdown","0a66cfb3":"markdown","8a1b043d":"markdown","f81063df":"markdown","5796a611":"markdown","0d8d0702":"markdown","939bfed0":"markdown","d38bd6bd":"markdown","befb0664":"markdown","03ff7054":"markdown","9aa35187":"markdown","47a4528a":"markdown","572e4000":"markdown","41efb59e":"markdown","49710100":"markdown","8f24b2f0":"markdown","948e4e8f":"markdown","d86b00ba":"markdown","44c24bde":"markdown","92b2a327":"markdown","6b82cd51":"markdown"},"source":{"579ed9f5":"import numpy as np\nimport pandas as pd\nimport geopandas as gpd\n\nimport folium\nfrom folium import Choropleth\nfrom folium.plugins import HeatMap\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns","f6ff6407":"# Read the data in\ndf_airbnb = pd.read_csv('\/kaggle\/input\/new-york-city-airbnb-open-data\/AB_NYC_2019.csv')\n# Have a look at the first 5 entries\ndf_airbnb.head(5)","a6a3d563":"# Print some stats about the data\nprint('There are {} listings in the dataset'.format(len(df_airbnb)))\nprint('The dataset has {} columns with the following titles:\\n'.format(len(df_airbnb.columns)))\nfor col in df_airbnb.columns:\n    print(col)","14789655":"# Check which columns have missing data\ndf_airbnb.isnull().sum()","8e144426":"# Drop the 3 columns and have a look at the new dataset\ndf_airbnb.drop(['id','host_name','last_review'], axis=1, inplace=True)\ndf_airbnb.head(5)","4c386fd3":"# Fill the missing reviews per month with zero\ndf_airbnb.fillna({'reviews_per_month': 0}, inplace=True)\ndf_airbnb.head(5)","c85edb4f":"# One last check to make sure there is no missing data\ndf_airbnb.isnull().sum()","864b5476":"gdf_nyc_boundaries = gpd.read_file(\"..\/input\/nyc-neighbourhood-boundaries\/geo_export_9f5919c7-b377-48b3-bc3f-c45b49cba31a.shp\")\ngdf_nyc_boundaries.set_index('ntacode', inplace=True)\ngdf_nyc_boundaries.head(5)","dd47e7ff":"count_data_df = df_airbnb[['neighbourhood']].neighbourhood.value_counts()\ngdf_nyc_boundaries[\"listing_count\"] = 0\n\nfor ii in range(len(count_data_df)):\n    key = count_data_df.keys()[ii]\n    \n    index = gdf_nyc_boundaries.index[gdf_nyc_boundaries['ntaname'] == key]\n    if len(index) > 0:\n        gdf_nyc_boundaries.loc[index[0], ('listing_count')] = count_data_df[ii]\n\ngdf_nyc_boundaries.head()","b30b7e1f":"# This function is used to help plot the maps in the notebook\ndef embed_map(m, file_name):\n    from IPython.display import IFrame\n    m.save(file_name)\n    return IFrame(file_name, width='100%', height='500px')","b16b090a":"listing_map = folium.Map(location=[40.730610,-73.935242], tiles='cartodbpositron', zoom_start=10)\nChoropleth(geo_data=gdf_nyc_boundaries['geometry'].__geo_interface__,\n           key_on=\"feature.id\",\n           data=gdf_nyc_boundaries['listing_count'],\n           fill_color='YlOrRd',\n           legend_name='NYC Neighbourhoods'\n          ).add_to(listing_map)\nembed_map(listing_map, 'listing_map.html')","46d254f0":"df_airbnb.price.describe()","b818c7ab":"# We will use the 25 and 75 percentile for the plot\ndef color_producer(val):\n    if val < 69:\n        return 'forestgreen'\n    if val < 175:\n        return 'darkorange'\n    else:\n        return 'darkred'\n    \nprice_map = folium.Map(location=[40.730610,-73.935242], tiles='cartodbpositron', zoom_start=10)\n    \nfor i in range(0, len(df_airbnb)):\n    folium.Circle(\n        location=[df_airbnb.iloc[i]['latitude'], df_airbnb.iloc[i]['longitude']],\n        radius=25,\n        color=color_producer(df_airbnb.iloc[i]['price'])\n    ).add_to(price_map)\nembed_map(price_map, 'price_map.html')","ab6702ad":"df_airbnb_top_reviewed = df_airbnb.nlargest(100, 'number_of_reviews')\ndf_airbnb_top_reviewed[['number_of_reviews', 'price']].describe()","2c763c62":"def color_producer(val):\n    if val < 348:\n        return 'forestgreen'\n    if val < 427:\n        return 'darkorange'\n    else:\n        return 'darkred'\n    \nreview_map = folium.Map(location=[40.730610,-73.935242], tiles='cartodbpositron', zoom_start=10)\n    \nfor i in range(0, len(df_airbnb_top_reviewed)):\n    folium.Circle(\n        location=[df_airbnb_top_reviewed.iloc[i]['latitude'], df_airbnb_top_reviewed.iloc[i]['longitude']],\n        radius=25,\n        color=color_producer(df_airbnb_top_reviewed.iloc[i]['number_of_reviews'])\n    ).add_to(review_map)\nembed_map(review_map, 'review_map.html')","5702e0cd":"df_airbnb_rooms = df_airbnb.room_type.unique()\n\n# Print some stats about the types of rooms\nprint('There are {} types of rooms\\n'.format(len(df_airbnb_rooms)))\nfor ii in range(len(df_airbnb_rooms)):\n    print(df_airbnb_rooms[ii])","0501ea03":"# Get the average price and number of reviews per room type\ndf_airbnb_rooms_private = df_airbnb.loc[df_airbnb['room_type'] == 'Private room']\ndf_airbnb_rooms_entire = df_airbnb.loc[df_airbnb['room_type'] == 'Entire home\/apt']\ndf_airbnb_rooms_shared = df_airbnb.loc[df_airbnb['room_type'] == 'Shared room']\n\nprint('Private Room Stats')\ndf_airbnb_rooms_private[['price', 'number_of_reviews']].describe()","0900056e":"print('Entire Home\/Apt Stats')\ndf_airbnb_rooms_entire[['price', 'number_of_reviews']].describe()","3b46e651":"print('Shared Room Stats')\ndf_airbnb_rooms_shared[['price', 'number_of_reviews']].describe()","27d46c09":"def color_producer(val):\n    if val < 'Private room':\n        return 'forestgreen'\n    if val < 'Shared room':\n        return 'darkorange'\n    else:\n        return 'darkred'\n    \ntypes_map = folium.Map(location=[40.730610,-73.935242], tiles='cartodbpositron', zoom_start=10)\n    \nfor i in range(0, len(df_airbnb)):\n    folium.Circle(\n        location=[df_airbnb.iloc[i]['latitude'], df_airbnb.iloc[i]['longitude']],\n        radius=25,\n        color=color_producer(df_airbnb.iloc[i]['room_type'])\n    ).add_to(types_map)\nembed_map(types_map, 'types_map.html')","625320e2":"df_airbnb.availability_365.describe()","d7e7e555":"def color_producer(val):\n    if val > 227:\n        return 'forestgreen'\n    if val > 0:\n        return 'darkorange'\n    else:\n        return 'darkred'\n    \navailability_map = folium.Map(location=[40.730610,-73.935242], tiles='cartodbpositron', zoom_start=10)\n    \nfor i in range(0, len(df_airbnb)):\n    folium.Circle(\n        location=[df_airbnb.iloc[i]['latitude'], df_airbnb.iloc[i]['longitude']],\n        radius=25,\n        color=color_producer(df_airbnb.iloc[i]['availability_365'])\n    ).add_to(review_map)\nembed_map(availability_map, 'availability_map.html')","6fbd33a1":"The average price for a entire house or apartment is \\$212 with an average of 22 reviews.","e28dba7a":"![image.png](attachment:image.png)","0a66cfb3":"We can now visualize all of the Airbnb listings on the map. We have plotted the number of listings per neighbourhood.","8a1b043d":"We need to add the number of listings in each neighbourhood to the neighbourhood in the geodata.","f81063df":"Majority of the top reviewed listings are in Manhattan, Brooklyn and Queens.","5796a611":"It can be seen from the plot above that most of the room tyoes are either private or shared rooms. With most of them being in Manhattan, Brooklyn and Queens.","0d8d0702":"After loading in the dataset we can see that there are 48895 listings and 16 cloumns of data for each. From the preview of the data it can be seen that there are some rows that are missing data. We will next fix the missing data and create a new column from the coordinates so that the listings can be plotted onto a map. ","939bfed0":"**Map Data**\n\nFor the maps to be more useful, I decided to get the shapefiles for all of the neighbourhoods in NYC. NYC Open Data had the files, https:\/\/data.cityofnewyork.us\/City-Government\/Neighborhood-Tabulation-Areas\/cpf4-rkhq. Once the data was read in using geopandas, I plotted it on a map to make sure it was correct.","d38bd6bd":"We can see that the max number of reviews 629, the min is 323 and the average is 396 out of the top 100 reviewed listings. We will plot the lower 25%, middle 50% and upper 25% on our plot. The average price to stay in one of the top 100 listings is \\$95 per night.","befb0664":"**Listing Availablitity**","03ff7054":"The average listing is available for 112 days in a year. We will again plot the lower 25%, middle 50% and upper 25% on the map.","9aa35187":"It can be seen from the map that the most expensive listings (top 25%) are in Manhattan. This goes hand in hand with the fact that it is a weathly area. Majority of the middle 50% of listings is in Brooklyn and Queens. Staten Island and The Bronx do't have close to as many listings as the other three boroughs.","47a4528a":"We can see that the cheapest listing is \\$0 and the most expensive is \\$10000. The average price for a listing is \\$106. This doesn't give us much insight so we will plot the lower 25%, the middle 50% and the upper 25% in different colors to see wat the distribution is.","572e4000":"**Abstract**\n\nAirbnb has been around since 2008. It has helped guests see the world and experience local cultures and things that aren't on the normall travel itinerary. It has also help hosts make some extra money and for some it has become a full time job. There are millions of homes and rooms available on Airbnb now. Analysing all of the data that is produced by these millions of homes can help them make better business decisions by understanding the customers and hosts.","41efb59e":"**Listing Prices**","49710100":"We can drop the Airbnb ID as it has no use to us. The host name is redundant in our analysis and we will not be concerned when the last review was submitted.","8f24b2f0":"The average price for a entire house or apartment is \\$70 with an average of 16 reviews.","948e4e8f":"**Listing Types**","d86b00ba":"The average price for a private room is \\$90 with an average of 24 reviews.","44c24bde":"**Top 100 Reviewed listings**","92b2a327":"**Imports**\n\nWe will be using pandas to read and manipulate the data. We will also be using the geopandas to help us plot the data on maps and we will be using folium for the maps.","6b82cd51":"**Cleaning Data**"}}