{"cell_type":{"f60b8295":"code","97d41a1d":"code","c15dffa8":"code","61acc804":"code","0f2b3c18":"code","34695fce":"code","a6c4d1e8":"code","86492e87":"code","20bc9b2f":"code","8974273d":"code","aae00533":"code","e4763ff5":"code","eb0c9367":"code","dc25a2ce":"code","3e07a35f":"code","8b7e3719":"code","193f71c2":"code","df4b3e07":"code","f6d0677e":"code","e8b67ddf":"code","d99ac6e1":"code","1cb9bae3":"code","b5140754":"code","e6c40169":"code","f7e44519":"code","c212853c":"code","c9f9f182":"code","46a798ba":"code","ea9e5ba9":"code","2669b7b5":"code","4d2fa95c":"code","9484ecd7":"code","173b6214":"code","946733a5":"code","16c509e2":"code","4177aa0d":"code","22aca19a":"code","fdffa1b4":"code","bf1ddc41":"code","5915cc5f":"code","691a851c":"code","a3bd7fb2":"code","762136d5":"code","3b4cf176":"code","921ae6f8":"code","bdf5ccd2":"code","e6a41e1e":"code","570d4564":"code","4341676b":"code","224013e1":"code","5c1e2c14":"code","fb266526":"code","995918fb":"code","1bb2e478":"code","054b6c61":"code","51ef1083":"code","e6f55faa":"code","8e79c549":"code","513ad0e4":"code","242f2742":"code","d17e7972":"code","9c3d24b2":"code","8ab4a390":"code","bd7b6acf":"code","fa8e197b":"code","4abac31e":"code","4a04df3f":"code","4a89966a":"code","3d79a80f":"code","77b841da":"code","1dafae7c":"code","8c4a7fd5":"code","65b3bbdd":"code","cfb29396":"code","1f0bb39a":"code","18eff8a1":"code","b86b0e08":"code","bdafaa26":"code","9e3a3b96":"code","8460f33a":"code","bbffd3c9":"code","c2c1f7f5":"code","81d23ef1":"code","11f525e2":"code","fe9ffdf6":"code","96d5311a":"code","42c91a6e":"code","21c909a2":"code","445e7556":"code","567856bd":"code","dd11d2f8":"code","db0dcce0":"code","f0444d99":"code","b89696bc":"code","dd633e65":"code","0efa1ff0":"code","7a8d74dd":"code","048ea1fd":"code","e7c18059":"code","52e3ca28":"code","cebf85ef":"code","1eba2e03":"code","d37f8f51":"code","96abe980":"code","edbc1d03":"code","069dfc84":"code","0e69ed47":"code","6d627797":"code","b1dc1fa7":"code","d1fddea3":"code","878856be":"code","93d48f3d":"code","e3b3250f":"code","7cd0cf64":"code","2e9511b1":"code","64069564":"code","e2736807":"code","3d506286":"code","67dea1b5":"code","be2d79b3":"code","f969f2ce":"code","8e051f7f":"code","c317222a":"code","b3a67236":"code","5fbb6cec":"code","f4e3ccad":"code","c6286305":"code","431f4df6":"code","b5de5702":"code","c410794b":"code","1b2f4aab":"code","10b617fd":"code","3145f951":"code","9236d974":"code","ed66677c":"code","8b4a4d93":"code","f9ebb239":"code","8c73fd25":"code","dccfc728":"code","078d0517":"code","5219fe10":"code","1552f1a6":"code","3a4b5c84":"code","aa89a0c9":"code","75affd36":"code","d0b36b3a":"code","c08380a5":"code","418fa855":"code","3a76f7c5":"code","e94c1348":"code","376da1e6":"code","681d5c0a":"code","5135f9a8":"code","3cb9b0a5":"code","56f74b04":"code","c37bd475":"code","54bc0c7e":"code","5387d249":"code","fd94652a":"code","756bb027":"code","8813e16f":"code","20b4bc8e":"code","59d271e4":"code","6577433e":"code","12f6814a":"code","bbe66fce":"code","ace23484":"code","e897d84d":"code","fb8f6c5c":"code","cd7f2fd2":"code","7b4b4f02":"code","e4b6deb3":"code","a3a78b89":"code","68565d74":"code","402bfb0a":"code","f7776448":"code","65d0b821":"code","910a8e8d":"code","194bee79":"code","c972df4a":"code","63fcb3b6":"code","801574af":"code","ac8ba553":"code","aaa2c08a":"code","43a78292":"code","5ece5c44":"code","e1440509":"code","4f1cd189":"code","c3c4b7c5":"code","9418312c":"code","f6c9fe0d":"code","bc830519":"code","7db1dce3":"code","af3e54e6":"code","7ad6ebf3":"code","c880af87":"code","5b4e80da":"code","ff861cb7":"code","81fa58b4":"code","43e409c0":"code","ac787009":"code","f3e86c10":"code","34bafc2d":"code","8e5b403a":"code","09d3a148":"code","dd05350c":"code","440238b4":"code","71ea70e8":"code","d6dbb508":"code","d6e1b726":"code","990bfacb":"code","6032a7b7":"code","439f1bb6":"code","629ed739":"code","a75ce9aa":"code","50b12adb":"code","1d641937":"code","8b382a38":"markdown","724be89b":"markdown","53020e3f":"markdown","6d1101f8":"markdown","3929e9d1":"markdown","4b810711":"markdown","49c0b56e":"markdown","220799bc":"markdown","67dcea58":"markdown","707ec0cd":"markdown","b64578cc":"markdown","57553b8d":"markdown","b2a2177d":"markdown","814f164c":"markdown","35b39dce":"markdown","3c8039de":"markdown","870f0029":"markdown","f6fe8ad8":"markdown","5e60ce86":"markdown","59d33ad0":"markdown","cc449e90":"markdown","e77063be":"markdown","c0f1c820":"markdown","5dfd5503":"markdown","e2507e5a":"markdown","b4748982":"markdown","aae01d02":"markdown","e4e3ffe9":"markdown","e7a409a2":"markdown","acef26a5":"markdown","2e7550a8":"markdown","22de914a":"markdown","6705347c":"markdown"},"source":{"f60b8295":"import seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.metrics import accuracy_score,classification_report,plot_confusion_matrix,plot_roc_curve","97d41a1d":"import pandas as pd\ndf=pd.read_csv('..\/input\/swarm-behaviour-classification\/Swarm_Behaviour.csv')","c15dffa8":"df","61acc804":"df[\"Swarm_Behaviour\"].unique()","0f2b3c18":"df.info()","34695fce":"df.isna().sum()","a6c4d1e8":"df.describe()","86492e87":"import seaborn as sns\nsns.countplot(df[\"Swarm_Behaviour\"])","20bc9b2f":"df[\"Swarm_Behaviour\"].value_counts()\/df.shape[0]","8974273d":"import numpy as np\nfrom sklearn.decomposition import PCA\nfrom sklearn.preprocessing import StandardScaler\nscaler=StandardScaler()\nX=df.drop(\"Swarm_Behaviour\",axis=1)\nX=scaler.fit_transform(X)","aae00533":"\nvariance=[]\np=[50,100,150,200,300,400,500,600,700,800,900,1000,1100,1300,1500,1700,1900,2000]\nfor p in p:\n    pca_model=PCA(n_components=p)\n    pca_model.fit(X)\n    variance.append(np.sum(pca_model.explained_variance_ratio_))\n    print(\"Components:\",p)","e4763ff5":"import matplotlib.pyplot as plt\nplt.plot(variance,\"o--\")","eb0c9367":"pca_model=PCA(n_components=400)\npca_model.fit(X)","dc25a2ce":"np.sum(pca_model.explained_variance_ratio_)","3e07a35f":"features=pca_model.transform(X)","8b7e3719":"features","193f71c2":"X=features\ny=df[\"Swarm_Behaviour\"]","df4b3e07":"from sklearn.model_selection import train_test_split,GridSearchCV","f6d0677e":"X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.25,random_state=101)","e8b67ddf":"from sklearn.linear_model import LogisticRegression\nlr=LogisticRegression(random_state=101,max_iter=10000)\npenalty=[\"l1\",\"l2\",\"elasticnet\"]\nl1_ratio=[0.01,0.1,0.5,1]\nC= [0.01,0.1,1]\n\nparamgrid={\n           \"penalty\":penalty,\n           \"l1_ratio\":l1_ratio,\n           \"C\":C}","d99ac6e1":"import warnings\nwarnings.filterwarnings(\"ignore\")\ngrid_model=GridSearchCV(lr,paramgrid,return_train_score=True,verbose=2)\ngrid_model.fit(X_train,y_train)","1cb9bae3":"cv_results=pd.DataFrame(grid_model.cv_results_)\ncv_results.head()","b5140754":"sns.lineplot(data=cv_results,x=\"param_C\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_C\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"C\")\nplt.ylabel(\"Score\")","e6c40169":"sns.lineplot(data=cv_results,x=\"param_l1_ratio\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_l1_ratio\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"L1 Ratio\")\nplt.ylabel(\"Score\")","f7e44519":"grid_model.best_params_","c212853c":"\nlr=LogisticRegression(C=0.01,l1_ratio=0.01,penalty=\"l2\",random_state=101,max_iter=10000)\nlr.fit(X_train,y_train)\n\n\n\n\n    ","c9f9f182":"y_pred=lr.predict(X_test)\ny_pred2=lr.predict(X_train)","46a798ba":"acc_lr=accuracy_score(y_test,y_pred)\nprint(\"Train: \",accuracy_score(y_train,y_pred2))\nprint(\"Test: \",accuracy_score(y_test,y_pred))","ea9e5ba9":"print(classification_report(y_test,y_pred))","2669b7b5":"plot_confusion_matrix(lr,X_test,y_test);","4d2fa95c":"fig,ax=plt.subplots(figsize=(12,6),dpi=100)\nplot_roc_curve(lr,X_test,y_test,ax=ax);","9484ecd7":"from sklearn.neighbors import KNeighborsClassifier","173b6214":"acc=[]\nfor n in range(1,15):\n    KNC=KNeighborsClassifier(n_neighbors=n)\n    KNC.fit(X_train,y_train)\n    y_pred= KNC.predict(X_test)\n    acc.append(accuracy_score(y_test,y_pred))\n\n","946733a5":"plt.figure(figsize=(14,7))\nsns.lineplot(x=np.arange(1,15),y=acc,color=\"green\")\nplt.ylabel(\"Accuracy_Score (test)\")\nplt.xlabel(\"n_neighbors\");","16c509e2":"KNC=KNeighborsClassifier(n_neighbors=6)\nKNC.fit(X_train,y_train)\n","4177aa0d":"y_pred=KNC.predict(X_test)\ny_pred2=KNC.predict(X_train)","22aca19a":"acc_KNC=accuracy_score(y_test,y_pred)\nprint(\"Train: \",accuracy_score(y_train,y_pred2))\nprint(\"Test: \",accuracy_score(y_test,y_pred))","fdffa1b4":"print(classification_report(y_test,y_pred))","bf1ddc41":"plot_confusion_matrix(KNC,X_test,y_test);","5915cc5f":"fig,ax=plt.subplots(figsize=(12,6),dpi=100)\nplot_roc_curve(KNC,X_test,y_test,ax=ax);","691a851c":"from sklearn.linear_model import RidgeClassifier","a3bd7fb2":"RC=RidgeClassifier(random_state=101)\nparams={\"alpha\":[0.0001,0.01,0.05,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0,2.0,3.0,4.0,5.0,10]}\ngrid_model=GridSearchCV(RC,params,return_train_score=True,verbose=2)\ngrid_model.fit(X_train,y_train)","762136d5":"cv_results=pd.DataFrame(grid_model.cv_results_)\ncv_results.head()","3b4cf176":"sns.lineplot(data=cv_results,x=\"param_alpha\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_alpha\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Alpha\")\nplt.ylabel(\"Score\")","921ae6f8":"grid_model.best_params_","bdf5ccd2":"RC=RidgeClassifier(alpha=0.0001,random_state=101)\nRC.fit(X_train,y_train)","e6a41e1e":"y_pred=RC.predict(X_test)\ny_pred2=RC.predict(X_train)","570d4564":"acc_RC=accuracy_score(y_test,y_pred)\nprint(\"Train: \",accuracy_score(y_train,y_pred2))\nprint(\"Test: \",accuracy_score(y_test,y_pred))","4341676b":"print(classification_report(y_test,y_pred))","224013e1":"plot_confusion_matrix(RC,X_test,y_test);","5c1e2c14":"fig,ax=plt.subplots(figsize=(12,6),dpi=100)\nplot_roc_curve(RC,X_test,y_test,ax=ax);","fb266526":"from sklearn.svm import SVC","995918fb":"params={\"C\":[0.01,0.1],\n    \"kernel\":[\"linear\"],\n    \"degree\":[1,2,3],\n    \"gamma\":[\"scale\",\"auto\"],}\nsvc=SVC(random_state=101)","1bb2e478":"grid_model=GridSearchCV(svc,params,return_train_score=True,verbose=2)\ngrid_model.fit(X_train,y_train)","054b6c61":"cv_results=pd.DataFrame(grid_model.cv_results_)\ncv_results.head()","51ef1083":"sns.lineplot(data=cv_results,x=\"param_C\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_C\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"C\")\nplt.ylabel(\"Score\")","e6f55faa":"sns.lineplot(data=cv_results,x=\"param_degree\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_degree\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Degree\")\nplt.ylabel(\"Score\")","8e79c549":"sns.lineplot(data=cv_results,x=\"param_gamma\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_gamma\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Gamma\")\nplt.ylabel(\"Score\")","513ad0e4":"grid_model.best_params_","242f2742":"svc=SVC(random_state=101,C=0.01,degree=1,gamma=\"scale\",kernel=\"linear\")\nsvc.fit(X_train,y_train)","d17e7972":"y_pred=svc.predict(X_test)\ny_pred2=svc.predict(X_train)","9c3d24b2":"acc_SVC=accuracy_score(y_test,y_pred)\nprint(\"Train: \",accuracy_score(y_train,y_pred2))\nprint(\"Test: \",accuracy_score(y_test,y_pred))","8ab4a390":"print(classification_report(y_test,y_pred))","bd7b6acf":"plot_confusion_matrix(svc,X_test,y_test);","fa8e197b":"fig,ax=plt.subplots(figsize=(12,6),dpi=100)\nplot_roc_curve(svc,X_test,y_test,ax=ax);","4abac31e":"from sklearn.tree import DecisionTreeClassifier","4a04df3f":"DTC=DecisionTreeClassifier(random_state=101)\nparams={\"max_depth\":[2,4],\n    \"max_leaf_nodes\":[3,6,9],\n        \"min_samples_leaf\":range(5,200,50),\n       \"min_samples_split\":range(5,200,50)}","4a89966a":"grid_model=GridSearchCV(DTC,params,return_train_score=True,verbose=2)\ngrid_model.fit(X_train,y_train)","3d79a80f":"cv_results=pd.DataFrame(grid_model.cv_results_)\ncv_results.head()","77b841da":"\nsns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Depth\")\nplt.ylabel(\"Score\")","1dafae7c":"\nsns.lineplot(data=cv_results,x=\"param_max_leaf_nodes\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_max_leaf_nodes\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Leaf Nodes\")\nplt.ylabel(\"Score\")","8c4a7fd5":"\nsns.lineplot(data=cv_results,x=\"param_min_samples_leaf\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_min_samples_leaf\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Min Samples Leaf\")\nplt.ylabel(\"Score\")","65b3bbdd":"\nsns.lineplot(data=cv_results,x=\"param_min_samples_split\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_min_samples_split\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Min Samples Split\")\nplt.ylabel(\"Score\")","cfb29396":"grid_model.best_params_","1f0bb39a":"DTC=DecisionTreeClassifier(max_depth=4,max_leaf_nodes=9,min_samples_leaf=5,min_samples_split=5,random_state=101)\nDTC.fit(X_train,y_train)","18eff8a1":"y_pred=DTC.predict(X_test)\ny_pred2=DTC.predict(X_train)","b86b0e08":"acc_DTC=accuracy_score(y_test,y_pred)\nprint(\"Train: \",accuracy_score(y_train,y_pred2))\nprint(\"Test: \",accuracy_score(y_test,y_pred))","bdafaa26":"print(classification_report(y_test,y_pred))","9e3a3b96":"plot_confusion_matrix(DTC,X_test,y_test);","8460f33a":"fig,ax=plt.subplots(figsize=(12,6),dpi=100)\nplot_roc_curve(DTC,X_test,y_test,ax=ax);","bbffd3c9":"from sklearn.ensemble import BaggingClassifier","c2c1f7f5":"dt=DecisionTreeClassifier(random_state=101)\nBC=BaggingClassifier(dt,random_state=101)\nparams={\"max_samples\":[1,5,10,20,50,100],\n       \"max_features\":[1,5,10,15,20],\n       \"base_estimator__max_depth\":[1,5,10,15,20]}","81d23ef1":"grid_model=GridSearchCV(BC,params,return_train_score=True,verbose=2)\ngrid_model.fit(X_train,y_train)","11f525e2":"cv_results=pd.DataFrame(grid_model.cv_results_)\ncv_results.head()","fe9ffdf6":"\nsns.lineplot(data=cv_results,x=\"param_base_estimator__max_depth\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_base_estimator__max_depth\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Depth of Decision Tree\")\nplt.ylabel(\"Score\")","96d5311a":"sns.lineplot(data=cv_results,x=\"param_max_features\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_max_features\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Features\")\nplt.ylabel(\"Score\")","42c91a6e":"sns.lineplot(data=cv_results,x=\"param_max_samples\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_max_samples\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Samples\")\nplt.ylabel(\"Score\")","21c909a2":"grid_model.best_params_","445e7556":"dt=DecisionTreeClassifier(max_depth=5,random_state=101)\nBC=BaggingClassifier(dt,random_state=101,max_features=20,max_samples=100)\nBC.fit(X_train,y_train)","567856bd":"y_pred=BC.predict(X_test)\ny_pred2=BC.predict(X_train)","dd11d2f8":"acc_BC=accuracy_score(y_test,y_pred)\nprint(\"Train: \",accuracy_score(y_train,y_pred2))\nprint(\"Test: \",accuracy_score(y_test,y_pred))","db0dcce0":"print(classification_report(y_test,y_pred))","f0444d99":"plot_confusion_matrix(BC,X_test,y_test);","b89696bc":"fig,ax=plt.subplots(figsize=(12,6),dpi=100)\nplot_roc_curve(BC,X_test,y_test,ax=ax);","dd633e65":"from sklearn.ensemble import RandomForestClassifier","0efa1ff0":"RFC=RandomForestClassifier(random_state=101)\nparams={\n    \"n_estimators\":[30,64,100,128,200],\n    \"max_features\":[2,3,4],\n    \"max_depth\":[4,8,10,15]}","7a8d74dd":"grid_model=GridSearchCV(RFC,params,return_train_score=True,verbose=2)\ngrid_model.fit(X_train,y_train)","048ea1fd":"cv_results=pd.DataFrame(grid_model.cv_results_)\ncv_results.head()","e7c18059":"sns.lineplot(data=cv_results,x=\"param_max_features\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_max_features\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Features\")\nplt.ylabel(\"Score\")","52e3ca28":"sns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Depth\")\nplt.ylabel(\"Score\")","cebf85ef":"sns.lineplot(data=cv_results,x=\"param_n_estimators\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_n_estimators\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"N Estimators\")\nplt.ylabel(\"Score\")","1eba2e03":"grid_model.best_params_","d37f8f51":"RFC=RandomForestClassifier(random_state=101,max_depth=8,max_features=2,n_estimators=200)\nRFC.fit(X_train,y_train)","96abe980":"y_pred=RFC.predict(X_test)\ny_pred2=RFC.predict(X_train)","edbc1d03":"acc_RFC=accuracy_score(y_test,y_pred)\nprint(\"Train: \",accuracy_score(y_train,y_pred2))\nprint(\"Test: \",accuracy_score(y_test,y_pred))","069dfc84":"plot_confusion_matrix(RFC,X_test,y_test);","0e69ed47":"print(classification_report(y_test,y_pred))","6d627797":"fig,ax=plt.subplots(figsize=(12,6),dpi=100)\nplot_roc_curve(RFC,X_test,y_test,ax=ax);","b1dc1fa7":"from sklearn.ensemble import ExtraTreesClassifier","d1fddea3":"ETC=ExtraTreesClassifier(random_state=101)","878856be":"params={\n    \"n_estimators\":[30,64,100,128,200],\n    \"max_features\":[2,3,4],\n    \"max_depth\":[4,8,10,15]}\n     ","93d48f3d":"grid_model=GridSearchCV(ETC,params,return_train_score=True,verbose=2)\ngrid_model.fit(X_train,y_train)","e3b3250f":"cv_results=pd.DataFrame(grid_model.cv_results_)\ncv_results.head()","7cd0cf64":"sns.lineplot(data=cv_results,x=\"param_max_features\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_max_features\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Features\")\nplt.ylabel(\"Score\")","2e9511b1":"sns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Depth\")\nplt.ylabel(\"Score\")","64069564":"sns.lineplot(data=cv_results,x=\"param_n_estimators\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_n_estimators\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"N Estimators\")\nplt.ylabel(\"Score\")","e2736807":"grid_model.best_params_","3d506286":"ETC=ExtraTreesClassifier(random_state=101,max_depth=15,max_features=4,n_estimators=128)\nETC.fit(X_train,y_train)","67dea1b5":"y_pred=ETC.predict(X_test)\ny_pred2=ETC.predict(X_train)","be2d79b3":"acc_ETC=accuracy_score(y_test,y_pred)\nprint(\"Train: \",accuracy_score(y_train,y_pred2))\nprint(\"Test: \",accuracy_score(y_test,y_pred))","f969f2ce":"print(classification_report(y_test,y_pred))","8e051f7f":"plot_confusion_matrix(RFC,X_test,y_test);","c317222a":"fig,ax=plt.subplots(figsize=(12,6),dpi=100)\nplot_roc_curve(ETC,X_test,y_test,ax=ax);","b3a67236":"from sklearn.ensemble import AdaBoostClassifier","5fbb6cec":"\nABC=AdaBoostClassifier(random_state=101)\n\nABC.fit(X_train,y_train)","f4e3ccad":"y_pred=ABC.predict(X_test)\ny_pred2=ABC.predict(X_train)","c6286305":"acc_ABC=accuracy_score(y_test,y_pred)\nprint(\"Train: \",accuracy_score(y_train,y_pred2))\nprint(\"Test: \",accuracy_score(y_test,y_pred))","431f4df6":"print(classification_report(y_test,y_pred))","b5de5702":"plot_confusion_matrix(ABC,X_test,y_test);","c410794b":"fig,ax=plt.subplots(figsize=(12,6),dpi=100)\nplot_roc_curve(ABC,X_test,y_test,ax=ax);","1b2f4aab":"from sklearn.ensemble import GradientBoostingClassifier","10b617fd":"GBC=GradientBoostingClassifier(random_state=101)\n\nparams={\n    \"n_estimators\":[5,10,15],\n    \"learning_rate\":[0.2,0.1],\n    \"max_depth\":[3,4],\n    \"subsample\":[0.3,0.6]\n}","3145f951":"grid_model=GridSearchCV(GBC,params,return_train_score=True,verbose=2)\ngrid_model.fit(X_train,y_train)","9236d974":"cv_results=pd.DataFrame(grid_model.cv_results_)\ncv_results.head()","ed66677c":"sns.lineplot(data=cv_results,x=\"param_n_estimators\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_n_estimators\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"N Estimators\")\nplt.ylabel(\"Score\")","8b4a4d93":"sns.lineplot(data=cv_results,x=\"param_learning_rate\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_learning_rate\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Learning Rate\")\nplt.ylabel(\"Score\")","f9ebb239":"sns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Depth\")\nplt.ylabel(\"Score\")","8c73fd25":"sns.lineplot(data=cv_results,x=\"param_subsample\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_subsample\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Subsample\")\nplt.ylabel(\"Score\")","dccfc728":"grid_model.best_params_","078d0517":"GBC=GradientBoostingClassifier(learning_rate=0.1,max_depth=4,n_estimators=5,subsample=0.3,random_state=101)\nGBC.fit(X_train,y_train)","5219fe10":"y_pred=GBC.predict(X_test)\ny_pred2=GBC.predict(X_train)","1552f1a6":"acc_GBC=accuracy_score(y_test,y_pred)\nprint(\"Train: \",accuracy_score(y_train,y_pred2))\nprint(\"Test: \",accuracy_score(y_test,y_pred))","3a4b5c84":"print(classification_report(y_test,y_pred))","aa89a0c9":"plot_confusion_matrix(GBC,X_test,y_test);","75affd36":"fig,ax=plt.subplots(figsize=(12,6),dpi=100)\nplot_roc_curve(GBC,X_test,y_test,ax=ax);","d0b36b3a":"from xgboost import XGBClassifier","c08380a5":"XGBC=XGBClassifier(random_state=101)\nparams={\n    \"n_estimators\":[5,10,15],\n    \"learning_rate\":[0.2,0.1],\n    \"max_depth\":[3,4],\n    \"subsample\":[0.3,0.6]\n}","418fa855":"grid_model=GridSearchCV(XGBC,params,return_train_score=True,verbose=2)\ngrid_model.fit(X_train,y_train)","3a76f7c5":"cv_results=pd.DataFrame(grid_model.cv_results_)\ncv_results.head()","e94c1348":"sns.lineplot(data=cv_results,x=\"param_n_estimators\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_n_estimators\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"N Estimators\")\nplt.ylabel(\"Score\")","376da1e6":"sns.lineplot(data=cv_results,x=\"param_learning_rate\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_learning_rate\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Learning Rate\")\nplt.ylabel(\"Score\")","681d5c0a":"sns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Depth\")\nplt.ylabel(\"Score\")","5135f9a8":"sns.lineplot(data=cv_results,x=\"param_subsample\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_subsample\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Subsample\")\nplt.ylabel(\"Score\")","3cb9b0a5":"grid_model.best_params_","56f74b04":"XGBC=XGBClassifier(random_state=101,learning_rate=0.1,max_depth=3,n_estimators=15,subsample=0.3)\nXGBC.fit(X_train,y_train)","c37bd475":"y_pred=XGBC.predict(X_test)\ny_pred2=XGBC.predict(X_train)","54bc0c7e":"acc_XGBC=accuracy_score(y_test,y_pred)\nprint(\"Train: \",accuracy_score(y_train,y_pred2))\nprint(\"Test: \",accuracy_score(y_test,y_pred))","5387d249":"print(classification_report(y_test,y_pred))","fd94652a":"plot_confusion_matrix(XGBC,X_test,y_test);","756bb027":"fig,ax=plt.subplots(figsize=(12,6),dpi=100)\nplot_roc_curve(XGBC,X_test,y_test,ax=ax);","8813e16f":"from lightgbm import LGBMClassifier","20b4bc8e":"LGBMC= LGBMClassifier(random_state=101)\nparams={\n    \"n_estimators\":[5,10,15,20],\n    \"learning_rate\":[0.2,0.1,0.05],\n    \"max_depth\":[3,4,8],\n    \"subsample\":[0.3,0.6,0.9]\n}","59d271e4":"grid_model=GridSearchCV(LGBMC,params,return_train_score=True,verbose=2)\ngrid_model.fit(X_train,y_train)","6577433e":"cv_results=pd.DataFrame(grid_model.cv_results_)\ncv_results.head()","12f6814a":"sns.lineplot(data=cv_results,x=\"param_n_estimators\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_n_estimators\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"N Estimators\")\nplt.ylabel(\"Score\")","bbe66fce":"sns.lineplot(data=cv_results,x=\"param_learning_rate\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_learning_rate\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Learning Rate\")\nplt.ylabel(\"Score\")","ace23484":"sns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Depth\")\nplt.ylabel(\"Score\")","e897d84d":"sns.lineplot(data=cv_results,x=\"param_subsample\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_subsample\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Subsample\")\nplt.ylabel(\"Score\")","fb8f6c5c":"grid_model.best_params_","cd7f2fd2":"LGBMC=LGBMClassifier(random_state=101,learning_rate=0.05,max_depth=8,n_estimators=10,subsample=0.3)\nLGBMC.fit(X_train,y_train)","7b4b4f02":"y_pred=LGBMC.predict(X_test)\ny_pred2=LGBMC.predict(X_train)","e4b6deb3":"acc_LGBMC=accuracy_score(y_test,y_pred)\nprint(\"Train: \",accuracy_score(y_train,y_pred2))\nprint(\"Test: \",accuracy_score(y_test,y_pred))","a3a78b89":"print(classification_report(y_test,y_pred))","68565d74":"plot_confusion_matrix(LGBMC,X_test,y_test);","402bfb0a":"fig,ax=plt.subplots(figsize=(12,6),dpi=100)\nplot_roc_curve(LGBMC,X_test,y_test,ax=ax);","f7776448":"from catboost import CatBoostClassifier","65d0b821":"CBC=CatBoostClassifier(random_state=101)\nparams={\n    \"n_estimators\":[5,10,15],\n    \"learning_rate\":[0.2,0.1],\n    \"max_depth\":[3,4],\n    \"subsample\":[0.3,0.6]\n}","910a8e8d":"grid_model=GridSearchCV(CBC,params,return_train_score=True,verbose=2)\ngrid_model.fit(X_train,y_train)","194bee79":"cv_results=pd.DataFrame(grid_model.cv_results_)\ncv_results.head()","c972df4a":"sns.lineplot(data=cv_results,x=\"param_n_estimators\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_n_estimators\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"N Estimators\")\nplt.ylabel(\"Score\")","63fcb3b6":"sns.lineplot(data=cv_results,x=\"param_learning_rate\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_learning_rate\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Learning Rate\")\nplt.ylabel(\"Score\")","801574af":"sns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Depth\")\nplt.ylabel(\"Score\")","ac8ba553":"sns.lineplot(data=cv_results,x=\"param_subsample\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_subsample\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Subsample\")\nplt.ylabel(\"Score\")","aaa2c08a":"grid_model.best_params_","43a78292":"CBC=CatBoostClassifier(random_state=101,learning_rate=0.2,max_depth=4,n_estimators=5,subsample=0.6)\nCBC.fit(X_train,y_train)\n","5ece5c44":"y_pred=CBC.predict(X_test)\ny_pred2=CBC.predict(X_train)","e1440509":"acc_CBC=accuracy_score(y_test,y_pred)\nprint(\"Train: \",accuracy_score(y_train,y_pred2))\nprint(\"Test: \",accuracy_score(y_test,y_pred))","4f1cd189":"print(classification_report(y_test,y_pred))","c3c4b7c5":"plot_confusion_matrix(CBC,X_test,y_test);","9418312c":"fig,ax=plt.subplots(figsize=(12,6),dpi=100)\nplot_roc_curve(CBC,X_test,y_test,ax=ax);","f6c9fe0d":"from sklearn.naive_bayes import BernoulliNB","bc830519":"BNB=BernoulliNB()\nBNB.fit(X_train,y_train)","7db1dce3":"y_pred=BNB.predict(X_test)\ny_pred2=BNB.predict(X_train)","af3e54e6":"acc_BNB=accuracy_score(y_test,y_pred)\nprint(\"Train: \",accuracy_score(y_train,y_pred2))\nprint(\"Test: \",accuracy_score(y_test,y_pred))","7ad6ebf3":"print(classification_report(y_test,y_pred))","c880af87":"plot_confusion_matrix(BNB,X_test,y_test);","5b4e80da":"fig,ax=plt.subplots(figsize=(12,6),dpi=100)\nplot_roc_curve(BNB,X_test,y_test,ax=ax);","ff861cb7":"from sklearn.linear_model import SGDClassifier","81fa58b4":"SGDC=SGDClassifier(random_state=101)\nparams={\"alpha\":[0.0001,0.01,0.05,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0],\n        \"l1_ratio\": [0.1, 0.5,1]}","43e409c0":"grid_model=GridSearchCV(SGDC,params,return_train_score=True,verbose=2)\ngrid_model.fit(X_train,y_train)","ac787009":"cv_results=pd.DataFrame(grid_model.cv_results_)\ncv_results.head()","f3e86c10":"sns.lineplot(data=cv_results,x=\"param_alpha\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_alpha\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Alpha\")\nplt.ylabel(\"Score\")","34bafc2d":"sns.lineplot(data=cv_results,x=\"param_l1_ratio\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_l1_ratio\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"L1 Ratio\")\nplt.ylabel(\"Score\")","8e5b403a":"grid_model.best_params_","09d3a148":"SGDC=SGDClassifier(random_state=101,alpha=1.0,l1_ratio=0.1)\nSGDC.fit(X_train,y_train)","dd05350c":"y_pred=SGDC.predict(X_test)\ny_pred2=SGDC.predict(X_train)","440238b4":"acc_SGDC=accuracy_score(y_test,y_pred)\nprint(\"Train: \",accuracy_score(y_train,y_pred2))\nprint(\"Test: \",accuracy_score(y_test,y_pred))","71ea70e8":"print(classification_report(y_test,y_pred))","d6dbb508":"plot_confusion_matrix(SGDC,X_test,y_test);","d6e1b726":"fig,ax=plt.subplots(figsize=(12,6),dpi=100)\nplot_roc_curve(SGDC,X_test,y_test,ax=ax);","990bfacb":"from sklearn.ensemble import VotingClassifier\nclassifiers = [('Gradient Boosting Classifier', GBC), ('Cat Boost Classifier', CBC), ('XGboost', XGBC),  ('Decision Tree', DTC),\n               ('Extra Tree', ETC), ('Light Gradient', LGBMC), ('Random Forest', RFC), ('Ada Boost', ABC), ('Logistic', lr),\n               ('Knn', KNC),(\"Support Vector Classifier\",svc),(\"Ridge Classifier\",RC),(\"Stochastic Gradient Descent Classifier\",SGDC),(\"Bagging Classifier\",BC)]\n","6032a7b7":"vc = VotingClassifier(estimators = classifiers)\nvc.fit(X_train, y_train)","439f1bb6":"y_pred=vc.predict(X_test)\ny_pred2=vc.predict(X_train)\nacc_vc=accuracy_score(y_test,y_pred)\nprint(\"Train: \",accuracy_score(y_train,y_pred2))\nprint(\"Test: \",accuracy_score(y_test,y_pred))","629ed739":"print(classification_report(y_test,y_pred))","a75ce9aa":"plot_confusion_matrix(vc,X_test,y_test);","50b12adb":"models = pd.DataFrame({\n    'Model' : ['Logistic Regression', 'KNN', 'Decision Tree Classifier', 'Random Forest Classifier','Ada Boost Classifier',\n             'Gradient Boosting Classifier', 'XgBoost', 'Cat Boost', 'Extra Trees Classifier', 'LGBM', 'Voting Classifier'\n               , 'Ridge Classifier',\"Bagging Classifier\",\"SGDC\",\"Bernoulli NB\",\"Support Vector Classifier\"],\n    'Score' : [acc_lr, acc_KNC, acc_DTC, acc_RFC, acc_ABC, acc_GBC, acc_XGBC, acc_CBC, acc_ETC, acc_LGBMC, acc_vc, acc_RC,acc_BC,acc_SGDC,acc_BNB,acc_SVC]\n})\n\n\nmodels.sort_values(by = 'Score', ascending = False)","1d641937":"import plotly.express as px\npx.bar(data_frame = models, x = 'Score', y = 'Model', color = 'Score', template = 'plotly_dark', title = 'Models Comparison')","8b382a38":"# Swarm Behaviour Prediction","724be89b":"## LGBMClassifier","53020e3f":"## SGDClassifier","6d1101f8":"* Since the Tree is no overfitting we will not do any pruning.","3929e9d1":"## K Nearest Neighbors","4b810711":"## Ridge Classifier","49c0b56e":"## Decision Tree Classifier","220799bc":"## XGBClassifier","67dcea58":"# Dimensionality Technique (PCA)","707ec0cd":"# Models Creation","b64578cc":"* Little Bit of imbalance but not a problem.","57553b8d":"* Be carefoul here thoug that the recall score for 1.0 is a bit low compared to 0.0. Where our model may be a little affected by the imbalance of the data","b2a2177d":"* We se that at 400-500 components the variance of the data is catched very well","814f164c":"## Cat Boost Classifier","35b39dce":"* At 400 components is okay, we have the 90% of the variance. So we reduce from 2401 to 400. Thats almost the 17% of the data (Dimensionally speaking)","3c8039de":"## Bagging Classifier","870f0029":"* We see here that SGDC knocked it out of the park. The handling of the little imbalance in the data dont even affected the model","f6fe8ad8":"## Logistic Regression","5e60ce86":"## Extra Trees Classifier","59d33ad0":"#### Wee see we got good models here. But i personally would go for the SGDC a 90 scoree with a magnificent handling of the imbalance (see recall scores). We could even try to tune it a bit more. As i said, my computer is not a turtle but maybe a cousing of it hehe. So in a good machine you could train the models much more.","cc449e90":"# Data Preprocessing","e77063be":"## Random Forest Classifier","c0f1c820":"\n\n### Thats all, hope you liked. Any feedback is super welcomee.","5dfd5503":"* Here we see ADA handling imbalance pretty well","e2507e5a":"* Here we the Bagging being hardly affected by the imbalance. Something to check in the future if we wanna use this model","b4748982":"## Bernoulli NB","aae01d02":"* If you wonder, i didnt do grid because on my computer it was taking to loong. Consider that i just have 4gb and i3. So in a normal machine it would go faster. I would encourage you to do it, since the ADA with no hyperparameter tunning got a really good score","e4e3ffe9":"* XGBoost handling imbalance even better. This model will never let you down. =]","e7a409a2":"## Gradient Boost Classifier","acef26a5":"## Voting Classifier","2e7550a8":"* We scale for the PCA and future models","22de914a":"## Ada Boost Classifier","6705347c":"## Support Vector Classifier"}}