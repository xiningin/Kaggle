{"cell_type":{"b65036ad":"code","e441f508":"code","cbcb51ad":"code","987c4773":"code","cc1a4bed":"code","1c06b7b5":"code","ea34eec6":"code","05dbd607":"code","d0a70656":"code","6c4b8463":"code","4ed88c2a":"code","31063de3":"code","d495e46c":"code","099f3fcf":"code","d5c6f474":"code","f2c06aa8":"code","84bdbc4b":"code","74a89092":"code","d07501fb":"code","fb2ed03c":"code","c36f9340":"markdown","7fd94a3f":"markdown","d5aedde8":"markdown"},"source":{"b65036ad":"import fastai\nfrom fastai.vision.all import *\nfrom fastai.vision.widgets import *\nimport pandas as pd\nimport os","e441f508":"# for dirname, _, filenames in os.walk('\/kaggle\/input'):\n#     for filename in filenames:\n#         print(os.path.join(dirname, filename))","cbcb51ad":"path = Path(\"..\/input\/chinese-mnist\/data\/data\")\n\nPath.BASE_PATH = path\n\npath.ls()","987c4773":"df = pd.read_csv(\"..\/input\/chinese-mnist\/chinese_mnist.csv\")\ndf.head()","cc1a4bed":"# We can create a new column in Pandas and use our existing columns to concatenate our file names.\n\ndf['fname'] = (\"input_\" + df['suite_id'].astype(str) \n               + \"_\" \n               + df['sample_id'].astype(str) \n               + \"_\" \n               + df['code'].astype(str) \n               + \".jpg\")\ndf.head()","1c06b7b5":"def get_x(r): return path\/r['fname']\n\n#.astype() and .split() method were added to contain each label\ndef get_y(r): return r['value'].astype(str).split(\" \")","ea34eec6":"dblock = DataBlock(blocks=(ImageBlock, MultiCategoryBlock),\n                   splitter = RandomSplitter(seed=42),\n                   get_x = get_x,\n                   get_y = get_y,\n                   item_tfms = RandomResizedCrop(128, min_scale=0.35),\n                  )\ndls = dblock.dataloaders(df)","05dbd607":"len(dls.train), len(dls.valid)","d0a70656":"dls.show_batch()","6c4b8463":"dls.train_ds","4ed88c2a":"dls.valid_ds","31063de3":"learn = cnn_learner(dls, resnet18, metrics=partial(accuracy_multi,thresh=0.2))\nlearn.fine_tune(6)","d495e46c":"interp = ClassificationInterpretation.from_learner(learn)\ninterp.plot_top_losses(5, nrows=1)\n","099f3fcf":"interp.most_confused(5)","d5c6f474":"learn = cnn_learner(dls, resnet18, metrics=partial(accuracy_multi, thresh=0.2))\nlearn.lr_find()","f2c06aa8":"learn = cnn_learner(dls, resnet18, metrics=partial(accuracy_multi, thresh=0.2))\nlearn.fine_tune(6, base_lr=1e-2)","84bdbc4b":"learn.unfreeze()","74a89092":"learn.lr_find()","d07501fb":"learn.fit_one_cycle(6, 1e-4)","fb2ed03c":"learn.show_results()","c36f9340":"creating a dataframe","7fd94a3f":"from https:\/\/www.kaggle.com\/dinodelao\/fastai-v2-gpu-for-chinese-mnist-prediction","d5aedde8":"drfine functions to get the label items"}}