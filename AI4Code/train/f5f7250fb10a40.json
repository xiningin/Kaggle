{"cell_type":{"30127633":"code","054643b5":"code","708d0ff9":"code","f1c8ec6a":"code","feb7d7d0":"code","cccfd666":"code","524c9026":"code","2af5e996":"code","bea5c6a0":"code","a588b93f":"code","4b3035e0":"code","9f1ba879":"code","7dd827a5":"code","6d3e8a8a":"code","242a9dff":"code","29009f6a":"code","19433dc8":"code","856e5905":"code","4b3a0f36":"code","aacf80eb":"code","ccb26dca":"code","238d4123":"code","c321a851":"code","2b36d5f7":"code","4f6bb8ed":"code","259dfb79":"code","df37122f":"code","04f25cff":"code","06eb6df4":"code","89273b14":"code","3b89db02":"code","7d24f42a":"code","fc1faadb":"code","d8ae81e0":"code","e8c9900d":"code","e67480a5":"code","660f3231":"code","480148ec":"code","bad4a4ea":"code","046c55af":"code","1fc3ba42":"code","ac689a09":"code","3e56800b":"code","e9ab7639":"code","fcebde9b":"code","8d0788a6":"code","a0dc5ae0":"markdown","1082335e":"markdown","b88f04ce":"markdown","cef7aa08":"markdown","e9b3d94e":"markdown","410dcfbe":"markdown","215a901f":"markdown","9fd170e6":"markdown","c1a1778b":"markdown","3849a40a":"markdown","1364cf6d":"markdown","5641bc53":"markdown","e5a4fdf0":"markdown","589eccc3":"markdown","51e77928":"markdown","f24a88b2":"markdown","5267fdb4":"markdown","14842167":"markdown","a621c562":"markdown","6b0082f1":"markdown","3b7c0888":"markdown","def3787f":"markdown","c164c41d":"markdown","ba584da4":"markdown","14efe3ac":"markdown","62e4e4d2":"markdown","51b9b31d":"markdown","ded481ed":"markdown","71db02ab":"markdown","5ff03e10":"markdown","1aeddd87":"markdown","62f506a9":"markdown","1679e732":"markdown","a0447e06":"markdown","c3312124":"markdown","8f14fb6e":"markdown"},"source":{"30127633":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport math as m\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import mean_squared_error,mean_absolute_error,r2_score\nfrom scipy.stats import pearsonr,spearmanr","054643b5":"df=pd.read_csv('..\/input\/insurance.csv')","708d0ff9":"df.columns","f1c8ec6a":"sns.distplot(df.age)\ndf.age.describe()","feb7d7d0":"df.sex.value_counts()","cccfd666":"df.sex.value_counts()\/len(df.sex)","524c9026":"sns.distplot(df.bmi)\ndf.bmi.describe()","2af5e996":"df.children.value_counts()\/len(df)","bea5c6a0":"df.smoker.value_counts()\/len(df)","a588b93f":"df.region.value_counts()\/len(df)","4b3035e0":"sns.distplot(df.charges)","9f1ba879":"sns.distplot(df[df.smoker=='no'].charges,label='Non Smoker')\nsns.distplot(df[(df.smoker=='yes')&(df.charges<30000)].charges,label='Poor Smoker')\nsns.distplot(df[(df.smoker=='yes')&(df.charges>30000)].charges,label='Rich Smoker')\n\nplt.legend()","7dd827a5":"sns.distplot(df[df.smoker=='no'].charges,label='Non Smoker')\nplt.legend()","6d3e8a8a":"sns.distplot(np.log10(df[df.smoker=='no'].charges))","242a9dff":"#H0: Less Smoking, more Children\n\ndf.groupby('smoker')['children'].value_counts()\/df.groupby('smoker')['children'].count()\n","29009f6a":"#H0: Older people(Age above 60), Smoking habbit, Children\n\ndf[df.age>=60].groupby('smoker')['children'].value_counts()#\/df[df.age>=60].groupby('smoker')['children'].count()","19433dc8":"#H0: We loose BMI by Smoking\n\nsns.barplot(df.smoker,df.bmi)","856e5905":"#Who smokes more, male or Female\n\ndf.groupby('smoker')['sex'].value_counts()\/df.groupby('smoker')['sex'].count()","4b3a0f36":"# How Age impacts the BMI\n#H0: As the Age increases, BMI Increases,You gain weight.\n# Age correlated to weight.\n\nsns.scatterplot(df.age,df.bmi)","aacf80eb":"sns.scatterplot(df.bmi,df.charges)","ccb26dca":"df.groupby('region')['charges'].mean()","238d4123":"df.groupby('region')['smoker'].value_counts()\/df.groupby('region')['smoker'].count()","c321a851":"df.groupby('region')['sex'].value_counts()\/df.groupby('region')['sex'].count()","2b36d5f7":"# No relation between Bmi and children\n\nsns.barplot(df.children,df.bmi)","4f6bb8ed":"# Female will have less BMI, and with LESS BMI they pay less\n\nsns.barplot(df.sex,df.bmi)\ndf.groupby('sex')['bmi'].mean()","259dfb79":"# lets check the charges of Female who has BMI less than 30 and more than 30\n\nprint('Avg charge of a female who has BMI less than 30 is :'+str(df[(df.bmi<=30)&(df.sex=='female')]['charges'].mean()))\nprint('Avg charge of a female who has BMI less than 30 is :'+str(df[(df.bmi>30)&(df.sex=='female')]['charges'].mean()))\n","df37122f":"df.groupby('region')['bmi'].mean()","04f25cff":"df.groupby(['smoker','children'])['charges'].mean()","06eb6df4":"df[(df.children>=4)&(df.smoker=='yes')]","89273b14":"sns.scatterplot(df.age,df.charges)","3b89db02":"X=df[['age','sex','bmi','smoker','children','region']].copy()\nX.sex=X.sex.map(lambda x:1 if x=='male' else 0)\nX.smoker=X.smoker.map(lambda x:1 if x=='yes' else 0)\nX=X.drop(['region'],axis=1)\nlr=LinearRegression()\ny=df.charges\nlr.fit(X,y)\ny_hat=lr.predict(X)\nresiduals=y-y_hat\n","7d24f42a":"print('MSE:', mean_squared_error(y,y_hat))\nprint('RMSE:',mean_squared_error(y,y_hat)**0.5)\nprint('MAE:',mean_absolute_error(y,y_hat))\nprint('R2 Score:',r2_score(y,y_hat))","fc1faadb":"def adj_r2(y,y_hat,p):\n    r2=r2_score(y,y_hat)\n    n=len(y)\n    return 1 - (1-r2)*(n-1)\/(n-p-1)","d8ae81e0":"adj_r2(y,y_hat,X.shape[1])","e8c9900d":"adj_r2(y,y_hat,X.shape[1]+4)","e67480a5":"sns.pairplot(df,hue='smoker')","660f3231":"from scipy.stats import pearsonr\nsns.lmplot(data=df[df.smoker=='yes'],x='bmi',y='charges')\nprint('pearsonr:',pearsonr(df[df.smoker=='yes'].bmi,df[df.smoker=='yes'].charges)[0])","480148ec":"sns.lmplot(data=df[df.smoker==\"no\"],x=\"bmi\",y=\"charges\")","bad4a4ea":"df[\"obese\"]=df.bmi.map(lambda x:\"obese\" if x>30 else \"fit\")","046c55af":"sns.pairplot(df,hue=\"obese\")","1fc3ba42":"def obese_smoker(obese,smoker):\n    if obese==\"obese\" and smoker==\"yes\":\n        return \"fat_smoker\"\n    elif obese==\"fit\" and smoker==\"yes\":\n        return \"fit_smoker\"\n    elif obese==\"obese\" and smoker=='no':\n        return \"fat\"\n    else:\n        return \"fit\"  ","ac689a09":"df[\"fit_fat\"]=df[[\"obese\",\"smoker\"]].apply(lambda x: obese_smoker(x[\"obese\"],x[\"smoker\"]),axis=1)","3e56800b":"df.head(5)","e9ab7639":"X=df[['age', 'bmi', 'children', \"fit_fat\"]].copy()\nX=X.join(pd.get_dummies(X.fit_fat)).drop([\"fit_fat\"],axis=1)\nfrom sklearn.linear_model import LinearRegression\nlr=LinearRegression()\nlr.fit(X,y)\ny_hat=lr.predict(X)\nresiduals=y-y_hat\n\nprint(\"MSE:\",mean_squared_error(y,y_hat))\nprint(\"RMSE:\",mean_squared_error(y,y_hat)**0.5)\nprint(\"MAE:\",mean_absolute_error(y,y_hat))\nprint(\"R squared:\",r2_score(y,y_hat))","fcebde9b":"adj_r2(y,y_hat,X.shape[1])","8d0788a6":"for i,j in zip(X.columns,lr.coef_):\n    print(i,\"*\",j,\"+\")\nprint(lr.intercept_)","a0dc5ae0":"#The Adjusted R2 value looks not bad.. we can see how can this be tuned further for better score. ","1082335e":"'Age' is a uniform distribution","b88f04ce":"Taking log will maximize the bins clearly. ","cef7aa08":"#### What is Linear Regression? \nA statistical model that attempts to show the linear relationship between the variables with linear equation.\n","e9b3d94e":"#### UniVariate Analysis","410dcfbe":"This looks strange as both smoker and Non Smoker has the same BMI","215a901f":"#### MultiVariate Analysis","9fd170e6":"Compartively in NorthEast region , the charges are high","c1a1778b":"### Exploratory Data Analysis(EDA)","3849a40a":"2.SEX","1364cf6d":"COMMENTS\/SUGGESTIONS are always welcome. \n\nWill discuss More of it.. \n\nHappy Learning","5641bc53":"Will add another new column called 'fit_fat' and will label as fit smoker, fat smoker, fit and fat","e5a4fdf0":"Will add a new column called 'Obese' and will see how the data looks like. ","589eccc3":"As we can see here, charges are divided into 1 part till 30000, and into another part after 30000","51e77928":"Male smokes more than Female. ","f24a88b2":"### Lets Start Now... \nImport all the libraries required.\n","5267fdb4":"3.BMI","14842167":"So this model looks better than the before","a621c562":"No Smoking ppl has No children(0.431391)\n& Smoking ppl also has No children(0.419708)","6b0082f1":"## Data preparation","3b7c0888":"5.SMOKER","def3787f":"R Square Value: \n    This Value tells how close the data are to the fitted regression line. \n    Coefficient of determination or Coefficient of multiple determination\n\nThe Value should be close to 1(Regression line).\nIf the value is 1 - it means all the data points lies on the regression line. \n\nNote: It is also possible to have a low R Squared value for a good Model & high R Squared value for a line that does not fit at all. ","c164c41d":"#### What is Regression?\n\nRegression analysis is a form of preditive modelling technique which investigates the relationship between a dependant and independant variable.  \n\nUses:\n->Determining the strength of predictors\n->Forecasting an effect\n->Trend Forecasting\n\n    Concept                     : The data is modelled using a straight line\n    Used with                   : Continuous variable\n    Output\/Prediction           : Value of the Variable\n    Accuracy\/Goodness of fit    : measured by loss, R Squared, Adjusted R Squared. ","ba584da4":"In all the 4 regions, male and females are almost of equal numbers","14efe3ac":"4.CHILDREN","62e4e4d2":"7.CHARGES","51b9b31d":"1.AGE","ded481ed":"Male and Female has the same BMI more or less","71db02ab":"Import the DataSet from the path. ","5ff03e10":"6.REGION","1aeddd87":"OMG. In all the regions, the non smoker has been charged high than the smokers. so this shows that the Region is useless for predicting the charges","62f506a9":"#### Why Linear Regression? \n\nAs the Linear Regression is used to predict the Value of the Continuous Variable(Charges), we use it here. \nSuch as - sales made on a day, Temperature of a city.\nAnd the linear Regression is not good for discrete variable(Output)","1679e732":"## Things We Missed. ","a0447e06":"'BMI' is a unifirm distribution","c3312124":"In the above plot, \n'Non Smoker' describes about the charges for who doesn't Smoke at all.\n\n'Poor Smoker' descirbes about who smokes and thier charges are average. \n\n'Rich Smoker' descirbes about who smokes and their charges are High. ","8f14fb6e":"#### DATA SET INFORMATION:::\nThis is \"Sample Insurance Claim Prediction Dataset\" which based on \"[Medical Cost Personal Datasets][1]\" to update sample value on top.\n\nage : age of policyholder\n\nsex: gender of policy holder (female=0, male=1)\n\nbmi: Body mass index, providing an understanding of body, weights that are relatively high or low relative to height, objective index of body weight (kg \/ m ^ 2) using the ratio of height to weight, ideally 18.5 to 25 steps: average walking steps per day of policyholder \n\nchildren: number of children \/ dependents of policyholder \n\nsmoker: smoking state of policyholder (non-smoke=0;smoker=1) \n\nregion: the residential area of policyholder in the US (northeast=0, northwest=1, southeast=2, southwest=3)\n\ncharges: individual medical costs billed by health insurance \n\ninsuranceclaim: yes=1, no=0"}}