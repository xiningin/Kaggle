{"cell_type":{"1b57d64b":"code","1b410fb1":"code","c6be3805":"code","d27e00f5":"code","a1ad7386":"code","a3722944":"code","5fd09e6c":"code","7576dfd4":"code","a3fed7c4":"code","83f6d199":"code","5c6d199c":"code","5391ea67":"code","ab2bb200":"markdown","80c0bac1":"markdown","3f111c10":"markdown","89425d1b":"markdown","8c7da672":"markdown","99e6a064":"markdown","52a63640":"markdown"},"source":{"1b57d64b":"import pandas as pd\nimport numpy as np\nhit = pd.read_csv(\"..\/input\/hittlers\/Hitters.csv\")\ndf = hit.copy()\ndf = df.dropna()\ndms = pd.get_dummies(df[['League', 'Division', 'NewLeague']])\ny = df[\"Salary\"]\nX_ = df.drop(['Salary', 'League', 'Division', 'NewLeague'], axis=1).astype('float64')\nX = pd.concat([X_, dms[['League_N', 'Division_W', 'NewLeague_N']]], axis=1)\n\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, \n                                                    test_size=0.25, \n                                                    random_state=42)","1b410fb1":"from sklearn.svm import SVR\nsvr_rbf = SVR(\"rbf\").fit(X_train, y_train)","c6be3805":"import numpy as np\ny_pred=svr_rbf.predict(X_test)","d27e00f5":"from sklearn.metrics import mean_squared_error\nnp.sqrt(mean_squared_error(y_test,y_pred))","a1ad7386":"svr_rbf","a3722944":"svr_params= {\"C\":[0.1,0.4,5,10,20,30,\n               40,50]}","5fd09e6c":"from sklearn.model_selection import GridSearchCV\nsvr_cv_model= GridSearchCV(svr_rbf,svr_params,cv=10)\nsvr_cv_model.fit(X_train,y_train)","7576dfd4":"svr_cv_model.best_params_","a3fed7c4":"svr_tuned_cv_model=SVR(\"rbf\",C=pd.Series(svr_cv_model.best_params_)[0]).fit(X_train,y_train)","83f6d199":"y_pred=svr_tuned_cv_model.predict(X_test)","5c6d199c":"np.sqrt(mean_squared_error(y_test,y_pred))","5391ea67":"#Thanks to https:\/\/github.com\/mvahit\/DSMLBC","ab2bb200":"# 428 is test error for SVR tuned model. This is our real test error.\n# As you remember, we have found 367 for SVR untuned model(the previous ipynb )","80c0bac1":"# 5) MODEL TUNNING","3f111c10":"# 3)PREDICT","89425d1b":"# 4) TEST ERROR WITHOUT TUNNING","8c7da672":"# 1)IMPORT DATA AND SPLIT IT","99e6a064":"# 2)MODEL FIT","52a63640":"### Here, we want to optimize \"C\"parameter"}}