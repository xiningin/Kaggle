{"cell_type":{"c0800503":"code","4b782033":"code","bc31a93e":"code","176ea7f3":"code","a1371704":"code","856dcdf1":"markdown","e07bada1":"markdown"},"source":{"c0800503":"# \uce90\uae00\uc758 \ube45\ucffc\ub9ac \ub370\uc774\ud130 \uc911 \uc2dc\uce74\uace0 \ubc94\uc8c4 \ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub294 \ucf54\ub4dc\uc785\ub2c8\ub2e4. \nimport bq_helper\nfrom bq_helper import BigQueryHelper\n# https:\/\/www.kaggle.com\/sohier\/introduction-to-the-bq-helper-package\nchicago_crime = bq_helper.BigQueryHelper(active_project=\"bigquery-public-data\",\n                                   dataset_name=\"chicago_crime\")\nbq_assistant = BigQueryHelper(\"bigquery-public-data\", \"chicago_crime\")\nbq_assistant.list_tables()","4b782033":"#crime \ub370\uc774\ud130 \uc798 \uac00\uc838\uc654\ub294\uc9c0 \ud655\uc778\nbq_assistant.head('crime')","bc31a93e":"'''*\uceec\ub7fc\uc124\uba85*\n# 0. Unnamed: 0 : index\n1. unique_key : \uc0ac\uac74\ubc88\ud638\n2. case_number : \uc0ac\uac74 \uace0\uc720\ubc88\ud638 + RD(Residence\/domicile) \ubc88\ud638 \uac70\uc8fc\uc9c0\/\uc8fc\uc18c\n3. data : \uc0ac\uac74 \ubc1c\uc0dd \ucd94\uc815\uc77c\n4. block : \uc0ac\uac74 \ubc1c\uc0dd \uc8fc\uc18c\n5. iucr : \uc77c\ub9ac\ub178\uc774 \ud1b5\uc77c \ubc94\uc8c4 \ubcf4\uace0 \ucf54\ub4dc(\uac01 \ubc94\uc8c4\uba85 \uc804\uc6a9\ucf54\ub4dc)\n6. primary_type : \uc0ac\uac74\uc720\ud615\n7. description : \ube44\uace0\ub780\n8. location_description : \uc0ac\uac74 \ubc1c\uc0dd \uc7a5\uc18c\n9. arrest : \uccb4\ud3ec \uc5ec\ubd80(False\/True)\n10. domestic : \uac00\uc815\ud3ed\ub825 \uc5ec\ubd80(False\/True)\n# 11. beat : \uc9c0\uad6c\ub300(\ud30c\ucd9c\uc18c), \uc21c\ucc30 \uad00\ud560\uad6c\uc5ed\n12. district : \uc0ac\uac74\ubc1c\uc0dd \uad6c\uc5ed (Patrol)\n13. ward : \uc0ac\uac74\uc774 \ubc1c\uc0dd\ud55c \uc2dc \uc758\ud68c \uc9c0\uad6c\n14. community_area : \uc0ac\uac74\uc774 \ubc1c\uc0dd\ud55c \ucee4\ubba4\ub2c8\ud2f0 \uad6c\uc5ed\uc785\ub2c8\ub2e4.(\uc2dc\uce74\uace0\uc5d0\ub294 77\uac1c\uc758 \ucee4\ubba4\ub2c8\ud2f0 \uad6c\uc5ed\uc774 \uc788\uc74c)\n15. fbi_code : FBI \ubc94\uc8c4 \ucf54\ub4dc(\uc0ac\uac74 \uad00\ub828)\n# 16. x_coordinate : State Plane Illinois East NAD 1983 \ud22c\uc601\ubc95\uc5d0\uc11c \uc0ac\uac74\uc774 \ubc1c\uc0dd\ud55c \uc704\uce58\uc758 x \uc88c\ud45c\n# 17. y_coordinate : State Plane Illinois East NAD 1983 \ud22c\uc601\ubc95\uc5d0\uc11c \uc0ac\uac74\uc774 \ubc1c\uc0dd\ud55c \uc704\uce58\uc758 y \uc88c\ud45c\n18. year : \ubc1c\uc0dd\ub144\ub3c4(2015\ub144 \uc2dc\uc791)\n# 19. updated_on : \uc5c5\ub85c\ub4dc \ub0a0\uc9dc\n# 20. latitude : \uc704\ub3c4\n# 21. longitude : \uacbd\ub3c4\n22. location : \uc704\ub3c4 + \uacbd\ub3c4 '''","176ea7f3":"# \ub370\uc774\ud130\uc5d0\uc11c \uc6d0\ud558\ub294 \uc815\ubcf4\ub9cc \uac00\uc838\uc634\n\nquery1 = \"\"\"SELECT \n    date, \n    primary_type, \n    description, \n    location_description, \n    arrest, \n    domestic, \n    year, \n    location\nFROM\n  `bigquery-public-data.chicago_crime.crime`\nWHERE\n  year IN (2001)\n   \"\"\"\nresponse1 = chicago_crime.query_to_pandas_safe(query1)\nresponse1.head(10)","a1371704":"# \ub370\uc774\ud130\ud504\ub808\uc784\uc744 \uc800\uc7a5\ud574\uc8fc\ub294 \ucf54\ub4dc\uc785\ub2c8\ub2e4. \n# \ubc11\uc5d0\uc11c \ub450\ubc88\uc9f8 \uc904 \uad04\ud638 \uc548\uc5d0 \ub370\uc774\ud130\ud504\ub808\uc784 \uc774\ub984\uc744 \ub123\uace0 \uc2e4\ud589 \ud574\uc8fc\uc138\uc694.\nimport base64\nimport pandas as pd\nfrom IPython.display import HTML\n\ndef create_download_link( df, title = \"Download CSV file\", filename = \"data.csv\"):\n    csv = df.to_csv()\n    b64 = base64.b64encode(csv.encode())\n    payload = b64.decode()\n    html = '<a download=\"{filename}\" href=\"data:text\/csv;base64,{payload}\" target=\"_blank\">{title}<\/a>'\n    html = html.format(payload=payload,title=title,filename=filename)\n    return HTML(html)\n\ndf = pd.DataFrame(response1)\ncreate_download_link(df)","856dcdf1":"**How to Query the Chicago Crime Dataset (BigQuery)**","e07bada1":"Credit: Many functions are adaptations of https:\/\/cloud.google.com\/bigquery\/public-data\/chicago-crime-data"}}