{"cell_type":{"bdc1b6a6":"code","1d2d54d6":"code","7896ab9a":"code","2739d76d":"code","ae0eb6c0":"code","76c1a4ee":"code","8ddaaf9a":"code","f6eff933":"code","78a360df":"code","9ffe9913":"code","75c6be42":"code","8f84e2ad":"code","1636488e":"code","8b886682":"code","15b8d898":"code","7d721ba8":"code","c523cfd8":"code","28af385e":"code","8fc5e963":"code","7b04bc26":"code","2f272262":"code","a503b85e":"code","ddbfcc9d":"code","7e9c5ea2":"code","38cc38aa":"code","0dc68a6a":"code","bb4eeda4":"code","a19dfc3d":"code","3d043a17":"code","304f7a0f":"code","b1a8a1df":"code","f21ca551":"code","780f5539":"code","f01a34ea":"markdown","2bbb7a5f":"markdown","71a3a390":"markdown","8008a44b":"markdown","5ab070d6":"markdown","36e0045e":"markdown","4794be60":"markdown","ab48d39a":"markdown","54266cbb":"markdown","0a6a7d1a":"markdown","d98c0f7a":"markdown","1b98ca2e":"markdown","6b1dddfa":"markdown","b51b3c5e":"markdown","5e3c5e21":"markdown","61340d36":"markdown","f8c153ef":"markdown","6802f578":"markdown","609f8eac":"markdown","18281aee":"markdown","25ed77aa":"markdown","e9dc2213":"markdown","8eabf34f":"markdown","c71e9ca3":"markdown","e2a1a0f3":"markdown","3e6d323a":"markdown","90110774":"markdown","bdd5e6ed":"markdown","d3a3baf6":"markdown","30d1d703":"markdown","d8c9a755":"markdown","c5a7a5c4":"markdown","0463df44":"markdown","4b81c529":"markdown"},"source":{"bdc1b6a6":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")","1d2d54d6":"df = pd.read_csv(\"..\/input\/health-insurance-dataset\/Health_insurance.csv\")\ndata = df.copy()\ndata.head()","7896ab9a":"print(data.shape)","2739d76d":"print(data.dtypes)","ae0eb6c0":"print(data.isna().sum())","76c1a4ee":"sns.pairplot(data)\nplt.show()","8ddaaf9a":"print(data[\"region\"].value_counts())","f6eff933":"sns.countplot(x = data[\"region\"])\nplt.title(\"Comparing the data based on regions\")\nplt.xlabel(\"Regions\")\nplt.ylabel(\"Count\")\nplt.show()","78a360df":"print(data[\"sex\"].value_counts())","9ffe9913":"colors = sns.color_palette('pastel')[0:5]\nplt.pie(data[\"sex\"].value_counts(), labels = [\"Male\", \"Female\"], colors = colors, autopct='%.0f%%')\nplt.show()","75c6be42":"print(data[\"smoker\"].value_counts())","8f84e2ad":"sns.countplot(data=data, x=\"sex\", hue=\"smoker\")\nplt.title(\"Comparing the gender ratio in smokers category\")\nplt.xlabel(\"Sex\")\nplt.ylabel(\"Count\")\nplt.show()","1636488e":"sns.histplot(data[\"age\"],kde=True, color= sns.color_palette('colorblind')[2])\nplt.show()","8b886682":"colors = sns.color_palette('pastel')[0:5]\nplt.pie(data[\"children\"].value_counts(), labels = [\"Zero\", \"One\", \"Two\",\"Three\",\"Four\", \"Five\"],\n                                        colors = colors, autopct='%.0f%%')\nplt.show()","15b8d898":"from sklearn.preprocessing import LabelEncoder\nlabelEncoder = LabelEncoder()\ndata[\"sex\"] = labelEncoder.fit_transform(data[\"sex\"])\ndata[\"smoker\"] = labelEncoder.fit_transform(data[\"smoker\"])\ndata.head()","7d721ba8":"from sklearn.preprocessing import OneHotEncoder\nfrom sklearn.compose import ColumnTransformer\ncolumnTransformer = ColumnTransformer(transformers = [('encoder',OneHotEncoder(),[5])], remainder=\"passthrough\")\ndatavalues = columnTransformer.fit_transform(data)","c523cfd8":"X = datavalues[:,:-1]\ny = datavalues[:,-1]","28af385e":"print(X.shape)\nprint(y.shape)","8fc5e963":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X,y, test_size = 0.25, random_state=11)","7b04bc26":"print(X_train.shape)\nprint(X_test.shape)","2f272262":"print(data.var())","a503b85e":"from sklearn.preprocessing import StandardScaler\nst_X = StandardScaler()\nst_Y = StandardScaler()","ddbfcc9d":"X_train = st_X.fit_transform(X_train)\nX_test = st_X.transform(X_test)","7e9c5ea2":"y_train = st_Y.fit_transform(y_train.reshape(-1,1))\ny_test = st_Y.transform(y_test.reshape(-1,1))","38cc38aa":"from sklearn.ensemble import GradientBoostingRegressor","0dc68a6a":"gbr = GradientBoostingRegressor()\ngbr.fit(X_train,y_train)","bb4eeda4":"y_pred = gbr.predict(X_test)","a19dfc3d":"from sklearn.metrics import mean_absolute_error, mean_squared_error, r2_score","3d043a17":"print(\"Mean Absolute Error:\",mean_absolute_error(y_test, y_pred))","304f7a0f":"print(\"Mean Squared Error:\",mean_squared_error(y_test, y_pred))","b1a8a1df":"print(\"Root Mean Squared Error:\", np.sqrt(mean_squared_error(y_test, y_pred)))","f21ca551":"print(\"R Squared Value:\", r2_score(y_test, y_pred))","780f5539":"compare = pd.DataFrame({\"Actual\": y_test[:,0], \"Predicted\": y_pred.reshape(-1,1)[:,0]})\ncompare.head()","f01a34ea":"<div style=\"border-bottom:5px solid #b5179e; \n           padding: 20px 5px; border-radius: 5px;\">\n    <h3>Importing the dataset<\/h3>\n<\/div>","2bbb7a5f":"The data is clean without any missing or null values","71a3a390":"<h3 style=\"color: #480ca8\">Distribution of Age Attribute<\/h3>","8008a44b":"We have almost equal ratio of male and female data, with 51% and 49% respectively","5ab070d6":"<div style=\"border-bottom:5px solid #b5179e; \n           padding: 20px 5px; border-radius: 5px;\">\n    <h3>Splitting the Dependent and Independent variables<\/h3>\n<\/div>","36e0045e":"<div style=\"border-bottom:5px solid #b5179e; \n           padding: 20px 5px; border-radius: 5px;\">\n    <h3>Train Test Split Data<\/h3>\n<\/div>","4794be60":"We see that the data from Southwest, Northwest and Northeast have more or less a similar count, while data from Southeast is\nthe maximum","ab48d39a":"<h3 style=\"color: #480ca8\">Comparing the data based on Gender<\/h3>","54266cbb":"The count of non smokers is very large than that of smokers in both the gender category","0a6a7d1a":"<div style=\"background-color: #f72585; padding: 20px; border-radius: 5px; text-align: center \">\n    <h2 style=\"color: white\">HEALTH INSURANCE PREDICTION MODEL<\/h2>\n<\/div>","d98c0f7a":"All data preprocessing completed \u270c <br>\nTime to train the model!","1b98ca2e":"It is clear that majority of the data are that of people with no children","6b1dddfa":"<div style=\"border-bottom:5px solid #b5179e; margin-bottom:10px; \n           padding: 20px 5px; border-radius: 5px;\">\n    <h3>Data Features<\/h3>\n<\/div>\n<div style=\"font-size: 1.1em\">\n    <ul>\n        <li><strong style=\"color: #7209b7\">Age<\/strong> - Age of the person<\/li>\n        <li><strong style=\"color: #7209b7\">Sex<\/strong> - Gender of the person<\/li>\n        <li><strong style=\"color: #7209b7\">BMI<\/strong> - Body Mass Index of the person<\/li>\n        <li><strong style=\"color: #7209b7\">Children<\/strong> - Count of Children of the person<\/li>\n        <li><strong style=\"color: #7209b7\">Smoker<\/strong> - Smoking Status of the person<\/li>\n        <li><strong style=\"color: #7209b7\">Region<\/strong> - Region to which the person belongs to<\/li>\n        <li><strong style=\"color: #7209b7\">Charges <\/strong>- The target variable, the Insurance Charge the person is eligible for<\/li>\n    <\/ul>\n<\/div>","b51b3c5e":"Model is trained and tested \u270c\u270c<br>\nTime to evaluate the performance of the model","5e3c5e21":"<div style=\"border-bottom:5px solid #b5179e; \n           padding: 20px 5px; border-radius: 5px;\">\n    <h3>Training the model<\/h3>\n<\/div>","61340d36":"We have 4 numerical attributes and 3 categorical attributes in our data","f8c153ef":"It is important to encode the categorical attributes in the dataset, so that it can be used properly\n<ul>\n    <li>Sex - Encoded as Male <code>1<\/code> Female <code>0<\/code><\/li>\n    <li>Smoker - Encoded as Yes <code>1<\/code> No <code>0<\/code><\/li>\n    <li>Region - Transformed into 4 columns - <code>southwest<\/code> <code>southeast<\/code> <code>northwest<\/code> <code>northeast<\/code><\/li>\n<\/ul>","6802f578":"<div style=\"border-bottom:5px solid #b5179e; \n           padding: 20px 5px; border-radius: 5px;\">\n    <h3>Importing the required packages<\/h3>\n<\/div>","609f8eac":"<h3 style=\"color: #480ca8\">Comparing the Gender ratio in Smokers category<\/h3>","18281aee":"<h3 style=\"color: #480ca8\">Mean Absolute Error<\/h3>\n<img src = \"https:\/\/miro.medium.com\/max\/630\/1*OVlFLnMwHDx08PHzqlBDag.gif\" >","25ed77aa":"We got an R<sup>2<\/sup> score of almost 87% \u270c\ud83d\ude04","e9dc2213":"<h3 style=\"color: #480ca8\">Root Mean Squared Error<\/h3>\n<img src = \"https:\/\/miro.medium.com\/max\/966\/1*lqDsPkfXPGen32Uem1PTNg.png\" >","8eabf34f":"<div style=\"border-bottom:5px solid #b5179e; \n           padding: 20px 5px; border-radius: 5px;\">\n    <h3>Visualizing the data<\/h3>\n<\/div>","c71e9ca3":"<h3 style=\"color: #480ca8\">Coefficient of Determination - R<sup>2<\/sup> Value<\/h3>\n<img src = \"https:\/\/www.gstatic.com\/education\/formulas2\/397133473\/en\/coefficient_of_determination.svg\" >","e2a1a0f3":"<div style=\"border-bottom:5px solid #b5179e; \n           padding: 20px 5px; border-radius: 5px;\">\n    <h3>Scaling the Data<\/h3>\n<\/div>","3e6d323a":"<div style=\"border-bottom:5px solid #b5179e; \n           padding: 20px 5px; border-radius: 5px;\">\n    <h3>Comparing The Actual And Predicted Values<\/h3>\n<\/div>","90110774":"<div style=\"border-bottom:5px solid #b5179e; margin-bottom:10px; \n           padding: 20px 5px; border-radius: 5px;\">\n    <h3>Introduction<\/h3>\n<\/div>\n<div style=\"font-size: 1.1em\">\n    Linear regression is a linear model, e.g. a model that assumes a linear relationship between the input variables <code>x<\/code> and the single output variable <code>y<\/code>. It can be said that <code>y<\/code> can be calculated from a linear combination of the input variables <code>x<\/code>.<br><br>\n    When there is a single input variable <code>x<\/code>, the method is referred to as <strong>simple linear regression<\/strong>. \n    <h2 style=\"text-align:center\">y = b<sub>0<\/sub> + b<sub>1<\/sub>x<\/h2> <br>\n    When there are multiple input variables <code>x<sub>1<\/sub><\/code>,<code>x<sub>2<\/sub><\/code>...<code>x<sub>n<\/sub><\/code>, the method is referred as <strong>multiple linear regression<\/strong>.\n    <h2 style=\"text-align:center\">y = b<sub>0<\/sub> + b<sub>1<\/sub>x<sub>1<\/sub>+ b<sub>2<\/sub>x<sub>2<\/sub>+ ... + b<sub>n<\/sub>x<sub>n<\/sub><\/h2>\n<\/div>\n\n    \n        \n    \n","bdd5e6ed":"<div style=\"border-bottom:5px solid #b5179e; \n           padding: 20px 5px; border-radius: 5px;\">\n    <h3>Evaluating the model<\/h3>\n<\/div>","d3a3baf6":"<img src = \"https:\/\/m.economictimes.com\/thumb\/msid-69278711,width-1200,height-900,resizemode-4,imgsize-132321\/home-insurance-getty.jpg\">","30d1d703":"<h3 style=\"color: #480ca8\">Comparing the data based on Regions<\/h3>","d8c9a755":"<h3 style=\"color: #480ca8\">Mean Squared Error<\/h3>\n<img src = \"https:\/\/lh3.googleusercontent.com\/-JBio3Q_1FiI\/YB2oQKEmRBI\/AAAAAAAAAkM\/c8KJ3wPwtMEd3Ik0nYMMdmr_pRqMF6MlQCLcBGAsYHQ\/w550-h177\/image.png\" >","c5a7a5c4":"<h3 style=\"color: #480ca8\">Comparing the data based on Children Count<\/h3>","0463df44":"<h4 style=\"color: #7209b7\">If you liked the notebook and found it useful to learn, give an upvote \ud83d\udc4d\ud83c\udffb and share it with your friends \ud83d\ude04\ud83d\ude04<\/h4>\n<h4 style=\"color: #001219\">\ud83d\ude04Do check out my other notebooks at: <a href = \"https:\/\/www.kaggle.com\/harshinisk\">https:\/\/www.kaggle.com\/harshinisk<\/a><\/h4>\n","4b81c529":"<div style=\"border-bottom:5px solid #b5179e; \n           padding: 20px 5px; border-radius: 5px;\">\n    <h3>Encoding Categorical Attributes<\/h3>\n<\/div>"}}