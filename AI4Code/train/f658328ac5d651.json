{"cell_type":{"85887f0f":"code","9d5a35b0":"code","0b4a10bd":"code","356e4476":"code","f22e289d":"code","dbbc3391":"code","80f0c4d2":"code","464c32da":"code","0a4890e7":"code","a58645ad":"code","f064374e":"code","9e33db53":"code","ec1121df":"code","ef773689":"code","5d9840bd":"code","732ca678":"code","6d40bf65":"code","cc752443":"code","9490e2a9":"code","e035f899":"code","02ee9c42":"code","16c87bed":"code","debdfb4e":"markdown","162a6f6d":"markdown","0eca9c05":"markdown","ac676ef7":"markdown","aa30cde9":"markdown"},"source":{"85887f0f":"import pandas as pd\nimport numpy as np\nfrom scipy.stats import ttest_ind","9d5a35b0":"states_dict = {'OH': 'Ohio', 'KY': 'Kentucky', 'AS': 'American Samoa', 'NV': 'Nevada', \n               'WY': 'Wyoming', 'NA': 'National', 'AL': 'Alabama', 'MD': 'Maryland', \n               'AK': 'Alaska', 'UT': 'Utah', 'OR': 'Oregon', 'MT': 'Montana', \n               'IL': 'Illinois', 'TN': 'Tennessee', 'DC': 'District of Columbia', \n               'VT': 'Vermont', 'ID': 'Idaho', 'AR': 'Arkansas', 'ME': 'Maine', \n               'WA': 'Washington', 'HI': 'Hawaii', 'WI': 'Wisconsin', 'MI': 'Michigan', \n               'IN': 'Indiana', 'NJ': 'New Jersey', 'AZ': 'Arizona', 'GU': 'Guam', \n               'MS': 'Mississippi', 'PR': 'Puerto Rico', 'NC': 'North Carolina', \n               'TX': 'Texas', 'SD': 'South Dakota', 'MP': 'Northern Mariana Islands', \n               'IA': 'Iowa', 'MO': 'Missouri', 'CT': 'Connecticut', 'WV': 'West Virginia', \n               'SC': 'South Carolina', 'LA': 'Louisiana', 'KS': 'Kansas','NY': 'New York', \n               'NE': 'Nebraska', 'OK': 'Oklahoma', 'FL': 'Florida', 'CA': 'California', \n               'CO': 'Colorado', 'PA': 'Pennsylvania', 'DE': 'Delaware', 'NM': 'New Mexico', \n               'RI': 'Rhode Island', 'MN': 'Minnesota', 'VI': 'Virgin Islands', \n               'NH': 'New Hampshire', 'MA': 'Massachusetts', 'GA': 'Georgia', \n               'ND': 'North Dakota', 'VA': 'Virginia'}","0b4a10bd":"colnames = ['City', 'State']\nuniv_towns = pd.read_csv('..\/input\/university-towns\/university_towns.txt', sep='\\n', header=None, names=colnames)","356e4476":"univ_towns.head()","f22e289d":"univ_towns['City'] = univ_towns['City'].str.replace('\\[.*$','')","dbbc3391":"univ_towns['City'] = univ_towns['City'].str.replace('\\ \\(.*$','')","80f0c4d2":"univ_towns.head()","464c32da":"univ_towns['State'] = univ_towns.loc[univ_towns['City'].isin(states_dict.values())]['City']","0a4890e7":"univ_towns.head()","a58645ad":"univ_towns['City'] = univ_towns.loc[~univ_towns['City'].isin(states_dict.values())]['City']","f064374e":"univ_towns['State'] = univ_towns['State'].ffill()","9e33db53":"univ_towns","ec1121df":"univ_towns = univ_towns.dropna()","ef773689":"univ_towns = univ_towns.set_index(['State','City'])","5d9840bd":"gdp = pd.read_excel('..\/input\/university-towns\/gdplev.xls', skiprows=219)\ngdp.head()","732ca678":"gdp = gdp.rename(columns={'1999q4': 'Quarter', 12323.3:'GDP'})\ngdp = gdp[['Quarter','GDP']]","6d40bf65":"gdp.head()","cc752443":"def get_recession_start():\n    i = 2\n    length = len(gdp['GDP'])\n    while i < length:\n        if gdp.GDP[i] < gdp.GDP[i-1] and gdp.GDP[i-1] < gdp.GDP[i-2]:\n            return gdp.Quarter[i-1]\n        i += 1\n\nget_recession_start()","9490e2a9":"def get_recession_end():\n    i = 2\n    length = len(gdp['GDP'])\n    in_recession = False\n    while i < length:\n        if gdp.GDP[i] < gdp.GDP[i-1] and gdp.GDP[i-1] < gdp.GDP[i-2]:\n            in_recession = True\n        if in_recession == True and gdp.GDP[i] > gdp.GDP[i-1] and gdp.GDP[i-1] > gdp.GDP[i-2]:\n            return gdp.Quarter[i]\n        i += 1\n    return recession_end\n\nget_recession_end()","e035f899":"def get_recession_bottom():\n    i = 2\n    length = len(gdp['GDP'])\n    in_recession = False\n    lowest_gdp = np.inf\n    while i < length:\n        if gdp.GDP[i] < gdp.GDP[i-1] and gdp.GDP[i-1] < gdp.GDP[i-2]:\n            in_recession = True\n        if in_recession == True and gdp.GDP[i] < lowest_gdp:\n            lowest_gdp = gdp.GDP[i]\n            return gdp.Quarter[i]\n        if in_recession == True and gdp.GDP[i] > gdp.GDP[i-1] and gdp.GDP[i-1] > gdp.GDP[i-2]:\n            in_recession = False\n        i+=1\n    return recession_bottom\n\nget_recession_bottom()","02ee9c42":"def convert_housing_data_to_quarters():\n    \"\"\"\n    Converts the housing data to quarters and returns it as mean \n    values in a dataframe. \n    \"\"\"\n    \n    housing_data = pd.read_csv('..\/input\/university-towns\/City_Zhvi_AllHomes.xls',encoding='latin-1')\n    housing_data['State'].replace(states_dict, inplace=True)\n    housing_data = housing_data.set_index([\"State\",\"RegionName\"])\n    housing_data = housing_data.iloc[:,49:250]\n    \n    def quarters(col):\n        if col.endswith((\"01\", \"02\", \"03\")):\n            s = col[:4] + \"q1\"\n        elif col.endswith((\"04\", \"05\", \"06\")):\n            s = col[:4] + \"q2\"\n        elif col.endswith((\"07\", \"08\", \"09\")):\n            s = col[:4] + \"q3\"\n        else:\n            s = col[:4] + \"q4\"\n        return s  \n    \n    housing_data = housing_data.groupby(quarters, axis=1).mean()\n    housing_data = housing_data.sort_index()\n    return housing_data\n\nconvert_housing_data_to_quarters()","16c87bed":"def run_ttest():\n    housing_data = convert_housing_data_to_quarters()\n    better = None\n    isin_list = housing_data.index.isin(univ_towns.index).astype(bool)\n    housing_data.insert(loc=0, column='isit_univ', value=isin_list)\n    \n    univ_town = housing_data[housing_data['isit_univ']==True]\n    not_univ_town = housing_data[housing_data['isit_univ']==False]\n    \n    univ_ratio = univ_town[get_recession_start()] \/ univ_town[get_recession_bottom()]\n    not_univ_ratio = not_univ_town[get_recession_start()] \/ not_univ_town[get_recession_bottom()]\n    p_value = ttest_ind(univ_ratio.dropna(), not_univ_ratio.dropna())[1]\n    different = p_value < .01\n    \n    if univ_ratio.mean() < not_univ_ratio.mean():\n        better = 'university town'\n    else:\n        better = 'non-university town'\n    return (different, p_value, better)\n\nrun_ttest()","debdfb4e":"# Explore economic data\nNext, to get the start of the recession, let\u2019s load data from the BEA and find the recession\u2019s start. A recession is defined as starting with two consecutive quarters of GDP decline, and ending with two consecutive quarters of GDP growth.","162a6f6d":"# Run t-test\nNext, we\u2019ll create new data showing the decline or growth of housing prices between the recession start and the recession bottom.\n\nAnd finally, we\u2019ll run a t-test comparing the university town values to the non-university towns values, return whether the alternative hypothesis (that the two groups are the same) is true or not, and the p-value of our confidence.\n\nThe function will return the tuple (different, p, better) where different=True if the t-test is True at a p<0.01 (we reject the null hypothesis), or different=False if otherwise (we cannot reject the null hypothesis). The variable p should be equal to the exact p value returned from scipy.stats.ttest_ind(). The value for better should be either \u201cuniversity town\u201d or \u201cnon-university town\u201d depending on which has a lower mean price ratio (which is equivilent to a reduced market loss)","0eca9c05":"# Cleaning","ac676ef7":"# Hypothesis Testing: Are university towns more resilient to recession than non-university towns?\nFor an early project, I sought to use Python to examine if university towns are more resilient to economic downturn than non-university towns. More specifically, I asked are the housing prices in university towns less effected by recession?\n\nTo start, a university town is a city which has a high percentage of university students compared to the total population of the city.\n\nThe hypothesis is that we can expect housing prices in such cities to be less effected by recession mostly because we should expect similar numbers of students, staff, and other workers connected to university life to live in such towns, regardless of the economic outlook.\n\nTo get a list of university towns, I simply used [Wikipedia](https:\/\/en.wikipedia.org\/wiki\/List_of_college_towns#College_towns_in_the_United_States), which maintains a list of college towns in the United States. For a spreadsheet on housing prices across the United States, I used [Zillow](https:\/\/www.zillow.com\/research\/data\/), which included data from 1996\u20132020 in [City_Zhvi_AllHomes.csv](http:\/\/files.zillowstatic.com\/research\/public\/City\/City_Zhvi_AllHomes.csv). And lastly, I used the U.S. Department of Commerce, Bureau of Economic Analysis (BEA) to figure out when exactly the \u2018Great Recession\u2019 of 2007\u20132009 started and when the recession reached its bottom i.e. the quarter within the recession which had the lowest GDP. This was necessary because I sought to compare housing prices at the start of the recession to prices at the bottom.","aa30cde9":"# Conclusion\nAs we can see, there is a difference between the mean housing prices of university towns and non-university towns. As the p-value is less than .01, we can reject the null-hypothesis (that there is no significant different between university towns and non-university towns). In other words, we can see that there is a difference between university towns and non-university towns and that university towns are, indeed, less effected by recession."}}