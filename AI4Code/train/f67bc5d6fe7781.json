{"cell_type":{"5a8d7978":"code","68fd1977":"code","4e278cc6":"code","9b89a5cd":"code","483b50e1":"code","921e59fa":"code","358c6766":"code","33e3b510":"code","5f5a72f4":"code","ea964f6e":"code","563d5796":"markdown"},"source":{"5a8d7978":"import pandas as pd\nfrom sklearn import preprocessing\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import roc_curve\nfrom sklearn.metrics import roc_auc_score\nimport matplotlib.pyplot as plt \nplt.rc(\"font\", size=14)\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import train_test_split\nimport seaborn as sns\nsns.set(style=\"white\")\nsns.set(style=\"whitegrid\", color_codes=True)\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","68fd1977":"df = pd.read_csv('..\/input\/train.csv')\ndf_test= pd.read_csv('..\/input\/test.csv')\nprint(df.head(3))","4e278cc6":"X = df.iloc[:,2:202]\ny = df.iloc[:,1]","9b89a5cd":"sns.countplot(x='target',data=df, palette='hls')\nplt.show()","483b50e1":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.5, random_state=2)","921e59fa":"classifier = LogisticRegression(random_state=0,solver='lbfgs',max_iter=2000,tol=0.01)\nclassifier.fit(X_train, y_train)","358c6766":"y_pred = classifier.predict(X_test)\nconfusion_matrix = confusion_matrix(y_test, y_pred)\nprint(confusion_matrix)","33e3b510":"# calculate AUC\nauc = roc_auc_score(y_test, y_pred)\nprint('AUC: %.3f' % auc)\n# calculate roc curve\nfpr, tpr, thresholds = roc_curve(y_test, y_pred)\n# plot no skill\nplt.plot([0, 1], [0, 1], linestyle='--')\n# plot the roc curve for the model\nplt.plot(fpr, tpr, marker='.')\n# show the plot\nplt.show()","5f5a72f4":"print('Accuracy of logistic regression classifier on test set: {:.2f}'.format(classifier.score(X_test, y_test)))","ea964f6e":"df_x_test = df_test.drop(columns = ['ID_code'])\ny_pred = classifier.predict(df_x_test)\ndf_y = pd.DataFrame(y_pred)\ndf_submission = pd.merge(pd.DataFrame(df_test['ID_code']),df_y,left_index=True,right_index=True)\n#df_submission.to_csv('..\/input\/submit.csv', encoding='utf-8', index=False)\nprint(df_submission)","563d5796":"Microsoft Azure NC6 with Ubuntu 18.06. Here is how to setup Azure for Kaggle Competitions:\nhttp:\/\/www.etedal.net\/2019\/03\/setting-up-azure-nc6-for-kaggle.html\n\nThis Kernel uses Logistic Regression"}}