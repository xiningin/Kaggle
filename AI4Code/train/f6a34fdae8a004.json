{"cell_type":{"5d3c3dda":"code","7f123af9":"code","750ec214":"code","7d59706b":"code","04ba6ff9":"code","464248da":"code","1d99ff85":"code","5cb279e4":"code","a583ce0c":"code","141185d6":"code","f392037b":"code","f03416b7":"markdown","ab764aa7":"markdown","3d3d5569":"markdown","bb5b94c1":"markdown","56f709dc":"markdown","04de2e5a":"markdown","a76d05e7":"markdown","a57c8d36":"markdown","3c554e58":"markdown"},"source":{"5d3c3dda":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)","7f123af9":"!pip install ctgan\n!pip install sdv","750ec214":"from sdv.tabular import CTGAN\nfrom sdv.evaluation import evaluate","7d59706b":"train_df = pd.read_csv('\/kaggle\/input\/30-days-of-ml\/train.csv')","04ba6ff9":"train_df.drop(columns=['id'], inplace=True)\ntrain_df.info()","464248da":"import warnings\n\nwarnings.filterwarnings('ignore')","1d99ff85":"batch_size = 5000\nepochs = 100\nmodel = CTGAN(batch_size=batch_size, epochs=epochs, verbose=True)\nmodel.fit(train_df)","5cb279e4":"model.save('ctgan_30daysofml_model.pkl')","a583ce0c":"n_generated_data = 10_000\ngenerated_df = model.sample(n_generated_data)","141185d6":"score = evaluate(generated_df, train_df.sample(n_generated_data))\nprint(f\"Similarity: {score:0.5f}\")","f392037b":"generated_df.to_csv(\"generated_train_data.csv\", index=False)","f03416b7":"You now can sample new data as follows:","ab764aa7":"Assure it is compatible with the original data by measuring similarity between generated data and the original one.","3d3d5569":"Now proceed importing the required tools:","bb5b94c1":"# Installing and Importing Packages\n\nFirst install the following packages:\n1. [CTGAN](https:\/\/pypi.org\/project\/ctgan\/)\n2. [SDV](https:\/\/pypi.org\/project\/sdv\/)","56f709dc":"Dropping `id` column because it is an index not part of original data.","04de2e5a":"Save your trained model to use later for generating new data.","a76d05e7":"Two important hyper-parameters to set are `batch_size` and `epoch`.\n\n* Please notice that the value that you set on the `batch_size` argument must always be a multiple of 10!*\n\nsklearn may show a lot of warnings in the process, thus you can turn warnings off. (this is actually a known [issue](https:\/\/github.com\/sdv-dev\/SDV\/issues\/568))\n","a57c8d36":"# Train GAN Model","3c554e58":"# Read Original Data\n\nCTAGN is a generative neural network, it will be trained on the`train.csv` of the 30 days of ML competition. "}}