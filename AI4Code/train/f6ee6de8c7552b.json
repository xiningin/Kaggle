{"cell_type":{"8afbd73f":"code","70591036":"code","823f32a9":"code","0e984bbc":"code","bc8eb411":"code","a48687ce":"code","b9fe7ccc":"code","3aee267d":"code","c581dc6f":"code","f4e7309c":"code","c2313a95":"code","2be69fcc":"code","258a9989":"code","9c349da8":"code","95da2e39":"code","6dfd41fb":"code","97eaf9b9":"code","b076ce5b":"code","44e7aab0":"code","c3a99e7b":"code","2a0dd783":"markdown","97e9687a":"markdown","8c9ffaed":"markdown","ca21f7d0":"markdown","ae79c458":"markdown","b8a2eb02":"markdown","abf19f46":"markdown","0812fd45":"markdown","559b35a2":"markdown","8d9d0050":"markdown","1ed877a0":"markdown","1fcac12a":"markdown","3577d6cc":"markdown","33b7d1be":"markdown","c079d986":"markdown","b57d143e":"markdown","e9d6675d":"markdown","53e071a4":"markdown","2352bb85":"markdown"},"source":{"8afbd73f":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nfrom sklearn.linear_model import LogisticRegression\nimport matplotlib.pyplot as plt\nfrom sklearn.utils import shuffle\nfrom sklearn.model_selection import GridSearchCV\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nfrom subprocess import check_output\nprint(check_output([\"ls\", \"..\/input\"]).decode(\"utf8\"))\n\n# Any results you write to the current directory are saved as output.\n","70591036":"data_dir = '..\/input\/google-cloud-ncaa-march-madness-2020-division-1-mens-tournament\/MDataFiles_Stage1\/'\ndf_seeds = pd.read_csv(data_dir + 'MNCAATourneySeeds.csv')\ndf_tour = pd.read_csv(data_dir + 'MNCAATourneyCompactResults.csv')\n","823f32a9":"df_seeds.head()\n","0e984bbc":"df_tour.head()\n","bc8eb411":"def seed_to_int(seed):\n    \n    \"\"\"Get just the digits from the seeding. Return as int\n    \"\"\"\n    s_int = int(seed[1:3])\n    return(s_int)\n\ndf_seeds['seed_int'] = df_seeds.Seed.apply(seed_to_int)\ndf_seeds.drop(labels=['Seed'], inplace=True, axis=1) # here the string label\n","a48687ce":"df_seeds.head()","b9fe7ccc":"df_winseeds = df_seeds.rename(columns={'TeamID':'WTeamID', 'seed_int':'WSeed'})\ndf_lossseeds = df_seeds.rename(columns={'TeamID':'LTeamID', 'seed_int':'LSeed'})\n\ndf_dummy = pd.merge(left=df_tour, right=df_winseeds, how='left', on=['Season', 'WTeamID'])\ndf_concat = pd.merge(left=df_dummy, right=df_lossseeds, on=['Season', 'LTeamID'])\n\ndf_concat['SeedDiff'] = df_concat.WSeed - df_concat.LSeed # difference seed\n\n# Let's concat dataframes and show it !\n\ndf_concat.head()","3aee267d":"# Winners \n\ndf_wins = pd.DataFrame()\ndf_wins['SeedDiff'] = df_concat['SeedDiff']\ndf_wins['result'] = 1\n\n# Losses\ndf_losses = pd.DataFrame()\ndf_losses['SeedDiff'] = -df_concat['SeedDiff']\ndf_losses['result'] = 0\n\n# Concat them together\n\ndf_for_predictions = pd.concat((df_wins, df_losses))","c581dc6f":"df_for_predictions.head()","f4e7309c":"X_train = df_for_predictions.SeedDiff.values.reshape(-1,1)\n\ny_train = df_for_predictions.result.values\n","c2313a95":"X_train, y_train = shuffle(X_train, y_train)\n","2be69fcc":"logregModel = LogisticRegression()\n\nparams = {'C': np.logspace(start=-5, stop=3, num=9)}\nclf = GridSearchCV(logregModel, params, scoring='neg_log_loss', refit=True)\nclf.fit(X_train, y_train)","258a9989":"print('Best log_loss: {:.4}, with best C: {}'.format(clf.best_score_, clf.best_params_['C']))\n","9c349da8":"X = np.arange(-15, 15).reshape(-1, 1)\npreds = clf.predict_proba(X)[:,1]","95da2e39":"plt.plot(X, preds)\nplt.xlabel('Team1 seed - Team2 seed')\nplt.ylabel('P(Team1 will win)')","6dfd41fb":"df_sample_sub = pd.read_csv('..\/input\/google-cloud-ncaa-march-madness-2020-division-1-mens-tournament\/MSampleSubmissionStage1_2020.csv')\n\nn_test = len(df_sample_sub)\n\n# get the year\n\ndef get_year_t1_t2(ID):\n    \"\"\"Return a tuple with ints `year`, `team1` and `team2`.\"\"\"\n    return (int(x) for x in ID.split('_'))","97eaf9b9":"X_test = np.zeros(shape=(n_test, 1))\n\nfor i, row in df_sample_sub.iterrows():\n    \n    year, t1, t2 = get_year_t1_t2(row.ID)\n    \n    t1_seed = df_seeds[(df_seeds.TeamID == t1) & (df_seeds.Season == year)].seed_int.values[0]\n    t2_seed = df_seeds[(df_seeds.TeamID == t2) & (df_seeds.Season == year)].seed_int.values[0]\n    diff_seed = t1_seed - t2_seed\n    X_test[i, 0] = diff_seed","b076ce5b":"preds = clf.predict_proba(X_test)[:,1] # predictor\n\n\nclipped_preds = np.clip(preds, 0.05, 0.95) # clipped predictions\n\ndf_sample_sub.Pred = clipped_preds\n","44e7aab0":"df_sample_sub.head()","c3a99e7b":"df_sample_sub.to_csv('Submission.csv', index=False)","2a0dd783":"## Merge seed for each team\nWe want the seeds in the same DataFrame as the game results\nthat's why we gonna Merge the Seeds with their corresponding TeamIDs in the compact results dataframe","97e9687a":"Finally, create your submission file!\n\n","8c9ffaed":"Let's Shuffle Our DataFrame","ca21f7d0":"This Notebook inspired by the Starter kernel [Basic Starter Kernel - NCAA Women's Dataset](https:\/\/www.kaggle.com\/juliaelliott\/basic-starter-kernel-ncaa-women-s-dataset) by [Jullia Eulliot](https:\/\/www.kaggle.com\/juliaelliott)\n\nThe idea is to create a basic Logistic Regression Model based on the seed differences between teams !\nNote : The Stage's 1 Submissions File is based on expected outcomes \nFor Stage 2, you will be predicting future outcomes based on the teams selected for the tournament.\nif you need to know more about the competition you can check this [comment](https:\/\/www.kaggle.com\/c\/google-cloud-ncaa-march-madness-2020-division-1-mens-tournament\/discussion\/135057#769427)","ae79c458":"## Make predictions","b8a2eb02":"## I hope you find this kernel useful and enjoyable.\n## Your comments and feedback are most welcome.\n\n## Happy Kaggling","abf19f46":"Let's Check the new dataframe","0812fd45":"Next  we'll create a new  dataframe that summarizes wins & losses along with their corresponding seed differences.\n\nThis is the meat of what we'll be creating our model on.","559b35a2":"Show up the result","8d9d0050":"[](https:\/\/www.google.com\/url?sa=i&url=http%3A%2F%2Fqbardarien.com%2Fcalendar%2Fq-event-list%2F293-march-madness-2020-at-q-bar-darien%3Fdate%3D2020-03-26-17-00&psig=AOvVaw28oFASgDMYBa6bE2-zqmKC&ust=1584120730706000&source=images&cd=vfe&ved=0CAIQjRxqFwoTCLDAn_-LlugCFQAAAAAdAAAAABAD)","1ed877a0":"then , Let's drop the columns we are not planning on using\n\n","1fcac12a":"## Evaluate the Model and show the best score","3577d6cc":"## Loading Data","33b7d1be":"## Acknowledgements\n\n#### This Notebook uses such great kernels : \n\n- [Logistic Regression on Tournament seeds](https:\/\/www.kaggle.com\/kplauritzen\/notebookde27b18258?scriptVersionId=804590)\n- [2020 March Madness Data - First Look EDA](https:\/\/www.kaggle.com\/robikscube\/2020-march-madness-data-first-look-eda)\n- [NCAAM20no-leak starter](https:\/\/www.kaggle.com\/code1110\/ncaam20-finally-no-leak-starter)\n- [Basic Starter Kernel - NCAA Women's Dataset](https:\/\/www.kaggle.com\/juliaelliott\/basic-starter-kernel-ncaa-women-s-dataset)\n\nBefore we get started I want to thank Kaggle and each member here for sharing such huge concepts , without their efforts i can't write this notebook \nwith such ease !\n\nSo, without wasting any time, let's start with importing some important python modules that I'll be using.\n\n","c079d986":"## Overview","b57d143e":"Note :  as Shown below  the probability a team will win decreases as the seed differential to its opponent decreases as well .","e9d6675d":"## Train Our Linear Regression Model\nWe'll Use a basic logistic regression to train Our model. \nYou can set different C values to see how performance changes.\n\n\n","53e071a4":"Next , we will make prediction with our LR Model","2352bb85":"### Examine the classifier predictions"}}