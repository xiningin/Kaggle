{"cell_type":{"4a467ce2":"code","1ca21ccc":"code","0470d644":"code","59d180c1":"code","160ee639":"code","35811919":"code","76402d51":"code","bbab37ef":"code","d766818d":"code","2ab6c7fc":"markdown","1530fdfa":"markdown","0bb3e1d8":"markdown","d43b016f":"markdown","33521dda":"markdown","809cc795":"markdown"},"source":{"4a467ce2":"import numpy as np\nimport pandas as pd\nimport os\nimport matplotlib.pyplot as plt\nfrom PIL import Image","1ca21ccc":"compare_df = pd.read_csv(\"..\/input\/errorfortrain\/erroran-2.csv\",index_col=[0])\ncompare_df","0470d644":"error_df = compare_df[compare_df['label']!=compare_df['p_label']]\ncorrect_df = compare_df[compare_df['label']==compare_df['p_label']]\nerror_df","59d180c1":"error_4_x = error_df[error_df['label']==4]\nerror_4_x","160ee639":"def show_image(image_ids, labels, plabels):\n    plt.figure(figsize=(16, 12))\n    for ind, (image_id, label, plabel) in enumerate(zip(image_ids, labels, plabels)):\n        plt.subplot(3, 3, ind + 1)\n        image = Image.open(os.path.join('..\/input\/cassava-leaf-disease-classification\/train_images',image_id))\n        plt.imshow(image)\n        plt.title(f\"Class: {label} - Predict: {plabel}\", fontsize=12)\n        plt.axis(\"off\")\n    plt.show()\n    \ndef show_batch(batch_index, df):\n    image_ids = df[9*batch_index:9*(batch_index+1)][\"image_id\"].values\n    labels = df[9*batch_index:9*(batch_index+1)][\"label\"].values\n    plabels = df[9*batch_index:9*(batch_index+1)][\"p_label\"].values\n    show_image(image_ids, labels, plabels)\n    \ndef show_one_inbatch(batch_index, i,df):\n    image_id = df['image_id'].values[9*batch_index+i]\n    image = Image.open(os.path.join('..\/input\/cassava-leaf-disease-classification\/train_images',image_id))\n    plt.figure(figsize=(10, 10))\n    plt.imshow(image)\n    plt.title(df[df['image_id']==image_id]['prob'].values[0], fontsize=18)\n    plt.show()","35811919":"show_batch(0,error_4_x)","76402d51":"show_one_inbatch(0, 0, error_4_x)","bbab37ef":"error_x_4 = error_df[error_df['p_label']==4]\nshow_batch(0,error_x_4)","d766818d":"show_one_inbatch(0, 4, error_x_4)","2ab6c7fc":"As I desperate to make a little tiny improvement in public leaderboard, it comes to my mind that I should check how is my poor model actually doing. My model's accuracy is about 0.87-0.88. After training, I ran it on the whole training set and saved result in \"erroran-2.csv\". ","1530fdfa":"Though predicted as healthy, the probability for CBB is 0.27, only 0.02 less than healthy. So I think maybe my model isn't that bad. Looking at how model actually performs does cheer me up. You should try it too. Thanks for your time.","0bb3e1d8":"The first one should be classified as \"Cassava Bacterial Blight(CBB)\" as my model suggests. Let's look at ones wrongfully predicted as healthy.","d43b016f":"Most of them don't look healthy.","33521dda":"\"label\" is ground truth from \"train.csv\". \"p_label\" and \"prob\" is predicted by my model.","809cc795":"Error rate is 0.12. Let's focus on \"Healthy\" class where my model disagrees with ground truth."}}