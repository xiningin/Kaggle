{"cell_type":{"004c05f8":"code","1248b13c":"code","5957578f":"code","70e10530":"code","4b551d0d":"code","206bb17f":"code","99db2a3a":"code","ddb8bfde":"code","1430240b":"code","7f678a31":"code","805b55c6":"code","334a348d":"code","36509597":"code","7224ef8d":"code","ea600097":"code","6a8b7d2a":"code","68f8607c":"code","0cf4bab6":"code","68614f45":"code","ee5cfa69":"markdown","cafb0a5e":"markdown","ea7217b6":"markdown","5aa125a3":"markdown","8696fd95":"markdown","fdf9129c":"markdown","9e42ba53":"markdown","13e8d058":"markdown","06ed7290":"markdown","98b20d45":"markdown","4f251641":"markdown","468d301f":"markdown","646d517c":"markdown"},"source":{"004c05f8":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline","1248b13c":"path = 'https:\/\/s3-api.us-geo.objectstorage.softlayer.net\/cf-courses-data\/CognitiveClass\/DA0101EN\/automobileEDA.csv'\ndf = pd.read_csv(path)\ndf.head()","5957578f":"df.dtypes","70e10530":"df.describe()","4b551d0d":"df.dtypes\nfor x in df:\n    if df[x].dtypes == \"int64\":\n        df[x] = df[x].astype(float)\n        print (df[x].dtypes)","206bb17f":"df = df.select_dtypes(exclude=['object'])\ndf=df.fillna(df.mean())\nX = df.drop('price',axis=1)\ny = df['price']","99db2a3a":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)","ddb8bfde":"from sklearn.svm import SVR","1430240b":"svr = SVR(kernel = 'linear',C = 1000)","7f678a31":"from sklearn.preprocessing import StandardScaler","805b55c6":"sc= StandardScaler().fit(X_train)","334a348d":"X_train_std = sc.transform(X_train)\nX_test_std = sc.transform(X_test)\nX_test_std","36509597":"svr.fit(X_train_std,y_train)\ny_test_pred = svr.predict(X_test_std)\n","7224ef8d":"y_train_pred = svr.predict(X_train_std)","ea600097":"y_test_pred","6a8b7d2a":"from sklearn import metrics\n\nprint('Mean Squared Error:', metrics.mean_squared_error(y_test, y_test_pred))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y_test, y_test_pred)))","68f8607c":"from sklearn.metrics import r2_score\nr2_score(y_train,y_train_pred)","0cf4bab6":"r2_score(y_test,y_test_pred)","68614f45":"import seaborn as sns\nplt.figure(figsize=(5, 7))\n\n\nax = sns.distplot(y, hist=False, color=\"r\", label=\"Actual Value\")\nsns.distplot(y_test_pred, hist=False, color=\"b\", label=\"Fitted Values\" , ax=ax)\n\n\nplt.title('Actual vs Fitted Values for Price')\n\n\nplt.show()\nplt.close()","ee5cfa69":"dtypes gives the data type of coloumn","cafb0a5e":"lets check our predicted values","ea7217b6":"In the above dataframe all the coloumns are not numeric. So we will consider only those coloumn whose values are in numeric and will make all numeric to float.","5aa125a3":"We will create an object svr using the impo function SVM.We will use the kernel as linear.","8696fd95":"Here the X variable contains all the columns from the dataset, except 'Price' column, which is the label. The y variable contains values from the 'Price' column, which means that the X variable contains the attribute set and y variable contains the corresponding labels.","fdf9129c":"df.head() will give us the details fo top 5 rows of every cooloumn. We can use df.tail() to get the last 5 rows and similiary df.head(10) to get top 10 rows.\n\nThe data is about cars and we need to predict the price of car using the above data\n\nWe will be using Decision Tree to get the price of the car.","9e42ba53":"Now our data has been standarised.","13e8d058":"The above is the graph between the actual and predicted values","06ed7290":"in order to work in an efficient manner we will standardize our data.SVM works on distance of points so its necessary that all our data should be of same standard.","98b20d45":"Our R sqrt score for test data is 0.72 and for train data is 0.85 which is a good value.","4f251641":"Time to check modal performance","468d301f":"Training SVM","646d517c":"Preparing the Data As with the classification task, in this section we will divide our data into attributes and labels and consequently into training and test sets. We will create 2 data set,one for price while the other (df-price). Since pur dataframe has many data in object format, for this analysis we are removing all the coloumn with object type and for all NaN value we are removig that row"}}