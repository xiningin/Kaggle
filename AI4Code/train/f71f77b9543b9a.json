{"cell_type":{"7962250a":"code","68017742":"code","b2fb2869":"code","7ed61366":"code","950a6e2c":"code","4b4c2ff8":"code","da213b97":"code","81707be5":"code","11322e0b":"markdown","e664d9ce":"markdown","7556b0ea":"markdown","eccd7cd3":"markdown"},"source":{"7962250a":"# Instalando o pacote h2o\n!pip install h2o","68017742":"# Importando as bibliotecas\nimport pandas as pd\nimport h2o\nfrom h2o.automl import H2OAutoML\n\n# Inicializando o cluster\nh2o.init()\nh2o.cluster().show_status()","b2fb2869":"# Importando os datasets   \ntrain = h2o.import_file('\/kaggle\/input\/competicao-dsa-machine-learning-dec-2019\/dataset_treino.csv')\ntest = h2o.import_file('\/kaggle\/input\/competicao-dsa-machine-learning-dec-2019\/dataset_teste.csv')\n\n# Convertendo a coluna target em fator\ntrain['target'] = train['target'].asfactor()","7ed61366":"# Indicando as colunas preditoras e a target\nx = train.columns\ny = 'target'\n\n# Converter o target em fator\ntrain[y] = train[y].asfactor()\n\n# Executa o AutoML para 20 modelos (limitado a 1h de duracao m\u00e1xima)\naml = H2OAutoML(max_models=10, seed=0)\naml.train(x=x, y=y, training_frame=train)","950a6e2c":"# AutoML Leaderboard\nlb = aml.leaderboard\n\n# Exibir as colunas do resultado dos modelos\nlb.head(rows=lb.nrows)","4b4c2ff8":"# Detalhes do melhor modelo\naml.leader","da213b97":"# Gerar as previsoes no dataset de teste\npreds = aml.leader.predict(test)\n\n# Salvar o resultado no dataset de teste\nresult = preds[:,2]\ntest['PredictedProb'] = result","81707be5":"# Gravar o arquivo de submiss\u00e3o ao Kaggle\nh2o.export_file(test[['ID', 'PredictedProb']],'submission_h2o.csv')","11322e0b":"# Executando o H2OAutoML","e664d9ce":"# Competi\u00e7\u00e3o DSA de Machine Learning - Dezembro 2019\n### Testes com H2O AutoML","7556b0ea":"# Submissions","eccd7cd3":"# Importando as bibliotecas"}}