{"cell_type":{"a1f6aed1":"code","bc77749b":"code","dfa0e874":"code","d1600930":"code","5e27e88d":"code","5f173f44":"code","cbffd28d":"code","2edaa7da":"code","171afdff":"code","dbc09e61":"code","b9129db2":"code","b2578de2":"code","2e302b81":"code","ea24cae8":"code","faf8a684":"code","7a69d12b":"code","83ad52f4":"code","55a38dd4":"code","8b9ab763":"code","4e3fa08e":"code","f1ffa6a9":"code","4cef44ec":"code","63e568ab":"code","577f5aae":"code","b6f00dde":"code","c7daba78":"code","99fddd58":"code","7a071ce4":"code","2c2a289e":"code","75148c1d":"code","cec679a9":"code","ae3dc2c5":"code","d2b5b315":"code","032d7c1c":"code","2a54f28f":"code","e99a3504":"code","ad27ede0":"code","d87a1013":"code","62f57983":"code","b319ce24":"code","44e6a962":"code","5cf4b3f9":"code","e32e0fae":"code","b697a1e6":"code","5049430d":"code","c00a11bf":"code","ec94a591":"code","ce956b4f":"code","39e1289e":"code","1e948dd4":"code","8105f3d4":"code","871ca0d2":"code","d02ef074":"code","e49f41f3":"code","d8873814":"code","518e7f5d":"code","28684bdf":"code","3c922000":"code","22dd44f7":"code","cd846987":"code","f19b54c6":"code","9f94ad70":"code","84027273":"code","4ad88011":"code","c895c3b0":"code","94ce7a7f":"code","8c06294e":"code","c05bb3df":"code","6e66e459":"code","d6c3d25d":"code","b9346a82":"code","ebf4d536":"code","78bb2f7f":"code","d5d0f72c":"code","2b3e643d":"code","cbbbcc81":"code","9bba4840":"code","e9cedb8a":"code","21d4a91d":"code","b3087238":"code","50a61879":"code","9e8287a8":"code","ab0442ad":"code","dd1b91fd":"code","7dab8dfe":"code","b3a6afa4":"code","dbdecd5c":"code","0b6a94cd":"code","ec4821c2":"code","22c3c636":"code","a6f1f864":"code","fc129dd5":"code","942ce3d8":"code","9808e6f1":"code","8d527057":"code","6884d349":"code","1930a588":"code","b1d2cd1d":"code","4a668091":"code","33767f3f":"code","5e665f81":"code","9f95ae94":"code","9029d4a4":"code","eaedfeac":"code","b44c579c":"code","d06d01ce":"code","0186f97e":"code","758be783":"code","6023ba21":"code","f36982c7":"code","c2d209f1":"code","ed13129b":"code","0fab39e4":"code","026683b7":"code","fddc546b":"code","6b7ec606":"code","0670fe8f":"code","667b6b52":"code","b9a73150":"code","894671f5":"code","e7a47892":"code","f3f5f466":"code","ff2119c1":"code","63d8be45":"code","5fcce060":"code","3661a955":"code","2c2f687a":"code","c97c3e2b":"code","5e139d2b":"code","569558d9":"code","41658221":"code","9369c152":"code","bfe6c86c":"code","d8d9f134":"code","e0462737":"code","158c482f":"code","41c83910":"code","649f50d2":"code","5c4d786e":"code","bf5bcef4":"code","66868366":"code","d023c232":"code","cc737315":"code","e17b7e10":"code","d49c6c1e":"code","c1254cb8":"code","38785b34":"code","b9b3c216":"code","c04a95d8":"code","f02bbf20":"code","5e734d3a":"code","1903795b":"code","c7fd6796":"markdown","7d1f1a26":"markdown","3a7d2c39":"markdown","9084ffa6":"markdown","596d7db5":"markdown","ae9d7e53":"markdown","7e6a8fc6":"markdown","4c88e508":"markdown","c47852b1":"markdown","14fc31b1":"markdown","fb739b77":"markdown","a607a7b9":"markdown","bf5037a7":"markdown","e76ab818":"markdown","3c82ec9f":"markdown","22d99008":"markdown","bc819f21":"markdown","39139f3c":"markdown","91f6387d":"markdown","501042cb":"markdown","978bf875":"markdown","50ed50b3":"markdown","a105fc14":"markdown","1c81a298":"markdown","03af1d9a":"markdown","9f173b21":"markdown","2864b891":"markdown","776a0598":"markdown","e51c0f0e":"markdown","88af2c43":"markdown","f47b0e70":"markdown","019d5b89":"markdown","4fc3a46e":"markdown","f39e5b68":"markdown","202b496b":"markdown","a5d89435":"markdown","278611c0":"markdown","e4bfbf12":"markdown","eeb7d505":"markdown","3390715b":"markdown","56c13a8b":"markdown","5dcba4c9":"markdown","e15149fc":"markdown"},"source":{"a1f6aed1":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","bc77749b":"df=pd.read_csv(\"\/kaggle\/input\/default-of-credit-card-clients-dataset\/UCI_Credit_Card.csv\")","dfa0e874":"df.head()","d1600930":"df.iloc[0:1,:].transpose()","5e27e88d":"df.info()","5f173f44":"df.describe().transpose()","cbffd28d":"df[\"default.payment.next.month\"].unique()","2edaa7da":"df[\"default.payment.next.month\"].value_counts()","171afdff":"fig=plt.figure(figsize=(7,7))\nsns.countplot(x=\"default.payment.next.month\",data=df,palette=\"magma\")","dbc09e61":"fig=plt.figure(figsize=(20,15))\naxes=fig.add_axes([0,0,0.8,0.8])\nsns.heatmap(df.corr(),annot=True,cmap=\"viridis\")","b9129db2":"fig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\ndist=sns.distplot(df[\"LIMIT_BAL\"],color=\"purple\")\naxes.ticklabel_format(style=\"plain\",axis=\"x\")","b2578de2":"fig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nbox=sns.boxplot(y=\"LIMIT_BAL\",x=\"default.payment.next.month\",palette=\"viridis\",data=df)\n","2e302b81":"df[\"LIMIT_BAL\"].nunique()","ea24cae8":"df[\"LIMIT_BAL\"].nunique()","faf8a684":"fig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nsns.countplot(x=\"LIMIT_BAL\",order=df[\"LIMIT_BAL\"].value_counts().head(5).index,data=df,palette=\"ocean_r\")","7a69d12b":"df[df[\"LIMIT_BAL\"]> 150000][\"default.payment.next.month\"].value_counts()","83ad52f4":"df[df[\"LIMIT_BAL\"]< 150000][\"default.payment.next.month\"].value_counts()","55a38dd4":"fig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nsns.countplot(x=\"SEX\",data=df,palette=\"cividis\")","8b9ab763":"fig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nbox=sns.violinplot(y=\"LIMIT_BAL\",x=\"SEX\",palette=\"rocket\",data=df)\n","4e3fa08e":"fig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nbox=sns.boxplot(y=\"LIMIT_BAL\",x=\"SEX\",palette=\"cubehelix\",data=df,hue=\"default.payment.next.month\")\n","f1ffa6a9":"fig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nsns.countplot(x=\"EDUCATION\",data=df,palette=\"Reds\")","4cef44ec":"df[\"EDUCATION\"].value_counts()","63e568ab":"df.shape","577f5aae":"df=df.drop(df[df[\"EDUCATION\"]==0].index)","b6f00dde":"df.shape","c7daba78":"def com(x):\n    if x==5 or x==6:\n        return 5\n    else:\n        return x\n\ndf[\"EDUCATION\"]=df[\"EDUCATION\"].apply(lambda x:com(x))","99fddd58":"df[\"EDUCATION\"].value_counts()","7a071ce4":"fig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nsns.countplot(x=\"EDUCATION\",data=df,palette=\"Reds\")","2c2a289e":"li=[]\nfor i in df[\"EDUCATION\"].unique():\n    a=(len(df[(df[\"EDUCATION\"]==i) & (df[\"default.payment.next.month\"]==1)].index)\/len(df[df[\"EDUCATION\"]==i].index)*100)\n    li.append(a)","75148c1d":"ed=pd.DataFrame({\"Education\":df[\"EDUCATION\"].unique(),\"% of Defaulters\":li})","cec679a9":"ed.set_index(\"Education\")","ae3dc2c5":"fig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nsns.barplot(x=\"Education\",y=\"% of Defaulters\",data=ed,palette=\"Blues\")","d2b5b315":"fig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nbox=sns.boxplot(y=\"LIMIT_BAL\",x=\"EDUCATION\",palette=\"bwr\",data=df,hue=\"default.payment.next.month\")\n","032d7c1c":"fig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\ndist=sns.distplot(df[\"AGE\"],color=\"green\",bins=45)\naxes.ticklabel_format(style=\"plain\",axis=\"x\")","2a54f28f":"sns.jointplot(y=\"LIMIT_BAL\",x=\"AGE\",data=df)","e99a3504":"fig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nbox=sns.boxplot(y=\"AGE\",x=\"default.payment.next.month\",palette=\"afmhot\",data=df)","ad27ede0":"fig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nbox=sns.boxplot(y=\"AGE\",x=\"default.payment.next.month\",palette=\"tab20\",data=df,hue=\"EDUCATION\")","d87a1013":"df[\"PAY_0\"].unique()","62f57983":"df[\"PAY_0\"].value_counts()","b319ce24":"li='PAY_0\tPAY_2\tPAY_3\tPAY_4\tPAY_5\tPAY_6\t'.split()","44e6a962":"def com(x):\n    if x==-2 or x==0:\n        return -1\n    else:\n        return x\n\nfor i in li:\n    df[i]=df[i].apply(lambda x:com(x))","5cf4b3f9":"df[\"PAY_0\"].value_counts()","e32e0fae":" sns.countplot(x=\"PAY_0\",data=df)","b697a1e6":"li=[]\nfor i in df[\"PAY_0\"].unique():\n    a=(len(df[(df[\"PAY_0\"]==i) & (df[\"default.payment.next.month\"]==1)].index)\/len(df[df[\"PAY_0\"]==i].index)*100)\n    li.append(a)","5049430d":"ed=pd.DataFrame({\"PAY_0\":df[\"PAY_0\"].unique(),\"% of Defaulters\":li})\ned.set_index(\"PAY_0\")","c00a11bf":"fig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nsns.barplot(x=\"PAY_0\",y=\"% of Defaulters\",data=ed,palette=\"twilight\")","ec94a591":"li=[]\nfor i in df[\"PAY_2\"].unique():\n    a=(len(df[(df[\"PAY_2\"]==i) & (df[\"default.payment.next.month\"]==1)].index)\/len(df[df[\"PAY_2\"]==i].index)*100)\n    li.append(a)\n\ned=pd.DataFrame({\"PAY_2\":df[\"PAY_2\"].unique(),\"% of Defaulters\":li})\ned.set_index(\"PAY_2\")\n\nfig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nsns.barplot(x=\"PAY_2\",y=\"% of Defaulters\",data=ed,palette=\"twilight\")","ce956b4f":"li=[]\nfor i in df[\"PAY_3\"].unique():\n    a=(len(df[(df[\"PAY_3\"]==i) & (df[\"default.payment.next.month\"]==1)].index)\/len(df[df[\"PAY_3\"]==i].index)*100)\n    li.append(a)\n\ned=pd.DataFrame({\"PAY_3\":df[\"PAY_3\"].unique(),\"% of Defaulters\":li})\ned.set_index(\"PAY_3\")\n\nfig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nsns.barplot(x=\"PAY_3\",y=\"% of Defaulters\",data=ed,palette=\"twilight\")","39e1289e":"li=[]\nfor i in df[\"PAY_4\"].unique():\n    a=(len(df[(df[\"PAY_4\"]==i) & (df[\"default.payment.next.month\"]==1)].index)\/len(df[df[\"PAY_4\"]==i].index)*100)\n    li.append(a)\n\ned=pd.DataFrame({\"PAY_4\":df[\"PAY_4\"].unique(),\"% of Defaulters\":li})\ned.set_index(\"PAY_4\")\n\nfig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nsns.barplot(x=\"PAY_4\",y=\"% of Defaulters\",data=ed,palette=\"twilight\")","1e948dd4":"li=[]\nfor i in df[\"PAY_5\"].unique():\n    a=(len(df[(df[\"PAY_5\"]==i) & (df[\"default.payment.next.month\"]==1)].index)\/len(df[df[\"PAY_5\"]==i].index)*100)\n    li.append(a)\n\ned=pd.DataFrame({\"PAY_5\":df[\"PAY_5\"].unique(),\"% of Defaulters\":li})\ned.set_index(\"PAY_5\")\n\nfig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nsns.barplot(x=\"PAY_5\",y=\"% of Defaulters\",data=ed,palette=\"twilight\")","8105f3d4":"li=[]\nfor i in df[\"PAY_6\"].unique():\n    a=(len(df[(df[\"PAY_6\"]==i) & (df[\"default.payment.next.month\"]==1)].index)\/len(df[df[\"PAY_6\"]==i].index)*100)\n    li.append(a)\n\ned=pd.DataFrame({\"PAY_6\":df[\"PAY_6\"].unique(),\"% of Defaulters\":li})\ned.set_index(\"PAY_6\")\n\nfig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nsns.barplot(x=\"PAY_6\",y=\"% of Defaulters\",data=ed,palette=\"twilight\")","871ca0d2":"df[\"MARRIAGE\"].unique()","d02ef074":"df[\"MARRIAGE\"].value_counts()","e49f41f3":"fig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nsns.countplot(x=\"MARRIAGE\",data=df,palette=\"icefire\")","d8873814":"fig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nsns.boxplot(x=\"MARRIAGE\",y=\"LIMIT_BAL\",data=df)","518e7f5d":"li=[]\nfor i in df[\"MARRIAGE\"].unique():\n    a=(len(df[(df[\"MARRIAGE\"]==i) & (df[\"default.payment.next.month\"]==1)].index)\/len(df[df[\"MARRIAGE\"]==i].index)*100)\n    li.append(a)\n\ned=pd.DataFrame({\"MARRIAGE\":df[\"MARRIAGE\"].unique(),\"% of Defaulters\":li})\ned.set_index(\"MARRIAGE\")\n\nfig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nsns.barplot(x=\"MARRIAGE\",y=\"% of Defaulters\",data=ed,palette=\"Wistia\")","28684bdf":"fig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nsns.boxplot(x=\"MARRIAGE\",y=\"AGE\",data=df)","3c922000":"fig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nsns.boxplot(x=\"MARRIAGE\",y=\"BILL_AMT1\",data=df)","22dd44f7":"df[df[\"BILL_AMT1\"]<0][\"PAY_0\"].value_counts()","cd846987":"df.shape","f19b54c6":"len(df[df[\"BILL_AMT1\"]<0])","9f94ad70":"(len(df[(df[\"BILL_AMT1\"]<0) & (df[\"default.payment.next.month\"]) == 1])\/len(df[df[\"BILL_AMT1\"]<0]))*100","84027273":"(len(df[(df[\"BILL_AMT1\"]>=0) & (df[\"default.payment.next.month\"]) == 1])\/len(df[df[\"BILL_AMT1\"]>=0]))*100","4ad88011":"fig=plt.figure(figsize=(10,7))\nsns.jointplot(x=\"BILL_AMT1\",y=\"LIMIT_BAL\",data=df,kind=\"hex\")","c895c3b0":"fig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nsns.boxplot(x=\"default.payment.next.month\",y=\"BILL_AMT1\",data=df)","94ce7a7f":"bi=\"BILL_AMT2\tBILL_AMT3\tBILL_AMT4\tBILL_AMT5\tBILL_AMT6\t\".split()","8c06294e":"f, axes = plt.subplots(2,3,figsize=(20,10))\nsns.boxplot(x=\"default.payment.next.month\",y=\"BILL_AMT1\",data=df,ax=axes[0][0])\nsns.boxplot(x=\"default.payment.next.month\",y=\"BILL_AMT2\",data=df ,ax=axes[0][1])\nsns.boxplot(x=\"default.payment.next.month\",y=\"BILL_AMT3\",data=df ,ax=axes[0][2])\nsns.boxplot(x=\"default.payment.next.month\",y=\"BILL_AMT4\",data=df ,ax=axes[1][0])\nsns.boxplot(x=\"default.payment.next.month\",y=\"BILL_AMT5\",data=df ,ax=axes[1][1])\nsns.boxplot(x=\"default.payment.next.month\",y=\"BILL_AMT6\",data=df ,ax=axes[1][2])\nplt.tight_layout()","c05bb3df":"df[\"PAY_AMT1\"].value_counts()","6e66e459":"len(df[df[\"PAY_AMT1\"]<0])","d6c3d25d":"len(df[(df[\"PAY_AMT1\"]==0) & (df[\"default.payment.next.month\"]==1)])\/len(df[(df[\"PAY_AMT1\"]==0)])*100","b9346a82":"len(df[(df[\"PAY_AMT1\"]>0) & (df[\"default.payment.next.month\"]==1)])\/len(df[(df[\"PAY_AMT1\"]>0)])*100","ebf4d536":"print(len(df[(df[\"PAY_AMT1\"]==0) & (df[\"default.payment.next.month\"]==1)])\/len(df[(df[\"PAY_AMT1\"]==0)])*100)\nprint(len(df[(df[\"PAY_AMT1\"]>0) & (df[\"default.payment.next.month\"]==1)])\/len(df[(df[\"PAY_AMT1\"]>0)])*100)\nprint(\"\\n\")\nprint(len(df[(df[\"PAY_AMT2\"]==0) & (df[\"default.payment.next.month\"]==1)])\/len(df[(df[\"PAY_AMT2\"]==0)])*100)\nprint(len(df[(df[\"PAY_AMT2\"]>0) & (df[\"default.payment.next.month\"]==1)])\/len(df[(df[\"PAY_AMT2\"]>0)])*100)\nprint(\"\\n\")\nprint(len(df[(df[\"PAY_AMT3\"]==0) & (df[\"default.payment.next.month\"]==1)])\/len(df[(df[\"PAY_AMT3\"]==0)])*100)\nprint(len(df[(df[\"PAY_AMT3\"]>0) & (df[\"default.payment.next.month\"]==1)])\/len(df[(df[\"PAY_AMT3\"]>0)])*100)\nprint(\"\\n\")\nprint(len(df[(df[\"PAY_AMT4\"]==0) & (df[\"default.payment.next.month\"]==1)])\/len(df[(df[\"PAY_AMT4\"]==0)])*100)\nprint(len(df[(df[\"PAY_AMT4\"]>0) & (df[\"default.payment.next.month\"]==1)])\/len(df[(df[\"PAY_AMT4\"]>0)])*100)\nprint(\"\\n\")\nprint(len(df[(df[\"PAY_AMT5\"]==0) & (df[\"default.payment.next.month\"]==1)])\/len(df[(df[\"PAY_AMT5\"]==0)])*100)\nprint(len(df[(df[\"PAY_AMT5\"]>0) & (df[\"default.payment.next.month\"]==1)])\/len(df[(df[\"PAY_AMT5\"]>0)])*100)\nprint(\"\\n\")\nprint(len(df[(df[\"PAY_AMT6\"]==0) & (df[\"default.payment.next.month\"]==1)])\/len(df[(df[\"PAY_AMT6\"]==0)])*100)\nprint(len(df[(df[\"PAY_AMT6\"]>0) & (df[\"default.payment.next.month\"]==1)])\/len(df[(df[\"PAY_AMT6\"]>0)])*100)","78bb2f7f":"f, axes = plt.subplots(2,3,figsize=(20,10))\nsns.boxplot(x=\"default.payment.next.month\",y=\"PAY_AMT1\",data=df,ax=axes[0][0])\nsns.boxplot(x=\"default.payment.next.month\",y=\"PAY_AMT2\",data=df ,ax=axes[0][1])\nsns.boxplot(x=\"default.payment.next.month\",y=\"PAY_AMT3\",data=df ,ax=axes[0][2])\nsns.boxplot(x=\"default.payment.next.month\",y=\"PAY_AMT4\",data=df ,ax=axes[1][0])\nsns.boxplot(x=\"default.payment.next.month\",y=\"PAY_AMT5\",data=df ,ax=axes[1][1])\nsns.boxplot(x=\"default.payment.next.month\",y=\"PAY_AMT6\",data=df ,ax=axes[1][2])\nplt.tight_layout()","d5d0f72c":"fig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nsns.distplot(df[\"PAY_AMT1\"],color=\"red\")","2b3e643d":"fig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\nsns.scatterplot(x=\"PAY_AMT1\",y=\"LIMIT_BAL\",data=df)","cbbbcc81":"X=df[['LIMIT_BAL', 'SEX', 'EDUCATION', 'MARRIAGE', 'AGE', 'PAY_0',\n       'PAY_2', 'PAY_3', 'PAY_4', 'PAY_5', 'PAY_6', 'BILL_AMT1', 'BILL_AMT2',\n       'BILL_AMT3', 'BILL_AMT4', 'BILL_AMT5', 'BILL_AMT6', 'PAY_AMT1',\n       'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6']]","9bba4840":"y = df.iloc[:,-1] ","e9cedb8a":"from sklearn.feature_selection import SelectKBest\nfrom sklearn.feature_selection import f_classif\n#target column i.e price range\n#apply SelectKBest class to extract top 10 best features\nbestfeatures = SelectKBest(score_func=f_classif, k=23)\nfit = bestfeatures.fit(X,y)\ndfscores = pd.DataFrame(fit.scores_)\ndfcolumns = pd.DataFrame(X.columns)\n#concat two dataframes for better visualization \nfeatureScores = pd.concat([dfcolumns,dfscores],axis=1)\nfeatureScores.columns = ['Specs','Score']  #naming the dataframe columns\nprint(featureScores.nlargest(16,'Score'))  #print 10 best features\n\n#taken from https:\/\/towardsdatascience.com\/feature-selection-techniques-in-machine-learning-with-python-f24e7da3f36e","21d4a91d":"fig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\ndist=sns.distplot(df[\"LIMIT_BAL\"],color=\"purple\")\naxes.ticklabel_format(style=\"plain\",axis=\"x\")","b3087238":"df[df[\"LIMIT_BAL\"]>750000]","50a61879":"df.shape","9e8287a8":"df.drop((df[df[\"LIMIT_BAL\"]>750000]).index,inplace=True)","ab0442ad":"df.shape","dd1b91fd":"fig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\ndist=sns.distplot(df[\"BILL_AMT1\"],color=\"orange\")\naxes.ticklabel_format(style=\"plain\",axis=\"x\")","7dab8dfe":"df[df[\"BILL_AMT1\"]>620000]","b3a6afa4":"df.shape","dbdecd5c":"df.drop((df[df[\"BILL_AMT1\"]>620000]).index,inplace=True)","0b6a94cd":"df.shape","ec4821c2":"df[df[\"BILL_AMT2\"]>620000]","22c3c636":"df.drop((df[df[\"BILL_AMT2\"]>620000]).index,inplace=True)","a6f1f864":"df.shape","fc129dd5":"df[df[\"BILL_AMT3\"]>620000]","942ce3d8":"df.drop((df[df[\"BILL_AMT3\"]>620000]).index,inplace=True)","9808e6f1":"df.shape","8d527057":"df.drop((df[df[\"BILL_AMT4\"]>620000]).index,inplace=True)","6884d349":"df.shape","1930a588":"df[df[\"BILL_AMT5\"]>620000]","b1d2cd1d":"df.drop((df[df[\"BILL_AMT5\"]>620000]).index,inplace=True)","4a668091":"df.shape","33767f3f":"df[df[\"BILL_AMT6\"]>620000]","5e665f81":"df.drop((df[df[\"BILL_AMT6\"]>620000]).index,inplace=True)","9f95ae94":"df.shape","9029d4a4":"fig=plt.figure(figsize=(10,7))\naxes=fig.add_axes([0,0,0.8,0.8])\ndist=sns.distplot(df[\"PAY_AMT1\"],color=\"BLACK\")\naxes.ticklabel_format(style=\"plain\",axis=\"x\")","eaedfeac":"df[df[\"PAY_AMT1\"]>400000]","b44c579c":"df.drop(df[df[\"PAY_AMT1\"]>400000].index,inplace=True)","d06d01ce":"df.shape","0186f97e":"df.drop(df[df[\"PAY_AMT2\"]>400000].index,inplace=True)","758be783":"df.shape","6023ba21":"df[df[\"PAY_AMT3\"]>400000]","f36982c7":"df.drop(df[df[\"PAY_AMT3\"]>400000].index,inplace=True)","c2d209f1":"df.shape","ed13129b":"df[df[\"PAY_AMT4\"]>400000]","0fab39e4":"df.drop(df[df[\"PAY_AMT4\"]>400000].index,inplace=True)","026683b7":"df.shape","fddc546b":"df[df[\"PAY_AMT5\"]>400000]","6b7ec606":"df.drop(df[df[\"PAY_AMT5\"]>400000].index,inplace=True)","0670fe8f":"df[df[\"PAY_AMT6\"]>400000]","667b6b52":"df.drop(df[df[\"PAY_AMT5\"]>400000].index,inplace=True)","b9a73150":"df.shape","894671f5":"df.columns","e7a47892":"X=df[[ 'LIMIT_BAL',  'SEX', 'EDUCATION', 'MARRIAGE', 'PAY_0',\n       'PAY_2', 'PAY_3', 'PAY_4', 'PAY_5', 'PAY_6', 'PAY_AMT1',\n       'PAY_AMT2', 'PAY_AMT3','PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6']].values","f3f5f466":"y=df['default.payment.next.month'].values","ff2119c1":"from sklearn.model_selection import train_test_split","63d8be45":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)","5fcce060":"from sklearn.preprocessing import StandardScaler","3661a955":"std=StandardScaler()","2c2f687a":"std.fit(X_train)","c97c3e2b":"X_train=std.transform(X_train)","5e139d2b":"X_test=std.transform(X_test)","569558d9":"from sklearn.ensemble import RandomForestClassifier","41658221":"from sklearn.model_selection import GridSearchCV","9369c152":"from sklearn.svm import SVC\nsvc=SVC()","bfe6c86c":"rfc=RandomForestClassifier(n_estimators=200)","d8d9f134":"rfc.fit(X_train,y_train)","e0462737":"predict=rfc.predict(X_test)","158c482f":"from sklearn.metrics import classification_report,confusion_matrix","41c83910":"print(classification_report(y_test,predict))","649f50d2":"print(confusion_matrix(y_test,predict))","5c4d786e":"svc.fit(X_train,y_train)","bf5bcef4":"predict2=svc.predict(X_test)","66868366":"print(classification_report(y_test,predict2))","d023c232":"print(confusion_matrix(y_test,predict2))","cc737315":"from sklearn.neighbors import KNeighborsClassifier","e17b7e10":"knn=KNeighborsClassifier(n_neighbors=1)","d49c6c1e":"knn.fit(X_train,y_train)","c1254cb8":"pred4=knn.predict(X_test)","38785b34":"print(classification_report(y_test,pred4))","b9b3c216":"error_rate=[]\nfor i in range(1,40):\n    knn=KNeighborsClassifier(n_neighbors=i)\n    knn.fit(X_train,y_train)\n    predict=knn.predict(X_test)\n    error_rate.append(np.mean(predict!= y_test))","c04a95d8":"plt.plot(range(1,40),error_rate)","f02bbf20":"a=np.min(error_rate)\nerror_rate.index(a)","5e734d3a":"knn=KNeighborsClassifier(n_neighbors=20)\nknn.fit(X_train,y_train)\npred5=knn.predict(X_test)\nprint(confusion_matrix(y_test,pred5))","1903795b":"print(classification_report(y_test,pred5))","c7fd6796":"### **MARRIAGE**","7d1f1a26":"#### This dataset looks unbalanced\n#### Before we build a model we should make sure that this feature is balanced ","3a7d2c39":"#### These results correspond with PAY_0\n#### A common trend i could observe in these graphs is the derease in percentage of defaultees in Class 5 after Class 4 \n#### The reason for this could be after 4 months of payment due, the bank could start warning people abut thier credit card bill and people might have paid thier bills(Just an intuition)","9084ffa6":"#### Defaulters tend to have a slightly lower LIMIT_BAL","596d7db5":"#### nothing much can be said from this at all\n#### let us check if this is similar for other BILL_AMTx(BILL_AMT2\tBILL_AMT3\tBILL_AMT4\tBILL_AMT5\tBILL_AMT6)","ae9d7e53":"### This is almost twice the chance of a person being a defaulter if he he has a PAY_AMT1=0","7e6a8fc6":"### since -1 means the client has paid upto date bills and 1 means the client has due of 1 month, 0 and -2 are completely useless so let us map 0 and -2 to -1","4c88e508":" ### **AGE**","c47852b1":"### So these class 3 people in marriage seem to have a very less LIMIT_BAL compared to the rest of the classes\n####  lesser the limit balance more the probability of them being defaulters,So according to this intiution class 3 should have more number of defaultees.Lets check this theory ","14fc31b1":"### As expected we have 0 and 1\n* Where 1 means the person will have default payement next month \n* And 0 means the person will have paid his dues next month","fb739b77":"### **EDUCATION**","a607a7b9":"## DATA CLEANING","bf5037a7":"#### we still dont know what class ) and 3 means ","e76ab818":"### In this project we try to predict in advance whether the person will have a default payement next month \n#### We should be able to answer questions like \n* How does the probability of default payment vary by categories of different demographic variables?\n* Which variables are the strongest predictors of default payment?\n\n\n### The feature which we try to predict is  \"default.payment.next.month\". So lets examine this feature","3c82ec9f":"#### Everything looks mostly similar and nothing can be distinguished ","22d99008":"#### Let us see the distribution of sex among the data","bc819f21":"#### The top 5 amounts of credit given to the customers","39139f3c":"#### This dataset has more female clients than male clients","91f6387d":"#### As expected class 2(Single People) have a lower average age compared to class 1(Married) but nothing can be inferred about class 3 and class 0 \n#### Class 3 seems to have a higher average age than other classes","501042cb":"#### There is no 0 class mentioned in the description of the dataset.\n#### Class 5 and 6 both denote unknown.Combining them would be a good idea \n#### As there are less than 30 entries it would be better to drop the rows having 0 as Education\n","978bf875":"#### Presence of Outliers are ruining this so let us remove them to get a clear view of our graph\n#### But there are about 500 instances where \"BILL_AMT1\" <0 \n","50ed50b3":"#### Percentage of people who have a positive bill amount and default thier payments\n\n#### There isnt a huge difference.Lets examine this feature some more ","a105fc14":"#### The LIMIT_BAL seems to be almost similar among the two sexes","1c81a298":"### Here we see a remarkable feature\n* If \"BILL_AMT1\"<0, PAY_0 is only -1 or 1 \n* The lesser the value of PAY_0 the better the chance that the person isnt a defaulter,So does having a negative BILL_AMT1 decrease the chances of him being an defaulter?\n* Let us study in detail ","03af1d9a":"### **PAY_AMT1**","9f173b21":"### As expected class 3 had the highest %age of defaultees\n#### Now lets compare this feature with age ","2864b891":"#### Nothing much can be inferred from this graph as AGE is almost similar for both the labels. So this feature aint that helpfull","776a0598":"### **PAY_0**","e51c0f0e":" ### **LIMIT_BAL**","88af2c43":"### CONSTRUCTING A MODEL WITHOUT ONE HOT ENCODING","f47b0e70":"#### This data is very skewed \n#### let us remove outliers later so that we see how the graph is ","019d5b89":"#### As we saw earlier there were a quite less number of defaulters when compared to the clients who paid thier bills\n#### This graph confirms it as we see there are quite a lot clients Repayment status -1(duly paid) in September, 2005 ","4fc3a46e":"#### Its a relief that there arent any missing values \n#### Also we can see that there are no categorical variables in this \n","f39e5b68":"#### From the first glance  we can see that PAY_5 and PAY_6 have -2.0 values which shoudnt be possible as the minimum vlaue to which they can go is -1\n#### Let us explore the dataset more ","202b496b":"### Now this looks better ","a5d89435":"### From Careful Examination of the Data:\n* Marriage has a maximum value of 3.0 which shouldnt be possible \n* PAY_0,PAY_2,PAY_3,PAY_4,PAY_5,PAY_6 have a minimum value -2.0\n* BILL_AMT1, BILL_AMT2, BILL_AMT3, BILL_AMT4, BILL_AMT5, BILL_AMT6 have a -ve value ","278611c0":"#### The default payement and Limit balance is almost the same between both the sexes\n### So, Sex wont help us that much in identfying a defaulter","e4bfbf12":"## Now let us perform some EDA to know our Dataset better","eeb7d505":" ### **SEX**","3390715b":"### As expected the more the months u dont pay your dues the better chance there is of u becoming a deafulter \n#### Now lets see if the trend is same in other months (PAY_2,PAY_3....)","56c13a8b":"#### We can see that the LIMIT_BAL is mostly between 100,000 dollars \n#### We also can see a very few people have a LIMIT_BAL of 1000,000 dollars which has made the dataset skewed. Removal of some outliers would be helpfull","5dcba4c9":"#### Percentage of people who have a negative bill amount and default thier payments","e15149fc":"### The owner of the credit card are mostly between 25-35.\n#### It is intresting to see people over 80 using credit cards"}}