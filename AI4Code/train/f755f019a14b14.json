{"cell_type":{"cd3260e7":"code","88726f84":"code","faa01155":"code","44123922":"code","f0306643":"code","d2f918eb":"code","3926b2d4":"code","797144da":"code","0c057220":"code","4dba8b5f":"code","920f4907":"code","bf54a6e0":"code","2cbff7f8":"code","0a9cd986":"code","d9b058fa":"code","5726adee":"code","4d8f56fe":"code","099dfeeb":"code","7992e48c":"code","e1f73827":"code","6aff8a65":"code","14736f8f":"markdown","ef017a4b":"markdown","20795b1d":"markdown","b2e15a7a":"markdown","6255ba1f":"markdown","f971b907":"markdown","e72ae4a4":"markdown","ee4157cb":"markdown","b8e3367e":"markdown","a1faf8d6":"markdown","17407146":"markdown"},"source":{"cd3260e7":"import warnings\nwarnings.filterwarnings('ignore')\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sn\nimport tensorflow as tf\nfrom sklearn.model_selection import train_test_split\n\nprint(tf.__version__)\n\nimport os\nprint(os.listdir(\"..\/input\"))","88726f84":"iris = pd.read_csv('..\/input\/Iris.csv').set_index('Id')\niris.head(5)","faa01155":"iris.info()","44123922":"iris.describe()","f0306643":"iris.groupby('Species').count()","d2f918eb":"sn.boxplot(x='Species', y='SepalLengthCm', data=iris)","3926b2d4":"sn.boxplot(x='Species', y='SepalWidthCm', data=iris)","797144da":"sn.boxplot(x='Species', y='PetalLengthCm', data=iris)","0c057220":"sn.boxplot(x='Species', y='PetalWidthCm', data=iris)","4dba8b5f":"sn.pairplot(iris,hue='Species')\nplt.show()","920f4907":"iris.corr()","bf54a6e0":"sn.heatmap(iris.corr(), annot=True)","2cbff7f8":"X = iris.drop(['Species'],axis=1)\ny = iris['Species'].replace({'Iris-setosa' : 0, 'Iris-versicolor' : 1, 'Iris-virginica' : 2})\nprint(X.shape, y.shape)","0a9cd986":"X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.3)\nprint(X_train.shape, X_test.shape)","d9b058fa":"# data is shuffled\nX_train.head(5)","5726adee":"y_train.head(5)","4d8f56fe":"# Convert to np arrays so that we can use with TensorFlow\nX_train = np.array(X_train).astype(np.float32)\nX_test  = np.array(X_test).astype(np.float32)\ny_train = np.array(y_train).astype(np.int)\ny_test  = np.array(y_test).astype(np.int)\n\nprint(X_train)\nprint(y_train)","099dfeeb":"feature_name = \"flower_features\"\nfeature_columns = [tf.feature_column.numeric_column(feature_name,shape=[4])]\n\nclassifier = tf.estimator.LinearClassifier(feature_columns=feature_columns,\n                                          n_classes=3,\n                                          model_dir='\/tmp\/iris_model')","7992e48c":"def input_fn(X,y):\n    def _fn():\n        features = {feature_name: tf.constant(X)}\n        label = tf.constant(y)\n        return features, label\n    return _fn\n\nprint(input_fn(X_train,y_train)())\n        ","e1f73827":"classifier.train(input_fn=input_fn(X_train,y_train), steps=1000)\nprint('fit done')","6aff8a65":"accuracy = classifier.evaluate(input_fn=input_fn(X_test,y_test),steps=100)['accuracy']\nprint('\\nAccuracy: {0:f}'.format(accuracy))","14736f8f":"# Feature columns and model","ef017a4b":"# Data set\nFrom https:\/\/en.wikipedia.org\/wiki\/Iris_flower_data_set\n\n3 types of Iris Flowers:\n\n1. Iris Setosa\n2. Iris Versicolour\n3. Iris Virginica","20795b1d":"# Data preview","b2e15a7a":"# Classification using Tensorflow","6255ba1f":"# Evaluation","f971b907":"# Data columns\n\n1. sepal length in cm\n2. sepal width in cm\n3. petal length in cm\n4. petal width in cm\n5. Species","e72ae4a4":"# Training","ee4157cb":"# Input function","b8e3367e":"# Data visualization","a1faf8d6":"# Split data into train and test","17407146":"# Import packages"}}