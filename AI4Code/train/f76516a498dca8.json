{"cell_type":{"033c1ce1":"code","50ebc8bd":"code","af82b51f":"code","804ba25a":"code","93ed1336":"code","2f75e5b7":"code","07fbc0d9":"code","1e92c168":"code","8403f5e5":"code","492695b1":"code","6a1e00c4":"code","daea87fc":"code","c79fe550":"code","386a487d":"code","f63bedf0":"code","ef853905":"code","5fda76f7":"code","63f9ddee":"code","72495895":"code","0f6abb3a":"code","46ccc634":"code","97e39516":"code","afba8906":"code","505dfb9c":"code","32734e44":"code","df8b16ad":"code","f154d47c":"code","98fa8c27":"code","248fab55":"code","9e10f2b2":"code","ce4c0672":"code","f674ae41":"code","ea6aa33d":"code","39862e28":"code","e67e97ff":"code","63254f65":"code","de1f926a":"code","f558cd64":"code","2a27e866":"code","c9e183a1":"code","4384c462":"code","c73a2ac1":"code","85fe1281":"code","3c8150e2":"code","0a757446":"code","66439f8f":"code","28b90226":"code","809f8876":"code","9de816b1":"code","b499bcc9":"code","74f5cece":"code","f3165992":"code","f290b702":"code","4bd33835":"code","2e2679a1":"code","7d470044":"code","3039947c":"code","1252560e":"code","4074e53a":"code","4979819c":"code","1e83ccd4":"code","49d45ecb":"code","c0b63828":"code","8a3a5f97":"code","62047b03":"code","76435ebf":"code","ce7d694b":"code","c9b39744":"code","aeabc987":"code","e8afd595":"code","68e1ee0c":"code","e99ede4e":"code","e2f0ce23":"code","0403294b":"code","a9f06483":"code","a79b5c3d":"code","b509fbde":"code","1708ca79":"code","20ad07e8":"code","33d662d4":"code","7e0dcc36":"code","96c3e301":"code","e4753d17":"code","b154693c":"code","0d773068":"code","fe39581e":"code","7328475c":"code","05f30b17":"code","4bc75e5c":"code","aa6d9972":"code","24a07efb":"code","5e8a420c":"code","a750aca4":"code","66dd85a5":"code","8c089d6a":"code","40af1084":"code","ebe69496":"code","5f27d208":"code","dc43f73c":"code","8486228a":"code","1afcb2bc":"code","0f3bbdaf":"code","500f7ce1":"code","f9e02df0":"code","8a281f69":"code","52783ade":"code","ebb8e37d":"code","0783fa30":"code","4f22557f":"code","1a8d0022":"markdown","64360712":"markdown","c477c115":"markdown","6a8d2566":"markdown"},"source":{"033c1ce1":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom scipy.stats import stats\n\n%matplotlib inline","50ebc8bd":"test = pd.read_csv('..\/input\/ashrae-energy-prediction\/test.csv',parse_dates=['timestamp'])","af82b51f":"train = pd.read_csv('..\/input\/ashrae-energy-prediction\/train.csv',parse_dates=['timestamp'])","804ba25a":"weather_test = pd.read_csv('..\/input\/ashrae-energy-prediction\/weather_test.csv',parse_dates=['timestamp'])","93ed1336":"weather_train = pd.read_csv('..\/input\/ashrae-energy-prediction\/weather_train.csv',parse_dates=['timestamp'])","2f75e5b7":"building_metadata = pd.read_csv('..\/input\/ashrae-energy-prediction\/building_metadata.csv')","07fbc0d9":"sample_submission = pd.read_csv('..\/input\/ashrae-energy-prediction\/sample_submission.csv')","1e92c168":"train.head()","8403f5e5":"weather_train.head()","492695b1":"def reduce_mem_usage(df, verbose=True):\n    numerics = ['int16', 'int32', 'int64', 'float16', 'float32', 'float64']\n    start_mem = df.memory_usage().sum() \/ 1024**2    \n    for col in df.columns:\n        col_type = df[col].dtypes\n        if col_type in numerics:\n            c_min = df[col].min()\n            c_max = df[col].max()\n            if str(col_type)[:3] == 'int':\n                if c_min > np.iinfo(np.int8).min and c_max < np.iinfo(np.int8).max:\n                    df[col] = df[col].astype(np.int8)\n                elif c_min > np.iinfo(np.int16).min and c_max < np.iinfo(np.int16).max:\n                    df[col] = df[col].astype(np.int16)\n                elif c_min > np.iinfo(np.int32).min and c_max < np.iinfo(np.int32).max:\n                    df[col] = df[col].astype(np.int32)\n                elif c_min > np.iinfo(np.int64).min and c_max < np.iinfo(np.int64).max:\n                    df[col] = df[col].astype(np.int64)  \n            else:\n                if c_min > np.finfo(np.float16).min and c_max < np.finfo(np.float16).max:\n                    df[col] = df[col].astype(np.float16)\n                elif c_min > np.finfo(np.float32).min and c_max < np.finfo(np.float32).max:\n                    df[col] = df[col].astype(np.float32)\n                else:\n                    df[col] = df[col].astype(np.float64)    \n    end_mem = df.memory_usage().sum() \/ 1024**2\n    if verbose: print('Mem. usage decreased to {:5.2f} Mb ({:.1f}% reduction)'.format(end_mem, 100 * (start_mem - end_mem) \/ start_mem))\n    return df","6a1e00c4":"test = reduce_mem_usage(test)\ntrain = reduce_mem_usage(train)\nweather_test = reduce_mem_usage(weather_test)\nweather_train = reduce_mem_usage(weather_train)\nbuilding_metadata = reduce_mem_usage(building_metadata)","daea87fc":"weather_train.isnull().sum()","c79fe550":"weather_train.head()","386a487d":"weather_train = weather_train.groupby('site_id').apply(lambda x: x.set_index('timestamp').interpolate(method='time',limit_direction='both').reset_index()).drop(columns='site_id').reset_index().drop(columns='level_1')\nweather_test = weather_test.groupby('site_id').apply(lambda x: x.set_index('timestamp').interpolate(method='time',limit_direction='both').reset_index()).drop(columns='site_id').reset_index().drop(columns='level_1')\n\nweather_train.isnull().sum()","f63bedf0":"weather_train.head()","ef853905":"\nweather_train['cloud_coverage'] = weather_train['cloud_coverage'].round()\nweather_train['wind_direction'] = weather_train['wind_direction'].round()\nweather_train['precip_depth_1_hr'] = weather_train['precip_depth_1_hr'].round()","5fda76f7":"weather_train.groupby('site_id').mean().sort_values(by='cloud_coverage')","63f9ddee":"train = train.merge(building_metadata, on='building_id', how='left')\ntest = test.merge(building_metadata, on='building_id', how='left')\n\ntrain = train.merge(weather_train, on=['site_id', 'timestamp'], how='left')\ntest = test.merge(weather_test, on=['site_id', 'timestamp'], how='left')","72495895":"del weather_train\ndel weather_test\ndel building_metadata","0f6abb3a":"train['aday']=train['timestamp'].dt.day\ntrain['amonth']=train['timestamp'].dt.month\ntrain['ayear']=train['timestamp'].dt.year\ntrain['aquarter']=train['timestamp'].dt.quarter\ntrain['adayofweek']=train['timestamp'].dt.dayofweek\ntrain['adayofyear']=train['timestamp'].dt.dayofyear\ntrain['adate']=train['timestamp'].dt.date\ntrain['ahour']=train['timestamp'].dt.hour\n\ntest['aday']=test['timestamp'].dt.day\ntest['amonth']=test['timestamp'].dt.month\ntest['ayear']=test['timestamp'].dt.year\ntest['aquarter']=test['timestamp'].dt.quarter\ntest['adayofweek']=test['timestamp'].dt.dayofweek\ntest['adayofyear']=test['timestamp'].dt.dayofyear\ntest['adate']=test['timestamp'].dt.date\ntest['ahour']=test['timestamp'].dt.hour","46ccc634":"test['source']='test'\ntrain['source']='train'","97e39516":"train.head()","afba8906":"train.columns","505dfb9c":"train.shape, test.shape","32734e44":"train.head()","df8b16ad":"train.info()","f154d47c":"train = reduce_mem_usage(train)","98fa8c27":"test = reduce_mem_usage(test)","248fab55":"train.info()","9e10f2b2":"train['ayear'].value_counts()","ce4c0672":"sns.countplot(train['meter'])\nplt.show() # The meter count varies from meter to meter","f674ae41":"train['site_id'].value_counts().sort_index().plot.bar()\nplt.show()","ea6aa33d":"plt.figure(figsize=(10,6))\ntrain['primary_use'].value_counts().plot(kind='bar')\nplt.show()","39862e28":"plt.figure(figsize=(12,6))\nsns.distplot(train['square_feet'])\nplt.show()","e67e97ff":"plt.figure(figsize=(18,6))\ntrain['year_built'].value_counts().sort_index(ascending= False).plot(kind='bar')\nplt.show()","63254f65":"train['year_built'].value_counts().to_frame().iloc[:2013]","de1f926a":"plt.figure(figsize=(12,6))\ntrain['floor_count'].value_counts().plot(kind='bar')\nplt.show()","f558cd64":"sns.boxplot(train['air_temperature'].dropna(), showfliers=True)\n\nplt.show()","2a27e866":"sns.distplot(train['air_temperature'].dropna())\nplt.show()","c9e183a1":"d= train['cloud_coverage'].value_counts().sort_index().to_frame()","4384c462":"(d).plot.bar()\nplt.show()","c73a2ac1":"d.T","85fe1281":"sns.stripplot(d.index,d.cloud_coverage)\nplt.show()","3c8150e2":"sns.boxplot(train['dew_temperature'].dropna(), showfliers=True)\nplt.show()","0a757446":"train['precip_depth_1_hr'].dropna().value_counts().sort_index().plot.density()\nplt.show()","66439f8f":"sns.boxplot(train['precip_depth_1_hr'].dropna(), showfliers = False)\nplt.show()","28b90226":"m=train['precip_depth_1_hr'].dropna().value_counts().sort_index()\nm\n# Suspecting precip_depth_1_hr values under 0 to be incorrect entries","809f8876":"\nplt.figure(figsize=(24,7))\nsns.barplot(m.index,m.values)\nplt.xticks(rotation=85)\nplt.ylim((0,553352))\nplt.show()","9de816b1":"sns.distplot(m.to_frame()['precip_depth_1_hr'])\nplt.ylim((0,0.0000004))\nplt.show()","b499bcc9":"plt.figure(figsize=(24,7))\nsns.boxplot(train['sea_level_pressure'].dropna(), showfliers=True)\nplt.show() # varies from 995 to 1034","74f5cece":"train['sea_level_pressure'].dropna().value_counts().sort_index().plot.hist(bins=50)\nplt.show()","f3165992":"sns.boxplot(train['wind_direction'].dropna(), showfliers=True)\nplt.show() # varies from 0-360","f290b702":"sns.boxplot(train['wind_speed'].dropna(), showfliers=True)\nplt.show() # the plot is right skewed","4bd33835":"sns.boxplot(train.groupby('building_id')['meter_reading'].mean(), showfliers=False)\nplt.show() # the plot is right skewed","2e2679a1":"'''plt.figure(figsize=(24,7))\n#sns.boxplot(train['building_id'], train['meter_reading'], showfliers=False)\nsns.barplot(train['building_id'], train['meter_reading'])\nplt.xticks(rotation=90)\nplt.show()'''","7d470044":"plt.figure(figsize=(24,7))\nsns.boxplot(train['site_id'], train['meter_reading'], showfliers=False)\nplt.show() # site: 5,8, 12,3,11 are the most efficient sites","3039947c":"train['amonth'].value_counts().sort_index()","1252560e":"plt.figure(figsize=(24,7))\nsns.boxplot(train['site_id'], train['air_temperature'], showfliers=True)\nplt.show()","4074e53a":"train.groupby(['site_id'])['air_temperature'].mean().sort_index()","4979819c":"m=train.groupby(['site_id','building_id'])['air_temperature'].mean()\n","1e83ccd4":"m[0][0]","49d45ecb":"d={}\nfor i in range(16):\n    n = np.array(m[i])\n    d.update({i:[i,np.mean(n),np.std(n)]})\n    print('For site_id = ', i,', mean value is: ',np.mean(n), 'standard dev value is: ', np.std(n))","c0b63828":"sns.distplot(train.loc[train.site_id == 5, 'air_temperature'].dropna())\nplt.show()","8a3a5f97":"pd.DataFrame(d, index=['site_index','mean', 'std']).T.sort_values(by='mean').iloc[:,[0,1]].set_index('site_index').plot(kind='bar')\nplt.show()","62047b03":"pd.DataFrame(d, index=['site_index','mean', 'std']).T.sort_values(by='mean').iloc[:,[0,1]].set_index('site_index').plot(kind='bar')\npd.DataFrame(d, index=['site_index','mean', 'std']).T.sort_values(by='std').iloc[:,[0,2]].set_index('site_index').plot(kind='bar')\nplt.grid(True)\nplt.show()","76435ebf":"train.columns","ce7d694b":"sns.boxplot(train['meter'], train['meter_reading'], showfliers=False)\nplt.show()","c9b39744":"plt.figure(figsize=(20,6))\ntrain.groupby(['site_id','building_id'])['meter_reading'].mean().sort_values()[-50:].plot.bar()\nplt.show()","aeabc987":"plt.figure(figsize=(20,6))\ntrain.groupby(['site_id','building_id'])['meter_reading'].mean().sort_values()[:50].plot.bar()\nplt.show()","e8afd595":"plt.figure(figsize=(24,7))\nsns.boxplot(train['primary_use'], train['meter_reading'], showfliers=False)\nplt.xticks(rotation=90)\nplt.show()","68e1ee0c":"plt.figure(figsize=(24,7))\nsns.boxplot(train['primary_use'], train['meter_reading'], showfliers=True)\nplt.xticks(rotation=90)\nplt.show()","e99ede4e":"m=train.groupby('square_feet')['meter_reading'].mean().to_frame()\nplt.figure(figsize=(18,7))\nsns.scatterplot(m.index,m['meter_reading']);\nplt.ylim((0,5000))\nm=train.groupby('square_feet')['meter_reading'].median().to_frame()\nsns.scatterplot(m.index,m['meter_reading']);\nplt.ylim((0,5000))\nplt.grid(True)\nplt.show()","e2f0ce23":"plt.figure(figsize=(24,7))\nsns.boxplot(train.groupby('year_built')['meter_reading'].mean(), showfliers=False)\nplt.show()","0403294b":"plt.figure(figsize=(24,7))\ntrain.groupby('year_built')['meter_reading'].mean().plot.bar()\nplt.xticks(rotation=90)\nplt.show()","a9f06483":"m=train.groupby('year_built')['meter_reading'].mean().to_frame()\nplt.figure(figsize=(18,7))\nsns.scatterplot(m.index,m['meter_reading'])\n\nm=train.groupby('year_built')['meter_reading'].median().to_frame()\nsns.scatterplot(m.index,m['meter_reading'])\n\nplt.grid(True)\nplt.show()","a79b5c3d":"plt.figure(figsize=(26,7))\nsns.barplot(train['year_built'], train['meter_reading'])\nplt.xticks(rotation=90)\nplt.show()","b509fbde":"plt.figure(figsize=(26,7))\nsns.boxplot(train['floor_count'], train['meter_reading'], showfliers=False)\nplt.show()","1708ca79":"plt.figure(figsize=(26,7))\ntrain.groupby(['floor_count'])['meter_reading'].mean().sort_values().plot.bar()\nplt.show() # To analyze floor count & meter reading by grouping on the basis of site_id","20ad07e8":"plt.figure(figsize=(26,7))\nsns.barplot(train['floor_count'], train['meter_reading'])\nplt.show()","33d662d4":"m=train.groupby('air_temperature')['meter_reading'].mean().to_frame()\nplt.figure(figsize=(18,7))\nsns.scatterplot(m.index,m['meter_reading'])\n\nplt.show()","7e0dcc36":"m=train.groupby('air_temperature')['meter_reading'].mean().to_frame()\nplt.figure(figsize=(18,7))\nsns.scatterplot(m.index,m['meter_reading'])\nm=train.groupby('dew_temperature')['meter_reading'].mean().to_frame()\nsns.scatterplot(m.index,m['meter_reading'])\nplt.show()","96c3e301":"m=train.groupby('dew_temperature')['meter_reading'].mean().to_frame()\nplt.figure(figsize=(18,7))\nsns.scatterplot(m.index,m['meter_reading'])\nm=train.groupby('dew_temperature')['meter_reading'].median().to_frame()\nsns.scatterplot(m.index,m['meter_reading'])\nplt.show()","e4753d17":"plt.figure(figsize=(24,7))\nsns.boxplot(train['cloud_coverage'], train['meter_reading'], showfliers=False)\nplt.show() # To analyze cloud_coverage & meter reading by grouping on the basis of site_id","b154693c":"m=train.groupby('precip_depth_1_hr')['meter_reading'].mean().to_frame()\nplt.figure(figsize=(18,7))\nsns.scatterplot(m.index,m['meter_reading'])\nm=train.groupby('precip_depth_1_hr')['meter_reading'].median().to_frame()\nsns.scatterplot(m.index,m['meter_reading'])\nplt.show()","0d773068":"plt.figure(figsize=(18,7))\nm=train.groupby('sea_level_pressure')['meter_reading'].mean().to_frame()\nsns.scatterplot(m.index,m['meter_reading'])\nm=train.groupby('sea_level_pressure')['meter_reading'].median().to_frame()\nsns.scatterplot(m.index,m['meter_reading'])\nplt.show()","fe39581e":"plt.figure(figsize=(18,7))\nm=train.groupby('wind_direction')['meter_reading'].mean().to_frame()\nsns.scatterplot(m.index,m['meter_reading'])\nm=train.groupby('wind_direction')['meter_reading'].median().to_frame()\nsns.scatterplot(m.index,m['meter_reading'])\nplt.show()","7328475c":"plt.figure(figsize=(18,7))\nm=train.groupby('wind_speed')['meter_reading'].mean().to_frame()\nsns.scatterplot(m.index,m['meter_reading'])\nm=train.groupby('wind_speed')['meter_reading'].median().to_frame()\nsns.scatterplot(m.index,m['meter_reading'])\nplt.show()","05f30b17":"m = train.groupby('site_id')['air_temperature', 'cloud_coverage'\n                         , 'dew_temperature', 'precip_depth_1_hr', 'sea_level_pressure'\n                         , 'wind_direction','wind_speed'].median()","4bc75e5c":"n=[i for i in m.columns]\nn\n# site_id, month, hour","aa6d9972":"train.isnull().sum()[train.isnull().sum()!=0]","24a07efb":"train.drop(columns=['year_built', 'floor_count'],inplace=True)","5e8a420c":"train.isnull().sum()[train.isnull().sum()!=0]","a750aca4":"m.isnull().sum()[m.isnull().sum()!=0]","66dd85a5":"for i in n:  \n    train[i]=train.groupby(['site_id','amonth', 'ahour'])[i].apply(lambda x: x.fillna(x.median()))\n","8c089d6a":"train.isnull().sum()[train.isnull().sum()!=0]","40af1084":"m.isnull().sum()[m.isnull().sum()!=0]","ebe69496":"train['wind_speed'].value_counts().sort_index()","5f27d208":"d","dc43f73c":"train.columns","8486228a":"train.groupby('site_id')['timestamp', 'air_temperature', 'cloud_coverage'\n                         , 'dew_temperature', 'precip_depth_1_hr', 'sea_level_pressure'\n                         , 'wind_direction','wind_speed',].mean().sort_values(by='air_temperature')\n","1afcb2bc":"train[train['air_temperature'].isnull()]","0f3bbdaf":"plt.figure(figsize=(14, 6))\nsns.distplot(train['meter_reading'])\nplt.show()","500f7ce1":"plt.figure(figsize=(15,6))\ntrain.groupby('building_id')['square_feet'].mean().plot(kind='bar')\nplt.show()","f9e02df0":"train.iloc[:,[9,10,11,12,13,14,15]][train['air_temperature'].isnull()]","8a281f69":"fig, axes = plt.subplots(1, 1, figsize=(14, 6))\ntrain['timestamp'].dt.floor('d').value_counts().sort_index().plot(ax=axes).set_xlabel('Date', fontsize=14);\ntest['timestamp'].dt.floor('d').value_counts().sort_index().plot(ax=axes).set_ylabel('Number of training examples', fontsize=14);\naxes.set_title('Number of training examples by day', fontsize=16);\naxes.legend(['Train', 'Test']);","52783ade":"fig, axes = plt.subplots(1, 1, figsize=(32, 4))\ntrain.iloc[:,[2,3]].set_index(['timestamp']).resample('H').mean()['meter_reading'].plot(ax=axes\n                                                                                        , label='By hour').set_ylabel('Meter reading', fontsize=14);\ntrain.iloc[:\n           ,[2,3]].set_index('timestamp').resample('D').mean()['meter_reading'].plot(ax=axes\n                                                                                      , label='By day'\n                                                                                     , alpha=1).set_ylabel('Meter reading', fontsize=14);","ebb8e37d":"plt.figure(figsize=(14, 6))\nsns.boxplot(x='meter', y='meter_reading', data=train, showfliers=False);\n\nplt.show()","0783fa30":"plt.figure(figsize=(14, 6))\nsns.boxplot(x='meter', y='air_temperature', data=train);\n\nplt.show()","4f22557f":"sample_submission.head()","1a8d0022":"# Bivariate Analysis","64360712":"1 & 5 are having similar weather conditions - sea_level_pressure, most probably KNN will be used for imputation","c477c115":"# Multivariate Analysis","6a8d2566":"# Univariate Analysis"}}