{"cell_type":{"34482ebe":"code","11bbe820":"code","1bb8e888":"code","4645e627":"code","e509242a":"code","45c42982":"code","a9cf03ca":"code","0c8b29a5":"code","7b46708f":"code","d922032f":"code","a8f75754":"code","a8ed8cdc":"code","0d83330d":"markdown","f08b79c2":"markdown","888ea10b":"markdown"},"source":{"34482ebe":"#\ub370\uc774\ud130 \uad00\ub9ac\nimport numpy as np\nimport pandas as pd\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n        \n#\ubaa8\ub378\nfrom sklearn.model_selection import train_test_split\nfrom xgboost import XGBRegressor\nfrom sklearn.metrics import mean_squared_error,r2_score\nimport lightgbm as lgb","11bbe820":"#\ub370\uc774\ud130\ubd88\ub7ec\uc624\uae30\ntrain = pd.read_csv('..\/input\/petfinder-pawpularity-score\/train.csv')\ntest = pd.read_csv('..\/input\/petfinder-pawpularity-score\/test.csv')\ntrain.head()","1bb8e888":"#\uac04\ub2e8\ud788 \ud655\uc778\ntrain.info()","4645e627":"test1=test.drop('Id',axis=1)   #id\uac12\uc740 \ub530\ub85c \ud2b9\uc9d5\uc774 \uc544\ub2c8\uae30\ub584\ubb38\uc5d0 \ubaa8\ub378\uc5d0\uc11c \uc81c\uac70","e509242a":"cols=['Id','Pawpularity']        #\uc880\ub354 \uc27d\uac8c  \uc81c\uac70\ud558\uae30\uc704\ud574 \ub9cc\ub4e0 \ubcc0\uc218\nx_train=train.drop(cols,axis=1)  #id \uc640 pawpularity\ub97c \uc81c\uac70\ud55c \ud2b9\uc815\uac12\ub4e4\ub9cc \ub0a8\uae34\ub2e4\ny_train=train['Pawpularity']     #\ucc3e\uace0\uc790\ud558\ub294 \uac12","45c42982":"# train_test_split\ub97c \uc0ac\uc6a9\ud558\uc5ec train \ub370\uc774\ud130\uc640 test \ub370\uc774\ud130\ub97c \ub098\ub208\ub2e4\nx_train,x_test,y_train,y_test=train_test_split(x_train,y_train,test_size=0.2)  ","a9cf03ca":"#xgb\ubaa8\ub378\ub9cc\ub4e4\uae30\nxgb=XGBRegressor()   #\uc6b0\ub9ac\uac00 \uc608\uce21\ud560 \ubc94\uc704\ub294 (0~\ubb34\ud55c\ub300)\uc778 \ud2b9\uc815 \uac12\uc774\ubbc0\ub85c regressor\uac00 \uc5b4\uc6b8\ub9ac\ub2c8 regressor\ub97c \uc0dd\uc131\ud574\uc900\ub2e4.\nxgb.fit(x_train,y_train)   #fit\uc744 \uc774\uc6a9\ud558\uc5ec \ubaa8\ub378\uc5d0 \uac12\uc744 \ub123\uc5b4\uc900\ub2e4\ny_pred=xgb.predict(x_test)  #\uc608\uce21\uac12\uc744 \ucc3e\ub294\ub2e4.","0c8b29a5":"def rmse(y, y_pred):    #rmse = \ub8e8\ud2b8 \ud3c9\uade0 \uc81c\uacf1 \uc624\ucc28 (RMSE\ub97c \uc0ac\uc6a9\ud558\uba74 \uc624\ub958 \uc9c0\ud45c\ub97c \uc2e4\uc81c \uac12\uacfc \uc720\uc0ac\ud55c \ub2e8\uc704\ub85c \ub2e4\uc2dc \ubcc0\ud658\ud558\uc5ec \ud574\uc11d\uc744 \uc27d\uac8c \ud569\ub2c8\ub2e4)\n    return np.sqrt(mean_squared_error(y, y_pred))\nprint(rmse(y_test,y_pred))\nprint(mean_squared_error(y_test,y_pred))\nprint(r2_score(y_test,y_pred))","7b46708f":"#lightGBM \ubaa8\ub378 \ub9cc\ub4e4\uae30\n#\ud68c\uadc0\ub97c \uc704\ud55c LGBMRegressor(max_depth=\ub098\ubb34\uae4a\uc774,learning_rate=\ud6c8\ub828\uc591(0.005~0.1),n_estimators=200,reg_alpha=1,reg_lambda=0.1)\nlgbr=lgb.LGBMRegressor(max_depth=10,learning_rate=0.005,n_estimators=200,reg_alpha=1,reg_lambda=0.1)\nlgbr.fit(x_train,y_train)   #fit\uc744 \uc774\uc6a9\ud558\uc5ec \ubaa8\ub378\uc5d0 \uac12\uc744 \ub123\uc5b4\uc900\ub2e4\ny_pred=lgbr.predict(x_test) #\uc608\uce21\uac12\uc744 \ucc3e\ub294\ub2e4","d922032f":"def rmse(y, y_pred):\n    return np.sqrt(mean_squared_error(y, y_pred))\nprint(rmse(y_test,y_pred))\nprint(mean_squared_error(y_test,y_pred))\nprint(r2_score(y_test,y_pred))","a8f75754":"Pred=lgbr.predict(test1)  #\uc608\uce21\uac12\uc744 \ucc3e\ub294\ub2e4","a8ed8cdc":"#\ucd5c\uc885\uacb0\uacfc\ubb3c\uc0dd\uc131\nsub=pd.DataFrame()\nsub['Id']=test['Id']\nsub['Pawpularity']=Pred\nsub.to_csv('submission.csv',index=False)\nprint(sub.head())","0d83330d":"**Step0 : Import baisic**","f08b79c2":"**Step2 : ready for model**","888ea10b":"**Step1 : input data and check**"}}