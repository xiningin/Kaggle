{"cell_type":{"a3127da0":"code","4fab3822":"code","88e345bf":"code","534d2ba5":"code","e7954e42":"markdown","2ecdf639":"markdown","a19eacfa":"markdown"},"source":{"a3127da0":"import pandas as pd\nfrom matplotlib import pyplot\nimport statsmodels.api as sm\nfrom statsmodels.graphics.tsaplots import plot_acf\nfrom statsmodels.tsa.arima.model import ARIMA\nfrom sklearn.metrics import mean_squared_error\nfrom math import sqrt\nimport csv\nimport pmdarima as pm\nimport warnings\n\nwarnings.filterwarnings('ignore')","4fab3822":"df=pd.read_csv('Dataframe Outliers.csv')\ndf_forecast=pd.read_csv('Weather Test.csv')\n\ncoast=df[df['region']=='Coast']\ncoast.set_index(['date'],inplace=True)\ncoast_test=df_forecast[df_forecast['region']=='Coast']\ncoast_test.set_index(['date'],inplace=True)\ncoast_y_train=coast[['ercotNew']].tail(13149)\ncoast_x_train=coast[['DewPointCNew']].tail(13149)\ncoast_x_test=coast_test[['DewPointCNew']]\n\neast=df[df['region']=='East']\neast.set_index(['date'],inplace=True)\neast_test=df_forecast[df_forecast['region']=='East']\neast_test.set_index(['date'],inplace=True)\neast_y_train=east[['ercotNew']]\neast_x_train=east[['pressureNew']]\neast_x_test=east_test[['pressureNew']]\n\nfar_west=df[df['region']=='Far West']\nfar_west.set_index(['date'],inplace=True)\nfar_west_test=df_forecast[df_forecast['region']=='Far West']\nfar_west_test.set_index(['date'],inplace=True)\nfar_west_y_train=far_west[['ercotNew']]\nfar_west_x_train=far_west[['humidityNew','WindGustMilesNew']]\nfar_west_x_test=far_west_test[['humidityNew','WindGustMilesNew']]\n\nnorth=df[df['region']=='North']\nnorth.set_index(['date'],inplace=True)\nnorth_test=df_forecast[df_forecast['region']=='North']\nnorth_test.set_index(['date'],inplace=True)\nnorth_y_train=north[['ercotNew']].tail(13149)\nnorth_x_train=north[['humidityNew']].tail(13149)\nnorth_x_test=north_test[['humidityNew']]\n\nnorth_central=df[df['region']=='North Central']\nnorth_central.set_index(['date'],inplace=True)\nnorth_central_test=df_forecast[df_forecast['region']=='North Central']\nnorth_central_test.set_index(['date'],inplace=True)\nnorth_central_y_train=north_central[['ercotNew']]\nnorth_central_x_train=north_central[['humidityNew','FeelsLikeCNew','WindChillCNew','tempCNew',\n                                     'weatherCodeNew','visibilityNew']]\nnorth_central_x_test=north_central_test[['humidityNew','FeelsLikeCNew','WindChillCNew','tempCNew',\n                                     'weatherCodeNew','visibilityNew']]\n\nsouth=df[df['region']=='South']\nsouth.set_index(['date'],inplace=True)\nsouth_test=df_forecast[df_forecast['region']=='South']\nsouth_test.set_index(['date'],inplace=True)\nsouth_y_train=south[['ercotNew']].tail(13149)\nsouth_x_train=south[['pressureNew','HeatIndexCNew']].tail(13149)\nsouth_x_test=south_test[['pressureNew','HeatIndexCNew']]\n\nsouth_central=df[df['region']=='South Central']\nsouth_central.set_index(['date'],inplace=True)\nsouth_central_test=df_forecast[df_forecast['region']=='South Central']\nsouth_central_test.set_index(['date'],inplace=True)\nsouth_central_y_train=south_central[['ercotNew']]\nsouth_central_x_train=south_central[['FeelsLikeCNew']]\nsouth_central_x_test=south_central_test[['FeelsLikeCNew']]\n\nwest=df[df['region']=='West']\nwest.set_index(['date'],inplace=True)\nwest_test=df_forecast[df_forecast['region']=='West']\nwest_test.set_index(['date'],inplace=True)\nwest_y_train=west[['ercotNew']]\nwest_x_train=west[['uvIndexNew']]\nwest_x_test=west_test[['uvIndexNew']]","88e345bf":"mod = sm.tsa.statespace.SARIMAX(coast_y_train,order=(1,1,1),seasonal_order=(1,1,1,24),\n                                exog=coast_x_train, enforce_stationarity=False, enforce_invertibility=False)\n\nresults=mod.fit()\npred_uc = results.get_forecast(steps=193,exog=coast_x_test)\nforecast1 = pred_uc.predicted_mean\n\ncoast_fore=pd.DataFrame({'Date':forecast1.index,'Coast':forecast1.values})\n\n\n\n\nmod = ARIMA(east_y_train,order=(5,0,1),exog=east_x_train)\n\nresults=mod.fit()\npred_uc = results.get_forecast(steps=193,exog=east_x_test)\nforecast2 = pred_uc.predicted_mean\n\n\neast_fore=pd.DataFrame({'Date':forecast2.index,'East':forecast2.values})\n\n\n\n\nmod = ARIMA(far_west_y_train,order=(3,0,1),exog=far_west_x_train)\n\nresults=mod.fit()\npred_uc = results.get_forecast(steps=193,exog=far_west_x_test)\nforecast3 = pred_uc.predicted_mean\n\nfar_west_fore=pd.DataFrame({'Date':forecast3.index,'Far_West':forecast3.values})\n\n\n\n\n\nmod = sm.tsa.statespace.SARIMAX(north_y_train,order=(2,1,0),seasonal_order=(2,1,0,24),\n                                exog=north_x_train, enforce_stationarity=False, enforce_invertibility=False)\n\nresults=mod.fit()\npred_uc = results.get_forecast(steps=193,exog=north_x_test)\nforecast4 = pred_uc.predicted_mean\n\nnorth_fore=pd.DataFrame({'Date':forecast4.index,'North':forecast4.values})\n\n\n\n\n\nmod = ARIMA(north_central_y_train,order=(4,0,4),exog=north_central_x_train)\n\nresults=mod.fit()\npred_uc = results.get_forecast(steps=193,exog=north_central_x_test)\nforecast5 = pred_uc.predicted_mean\n\nnorth_central_fore=pd.DataFrame({'Date':forecast5.index,'North_Central':forecast5.values})\n\n\n\nmod = sm.tsa.statespace.SARIMAX(south_y_train,order=(2,1,0),seasonal_order=(2,1,0,24),\n                                exog=south_x_train, enforce_stationarity=False, enforce_invertibility=False)\n\nresults=mod.fit()\npred_uc = results.get_forecast(steps=193,exog=south_x_test)\nforecast6 = pred_uc.predicted_mean\n\nsouth_fore=pd.DataFrame({'Date':forecast6.index,'South':forecast6.values})\n\n\n\n\n\nmod = ARIMA(south_central_y_train,order=(5,0,1),exog=south_central_x_train)\n\nresults=mod.fit()\npred_uc = results.get_forecast(steps=193,exog=south_central_x_test)\nforecast7 = pred_uc.predicted_mean\n\nsouth_central_fore=pd.DataFrame({'Date':forecast7.index,'South_Central':forecast7.values})\n\n\n\n\n\nmod = ARIMA(west_y_train,order=(3,0,1),exog=west_x_train)\n\nresults=mod.fit()\npred_uc = results.get_forecast(steps=193,exog=west_x_test)\nforecast8 = pred_uc.predicted_mean\n\nwest_fore=pd.DataFrame({'Date':forecast8.index,'West':forecast8.values})","534d2ba5":"# compile the list of dataframes you want to merge\ndata_frames = [coast_fore, east_fore, far_west_fore,north_fore, north_central_fore, south_fore,\n               south_central_fore,west_fore]\ndf_merged = reduce(lambda  left,right: pd.merge(left,right,on=['Date'],\n                                            how='inner'), data_frames)\n\ndf_merged['Date'] = df_merged['Date'].str.replace('+00:00','+05:00')\n\ndf_merged.to_csv('Submission.csv')\n","e7954e42":"Read in data and create all the needed data for the models","2ecdf639":"Run all the models","a19eacfa":"Combine data frames and output results to excel"}}