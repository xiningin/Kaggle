{"cell_type":{"afdef2cf":"code","bf6edc1a":"code","80ab2704":"code","3bd67464":"code","a2c147e1":"code","a583c80a":"code","2d254897":"code","1c8b91a7":"code","7be293a1":"code","7a806be6":"code","3c3a91d7":"markdown"},"source":{"afdef2cf":"import pandas as pd\nimport numpy as np\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.metrics.pairwise import linear_kernel\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom ast import literal_eval\n%matplotlib inline","bf6edc1a":"books = pd.read_csv(\"..\/input\/top2k-books-with-descriptions\/top2k_book_descriptions.csv\", index_col=0)\nbooks","80ab2704":"\nbooks['tag_name'] = books['tag_name'].apply(lambda x: literal_eval(x) if literal_eval(x) else np.nan)\nmabooks = books[books['description'].notnull() | books['tag_name'].notnull()]\nmabooks = mabooks.fillna('')","3bd67464":"def make_soup(x):\n    soup = x[\"original_title\"]+\" \"+x[\"description\"]\n    return soup","a2c147e1":"soups = mabooks.apply(make_soup, axis=1).rename(\"soup\")\nmabooks= mabooks.join(soups)","a583c80a":"tfidf = TfidfVectorizer(stop_words=\"english\")\n\ntfidf_matrix = tfidf.fit_transform(mabooks['soup'])\n\ntfidf_matrix.shape\n","2d254897":"\n\ncosine_sim = linear_kernel(tfidf_matrix, tfidf_matrix)","1c8b91a7":"indices = pd.Series(mabooks.index, index=mabooks['original_title'].apply(lambda x: x.lower())).drop_duplicates()\n","7be293a1":"def content_recommender(title, cosine_sim=cosine_sim, mabooks=mabooks, indices=indices):\n    idx = indices[title.lower()]\n\n    sim_scores = list(enumerate(cosine_sim[idx]))\n    \n    sim_scores = sorted(sim_scores, key=lambda x:x[1], reverse=True)\n    sim_scores = sim_scores[1:11]\n\n    book_indices = [i[0] for i in sim_scores]\n\n    return mabooks['title'].iloc[book_indices]\n","7a806be6":"content_recommender('The Da Vinci Code')","3c3a91d7":"# A simple Content Based Recommender"}}