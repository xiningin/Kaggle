{"cell_type":{"1845f9ef":"code","46b92e3d":"code","a93bf721":"code","3278a959":"code","856714ab":"code","d0bfc84f":"code","0dc4700f":"code","896ef456":"code","adaef840":"code","b1d786ed":"code","5bff6f17":"code","6f719df8":"code","2c7cb3fa":"code","801c7c94":"code","ab3c240e":"code","2bdc217f":"code","fe26ceb1":"code","9b525c4c":"code","d9db057d":"code","0b006b35":"code","596244df":"code","3520949c":"code","f61cfe77":"code","61b0505e":"code","6753e280":"code","d1e33cde":"code","5162a372":"markdown","04a2bbaa":"markdown"},"source":{"1845f9ef":"# import the required librairies\nimport numpy as np\nimport pandas as pd\nfrom sklearn.metrics import classification_report,accuracy_score,confusion_matrix\nfrom sklearn.ensemble import IsolationForest\nfrom sklearn.neighbors import LocalOutlierFactor\nfrom sklearn.svm import OneClassSVM\nfrom pylab import rcParams\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nrcParams['figure.figsize']= 14,8\nRANDOM_SEED = 42\nLABELS =['Normal','Fraud']\nimport warnings\nwarnings.filterwarnings('ignore')","46b92e3d":"# Loading the data from file\ndf = pd.read_csv('..\/input\/creditcardfraud\/creditcard.csv')","a93bf721":"df.head()","3278a959":"df.shape","856714ab":"df['Class'].value_counts()","d0bfc84f":"# Cheack if any null values present or not\ndf.isnull().sum()","0dc4700f":"sns.countplot(df['Class'])\nplt.xlabel('Class')\nplt.ylabel(\"Frequency\")\nplt.show()","896ef456":"fraud = df[df['Class']==1]\nnormal = df[df['Class']==0]","adaef840":"fraud.Amount.describe()","b1d786ed":"f, (ax1, ax2) = plt.subplots(2, 1, sharex=True)\nf.suptitle('Amount per transaction by class')\nbins = 50\nax1.hist(fraud.Amount, bins = bins)\nax1.set_title('Fraud')\nax2.hist(normal.Amount, bins = bins)\nax2.set_title('Normal')\nplt.xlabel('Amount ($)')\nplt.ylabel('Number of Transactions')\nplt.xlim((0, 20000))\nplt.yscale('log')\nplt.show();","5bff6f17":"# Taking sample of data from large dataset\ndf1 =  df.sample(frac=0.1,random_state=1)","6f719df8":"df1.shape","2c7cb3fa":"Fraud = df1[df1['Class']==1]\nNormal = df1[df1['Class']==0]\n\noutlier_fraction = len(Fraud)\/float(len(Normal))","801c7c94":"outlier_fraction","ab3c240e":"Fraud.shape","2bdc217f":"Normal.shape","fe26ceb1":"cor = df1.corr()\ntop_cor_features = cor.index\nplt.figure(figsize=(20,20))\n\ng = sns.heatmap(df[top_cor_features].corr(),annot=True,cmap='RdYlGn')","9b525c4c":"X = df.drop('Class',axis=1)\ny = df['Class']","d9db057d":"X.shape","0b006b35":"y.shape","596244df":"# Creating model with Isolation Forest Algorithm\nmodel = IsolationForest(n_estimators=100,max_samples=len(X),contamination = outlier_fraction,verbose=0)","3520949c":"model.fit(X)","f61cfe77":"y_pred = model.predict(X)","61b0505e":"y_pred[y_pred ==1] = 0\ny_pred[y_pred ==-1] = 1","6753e280":"acc = accuracy_score(y,y_pred)","d1e33cde":"print(\"Accuray of the model:- {}\".format(acc))","5162a372":"# Credit Card Fraud Detection ","04a2bbaa":"### Exploratory Data Analysis  "}}