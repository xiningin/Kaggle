{"cell_type":{"9c20d07a":"code","bdea9ca8":"code","5d0d1f40":"code","89dc0c8c":"code","1540af4f":"code","aa18a648":"code","584f633e":"code","9d20dccc":"code","62a1cc78":"code","fa0af554":"code","ea922116":"code","3fde92ae":"code","0608e9d0":"markdown","6f77f49d":"markdown","87bdff7c":"markdown","fe2018f8":"markdown","b9efa942":"markdown","5f84d98b":"markdown","dd118d39":"markdown","446ca39f":"markdown","2a91c517":"markdown","1dbadfb4":"markdown","bad71185":"markdown","2dc125aa":"markdown","d30aaa4b":"markdown","aae43bdb":"markdown","173af458":"markdown"},"source":{"9c20d07a":"# Importing required libraries\n\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt \nfrom sklearn.model_selection import train_test_split \nfrom sklearn.linear_model import LinearRegression\nfrom sklearn import metrics\n%matplotlib inline","bdea9ca8":"# Loading data\ndata = pd.read_csv('..\/input\/advertising.csv\/Advertising.csv')","5d0d1f40":"# First few rows of data\ndata.head()","89dc0c8c":"plt.figure(figsize=(14,4))\n\nplt.subplot(1,3,1)\nplt.scatter(data['TV'], data['sales'], color='blue')\nplt.xlabel('TV')\nplt.ylabel('sales')\n\nplt.subplot(1,3,2)\nplt.scatter(data['radio'], data['sales'], color = 'red')\nplt.xlabel('radio')\nplt.ylabel('sales')\n\nplt.subplot(1,3,3)\nplt.scatter(data['newspaper'], data['sales'], color = 'green')\nplt.xlabel('newspaper')\nplt.ylabel('sales')\n\nplt.show()","1540af4f":"# Defining X & Y\n\nX = data['TV'].values.reshape(-1,1)\nY = data['sales'].values.reshape(-1,1)","aa18a648":"# Splitting data into Train and Test datasets\nX_train, X_test, y_train, y_test = train_test_split(X, Y, test_size=0.2, random_state=0)","584f633e":"# Fitting the Linear Regression Model\nModel = LinearRegression()\nModel.fit(X_train, y_train)","9d20dccc":"train_fit = Model.predict(X_train)\ntest_pred = Model.predict(X_test) ","62a1cc78":"plt.figure(figsize=(12,4))\n\nplt.subplot(1,2,1)\nplt.scatter(X_train, y_train, color='gray')\nplt.plot(X_train, train_fit, color='blue', linewidth=2)\nplt.xlabel('TV')\nplt.ylabel('sales')\nplt.title(\"Train Dataset\")\n\nplt.subplot(1,2,2)\nplt.scatter(X_test, y_test, color='gray')\nplt.plot(X_test, test_pred, color='blue', linewidth=2)\nplt.xlabel('TV')\nplt.ylabel('sales')\nplt.title(\"Test Dataset\")\n\nplt.show()","fa0af554":"#To print the value of Intercept:\nprint(Model.intercept_)\n\n# To print the value of x-coefficient or slope:\nprint(Model.coef_)","ea922116":"plt.figure(figsize=(10,7))\nplt.scatter(X_train, y_train,  color='firebrick', s=20)\nplt.plot(X_train, train_fit, color='royalblue', linewidth=0.7)\nfor i in range(X_train.shape[0]):\n    plt.plot([X_train[i], X_train[i]], [y_train[i], train_fit[i]], color='black', linewidth=0.5)\nplt.xlabel(\"TV\")\nplt.ylabel(\"sales\")\nplt.title(\"Residuals in the data after fitting the model\")\nplt.text(240,3,\"@DataScienceWithSan\")\nplt.text(0, 23, \"Verical lines represent\\nthe distance between\\neach data point and \\nthe regression line of model\")\nplt.show()","3fde92ae":"print('Mean Squared Error:', metrics.mean_squared_error(y_test, test_pred))  \nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y_test, test_pred)))\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y_test, test_pred))  ","0608e9d0":"### Building the model","6f77f49d":"### Visualizing data","87bdff7c":"Let's visualize these residuals with the help of the following code:","fe2018f8":"I'm going to use Advertising data which is avaialble on the site of USC Marshall School of Business. \n\nThis dataset contains information about sales of a product (output variable) in 200 different markets, and three advertising media (input variables) that affect these sales: TV, radio and newspaper.\n\nThe sales column depicts the number of units sold in 1000. The other columns depict the budget in $1000. ","b9efa942":"For simplicity, I have only used TV column to explain Simple Linear Regression.\n\n\u2192 \ud835\udc46\ud835\udc4e\ud835\udc59\ud835\udc52\ud835\udc60 = \ud835\udefd0 + \ud835\udefd1 * \ud835\udc47\ud835\udc49","5f84d98b":"To Evaluate Error following measures can be considered:\n\n1. Mean Squared Error (MSE): It is the mean of squared residuals (e\u00b2).\n\n2. Root Mean Squared Error (RMSE): As the name suggests, it is the square root of Mean Squared Error and is more suitable when large errors are particularly undesirable.\n\n3. Mean Absolute Error (MAE): Instead of taking squares, we take absolute values of residuals and calculate their mean.","dd118d39":"Storing the predicted results of the Model","446ca39f":"### Error Evaluation","2a91c517":"![image.png](attachment:image.png)","1dbadfb4":"**The intercept** is the value of output when the input is 0. In this case, it is the estimated value of sales in the absence of a TV advertising budget. The value of the intercept here is 7.033, which means that without TV advertisements, the number of units sold is 7,033 (Sales*1000 units).\n\n**The coefficient** or the slope is the measure of the change in the output variable per unit change in the input variable. Here, the coefficient of Model is 0.048, which means that if we increase the TV advertising budget by 1 unit ($1000), the sales of the product will increase by approximately 48 units (0.048*1000).","bad71185":"The points that lie on the line or very closer to it are the ones that the model was able to predict correctly. However, there are many points that lie away from the regression line. The distance of every such point from the straight line accounts for the error.","2dc125aa":"Let's visualize the Regression Line on top of Training and Testing Dataset","d30aaa4b":"#### Simple Linear Regression is mathematically expressed as\n![image.png](attachment:image.png)\n\nLet's understand it by building a Simple Linear Regession model. ","aae43bdb":"The error function can be considered as the distance between the current state and the ideal state. A model starts with an initial state where it assumes some value of parameters involved and thereby adjusting those parameters to reduce the error function.\n\nIn this case, the intercept and the advertising coefficient are the parameters to be adjusted, whereas the error function is the overall difference between the actual sales and the predicted sales.","173af458":"The first row of the data says that the advertising budgets for TV, radio, and newspaper were $230.1k, $37.8k, and $69.2k respectively, and the corresponding number of units that were sold was 22.1k (or 22,100)."}}