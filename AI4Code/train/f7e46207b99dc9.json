{"cell_type":{"b0ce73db":"code","4c436266":"code","2a885c6c":"code","06668efd":"code","d7ab4448":"code","b41aaa64":"code","a6ae938d":"code","2f27a660":"code","f7a59d4e":"code","95f5f202":"code","d7eb2165":"code","15d94520":"code","43449032":"code","119db30b":"code","0782b40c":"markdown","4f16fd76":"markdown","b7f29906":"markdown","6b654dca":"markdown","d7ff7963":"markdown","ca0b787b":"markdown","e8887361":"markdown"},"source":{"b0ce73db":"import os\n\nimport cv2\n\nfrom tqdm import tqdm\n\nimport numpy as np\nimport pandas as pd\n\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport matplotlib.image as mpimg","4c436266":"train_df = pd.read_csv(\"..\/input\/petfinder-pawpularity-score\/train.csv\")\ntest_df = pd.read_csv(\"..\/input\/petfinder-pawpularity-score\/test.csv\")\nsample_sub_df = pd.read_csv(\"..\/input\/petfinder-pawpularity-score\/sample_submission.csv\")","2a885c6c":"print(f\"Training data size: {train_df.shape}\")\nprint(f'Number of images in \"train\/\": {len(os.listdir(\"..\/input\/petfinder-pawpularity-score\/train\"))}')","06668efd":"train_df.head()","d7ab4448":"test_df.head()","b41aaa64":"sample_sub_df.head()","a6ae938d":"sns.displot(train_df[\"Pawpularity\"], kind=\"hist\", kde=True, height=8)","2f27a660":"pd.DataFrame(train_df[\"Pawpularity\"].describe())","f7a59d4e":"f, ax = plt.subplots(2, 6, figsize=(16, 12))\nax = ax.flatten()\n\nfor idx, col in enumerate(list(train_df.columns)[1:-1]):\n    sns.histplot(train_df[[col, \"Pawpularity\"]], hue=col, x=\"Pawpularity\", kde=True, ax=ax[idx])","95f5f202":"f, ax = plt.subplots(3, 5, figsize=(20, 10))\nax = ax.flatten()\n\nfor idx in range(15):\n    img_id = train_df[train_df['Pawpularity'] == 100]['Id'].iloc[idx]\n    ax[idx].imshow(mpimg.imread(f\"..\/input\/petfinder-pawpularity-score\/train\/{img_id}.jpg\"))\n    ax[idx].title.set_text(f\"Pawpularity: {train_df[train_df['Id'] == img_id]['Pawpularity'].iloc[0]}\")\n    ax[idx].grid(None)","d7eb2165":"f, ax = plt.subplots(3, 5, figsize=(20, 10))\nax = ax.flatten()\n\nfor idx in range(15):\n    img_id = train_df[train_df['Pawpularity'].isin([1, 2])].sort_values(\"Pawpularity\")['Id'].iloc[idx]\n    ax[idx].imshow(mpimg.imread(f\"..\/input\/petfinder-pawpularity-score\/train\/{img_id}.jpg\"))\n    ax[idx].title.set_text(f\"Pawpularity: {train_df[train_df['Id'] == img_id]['Pawpularity'].iloc[0]}\")\n    ax[idx].grid(None)","15d94520":"widths, heights = 0, 0\nfor img_id in tqdm(train_df[\"Id\"]):\n    img = cv2.imread(f\"..\/input\/petfinder-pawpularity-score\/train\/{img_id}.jpg\")\n    h, w, _ = img.shape\n    heights += h\n    widths += w","43449032":"print(f\"Mean Height: {heights\/len(train_df)}\")\nprint(f\"Mean Width: {widths\/len(train_df)}\")","119db30b":"sample_sub_df[\"Pawpularity\"] = train_df[\"Pawpularity\"].mean()\nsample_sub_df.to_csv('submission.csv', index=False)","0782b40c":"## Target variable analysis","4f16fd76":"## Data at a glance!","b7f29906":"The pawpularity ranges between 1 to 100.","6b654dca":"## Some of the least pawpular images","d7ff7963":"## Some of the most pawpular images","ca0b787b":"### Effect of meta variables on pawpularity","e8887361":"## Mean Image size in training set"}}