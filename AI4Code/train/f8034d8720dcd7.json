{"cell_type":{"d2687f73":"code","1733905a":"code","253beb58":"code","56923ccc":"code","80c77d88":"code","b135fd9a":"code","10752587":"code","ed6c2057":"code","81cb0419":"code","7d4a7ce9":"code","380ad8e8":"code","0ae36a55":"code","9ceba6cf":"code","7d931b1b":"code","5a69225a":"code","b1079b52":"code","5efa915f":"code","8cd2a96d":"code","432a1142":"code","a26c419f":"code","99bd87b4":"code","9594b11f":"code","2f68c2c7":"code","3d025857":"code","7afe2efd":"code","1ae6d363":"code","4be43c4d":"code","edbeeb16":"code","a93dc121":"markdown"},"source":{"d2687f73":"import numpy as np\nimport pandas as pd\n\nfilename_train = \"\/kaggle\/input\/titanic\/train.csv\"\n\ntrain = pd.read_csv(filename_train)\ntrain\n","1733905a":"filename_test = \"\/kaggle\/input\/titanic\/test.csv\"\ntest = pd.read_csv(filename_test)\ntest","253beb58":"filename_submit=\"..\/input\/titanic\/gender_submission.csv\"\ngender_submission=pd.read_csv(filename_submit)\n\ngender_submission","56923ccc":"#\u5927\u6d5c\u5148\u751f\u306e\u8cea\u554f\nanimals = pd.DataFrame({'Cows': [12, 20, 3], 'Goats': [50, 19, 50]}, index=['Year 1', 'Year 2', 'Year 3'])\nanimals","80c77d88":"#Goat\u304cmax\u306e\u6642\u306eTrue\/Fales\u30ea\u30b9\u30c8\nprint(animals[\"Goats\"]==animals[\"Goats\"].max())\n\n#Goats\u304cmax\u306e\u6642\u306eCows\u306e\u5024\u3092Series\u3067\u8fd4\u3059\nprint(animals[\"Cows\"][animals[\"Goats\"]==animals[\"Goats\"].max()])\n\n#\u30d6\u30fc\u30eb\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u53c2\u7167\u3068\u3044\u3046\u65b9\u6cd5","b135fd9a":"data = pd.concat([train, test], sort=False)\ndata","10752587":"data.isnull().sum()","ed6c2057":"data['Sex'].replace(['male', 'female'], [0, 1], inplace=True)\n","81cb0419":"data","7d4a7ce9":"data['Embarked'].value_counts()","380ad8e8":"data['Embarked'].fillna(('S'), inplace=True)","0ae36a55":"data['Embarked'].value_counts()","9ceba6cf":"data.isnull().sum()","7d931b1b":"data['Embarked'] = data['Embarked'].map({'S': 0, 'C': 1, 'Q': 2}).astype(int)","5a69225a":"data","b1079b52":"data['Fare'].fillna(np.mean(data['Fare']), inplace=True)","5efa915f":"age_avg = data['Age'].mean()\nage_std = data['Age'].std()\n\ndata['Age'].fillna(np.random.randint(age_avg - age_std, age_avg + age_std), inplace=True)","8cd2a96d":"data","432a1142":"delete_columns = ['Name', 'PassengerId', 'SibSp', 'Parch', 'Ticket', 'Cabin']\ndata.drop(delete_columns, axis=1, inplace=True)","a26c419f":"train = data[:len(train)]\ntest = data[len(train):]","99bd87b4":"y_train = train['Survived']\nX_train = train.drop('Survived', axis=1)\nX_test = test.drop('Survived', axis=1)","9594b11f":"X_train.head()","2f68c2c7":"y_train.head()","3d025857":"from sklearn.model_selection import train_test_split\n\n\nX_train, X_valid, y_train, y_valid = \\\n    train_test_split(X_train, y_train, test_size=0.3,\n                                 random_state=0, stratify=y_train)","7afe2efd":"categorical_features = ['Embarked', 'Pclass', 'Sex',\"Fare\"]","1ae6d363":"import lightgbm as lgb\n\n\nlgb_train = lgb.Dataset(X_train, y_train,\n                                         categorical_feature=categorical_features)\nlgb_eval = lgb.Dataset(X_valid, y_valid, reference=lgb_train,\n                                         categorical_feature=categorical_features)\n\nparams = {\n    'objective': 'binary'\n}\n\nmodel = lgb.train(params, lgb_train,\n                               valid_sets=[lgb_train, lgb_eval],\n                               verbose_eval=10,\n                               num_boost_round=1000,\n                               early_stopping_rounds=10)\n\ny_pred = model.predict(X_test, num_iteration=model.best_iteration)","4be43c4d":"y_pred = (y_pred > 0.5).astype(int)\ny_pred[:10]","edbeeb16":"sub = pd.read_csv('..\/input\/titanic\/gender_submission.csv')\nsub['Survived'] = y_pred\nsub.to_csv('submission.csv', index=False)\n\nsub.head()","a93dc121":"**\u3053\u3053\u304b\u3089\u7279\u5fb4\u91cf\u30a8\u30f3\u30b8\u30cb\u30a2\u30ea\u30f3\u30b0**"}}