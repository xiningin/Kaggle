{"cell_type":{"40038a62":"code","2d96f740":"code","4253b056":"code","1b68914d":"code","61650b00":"code","28aca75f":"code","6940fec7":"code","78f3d6e2":"code","36b64221":"code","ee7e5f93":"code","7a116335":"code","521b4d0d":"code","7ac4cbad":"code","27155a73":"markdown","50c80ec3":"markdown"},"source":{"40038a62":"import pandas as pd","2d96f740":"df_train = pd.read_csv('..\/input\/train.csv')\ndf_test = pd.read_csv('..\/input\/test.csv')","4253b056":"df_train = df_train.drop(['Dates', 'Descript', 'Resolution', 'Address'], axis=1)\ndf_test = df_test.drop(['Id','Dates', 'Address'], axis=1)\ndf_train.head()","1b68914d":"## using label encoder","61650b00":"from sklearn.preprocessing import LabelEncoder\n\nle_cat = LabelEncoder()\ncat_encoded = le_cat.fit_transform(df_train['Category'])\n#cat_encoded_t = le_cat.fit_transform(df_test['Category'])\n\nle_day = LabelEncoder()\nday_encoded = le_day.fit_transform(df_train['DayOfWeek'])\nday_encoded_t = le_day.fit_transform(df_test['DayOfWeek'])\n\nle_district = LabelEncoder()\ndistrict_encoded = le_district.fit_transform(df_train['PdDistrict'])\ndistrict_encoded_t = le_district.fit_transform(df_test['PdDistrict'])\n\n## apply label encoded on dataset\n\ndf_train['Category'] = cat_encoded\ndf_train['DayOfWeek'] = day_encoded\ndf_train['PdDistrict'] = district_encoded\n\ndf_test['DayOfWeek'] = day_encoded_t\ndf_test['PdDistrict'] = district_encoded_t\n\ndf_train.head()\n#df_test.head()","28aca75f":"from sklearn.model_selection import train_test_split\n\ny = df_train['Category']\nX = df_train.drop(['Category'], axis=1)\n\n# split data\nX_train, X_test, y_train, y_test= train_test_split(X, y, test_size=0.2, stratify=y, random_state=42)","6940fec7":"test_X = df_test","78f3d6e2":"from sklearn.tree import DecisionTreeClassifier\nfrom sklearn import tree\nfrom sklearn.metrics import log_loss\n#print(X_test)\n    \ndt = DecisionTreeClassifier(max_depth=10, random_state=42)\ndt.fit(X_train,y_train)\n#y_pred = dt.predict(X_test)\ny_pred = dt.predict_proba(X_test)\nprint(log_loss(y_test, y_pred))","36b64221":"dt.feature_importances_","ee7e5f93":"# creating a sample dataset\ny_pred = dt.predict(test_X)\nle_cat.inverse_transform(y_pred)","7a116335":"# probability\nimport numpy as np\ny_pred_proba = dt.predict_proba(test_X)\n\nprobs = np.zeros((1,39))\nprobs = y_pred_proba\n#print(probs)\ncol = le_cat.inverse_transform(range(39))\nprint(col)","521b4d0d":"# criando um dataframe\n\nds = pd.DataFrame(probs, columns=col)\ncounts = np.array(range(ds.shape[0]))\ncounts = counts.astype('int64')\n\n\nds.insert(0, \"Id\", counts)\nds.info()","7ac4cbad":"# save dataframe submission\nds.to_csv('submission.csv', sep=',', index=False)","27155a73":"## pr\u00e9 - processamento","50c80ec3":"## analise dos dados"}}