{"cell_type":{"c78290ac":"code","7d4934c4":"code","d7f712bf":"code","dc21860a":"code","ac648a9c":"code","34c08df2":"code","042035bb":"code","430f4d6a":"code","b6e310e2":"code","8f0261f2":"code","d2459f7f":"code","febc025f":"code","42d8f342":"code","dd55a0cd":"code","5ce83921":"code","b89f9322":"code","769bd410":"code","5e414133":"code","8eb5a4db":"code","9379e25a":"code","4ff131ca":"code","a7534539":"code","b64aeeef":"code","248b1b72":"code","5db1f416":"code","456a3da8":"code","32823d5e":"code","58dfecd5":"code","27396ed1":"markdown","32a8873b":"markdown","4edbf00e":"markdown","aa1c69eb":"markdown","9f3dd34d":"markdown","e2a06cca":"markdown","2987aa68":"markdown","ccc29a79":"markdown","824d2570":"markdown","354b7916":"markdown"},"source":{"c78290ac":"!pip install siuba","7d4934c4":"import numpy as np\nimport pandas as pd \nimport matplotlib.pyplot as plt \nimport seaborn as sns\nimport datetime\nfrom siuba.dply.forcats import fct_lump\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","d7f712bf":"sns.set_theme(style = 'darkgrid')","dc21860a":"df = pd.read_csv('\/kaggle\/input\/netflix-shows\/netflix_titles.csv')\nnetflix = df.copy()\nnetflix.head()","ac648a9c":"(netflix.isnull().sum()\/len(netflix)) * 100","34c08df2":"# filling missing values for each variables\nnetflix['director'] = netflix['director'].fillna(value = 'No Director')\nnetflix['cast'] = netflix['cast'].fillna(value = 'No Cast')\nnetflix['country'] = netflix['country'].fillna(value = 'United States')\nnetflix['date_added'] = netflix['date_added'].fillna(value = datetime.datetime(2020, 1,1))\nnetflix['rating'] = netflix['rating'].fillna(value = 'Other')\n\n# lump together least\/most common factor levels into \"other\"\nnetflix['rating'] = fct_lump(netflix['rating'], n = 5)\n\n# getting the months from the dates\nnetflix['month'] = pd.to_datetime(netflix['date_added']).dt.month","042035bb":"(netflix.isnull().sum()\/len(netflix)) * 100","430f4d6a":"def column_list_tokenizer_count(df, subset_cols, secondary_col):\n\n    # Creating an empty list\n    token_list = []\n\n    # Removing any missing values just in case if they are any within the dataset. \n    # As well reseting the index.\n    clean_df = df.dropna(subset = [subset_cols])\n    clean_df.reset_index(inplace = True)\n    \n    # This for loop would go to every single row and split the string \n    # values into a list essentially tokenizing them.\n    if secondary_col == None:\n        for i, element in clean_df.iterrows():\n            for token in str(element[subset_cols]).strip(' ').split(','):\n                token_list.append([token.strip()])\n\n    # Returns a dataframe based from the appended list and counting each unique value \n    # from the inserted 'subset_cols' variable.\n        token_data = pd.DataFrame(data = token_list, columns = [token])\n        return token_data\n    else:\n        for i, element in clean_df.iterrows():\n            secondary_cols = element[secondary_col]\n            for token in str(element[subset_cols]).strip(' ').split(','):\n                token_list.append([secondary_cols, token.strip()])\n\n        token_data = pd.DataFrame(data = token_list, columns = [secondary_cols, token])\n        return token_data.value_counts().to_frame().rename(columns = {0: 'count'}).reset_index(level = [0, 1])","b6e310e2":"def plot_bar(x_var, y_var, df, num_colors, title_name, xlabel_name, ylabel_name, hue_col):\n    if hue_col == None:\n        plt.figure(figsize = (10,6))\n        sns.barplot(x = x_var, y = y_var, data = df, ci = False,\n                    palette = sns.dark_palette(color = '#b60c26', n_colors = num_colors, reverse = True, input = 'hsl'))\n        plt.title(title_name, fontdict = {'fontsize': 16, 'fontweight': 'bold'})\n        plt.xlabel(xlabel_name)\n        plt.ylabel(ylabel_name)\n        plt.show()\n    else:\n        plt.figure(figsize = (10,6))\n        sns.barplot(x = x_var, y = y_var, data = df, ci = False, hue = hue_col,\n                    palette = sns.dark_palette(color = '#b60c26', n_colors = num_colors, reverse = True, input = 'hsl'))\n        plt.title(title_name, fontdict = {'fontsize': 16, 'fontweight': 'bold'})\n        plt.xlabel(xlabel_name)\n        plt.ylabel(ylabel_name)\n        plt.show()","8f0261f2":"genre_data = (column_list_tokenizer_count(df = netflix, subset_cols = 'listed_in', secondary_col = 'type')\n             .rename(columns = {'Movie': 'type', ' Music & Musicals': 'genre'}))","d2459f7f":"top_genre_movies = genre_data[genre_data['type'] == 'Movie'].nlargest(n = 10, columns = 'count')\ntop_genre_movies","febc025f":"plot_bar(x_var = 'count',\n         y_var = 'genre',\n         df = top_genre_movies, \n         num_colors = 10, \n         title_name = 'Top 10 Genres in Movies', \n         xlabel_name = 'Frequency', \n         ylabel_name = 'Name of Genres',\n         hue_col = None)","42d8f342":"top_genre_shows = genre_data[genre_data['type'] == 'TV Show'].nlargest(n = 10, columns = 'count')\ntop_genre_shows","dd55a0cd":"plot_bar(x_var = 'count',\n         y_var = 'genre',\n         df = top_genre_shows, \n         num_colors = 10, \n         title_name = 'Top 10 Genres in TV Shows', \n         xlabel_name = 'Frequency', \n         ylabel_name = 'Name of Genres', \n         hue_col = None)","5ce83921":"plt.figure(figsize = (10, 6))\nsns.countplot(x = 'type', hue = 'rating', data = netflix, palette = sns.color_palette(\"icefire\"))\nplt.title('Rating Type Distibution in Movies and TV Shows', fontdict = {'fontsize': 16, 'fontweight': 'bold'})\nplt.xlabel('Content Type')\nplt.ylabel('Rating Frequency')\nplt.show()","b89f9322":"top_10_countries = (column_list_tokenizer_count(df = netflix, subset_cols = 'country', secondary_col = None)\n                   .value_counts()\n                   .to_frame()\n                   .reset_index()\n                   .rename(columns = {' United States': 'country', 0: 'count'})\n                   .nlargest(n = 10, columns = 'count'))\n\nplot_bar(x_var = 'count',\n         y_var = 'country',\n         df = top_10_countries, \n         xlabel_name = 'Frequency', \n         ylabel_name ='Name of Countries', \n         title_name = 'Countries with the Most Content', \n         num_colors = 10, \n         hue_col = None)","769bd410":"country_data = (column_list_tokenizer_count(df = netflix, subset_cols = 'country',secondary_col = 'type')\n                .rename(columns = {'Movie': 'type', ' United States': 'country'}))\ntop_countries_content = country_data[country_data['country'].isin(top_10_countries['country'])]\ntop_countries_content.head()","5e414133":"plot_bar(x_var = 'count', \n         y_var = 'country', \n         df = top_countries_content,\n         num_colors = 2, \n         xlabel_name = 'Frequency', \n         ylabel_name = 'Name of Countries', \n         title_name = 'Which Content Type does each Country produce the most?', \n         hue_col = 'type')","8eb5a4db":"years_count_type = (netflix[(netflix['release_year'] >= 2007) & (netflix['release_year'] < 2021)]\n                   .groupby(by = ['type', 'release_year'], as_index = False)['show_id']\n                   .count())\nyears_count_type.rename(columns = {'show_id': 'count'}, inplace = True)\nyears_count_type.head()","9379e25a":"plt.figure(figsize = (10, 6))\nsns.lineplot(x = 'release_year', y = 'count', hue = 'type', data = years_count_type, \n             palette = sns.dark_palette(color = '#b60c26', n_colors = 2, reverse = True, input = 'hsl'))\nplt.title('The Growth of Movies\/TV Shows over the years', fontdict = {'fontsize': 16, 'fontweight': 'bold'})\nplt.xlabel('Release Year')\nplt.xticks(ticks = years_count_type['release_year'].unique())\nplt.ylabel('Frequency')\nplt.show()","4ff131ca":"net_rating = (netflix\n             .groupby(by = ['month', 'rating'])['month']\n             .count()\n             .to_frame()\n             .rename(columns = {'month':'count'})\n             .reset_index())\n\nplt.figure(figsize = (10,6))\nsns.lineplot(x = 'month', \n             y = 'count', \n             data = net_rating,\n             hue = 'rating', \n             style = 'rating', \n             markers= True,\n             palette = sns.color_palette(\"icefire\"))\n\nplt.title('Which Rating Type does Netflix\\n put more into their Platform Per Month?', \n           fontdict = {'fontsize': 16, 'fontweight': 'bold'})\nplt.xticks(ticks = net_rating['month'].unique())\nplt.xlabel('Month')\nplt.ylabel('Frequency')\nplt.show()","a7534539":"net_type = (netflix\n            .groupby(by = ['month', 'rating', 'type'])['month']\n            .count()\n            .to_frame()\n            .rename(columns = {'month':'count'})\n            .reset_index())\n\ng = sns.FacetGrid(net_type, col = 'type', hue = 'rating', palette = sns.color_palette('icefire'))\ng.map(sns.lineplot, 'month', 'count')\ng.set_titles(col_template = 'Which rating type does Netflix\\n put more into their Plaform for\\n {col_name}s Per Month?')\ng.set_axis_labels('Month', 'Frequency')\ng.set(xticks = net_type['month'].unique())\ng.fig.subplots_adjust(wspace = .15, hspace = .25)\ng.add_legend()\nplt.show()","b64aeeef":"director_data = (column_list_tokenizer_count(df = netflix, subset_cols = 'director', secondary_col = 'type')\n                .rename(columns = {'Movie': 'type', 'Sam Dunn': 'director'}))\ndirector_data.head()","248b1b72":"top_director_movies = (director_data[(director_data['type'] == 'Movie') & (director_data['director'] != 'No Director')]\n                      .nlargest(n = 10, columns = 'count'))\n\nplot_bar(x_var = 'count', y_var = 'director', hue_col = None,\n         df = top_director_movies, xlabel_name = 'Director Frequency', ylabel_name = 'Name of Directors', num_colors = 10,\n         title_name = 'Top 10 Famous Directors in Movies')","5db1f416":"top_director_shows = (director_data[(director_data['type'] == 'TV Show') & (director_data['director'] != 'No Director')]\n                      .nlargest(n = 10, columns = 'count'))\n                      \nplot_bar(x_var = 'count', y_var = 'director', hue_col = None,\n         df = top_director_shows, xlabel_name = 'Director Frequency', ylabel_name = 'Name of Directors', num_colors = 10,\n         title_name = 'Top 10 Famous Directors in TV Shows')","456a3da8":"actor_data = (column_list_tokenizer_count(df = netflix, subset_cols = 'cast', secondary_col = 'type')\n             .rename(columns = {'Movie': 'type', 'No Cast': 'cast'}))\nactor_data.head()","32823d5e":"top_actor_movies = (actor_data[(actor_data['type'] == 'Movie') & (actor_data['cast'] != 'No Cast')]\n                    .nlargest(n = 10, columns = 'count'))\n                      \nplot_bar(x_var = 'count', y_var = 'cast', hue_col = None,\n         df = top_actor_movies, xlabel_name = 'Actor Frequency', ylabel_name = 'Name of Actors', num_colors = 10,\n         title_name = 'Top 10 Famous Actors in Movies')","58dfecd5":"top_actor_shows = (actor_data[(actor_data['type'] == 'TV Show') & (actor_data['cast'] != 'No Cast')]\n                    .nlargest(n = 10, columns = 'count'))\n                      \nplot_bar(x_var = 'count', y_var = 'cast', hue_col = None,\n         df = top_actor_shows, xlabel_name = 'Actor Frequency', ylabel_name = 'Name of Actors', num_colors = 10,\n         title_name = 'Top 10 Famous Actors in TV Shows')","27396ed1":"### Inspecting the Data","32a8873b":"# Actor Analysis for Movies and TV Shows","4edbf00e":"# Preprocessing","aa1c69eb":"# Importing Libraries","9f3dd34d":"# Genres Distribution between Movies and TV Shows","e2a06cca":"# Director Analysis for Movies and TV Shows","2987aa68":"# Creating Useful Functions for Efficiency!","ccc29a79":"# Importing Data","824d2570":"# Content Type Distibution in the World","354b7916":"### Setting the Style"}}