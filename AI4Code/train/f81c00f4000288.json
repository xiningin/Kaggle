{"cell_type":{"02c918ed":"code","dd12420d":"code","d8cb239a":"code","22aead07":"code","55162341":"code","39f5ebc4":"code","b9d57e30":"code","f70c6cec":"code","1a8fa16b":"code","a9675cff":"code","f536d272":"code","1a5572c6":"code","55f6cf17":"code","0aaf9d7d":"code","803f5f31":"code","7471b74b":"code","1f7617e2":"code","02929272":"code","df63eaf5":"code","b4176b42":"code","a9f1207a":"code","dc07e29e":"code","8ae45ef6":"code","806cc1e7":"code","debf68e0":"code","131f1d17":"code","6cdb91ad":"code","09d5f7b4":"code","640b09e2":"code","8afc8c5a":"code","8cb39593":"code","62fd0866":"code","05db0832":"code","71d30fbe":"code","64a4a9f4":"code","f16a4bda":"code","9afbe1f0":"code","1b204c67":"code","635ec8b0":"code","285eb3b5":"code","59b5cde7":"code","618e865b":"code","e41fd069":"code","f0918243":"code","4108bf55":"code","6b18cb65":"code","22580841":"code","0a7aa1d0":"code","1a1bc359":"code","a83f3da6":"code","65783113":"code","993f6fd0":"markdown","3d27e903":"markdown"},"source":{"02c918ed":"import pandas as pd \nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n","dd12420d":"creditcard_df= pd.read_csv('UCI_Credit_Card.csv')","d8cb239a":"creditcard_df","22aead07":"creditcard_df.info()","55162341":"creditcard_df.shape","39f5ebc4":"creditcard_df.describe()","b9d57e30":"sns.heatmap(creditcard_df.isnull(),cmap='Blues')","f70c6cec":"creditcard_df.hist(bins=40,figsize=(20,20), color='r')\nplt.show()","1a8fa16b":"creditcard_df.drop(['ID'],axis=1,inplace=True)","a9675cff":"creditcard_df","f536d272":"ccdefault_df=creditcard_df[creditcard_df['default.payment.next.month']==1]\nccnotdefault_df=creditcard_df[creditcard_df['default.payment.next.month']==0]","1a5572c6":"ccdefault_df","55f6cf17":"ccnotdefault_df","0aaf9d7d":"ccdefault_df.describe","803f5f31":"ccnotdefault_df.describe","7471b74b":"print(len(creditcard_df))\nprint(len(ccdefault_df))\nprint( len(ccdefault_df)\/len(creditcard_df)*100.0, \"%\")\nprint(len(ccnotdefault_df))\nprint( len(ccnotdefault_df)\/len(creditcard_df)*100.0, \"%\")\n ","1f7617e2":"correlation=creditcard_df.corr()\nf,ax=plt.subplots(figsize=(20,20))\nsns.heatmap(correlation,annot=True)","02929272":"plt.figure(figsize=(20,20))\nsns.countplot(x='AGE',hue='default.payment.next.month',data=creditcard_df)","df63eaf5":"plt.figure(figsize=(20,20))\nplt.subplot(311)\nsns.countplot(x='EDUCATION',hue='default.payment.next.month',data=creditcard_df)\n","b4176b42":"plt.figure(figsize=(20,20))\nplt.subplot(312)\nsns.countplot(x='SEX',hue='default.payment.next.month',data=creditcard_df)","a9f1207a":"plt.figure(figsize=(20,20))\nplt.subplot(313)\nsns.countplot(x='MARRIAGE',hue='default.payment.next.month',data=creditcard_df)","dc07e29e":"plt.figure(figsize=(20,20))\nsns.distplot(ccnotdefault_df['LIMIT_BAL'],bins=200,color='r')\nsns.distplot(ccdefault_df['LIMIT_BAL'],bins=200,color='b')\nplt.xlabel('Amount of Bill Statement')","8ae45ef6":"plt.figure(figsize=(20,10))\nsns.kdeplot(ccnotdefault_df['BILL_AMT1'],label='Customers who paid',shade=True,color='r')\nsns.kdeplot(ccdefault_df['BILL_AMT1'],label='Customers who did not pay',shade=True,color='b')\nplt.xlabel('Amount of Bill statement')","806cc1e7":"plt.figure(figsize=(10,20))\nplt.subplot(211)\nsns.boxplot(x='MARRIAGE',y='LIMIT_BAL',data=creditcard_df,showfliers=False)","debf68e0":"plt.figure(figsize=(10,20))\nplt.subplot(212)\nsns.boxplot(x='MARRIAGE',y='LIMIT_BAL',data=creditcard_df)","131f1d17":"plt.figure(figsize=(10,20))\nplt.subplot(211)\nsns.boxplot(x='SEX',y='LIMIT_BAL',data=creditcard_df,showfliers=False)","6cdb91ad":"plt.figure(figsize=(10,20))\nplt.subplot(212)\nsns.boxplot(x='SEX',y='LIMIT_BAL',data=creditcard_df)","09d5f7b4":"X_cat=creditcard_df[['SEX','EDUCATION','MARRIAGE']]","640b09e2":"X_cat","8afc8c5a":"from sklearn.preprocessing import OneHotEncoder\nonehotencoder=OneHotEncoder()\nX_cat=onehotencoder.fit_transform(X_cat).toarray()\n","8cb39593":"X_cat.shape","62fd0866":"X_cat=pd.DataFrame(X_cat)","05db0832":"X_cat","71d30fbe":"X_numerical = creditcard_df[['LIMIT_BAL', 'AGE', 'PAY_0', 'PAY_2', 'PAY_3', 'PAY_4', 'PAY_5', 'PAY_6', \n                'BILL_AMT1','BILL_AMT2', 'BILL_AMT3', 'BILL_AMT4', 'BILL_AMT5', 'BILL_AMT6',\n                'PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6']]","64a4a9f4":"X_numerical","f16a4bda":"X_all=pd.concat([X_cat,X_numerical],axis=1)","9afbe1f0":"X_all","1b204c67":"from sklearn.preprocessing import MinMaxScaler\nscaler=MinMaxScaler()\nX=scaler.fit_transform(X_all)","635ec8b0":"X","285eb3b5":"Y=creditcard_df['default.payment.next.month']","59b5cde7":"Y","618e865b":"from sklearn.model_selection import train_test_split\nX_train,X_test,Y_train,Y_test=(train_test_split(X,Y,test_size=0.30))","e41fd069":"X_train.shape","f0918243":"X_test.shape","4108bf55":"param_grid = {\n    'gamma': [0.5, 1, 5],   # regularization parameter \n        'subsample': [0.6, 0.8, 1.0], # % of rows taken to build each tree\n        'colsample_bytree': [0.6, 0.8, 1.0], # number of columns used by each tree\n        'max_depth': [3, 4, 5]}","6b18cb65":"from xgboost import XGBClassifier\nmodel=XGBClassifier(learning_rate=0.01,n_estimator=200,objective='binary:logistic')","22580841":"from sklearn.model_selection import GridSearchCV\ngrid=GridSearchCV(model,param_grid,refit=True,verbose=5)\ngrid.fit(X_train,Y_train)","0a7aa1d0":"from sklearn.metrics import accuracy_score\ny_pred=grid.predict(X_test)\n","1a1bc359":"y_pred","a83f3da6":"from sklearn.metrics import confusion_matrix,classification_report\nprint(\"ACCURACY {}%\".format(100*accuracy_score(y_pred,Y_test)))","65783113":"print(classification_report(Y_test,y_pred))","993f6fd0":"DATA VISUALISATION","3d27e903":"**DATA CLEANING**"}}