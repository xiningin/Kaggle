{"cell_type":{"5c554260":"code","33d2a397":"code","67367ee5":"code","9f1fb53c":"code","183babbd":"code","36c9730f":"code","69232758":"code","2e60d43c":"code","bb1478fc":"code","e1994104":"code","63b72961":"code","f0f1a7d8":"code","15c04a0a":"code","2b5f60c4":"code","37bb72de":"code","2fce90b5":"code","bf9360b9":"code","2b8c0208":"code","e22d3926":"code","17855109":"code","a152a983":"code","1bd29824":"code","7cb5e659":"code","70a0c8cb":"code","b7c367e3":"code","5dbacc9b":"code","dd341841":"code","75c78899":"code","89802a16":"code","421a46be":"code","389ebad7":"code","c77e7fa2":"code","b70d6881":"code","d11109be":"code","a3fc1bd2":"code","c66ad2fd":"code","dc1b4b2b":"code","8f77fabb":"code","9319597f":"code","441ecc28":"code","8f0474a4":"code","27b62a87":"code","f081c79d":"code","d1fab268":"code","bdc64d38":"code","3fbccb76":"code","526c38f8":"code","d1521a72":"code","2b6a511a":"code","b1778bbf":"code","b730c653":"code","eb5cd04f":"code","7fd451fa":"code","23c9cafe":"code","f8e345ed":"code","ec4da014":"code","5f8c7358":"code","da675d3a":"code","9dba4125":"code","86449ae4":"code","9fd2d5e0":"code","ea1a0118":"code","c02e8bed":"code","3530df24":"code","c134cdab":"code","4ae8abb8":"code","2a6ccf58":"code","a058f1a5":"code","9bdf5124":"code","e86cb338":"code","d27f3807":"code","7e39e83c":"code","1f393dd7":"code","7a2a3382":"code","51b26fc9":"code","2a267935":"code","f2222b38":"code","f175c954":"code","068cf5c4":"code","47c5b397":"code","488f2750":"code","61236c33":"code","3b88a741":"code","46c7f3cb":"code","ae89765d":"code","8c2fef0b":"code","07171da9":"code","aa4c1969":"code","6dd12b64":"code","02af49d2":"code","8f357f09":"code","9f8d598a":"code","841b5d20":"code","f359d597":"code","42d018ef":"code","b5f56399":"code","0912c635":"code","2266aef8":"code","4287b0de":"code","3b076942":"code","62bdca0f":"code","a99df191":"code","7c5a37e9":"code","fd3fa263":"code","35ca059c":"code","5dd5c37e":"code","ce144dc7":"code","8acb786d":"code","a0c7802c":"code","f4763ecc":"code","525e8cd5":"code","ce330e08":"code","31c05fe8":"code","99323d8b":"code","285b3831":"code","897036f1":"code","c8eb6a39":"code","002e2d46":"code","de563f8e":"code","9c2cbf12":"code","87f6ea94":"code","c5801607":"code","9247a1ec":"code","81fbaff0":"code","1636e3ed":"code","e3743697":"code","9075ac18":"code","284a339c":"code","2f38afcd":"code","c65f51fd":"code","c5b55e75":"markdown","e16092cb":"markdown","d466318c":"markdown","84ad363b":"markdown","9355de0b":"markdown","7250e657":"markdown","86c7dcd3":"markdown","2c28babc":"markdown","2c054be9":"markdown","cd71909b":"markdown","3ba50e9f":"markdown","1fb6ae6c":"markdown","c610236f":"markdown","ff9a722f":"markdown","c0bdc847":"markdown","1e4ba09f":"markdown","3f827ab6":"markdown","a588fc78":"markdown","99695aeb":"markdown","86feb08e":"markdown","50e3042d":"markdown","09e71122":"markdown","0210bf82":"markdown","e9dbb5b4":"markdown","97da9f28":"markdown","c8f7f7a2":"markdown","45b7bf3d":"markdown","f54019ba":"markdown","21b5e609":"markdown","ffb6982d":"markdown","f0c80e0c":"markdown","3a4b4f96":"markdown","0222ae20":"markdown","6e4202d2":"markdown","5e9c7289":"markdown","247ea7ac":"markdown","588c7873":"markdown","8c698a0f":"markdown","b50686a2":"markdown","ee14cc10":"markdown","c96365ce":"markdown","12c24ed6":"markdown","90ac8b9e":"markdown","37ad12ef":"markdown","012f42fd":"markdown","9670282f":"markdown","2d1f1c42":"markdown","e763b120":"markdown","559e63bb":"markdown","da03804d":"markdown","a91e2ac5":"markdown","0f63186d":"markdown","eade4cdd":"markdown","66b68118":"markdown","0dbe678c":"markdown","574c46b9":"markdown"},"source":{"5c554260":"import numpy as np\nnp.seterr(divide='ignore', invalid='ignore')\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.express as px","33d2a397":"df = pd.read_csv('..\/input\/crop-production-in-india\/crop_production.csv')","67367ee5":"df.info()","9f1fb53c":"df.head()","183babbd":"df.isnull().sum()","36c9730f":"df.dropna(inplace=True)","69232758":"df.isnull().sum()","2e60d43c":"df = df[df['Production'] !=0]","bb1478fc":"df.info()","e1994104":"df['Crop_Year'].unique() # Lets see since what year the data has been collected","63b72961":"len(df['State_Name'].unique()) #Lets see how many states and UT are there","f0f1a7d8":"df['State_Name'].unique()  #lets see the different states and UTs from where the data is collected","15c04a0a":"df['District_Name'].nunique()","2b5f60c4":"pd.set_option('display.float_format', lambda x: '%.2f' % x)\ndf['Production'].sort_values(ascending = False)  #Let's see the state with highest production","37bb72de":"df.loc[178273]","2fce90b5":"df[df['Area'] == 82704.00]","bf9360b9":"no_of_diff_crops = df['Crop'].nunique()\ntypes_of_crops = df['Crop'].unique()\n\nprint('There are {} different types of crops'.format(no_of_diff_crops))\nprint('------------------------------------')\nprint('They different types of crops are :-',types_of_crops)","2b8c0208":"df['Season'].value_counts() #Lets see the diff seasons ","e22d3926":"plt.figure(figsize=(7,5),dpi=100)\nsns.countplot(data=df,x='Season');","17855109":"plt.figure(figsize=(7,5),dpi=100)\nsns.barplot(data=df,x='Season',y='Production');","a152a983":"df['District_Name'].nunique() #No of districts ","1bd29824":"df.info()","7cb5e659":"state_prod = df.groupby('State_Name')['Production'].sum().reset_index().sort_values(by='Production',ascending=False)\npx.bar(state_prod , 'State_Name', 'Production')","70a0c8cb":"state_prod ","b7c367e3":"df.groupby('State_Name').sum()['Production'].nlargest()#Let's see the top 5 states with most production over the years","5dbacc9b":"df.groupby(\"State_Name\").sum()['Production'].nsmallest() # Let's see the top 5 states with least production over the years","dd341841":"df['Area'].shape","75c78899":"df.groupby(['State_Name','Crop_Year']).sum()['Production']","89802a16":"dist_prod = df.groupby('District_Name')['Production'].sum().reset_index().sort_values(by='Production')\ndist = dist_prod[0:5]\npx.bar(dist , 'District_Name', 'Production')","421a46be":"plt.figure(figsize=(9,7),dpi=100)\nsns.countplot(data=df,y='Crop_Year');   #Let's see which year was when most crops were cultivated","389ebad7":"plt.figure(figsize=(9,7),dpi=100)\nsns.lineplot(data=df,x='Crop_Year',y='Production');","c77e7fa2":"df.head()","b70d6881":"plt.figure(figsize=(10,9),dpi=100)\nsns.barplot(data=df,x='Crop_Year',y='Production',palette='viridis');","d11109be":"df.groupby('Season').sum()['Production']","a3fc1bd2":"kerala_data = df[df['State_Name'] == 'Kerala']\nkerala_data.head()","c66ad2fd":"top_prod_kerala = kerala_data.groupby('Crop').sum()[\"Production\"].reset_index().sort_values(by='Production',ascending=False).nlargest(n=10,columns='Production')\ntop_prod_kerala","dc1b4b2b":"sns.barplot(data=top_prod_kerala,y='Crop',x='Production')","8f77fabb":"kerala_district = kerala_data.groupby('District_Name').sum()['Production'].reset_index().sort_values(by='Production',ascending=False)\nkerala_district","9319597f":"sns.barplot(data=kerala_district,y='District_Name',x='Production')","441ecc28":"df.groupby('Season').sum()['Production'].nlargest()","8f0474a4":"df['Crop'].value_counts().reset_index()","27b62a87":"india_top_prod = df.groupby('Crop').sum()['Production'].nlargest(20).reset_index() #Top 20 best performing crops\nindia_top_prod","f081c79d":"plt.figure(figsize=(9,7),dpi=100)\nsns.barplot(data=india_top_prod,x='Production',y='Crop')","d1fab268":"df.groupby('Crop').sum()['Production'].nsmallest(20).reset_index() # top 20 worst performing crops","bdc64d38":"coconut_crop = df[df['Crop'] == 'Coconut ']","3fbccb76":"coconut_crop","526c38f8":"plt.figure(figsize=(8,6),dpi=100)\nsns.barplot(data=coconut_crop,x='Production',y='State_Name');","d1521a72":"coconut_districts = coconut_crop.groupby('District_Name').sum()['Production'].nlargest().reset_index()\npx.bar(data_frame=coconut_districts,x='District_Name',y='Production')","2b6a511a":"plt.figure(figsize=(8,6),dpi=100)\nsns.lineplot(data=coconut_crop,x='Crop_Year',y='Production');","b1778bbf":"plt.figure(figsize=(13,12),dpi=100)\nsns.barplot(data=coconut_crop,x='Crop_Year',y='Production');","b730c653":"coconut_crop.groupby('Season').sum()['Production'].nlargest()","eb5cd04f":"coconut_season = coconut_crop.groupby('Season').sum()['Production'].reset_index()\npx.bar(data_frame=coconut_season,x='Season',y='Production')","7fd451fa":"sns.scatterplot(data=coconut_crop,x='Area',y='Production');","23c9cafe":"sugarcane_crop = df[df['Crop'] == 'Sugarcane']","f8e345ed":"sugarcane_crop.shape","ec4da014":"sugarcane_crop.head()","5f8c7358":"plt.figure(figsize=(13,8),dpi=100)\nsns.barplot(data=sugarcane_crop,x='Production',y='State_Name');","da675d3a":"sugarcane_crop.groupby('State_Name').sum()['Production'].nlargest().reset_index()","9dba4125":"sugarcane_districts = sugarcane_crop.groupby('District_Name').sum()['Production'].nlargest().reset_index()\npx.bar(data_frame=sugarcane_districts,x='District_Name',y='Production')","86449ae4":"plt.figure(figsize=(8,6),dpi=100)\nsns.lineplot(data=sugarcane_crop,x='Crop_Year',y='Production');","9fd2d5e0":"plt.figure(figsize=(13,12),dpi=100)\nsns.barplot(data=sugarcane_crop,x='Crop_Year',y='Production',palette='viridis');\n\nprint('We can also see that result in the following graph')","ea1a0118":"sugarcane_crop.groupby('Season').sum()['Production'].nlargest()","c02e8bed":"sns.barplot(data=sugarcane_crop,x='Season',y='Production');","3530df24":"sns.scatterplot(data=sugarcane_crop,x='Area',y='Production');","c134cdab":"rice_crop = df[df['Crop'] == 'Rice']","4ae8abb8":"rice_crop","2a6ccf58":"plt.figure(figsize=(7,5),dpi=90)\nsns.lineplot(data=rice_crop,x='Crop_Year',y='Production')","a058f1a5":"plt.figure(figsize=(10,8),dpi=90)\nsns.barplot(data=rice_crop,x='Crop_Year',y='Production');","9bdf5124":"#plt.figure(figsize=(10,8),dpi=90)\n#sns.barplot(data=rice_crop,x='Production',y='State_Name');\n\nrice_states = rice_crop.groupby('State_Name').sum()['Production'].reset_index()\npx.bar(data_frame=rice_states,x='State_Name',y='Production')","e86cb338":"rice_crop.groupby('State_Name').sum()['Production'].nlargest().reset_index()","d27f3807":"rice_districts = rice_crop.groupby('District_Name').sum()['Production'].nlargest(10).reset_index()\npx.bar(data_frame=rice_districts,x='District_Name',y='Production')","7e39e83c":"sns.scatterplot(data=rice_crop,x='Area',y='Production');","1f393dd7":"rice_season = rice_crop.groupby('Season').sum()['Production'].reset_index()\npx.bar(data_frame=rice_season,x='Season',y='Production')","7a2a3382":"crop_data = pd.get_dummies(data=df)","51b26fc9":"crop_data.head()","2a267935":"from sklearn.model_selection import train_test_split","f2222b38":"X = crop_data.drop('Production',axis=1)\nX.head()","f175c954":"y = crop_data['Production']\ny.head()","068cf5c4":"X_train, X_test, y_train, y_test = train_test_split( X, y, test_size=0.33, random_state=42)","47c5b397":"X_test.shape","488f2750":"y_test.shape","61236c33":"from sklearn.linear_model import LinearRegression","3b88a741":"crop_model = LinearRegression()","46c7f3cb":"crop_model.fit(X_train,y_train)","ae89765d":"crop_predictions = crop_model.predict(X_test)\ncrop_predictions","8c2fef0b":"crop_model.coef_","07171da9":"crop_model.intercept_","aa4c1969":"predicted_crop_val = pd.DataFrame({'Actual':y_test,'Predicted':crop_predictions})\npredicted_crop_val","6dd12b64":"from sklearn.metrics import mean_absolute_error,mean_squared_error,r2_score","02af49d2":"df['Production'].mean()","8f357f09":"crop_predictions.mean()","9f8d598a":"mean_absolute_error(y_test,crop_predictions)","841b5d20":"mean_squared_error(y_test,crop_predictions)","f359d597":"np.sqrt(mean_squared_error(y_test,crop_predictions))","42d018ef":"def mape(actual, pred): \n    actual, pred = np.array(actual), np.array(pred)\n    return np.mean(np.abs((actual - pred) \/ actual)) * 100\n\nmape(y_test,crop_predictions)","b5f56399":"test_residuals = y_test - crop_predictions","0912c635":"test_residuals","2266aef8":"sns.scatterplot(x=y_test,y=test_residuals)\nplt.axhline(y=0,color='red')\nplt.title('Residual plot of Testing data');","4287b0de":"#sns.displot(test_residuals,kde=True,bins=100);","3b076942":"r = r2_score(y_test,crop_predictions)\nprint(\"R2score when we predict using Linear Regression is \",r)","62bdca0f":"train_set_predictions = crop_model.predict(X_train)\ntrain_set_predictions","a99df191":"train_set_predictions.mean()","7c5a37e9":"sns.scatterplot(x=y_train,y=y_train-train_set_predictions)\nplt.axhline(y=0,color='red')\nplt.title('Residual plot of Training data');","fd3fa263":"def mape(actual, pred): \n    actual, pred = np.array(actual), np.array(pred)\n    return np.mean(np.abs((actual - pred) \/ actual)) * 100\n\nmape(y_train,train_set_predictions)\n","35ca059c":"Crop_data2 = df.drop(['District_Name'],axis=1)","5dd5c37e":"Crop_data2.head()","ce144dc7":"crop_data2_ac = pd.get_dummies(data=Crop_data2)\ncrop_data2_ac.head()","8acb786d":"X2 = crop_data2_ac.drop('Production',axis=1)\nX2.head()","a0c7802c":"y2 = crop_data2_ac['Production']\ny2.head()","f4763ecc":"from sklearn.model_selection import train_test_split","525e8cd5":"X2_train, X2_test, y2_train, y2_test = train_test_split( X2, y2, test_size=0.33, random_state=42)","ce330e08":"from sklearn.linear_model import LinearRegression","31c05fe8":"crop_model2 = LinearRegression()","99323d8b":"### Training Model","285b3831":"crop_model2.fit(X2_train,y2_train)","897036f1":"crop2_predictions = crop_model2.predict(X2_test)\ncrop2_predictions","c8eb6a39":"crop_model2.coef_","002e2d46":"crop_model.intercept_","de563f8e":"predicted_crop_val2 = pd.DataFrame({'Actual':y2_test,'Predicted':crop2_predictions})\npredicted_crop_val2","9c2cbf12":"from sklearn.metrics import mean_absolute_error, mean_squared_error, r2_score","87f6ea94":"df['Production'].mean()","c5801607":"crop2_predictions.mean()","9247a1ec":"mean_absolute_error(y_test,crop2_predictions)","81fbaff0":"mean_squared_error(y_test,crop2_predictions)","1636e3ed":"np.sqrt(mean_squared_error(y_test,crop2_predictions))","e3743697":"r2_score(y_test,crop2_predictions)","9075ac18":"test2_residuals = y2_test - crop2_predictions","284a339c":"test2_residuals","2f38afcd":"sns.scatterplot(x=y2_test,y=test2_residuals)\nplt.axhline(y=0,color='red')","c65f51fd":"#sns.displot(data=test2_residuals,kde=True,bins=50);","c5b55e75":"### Whole Year season seems to have yeilded more crops compared to other seasons in  a year","e16092cb":"#### MAE","d466318c":"## We can see that Kerela has the highest production, Also we can see that the top 3 states with highest production over the years are from South India\n\n## So we can say that South India can be considered as the agricultural valley of India producing highest yiels","84ad363b":"### Residual plots","9355de0b":"### Prediction","7250e657":"#### RMSE","86c7dcd3":"### Dividing data into Training and testing data","2c28babc":"# 3.Rice","2c054be9":"# Though 2002-2003 was the year most crops were cultivated, the period between 2010-2012 and then 2012-2013 happens to be the year which saw highest yield for the crops.","cd71909b":"#### Coconut production has increased over the year which suggests that the favourable conditions for its growth has been increasing in India every year in different places.\n\n#### Coconut seems have Kerala as its mainland for growth as most of its districts have the highest productions of Coconut.\n\n#### Its only obvious that with every year seeing more production of Coconut and suitable conditions for it's growth increase in land for it's cultivation has yielded more productions.","3ba50e9f":"### Creating model","1fb6ae6c":"### We can see that from above table the predicted and actual values don't match ","c610236f":"### From the metrics that we have used to test our second model we can agian straight away say that Linear Regression was not a good choice of algo for this data set.\n\n### The residual plot is a clear explaination of this, we can see the that the residual points are not randomly distributed around the actual points themself.\n\n### Its seems that again we have a situation of undershooting here.","ff9a722f":"### Checking the residual plots","c0bdc847":"### Now eventhough we have a set of predictions with us we need a way to actually tell if the model is accuarte enough, let's test that using metrics","1e4ba09f":"### Dividing data into Training and Tesing Data ","3f827ab6":"### Creating Model","a588fc78":"# Creating Linear regression model","99695aeb":" ## Let's analyze the top crops by highest production in the country","86feb08e":"# 2. Sugarcane","50e3042d":"### Whole Year season has the highest yield of Cococnut crops","09e71122":"### All top 5 districts having highest Coconut production belong to Kerala.","0210bf82":"### Feature selection & Creating dummy variables for object datatype within the dataset","e9dbb5b4":"### We can see that in the coefficients there are a lot of negative values, telling us some features are not really of any use instead using them to predict the production gives us less results, So we can try and drop some of the columns and again train the model using Linear regression.","97da9f28":"# Most of the crop production came from Kerala let's analyze Kerala's data","c8f7f7a2":"### Feature Selection & Creating dummy variables for object datatype within the dataset","45b7bf3d":"### Prediction","f54019ba":"### We can see that over the years coconut production has kept on increasing","21b5e609":"### Rice has overall good production throughout the Country.\n\n### Most of the Northern and North Eastern part of India has seen more Rice production between the year 1997 to 2015.\n\n### It is clear from the data that Rice is a Kharif crop as we know Rice needs a lot of rain to grow as well temp ranging between 21 to 37\u00ba C and Kharif season starting from late June or early July to October has all these favourable conditons from growth of Rice.","ffb6982d":"### After seeing an uneven growth till early 2000's Rice production has been on the race soaring high in production ever after.","f0c80e0c":"#### The reason here I dropped districts is that we have the info on states and districts is a subset of states and also there 646 districts name in this dataset and maybe using them has negative results- this is my assumption.","3a4b4f96":"### Sugarcane production has been stable over the years after falling drastically in 90's and this stability was again broken in the period after 2014","0222ae20":"### Kozhikode and Malappuram Districts in Kerala seem to have most favourable conditions for any crop production since they have more production compared to any other districs in kerala","6e4202d2":"### Coconut, Sugarcane, Rice, Wheat and Potato happen to be the top 5 crops yeilding more productions in India over the years","5e9c7289":"# Now let's analyze the data across all the states in India","247ea7ac":"### From the metrics that we have used to test our model we can straight away say that Linear Regression was not a good choice of algo for this data set\n\n### The residual plot is a clear explaination of this, we can see the that the residual points are not randomly distributed around the actual points themself.\n\n### Its seems that we have a situation of undershooting here.","588c7873":"####  Results of training data ","8c698a0f":"### Let's see which state produces more Sugarcane","b50686a2":"### Tamilnadu is the state is with highest production of any crop with 1250 million tonnes or 1.25 billion tonnes of Coconut in the year 2011","ee14cc10":"### We can see that from above table the predicted and actual values don't match \n","c96365ce":" ### 2002-2003 was the year when most of the crops were cultivated in India","12c24ed6":"### Kharif season has the highest Sugarcane production","90ac8b9e":"### Over the years Rice, Maize and Moong have been cultivated more across all the states in India","37ad12ef":"### Null values removed","012f42fd":"## All the states are included and 2 out of 7 UTs are not there - Delhi and Lakhswadeep","9670282f":"### 1. Coconut","2d1f1c42":"### Training the model","e763b120":"# Coconut is most produced crop in Kerala","559e63bb":"### UP, Maharashtra, Tamil Nadu, Karnataka and Andra Pradesh have the highest production of Sugarcane","da03804d":"## The Data has been collected from the year 1997 to 2015","a91e2ac5":"### Kerala followed by Andra Pradesh and Andaman & Nicobar islands has highest production of coconut m","0f63186d":"### Sugarcane seems to grow more in the North and South western part of India, which is reasonable because this part of India is also considered as the tropical as well as sub tropical. Temp of this part of the country being hot and humid supports Sugarcane growth.\n\n","eade4cdd":"## Sugarcane seems to be a South-western crop","66b68118":"## Let's again test our model using some metrics","0dbe678c":"# Creating Linear regression Model no.2","574c46b9":"### Let's see which state produces more cocnut "}}