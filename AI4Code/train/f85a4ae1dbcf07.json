{"cell_type":{"e41b42bb":"code","8c57906b":"code","ba08e0e6":"code","0840eb90":"code","3b910ab2":"code","2fcc76e1":"code","37605c85":"code","523f41a5":"code","040b16f9":"code","9a986413":"code","5e7309ad":"code","bf09a174":"code","b43d02ba":"code","1a17cb6e":"code","dbf6d1ec":"code","2e4903ef":"code","33a227a9":"markdown","d5abae70":"markdown","664a664b":"markdown","1db5cf9d":"markdown"},"source":{"e41b42bb":"import pandas as pd\nimport numpy as np\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import accuracy_score","8c57906b":"train_df = pd.read_csv('..\/input\/titanic\/train.csv')\ntest_df = pd.read_csv('..\/input\/titanic\/test.csv')\ntrain_df.head()","ba08e0e6":"data_train = train_df.drop(['Name', 'Ticket', 'Cabin'], axis=1)\ndata_test = test_df.drop(['Name', 'Ticket', 'Cabin'], axis=1)\ndata_train.head()","0840eb90":"print(data_train.info(), data_test.info())","3b910ab2":"data_train.Age = data_train['Age'].fillna(data_train['Age'].median())\ndata_test.Age = data_test['Age'].fillna(data_test['Age'].median())\ndata_train.Embarked = data_train['Embarked'].fillna('S')\ndata_test.Fare = data_test['Fare'].fillna(data_test['Fare'].median())","2fcc76e1":"data_train.info(), data_test.info()","37605c85":"categorical_cols = [cname for cname in data_train.columns if\n                    len(data_train[cname].unique()) <= 10 and\n                    data_train[cname].dtype == 'object'\n                   ]\nnumerical_cols = [cname for cname in data_train.columns if\n                    data_train[cname].dtype in ['int64', 'float64']\n                 ]","523f41a5":"embarked_categorical = {category: index for index, category in enumerate(data_train.Embarked.astype('category').cat.categories)}\nsex_categorical = {category: index for index, category in enumerate(data_train.Sex.astype('category').cat.categories)}\n\ndata_train.Embarked = data_train['Embarked'].map(embarked_categorical)\ndata_test.Embarked = data_test['Embarked'].map(embarked_categorical)\n\ndata_train.Sex = data_train['Sex'].map(sex_categorical)\ndata_test.Sex = data_test['Sex'].map(sex_categorical)","040b16f9":"data_train.columns","9a986413":"X_train, X_test, Y_train, Y_test = train_test_split(data_train.drop(['PassengerId', 'Survived'], axis=1), data_train['Survived'], test_size=0.2)","5e7309ad":"model = LogisticRegression()\nmodel.fit(X_train, Y_train)","bf09a174":"# Good accuracy!!!\ny_pred = model.predict(X_test)\nprint('Accuracy Score:', str(accuracy_score(Y_test, y_pred)*100) + '%')","b43d02ba":"X_for_real_prediction = data_test.drop('PassengerId', axis=1)\nX_for_real_prediction","1a17cb6e":"real_predictions = model.predict(X_for_real_prediction)\nreal_predictions","dbf6d1ec":"output = pd.DataFrame({'PassengerId':data_test.PassengerId,'Survived':real_predictions})\noutput","2e4903ef":"output.to_csv('my_titanic_submission.csv', index=False)\nprint('All ready')","33a227a9":"**Data cleaning**","d5abae70":"**Training**","664a664b":"**Prediction**","1db5cf9d":"**Dataset exploration**"}}