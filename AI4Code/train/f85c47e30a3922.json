{"cell_type":{"968f3878":"code","5f370585":"code","07a1cae5":"code","2fe2921e":"code","04ac2aba":"code","ffce161e":"code","52b700e7":"code","1d3277bd":"markdown","a8b63d19":"markdown","1d7ba08e":"markdown","3998a9bb":"markdown","1f4af897":"markdown"},"source":{"968f3878":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport cv2\nfrom convolutionalautoencoder import CNAutoEnc #import AutoEncoder utility script\n\n%matplotlib inline","5f370585":"mtrain = pd.read_csv(\"..\/input\/mnist-in-csv\/mnist_train.csv\")\nmtest = pd.read_csv(\"..\/input\/mnist-in-csv\/mnist_test.csv\")\nmnist_train = np.array(mtrain)\nmnist_test = np.array(mtest)\nmnist_train = mnist_train[:,1:]\nmnist_test = mnist_test[:,1:]\nmnist_train=mnist_train.reshape(60000,28,28,1)\nmnist_train = mnist_train.astype(\"float32\")\/255.0\nmnist_test=mnist_test.reshape(10000,28,28,1)\nmnist_test = mnist_test.astype(\"float32\")\/255.0\nplt.imshow(mnist_train[0].reshape(28,28), cmap='gray')","07a1cae5":"epoch = 20\nbatch_size = 32\n(encoder, decoder, autoencoder) = CNAutoEnc.create((28, 28, 1))\nautoencoder.compile(loss=\"mse\", optimizer=\"Adam\")","2fe2921e":"history = autoencoder.fit(mnist_train, mnist_train,validation_data=(mnist_test,mnist_test),epochs=epoch,batch_size=batch_size)","04ac2aba":"recon = autoencoder.predict(mnist_test)\n# Sample1\nreconstructed = (recon[0]*255.0).astype(\"uint8\")\ntest_sample = (mnist_test[0]*255.0).astype(\"uint8\")\n","ffce161e":"print(\"Reconstructed Image\")\nplt.imshow(reconstructed.reshape(28,28), cmap=\"gray\")\n","52b700e7":"print(\"Original Image\")\nplt.imshow(test_sample.reshape(28,28), cmap=\"gray\")","1d3277bd":"# Convolutional Autoencoder example\n### Using the Convolutional AutoEncoder Utility class:\n> available at this URL: [Convolutional Autoencoder](https:\/\/www.kaggle.com\/pankaj1234\/convolutionalautoencoder)\n","a8b63d19":"### Import libraries and packages","1d7ba08e":"### Call _CNAutoEnc_ function from the utility.\nCreating am instance of the Convolutional Autoncoder and complie it. Note that the image size passed is (28,28,1) - channel last.\n","3998a9bb":"### MNIST Data load and regular pre-processing","1f4af897":"### Predict and reconstruct the Images (sample)"}}