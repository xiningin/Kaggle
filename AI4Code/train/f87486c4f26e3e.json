{"cell_type":{"5a636764":"code","39ecb57f":"code","fb64f1ec":"code","e7b3e7d3":"code","9c9db7b5":"code","c67e008f":"code","3ccd0f8b":"code","61606a3c":"code","1b61b1df":"code","c5cfe5dd":"code","d5a5560a":"code","395784ae":"code","5ca0ba76":"code","ff365d4f":"code","7b53cf5f":"code","5559ecd0":"code","a686f872":"code","303b457b":"code","f1e71655":"code","41d2c90e":"code","b4a8c2ad":"code","d52f7ae0":"code","88250456":"code","ea9897fb":"code","5108ec38":"code","e737c639":"code","3514ef27":"code","346e09bd":"code","95d9a4e1":"code","05e4836e":"code","2098d14a":"code","8321ae06":"code","80a91808":"code","b61215b2":"code","8a68a7f7":"code","02a75aa4":"code","1122c160":"code","62eeb485":"code","05dcbffb":"markdown","23de265c":"markdown","0723fe80":"markdown","8d3867ed":"markdown","ebcdac02":"markdown","43826241":"markdown","dfc1373a":"markdown","a98db7c2":"markdown","b76efd14":"markdown","a62a6373":"markdown","9e0e6a67":"markdown","8b525b43":"markdown","cf38f6ba":"markdown","02910423":"markdown","8bf8bfa0":"markdown","543b0f17":"markdown","07b1aaa6":"markdown","50841bba":"markdown","78a20a70":"markdown","8d4c32d7":"markdown","852970da":"markdown","42e88935":"markdown","5089d24b":"markdown","b1155fd4":"markdown","56c182ff":"markdown","59920ca0":"markdown","719ecd2d":"markdown","58512ac6":"markdown","5d30c86a":"markdown","c712d026":"markdown","d5cc8086":"markdown","0178b5de":"markdown","c91ba47a":"markdown","f61c1afc":"markdown","936a800b":"markdown","2053dd82":"markdown","03d5a79f":"markdown","38cd4154":"markdown","ac41518b":"markdown","1cbb94d9":"markdown","f375865d":"markdown","e5281fe0":"markdown","abe58914":"markdown","7544f51c":"markdown","5ef0bcaa":"markdown","f374e2e8":"markdown","b05f4a95":"markdown","da0fdb6f":"markdown","27fa6067":"markdown","52fdf30e":"markdown","77e4d052":"markdown","922dbfcb":"markdown","a891a559":"markdown"},"source":{"5a636764":"!pip install prince","39ecb57f":"import numpy as np  \nimport pandas as pd \nimport matplotlib.pyplot as plt \nimport seaborn as sns \nimport prince\nfrom wordcloud import WordCloud, STOPWORDS\nfrom PIL import Image\n\nsns.set_style('darkgrid')","fb64f1ec":"data = pd.read_csv('..\/input\/starbucks-customer-retention-malaysia-survey\/Starbucks satisfactory survey.csv')","e7b3e7d3":"data.head()","9c9db7b5":"data.info()","c67e008f":"rename_dict = {\n    '1. Your Gender' : 'Gender',\n    '2. Your Age' : 'Age',     \n    '3. Are you currently....?' : 'Profession',\n    '4. What is your annual income?' : 'Income',\n    '5. How often do you visit Starbucks?' : 'Visit Frequency',\n    '6. How do you usually enjoy Starbucks?' : 'Prefered Form of Consumption',\n    '7. How much time do you normally  spend during your visit?' : 'Time Spent on Visit',\n    \"8. The nearest Starbucks's outlet to you is...?\" : 'Distance to Store',\n    '9. Do you have Starbucks membership card?' : 'Membership',\n    '10. What do you most frequently purchase at Starbucks?' : 'Most consumed Product',\n    '11. On average, how much would you spend at Starbucks per visit?' : 'Spend per Visit',\n    '12. How would you rate the quality of Starbucks compared to other brands (Coffee Bean, Old Town White Coffee..) to be:' : 'Quality Rate',\n    '13. How would you rate the price range at Starbucks?' : 'Price Range Rate',\n    '14. How important are sales and promotions in your purchase decision?' : 'Sales and Promotion Importance',\n    '15. How would you rate the ambiance at Starbucks? (lighting, music, etc...)' : 'Ambiance Rate',\n    '16. You rate the WiFi quality at Starbucks as..' : 'WiFi Quality Rate',\n    '17. How would you rate the service at Starbucks? (Promptness, friendliness, etc..)' : 'Service Rate',\n    '18. How likely you will choose Starbucks for doing business meetings or hangout with friends?' : 'Likely for Meetings or Hangouts',\n    '19. How do you come to hear of promotions at Starbucks? Check all that apply.' : 'Form of communication to Promotions',\n    '20. Will you continue buying at Starbucks?' : 'Recurrent Costumer'\n}","3ccd0f8b":"data = data.rename(rename_dict,axis=1)\ndata.head()","61606a3c":"for column in data.columns:\n    print('{} column: {} unique values'.format(column,data[column].nunique()))","1b61b1df":"data['Prefered Form of Consumption'] = data['Prefered Form of Consumption'].replace({'Never':'None','never':'None','Never buy':'None','Never ':'None','I dont like coffee':'None',np.nan:'None'})\ndata['Most consumed Product'] = data['Most consumed Product'].replace({'Never buy any':'Nothing','never':'Nothing','Never':'Nothing','Jaws chip ':'Jaws Chip','cake ':'Cake'})\ndata['Form of communication to Promotions'] = data['Form of communication to Promotions'].replace({np.nan:'Never hear'})","c5cfe5dd":"int_columns = ['Quality Rate','Price Range Rate','Ambiance Rate','WiFi Quality Rate','Service Rate','Likely for Meetings or Hangouts','Sales and Promotion Importance']","d5a5560a":"for column in int_columns:\n    data[column] = data[column].astype(object)","395784ae":"def plot_bar(feature,figsize):\n    plot_data = organize_plot_data(feature)\n    generate_plot(plot_data,feature,figsize)\n\ndef organize_plot_data(feature):\n    plot_data = data[['Timestamp',feature]] #Timestamp is used only for counting the occurrences\n    plot_data = plot_data.groupby(feature).count()\n    plot_data = plot_data.reset_index()\n    plot_data.columns = [feature,'Counts'] \n    return plot_data\n\ndef generate_plot(plot_data,feature,figsize):\n    plt.figure(figsize=figsize)\n    plt.bar(x = plot_data[feature], height = plot_data['Counts'])\n    plt.title('Costumers by {}'.format(feature))","5ca0ba76":"plot_bar(feature='Gender',figsize=(6,8))","ff365d4f":"data['Age'] = data['Age'].replace({'Below 20' : '1. Below 20',\n                                    'From 20 to 29' : '2. From 20 to 29',\n                                    'From 30 to 39' : '3. From 30 to 39',\n                                    '40 and above' : '4. 40 and Above'})\ndata = data.sort_values('Age')","7b53cf5f":"plot_bar(feature ='Age', figsize = (10,8))","5559ecd0":"plot_bar(feature ='Profession', figsize = (10,8))","a686f872":"data['Income'] = data['Income'].replace({'Less than RM25,000' : '1. Less than RM25,000',\n                                        'RM25,000 - RM50,000' : '2. RM25,000 - RM50,000',\n                                        'RM50,000 - RM100,000' : '3. RM50,000 - RM100,000',\n                                        'RM100,000 - RM150,000' : '4. RM100,000 - RM150,000',\n                                        'More than RM150,000' : '5. More than RM150,000'})\ndata = data.sort_values('Income')","303b457b":"plot_bar(feature ='Income', figsize = (15,8))","f1e71655":"data['Spend per Visit'] = data['Spend per Visit'].replace({'Zero' : '1. Zero',\n                                        'Less than RM20' : '2. Less than RM20',\n                                        'Around RM20 - RM40' : '3. Around RM20 - RM40',\n                                        'More than RM40' : '4. More than RM40'})\ndata = data.sort_values('Spend per Visit')","41d2c90e":"plot_bar(feature ='Spend per Visit', figsize = (10,8))","b4a8c2ad":"plot_bar(feature ='Membership', figsize = (6,8))","d52f7ae0":"def plot_mca(selected_columns,rows,columns,figsize):\n    mca_data = data[selected_columns]\n    mca = prince.MCA()\n    mca.fit(mca_data)\n\n    mca.plot_coordinates(mca_data,\n                     show_row_points=rows,\n                     show_column_points=columns,\n                     show_column_labels=True,\n                     figsize=figsize,\n                    );","88250456":"selected_columns = ['Gender', 'Age', 'Profession', 'Income']","ea9897fb":"plot_mca(selected_columns,rows=False,columns=True,figsize=(10,10))","5108ec38":"selected_columns = ['Visit Frequency','Prefered Form of Consumption', 'Time Spent on Visit','Spend per Visit','Distance to Store']","e737c639":"plot_mca(selected_columns,rows=False,columns=True,figsize=(10,10))","3514ef27":"selected_columns = ['Quality Rate','Price Range Rate','Service Rate','Ambiance Rate', 'WiFi Quality Rate','Likely for Meetings or Hangouts']","346e09bd":"plot_mca(selected_columns,rows=False,columns=True,figsize=(10,10))","95d9a4e1":"selected_columns = ['Gender', 'Age', 'Profession', 'Income','Recurrent Costumer']","05e4836e":"plot_mca(selected_columns,rows=False,columns=True,figsize=(10,10))","2098d14a":"selected_columns = ['Visit Frequency','Prefered Form of Consumption', 'Time Spent on Visit','Spend per Visit','Recurrent Costumer']","8321ae06":"plot_mca(selected_columns,rows=False,columns=True,figsize=(10,10))","80a91808":"def plot_bar(feature):\n    plot_data = organize_plot_data(feature)\n    generate_plot(plot_data,feature)\n\ndef organize_plot_data(feature):\n    plot_data = data[['Timestamp',feature]] #Timestamp is used only for counting the occurrences\n    plot_data = plot_data.groupby(feature).count()\n    plot_data = plot_data.reset_index()\n    plot_data.columns = [feature,'Counts'] \n    return plot_data\n\ndef generate_plot(plot_data,feature):\n    plt.bar(x = plot_data[feature], height = plot_data['Counts'])\n    plt.title('Costumers by {}'.format(feature))","b61215b2":"plt.figure(figsize=(20,8))\nplt.subplot(1,5,1)\nplot_bar(feature ='Quality Rate')\nplt.subplot(1,5,2)\nplot_bar(feature ='Price Range Rate')\nplt.subplot(1,5,3)\nplot_bar(feature ='Ambiance Rate')\nplt.subplot(1,5,4)\nplot_bar(feature ='WiFi Quality Rate')\nplt.subplot(1,5,5)\nplot_bar(feature ='Service Rate')","8a68a7f7":"plt.figure(figsize=(6,8))\nplot_bar('Sales and Promotion Importance')","02a75aa4":"cloud_data = data['Form of communication to Promotions'].sum()","1122c160":"cloud = WordCloud(background_color = \"white\", max_words = 200, stopwords = set(STOPWORDS))\nwordcloud = cloud.generate(cloud_data)","62eeb485":"fig, ax = plt.subplots(figsize=(10,8))\nax.imshow(wordcloud, interpolation='bilinear')\nax.set_axis_off()","05dcbffb":"Despite being a relative small dataset, the data appears to be almost complete, with rare missing values.","23de265c":"Actually, the fact of the income of costumers are concetrated on minor ranges doesn't seen to affect their consuming behaviour. Not only the costumers tend to have regular spends for a coffee shop, but also the number of memberships are almost balanced to the number of common costumers, which seems reasonable.","0723fe80":"---\n## Quality Rates Analysis","8d3867ed":"First, let's try to plot the columns related to demographic info about costumers.","ebcdac02":"The data seems to be well balanced in terms of Gender, which can be a positive factor for the representative aspect of the dataset. Next, let's check the age distribution.","43826241":"Starbucks is a multi-national, and the world largest, coffee chain originated in Seattle, Washington. With a well-recognized brand worldwide, Starbucks menus are composed of a variety of hot drinks, like whole-bean coffee, espresso and latte, and also cold drinks, like cold brew coffee and the famous Frappuccinos, besides other types of beverages and snacks.","dfc1373a":"[How Correspondence Analysis Works (A Simple Explanation)](https:\/\/www.displayr.com\/how-correspondence-analysis-works\/) and [How to Interpret Correspondence Analysis Plots (It Probably Isn\u2019t the Way You Think)](https:\/\/www.displayr.com\/interpret-correspondence-analysis-plots-probably-isnt-way-think\/), awesome articles by [Tim Bock](https:\/\/www.displayr.com\/author\/tim-bock\/) found on [DisplayR Blog](https:\/\/www.displayr.com\/).","a98db7c2":"It's clearly possible to see that the marjority of Starbucks costumers stands on the 20-29 Age Range. Let\u00b4s now check the Professions and Income Distributions.","b76efd14":"With this, some great insights could be obtained about the costumers. First, with the initial exploratory data, we could conclude that:\n\n* The costumers are well balance between Male and Female\n* The great portion of costumers are younger people, ranging between 20 and 29 years old, and generally are Employers and Students with incomes lower than RM 25.000\n* The spend per visit generally seems to involve regular values, less than RM 40\n* The data is also well balanced in terms of Membership","a62a6373":"And finally, from the Word Cloud of Sales and Promotions communication, we could clearly see that the most relevant ways of advertasing are by Friends and Word of Mouth. ","9e0e6a67":"Next, let's check the visits experience features under the same conditions.","8b525b43":"Compared to the distributions of the other rates, actually the Sales and Promotion Importance seems even more skewed to higher rates, indicating it's considerably  big importance to costumers.","cf38f6ba":"After pre-processing the data, an initial exploratory analysis can be done to obtain a first understanding of the data. For this, let\u00b4s focus on the more general characteristics of the costumers, starting with Gender.","02910423":"---\n## Objectives","8bf8bfa0":"---\n## Sales and Promotions Form of Communication Analysis","543b0f17":"As the Quality Rates couldn't been very well utilized for insights generations on the last section, this section proposes the analysis of this features using the raw data itself. For creating a better visualization, the plot_bar function used before suffers some adaptations.","07b1aaa6":"To try to answer the questions defined on the Objectives Section, especially the first two, on this section a technique called Multiple Correspondence Analysis (MCA) is used. This technique involves, as the name suggests, the multiple application of a simpler technique called Correspondence Analysis, which objective is to find the association between two variables of data. In this way, MCA calculates the association between multiple columns and show the results as points in a dimension reduced space, generally bi-dimensional, where features close to each other are probably strongly associated, and features on opposite site are probably negatively associated.\n\nWith this technique, we may find associations between features both in a way to better understand the characteristics of costumers, but also to understand which of this features are more related to recurrent costumers.","50841bba":"First, let's read the data and make a initial check on its format and presence of null values.","78a20a70":"On this plot, it's possible to see that the recurrent costumer is associated with the 20 to 29 year old range with employed people with RM 25.000 - RM 100.000 income. In contrast, the younger student costumers, with smaller incomes, are not prone to come back to Starbucks.","8d4c32d7":"On this notebook, a dataset containing answers to a Starbucks Costumer Survey are analysed, with the main objective of understanding the characteristics of the recurrent clients of Starbucks and how they stand out of the non-recurrent clients of the brand. For this, some minor objectives can be defined, made in the form of questions:\n\n* Who are the recurrent costumers of Starbucks? And who are the non-recurrent costumers?\n* How these two classes of costumers are different from one another?\n* What are the strong points of Starbucks according to the recurrent costumers? And the weakests?","852970da":"From the Quality Rates Analysis, we could learn that:\n* The Rates related to Price Range are not so skewed to higher notes, indicating some insatisfaction of the costumers\n* Consequently, the Importance of Sales and Promotions to Costumers presents higher rates","42e88935":"Checking the columns with more than 5 unique values, some redundancy could be found. Lets's fix those.","5089d24b":"It seems most of the costumers consists of Employees and Students with less than RM 25.000 of income (RM stands for Malaysian Ringgit, the local coin of Malaysia). This behaviour may have an direct impact on features like the spending of a costumer on a visit and quantity of costumers that have a membership card, and also indirect influences on features like the importance of sales and promotions on costumer decision and the price range rate. Maybe it's a good idea to check those. Let's briefly plot the two first mentioned.","b1155fd4":"# Starbucks Costumer Survey Data Analysis","56c182ff":"This plot presents a lot of interesting information. Let's check one by one:\n\n* First, close to the center, it's possible to find costumers who visit a  Starbucks daily and spends up to one hour on each visit.\n\n* Close to it, there's a group who rarely visit Starbucks, and spends less than RM 20 and generally only take-away.\n\n* Next, a monthly visit group can be found, with more than 3 hours visits and spends of RM 20 - RM 40 and prefers Dine-In on Drive-Thru experience.\n\n* More distant to the center, in the upper region, there's a group of weekly visitors, that spend between 1 and 3 hours on each visit, and actually spends the most among the costumers.\n\n* Finally, on the right there's the group that never visits a Starbucks store. \n\nAlso, there's an interesting pattern about the distance to store: The Monthly visitors group is more associated with costumers who live in greater distances than the ones who rarely visit Starbucks, which live within 1 km of the store.","59920ca0":"The income values suffers the similar problems to the Age Data. Let's replace some values.","719ecd2d":"To check that the formatting of data are constant, in a way to avoid duplicate answers, let\u00b4s check the number of unique values of each column, with the objective of check if any feature presents a unreasonably large number of possible values, which could indicate bad formatting.","58512ac6":"Next, let's plot some rate features related to the service itself.","5d30c86a":"Continuing on the topic of Sales and Promotions, let's check how they are being communicated to costumers by creating a Word Cloud of the most used ways to do this task.","c712d026":"---\n## Libraries","d5cc8086":"---\n## Costumer Clustering","0178b5de":"From the MCA plots, we could obtain:\n\n* The recurrent costumers are clustered in two well-defined groups of Daily, Weekly and Monthly Visitors\n* Daily Visitors tends to make short visits, up to one hour\n* Monthly Visitors tends to consume by Drive-Thru, expending regular values on each visit\n* Weekly Visitors, in turn, tends to take longer visits, between 1 and 3 hours, and spends more money on each visit\n* Interestingly, the more regular visitors are associated with people living more distant of a Starbucks Store, as oposed to rare visitors, who live nearby","c91ba47a":"On the next step, some rate columns, which are formatted as int are converted to strings. The reason to do that is the fact that in future sections, a clustering framework to be used is not compatible with int values.","f61c1afc":"First, some custom libraries are installed.","936a800b":"From these conclusions, it is possible to elaborate some suggestions, in the form of concise questions, with the objective to inspire some ideas to grown the sales of the Malaysian Starbucks:\n* Considering that a great part of the costumers are composed by younger people, and also considering the fact that Sales and Promotions have a great importance to them, why not use more modern ways of communication, like Social Networks, which are highly populated by this kind of public?\n* Considering this same portion of the costumers, why not create ambient stores more friendly to students, like stores close to universities with quiet places where costumers could study and drink coffee?\n* Considering the clusters of costumers according to the Frequency of Visits, would be a great ideia to create different Memberships for these different forms of consumption?\n* Part of the recurrent costumers seems to live far away from the stores. Is there anyway to target this public on promotions like Drive-Thru Sales, develop delivery services or promotions to home products like coffee capsules or instant coffee?\n* And also, for the closer costumers, which, as we saw, are associated with rare visits, why not promote Take-Away Sales that could target these costumers?","2053dd82":"---\n## Conclusion","03d5a79f":"Here, all the libaries and frameworks used throughout the notebook are imported.","38cd4154":"In some way, it's interesting to see that similar rates generally are closer together (5's are close to 5's, 2's are close to 2's and so on). This pattern, unfortunately doesn't bring much information to us.","ac41518b":"Now, let's remake the first two MCA plots, which gave the most information about data, but now also considering the \"Recurrent Costumer\" column, with the objective to try to discover the characteristics of the costumers that are prone to come back to Starbucks and the ones who don't think will return.","1cbb94d9":"Most of the features rates shows distributions more skewed to higher rates (3 to 5) with exception of the Price Range Rate, which has a kind of simetric distribution, but has more 1's and 2' rates than the other features evaluated by the costumers. This may have relation to the fact that most of the costumers have lower incomes, as discussed before. This may also have some relation to the  Sales and Promotion Importance feature. Let's check that.","f375865d":"As expected, the reccurent costumers are more related to daily and monthly visitors, for obvious reasons. But it's also possible to see that it is related to short visits, below 30 minutes and usually by drive-thru, indicanting a good retention of costumers on this format. In contrast, costumers who spend more time on each visit generally are less prone to come back. ","e5281fe0":"It is clear that communication between friends and word of mouth (that's what the big \"word\" on the plot stands for) are important ways of communicating promotions to the costumers. ","abe58914":"---\n## References","7544f51c":"For these initial plots, a simple function is created to avoid repeated code.","5ef0bcaa":"---\n## Pre-Processing","f374e2e8":"---\n## Exploratory Analysis","b05f4a95":"On this notebook, the Malaysian costumers of Starbucks were analysed through a dataset from a Survey about buying behaviour. For this task, visual exploration of data were made using Bar Plots and a Dimensional-Reduction technique called Multiple Correspondence Analysis, which were used to create a bi-dimensional space where the association between different categories of data could be easily seen. ","da0fdb6f":"At first glance, the data seems to be well formatted, but there's some possible steps to be done to guarantee a easier time on future sections.","27fa6067":"---\n## Read Data","52fdf30e":"Despite reaffirming some insights obtained on the previous section, this plot shows us a expected, but still interesting relation between columns: The income seems very related to the profession and age of the costumers. In that way, Employed Costumers with age between 20 to 39 years old are closer to greater income points in the graph, for example.","77e4d052":"The first thing that can be noticed on this data is that the columns names are too extensive. To make better dataframe visualizations in the future, shorter names are prefered.","922dbfcb":"Next, let's plot a graph involving features related to the costumers visit experience.","a891a559":"To sort values according to the Age, let's make a simple change on the names of possible answers."}}