{"cell_type":{"06ad38e7":"code","56681ac1":"code","176846ef":"code","ca8d5f70":"code","febd1ed2":"code","f97b76a2":"code","9fc8a177":"code","869d7c52":"code","c211feda":"code","d4698c4d":"code","283e053c":"code","2d0d18fe":"code","7817aae0":"code","a10877ca":"code","752a7dc2":"code","904b31f5":"code","f4a22dc9":"code","0f4fa17e":"code","0e7f67c0":"code","f4ae3848":"code","0ea67179":"code","16485f67":"code","27e4bd50":"code","dd2ae6b7":"code","aac9a09e":"code","858b9710":"code","f1ef236c":"code","338966c9":"code","8e88a61e":"code","3ea149ee":"code","0a60a419":"code","e99f4b71":"code","c23d4339":"code","3a0dba1c":"code","4ea0ee16":"code","89b52e81":"code","2fba5581":"code","072a89b0":"code","51fb6852":"code","418e821f":"code","4d4e8578":"code","e28c160a":"code","1f89bd62":"code","02a4d857":"code","3a927131":"code","3352892e":"code","446fe84f":"code","a8a434fc":"code","d810bb29":"code","633b7fa7":"code","1e48e856":"code","d90ca697":"code","518453c3":"code","3693cf0f":"code","5cb6bcaf":"code","0683349f":"code","41915134":"code","d2d8fee5":"code","a6e7818f":"code","9d4b9468":"code","91f9962c":"code","9571d5ac":"code","59826b5f":"code","b4764a4b":"code","ba14a0af":"code","432a9877":"code","2357ae35":"code","79ae892a":"code","e653af19":"code","0ee73118":"code","4faeb15c":"code","44f7f38b":"code","efeb9551":"code","0af69444":"markdown","2ec7bc2b":"markdown","f3203666":"markdown","8953a0d2":"markdown","58d8c2f8":"markdown","237df8e9":"markdown","e3d71577":"markdown","8ae7de90":"markdown","4944e855":"markdown","78fa95a2":"markdown","752103a5":"markdown","63843257":"markdown","de787f22":"markdown","3c4b11ce":"markdown","5c1b891f":"markdown","482a5789":"markdown","88fb5bdc":"markdown","9373bb37":"markdown","48f41472":"markdown","9bb79041":"markdown","b41c170f":"markdown","3d634da9":"markdown","bf91e2cf":"markdown","8c3ad6b3":"markdown","0deeb573":"markdown","d2e3ce75":"markdown","225dd63d":"markdown","2b5908a1":"markdown","1dc642e5":"markdown","98886ab7":"markdown","30c06d20":"markdown","a8ef9db6":"markdown","5d28cb81":"markdown","f93ba4ec":"markdown","ae3e2965":"markdown","e4accf2e":"markdown","f43d78c6":"markdown","a6b1049e":"markdown","28b734fd":"markdown","bde25187":"markdown","d48137e3":"markdown","dee0fd57":"markdown","735849c3":"markdown","bc923fd9":"markdown","affafce6":"markdown","5a1464de":"markdown","6507181b":"markdown","527ee33d":"markdown","4b48e970":"markdown","2930380d":"markdown"},"source":{"06ad38e7":"import pandas as pd\nimport numpy as np\n\nimport matplotlib.pyplot as plt \nimport seaborn as sns \nimport matplotlib as mpl\n\n\n\nimport plotly \nimport plotly.express as px\nimport plotly.graph_objs as go\nimport plotly.offline as py\nfrom plotly.offline import iplot\nfrom plotly.subplots import make_subplots\nimport plotly.figure_factory as ff","56681ac1":"fandango = pd.read_csv(\"..\/input\/fandango-rating-discrepancy\/fandango_scrape.csv\")","176846ef":"fandango.head()","ca8d5f70":"fandango.shape","febd1ed2":"fandango.info()","f97b76a2":"fandango.describe()","9fc8a177":"plt.figure(figsize=(16, 6))\nsns.scatterplot(data=fandango, x=\"RATING\", y=\"VOTES\")\nplt.title(\"Relationship between Rating and Votes\");","869d7c52":"fandango.corr()","c211feda":"fandango.columns","d4698c4d":"fandango.FILM.head()","283e053c":"fandango['YEAR'] = fandango['FILM'].apply(lambda title: title.split('(')[-1][:-1])\nfandango.YEAR","2d0d18fe":"fandango.groupby(\"YEAR\")[\"YEAR\"].value_counts().sort_values(ascending=False)","7817aae0":"film_by_year = fandango.YEAR.value_counts()\nfilm_by_year","a10877ca":"sns.countplot(data=fandango, x=\"YEAR\");","752a7dc2":"fandango[[\"FILM\", \"STARS\", \"RATING\", \"VOTES\", \"YEAR\"]].sort_values(by=\"VOTES\", ascending=False)[:10]","904b31f5":"fandango.nlargest(10, \"VOTES\")","f4a22dc9":"fandango[fandango[\"VOTES\"]==0].shape[0]","0f4fa17e":"fandango[\"VOTES\"][fandango[\"VOTES\"]==0].value_counts().sum()","0e7f67c0":"zero_votes = fandango['VOTES']==0 \nzero_votes.sum()","f4ae3848":"fandango_rev = fandango[fandango[\"VOTES\"] > 0]\nfandango_rev.head()","0ea67179":"plt.figure(figsize=(14, 6))\nsns.kdeplot(data=fandango_rev, x=\"RATING\", clip=(0, 5), fill=True, label=\"True Rating\")\nsns.kdeplot(data=fandango_rev, x=\"STARS\", clip=(0, 5), fill=True, label=\"Stars Displayed\")\nplt.legend(loc=(1.05,0.5));","16485f67":"fandango_rev.head()","27e4bd50":"fandango_rev[\"STARS_DIFF\"] = (fandango_rev[\"STARS\"] - fandango_rev[\"RATING\"]).round(2)\nfandango_rev","dd2ae6b7":"fandango_rev[\"STARS_DIFF\"][fandango_rev[\"STARS_DIFF\"] > 0]","aac9a09e":"non_zero_diff = fandango_rev[\"STARS_DIFF\"][fandango_rev[\"STARS_DIFF\"] > 0]","858b9710":"non_zero_diff.head()","f1ef236c":"non_zero_diff.unique()","338966c9":"plt.figure(figsize=(16, 5))\nsns.countplot(data=fandango_rev, x=non_zero_diff.values, palette=\"magma\")\nplt.title(\"Number of Times a Non_Zero Difference Occurs\");","8e88a61e":"plt.figure(figsize=(16, 5))\nsns.countplot(data=fandango_rev, x=\"STARS_DIFF\", palette=\"magma\")\nplt.title(\"Number of Times a Certain Difference Occurs\");","3ea149ee":"fandango_rev[fandango_rev[\"STARS_DIFF\"]==1]","0a60a419":"all_sites = pd.read_csv(\"..\/input\/fandango-rating-discrepancy\/all_sites_scores.csv\")","e99f4b71":"all_sites.head()","c23d4339":"all_sites.shape","3a0dba1c":"all_sites.info()","4ea0ee16":"all_sites.describe()","89b52e81":"all_sites.columns","2fba5581":"plt.figure(figsize=(10, 4), dpi=150)\nsns.scatterplot(data=all_sites, x=\"RottenTomatoes\", y=\"RottenTomatoes_User\")\nplt.xlim(0, 100)\nplt.ylim(0, 100);","072a89b0":"all_sites[\"Rotten_Diff\"] = all_sites[\"RottenTomatoes\"] - all_sites[\"RottenTomatoes_User\"]\nall_sites.head()","51fb6852":"all_sites[\"Rotten_Diff\"].apply(abs)","418e821f":"all_sites[\"Rotten_Diff\"].apply(abs).mean()","4d4e8578":"plt.figure(figsize=(16, 6), dpi=150)\nsns.histplot(data=all_sites, x=\"Rotten_Diff\", kde=True, bins=25)\nplt.title(\"RT Critics Score minus RT User Score\");","e28c160a":"plt.figure(figsize=(16, 6), dpi=150)\nsns.histplot(data=all_sites, x=all_sites[\"Rotten_Diff\"].apply(abs), kde=True, bins=25)\nplt.title(\"Absolute Difference between RT Critics Score and RT User Score\");","1f89bd62":"print(\"Users Love but Critics Hate\")\nall_sites[[\"FILM\",\"Rotten_Diff\"]][all_sites[\"Rotten_Diff\"] < 0].nsmallest(5, \"Rotten_Diff\")","02a4d857":"# Same output can be returned in the following way, as well.\n\nall_sites.nsmallest(5,'Rotten_Diff')[['FILM','Rotten_Diff']]","3a927131":"print(\"Critics love, but Users Hate\")\nall_sites[[\"FILM\",\"Rotten_Diff\"]][all_sites[\"Rotten_Diff\"] > 0].nlargest(5, \"Rotten_Diff\")","3352892e":"# Same output can be returned in the following way, as well.\n\nall_sites.nlargest(5,'Rotten_Diff')[['FILM','Rotten_Diff']]","446fe84f":"all_sites.columns","a8a434fc":"plt.figure(figsize=(10, 4), dpi=150)\nsns.scatterplot(data=all_sites, x=\"Metacritic\", y=\"Metacritic_User\")\nplt.xlim(0, 100)\nplt.ylim(0, 10);","d810bb29":"all_sites.columns","633b7fa7":"plt.figure(figsize=(10, 4), dpi=150)\nsns.scatterplot(data=all_sites, x=\"Metacritic_user_vote_count\", y=\"IMDB_user_vote_count\");","1e48e856":"all_sites.nlargest(1, \"IMDB_user_vote_count\")","d90ca697":"all_sites.nlargest(1, \"Metacritic_user_vote_count\")","518453c3":"df_merged = pd.merge(fandango, all_sites, on=\"FILM\", how=\"inner\")\ndf_merged.head()","3693cf0f":"df_merged.shape","5cb6bcaf":"df_merged.info()","0683349f":"df_merged.head()","41915134":"df_merged['RT_Norm'] = np.round(df_merged['RottenTomatoes']\/20,1)\ndf_merged['RTU_Norm'] =  np.round(df_merged['RottenTomatoes_User']\/20,1)","d2d8fee5":"df_merged['Meta_Norm'] =  np.round(df_merged['Metacritic']\/20,1)\ndf_merged['Meta_U_Norm'] =  np.round(df_merged['Metacritic_User']\/2,1)","a6e7818f":"df_merged['IMDB_Norm'] = np.round(df_merged['IMDB']\/2,1)","9d4b9468":"df_merged.head()","91f9962c":"normalized_score = df_merged[['STARS','RATING','RT_Norm','RTU_Norm','Meta_Norm','Meta_U_Norm','IMDB_Norm']]","9571d5ac":"normalized_score.head()","59826b5f":"def move_legend(ax, new_loc, **kws):\n    old_legend = ax.legend_\n    handles = old_legend.legendHandles\n    labels = [t.get_text() for t in old_legend.get_texts()]\n    title = old_legend.get_title().get_text()\n    ax.legend(handles, labels, loc=new_loc, title=title, **kws)","b4764a4b":"fig, ax = plt.subplots(figsize=(15,6),dpi=150)\nsns.kdeplot(data=normalized_score,clip=[0,5],shade=True,palette='Set1',ax=ax)\nmove_legend(ax, \"upper left\")","ba14a0af":"fig, ax = plt.subplots(figsize=(15,6),dpi=150)\nsns.kdeplot(data=normalized_score[['RT_Norm','STARS']],clip=[0,5],shade=True,palette='Set1',ax=ax)\nmove_legend(ax, \"upper left\")","432a9877":"plt.subplots(figsize=(15,6),dpi=150)\nsns.histplot(normalized_score,bins=50);","2357ae35":"sns.clustermap(normalized_score,cmap='magma',col_cluster=False);","79ae892a":"norm_films = df_merged[['STARS','RATING','RT_Norm','RTU_Norm','Meta_Norm','Meta_U_Norm','IMDB_Norm','FILM']]","e653af19":"norm_films.nsmallest(10,'RT_Norm')","0ee73118":"print('\\n\\n')\nplt.figure(figsize=(15,6),dpi=150)\nworst_films = norm_films.nsmallest(10,'RT_Norm').drop('FILM',axis=1)\nsns.kdeplot(data=worst_films,clip=[0,5],shade=True,palette='Set1')\nplt.title(\"Ratings for RT Critic's 10 Worst Reviewed Films\");","4faeb15c":"norm_films.iloc[25]","44f7f38b":"0.4+2.3+1.3+2.3+3","efeb9551":"9.3\/5","0af69444":"\n## Overview\n\nIf you are planning on going out to see a movie, how well can you trust online reviews and ratings? *Especially* if the same company showing the rating *also* makes money by selling movie tickets. Do they have a bias towards rating movies higher than they should be rated?\n\n### Goal:\n\n**Your goal is to complete the tasks below based off the 538 article and see if you reach a similar conclusion. You will need to use your pandas and visualization skills to determine if Fandango's ratings in 2015 had a bias towards rating movies better to sell more tickets.**\n\n---\n---\n\n**Complete the tasks written in bold.**\n\n---\n----\n\n## Part One: Understanding the Background and Data\n\n\n**TASK: Read this article: [Be Suspicious Of Online Movie Ratings, Especially Fandango\u2019s](http:\/\/fivethirtyeight.com\/features\/fandango-movies-ratings\/)**","2ec7bc2b":"**TASK: Combine the Fandango Table with the All Sites table. Not every movie in the Fandango table is in the All Sites table, since some Fandango movies have very little or no reviews. We only want to compare movies that are in both DataFrames, so do an *inner* merge to merge together both DataFrames based on the FILM columns.**","f3203666":"**TASK: Plot the distribution of the differences between RT Critics Score and RT User Score. There should be negative values in this distribution plot. Feel free to use KDE or Histograms to display this distribution.**","8953a0d2":"**TASK: Calculate the correlation between the columns:**","58d8c2f8":"**OPTIONAL TASK: Create a histplot comparing all normalized scores.**","237df8e9":"**TASK: What are the 10 movies with the highest number of votes?**","e3d71577":"\n### How are the worst movies rated across all platforms?\n\n**TASK: Create a clustermap visualization of all normalized scores. Note the differences in ratings, highly rated movies should be clustered together versus poorly rated movies. Note: This clustermap does not need to have the FILM titles as the index, feel free to drop it for the clustermap.**","8ae7de90":"**TASK: Display a scatterplot of the Metacritic Rating versus the Metacritic User rating.**","4944e855":"**TASK: Let's explore the relationship between popularity of a film and its rating. Create a scatterplot showing the relationship between rating and votes. Feel free to edit visual styling to your preference.**","78fa95a2":"**TASK: Now create a distribution showing the *absolute value* difference between Critics and Users on Rotten Tomatoes.**","752103a5":"Let's now compare the overall mean difference. Since we're dealing with differences that could be negative or positive, first take the absolute value of all the differences, then take the mean. This would report back on average to absolute difference between the critics rating versus the user rating.","63843257":"**TASK: Create a count plot to display the number of times a certain difference occurs:**","de787f22":"**TASK: Now create a norm_scores DataFrame that only contains the normalizes ratings. Include both STARS and RATING from the original Fandango table.**","3c4b11ce":"## Fandago Scores vs. All Sites\n\nFinally let's begin to explore whether or not Fandango artificially displays higher ratings than warranted to boost ticket sales.","5c1b891f":"----\n\n**TASK: Import any libraries you think you will use:**","482a5789":"**Let's find out which movies are causing the largest differences. First, show the top 5 movies with the largest *negative* difference between Users and RT critics. Since we calculated the difference as Critics Rating - Users Rating, then large negative values imply the users rated the movie much higher on average than the critics did.**","88fb5bdc":"That is the end of our analysis. Hope you enjoy it. ","9373bb37":"**Clearly Fandango has an uneven distribution. We can also see that RT critics have the most uniform distribution. Let's directly compare these two.** \n\n**TASK: Create a KDE plot that compare the distribution of RT critic ratings against the STARS displayed by Fandango.**","48f41472":"**Notice there are two outliers here. The movie with the highest vote count on IMDB only has about 500 Metacritic ratings. What is this movie?**\n\n**TASK: What movie has the highest IMDB user vote count?**","9bb79041":"### Rotten Tomatoes\n\nLet's first take a look at Rotten Tomatoes. RT has two sets of reviews, their critics reviews (ratings published by official critics) and user reviews. \n\n**TASK: Create a scatterplot exploring the relationship between RT Critic reviews and RT User reviews.**","b41c170f":"**TASK: Calculate the Mean Absolute Difference between RT scores and RT User scores as described above.**","3d634da9":"**TASK: What movie has the highest Metacritic User Vote count?**","bf91e2cf":"**TASK: Now show the top 5 movies critics scores higher than users on average.**","8c3ad6b3":"**TASK: What are the top 5 movies users rated higher than critics on average:**","0deeb573":"----\n\n**As noted in the article, due to HTML and star rating displays, the true user rating may be slightly different than the rating shown to a user. Let's visualize this difference in distributions.**\n\n**TASK: Create a KDE plot (or multiple kdeplots) that displays the distribution of ratings that are displayed (STARS) versus what the true rating was from votes (RATING). Clip the KDEs to 0-5.**","d2e3ce75":"----\n\n**TASK: After reading the article, read these two tables giving an overview of the two .csv files we will be working with:**\n\n### The Data\n\nThis is the data behind the story [Be Suspicious Of Online Movie Ratings, Especially Fandango\u2019s](http:\/\/fivethirtyeight.com\/features\/fandango-movies-ratings\/) openly available on 538's github: https:\/\/github.com\/fivethirtyeight\/data. There are two csv files, one with Fandango Stars and Displayed Ratings, and the other with aggregate data for movie ratings from other sites, like Metacritic,IMDB, and Rotten Tomatoes.\n\n#### all_sites_scores.csv","225dd63d":"## Part Three: Comparison of Fandango Ratings to Other Sites\n\nLet's now compare the scores from Fandango to other movies sites and see how they compare.\n\n**TASK: Read in the \"all_sites_scores.csv\" file by running the cell below**","2b5908a1":"Let's quantify this difference by comparing the critics ratings and the RT User ratings. We will calculate this with RottenTomatoes-RottenTomatoes_User. Note: Rotten_Diff here is Critics - User Score. So values closer to 0 means aggrement between Critics and Users. Larger positive values means critics rated much higher than users. Larger negative values means users rated much higher than critics.\n\n**TASK: Create a new column based off the difference between critics ratings and users ratings for Rotten Tomatoes. Calculate this with RottenTomatoes-RottenTomatoes_User**","1dc642e5":"----\n----\n\n#### fandango_scrape.csv","98886ab7":"**TASK: Explore the DataFrame columns, info, description.**","30c06d20":"## MetaCritic\n\nNow let's take a quick look at the ratings from MetaCritic. Metacritic also shows an average user rating versus their official displayed rating.","a8ef9db6":"**TASK: Visualize the count of movies per year with a plot:**","5d28cb81":"**TASK: Explore the DataFrame Properties and Head.**","f93ba4ec":"## IMDB\n\nFinally let's explore IMDB. Notice that both Metacritic and IMDB report back vote counts. Let's analyze the most popular movies.\n\n**TASK: Create a scatterplot for the relationship between vote counts on MetaCritic versus vote counts on IMDB.**","ae3e2965":"-----\n\n`all_sites_scores.csv` contains every film that has a Rotten Tomatoes rating, a RT User rating, a Metacritic score, a Metacritic User score, and IMDb score, and at least 30 fan reviews on Fandango. The data from Fandango was pulled on Aug. 24, 2015.","e4accf2e":"`fandango_scrape.csv` contains every film 538 pulled from Fandango.\n\nColumn | Definiton\n--- | ---------\nFILM | The movie\nSTARS | Number of stars presented on Fandango.com\nRATING |  The Fandango ratingValue for the film, as pulled from the HTML of each page. This is the actual average score the movie obtained.\nVOTES | number of people who had reviewed the film at the time we pulled it.","f43d78c6":"**TASK: Create DataFrame of only reviewed films by removing any films that have zero votes.**","a6b1049e":"**TASK: How many movies are in the Fandango DataFrame per year?**","28b734fd":"**TASK: Let's now actually quantify this discrepancy. Create a new column of the different between STARS displayed versus true RATING. Calculate this difference with STARS-RATING and round these differences to the nearest decimal point.**","bde25187":"## Part Two: Exploring Fandango Displayed Scores versus True User Ratings\n\nLet's first explore the Fandango ratings to see if our analysis agrees with the article's conclusion.\n\n**TASK: Run the cell below to read in the fandango_scrape.csv file**","d48137e3":"**TASK: We can see from the plot that one movie was displaying over a 1 star difference than its true rating! What movie had this close to 1 star differential?**","dee0fd57":"---\n----\n\n<img src=\"https:\/\/upload.wikimedia.org\/wikipedia\/en\/6\/6f\/Taken_3_poster.jpg\">\n\n**Final thoughts: Wow! Fandango is showing around 3-4 star ratings for films that are clearly bad! Notice the biggest offender, [Taken 3!](https:\/\/www.youtube.com\/watch?v=tJrfImRCHJ0). Fandango is displaying 4.5 stars on their site for a film with an [average rating of 1.86](https:\/\/en.wikipedia.org\/wiki\/Taken_3#Critical_response) across the other platforms!**","735849c3":"### Normalize columns to Fandango STARS and RATINGS 0-5 \n\nNotice that RT,Metacritic, and IMDB don't use a score between 0-5 stars like Fandango does. In order to do a fair comparison, we need to *normalize* these values so they all fall between 0-5 stars and the relationship between reviews stays the same.\n\n**TASK: Create new normalized columns for all ratings so they match up within the 0-5 star range shown on Fandango. There are many ways to do this.**\n\nHint link: https:\/\/stackoverflow.com\/questions\/26414913\/normalize-columns-of-pandas-data-frame\n\n\nEasier Hint:\n\nKeep in mind, a simple way to convert ratings:\n* 100\/20 = 5 \n* 10\/2 = 5","bc923fd9":"### Comparing Distribution of Scores Across Sites\n\n\nNow the moment of truth! Does Fandango display abnormally high ratings? We already know it pushs displayed RATING higher than STARS, but are the ratings themselves higher than average?\n\n\n**TASK: Create a plot comparing the distributions of normalized ratings across all sites. There are many ways to do this, but explore the Seaborn KDEplot docs for some simple ways to quickly show this. Don't worry if your plot format does not look exactly the same as ours, as long as the differences in distribution are clear.**\n\nQuick Note if you have issues moving the legend for a seaborn kdeplot: https:\/\/github.com\/mwaskom\/seaborn\/issues\/2280","affafce6":"----","5a1464de":"**TASK: Assuming that every row in the FILM title column has the same format:**\n\n    Film Title Name (Year)\n    \n**Create a new column that is able to strip the year from the title strings and set this new column as YEAR**","6507181b":"**TASK: Clearly Fandango is rating movies much higher than other sites, especially considering that it is then displaying a rounded up version of the rating. Let's examine the top 10 worst movies. Based off the Rotten Tomatoes Critic Ratings, what are the top 10 lowest rated movies? What are the normalized scores across all platforms for these movies? You may need to add the FILM column back in to your DataFrame of normalized scores to see the results.**","527ee33d":"**FINAL TASK: Visualize the distribution of ratings across all sites for the top 10 worst movies.**","4b48e970":"**TASK: How many movies have zero votes?**","2930380d":"Column | Definition\n--- | -----------\nFILM | The film in question\nRottenTomatoes | The Rotten Tomatoes Tomatometer score  for the film\nRottenTomatoes_User | The Rotten Tomatoes user score for the film\nMetacritic | The Metacritic critic score for the film\nMetacritic_User | The Metacritic user score for the film\nIMDB | The IMDb user score for the film\nMetacritic_user_vote_count | The number of user votes the film had on Metacritic\nIMDB_user_vote_count | The number of user votes the film had on IMDb"}}