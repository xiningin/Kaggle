{"cell_type":{"b0b724fc":"code","3aea2f3e":"code","6cad909c":"code","fd8fe9c1":"code","bc1a948e":"code","691cd827":"code","cf85b3a9":"code","c6acfc0a":"code","8eff1eb4":"code","6eeee658":"code","1058e88d":"code","c864d7a6":"code","c3111acf":"code","73df9d61":"code","3d0df0a2":"code","8da6cd41":"code","4f9aa6d7":"code","549db897":"code","1a2c879e":"code","e89e4f8d":"code","8c3f7e32":"code","01beb9e1":"code","277b2ec8":"code","a05bf924":"code","c5d92689":"code","6da91ca7":"code","b906e2ba":"code","9db63fbf":"code","45677cd5":"code","d82cdaca":"code","ac8e85d0":"code","e5dec4f0":"code","af00d1d2":"code","db55e1fd":"code","ee9af0ec":"code","85c2f648":"code","77e29ef7":"code","82a49600":"code","5f303d87":"code","62c53d5d":"code","0c2d3e2e":"code","7cd6eb23":"code","7b8710c8":"code","9aaa6711":"markdown","e5b99010":"markdown","1006b375":"markdown","7ccfe173":"markdown","c3a69e44":"markdown","a6e266b8":"markdown","d4767367":"markdown","d813d3af":"markdown","ae423cda":"markdown","c1210a58":"markdown","87cfad72":"markdown","d1209d7c":"markdown","d370a911":"markdown","e753cc64":"markdown","5e427aa2":"markdown","98996d78":"markdown","9943c561":"markdown","c0f453cd":"markdown","865b4a9c":"markdown","404588f4":"markdown","4fc0ce0b":"markdown","049b6dc9":"markdown","15f72446":"markdown","2a006005":"markdown","97bf6f74":"markdown","99987b41":"markdown","5f61aed2":"markdown","eea84b54":"markdown","327d628b":"markdown","1d53f137":"markdown"},"source":{"b0b724fc":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport matplotlib.image as mpimg\nimport seaborn as sns","3aea2f3e":"data=pd.read_csv('..\/input\/ny_airbnb\/AB_NYC_2019_org.csv')\ndata.head(8)","6cad909c":"data.isnull().sum()","fd8fe9c1":"data=pd.read_csv('..\/input\/ny_airbnb\/AB_NYC_2019.csv')\ndata.isnull().sum()","bc1a948e":"# SELECT COUNT(*) FROM NY1 WHERE Price <= 0\n# Result: 11 --- will remove those 11 rows\n\n# SELECT COUNT(*) FROM NY1 WHERE Price <= 0\n# Result: 0 --- good to go\n\n# SELECT COUNT(*) FROM NY1 WHERE availability_365 <= 0\n# Result: 17533 --- thats is shocking, more than one third of property listed has never been available","691cd827":"#Courtesy Dgmonov, I didn't know earler how to use image while plotting\n\nplt.figure(figsize=(20,16))\nnyc_img=plt.imread('..\/input\/ny_airbnb_img\/Neighbourhoods_New_York_City_Map.PNG')\n#scaling the image based on the latitude and longitude max and mins for proper output specially when drawing scattter plot\nplt.imshow(nyc_img,zorder=0,extent=[-74.258, -73.7, 40.49,40.92])\nax=plt.gca()\nsns.scatterplot(data.longitude,data.latitude,hue=data.neighbourhood_group, ax=ax)","cf85b3a9":"# CREATE TABLE [dbo].[NY_2](\n\n# \t[id] [int] NULL,\n#   [name] [varchar](max) NULL,\n#   [host_id] [int] NULL,\n# \t[host_name] [varchar](max) NULL,\n# \t[neighbourhood_group] [varchar](max) NULL,\n# \t[neighbourhood] [varchar](max) NULL,\n# \t[latitude] [decimal](18, 9) NULL,\n# \t[longitude] [decimal](18, 9) NULL,\n# \t[room_type] [varchar](max) NULL,\n# \t[price] [int] NULL,\n# \t[minimum_nights] [int] NULL,\n# \t[number_of_reviews] [int] NULL,\n# \t[last_review] [datetime] NULL,\n# \t[reviews_per_month] [decimal](18, 9) NULL,\n# \t[calculated_host_listings_count] [int] NULL,\n# \t[availability_365] [int] NULL,\n# \t[Price_Range_100] [varchar](max) NULL,\n# \t[Price_Range_Sequence] INT,\n# \t[Availability_Range] [varchar](max) NULL,\n# \t[Availibility_Range_Sequence] INT\n# ) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]","c6acfc0a":"# INSERT INTO NY_2(id,name,host_id,host_name,neighbourhood_group,neighbourhood,latitude,longitude,room_type,price,minimum_nights,number_of_reviews,last_review,reviews_per_month,calculated_host_listings_count,availability_365)\n# SELECT * FROM NY1\n# WHERE Price > 0\n\n##### Updating Category columns\n\n# UPDATE NY_2\n# SET [Price_Range_100] = CASE \n\n# \tWHEN price BETWEEN 0 AND 100 THEN '0-100'\n# \tWHEN price BETWEEN 101 AND 200 THEN '101-200'\n# \tWHEN price BETWEEN 201 AND 300 THEN '201-300'\n# \tWHEN price BETWEEN 301 AND 400 THEN '301-400'\n# \tWHEN price BETWEEN 401 AND 500 THEN '401-500'\n# \tWHEN price BETWEEN 501 AND 600 THEN '501-600'\n# \tWHEN price BETWEEN 601 AND 700 THEN '601-700'\n# \tWHEN price BETWEEN 701 AND 800 THEN '701-800'\n# \tWHEN price BETWEEN 801 AND 900 THEN '801-900'\n# \tWHEN price BETWEEN 901 AND 1000 THEN '901-1000'\n# \tELSE '> 1000' END \n        \n# , [Price_Range_Sequence] = CASE \n\n# \tWHEN price BETWEEN 0 AND 100 THEN 1\n# \tWHEN price BETWEEN 101 AND 200 THEN 2\n# \tWHEN price BETWEEN 201 AND 300 THEN 3\n# \tWHEN price BETWEEN 301 AND 400 THEN 4\n# \tWHEN price BETWEEN 401 AND 500 THEN 5\n# \tWHEN price BETWEEN 501 AND 600 THEN 6\n# \tWHEN price BETWEEN 601 AND 700 THEN 7\n# \tWHEN price BETWEEN 701 AND 800 THEN 8\n# \tWHEN price BETWEEN 801 AND 900 THEN 8\n# \tWHEN price BETWEEN 901 AND 1000 THEN 10\n# \tELSE 11 END \n#         \n# , [Availability_Range] =  CASE \n# \n# \tWHEN [availability_365] = 0 THEN 'No Availability'\n# \tWHEN [availability_365] BETWEEN 1 AND 100 THEN 'Low Avalability'\n# \tWHEN [availability_365] BETWEEN 101 AND 200 THEN 'Medium Availablity'\n# \tWHEN [availability_365] BETWEEN 201 AND 300 THEN 'High Availablity'\n# \tWHEN [availability_365] BETWEEN 301 AND 365 THEN 'Nearly Always Availability'\n# \tELSE 'Invalid' END\n#        \n# , [Availibility_Range_Sequence] = CASE \n# \n# \tWHEN [availability_365] = 0 THEN 0\n# \tWHEN [availability_365] BETWEEN 1 AND 100 THEN 1\n# \tWHEN [availability_365] BETWEEN 101 AND 200 THEN 2\n# \tWHEN [availability_365] BETWEEN 201 AND 300 THEN 3\n# \tWHEN [availability_365] BETWEEN 301 AND 365 THEN 4\n# \tELSE -1 END\n#         \n# \tFROM NY_2","8eff1eb4":"### Lets Have a look at the Data we have prepared so far\ndata_cat=pd.read_csv('..\/input\/ny_airbnb\/AB_NYC_2019_4.csv')\ndata_cat.head()","6eeee658":"f,ax=plt.subplots(1,2,figsize=(20,10))\ntitle = plt.title('Number of listings by Naighbourhood Groups', fontsize=20)\ntitle.set_position([-0.2, 1.15])\npatches, texts = plt.pie(data['neighbourhood_group'].value_counts(), startangle=90, pctdistance=0.85)\nplt.legend(patches, data['neighbourhood_group'], loc=\"best\")\n\ncentre_circle = plt.Circle((0,0),0.4,fc='white')\nfig = plt.gcf()\nfig.gca().add_artist(centre_circle)\nplt.axis('equal')  \nplt.tight_layout()\n\nsns.countplot('neighbourhood_group',data=data,ax=ax[0])\nax[0].set_xlabel('Neighbourhood Groups')\nax[0].set_ylabel('Number of Listings')\nplt.show()","1058e88d":"# SELECT TOP 35 neighbourhood, count(*) FROM NY_2\n# GROUP BY neighbourhood\n# ORDER BY COUNT(*) DESC\n\n#Resulted in following\ndata_neighbourhood=pd.read_csv('..\/input\/ny_airbnb\/AB_NYC_2019_7.csv')\ndata_neighbourhood","c864d7a6":"#Lets run pie on this\nplt.figure(figsize=(15,11))\nplt.title('Number of listings by Top 35 Neighbourhoods', fontsize=20)\npatches, texts = plt.pie(data_neighbourhood['COUNT'], startangle=90, pctdistance=0.85)\nplt.legend(patches, data_neighbourhood['neighbourhood'], loc=\"upper right\")\n\ncentre_circle = plt.Circle((0,0),0.4,fc='white')\nfig = plt.gcf()\nfig.gca().add_artist(centre_circle)\nplt.axis('equal')  \nplt.tight_layout()\nplt.show()","c3111acf":"# SELECT TOP 35 neighbourhood, count(*) AS [COUNT] FROM NY_2\n# GROUP BY neighbourhood\n# HAVING COUNT(*) > 500\n# ORDER BY COUNT(*) DESC\n\n#Resulted in following\ndata_neighbourhood_500=pd.read_csv('..\/input\/ny_airbnb\/AB_NYC_2019_8.csv')\ndata_neighbourhood_500","73df9d61":"f,ax=plt.subplots(1,2,figsize=(25,10))\ntitle = plt.title('Number of listings by Naighbourhood having more than 500 records', fontsize=20)\ntitle.set_position([0.0, 1.15])\npatches, texts = plt.pie(data_neighbourhood_500['COUNT'], startangle=90, pctdistance=0.85)\nplt.legend(patches, data_neighbourhood_500['neighbourhood'], loc=\"upper left\")\n\ncentre_circle = plt.Circle((0,0),0.4,fc='white')\nfig = plt.gcf()\nfig.gca().add_artist(centre_circle)\nplt.axis('equal')  \nplt.tight_layout()\n\nchart = sns.barplot(data=data_neighbourhood_500,x='neighbourhood',y='COUNT',ax=ax[0])\nax[0].set_xlabel('Neighbourhoods')\nax[0].set_ylabel('Number of Listings')\nax[0].tick_params(axis='x', labelrotation=45)\nchart.set_xticklabels(chart.get_xticklabels(), rotation=45, horizontalalignment='right')\nplt.show()","3d0df0a2":"plt.figure(figsize=(10,6))\ntitle = plt.title('Number of listings by Room Type', fontsize=20)\ntitle.set_position([0.5, 1.15])\nax = sns.countplot(x=\"room_type\", data=data_cat)\nax.set_xlabel('Room Type')\nax.set_ylabel('Listings')\na = ax.set_xticklabels(ax.get_xticklabels(), rotation=0, horizontalalignment='right')","8da6cd41":"plt.figure(figsize=(10,6))\ntitle = plt.title('Number of Reviews by Room Type', fontsize=20)\ntitle.set_position([0.5, 1.15])\nax = sns.barplot(x=\"room_type\", y=\"number_of_reviews\", data=data_cat, ci=None)\nax.set_xlabel('Room Type')\nax.set_ylabel('Reviews')\na = ax.set_xticklabels(ax.get_xticklabels(), rotation=15, horizontalalignment='right')","4f9aa6d7":"plt.figure(figsize=(10,6))\ntitle = plt.title('Distribution of Reviews by Neighbourhood Groups', fontsize=20)\ntitle.set_position([0.5, 1.15])\nax = sns.violinplot(x=\"neighbourhood_group\", y=\"number_of_reviews\", data=data_cat)\nax.set_xlabel('Neighbourhood Group')\nax.set_ylabel('Reviews')\nax.set(ylim=(0, 200))\nc = ax.set_xticklabels(ax.get_xticklabels(), rotation=0, horizontalalignment='center')","549db897":"plt.figure(figsize=(10,6))\ntitle = plt.title('Distribution of Reviews by Room Type', fontsize=20)\ntitle.set_position([0.5, 1.15])\nax = sns.violinplot(x=\"room_type\", y=\"number_of_reviews\", data=data_cat)\nax.set_xlabel('Room Types')\nax.set_ylabel('Reviews')\nax.set(ylim=(0, 200))\nc = ax.set_xticklabels(ax.get_xticklabels(), rotation=0, horizontalalignment='center')","1a2c879e":"heatmap_data_roomtype_ng_price = pd.pivot_table(data_cat, values='price', \n                     index=['room_type'], \n                     columns='neighbourhood_group')\n\nplt.figure(figsize=(20,6))\ntitle = plt.title('Room Type, Neighbourhood Groups and Price Relation', fontsize=20)\ntitle.set_position([0.5, 1.15])\nax = sns.heatmap(heatmap_data_roomtype_ng_price, cmap=\"YlGnBu\", cbar_kws={'label': 'Price'})\nax.set_xlabel('Neighbourhood Groups')\nax.set_ylabel('Room Type')\na = ax.set_yticklabels(ax.get_yticklabels(), rotation=0, horizontalalignment='right')\na = ax.set_xticklabels(ax.get_xticklabels(), rotation=0, horizontalalignment='center')","e89e4f8d":"#SELECT Price_Range_100, COUNT(*) AS [COUNT]\n#FROM NY_2\n#GROUP BY Price_Range_100, Price_Range_Sequence\n#ORDER BY Price_Range_Sequence\ndata_price_count=pd.read_csv('..\/input\/ny_airbnb\/AB_NYC_2019_5.csv')\ndata_price_count","8c3f7e32":"#SELECT [Availability_Range], COUNT(*) AS [COUNT]\n#FROM NY_2\n#GROUP BY [Availability_Range], [Availibility_Range_Sequence]\n#ORDER BY [Availibility_Range_Sequence]\ndata_availability_count=pd.read_csv('..\/input\/ny_airbnb\/AB_NYC_2019_6.csv')\ndata_availability_count","01beb9e1":"f,ax=plt.subplots(1,2,figsize=(20,10))\nplt.title('Share of listings by Availability', fontsize=20)\nwedges, patches, texts = ax[1].pie(data_availability_count['COUNT'], startangle=90, labels=data_availability_count['Availability_Range'], pctdistance=0.6,autopct='%1.1f%%')\n\ncentre_circle = plt.Circle((0,0),0.4,fc='white')\nfig = plt.gcf()\nfig.gca().add_artist(centre_circle)\nplt.axis('equal')  \nplt.tight_layout()\n\nchart = sns.barplot(data=data_availability_count,x='Availability_Range',y='COUNT',ax=ax[0])\nax[0].set_title('Share of listings by Availability', fontsize=20)\nax[0].set_xlabel('Availability')\nax[0].set_ylabel('Number of Listings')\nchart.set_xticklabels(chart.get_xticklabels(), rotation=0, horizontalalignment='center')\nplt.show()","277b2ec8":"data_availability_count_nonzero=pd.read_csv('..\/input\/ny_airbnb\/AB_NYC_2019_9.csv')\nf,ax=plt.subplots(1,2,figsize=(20,10))\nplt.title('Share of listings by Availability with non zero availability', fontsize=20)\nwedges, patches, texts = plt.pie(data_availability_count_nonzero['COUNT'], startangle=90, labels=data_availability_count_nonzero['Availability_Range'], pctdistance=0.6,autopct='%1.1f%%')\n\ncentre_circle = plt.Circle((0,0),0.4,fc='white')\nfig = plt.gcf()\nfig.gca().add_artist(centre_circle)\nplt.axis('equal')  \nplt.tight_layout()\n\nchart = sns.barplot(data=data_availability_count_nonzero,x='Availability_Range',y='COUNT',ax=ax[0])\nax[0].set_title('Share of listings by Availability with non zero availability', fontsize=20)\nax[0].set_xlabel('Availability')\nax[0].set_ylabel('Number of Listings')\nchart.set_xticklabels(chart.get_xticklabels(), rotation=0, horizontalalignment='center')","a05bf924":"#Including more Parameters\nplt.figure(figsize=(10,10))\ntitle = plt.title('Number of listings by Availability and Neighbourhood Groups', fontsize=20)\ntitle.set_position([0.5, 1.15])\nax = sns.countplot(x=\"Availability_Range\", data=data_cat, hue='neighbourhood_group')\nax.set_xlabel('Availability')\nax.set_ylabel('Number of Listings')\na = ax.set_xticklabels(ax.get_xticklabels(), rotation=15, horizontalalignment='right')\nax.titlesize = 'large'   ","c5d92689":"#### Removing Zero Availability\n\n# Removing records with zero availability from *data_cat* and loading into *data_cat_nonzero* by following __SQL__\n\n# SELECT * FROM NY_2\n# WHERE availability_365 > 0\n# Resulted in 31354 records\n\ndata_cat_nonzero=pd.read_csv('..\/input\/ny_airbnb\/AB_NYC_2019_10.csv')","6da91ca7":"plt.figure(figsize=(10,6))\ntitle = plt.title('Number of listings by Availability and Neighbourhood Groups', fontsize=20)\ntitle.set_position([0.5, 1.15])\nax = sns.countplot(x=\"Availability_Range\", data=data_cat_nonzero, hue='neighbourhood_group')\nax.set_xlabel('Availability')\nax.set_ylabel('Number of Listings')\na = ax.set_xticklabels(ax.get_xticklabels(), rotation=15, horizontalalignment='right')","b906e2ba":"plt.figure(figsize=(10,6))\ntitle = plt.title('Number of listings by Availability and Room Type', fontsize=20)\ntitle.set_position([0.5, 1.15])\nax = sns.countplot(x=\"Availability_Range\", data=data_cat_nonzero, hue='room_type')\nax.set_xlabel('Availability')\nax.set_ylabel('Number of Listings')\na = ax.set_xticklabels(ax.get_xticklabels(), rotation=15, horizontalalignment='right')","9db63fbf":"f,ax=plt.subplots(1,1,figsize=(20,10))\n\nchart1 = sns.barplot(x=\"Availability_Range\", y=\"number_of_reviews\", data=data_cat, ci=None)\ntitle = ax.set_title('Number of Reviews by Availability', fontsize=20)\ntitle.set_position([0.5, 1.15])\nax.set_xlabel('Availability')\nax.set_ylabel('Number Reviews')\nchart1.set_xticklabels(chart1.get_xticklabels(), rotation=0, horizontalalignment='center')\n\nplt.show()","45677cd5":"plt.figure(figsize=(10,6))\ntitle = plt.title('Number of Reviews by Availability and Appartment Type', fontsize=20)\ntitle.set_position([0.5, 1.15])\nax = sns.barplot(x=\"Availability_Range\", y=\"number_of_reviews\", data=data_cat_nonzero, hue='room_type', ci=None)\nax.set_xlabel('Availability')\nax.set_ylabel('Reviews')\na = ax.set_xticklabels(ax.get_xticklabels(), rotation=15, horizontalalignment='right')","d82cdaca":"#Another incoming from SQL\n# SELECT Availibility_Range_Sequence, neighbourhood_group, price\n# FROM NY_2\n# ORDER BY Availibility_Range_Sequence\n\ndata_av_heatmap=pd.read_csv('..\/input\/ny_airbnb\/AB_NYC_2019_11.csv')\nheatmap_data = pd.pivot_table(data_av_heatmap, values='price', \n                     index=['Availibility_Range_Sequence'], \n                     columns='neighbourhood_group')\n\nplt.figure(figsize=(10,6))\ntitle = plt.title('Availability, Neighbour Group, and Price comparison', fontsize=20)\ntitle.set_position([0.5, 1.15])\nax = sns.heatmap(heatmap_data, cmap=\"YlGnBu\", cbar_kws={'label': 'Price'})\nax.set_xlabel('Neighbourhood Groups')\nax.set_ylabel('Availability')\ny_label_list = ['No Availability', 'Low Availablity', 'Medium Availablity', 'High Availablity', 'Nearly Always Availability']\na = ax.set_yticklabels(y_label_list, rotation=0)\na = ax.set_xticklabels(ax.get_xticklabels(), rotation=0, horizontalalignment='center')","ac8e85d0":"# Heatmap with respect to Top 10 Neighbourhoods\n# SELECT Availibility_Range_Sequence, neighbourhood, price FROM NY_2\n# WHERE neighbourhood IN\n# (\n# \tSELECT TOP 10 neighbourhood\n# \tFROM NY_2\n# \tGROUP BY neighbourhood\n# \tORDER BY COUNT(*) DESC\n#)\n\ndata_av_heatmap=pd.read_csv('..\/input\/ny_airbnb\/AB_NYC_2019_12.csv')\nheatmap_data = pd.pivot_table(data_av_heatmap, values='price', \n                     index=['Availibility_Range_Sequence'], \n                     columns='neighbourhood')\n\nplt.figure(figsize=(20,6))\ntitle = plt.title('Availability, Top 10 Neighbourhoods, and Price comparison', fontsize=20)\ntitle.set_position([0.5, 1.15])\nax = sns.heatmap(heatmap_data, cmap=\"YlGnBu\", cbar_kws={'label': 'Price'})\nax.set_xlabel('Neighbourhoods')\nax.set_ylabel('Availability')\ny_label_list = ['No Availability', 'Low Availablity', 'Medium Availablity', 'High Availablity', 'Nearly Always Availability']\na = ax.set_yticklabels(y_label_list, rotation=0)\na = ax.set_xticklabels(ax.get_xticklabels(), rotation=30, horizontalalignment='right')","e5dec4f0":"# SELECT Availibility_Range_Sequence, room_type, price\n# FROM NY_2\n# ORDER BY Availibility_Range_Sequence\n\ndata_av_heatmap_3=pd.read_csv('..\/input\/ny_airbnb\/AB_NYC_2019_13.csv')\nheatmap_data = pd.pivot_table(data_av_heatmap_3, values='price', \n                     index=['Availibility_Range_Sequence'], \n                     columns='room_type')\n\nplt.figure(figsize=(10,6))\ntitle = plt.title('Availability, Room Type, and Price comparison', fontsize=20)\ntitle.set_position([0.5, 1.15])\nax = sns.heatmap(heatmap_data, cmap=\"YlGnBu\", cbar_kws={'label': 'Price'})\nax.set_xlabel('Room Type')\nax.set_ylabel('Availability')\ny_label_list = ['No Availability', 'Low Availablity', 'Medium Availablity', 'High Availablity', 'Nearly Always Availability']\na = ax.set_yticklabels(y_label_list, rotation=0)\na = ax.set_xticklabels(ax.get_xticklabels(), rotation=0, horizontalalignment='center')","af00d1d2":"f,ax=plt.subplots(1,2,figsize=(15,10))\ntitle = plt.title('Number of listings by Price', fontsize=20)\ntitle.set_position([0.0, 1.15])\npatches, texts = plt.pie(data_price_count['COUNT'], startangle=90, pctdistance=0.6)\nplt.legend(patches, data_price_count['Price_Range_100'], loc=\"upper right\")\nax[1].set_title('Number of listings by Price', fontsize=20)\n\ncentre_circle = plt.Circle((0,0),0.4,fc='white')\nfig = plt.gcf()\nfig.gca().add_artist(centre_circle)\nplt.axis('equal')  \nplt.tight_layout()\n\nchart = sns.barplot(data=data_price_count,x='Price_Range_100',y='COUNT',ax=ax[0])\nax[0].set_xlabel('Price')\nax[0].set_ylabel('Number of Listings')\nchart.set_xticklabels(chart.get_xticklabels(), rotation=35, horizontalalignment='right')\nplt.show()","db55e1fd":"plt.figure(figsize=(10,6))\ntitle = plt.title('Price comparison by Room Type', fontsize=20)\ntitle.set_position([0.5, 1.15])\nax = sns.violinplot(x=\"room_type\", y=\"price\", data=data_cat_nonzero)\nax.set_xlabel('Room Type')\nax.set_ylabel('Price')\nax.set(ylim=(0, 600))\nc = ax.set_xticklabels(ax.get_xticklabels(), rotation=0, horizontalalignment='center')","ee9af0ec":"plt.figure(figsize=(10,6))\ntitle = plt.title('Price comparison by Neighbourhood Groups', fontsize=20)\ntitle.set_position([0.5, 1.15])\nax = sns.violinplot(x=\"neighbourhood_group\", y=\"price\", data=data_cat_nonzero)\nax.set_xlabel('Neighbourhood Groups')\nax.set_ylabel('Price')\nax.set(ylim=(0, 600))\nc = ax.set_xticklabels(ax.get_xticklabels(), rotation=0, horizontalalignment='center')","85c2f648":"# SELECT * FROM NY_2\n# WHERE neighbourhood IN\n# (\n# \tSELECT TOP 20 neighbourhood\n# \tFROM NY_2\n# \tWHERE availability_365 > 0\n# \tGROUP BY neighbourhood\n# \tORDER BY COUNT(*) DESC\n# )\n# AND availability_365 > 0\ndata_top_10_neighbourhoods=pd.read_csv('..\/input\/ny_airbnb\/AB_NYC_2019_14.csv')\n\nplt.figure(figsize=(25,6))\nplt.title('Price comparison by Top 10 Neighbourhoods', fontsize=20)\nax = sns.violinplot(x=\"neighbourhood\", y=\"price\", data=data_top_10_neighbourhoods)\nax.set_xlabel('Neighbourhoods')\nax.set_ylabel('Price')\nax.set(ylim=(0, 500))\nc = ax.set_xticklabels(ax.get_xticklabels(), rotation=30, horizontalalignment='right')","77e29ef7":"ax = sns.jointplot(y=\"price\", x=\"availability_365\", data=data_cat_nonzero,xlim=(0, 365), ylim=(0, 500), height=8, ratio=5)\nl = ax.set_axis_labels(\"Availaility\", \"Price\")\nplt.subplots_adjust(top=0.9)\nplt.suptitle('Price and availability distribution', fontsize = 16)\nplt.show()","82a49600":"heatmap_data_ng_price_reviews = pd.pivot_table(data_cat_nonzero, values='number_of_reviews', \n                     index=['neighbourhood_group'], \n                     columns='Price_Range_100')\n\nplt.figure(figsize=(20,6))\ntitle = plt.title('Reviews by Neighbourhood and Price Range', fontsize=20)\ntitle.set_position([0.5, 1.15])\nax = sns.heatmap(heatmap_data_ng_price_reviews, cmap=\"YlGnBu\", cbar_kws={'label': 'Reviews'})\nax.set_xlabel('Price Range')\nax.set_ylabel('Neighbourhood Groups')\na = ax.set_yticklabels(ax.get_yticklabels(), rotation=0, horizontalalignment='right')\na = ax.set_xticklabels(ax.get_xticklabels(), rotation=0, horizontalalignment='center')","5f303d87":"heatmap_data_rt_price_reviews = pd.pivot_table(data_cat_nonzero, values='number_of_reviews', \n                     index=['room_type'], \n                     columns='Price_Range_100')\n\nplt.figure(figsize=(20,6))\ntitle = plt.title('Reviews by Room Type and Price Range', fontsize=20)\ntitle.set_position([0.5, 1.15])\nax = sns.heatmap(heatmap_data_rt_price_reviews, cmap=\"YlGnBu\", cbar_kws={'label': 'Reviews'})\nax.set_xlabel('Price Range')\nax.set_ylabel('Room Type')\na = ax.set_yticklabels(ax.get_yticklabels(), rotation=0, horizontalalignment='right')\na = ax.set_xticklabels(ax.get_xticklabels(), rotation=0, horizontalalignment='center')","62c53d5d":"import urllib\nf,ax=plt.subplots(1,2,figsize=(25,10))\nnyc_img=plt.imread('..\/input\/ny_airbnb_img\/Neighbourhoods_New_York_City_Map.PNG')\n#scaling the image based on the latitude and longitude max and mins for proper output specially when drawing scattter plot\nax[0].imshow(nyc_img,zorder=0,extent=[-74.258, -73.7, 40.49,40.92])\nmap1 = sns.scatterplot(data_cat.longitude,data_cat.latitude,hue=data_cat.neighbourhood_group, ax=ax[0])\ntitle = ax[0].set_title('Data with 0 Availability', fontsize=20)\ntitle.set_position([0.5, 1.1])\n\nax[1].imshow(nyc_img,zorder=0,extent=[-74.258, -73.7, 40.49,40.92])\nmap2 = sns.scatterplot(data_cat_nonzero.longitude,data_cat_nonzero.latitude,hue=data_cat_nonzero.neighbourhood_group, ax=ax[1])\ntitle = ax[1].set_title('Data without 0 Availability', fontsize=20)\ntitle.set_position([0.5, 1.1])\nplt.show()","0c2d3e2e":"ax=plt.figure(figsize=(20,8))\nnyc_img=plt.imread('..\/input\/ny_airbnb_img\/Neighbourhoods_New_York_City_Map.PNG')\nplt.imshow(nyc_img,zorder=0,extent=[-74.258, -73.7, 40.49,40.92])\nax=plt.gca()\nsns.scatterplot(data=data_cat[data_cat['Availability_Range']=='No Availability'], x='longitude',y='latitude',hue='Availability_Range', ax=ax)\ntitle = ax.set_title('Data for No Availability', fontsize=20)\ntitle.set_position([0.5, 1.1])","7cd6eb23":"f,ax=plt.subplots(1,2,figsize=(25,10))\nnyc_img=plt.imread('..\/input\/ny_airbnb_img\/Neighbourhoods_New_York_City_Map.PNG')\n#scaling the image based on the latitude and longitude max and mins for proper output specially when drawing scattter plot\nax[0].imshow(nyc_img,zorder=0,extent=[-74.258, -73.7, 40.49,40.92])\n\nmap1 = sns.scatterplot(data = data_cat_nonzero,x='longitude',y='latitude',hue='Price_Range_100', ax=ax[0], palette='RdBu')\ntitle = ax[0].set_title('Distribution by Price', fontsize=20)\ntitle.set_position([0.5, 1.1])\n\nax[1].imshow(nyc_img,zorder=0,extent=[-74.258, -73.7, 40.49,40.92])\nmap2 = sns.scatterplot(data = data_cat_nonzero,x='longitude',y='latitude',hue='Availability_Range', ax=ax[1])\ntitle = ax[1].set_title('Distribution by Availability', fontsize=20)\ntitle.set_position([0.5, 1.1])\nplt.show()","7b8710c8":"ax=plt.figure(figsize=(20,8))\nnyc_img=plt.imread('..\/input\/ny_airbnb_img\/Neighbourhoods_New_York_City_Map.PNG')\nplt.imshow(nyc_img,zorder=0,extent=[-74.258, -73.7, 40.49,40.92])\nax=plt.gca()\nsns.scatterplot(data=data_cat_nonzero, x='longitude',y='latitude',hue='room_type', ax=ax)\ntitle = ax.set_title('Distribution by Room Type', fontsize=20)\ntitle.set_position([0.5, 1.1])","9aaa6711":"### 4.1.1 Dumping data in NY_2","e5b99010":"## 7.1 Inference\n\n1. Listings with No Availability are scattered throughout the city\n\n2. In Manhattan there are more records for Low Availability while in Staten Island there are more records for Always availability\n\n3. in Manhattan there are more records for Entire home\/apt","1006b375":"#### Removing Zero Availability\n\nRemoving records with no avilability and drawing again:","7ccfe173":"# 7. Geograhical Analysis","c3a69e44":"##### Information:\n\nNumber of listings in top 23 Neighbourhoods: 33775 (69.03%)\nPercentage of Neighbouroods: 10.04%\n\n<font color=red> __*So just 10% of Neighbourhoods contains about 70% of data*__ <\/font>","a6e266b8":"### 4.2.2 Neighbourhoods Analysis -- Applying Pareto Principle (80\/20 rule) ","d4767367":"## 3.1 Nulls and Empty","d813d3af":"## Data Analysis by Categories\n\nAs we have aready added four new columns to categorize our data in two ways\n\n##### 1) Prince Range\nCategorized in 11 categories with the interval of 100 starting with 0, which reated 10 categories till 1000 while for price more than 1000 just one category is created\n\n##### 2) Availability\nCategorized in 5 categories:\n\n    1. Not Available - Property has never been up for rent in a year\n    2. Low Availablity - Property avilable for less than or just for 100 days in a year\n    3. Medium Availability - Property available for 101 to 200 days in a year\n    4. High Availability - Property available for more than 200 but only upto 300 days in a year\n    5. Nearly Always Available - Property available for more than 300 days in a year\n\nFollowing are the SQL queries and their results","ae423cda":"## 3.2 Validity check by SQL\n\nI am running a few queries and listing down its results to discard rows tat looks in valid or not usable","c1210a58":"# 3. Data Cleaning and Validity","87cfad72":"# 1. Foreword\n\nThis Notebook is created for learning purpose for beginners specially for those who have very little knowledge of Python but have nice experience with other programming languages for example c#, java, c++, SQL. I will be using lot od SQL in there for data wrangling instead of Pandas or any other library.\n\nIn addition to that I have created a small utility to load data from\/to CSV\/SQL while I will upload once it gets stabalized.","d1209d7c":"Removing this might not be a good idea since it is atleast giving us the data that these property might be available in future.\n\nWe can utilize its longitude and latitude but we should not use this data for price comparison, since they have never been rented.\n\nWe can add a flag\/column in our dataframe depicting if the property is avilable or not","d370a911":"## 6.1 Inference\n\n1. Prices thhat fall in lower prices category like 0-100 and 101-200 has more records than all the oter records combined\n\n2. Manhattan and Broklyn has more records in between 100 to 200 than any other borough\n\n3. Financial District and West Village has more records with prices more than 100\n\n4. Though number of reviews mostly decline with increase in price but for price between 801-900 has more reviews for boroughs Queens and Manhattan **&** for Private Room and Entire Appartment","e753cc64":"### 4.2.1 Neighbourhood Groups","5e427aa2":"Since I have to transafer data to SQL name and host name can be considered as Empty but I am replacing last_review with *__'1\/1\/1900'__* and reviews_per_month is replaced with __0__. Although SQL can consider NULL values its just that my utility is not that much evolved yet.\n\nSo after doing so following are the results for same isnull function:\n","98996d78":"# 2. Data Load and Libraries Import","9943c561":"##### Information:\n\nNumber of listings in top 35 Neighbourhoods: 38795 (79.34%)\nPercentage of Neighbouroods: 15.84%\n\n<font color=red> __*Under 16% of Neighbourhoods contains about 80% of data*__ <\/font>","c0f453cd":"Total Number of Neigbourhoods: **221**\n**20% of  221 is 44**\n\nPicking up __*Top 35 neighbourhoods*__  since it loks like presenting 44 neighbourhoods in a chart will not be a good idea, so further reducing number of neighbourhoods that is with follwing SQL Query","865b4a9c":"## 4.1 SQL Script for data preperation\n\nWe will be keeping the originial table (NY1) as it is while creating new table name NY_2","404588f4":"## 5.1 Inference\n\n1) One third of the data have zero availability, means they are nothing more than addresses, and should not be considered r considered separately when applying availability with other parameters for example Price which we will see next.\n\n2) Manhattan has the hoghest number of listings in all sorts of avilability except for one that is Low Availability.\n\n3) Strangely properties that are always available have lower number of reviews\n\n4) Property that is not available also reviews, means it was available before the data is extracted.\n\n5) Number of reviews is still higher in case of private room compared with any other type except in case of high availability \n\n6) Price is directly proportional to Availability, in both cases of Neighbourhood Groups and Top 10 Neighbourhoods.\n","4fc0ce0b":"## 5 Data Analysis by Availability:","049b6dc9":"## 4. Exploratory Data Analysis\n\nNow lets start with simple Explorartory Data Analysis. For this as the data is already transferred to SQL so there are three things that we would like to do with data\n\n##### 1) Remove the rows with 0 price\n\n##### 2) Categorize data with respect to Prices\n\n##### 3) Categorize data wit respect to Availability","15f72446":"# Contents\n\n#### 1. Foreword\n#### 2. Data Load and Libraries Import\n#### 3. Data Cleaning and Validity\n*  3.1 Nulls and Empty\n*    3.2 Valididty Check by SQL\n*    3.3 Georaphical Validity\n\n#### 4. Exploratory Data Analysis\n*  4.1 SQL Script for Data Preparation\n*  *  4.1.1 Dumping Data in NY_2\n*  4.2 Simple data Analysis\n*  *  4.2.1 Neighbourhood Groups\n*  *  4.2.2 Neighbourhoods Analysis -- Applying Pareto Principle (80\/20 rule) \n*  4.3 Inference\n\n#### 5. Data Analysis by availability\n*  5.1 Inference\n\n#### 6. Data Analysis by Price\n*  6.1 Inference\n\n#### 7. Geographic Analysis\n*  7.1 inference","2a006005":"#### Neighbourhood with more than 500 listings\n\nFurther narrowing our data, that is selecting only those neighbourhoods that have more than 500 listings","97bf6f74":"As you can see here that 4 columns are increased, that is 2 for each category, one depicts name of Category while other depicts its sequence. \n\nNow lets fill the table first and we shall update the newly created column afterwards","99987b41":"Cant find any outlier atleast not with respect to neighbhourhood_group, so moving forward to Simple dta analysis.","5f61aed2":"## 4.2 Simple Data Analysis","eea84b54":"# 6. Data Analysis by Price","327d628b":"## 3.3 Geographical Validity\n\nHere is the image of NewYork map with neighbourhood_group borders and do a scatter plot with neighbourhood_group as hue, that will easily point out outliers","1d53f137":"## 4.3 Inference\n\nWith the simple data analysis we can infer that:\n\n1. Data is avaialable for 5 Neighbourood Groups\n\n2.  There are 221 Neighbourhoods listed in data\n\n3.  Pareto rule is quite applicable 16% of Neighbourhoods have 80% data while top 10% Neighbourhoods have 70% of data\n *  We will surely apply thatwhile doing Data analysis by categories\n\n4.  There were 11 records that had 0 price so they are removed\n\n5.  There are 17533 records with no avilability, that will be further discussed in data analysis by Categories\n\n6. Though Entire home\/appartments have higher number of listings but Private room have more number of reviews\n *  We shall look into relation of Reviews and prices later\n        \n7. The two least listed Neighbourhood groups have greater number of reviews per property\n\n8. Manhattan is ofcourse the costliest in case of any type of propety.\n *  Staten Island in case of Entire Appartment has more price than any other Neighbourhood Group ofcourse except Manhattan "}}