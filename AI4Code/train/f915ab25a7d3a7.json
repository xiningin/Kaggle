{"cell_type":{"b435ca7f":"code","5d164b94":"code","890d9a1e":"code","4763bbaa":"code","1936026d":"code","b3ca6651":"code","adf98227":"code","c60dc59d":"code","22c162c4":"code","1195952b":"code","35c961dc":"code","cebc40f0":"code","2b5f3110":"code","c2c334b3":"code","de66e750":"code","0aef8087":"code","cee61958":"code","0ffd69cc":"code","c8514557":"code","de5b1388":"code","fa85b6c3":"code","2e3e3467":"code","9809b1c7":"code","99d01517":"code","dc4c58bd":"code","cf3aadd0":"code","6315f1a6":"code","691b9db2":"code","c56b1193":"code","696b0be4":"code","6515b145":"code","531af00b":"code","0846c1f0":"code","c15dae94":"code","aaad597d":"code","ac5a7a8f":"code","823bd0bc":"code","83cc7132":"code","2709dc66":"code","67c43be9":"code","af3fe6f2":"code","8372622f":"code","8d8a7632":"code","5f4bf620":"code","25477b26":"code","b57be081":"code","fbbf228d":"code","9c19af6f":"code","27f503d2":"code","469cf5c4":"code","49c444c3":"code","df992f6b":"code","fb6066c3":"code","382b7783":"code","d3037f9f":"code","0a7a69f3":"code","579cf8a8":"code","4e243475":"code","2c756c66":"code","2548a479":"code","a2a99aef":"code","2d32daf5":"code","513e2bc2":"code","5d023d05":"code","f8cbc8be":"code","a4b21f81":"code","3fca3b28":"code","8e7716cc":"code","a524af4a":"code","6508d733":"code","88ec90bb":"code","25ee4ec8":"code","1a904fc6":"code","d939ceaf":"code","036f18f3":"code","ee767d15":"code","228d39e8":"code","151d07dc":"code","e8291885":"code","533443ff":"code","327d48f9":"code","53c1b0e1":"code","c7f929a0":"code","90eedf67":"code","89933a48":"code","9d4de092":"code","2921395f":"code","0fb29ef1":"code","2c8f3f0a":"code","6c6b21fd":"code","25809294":"code","361d179a":"code","d5d8b657":"code","d424df8e":"code","608883f8":"code","8e642cc7":"code","745ec5ab":"code","7a7c487f":"code","50236818":"code","8cd2fb38":"code","cf1207bd":"code","0279b142":"code","4d4cee2e":"code","ff37f069":"code","e05d6255":"code","984c78f5":"code","8129630d":"code","e2c42a04":"code","6933e75c":"code","ca05ad6b":"code","8d9a3ad8":"code","bfa2cd16":"code","0dbb59e7":"code","65e97d49":"code","ef01679e":"code","0d3ca591":"code","723096ca":"code","209df9ee":"code","e214bd5d":"code","8412e422":"code","f562d718":"code","4a7974fc":"code","c8448e68":"code","581390a6":"code","34c1fe4f":"code","457f2640":"code","7f2b4ad6":"code","dc8a1007":"code","d0a28776":"code","b41e0529":"code","6f7d391c":"code","f39fecdb":"code","87993d6e":"code","67316173":"code","2e608677":"code","77835e2e":"code","988f5d3e":"code","a03459df":"code","326733f0":"code","cd33dad8":"code","bd90529e":"code","eaea2d07":"code","842df529":"code","eb75452a":"code","94da2b85":"code","4ced64f1":"code","a9f7e0e6":"code","e59ee767":"code","d5b514f3":"code","84881fb7":"code","e84b8c50":"code","984ad9cd":"code","5868e244":"code","e52649dd":"code","77558c75":"code","d80dfb9d":"code","59743980":"code","42ea5024":"code","964f2dd2":"code","f20e99ce":"code","545fe4d5":"code","6e98917c":"code","88baadf3":"code","ca120072":"code","a4ddb905":"code","6a60deb5":"code","853043d5":"code","0bf121e1":"code","35222e8f":"code","be8a6546":"code","5d577867":"code","53325a2a":"code","aadaf0ed":"code","737be9ab":"code","6574c1f7":"code","eada2eb3":"code","6a0d8ad1":"code","11e38adf":"code","7c995279":"code","0ba66fc7":"code","5d5387a2":"code","b785db1b":"code","53384d23":"code","5e60d004":"code","03d6d333":"code","04f5e969":"code","ef723d49":"code","74ac3016":"code","27366c5d":"code","4021d28c":"code","d3364562":"code","707d5b43":"code","2531d49b":"code","eebaf427":"code","8e5ed0c7":"code","ecac42ea":"code","de192136":"code","6017a351":"code","2109ba6f":"code","62a7c35d":"code","86334c2a":"code","5726a745":"code","9a3372b9":"code","9c63fd12":"code","b3f219df":"code","af0ac271":"code","79782355":"code","91d010ca":"code","4f4b2f0e":"code","1dbf5bf7":"code","d9b8ee95":"code","6548a074":"code","2aa8dff9":"code","e1483937":"code","6c459af0":"code","dbb446e3":"code","6bda401d":"code","aa16df11":"code","a04a5818":"code","dbb147e6":"code","e14d4fb6":"code","c3033e57":"code","5a980b98":"code","ff221781":"code","dc9a62d3":"code","8a75bb42":"code","c61639b4":"code","103f6808":"code","a0e5e06a":"code","5c10045a":"code","45615e2f":"code","b2c19be8":"code","5882110b":"code","58caf131":"code","fddea4f2":"code","c1545429":"code","e1edfa8b":"code","9461542d":"code","cb7cf059":"code","da0773e7":"code","0fbdc7fe":"code","97d279e8":"code","b8c88cd5":"code","e52e47cb":"code","284d5ca3":"code","3cb95b5f":"code","f241b4f3":"code","c1353bd2":"code","6623911e":"code","8b6d987d":"code","c9f67d49":"code","0c8e5c95":"code","4ffe3750":"code","e659f4d5":"code","ce5f86e3":"code","7949fe53":"code","f91b16fd":"code","14a4a7da":"code","d319671e":"code","3794a631":"code","77fb72be":"markdown","4ffde08b":"markdown","65893f5b":"markdown","a422b8bc":"markdown","0db84512":"markdown","bac8df9f":"markdown","8f1645cc":"markdown","9a19a3a5":"markdown","b4274ad6":"markdown","747df4c4":"markdown","2f4ec167":"markdown","e7449cdf":"markdown","83009a15":"markdown","fad78016":"markdown","160f3d7d":"markdown","b8d80196":"markdown","38949890":"markdown","e294d902":"markdown","5dd774e3":"markdown","864864dd":"markdown","5c6d7b04":"markdown","372958f3":"markdown","f5ad368a":"markdown","94d7c7ff":"markdown","6d7609f6":"markdown","b8d376db":"markdown","4f1d6b5a":"markdown","833a1232":"markdown","32306647":"markdown","79fef2f6":"markdown","bc4e69c4":"markdown","86216c62":"markdown","fefd7046":"markdown","791f2c3d":"markdown","ed032ccf":"markdown","8e66914a":"markdown","da772a53":"markdown","4020a082":"markdown","ff951d39":"markdown","9c4453b1":"markdown","67be2a8b":"markdown","186d75fb":"markdown","2f184660":"markdown","f8fa10c3":"markdown","bc6087b6":"markdown","6fa9cfa5":"markdown","bebe8215":"markdown","d257a13f":"markdown","d6d42025":"markdown","8ede97bf":"markdown","fc50a5df":"markdown","b6c1acb9":"markdown","3bf9227d":"markdown","9daafcc9":"markdown","3a4f8a4f":"markdown","a2e9512f":"markdown","5fdcd142":"markdown","8e3aba9a":"markdown","1fe89942":"markdown","bdb9ea6f":"markdown","a751d5ca":"markdown","e8568889":"markdown","e7310c1b":"markdown","93e06225":"markdown","bfbe344a":"markdown","208bfa9f":"markdown","5cb749a7":"markdown","d7fe029d":"markdown","d8d0fca4":"markdown","b8ed2c77":"markdown","4d1f948f":"markdown","91159f44":"markdown","396ff61a":"markdown","a151e764":"markdown","02b9167d":"markdown","24eba5fb":"markdown","f029b92a":"markdown","a9571cb0":"markdown","00c70970":"markdown","3b60f2b9":"markdown","53423b36":"markdown","04f0b90d":"markdown","dd2d9b05":"markdown","c93b8f1d":"markdown","ece4db3f":"markdown","94d5152e":"markdown","28581aa5":"markdown","92f437b4":"markdown","76334219":"markdown","6d41dfc3":"markdown","8156a2b1":"markdown","4302bb0d":"markdown","b1f0c5b2":"markdown","b0caaaf9":"markdown","0a7e1285":"markdown","358849e7":"markdown","4225dd96":"markdown","0019c532":"markdown","35263c76":"markdown","c2668b55":"markdown","8490ddbb":"markdown","817086ed":"markdown","e28562a1":"markdown","c26a8eeb":"markdown","93b38398":"markdown","c36748ec":"markdown","c4eb5e36":"markdown","b552ec0f":"markdown","4e4a37c9":"markdown","2c9f379e":"markdown","c9f3aad5":"markdown","5cc173f5":"markdown","129d1a30":"markdown","cc3e4380":"markdown","69069dd7":"markdown","b7f62ab2":"markdown","332b2faa":"markdown","ca7e806c":"markdown","5027da12":"markdown","4c810fb4":"markdown","185439cc":"markdown","d8018bb2":"markdown","548c2821":"markdown","654b8b54":"markdown","0c99e0ed":"markdown","42598263":"markdown","122bc38b":"markdown","398326a5":"markdown","de658bf0":"markdown","96c11388":"markdown","1c538e0d":"markdown","1de1a26b":"markdown","ecea3698":"markdown","2eb65f73":"markdown","6a8ac3b2":"markdown","37a04f69":"markdown","fef8985b":"markdown","22135b17":"markdown","8d07fa69":"markdown","a476edeb":"markdown","aa5cab72":"markdown","e6d09d78":"markdown","ed15be0d":"markdown","5b3afdbf":"markdown","1bbc9652":"markdown","cc98d1c2":"markdown","f1c7b0cc":"markdown","e434f34b":"markdown","2c7ad4d3":"markdown","05f9d114":"markdown","2e1974f8":"markdown","8baf485c":"markdown","404cecfc":"markdown","55e50b31":"markdown","54b14b48":"markdown","d93e3948":"markdown","df114b00":"markdown","8b544eb2":"markdown","bc7618e6":"markdown","68bdf83d":"markdown","584a7d50":"markdown","6d4d3607":"markdown"},"source":{"b435ca7f":"!pip install --upgrade pip --user\n!pip install --upgrade seaborn --user\n!pip install pycaret --user\n!pip install termcolor --user\n!pip install wget --user\n!pip install geoplot --user\n","5d164b94":"#Package need in this project\n\n\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport os\nfrom datetime import datetime, date\n# Missing Value\n# -----------------------------------\n# !pip install missingno\nimport missingno as msno\n\n# Configuration\n# -----------------------------------\nimport warnings\nwarnings.filterwarnings(\"ignore\")\nwarnings.simplefilter(action='ignore', category=FutureWarning)\n\npd.set_option('display.max_columns', None)\npd.options.display.float_format = '{:.2f}'.format\n\nfrom termcolor import colored\n\n\n#sklearn Area\nfrom sklearn.manifold import TSNE\nfrom sklearn.decomposition import PCA\n\nfrom astropy.coordinates import Angle # some lat\/lng are formatted weirdly\nfrom astropy import units as u\n\nEARTH_RADIUS = 3958.761 #in miles \n\nimport geoplot\nimport geoplot.crs as gcrs\nimport geopandas as gpd","890d9a1e":"#matplot \u8abf\u6574\u5340\nplt.rcParams['figure.dpi'] = 300","4763bbaa":"#kaggle\u81ea\u5e36\u5340\u57df\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n        ","1936026d":"##\u4f5c\u5716\u5c01\u88dd\u5340##\n\n\n#\u71b1\u529b\u5716\ndef corr_plot(data, figsize = (10, 6)):\n    fig, ax = plt.subplots(figsize = figsize)\n    plt.title('Correlations (Pearson)', size = 15, fontweight = 'bold', fontfamily = 'serif')\n    \n    mask = np.triu(np.ones_like(data.corr(), dtype = bool))\n    sns.heatmap(round(data.corr(), 2), mask=mask,cmap = 'YlGnBu', annot = True,annot_kws={\"size\":6})\n    plt.rcParams['figure.dpi'] = 300\n    \n    plt.show()\n    \n#???\u6642\u597d\u6642\u4e0d\u597d     \ndef vis(data):\n    list_col = data.columns.tolist()\n    fig, ax = plt.subplots(nrows=len(list_col), ncols=1, figsize=(20,90))\n\n    for i in range(len(list_col)):\n        sns.lineplot(x=data.Date, y=(data.iloc[:,i]).fillna(np.inf), ax=ax[i], color='dodgerblue')\n        ax[i].set_title(list_col[i], fontsize=14)\n        ax[i].set_ylabel(ylabel=list_col[i], fontsize=14)\n        \n        ax[i].set_xlim(date(2010,1,1), date(2020,6,30))\n        ax[i].grid(axis = 'y', linestyle = '--', alpha = 0.9)\n\n#\u7d71\u4e00\u589e\u52a0\u6642\u9593\u898f\u683c\ndef time(data):\n    #\u5f9e\u6587\u5b57\u8b8a\u6210\u6642\u9593\u683c\u5f0f\n    data['Date'] = data['Date'].apply(lambda x: datetime.strptime(x, \"%d\/%m\/%Y\"))\n    y = data.iloc[0]['Date'].year\n    #Lake_na['year-month'] = Lake_na['date'].apply(lambda x: int((x.year-y)*12+x.month))\n    \n    #\u6708\u4efd\u52a0\u6642\u9593\n    #data['month\/day'] = data['Date'].apply(lambda x:str(x.month) + \"\/\" + str(x.day))\n    #Lake_na['year'] = Lake_na['date'].apply(lambda x: int(x.year))\n    \n    #\u6708\u4efd\n    data['month'] = data['Date'].apply(lambda x: int(x.month))\n    #\u65e5\n    data['day'] = data['Date'].apply(lambda x: int(x.day))\n        \n","b3ca6651":"#\u6709\u6642\u5019\u65b9\u4fbf\u53d6column\ndef takecolumn(data):\n    col = data.columns.tolist()\n    RainfallCol = []\n    DepthCol = []\n    TempCol = []\n    VolCol = []\n    HydroCol = []\n    for i in col:\n        if i.startswith('Rain'):\n            RainfallCol.append(i.strip())\n        elif i.startswith('Depth'):\n            DepthCol.append(i.strip())\n        elif i.startswith('Temp'):\n            TempCol.append(i.strip())\n        elif i.startswith('Vol'):\n            VolCol.append(i.strip())\n        elif i.startswith('Hydro'):\n            HydroCol.append(i.strip())\n            \n\n    return RainfallCol,DepthCol,TempCol,VolCol,HydroCol","adf98227":"#feature engineering funtion\u5340\u57df\n#T-1 \/T-2\ndef moreday(data,Columns,days,Dimension):\n    \n    Target = data[Columns]\n    Insertneed = pd.DataFrame(np.zeros([days,Target.shape[1]],dtype=float),columns = Columns)\n    Target = pd.concat([Insertneed,Target]).reset_index(drop = True)\n    Target.drop(Target.tail(days).index,inplace=True)\n    \n    \n    if Dimension == True:\n        from sklearn.manifold import TSNE\n        tsne = TSNE(n_components=2, verbose=1, perplexity=40, n_iter=500)\n        tsne_result = tsne.fit_transform(Target)\n        tsnepd = pd.DataFrame(tsne_result,columns=['SNE_T- {day} (1)'.format(day=days),'SNE_T- {day} (2)'.format(day=days)])\n        tsnepd.reset_index(drop=True, inplace=True)\n        data.reset_index(drop=True, inplace=True)\n        Returndata = pd.concat([data,tsnepd],axis=1)\n    else:\n        Target.reset_index(drop=True, inplace=True)\n        #Target.rename(columns={Columns: 'a'}\n        for df_name in Target:\n            Target.columns = [col_name+'_{day}'.format(day=days) for col_name in Target.columns]\n        Returndata = pd.concat([data,Target],axis=1)\n        \n        \n   \n        \n    return Returndata\n        \n\n#\u5e73\u5747n\u65e5\n\n# def AVG(data,name,day):\n#     day=3\n#     length = len(data[name])\n#     new_name = name + \"_Avg\"\n#     data[new_name] = 0.00\n#     for i in range(length):\n#         if i <=2:\n#             data[new_name][i] = data[name][i]\n#         if i > 2:\n#             data[new_name][i] = data[name][i-int(day\/2)+1:i+int(day\/2)].mean()\n            \n    \ndef season(data):\n    \n    #new column\n    data['Spring'] = 0\n    data['Summer'] = 0\n    data['Autumn'] = 0\n    data['Winter'] = 0\n    #\u7b28\u86cb\u7684\u65b9\u5f0f\n    data.loc[np.logical_and(3 <= data['month'], data['month'] <= 5), 'Spring'] = 1\n    data.loc[np.logical_and(6 <= data['month'], data['month'] <= 8), 'Summer'] = 1\n    data.loc[np.logical_and(9 <= data['month'], data['month'] <= 11), 'Autumn'] = 1\n    data.loc[np.logical_and(12 == data['month'], data['month'] <= 2), 'Winter'] = 1\n    \n\n#\u964d\u7dad\u4e4b\u5f8c\u76f4\u63a5\u8fd4\u56dedataframe\ndef SNEnewcolumn(data,col,compnum,define):\n    from sklearn.manifold import TSNE\n    Target = data[col]\n    dataCNM = data.drop(columns=col)\n    tsne = TSNE(n_components=compnum, verbose=1, perplexity=40, n_iter=500)\n    tsne_result = tsne.fit_transform(Target)\n    tsnepd = pd.DataFrame(tsne_result,columns=['SNE_T- {day} (1)'.format(day=define),'SNE_T- {day} (2)'.format(day=define)])\n    tsnepd.reset_index(drop=True)\n    dataCNM.reset_index(drop=True)\n    Returndata = pd.concat([dataCNM,tsnepd],axis=1)\n    \n    return Returndata\n    \n    \n#\u53d6avg3 \u4e14\u9078\u64c7\u662f\u5426\u964d\u7dad\ndef AVG(data, column, Dimension, define):\n    newname = []\n    for name in column:\n        length = len(data[name])\n        new_name = name + \"_Avg\"\n        data[new_name] = 0.00\n        for i in range(length):\n            if i <= 2:\n                data[new_name][i] = data[name][i]\n            if i > 2:\n                data[new_name][i] = data[name][i - 2:i + 1].mean()\n        newname.append(new_name)\n        # print(data.head(1))\n\n    if Dimension == True:\n        from sklearn.manifold import TSNE\n        Target = data[newname]\n        dataCNM = data.drop(column,axis=1)\n        #print(Target.head(1))\n        tsne = TSNE(n_components=2, verbose=1, perplexity=40, n_iter=500)\n        tsne_result = tsne.fit_transform(Target)\n        tsnepd = pd.DataFrame(tsne_result,\n                              columns=['SNE_T- {day} (1)'.format(day=define), 'SNE_T- {day} (2)'.format(day=define)])\n        tsnepd.reset_index(drop=True)\n        dataCNM.reset_index(drop=True)\n        Returndata = pd.concat([dataCNM, tsnepd], axis=1)\n\n        return Returndata\n","c60dc59d":"# #CSV read for local test\n# Aquifer_Auser = pd.read_csv('Aquifer_Auser.csv')\n# Aquifer_Doganella = pd.read_csv('Aquifer_Doganella.csv')\n# Aquifer_Luco = pd.read_csv('Aquifer_Luco.csv')\n# Aquifer_Petrignano = pd.read_csv('Aquifer_Petrignano.csv')\n# # WaterSpring_Amiata = pd.read_csv('Water_Spring_Amiata.csv')\n# WaterSpring_Lupa = pd.read_csv('Water_Spring_Lupa.csv')\n# WaterSpring_Mandonna = pd.read_csv('Water_Spring_Madonna_di_Canneto.csv')\n# Lake = pd.read_csv('Lake_Bilancino.csv')\n# River = pd.read_csv('River_Arno.csv')\n","22c162c4":"#CSV read\nAquifer_Auser = pd.read_csv('\/kaggle\/input\/acea-water-prediction\/Aquifer_Auser.csv')\nAquifer_Doganella = pd.read_csv('\/kaggle\/input\/acea-water-prediction\/Aquifer_Doganella.csv')\nAquifer_Luco = pd.read_csv('\/kaggle\/input\/acea-water-prediction\/Aquifer_Luco.csv')\nAquifer_Petrignano = pd.read_csv('\/kaggle\/input\/acea-water-prediction\/Aquifer_Petrignano.csv')\nWaterSpring_Amiata = pd.read_csv('\/kaggle\/input\/acea-water-prediction\/Water_Spring_Amiata.csv')\nWaterSpring_Lupa = pd.read_csv('\/kaggle\/input\/acea-water-prediction\/Water_Spring_Lupa.csv')\nWaterSpring_Mandonna = pd.read_csv('\/kaggle\/input\/acea-water-prediction\/Water_Spring_Madonna_di_Canneto.csv')\nLake = pd.read_csv('\/kaggle\/input\/acea-water-prediction\/Lake_Bilancino.csv')\nRiver = pd.read_csv('\/kaggle\/input\/acea-water-prediction\/River_Arno.csv')\n\n","1195952b":"locations = {}\n\nlocations['Settefrati'] = {'lat' : 41.669624, 'lon' : 13.850011 }\nlocations['Velletri'] = {'lat' : 41.6867015, 'lon' : 12.7770433 }\nlocations['Petrignano'] = {'lat' : 43.1029282, 'lon' : 12.5237369 }\nlocations['Piaggione'] = {'lat' : 43.936794, 'lon' : 10.5040929 }\nlocations['S_Fiora'] = {'lat' : 42.854, 'lon' : 11.556 }\nlocations['Abbadia_S_Salvatore'] = {'lat' : 42.8809724, 'lon' : 11.6724203 }\nlocations['Vetta_Amiata'] = {'lat' : 42.8908958, 'lon' : 11.6264863 }\nlocations['Castel_del_Piano'] = {'lat' : 42.8932352, 'lon' : 11.5383804 }\nlocations['Terni'] = {'lat' : 42.6537515, 'lon' : 12.43981163 }\nlocations['Bastia_Umbra'] = {'lat' : 43.0677554, 'lon' : 12.5495816  }\nlocations['S_Savino'] = {'lat' : 43.339, 'lon' : 11.742 }\nlocations['Monteroni_Arbia_Biena'] = {'lat' : 43.228279, 'lon' : 11.4021433 }\nlocations['Monticiano_la_Pineta'] = {'lat' : 43.1335066 , 'lon' : 11.2408464 }\nlocations['Montalcinello'] = {'lat' : 43.1978783, 'lon' : 11.0787906 }\nlocations['Sovicille'] = {'lat' : 43.2806018, 'lon' : 11.2281756 }\nlocations['Simignano'] = {'lat' : 43.2921965, 'lon' : 11.1680079 }\nlocations['Mensano'] = {'lat' : 43.3009594 , 'lon' : 11.0548528 }\nlocations['Siena_Poggio_al_Vento'] = {'lat' : 43.1399762, 'lon' : 11.3832092 }\nlocations['Scorgiano'] = {'lat' : 43.3521445 , 'lon' : 11.15867 }\nlocations['Ponte_Orgia'] = {'lat' : 43.2074581 , 'lon' : 11.2504416 }\nlocations['Pentolina'] = {'lat' : 43.1968029, 'lon' : 11.1754672 }\nlocations['Montevarchi'] = {'lat' : 43.5234999, 'lon' : 11.5675911 }\nlocations['Incisa'] = {'lat' : 43.6558723, 'lon' : 11.4526838 }\nlocations['Camaldoli'] = {'lat' : 43.7943293, 'lon' : 11.8199481 }\nlocations['Bibbiena'] = {'lat' : 43.6955475, 'lon' : 11.817341 }\nlocations['Stia'] = {'lat' : 43.801537, 'lon' : 11.7067347 }\nlocations['Laterina'] = {'lat' : 43.5081823, 'lon' : 11.7102588 }\nlocations['Monteporzio'] = {'lat' : 41.817251, 'lon' : 12.7050839 }\nlocations['Pontetetto'] = {'lat' : 43.8226294, 'lon' : 10.4940843 }\nlocations['Ponte_a_Moriano'] = {'lat' : 43.9083609 , 'lon' : 10.5342488 }\nlocations['Calavorno'] = {'lat' : 44.0217216, 'lon' : 10.5297323 }\nlocations['Borgo_a_Mozzano'] = {'lat' : 43.978948, 'lon' : 10.545703  }\nlocations['Gallicano'] = {'lat' : 44.0606512, 'lon' : 10.435668  }\nlocations['Tereglio_Coreglia_Antelminelli'] = {'lat' : 44.0550548 , 'lon' : 10.5623594 }\nlocations['Lucca_Orto_Botanico'] = {'lat' : 43.84149865, 'lon' : 10.51169066 }\nlocations['Orentano'] = {'lat' : 43.7796506, 'lon' : 10.6583892 }\nlocations['Fabbriche_di_Vallico'] = {'lat' : 43.997647, 'lon' : 10.4279  }\nlocations['Monte_Serra'] = {'lat' : 43.750833, 'lon' : 10.555278 }\nlocations['Mangona'] = {'lat' : 44.0496863, 'lon' : 11.1958797 }\nlocations['Le_Croci'] = {'lat' : 44.0360503, 'lon' : 11.2675661 }\nlocations['Cavallina'] = {'lat' : 43.9833515, 'lon' : 11.2323312 }\nlocations['S_Agata'] = {'lat' : 43.9438247, 'lon' : 11.3089835 }\nlocations['Firenze'] = {'lat' : 43.7698712, 'lon' : 11.2555757 }\nlocations['S_Piero'] = {'lat' : 43.9637372, 'lon' : 11.3182991 }\nlocations['Vernio'] = {'lat' : 44.0440508 , 'lon' : 11.1498804  }\nlocations['Consuma'] = {'lat' : 43.784, 'lon' : 11.585 }\nlocations['Croce_Arcana']  = {'lat' : 44.1323056, 'lon' : 10.7689152 }\nlocations['Laghetto_Verde']  = {'lat' :   42.883, 'lon' : 11.662  }\n\nlocations_df = pd.DataFrame(columns=['city', 'lat', 'lon'] )\n\ndef get_location_coordinates(df, column_type, cluster, target_df):\n    for location in df.columns[df.columns.str.startswith(column_type)]:\n        location = location.split(column_type)[1]\n\n        loc_dict = {}\n        loc_dict['city'] = location\n        loc_dict['cluster'] = cluster\n        loc_dict['lat'] = locations[location]['lat']\n        loc_dict['lon'] = locations[location]['lon']\n\n        target_df = target_df.append(loc_dict, ignore_index=True)\n\n    return target_df\n\nlocations_df = get_location_coordinates(Aquifer_Auser, 'Temperature_', 'Aquifer_Auser', locations_df)\nlocations_df = get_location_coordinates(Aquifer_Auser, 'Rainfall_', 'Aquifer_Auser', locations_df)\n\nlocations_df = get_location_coordinates(Aquifer_Doganella , 'Temperature_', 'Aquifer_Doganella ', locations_df)\nlocations_df = get_location_coordinates(Aquifer_Doganella , 'Rainfall_', 'Aquifer_Doganella ', locations_df)\n\nlocations_df = get_location_coordinates(Aquifer_Luco , 'Temperature_', 'Aquifer_Luco ', locations_df)\nlocations_df = get_location_coordinates(Aquifer_Luco , 'Rainfall_', 'Aquifer_Luco ', locations_df)\n\nlocations_df = get_location_coordinates(Aquifer_Petrignano , 'Temperature_', 'Aquifer_Petrignano ', locations_df)\nlocations_df = get_location_coordinates(Aquifer_Petrignano , 'Rainfall_', 'Aquifer_Petrignano ', locations_df)\n\nlocations_df = get_location_coordinates(Lake , 'Temperature_', 'Lake ', locations_df)\nlocations_df = get_location_coordinates(Lake , 'Rainfall_', 'Lake ', locations_df)\n\nlocations_df = get_location_coordinates(River , 'Temperature_', 'River ', locations_df)\nlocations_df = get_location_coordinates(River , 'Rainfall_', 'River ', locations_df)\n\nlocations_df = get_location_coordinates(WaterSpring_Amiata , 'Temperature_', 'WaterSpring_Amiata ', locations_df)\nlocations_df = get_location_coordinates(WaterSpring_Amiata , 'Rainfall_', 'WaterSpring_Amiata ', locations_df)\n\nlocations_df = get_location_coordinates(WaterSpring_Lupa , 'Temperature_', 'WaterSpring_Lupa ', locations_df)\nlocations_df = get_location_coordinates(WaterSpring_Lupa , 'Rainfall_', 'WaterSpring_Lupa  spring_lupa_df', locations_df)\n\nlocations_df = get_location_coordinates(WaterSpring_Mandonna, 'Temperature_', 'WaterSpring_Mandonna', locations_df)\nlocations_df = get_location_coordinates(WaterSpring_Mandonna, 'Rainfall_', 'WaterSpring_Mandonna', locations_df)\n\n# Drop duplicates\nlocations_df = locations_df.sort_values(by='city').drop_duplicates().reset_index(drop=True)\ngdf_acea = gpd.GeoDataFrame(locations_df, geometry=gpd.points_from_xy(locations_df.lon, locations_df.lat))\n\nall_water_bodies = locations_df['cluster'].unique().tolist()\nloc_df = locations_df.sort_values(by='cluster').set_index(keys=['cluster'], drop=False)","35c961dc":"colors = sns.color_palette(\"husl\", len(all_water_bodies)) # colors for differnet water bodies\nworld = gpd.read_file(\n    gpd.datasets.get_path('naturalearth_lowres')\n)\nitaly = world.query('name == \"Italy\"') # chosoe italy","cebc40f0":"fig, ax = plt.subplots(figsize=(12,12), subplot_kw={'projection': gcrs.WebMercator()})\nfor i, body in enumerate(all_water_bodies):\n    geoplot.pointplot(gdf_acea[gdf_acea[\"cluster\"] == body], ax=ax, label=\"%s\"%(body.replace(\"_df\",\"\").replace(\"_\", \" \")), color=colors[i], s=5.5, extent=[9,35,19,42])\ngeoplot.webmap(italy, projection=gcrs.WebMercator(),ax=ax)\nplt.legend(loc='upper right', frameon=True, fontsize=12)\nplt.show()","2b5f3110":"Lake.info()","c2c334b3":"#date transformation\ntime(Lake)","de66e750":"Lake.head()","0aef8087":"msno.heatmap(Lake)","cee61958":"f, ax = plt.subplots(nrows=1, ncols=1, figsize=(16,5))\nsns.heatmap(Lake.T.isna(), cmap='Blues')\nax.set_title('Fields with Missing Values', fontsize=16)\n#for tick in ax.xaxis.get_major_ticks():\n#    tick.label.set_fontsize(14) \nfor tick in ax.yaxis.get_major_ticks():\n    tick.label.set_fontsize(14)\nplt.show()","0ffd69cc":"corr_plot(Lake)","c8514557":"vis(Lake)\n#sns.lineplot(x=Lake.Date, y='Rainfall_S_Piero', data=Lake)","de5b1388":"list_col = Lake.columns.tolist()\nlist_col","fa85b6c3":"#drop LakeNa \u56e0\u70banull\u90fd\u51fa\u73fe\u5728\u524d\u534a\u6bb5\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u5e36\u8d70\nLake = Lake.dropna() \nLake=Lake.reset_index(drop=True)","2e3e3467":"#\u6709\u6642\u5019\u505afeature\u7684\u6216\u8005\u5e36\u51fd\u6578\u8981col\u5c31\u76f4\u63a5\u5e36 \u4e0d\u80fd\u7528yet\nRainfallCol,DepthCol,TempCol,VolCol,HyrdoCol = takecolumn(Lake)\nprint(RainfallCol)\n#col = ['Rainfall_S_Piero','Rainfall_Mangona','Rainfall_S_Agata','Rainfall_Le_Croci']\n#print(col)","9809b1c7":"#add more T-1 and T-2\n#col = ['Rainfall_S_Piero','Rainfall_Mangona','Rainfall_S_Agata','Rainfall_Le_Croci']\nLake = moreday(Lake,RainfallCol,days=1,Dimension = True)\nLake = moreday(Lake,RainfallCol,days=2,Dimension = True)\nLake.head()","99d01517":"#3-dayAVG\nLake = AVG(Lake,RainfallCol,True,'RainvallAVG')","dc4c58bd":"AVG(Lake,TempCol,False,None)","cf3aadd0":"#\u52a0season\nseason(Lake)","6315f1a6":"#\u5f9eRiver\u88e1\u62c9feature\nRiver_level=River.iloc[2192:,-1]\nLake.reset_index(drop=True, inplace = True)\nRiver_level.reset_index(drop=True, inplace = True)\nLake = pd.concat([Lake,River_level],axis=1)\nLake = Lake.dropna()","691b9db2":"Lake.info()","c56b1193":"#\u9078\u64c7\u7684feature\nFinalLake = Lake.drop(['Date','Flow_Rate','Rainfall_S_Piero_Avg','Rainfall_Mangona_Avg','Rainfall_S_Agata_Avg','Rainfall_Cavallina_Avg','Rainfall_Le_Croci_Avg','day'],axis=1)\nFinalFlow = Lake.drop(['Date','Lake_Level','Rainfall_S_Piero_Avg','Rainfall_Mangona_Avg','Rainfall_S_Agata_Avg','Rainfall_Cavallina_Avg','Rainfall_Le_Croci_Avg','day'],axis=1)","696b0be4":"from pycaret.regression import * \n\nexp_reg = setup(FinalLake,target='Lake_Level',session_id=13,use_gpu=True,feature_selection = True)\nset_config('seed', 123)","6515b145":"bestLake = compare_models(exclude = ['ransac'], n_select = 3)","531af00b":"et = create_model('et')\ntuned_Lakeet = tune_model(et,n_iter=100)","0846c1f0":"print(tuned_Lakeet)","c15dae94":"save_model(tuned_Lakeet,'tuned_Lakeet for LakeLevel')","aaad597d":"exp_reg = setup(FinalFlow,target='Flow_Rate',session_id=13,use_gpu=True,feature_selection = True)\nset_config('seed', 123)","ac5a7a8f":"bestFlow = compare_models(exclude = ['ransac'], n_select = 3)","823bd0bc":"cat = create_model('catboost')\ntuned_Lakecat = tune_model(cat,n_iter=10)","83cc7132":"print(tuned_Lakecat)","2709dc66":"save_model(tuned_Lakecat,'tuned_Lakecat for Lake_FlowRate')","67c43be9":"River.info()","af3fe6f2":"time(River)","8372622f":"msno.heatmap(River)","8d8a7632":"f, ax = plt.subplots(nrows=1, ncols=1, figsize=(16,5))\nsns.heatmap(River.T.isna(), cmap='Blues')\nax.set_title('Fields with Missing Values', fontsize=16)\n#for tick in ax.xaxis.get_major_ticks():\n#    tick.label.set_fontsize(14) \nfor tick in ax.yaxis.get_major_ticks():\n    tick.label.set_fontsize(14)\nplt.show()","5f4bf620":"corr_plot(River)","25477b26":"vis(River)","b57be081":"#get River column\nRainfallCol,DepthCol,TempCol,VolCol,HyrdoCol = takecolumn(River)","fbbf228d":"River.info()","9c19af6f":"#\u586b\u88dcRiver Temperature\u7f3a\u5931\u503c\nTempPre_River = River.groupby(['month','day'],as_index=False).agg({'Temperature_Firenze':'mean'})\nRiver= pd.merge(River,TempPre_River, how='left' ,left_on=['month','day'], right_on=['month','day'])\nRiver.Temperature_Firenze_x.fillna(River.Temperature_Firenze_y, inplace=True)\nRiver = River.drop(columns=['Temperature_Firenze_y'])","27f503d2":"#River \u9078\u64c7\u6578\u64da\u4e14drop\nRiver = River.iloc[2191:8127,:]\nRiver = River.drop(columns=['Rainfall_Stia',\n 'Rainfall_Consuma',\n 'Rainfall_Incisa',\n 'Rainfall_Montevarchi',\n 'Rainfall_S_Savino',\n 'Rainfall_Laterina',\n'Rainfall_Vernio',\n 'Rainfall_Bibbiena',\n 'Rainfall_Camaldoli'])","469cf5c4":"#River\u589e\u52a0season\nseason(River)","49c444c3":"#\u5c0dRainfall\u9032\u884c\u964d\u7dad\nRainfallCol,DepthCol,TempCol,VolCol,HyrdoCol = takecolumn(River)\nRiver= River.reset_index(drop=True)\nRiver = AVG(River,RainfallCol,True,'RainfallAVG')","df992f6b":"print(RainfallCol)","fb6066c3":"River = River.dropna()\nRiver= River.drop(columns = ['Rainfall_Le_Croci_Avg','Date','Rainfall_Cavallina_Avg','Rainfall_S_Agata_Avg','Rainfall_Mangona_Avg','Rainfall_S_Piero_Avg'])\nRiver.info()","382b7783":"from pycaret.regression import * \n\nexp_reg = setup(River,target='Hydrometry_Nave_di_Rosano',session_id=13,feature_selection = True,remove_multicollinearity = True,use_gpu = True)","d3037f9f":"bestRiver = compare_models(exclude = ['ransac'])","0a7a69f3":"cat = create_model('et')\ntuned_Riveret = tune_model(cat,n_iter=10)\nprint(tuned_Riveret)","579cf8a8":"save_model(tuned_Riveret,'Hydrometry_Nave_di_Rosano for River')","4e243475":"WaterSpring_Mandonna.info()","2c756c66":"#drop null for time function\nWaterSpring_Mandonna = WaterSpring_Mandonna.dropna(subset=['Date'])\ntime(WaterSpring_Mandonna)","2548a479":"WaterSpring_Mandonna.head()","a2a99aef":"msno.heatmap(WaterSpring_Mandonna)","2d32daf5":"f, ax = plt.subplots(nrows=1, ncols=1, figsize=(16,5))\nsns.heatmap(WaterSpring_Mandonna.T.isna(), cmap='Blues')\nax.set_title('Fields with Missing Values', fontsize=16)\n#for tick in ax.xaxis.get_major_ticks():\n#    tick.label.set_fontsize(14) \nfor tick in ax.yaxis.get_major_ticks():\n    tick.label.set_fontsize(14)\nplt.show()","513e2bc2":"corr_plot(WaterSpring_Mandonna)","5d023d05":"vis(WaterSpring_Mandonna)","f8cbc8be":"#\u586b\u88dcMandonna Temperature\u7f3a\u5931\u503c(\u53ef\u4ee5\u7528\u6240\u6709\u5e74\u96e8\u91cf\u4f86\u586b\u88dc)\nTempPre_Mandonna = WaterSpring_Mandonna.groupby(['month','day'],as_index=False).agg({'Temperature_Settefrati':'mean'})\nWaterSpring_Mandonna= pd.merge(WaterSpring_Mandonna,TempPre_Mandonna, how='left' ,left_on=['month','day'], right_on=['month','day'])\nWaterSpring_Mandonna.Temperature_Settefrati_x.fillna(WaterSpring_Mandonna.Temperature_Settefrati_y, inplace=True)\nWaterSpring_Mandonna = WaterSpring_Mandonna.drop(columns=['Temperature_Settefrati_y'])","a4b21f81":"#\u586b\u88dcMandonna Temperature\u7f3a\u5931\u503c(\u53ef\u4ee5\u7528\u6240\u6709\u5e74\u4f86\u586b\u88dc)\nTempPre_Mandonna = WaterSpring_Mandonna.groupby(['month','day'],as_index=False).agg({'Rainfall_Settefrati':'mean'})\nWaterSpring_Mandonna= pd.merge(WaterSpring_Mandonna,TempPre_Mandonna, how='left' ,left_on=['month','day'], right_on=['month','day'])\nWaterSpring_Mandonna.Rainfall_Settefrati_x.fillna(WaterSpring_Mandonna.Rainfall_Settefrati_y, inplace=True)\nWaterSpring_Mandonna = WaterSpring_Mandonna.drop(columns=['Rainfall_Settefrati_y'])","3fca3b28":"#T+1\nWaterSpring_Mandonna = moreday(WaterSpring_Mandonna,['Rainfall_Settefrati_x'],1,False)        ","8e7716cc":"#T+2\nWaterSpring_Mandonna = moreday(WaterSpring_Mandonna,['Rainfall_Settefrati_x'],2,False)        ","a524af4a":"WaterSpring_Mandonna=WaterSpring_Mandonna.dropna(subset=['Flow_Rate_Madonna_di_Canneto'])","6508d733":"WaterSpring_Mandonna.info()","88ec90bb":"season(WaterSpring_Mandonna)","25ee4ec8":"WaterSpring_Mandonna = WaterSpring_Mandonna.drop(columns=['Date'])","1a904fc6":"from pycaret.regression import * \n\nexp_reg = setup(WaterSpring_Mandonna,target='Flow_Rate_Madonna_di_Canneto',session_id=13,feature_selection = True,remove_multicollinearity = True,use_gpu = True)","d939ceaf":"bestMandonna = compare_models(exclude = ['ransac'])","036f18f3":"cat = create_model('catboost')\ntuned_Mandonnacat = tune_model(cat,n_iter=10)","ee767d15":"save_model(tuned_Mandonnacat,'tuned_flow_rate for Mandonnacat')","228d39e8":"WaterSpring_Lupa.info()","151d07dc":"time(WaterSpring_Lupa)","e8291885":"corr_plot(WaterSpring_Lupa)","533443ff":"vis(WaterSpring_Lupa)","327d48f9":"WaterSpring_Lupa = WaterSpring_Lupa.dropna()","53c1b0e1":"WaterSpring_Lupa.reset_index(drop=True)","c7f929a0":"#t-1\u8655\u7406\nWaterSpring_Lupa = moreday(WaterSpring_Lupa,['Rainfall_Terni'],1,False)","90eedf67":"#t-2\u8655\u7406\nWaterSpring_Lupa = moreday(WaterSpring_Lupa,['Rainfall_Terni'],2,False)","89933a48":"season(WaterSpring_Lupa)","9d4de092":"WaterSpring_Lupa = WaterSpring_Lupa.drop(columns=['Date'])","2921395f":"from pycaret.regression import * \n\nexp_reg = setup(WaterSpring_Lupa,target='Flow_Rate_Lupa',session_id=13,feature_selection = True,remove_multicollinearity = True,use_gpu = True)","0fb29ef1":"bestLupa = compare_models(exclude = ['ransac'])","2c8f3f0a":"et = create_model('et')\ntuned_Lupaet = tune_model(et,n_iter=10)","6c6b21fd":"print(tuned_Lupaet)","25809294":"save_model(tuned_Lupaet,'Flow_Rate_Lupa for Lupa')","361d179a":"WaterSpring_Amiata.info()","d5d8b657":"time(WaterSpring_Amiata)","d424df8e":"f, ax = plt.subplots(nrows=1, ncols=1, figsize=(16,5))\nsns.heatmap(WaterSpring_Amiata.T.isna(), cmap='Blues')\nax.set_title('Fields with Missing Values', fontsize=16)\n#for tick in ax.xaxis.get_major_ticks():\n#    tick.label.set_fontsize(14) \nfor tick in ax.yaxis.get_major_ticks():\n    tick.label.set_fontsize(14)\nplt.show()","608883f8":"vis(WaterSpring_Amiata)","8e642cc7":"WaterSpring_Amiata.isnull().sum()","745ec5ab":"#\u63d2\u503c\u6cd5\u5f25\u8865Depth\u7f3a\u5931\u503c\nWaterSpring_Amiata['Depth_to_Groundwater_S_Fiora_8']= WaterSpring_Amiata['Depth_to_Groundwater_S_Fiora_8'].interpolate()\nWaterSpring_Amiata['Depth_to_Groundwater_S_Fiora_11bis']= WaterSpring_Amiata['Depth_to_Groundwater_S_Fiora_11bis'].interpolate()\nWaterSpring_Amiata['Depth_to_Groundwater_David_Lazzaretti']= WaterSpring_Amiata['Depth_to_Groundwater_David_Lazzaretti'].interpolate()","7a7c487f":"#\u66ff\u6362\u7f3a\u5931\u503c\u4e3a\u4e00\u5e74\u524d\u7684\u5f53\u524d\u503c\u7684\u4e09\u65e5\u7684\u5e73\u5747\nname_start_index = 1\nfor name in ['Rainfall_Castel_del_Piano','Rainfall_Abbadia_S_Salvatore','Rainfall_S_Fiora',\n     'Rainfall_Laghetto_Verde','Rainfall_Vetta_Amiata']:\n    ls = WaterSpring_Amiata.loc[WaterSpring_Amiata[name].isnull()==True].index.tolist()\n    \n    for i in ls:\n        if(i - 365) > 0:\n            WaterSpring_Amiata.iloc[i,name_start_index] = WaterSpring_Amiata.iloc[i-366:i-363,name_start_index].mean()\n    \n    name_start_index = name_start_index + 1","50236818":"#\u66ff\u6362\u7f3a\u5931\u503c\u4e3a\u4e00\u5e74\u524d\u7684\u5f53\u524d\u503c\u4e3atemperature\nls = WaterSpring_Amiata.loc[WaterSpring_Amiata['Temperature_Abbadia_S_Salvatore'].isnull()==True].index.tolist()\nfor i in ls:\n    if (i - 365) > 0:\n        WaterSpring_Amiata.iloc[i,9] = WaterSpring_Amiata.iloc[i-365,9]","8cd2fb38":"Amiatafull = WaterSpring_Amiata.dropna(subset=['Flow_Rate_Bugnano','Flow_Rate_Arbure','Flow_Rate_Ermicciolo','Flow_Rate_Galleria_Alta'])","cf1207bd":"Amiatafull = Amiatafull.reset_index(drop=True)","0279b142":"Amiatafull.isnull().sum()","4d4cee2e":"Amiatafull.loc[Amiatafull['Temperature_Laghetto_Verde'].isnull()==True]","ff37f069":"Amiatafull.iloc[729]['Temperature_Laghetto_Verde']","e05d6255":"#\u88dc\u4e0a\u7f3a\u5931\u7684\u7279\u5b9a\u4e09\u500btemperature\nAmiatafull.iloc[723,-7]= 3.95\nAmiatafull.iloc[724,-7]= 3.95\nAmiatafull.iloc[728,-7] = 0.35","984c78f5":"RainfallCol,DepthCol,TempCol,VolCol,HyrdoCol = takecolumn(Amiatafull)","8129630d":"#AVG days\nAVG(Amiatafull,RainfallCol,False,'Rainfall')","e2c42a04":"#T+1\nAmiatafull = moreday(Amiatafull,RainfallCol,1,False)","6933e75c":"#T+2\nAmiatafull = moreday(Amiatafull,RainfallCol,2,False)","ca05ad6b":"print(DepthCol)","8d9a3ad8":"Amiatafull = SNEnewcolumn(Amiatafull,DepthCol,2,'Depth')","bfa2cd16":"AmiataBugnano = Amiatafull.drop(columns=['Flow_Rate_Arbure','Flow_Rate_Ermicciolo','Flow_Rate_Galleria_Alta','Date'])\nAmiataArbure = Amiatafull.drop(columns=['Flow_Rate_Bugnano','Flow_Rate_Ermicciolo','Flow_Rate_Galleria_Alta','Date'])\nAmiataErmicciolo = Amiatafull.drop(columns=['Flow_Rate_Bugnano','Flow_Rate_Arbure','Flow_Rate_Galleria_Alta','Date'])\nAmiataAlta = Amiatafull.drop(columns=['Flow_Rate_Bugnano','Flow_Rate_Arbure','Flow_Rate_Ermicciolo','Date'])","0dbb59e7":"from pycaret.regression import * \n\nexp_reg = setup(AmiataBugnano,target='Flow_Rate_Bugnano',session_id=13,feature_selection = True,remove_multicollinearity = True,use_gpu = True)","65e97d49":"bestbugnano = compare_models(exclude = ['ransac'])","ef01679e":"et = create_model('et')\ntuned_Bugnanoet = tune_model(et,n_iter=10)","0d3ca591":"print(tuned_Bugnanoet)","723096ca":"save_model(tuned_Bugnanoet,'Flow_Rate_Bugnano for Amiata')","209df9ee":"exp_reg = setup(AmiataArbure,target='Flow_Rate_Arbure',session_id=13,feature_selection = True,remove_multicollinearity = True,use_gpu = True)","e214bd5d":"bestArbure = compare_models(exclude=['ransac'])","8412e422":"et = create_model('et')\ntuned_Arbruecat = tune_model(et,n_iter=10)","f562d718":"save_model(tuned_Arbruecat,'Flow_Rate_Arbure for Amiata')","4a7974fc":"from pycaret.regression import * \n\nexp_reg = setup(AmiataErmicciolo,target='Flow_Rate_Ermicciolo',session_id=13,feature_selection = True,remove_multicollinearity = True,use_gpu = True)","c8448e68":"bestErimicciolo = compare_models(exclude = ['ransac'])","581390a6":"et = create_model('et')\ntuned_Emiriet = tune_model(et,n_iter=10)","34c1fe4f":"print(tuned_Emiriet)","457f2640":"save_model(tuned_Emiriet,'Flow_Rate_Ermicciolo for Amita')","7f2b4ad6":"from pycaret.regression import * \n\nexp_reg = setup(AmiataAlta,target='Flow_Rate_Galleria_Alta',session_id=13,feature_selection = True,remove_multicollinearity = True,use_gpu = True)","dc8a1007":"bestAlta = compare_models(exclude = ['ransac'])","d0a28776":"cat = create_model('catboost')\ntuned_Alta = tune_model(cat,n_iter=10)","b41e0529":"save_model(tuned_Alta,'Flow_Rate_Galleria_Alta for Amiata')","6f7d391c":"Aquifer_Auser.info()","f39fecdb":"f, ax = plt.subplots(nrows=1, ncols=1, figsize=(25,15))\nsns.heatmap(Aquifer_Auser.T.isna(), cmap='Blues')\nax.set_title('Fields with Missing Values', fontsize=16)\n#for tick in ax.xaxis.get_major_ticks():\n#    tick.label.set_fontsize(14) \nfor tick in ax.yaxis.get_major_ticks():\n    tick.label.set_fontsize(14)\nplt.show()","87993d6e":"time(Aquifer_Auser)","67316173":"corr_plot(Aquifer_Auser)","2e608677":"vis(Aquifer_Auser)","77835e2e":"#replace the 0 into nan\nAquifer_Auser['Volume_CSA'] = Aquifer_Auser['Volume_CSA'].replace([0],np.nan)","988f5d3e":"Aquifer_Auser['Temperature_Ponte_a_Moriano'] = Aquifer_Auser['Temperature_Ponte_a_Moriano'].replace([0],np.nan)","a03459df":"#fill temperature missing value\n#\u586b\u88dcMandonna Temperature\u7f3a\u5931\u503c(\u53ef\u4ee5\u7528\u6240\u6709\u5e74\u96e8\u91cf\u4f86\u586b\u88dc)\n\nTempPre_Auser = Aquifer_Auser.groupby(['month','day'],as_index=False).agg({'Temperature_Ponte_a_Moriano':'mean'})\nAquifer_Auser= pd.merge(Aquifer_Auser,TempPre_Auser, how='left' ,left_on=['month','day'], right_on=['month','day'])\nAquifer_Auser.Temperature_Ponte_a_Moriano_x.fillna(Aquifer_Auser.Temperature_Ponte_a_Moriano_y, inplace=True)\nAquifer_Auser = Aquifer_Auser.drop(columns=['Temperature_Ponte_a_Moriano_y'])","326733f0":"#we would like to keep data after 2017\nAuserna = Aquifer_Auser.dropna(subset = ['Volume_CSA'])","cd33dad8":"f, ax = plt.subplots(nrows=1, ncols=1, figsize=(25,15))\nsns.heatmap(Auserna.T.isna(), cmap='Blues')\nax.set_title('Fields with Missing Values', fontsize=16)\n#for tick in ax.xaxis.get_major_ticks():\n#    tick.label.set_fontsize(14) \nfor tick in ax.yaxis.get_major_ticks():\n    tick.label.set_fontsize(14)\nplt.show()","bd90529e":"vis(Auserna)","eaea2d07":"#fill temperature missing value\n#\u586b\u88dcDIEC\u7f3a\u5931\u503c(\u53ef\u4ee5\u7528\u6240\u6709\u5e74\u96e8\u91cf\u4f86\u586b\u88dc)\n\nTempPre_Auser = Auserna.groupby(['month','day'],as_index=False).agg({'Depth_to_Groundwater_DIEC':'mean'})\nAuserna= pd.merge(Auserna,TempPre_Auser, how='left' ,left_on=['month','day'], right_on=['month','day'])\nAuserna.Depth_to_Groundwater_DIEC_x.fillna(Auserna.Depth_to_Groundwater_DIEC_y, inplace=True)\nAuserna = Auserna.drop(columns=['Depth_to_Groundwater_DIEC_y'])","842df529":"#fill temperature missing value\n#\u586b\u88dcPAG\u7f3a\u5931\u503c(\u53ef\u4ee5\u7528\u6240\u6709\u5e74\u96e8\u91cf\u4f86\u586b\u88dc)\n\nTempPre_Auser = Auserna.groupby(['month','day'],as_index=False).agg({'Depth_to_Groundwater_PAG':'mean'})\nAuserna= pd.merge(Auserna,TempPre_Auser, how='left' ,left_on=['month','day'], right_on=['month','day'])\nAuserna.Depth_to_Groundwater_PAG_x.fillna(Auserna.Depth_to_Groundwater_PAG_y, inplace=True)\nAuserna = Auserna.drop(columns=['Depth_to_Groundwater_PAG_y'])","eb75452a":"#\u5dee\u503c\u88dc\u7f3a\u6cd5\u5247\nAuserna['Hydrometry_Monte_S_Quirico']= Auserna['Hydrometry_Monte_S_Quirico'].interpolate()\nAuserna['Hydrometry_Piaggione']= Auserna['Hydrometry_Piaggione'].interpolate()","94da2b85":"Auserna = Auserna.dropna(subset=['Depth_to_Groundwater_LT2','Depth_to_Groundwater_CoS','Depth_to_Groundwater_SAL'])","4ced64f1":"#\u770b\u770b\u6709\u6c92\u6709\u9ad8\u76f8\u95dc\u7684 \u7136\u5f8c\u5c0d\u5176\u505a\u5c07\u7dad\u5ea6\ncorr_plot(Auserna)","a9f7e0e6":"RainfallCol,DepthCol,TempCol,VolCol,HyrdoCol = takecolumn(Auserna)","e59ee767":"#Rainfall T+1\nAuserna = moreday(Auserna,['Rainfall_Gallicano', 'Rainfall_Pontetetto', 'Rainfall_Monte_Serra', 'Rainfall_Orentano', 'Rainfall_Borgo_a_Mozzano', 'Rainfall_Piaggione', 'Rainfall_Calavorno', 'Rainfall_Fabbriche_di_Vallico'],1,True)","d5b514f3":"#Rainfall T+2\nAuserna = moreday(Auserna,['Rainfall_Gallicano', 'Rainfall_Pontetetto', 'Rainfall_Monte_Serra', 'Rainfall_Orentano', 'Rainfall_Borgo_a_Mozzano', 'Rainfall_Piaggione', 'Rainfall_Calavorno', 'Rainfall_Fabbriche_di_Vallico'],2,True)","84881fb7":"#Rainfall\u964d\u70ba\nAuserna = SNEnewcolumn(Auserna,['Rainfall_Gallicano', 'Rainfall_Pontetetto', 'Rainfall_Monte_Serra', 'Rainfall_Orentano', 'Rainfall_Borgo_a_Mozzano', 'Rainfall_Piaggione', 'Rainfall_Calavorno', 'Rainfall_Fabbriche_di_Vallico'],2,'RainfallT0')","e84b8c50":"#temp\u964d\u70ba\nAuserna = SNEnewcolumn(Auserna,['Temperature_Monte_Serra', 'Temperature_Ponte_a_Moriano_x', 'Temperature_Lucca_Orto_Botanico'],2,'temp')","984ad9cd":"#hyrdo \u964d\u7dad\nAuserna = SNEnewcolumn(Auserna,['Hydrometry_Monte_S_Quirico', 'Hydrometry_Piaggione'],2,'Hyrdo')","5868e244":"Auserna.info()","e52649dd":"LT2 = Auserna.drop(columns=['Date','Depth_to_Groundwater_SAL','Depth_to_Groundwater_CoS'])\nSAL = Auserna.drop(columns=['Date','Depth_to_Groundwater_LT2','Depth_to_Groundwater_CoS'])\nCoS = Auserna.drop(columns=['Date','Depth_to_Groundwater_SAL','Depth_to_Groundwater_LT2'])","77558c75":"from pycaret.regression import * \n\nexp_reg = setup(LT2,target='Depth_to_Groundwater_LT2',session_id=13,feature_selection = True,remove_multicollinearity = True,use_gpu = True)","d80dfb9d":"bestLT2 = compare_models(exclude = ['ransac'])","59743980":"model = create_model('lightgbm')\ntuned_LT2 = tune_model(et,n_iter=10)\nsave_model(tuned_LT2,'tuned_LT2 for Auser')","42ea5024":"print(tuned_LT2)","964f2dd2":"from pycaret.regression import * \n\nexp_reg = setup(SAL,target='Depth_to_Groundwater_SAL',session_id=13,feature_selection = True,remove_multicollinearity = True,use_gpu = True)","f20e99ce":"bestSAL = compare_models(exclude = ['ransac'])","545fe4d5":"model = create_model('et')\ntuned_SAL = tune_model(et,n_iter=10)\nsave_model(tuned_SAL,'tuned_SAL for Auser')","6e98917c":"print(tuned_SAL)","88baadf3":"from pycaret.regression import * \n\nexp_reg = setup(CoS,target='Depth_to_Groundwater_CoS',session_id=13,feature_selection = True,remove_multicollinearity = True,use_gpu = True)","ca120072":"bestCoS = compare_models(exclude = ['ransac'])","a4ddb905":"model = create_model('et')\ntuned_CoS = tune_model(et,n_iter=10)\nsave_model(tuned_CoS,'tuned_CoS for Auser')","6a60deb5":"print(tuned_CoS)","853043d5":"Aquifer_Doganella.info()","0bf121e1":"f, ax = plt.subplots(nrows=1, ncols=1, figsize=(25,15))\nsns.heatmap(Aquifer_Doganella.T.isna(), cmap='Blues')\nax.set_title('Fields with Missing Values', fontsize=16)\n#for tick in ax.xaxis.get_major_ticks():\n#    tick.label.set_fontsize(14) \nfor tick in ax.yaxis.get_major_ticks():\n    tick.label.set_fontsize(14)\nplt.show()","35222e8f":"corr_plot(Aquifer_Doganella)","be8a6546":"time(Aquifer_Doganella)","5d577867":"vis(Aquifer_Doganella)","53325a2a":"Aquifer_Doganella['year'] = Aquifer_Doganella['Date'].apply(lambda x: int(x.year))","aadaf0ed":"#\u5c0715-18\u6578\u64da\u8a2d\u70banan\u518d\u4f5c\u5f8c\u671f\u8655\u7406\nAquifer_Doganella['Rainfall_Monteporzio'].loc[Aquifer_Doganella['year']==2015] =np.nan\nAquifer_Doganella['Rainfall_Monteporzio'].loc[Aquifer_Doganella['year']==2016] =np.nan\nAquifer_Doganella['Rainfall_Monteporzio'].loc[Aquifer_Doganella['year']==2017] =np.nan\nAquifer_Doganella['Rainfall_Monteporzio'].loc[Aquifer_Doganella['year']==2018] =np.nan\nAquifer_Doganella['Rainfall_Velletri'].loc[Aquifer_Doganella['year']==2015] =np.nan\nAquifer_Doganella['Rainfall_Velletri'].loc[Aquifer_Doganella['year']==2016] =np.nan\nAquifer_Doganella['Rainfall_Velletri'].loc[Aquifer_Doganella['year']==2017] =np.nan\nAquifer_Doganella['Rainfall_Velletri'].loc[Aquifer_Doganella['year']==2018] =np.nan","737be9ab":"#fill Rainfall missing value #Rainfall_Monteporzio\n\nTempPre_Dog = Aquifer_Doganella.groupby(['month','day'],as_index=False).agg({'Rainfall_Monteporzio':'mean'})\nAquifer_Doganella= pd.merge(Aquifer_Doganella,TempPre_Dog, how='left' ,left_on=['month','day'], right_on=['month','day'])\nAquifer_Doganella.Rainfall_Monteporzio_x.fillna(Aquifer_Doganella.Rainfall_Monteporzio_y, inplace=True)\nAquifer_Doganella = Aquifer_Doganella.drop(columns=['Rainfall_Monteporzio_y'])","6574c1f7":"#fill Rainfall missing value #Rainfall_Velletri\n\nTempPre_Dog = Aquifer_Doganella.groupby(['month','day'],as_index=False).agg({'Rainfall_Velletri':'mean'})\nAquifer_Doganella= pd.merge(Aquifer_Doganella,TempPre_Dog, how='left' ,left_on=['month','day'], right_on=['month','day'])\nAquifer_Doganella.Rainfall_Velletri_x.fillna(Aquifer_Doganella.Rainfall_Velletri_y, inplace=True)\nAquifer_Doganella = Aquifer_Doganella.drop(columns=['Rainfall_Velletri_y'])","eada2eb3":"#fill Temperature missing value #Temperature_Monteporzio\n\nTempPre_Dog = Aquifer_Doganella.groupby(['month','day'],as_index=False).agg({'Temperature_Monteporzio':'mean'})\nAquifer_Doganella= pd.merge(Aquifer_Doganella,TempPre_Dog, how='left' ,left_on=['month','day'], right_on=['month','day'])\nAquifer_Doganella.Temperature_Monteporzio_x.fillna(Aquifer_Doganella.Temperature_Monteporzio_y, inplace=True)\nAquifer_Doganella = Aquifer_Doganella.drop(columns=['Temperature_Monteporzio_y'])","6a0d8ad1":"#fill Temperature missing value #Temperature_Velletri\n\nTempPre_Dog = Aquifer_Doganella.groupby(['month','day'],as_index=False).agg({'Temperature_Velletri':'mean'})\nAquifer_Doganella= pd.merge(Aquifer_Doganella,TempPre_Dog, how='left' ,left_on=['month','day'], right_on=['month','day'])\nAquifer_Doganella.Temperature_Velletri_x.fillna(Aquifer_Doganella.Temperature_Velletri_y, inplace=True)\nAquifer_Doganella = Aquifer_Doganella.drop(columns=['Temperature_Velletri_y'])","11e38adf":"RainfallCol,DepthCol,TempCol,VolCol,HyrdoCol = takecolumn(Aquifer_Doganella)","7c995279":"print(DepthCol)","0ba66fc7":"#\u5207\u5230\u53ea\u5269\u4e0bVolume\u6709\u7684\u90e8\u5206\nDogna = Aquifer_Doganella.dropna(subset=['Depth_to_Groundwater_Pozzo_1', 'Depth_to_Groundwater_Pozzo_2', 'Depth_to_Groundwater_Pozzo_3', 'Depth_to_Groundwater_Pozzo_4', 'Depth_to_Groundwater_Pozzo_5', 'Depth_to_Groundwater_Pozzo_6', 'Depth_to_Groundwater_Pozzo_7', 'Depth_to_Groundwater_Pozzo_8', 'Depth_to_Groundwater_Pozzo_9'])","5d5387a2":"Dogna = Dogna.dropna()\nDogna.info()","b785db1b":"corr_plot(Dogna)","53384d23":"RainfallCol,DepthCol,TempCol,VolCol,HyrdoCol = takecolumn(Dogna)","5e60d004":"#\u8981\u505a\u964d\u7dad\u7684\u9ad8\u76f8\u95dcvolume\nprint(VolCol)\n['Volume_Pozzo_4', 'Volume_Pozzo_5+6','Volume_Pozzo_8', 'Volume_Pozzo_9']\n\n","03d6d333":"#RainfallT+1\nDogna = moreday(Dogna,RainfallCol,1,True)","04f5e969":"#RainfallT+2\nDogna = moreday(Dogna,RainfallCol,2,True)","ef723d49":"#RainfallT0\u964d\u7dad\nDogna = SNEnewcolumn(Dogna,RainfallCol,2,'RainfallT0')","74ac3016":"#Vol\u964d\u7dad\nDogna = SNEnewcolumn(Dogna,['Volume_Pozzo_4', 'Volume_Pozzo_5+6','Volume_Pozzo_8', 'Volume_Pozzo_9'],2,'Vol')","27366c5d":"#Temperature\u964d\u7dad\nDogna = SNEnewcolumn(Dogna,TempCol,2,'Temp')","4021d28c":"#prepare training set\nDepth1 = Dogna.drop(columns=['Date', 'Depth_to_Groundwater_Pozzo_2', 'Depth_to_Groundwater_Pozzo_3', 'Depth_to_Groundwater_Pozzo_4', 'Depth_to_Groundwater_Pozzo_5', 'Depth_to_Groundwater_Pozzo_6', 'Depth_to_Groundwater_Pozzo_7', 'Depth_to_Groundwater_Pozzo_8', 'Depth_to_Groundwater_Pozzo_9'])\nDepth2 = Dogna.drop(columns=['Date' ,'Depth_to_Groundwater_Pozzo_1', 'Depth_to_Groundwater_Pozzo_3', 'Depth_to_Groundwater_Pozzo_4', 'Depth_to_Groundwater_Pozzo_5', 'Depth_to_Groundwater_Pozzo_6', 'Depth_to_Groundwater_Pozzo_7', 'Depth_to_Groundwater_Pozzo_8', 'Depth_to_Groundwater_Pozzo_9'])\nDepth3 = Dogna.drop(columns=['Date','Depth_to_Groundwater_Pozzo_2', 'Depth_to_Groundwater_Pozzo_1', 'Depth_to_Groundwater_Pozzo_4', 'Depth_to_Groundwater_Pozzo_5', 'Depth_to_Groundwater_Pozzo_6', 'Depth_to_Groundwater_Pozzo_7', 'Depth_to_Groundwater_Pozzo_8', 'Depth_to_Groundwater_Pozzo_9'])\nDepth4 = Dogna.drop(columns=['Date', 'Depth_to_Groundwater_Pozzo_2', 'Depth_to_Groundwater_Pozzo_3', 'Depth_to_Groundwater_Pozzo_1', 'Depth_to_Groundwater_Pozzo_5', 'Depth_to_Groundwater_Pozzo_6', 'Depth_to_Groundwater_Pozzo_7', 'Depth_to_Groundwater_Pozzo_8', 'Depth_to_Groundwater_Pozzo_9'])\nDepth5 = Dogna.drop(columns=['Date', 'Depth_to_Groundwater_Pozzo_2', 'Depth_to_Groundwater_Pozzo_3', 'Depth_to_Groundwater_Pozzo_4', 'Depth_to_Groundwater_Pozzo_1', 'Depth_to_Groundwater_Pozzo_6', 'Depth_to_Groundwater_Pozzo_7', 'Depth_to_Groundwater_Pozzo_8', 'Depth_to_Groundwater_Pozzo_9'])\nDepth6 = Dogna.drop(columns=['Date', 'Depth_to_Groundwater_Pozzo_2', 'Depth_to_Groundwater_Pozzo_3', 'Depth_to_Groundwater_Pozzo_4', 'Depth_to_Groundwater_Pozzo_5', 'Depth_to_Groundwater_Pozzo_1', 'Depth_to_Groundwater_Pozzo_7', 'Depth_to_Groundwater_Pozzo_8', 'Depth_to_Groundwater_Pozzo_9'])\nDepth7 = Dogna.drop(columns=['Date', 'Depth_to_Groundwater_Pozzo_2', 'Depth_to_Groundwater_Pozzo_3', 'Depth_to_Groundwater_Pozzo_4', 'Depth_to_Groundwater_Pozzo_5', 'Depth_to_Groundwater_Pozzo_6', 'Depth_to_Groundwater_Pozzo_1', 'Depth_to_Groundwater_Pozzo_8', 'Depth_to_Groundwater_Pozzo_9'])\nDepth8 = Dogna.drop(columns=['Date', 'Depth_to_Groundwater_Pozzo_2', 'Depth_to_Groundwater_Pozzo_3', 'Depth_to_Groundwater_Pozzo_4', 'Depth_to_Groundwater_Pozzo_5', 'Depth_to_Groundwater_Pozzo_6', 'Depth_to_Groundwater_Pozzo_7', 'Depth_to_Groundwater_Pozzo_1', 'Depth_to_Groundwater_Pozzo_9'])\nDepth9 = Dogna.drop(columns=['Date', 'Depth_to_Groundwater_Pozzo_2', 'Depth_to_Groundwater_Pozzo_3', 'Depth_to_Groundwater_Pozzo_4', 'Depth_to_Groundwater_Pozzo_5', 'Depth_to_Groundwater_Pozzo_6', 'Depth_to_Groundwater_Pozzo_7', 'Depth_to_Groundwater_Pozzo_8', 'Depth_to_Groundwater_Pozzo_1'])\n\n","d3364562":"#\u958b\u59cbtrain\nfrom pycaret.regression import * \n\nexp_reg = setup(Depth1,target='Depth_to_Groundwater_Pozzo_1',session_id=13,feature_selection = True,remove_multicollinearity = True,use_gpu = True)","707d5b43":"bestbDepth1 = compare_models(exclude = ['ransac'])","2531d49b":"et = create_model('et')\ntuned_Depth1 = tune_model(et,n_iter=10)\nsave_model(tuned_Depth1,'Depth_to_Groundwater_Pozzo_1 for Doganella')\nprint(tuned_Depth1)","eebaf427":"#\u958b\u59cbtrain\nfrom pycaret.regression import * \n\nexp_reg = setup(Depth2,target='Depth_to_Groundwater_Pozzo_2',session_id=13,feature_selection = True,remove_multicollinearity = True,use_gpu = True)","8e5ed0c7":"bestbDepth2 = compare_models(exclude = ['ransac'])","ecac42ea":"et = create_model('et')\ntuned_Depth2 = tune_model(et,n_iter=10)\nsave_model(tuned_Depth2,'Depth_to_Groundwater_Pozzo_2 for Doganella')\nprint(tuned_Depth2)","de192136":"#\u958b\u59cbtrain\nfrom pycaret.regression import * \n\nexp_reg = setup(Depth3,target='Depth_to_Groundwater_Pozzo_3',session_id=13,feature_selection = True,remove_multicollinearity = True,use_gpu = True)","6017a351":"bestbDepth3 = compare_models(exclude = ['ransac'])","2109ba6f":"et = create_model('et')\ntuned_Depth3 = tune_model(et,n_iter=10)\nsave_model(tuned_Depth3,'Depth_to_Groundwater_Pozzo_3 for Doganella')\nprint(tuned_Depth3)","62a7c35d":"#\u958b\u59cbtrain\nfrom pycaret.regression import * \n\nexp_reg = setup(Depth4,target='Depth_to_Groundwater_Pozzo_4',session_id=13,feature_selection = True,remove_multicollinearity = True,use_gpu = True)","86334c2a":"bestbDepth4 = compare_models(exclude = ['ransac'])","5726a745":"et = create_model('et')\ntuned_Depth4 = tune_model(et,n_iter=10)\nsave_model(tuned_Depth4,'Depth_to_Groundwater_Pozzo_4 for Doganella')\nprint(tuned_Depth4)","9a3372b9":"#\u958b\u59cbtrain\nfrom pycaret.regression import * \n\nexp_reg = setup(Depth5,target='Depth_to_Groundwater_Pozzo_5',session_id=13,feature_selection = True,remove_multicollinearity = True,use_gpu = True)","9c63fd12":"bestbDepth5 = compare_models(exclude = ['ransac'])","b3f219df":"et = create_model('et')\ntuned_Depth5 = tune_model(et,n_iter=10)\nsave_model(tuned_Depth5,'Depth_to_Groundwater_Pozzo_5 for Doganella')\nprint(tuned_Depth5)","af0ac271":"#\u958b\u59cbtrain\nfrom pycaret.regression import * \n\nexp_reg = setup(Depth6,target='Depth_to_Groundwater_Pozzo_6',session_id=13,feature_selection = True,remove_multicollinearity = True,use_gpu = True)","79782355":"bestbDepth6 = compare_models(exclude = ['ransac'])","91d010ca":"et = create_model('et')\ntuned_Depth6 = tune_model(et,n_iter=10)\nsave_model(tuned_Depth6,'Depth_to_Groundwater_Pozzo_6 for Doganella')\nprint(tuned_Depth6)","4f4b2f0e":"#\u958b\u59cbtrain\nfrom pycaret.regression import * \n\nexp_reg = setup(Depth7,target='Depth_to_Groundwater_Pozzo_7',session_id=13,feature_selection = True,remove_multicollinearity = True,use_gpu = True)","1dbf5bf7":"bestbDepth7 = compare_models(exclude = ['ransac'])","d9b8ee95":"et = create_model('catboost')\ntuned_Depth7 = tune_model(et,n_iter=10)\nsave_model(tuned_Depth7,'Depth_to_Groundwater_Pozzo_7 for Doganella')\nprint(tuned_Depth7)","6548a074":"#\u958b\u59cbtrain\nfrom pycaret.regression import * \n\nexp_reg = setup(Depth8,target='Depth_to_Groundwater_Pozzo_8',session_id=13,feature_selection = True,remove_multicollinearity = True,use_gpu = True)","2aa8dff9":"bestbDepth8 = compare_models(exclude = ['ransac'])","e1483937":"et = create_model('et')\ntuned_Depth8 = tune_model(et,n_iter=10)\nsave_model(tuned_Depth8,'Depth_to_Groundwater_Pozzo_8 for Doganella')\nprint(tuned_Depth8)","6c459af0":"#\u958b\u59cbtrain\nfrom pycaret.regression import * \n\nexp_reg = setup(Depth9,target='Depth_to_Groundwater_Pozzo_9',session_id=13,feature_selection = True,remove_multicollinearity = True,use_gpu = True)","dbb446e3":"bestbDepth9 = compare_models(exclude = ['ransac'])","6bda401d":"et = create_model('et')\ntuned_Depth9 = tune_model(et,n_iter=10)\nsave_model(tuned_Depth9,'Depth_to_Groundwater_Pozzo_9 for Doganella')\nprint(tuned_Depth9)","aa16df11":"Aquifer_Luco.info()","a04a5818":"f, ax = plt.subplots(nrows=1, ncols=1, figsize=(25,15))\nsns.heatmap(Aquifer_Luco.T.isna(), cmap='Blues')\nax.set_title('Fields with Missing Values', fontsize=16)\n#for tick in ax.xaxis.get_major_ticks():\n#    tick.label.set_fontsize(14) \nfor tick in ax.yaxis.get_major_ticks():\n    tick.label.set_fontsize(14)\nplt.show()","dbb147e6":"corr_plot(Aquifer_Luco)","e14d4fb6":"time(Aquifer_Luco)","c3033e57":"vis(Aquifer_Luco)","5a980b98":"Lucona = Aquifer_Luco.dropna(subset=['Volume_Pozzo_1','Depth_to_Groundwater_Podere_Casetta'])","ff221781":"Lucona.info()","dc9a62d3":"corr_plot(Lucona)","8a75bb42":"vis(Lucona)","c61639b4":"#remain300\u500b\nLucona = Lucona.dropna(subset=['Depth_to_Groundwater_Pozzo_1','Depth_to_Groundwater_Pozzo_3','Depth_to_Groundwater_Pozzo_4'])","103f6808":"Lucona = Lucona.drop(columns=['Rainfall_Siena_Poggio_al_Vento'])","a0e5e06a":"season(Lucona)","5c10045a":"Lucona = Lucona.reset_index(drop=True)","45615e2f":"RainfallCol,DepthCol,TempCol,VolCol,HyrdoCol = takecolumn(Lucona)","b2c19be8":"#T+1\nLucona = moreday(Lucona,RainfallCol,1,False)","5882110b":"#T+2\nLucona = moreday(Lucona,RainfallCol,2,False)","58caf131":"Lucona = AVG(Lucona,RainfallCol,True,'Rainfall')","fddea4f2":"from pycaret.regression import * \n\nexp_reg = setup(Lucona,target='Depth_to_Groundwater_Podere_Casetta',session_id=13,feature_selection = True,remove_multicollinearity = True,use_gpu = True)","c1545429":"bestLuco = compare_models(exclude = ['ransac'])","e1edfa8b":"et = create_model('et')\ntuned_Luco = tune_model(et,n_iter=10)\nprint(tuned_Luco)","9461542d":"save_model(tuned_Luco,'Depth_to_Groundwater_Podere_Casetta for Luco')","cb7cf059":"Aquifer_Petrignano.info()","da0773e7":"time(Aquifer_Petrignano)","0fbdc7fe":"f, ax = plt.subplots(nrows=1, ncols=1, figsize=(16,5))\nsns.heatmap(Aquifer_Petrignano.T.isna(), cmap='Blues')\nax.set_title('Fields with Missing Values', fontsize=16)\n#for tick in ax.xaxis.get_major_ticks():\n#    tick.label.set_fontsize(14) \nfor tick in ax.yaxis.get_major_ticks():\n    tick.label.set_fontsize(14)\nplt.show()","97d279e8":"corr_plot(Aquifer_Petrignano)","b8c88cd5":"vis(Aquifer_Petrignano)","e52e47cb":"# replace 0 on nans, if two or more 0 follow to each other\nfeatures_temp = [f for f in Aquifer_Petrignano.columns if 'Temperature' in f]\nfor f in features_temp:\n    indexs = Aquifer_Petrignano[Aquifer_Petrignano[f]==0].index.tolist()\n    for i in range(1,len(indexs)):\n        if indexs[i] == indexs[i-1]+1:\n            Aquifer_Petrignano[f][indexs[i]] = np.nan\n            Aquifer_Petrignano[f][indexs[i-1]] = np.nan\n            ","284d5ca3":"# replace 0 on nan\nfeatures_volume = [f for f in Aquifer_Petrignano.columns if 'Volume' in f]\nAquifer_Petrignano[features_volume] = Aquifer_Petrignano[features_volume].replace(0, np.nan)","3cb95b5f":"# replace 0 on nan\nfeatures_hydrometry = [f for f in Aquifer_Petrignano.columns if 'Hydrometry' in f]\nAquifer_Petrignano[features_hydrometry] = Aquifer_Petrignano[features_hydrometry].replace(0, np.nan)","f241b4f3":"#\u586b\u88dcTemperature\u7f3a\u5931\u503c\nTemperature_Bastia_Umbra = Aquifer_Petrignano.groupby(['month','day'],as_index=False).agg({'Temperature_Bastia_Umbra':'mean'})\nAquifer_Petrignano= pd.merge(Aquifer_Petrignano,Temperature_Bastia_Umbra, how='left' ,left_on=['month','day'], right_on=['month','day'])\nAquifer_Petrignano.Temperature_Bastia_Umbra_x.fillna(Aquifer_Petrignano.Temperature_Bastia_Umbra_y, inplace=True)\nAquifer_Petrignano = Aquifer_Petrignano.drop(columns=['Temperature_Bastia_Umbra_y'])\n\nTemperature_Petrignano  = Aquifer_Petrignano.groupby(['month','day'],as_index=False).agg({'Temperature_Petrignano':'mean'})\nAquifer_Petrignano= pd.merge(Aquifer_Petrignano,Temperature_Petrignano, how='left' ,left_on=['month','day'], right_on=['month','day'])\nAquifer_Petrignano.Temperature_Petrignano_x.fillna(Aquifer_Petrignano.Temperature_Petrignano_y, inplace=True)\nAquifer_Petrignano = Aquifer_Petrignano.drop(columns=['Temperature_Petrignano_y'])","c1353bd2":"#\u63d2\u503c\u6cd5\u5f25\u8865Volume Hydrometry\u7f3a\u5931\u503c\nAquifer_Petrignano['Volume_C10_Petrignano']= Aquifer_Petrignano['Volume_C10_Petrignano'].interpolate()\nAquifer_Petrignano['Hydrometry_Fiume_Chiascio_Petrignano']= Aquifer_Petrignano['Hydrometry_Fiume_Chiascio_Petrignano'].interpolate()","6623911e":"vis(Aquifer_Petrignano)","8b6d987d":"#Lag T-1\nAquifer_Petrignano = moreday(Aquifer_Petrignano,['Rainfall_Bastia_Umbra'],1,False)\n#lag T-2\nAquifer_Petrignano = moreday(Aquifer_Petrignano,['Rainfall_Bastia_Umbra'],2,False)","c9f67d49":"#\u5220\u9664\u786e\u5b9ehydrometry\u4e0erainfall\u7684\u7f3a\u5931\u503c\nAquifer_Petrignano = Aquifer_Petrignano.iloc[1024:,]\nAquifer_Petrignano = Aquifer_Petrignano.reset_index(drop=True)","0c8e5c95":"#AVG days\nAVG(Aquifer_Petrignano,['Rainfall_Bastia_Umbra'],False,'Rainfall_Bastia_Umbra')","4ffe3750":"Aquifer_Petrignano = Aquifer_Petrignano.dropna()\nAquifer_Petrignano = Aquifer_Petrignano.reset_index(drop=True)","e659f4d5":"P24 = Aquifer_Petrignano.drop(columns=['Date','Depth_to_Groundwater_P25'])\nP25 = Aquifer_Petrignano.drop(columns=['Date','Depth_to_Groundwater_P24'])","ce5f86e3":"from pycaret.regression import * \n\nexp_reg = setup(P24,target='Depth_to_Groundwater_P24',session_id=13,feature_selection = True,remove_multicollinearity = True,use_gpu = True)","7949fe53":"bestP24 = compare_models(exclude = ['ransac'])","f91b16fd":"et = create_model('et')\ntuned_P24 = tune_model(et,n_iter=10)\nsave_model(tuned_P24,'Depth_to_Groundwater_P24 for Petrignano')","14a4a7da":"from pycaret.regression import * \n\nexp_reg = setup(P25,target='Depth_to_Groundwater_P25',session_id=13,feature_selection = True,remove_multicollinearity = True,use_gpu = True)","d319671e":"bestP25 = compare_models(exclude = ['ransac'])","3794a631":"et = create_model('et')\ntuned_P25 = tune_model(et,n_iter=10)\nsave_model(tuned_P25,'Depth_to_Groundwater_P25 for Petrignano')","77fb72be":"* Since the distribution of missing values is concentrated in the front part of the dataset and the amount of missing value data is not large, we only need to simply delete the data with missing values. ","4ffde08b":"## Aquifer_Doganella Feature Engineering","65893f5b":"# Aquifer_Luco Luco","a422b8bc":"* Because there may be a delay between the rain falling and the spring, for example, in one day or two days, new features, rainfall data after one day and rainfall data after two days, are added to the dataset.","0db84512":"### Depth_to_Groundwater_Pozzo_4\n","bac8df9f":"A lake is an area filled with water, localized in a basin, surrounded by land, apart from any river or other outlet that serves to feed or drain the lake.[(Wikipedia)](https:\/\/en.wikipedia.org\/wiki\/Lake)","8f1645cc":"* The same phenomenon also appears in the feature ***Temperature***. According to common sense, the Temperature of the aquifer is ***not likely to be 0 suddenly***, but the data shows that the volume is equal to 0 occasionally, so we also regard these values as outliers and replace these outliers with ***NAN***..","9a19a3a5":"* Delete a small part of missing values scattered in the dataset.","b4274ad6":"## Aquifer_Doganella Prediction","747df4c4":"* An aquifer is an underground layer of water-bearing permeable rock, rock fractures or unconsolidated materials (gravel, sand, or silt). Groundwater can be extracted using a water well. The study of water flow in aquifers and the characterization of aquifers is called hydrogeology. Related terms include aquitard, which is a bed of low permeability along an aquifer, and aquiclude (or aquifuge), which is a solid, impermeable area underlying or overlying an aquifer, the pressure of which could create a confined aquifer. [(Wikipedia)](https:\/\/en.wikipedia.org\/wiki\/Aquifer)","2f4ec167":"* Here ***lightgbm Regressor*** is the best performer with an RMSE of **0.3492** Next, we will conduct the following model tuning. The explanation of the Extra Tree Regressor model was explained in the first half of the notebook.\n\n* The below is the hyperparameter we would like to use for Final lightgbm Regressor Regressor.","e7449cdf":"# Aquifer_Doganella\n","83009a15":"## Lake Data Preprocessing","fad78016":"* Here ***Extra Trees Regressor*** is the best performer with an RMSE of ***0.0102***. Next, we will conduct the following model tuning. The explanation of the Extra Tree Regressor model was explained in the first half of the notebook.\n\n* The below is the hyperparameter we would like to use for Final Extra Tree Regressor.","160f3d7d":"We get this Parameter as the best performance hyperparameter for ***Extra Tree Regressor***:","b8d80196":"## Aquifer Petrignano\n","38949890":"## Aquifer_Auser Feature Engineering","e294d902":"* In the EDA process, it can be seen that the data in dataset are very ***incomplete***, and the problem of data missing is very serious. What is more fatal is that, the missing data among different features are very ***scattered***.\n* For example, the important features found from the correlation graph: ***Depth_to_Groundwater_Podere_Casetta and Volume_Pozzo, have little non-missing value in common.*** Considering that these features are very important and difficult to discard, we chose to sacrifice the amount of data to preserve the features.\n* So, we firstly drop the data which have missing value in Volume_Pozzo_1,3,4 and Depth_to_Groundwater_Podere_Casetta","5dd774e3":"* It is worth noting that Bilancino lake is used to supplement the Arno River in summer, while the situation is the opposite in winter. Therefore, the water level of the Arno River can reflect the lake level of Bilancino to a certain extent, so we reasonably ***introduce the target value in the River Arno dataset as a new feature*** of this dataset ","864864dd":"* First of all, because the Rainfall of the five locations has a strong linear correlation with each other, we can conduct dimensionality reduction with the help of ***TSNE***, and obtain the new feature ***SNE_T-1(1),SNE_T-1(2)*** as Rainfall of yesterday,***SNE_T-2(1),SNE_T-2(2)*** as the day berfore Yesterday Rainfall, after dimensionality reduction, which can represent the information about the rainfall of the five locations ","5c6d7b04":"## WaterSpring_Mandonna feature engineering","372958f3":"* Same as before, Because there may be a delay between the rain falling and the spring, for example, in one day or two days, new features, rainfall data after one day and rainfall data after two days, are added to the dataset. Also some rainfall has high correlation due to their geo locaton is close, we would like to reduce their dimension.\n\n\n\n\n\n* High correlate Rainfall: **['Rainfall_Gallicano', 'Rainfall_Pontetetto', 'Rainfall_Monte_Serra', 'Rainfall_Orentano', 'Rainfall_Borgo_a_Mozzano', 'Rainfall_Piaggione', 'Rainfall_Calavorno', 'Rainfall_Fabbriche_di_Vallico']**","f5ad368a":"* Here ***Extra Trees Regressor*** is the best performer with an RMSE of **1.4700**. Next, we will conduct the following model tuning. The explanation of the Extra Tree Regressor model was explained in the first half of the notebook.\n\n* The below is the hyperparameter we would like to use for Final Extra Tree Regressor.","94d7c7ff":"* Here ***Extra Trees Regressor*** is the best performer with an RMSE of **0.6999**. Next, we will conduct the following model tuning. The explanation of the Extra Tree Regressor model was explained in the first half of the notebook.\n\n* The below is the hyperparameter we would like to use for Final Extra Tree Regressor.","6d7609f6":"## Mandonna Exploratory Data Analysis","b8d376db":"* Let's quickly browse through Lupa's data, Lupa is the least dependent variable in all the data, and the data is also the most complete with only about 300 missing values, which is the easiest to handle and the most difficult to handle accurately.\n\n* This water spring is located in the Rosciano Valley, on the left side of the Nera river.\n\n* The waters emerge at an altitude of about 375 meters above sea level through a long draining tunnel that crosses, in its final section, lithotypes and essentially calcareous rocks","4f1d6b5a":"## Water_Spring Prediction\n\n* **Four target variable are**: \n *  Flow_Rate_Arbure\n *  Flow_Rate_Ermicciolo\n *  Flow_Rate_Galleria_Alta\n *  Flow_Rate_Bugnano","833a1232":"## Data Preprocessing","32306647":"* Similarly, the feature ***hydrometry*** also has such a situation. It is ***not reasonable for the groundwater level to be 0 suddenly*** for a period of time. Moreover, the time period when hydrometry is equal to 0 is exactly the same as the time period when temperature is equal to 0, so we are more sure that the values in this period are outliers and replace these outliers with ***NAN***.","79fef2f6":"* From the correlation and time diagrams, there is no variable with particularly high correlation and no variable with obvious time pattern.","bc4e69c4":"## Aquifer_Doganella Data Preprocessing","86216c62":"* Because **Depth to ground water DIEC\/PAG**, have a certain time series trend pattern, we will use the average of the day in the past few years to fill in the missing values, and we replace the feature names with ***Depth to ground water_name_x***","fefd7046":"* In the ramainnning data, we find that there are some missing data in ***target value***, so we have to drop these data. But for the feature ***'Rainfall_Siena_Poggio_al_Vento'***, which has much missing value but shows little importance, we drop this feature directly.","791f2c3d":"### Lake Flow Rate modeling ","ed032ccf":"* Petrignano is a frazione of the comune of Assisi in the Province of Perugia, Umbria, central Italy. It stands at an elevation of 212 metres above sea level on the right bank of the Chiascio River.[(Wikipedia)](https:\/\/en.wikipedia.org\/wiki\/Petrignano)\n\n* The aquifer can be considered a water table groundwater and is also fed by the Chiascio river. The groundwater levels are influenced by the following parameters:\n     1. rainfall\n     2. depth to groundwater\n     3. temperatures\n     4. drainage volumes\n     5. level of the Chiascio river.","8e66914a":"* Since only the predicted values are missing, we can remove the missing values directly.","da772a53":"## Aquifer_Luco Feature Engineering","4020a082":"## Feature Engineering","ff951d39":"* We can see that the distribution of missing values of his flowrate is intermittent, while the distribution of missing values of two dependent variables is concentrated in the ***second half***, which will facilitate us to handle the missing values.","9c4453b1":"* From the time trend graph, we can find that the data of Rainfall_Monteporzio and Rainfall_Velletri in the period from **2015 to 2018** are a bit strange compared to other years. We also tried to find data online for comparison and found that the value of this period is **not normal**, so we replaced the value of this period with **NAN** and then replaced it with the average of the past years on the same day. By giving a new vairable **Rainfall_name_x**","67be2a8b":"* Because Depth to ground water has a high correlation, we will lower its dimension. Giving a new variable SNE-Depth(1)","186d75fb":"* Here ***Extra Trees Regressor*** is the best performer with an RMSE of ***0.1225***. Next, we will conduct the following model tuning. The explanation of the Extra Tree Regressor model was explained in the first half of the notebook.\n\n* The below is the hyperparameter we would like to use for Final Extra Tree Regressor.","2f184660":"* Firstly, we introduce the seasonal features\n* Secondly, we introduce the lag term of Rainfall\n* Thirdly, we introduce the 3-day moving average of rainfall\n* As for the reason why we introduce these new features, we will give detailed explanation in the \"Petrignano\" part.","f8fa10c3":"## Lake Feature Engineering","bc6087b6":"### Depth_to_Groundwater_Pozzo_2\n","6fa9cfa5":"## Aquifer_Luco Exploratory Data Analysis","bebe8215":"##  WaterSpring_Mandonna Spring Prediction\n","d257a13f":"* Since both rainfall and temperature have a certain time trend, we used the ***current three-day average of past years** as a way to fill in the missing values.","d6d42025":"* Here ***Extra Trees Regressor*** is the best performer with an RMSE of **0.2805**. Next, we will conduct the following model tuning. The explanation of the Extra Tree Regressor model was explained in the first half of the notebook.\n\n* The below is the hyperparameter we would like to use for Final Extra Tree Regressor.","8ede97bf":"### Depth_to_Groundwater_Pozzo_7\n","fc50a5df":"## River Feature Engineering\n\n* we take ***seasonal factors*** into consideration. Because the change of season can reflect the change of rainfall to some extent in the district of Arno River, it is very reasonable to add seasonal features.","b6c1acb9":"## Amiata feature engineering","3bf9227d":"* Since temperature has an obvious seasonal trend, we can use the ***mean value of the temperature on the same date in different years*** to fill the missing value. \n* However, Volume and Hydrometry have no obvious seasonal trends, so it is more reasonable for us to use ***interpolation method*** to fill the missing values, and we replace the feature names with ***Temperature_name_x***","9daafcc9":"The Arno is a river in the Tuscany region of Italy. It is the most important river of central Italy after the Tiber. With a length of 241 kilometres (150 mi), it is the largest river in the region. It has many tributaries: Sieve at 60 kilometres (37 mi) long, Bisenzio at 49 kilometres (30 mi), Ombrone Pistoiese at 47 kilometres (29 mi), and the Era, Elsa, Pesa, and Pescia. The drainage basin amounts to more than 8,200 square kilometres (3,200 sq mi).","3a4f8a4f":"* Add season as new feature","a2e9512f":"* From the correlation graph, some feature in **Volume** and **Temperature** are highly correlated, therefore, we would like to do diemnsion reduction to increase the accuracy of the result.","5fdcd142":"* Here ***Extra Trees Regressor*** is the best performer with an RMSE of **0.2205**. Next, we will conduct the following model tuning. The explanation of the Extra Tree Regressor model was explained in the first half of the notebook.\n\n* The below is the hyperparameter we would like to use for Final Extra Tree Regressor.","8e3aba9a":"The earliest data is from ***2012***, but the Flow_Rate was a ***missing value*** at that time","1fe89942":"### Lake Lake Level modeling","bdb9ea6f":"* Here ***Extra Trees Regressor*** is the best performer with an RMSE of **0.4833**, which is expected because there are relatively few dependent variables here. Next, we will conduct the following model tuning. The explanation of the Extra Tree Regressor model was explained in the first half of the notebook.\n\n* The below is the hyperparameter we would like to use for Final Extra Tree Regressor.","a751d5ca":"* The deep color is missing value and the light color is non missing value.From the pattern, we can find out that Lake missing data are foucs on the front part of the dataset.","e8568889":"> ","e7310c1b":"# Welcome to the Competition\n","93e06225":"### Depth_to_Groundwater_Pozzo_9","bfbe344a":"* The same phenomenon also appears in the feature ***Volume***. According to common sense, the Volume of the aquifer is ***not likely to be 0 suddenly***, but the data shows that the volume is equal to 0 occasionally, so we also regard these values as outliers and replace these outliers with ***NAN***.\n* We will keep the data only after 2017, which will keep all the predicted values and most of the dependent variable values, for example, the 0 value in Volume will be removed. ","208bfa9f":"* From the correlation graph, we can find that **Volume** and the predicted value-**Depth to Ground Water1-9** have a greater correlation, so we intend to keep the data of **Volume** as much as possible, so we will only leave **Depth to Ground Water1-9** with Volume **not NAN**.","5cb749a7":"* Here ***Extra Trees Regressor*** is the best performer with an RMSE of **0.0731**. Next, we will conduct the following model tuning. The explanation of the Extra Tree Regressor model was explained in the first half of the notebook.\n\n* The below is the hyperparameter we would like to use for Final Extra Tree Regressor.","d7fe029d":"* At the same time, Rainfall varies greatly from day to day. For example, if it did not rain yesterday, the rainfall is 0, but if it rains today, the rainfall will increase greatly compared to yesterday. Therefore, It's not appropriatethe to use the daily rainfall as a feature. We created a new feature ***Rainfall_AVG***, which represents the average daily rainfall of the three days from the day before yesterday to today. We believe it can better reflect the short-term rainfall level. ","d8d0fca4":"* For **Hydrometry Monte_S_Quirico and Hydrometry_Piaggione**, which have trends but no time trends, we will use the interpolation method to fill in the missing values. Finally, we keep only the part of the predicted value that has a numerical value.","b8ed2c77":"A river is a natural flowing watercourse, usually freshwater, flowing towards an ocean, sea, lake or another river. In some cases a river flows into the ground and becomes dry at the end of its course without reaching another body of water.[(Wikipedia)](https:\/\/en.wikipedia.org\/wiki\/River)","4d1f948f":"* Here ***Extra Trees Regressor*** is the best performer with an RMSE of **0.4465**. Next, we will conduct the following model tuning. The explanation of the Extra Tree Regressor model was explained in the first half of the notebook.\n\n* The below is the hyperparameter we would like to use for Final Extra Tree Regressor.","91159f44":"* Here ***Extra Trees Regressor*** is the best performer with an RMSE of **0.0711**. Next, we will conduct the following model tuning. The explanation of the Extra Tree Regressor model was explained in the first half of the notebook.\n\n* The below is the hyperparameter we would like to use for Final Extra Tree Regressor.","396ff61a":"* Here ***Extra Trees Regressor*** is the best performer with an RMSE of **22.74**, which is expected because there are relatively few dependent variables here. Next, we will conduct the following model tuning. The explanation of the Extra Tree Regressor model was explained in the first half of the notebook.\n\n* The below is the hyperparameter we would like to use for Final Extra Tree Regressor.","a151e764":"## Aquifer_Luco Data Preprocessing","02b9167d":"* The distribution of missing values in Amiata is mostly concentrated ***in the first half***, in front of row 3512, where four predicted values are in front of row 3512, so the initial speculation is that we only need to process the data after row 3152.","24eba5fb":"* where the missing values are concentrated in front of **2886 row**, and the three predicted values have some scattered missing values after **2886 row**, which means there is some level of missing values.\n\n* This waterbody consists of two subsystems, called **NORTH** and **SOUTH**, where the former partly influences the behavior of the latter. Indeed, the north subsystem is a water table (or unconfined) aquifer while the south subsystem is an artesian (or confined) groundwater.\n\n* The levels of the NORTH sector are represented by the values of the SAL, PAG, CoS and DIEC wells, while the levels of the SOUTH sector by the LT2 well.","f029b92a":"## Challenge\n* The challenge is to determine **how features influence the water availability of each presented waterbody**. To be more straightforward, **gaining a better understanding of volumes**, they will be able to ensure water availability for each time interval of the year.","a9571cb0":"# Water_Spring Lupa","00c70970":"Target Variable in the Lake are: Flow_Rate and Lake_level, in the following part we would like to create two new dataset for the training model,","3b60f2b9":"# ****Lake Binallino****\n\n\n\n","53423b36":"## Introduction\n\n* Water is one of the most valueable ressources not only to our humans but for many other living organisms as well. \n\n* In this competition we will focus only on the water sector to help Acea Group preserve precious waterbodies. As it is easy to imagine, a water supply company struggles with the need to forecast the water level in a waterbody (water spring, lake, river, or aquifer) to handle daily consumption. During fall and winter waterbodies are refilled, but during spring and summer they start to drain. \n* To help preserve the health of these waterbodies it is important to predict the most efficient water availability, in terms of level and water flow for each day of the year.","04f0b90d":"* We average every 3-days rainfall as new features ***Rainfall_Avg***, and because of strong correlation among the new features, then we use the method of ***TSNE*** dimensionality reduction to reduce the features.","dd2d9b05":"* Let's take a brief look at the Amiata dataset, there are **7487 rows** of data and 4 rows of predicted values are **2008 rows**.\n\n* The Amiata waterbody is composed of a volcanic aquifer not fed by rivers or lakes but fed by meteoric infiltration.\n\n* This aquifer is accessed through Ermicciolo, Arbure, Bugnano and Galleria Alta water springs.","c93b8f1d":"## WaterSpring_Amiata Exploratory Data Analysis\n","ece4db3f":"* Since it takes some time for rainwater to penetrate into the underground aquifer, we assume that the impact of rainfall on the aquifer ***has a lag***. Based on this assumption, we create two new features, the lag term of rainfall ***Rainfall_Bastia_Umbra_1, Rainfall_Bastia_Umbra_2***,which represents one-day lag and two-day lag respectively.","94d5152e":"* Here ***Extra Trees Regressor*** is the best performer with an RMSE of **0.1672**. Next, we will conduct the following model tuning. The explanation of the Extra Tree Regressor model was explained in the first half of the notebook.\n\n* The below is the hyperparameter we would like to use for Final Extra Tree Regressor.","28581aa5":"Amiatafull.info()","92f437b4":"* Here ***Extra Trees Regressor*** is the best performer with an RMSE of **0.2111**. Next, we will conduct the following model tuning. The explanation of the Extra Tree Regressor model was explained in the first half of the notebook.\n\n* The below is the hyperparameter we would like to use for Final Extra Tree Regressor.","76334219":"### Flow_Rate_Bugnano","6d41dfc3":"* At the same time, for the serious lack of data before 2009, we directly drop the data before 2009 in the dataset.","8156a2b1":"#  Water Spring","4302bb0d":"* From the first batch of training, Extra tree Regreessor pefrom the best pefromance, therefore we would like to use Extra tree Regressor to do the parameter training for 100 iterations.\n\n* Here is some explaination for Extra-Tree Regressor:\n    ET or Extra-Trees (Extra Trees Regressor) was proposed by PierreGeurts et al. in 2006. The algorithm is very similar to the random forest algorithm, and is composed of many decision trees. But there are two main differences between this algorithm and random forest:\n        1. Random forest uses the Bagging model, while ET uses all training samples to get each decision tree, that is, each decision tree uses the same all training samples;\n        2. Random forest obtains the best bifurcation attribute in a random subset, while ET obtains the bifurcation value completely and randomly, so as to realize the bifurcation of the decision tree","b1f0c5b2":"## Libraries we use","b0caaaf9":"* As always, the temperature has a strong temporal rhythm. Meanwhile, Rainfall is relatively much weaker. Also Depth to Ground Water has a relative clear trend on the graph.","0a7e1285":"* As can be seen from the correlation graph, the predicted value of flowrate seems to be somewhat related to the month. It is also clear that ***temperature and month are related***. From the time plot below, temperature has a strong temporal pattern, which will help us to fill in the missing values, while Rainfall is a little weaker.","358849e7":"* Here ***CatBoost Regressor*** is the best performer with an RMSE of **0.4963**. Next, we will conduct the following model tuning. The explanation of the CatBoost Regressor model was explained in the first half of the notebook.\n","4225dd96":"## Water_Spring Mandonna\n\nThe Madonna di Canneto spring is situated at an altitude of 1010m above sea level in the Canneto valley. We can quickly browse the data content, a total of 3112 lines, which has a large number of missing data, the most important prediction Flow_Rate_Madonna_di_Canneto only 1387.","0019c532":"* For the overall line of Depth to Ground_Water there is a trend when there is no seasonal factor, so we use the interpolation method to fill in the missing values","35263c76":"* Similarly, because daily rainfall fluctuates strongly, we create a new feature, the three-day moving average of rainfall ***Rainfall_Bastia_Umbra_Avg***","c2668b55":"* Here Extra Trees Regressor is the best performer with an RMSE of 2.0198. Next, we will conduct the following model tuning. The explanation of the Extra Tree Regressor model was explained in the first half of the notebook.\n\n* The below is the hyperparameter we would like to use for Final Extra Tree Regressor.\n\n","8490ddbb":"* The same phenomenon also appears in the feature ***Volume***. According to common sense, the Volume of the aquifer is ***not likely to be 0 suddenly***, but the data shows that the volume is equal to 0 occasionally, so we also regard these values as outliers and replace these outliers with ***NAN***.","817086ed":"## Aquifer_Petrignano Prediction","e28562a1":"### Depth_to_Groundwater_Pozzo_5\n","c26a8eeb":"## Aquifer_Doganella Exploratory Data Analysis","93b38398":"### Flow_Rate_Ermicciolo","c36748ec":"* For rainfall, we will create three new features. The moving average of three days after dimension reduction. Rainfall data after one day and rainfall data after two days( Both are after dimension reduction).","c4eb5e36":"From the missing value pattern graph, we can find out that the for most of variable, the missing part are before rows 2204 and after rows 4524. The independent variable almost have no missing value, it is great.","b552ec0f":"## River Prediction","4e4a37c9":"* Here ***Extra Trees Regressor*** is the best performer with an RMSE of **0.2750**. Next, we will conduct the following model tuning. The explanation of the Extra Tree Regressor model was explained in the first half of the notebook.\n\n* The below is the hyperparameter we would like to use for Final Extra Tree Regressor.","2c9f379e":"* Since it takes some time for rainwater to penetrate into the underground aquifer, we assume that the impact of rainfall on the aquifer has a lag. Based on this assumption, we create two new features, the lag term of rainfall Rainfall_name_1, Rainfall_name_2,which represents one-day lag and two-day lag respectively. Also, we would like to do dimension reduction for Rainfall variable, this is due to that they have high correlaton (close geography location).In the result of dimension reduction, new variable SNE_T_lagdays_(1) and SNE_T_Lagdays_(2) will be give out","c9f3aad5":"### Depth_to_Groundwater_Pozzo_6\n","5cc173f5":"* Same as most of dataset, Temperature has strong time trend pattern and Rainfall has a relatively weaker trend. Depth to the ground water has a trend but with out time series pattern. \n* Temperature_Ponte_a_Moriano data are all 0 after summer of 2017.\n* Volume_CSA and Volume_CSAL value are 0 before 2014.","129d1a30":"# Conclusion of Result","cc3e4380":"* Add season as a new feature","69069dd7":"* Here ***catboost*** is the best performer with an RMSE of 22.74, which is expected because there are relatively few dependent variables here. Next, we will conduct the following model tuning. The explanation of the catboost model was explained in the first half of the notebook.","b7f62ab2":"### Depth_to_Groundwater_Pozzo_1\n","332b2faa":"* Here ***Extra Trees Regressor*** is the best performer with an RMSE of **0.2980**. Next, we will conduct the following model tuning. The explanation of the Extra Tree Regressor model was explained in the first half of the notebook.\n\n* The below is the hyperparameter we would like to use for Final Extra Tree Regressor.","ca7e806c":"![image.png](attachment:image.png)","5027da12":"* Since the non-missing values of the dataset are mainly concentrated in an interval, we will keep this interval and drop the rest of the data. This piece of data starts from the 2191th to the 8127th. At the same time, because the data of ***rainfall along the River Arno*** are seriously missing, we have to not select them as features. On the contrary, the data of ***rainfall near the Lake*** are relatively complete, so these features will be preserved.","4c810fb4":"River modeling","185439cc":"* Because there may be a delay between the rain falling and the spring, for example, in one day or two days, new features, rainfall data after one day and rainfall data after two days, are added to the dataset.","d8018bb2":"* From the distribution of the missing values, the missing values of the predicted variables are mainly concentrated **before 3080 rows**, and the correlation between **Volume and predicted variables has a high correlation**, which indicates that Volume greatly affects the predicted variables. ","548c2821":"* For Temperature and Rainfall, we will use the daily average of each year to fill in the missing values.","654b8b54":"Teams member:\nyuchunsing1@gmail.com -- Chun Sing Yu\nzacarysun@gmail.com -- Zacary Sun","0c99e0ed":"* This waterbody consists of two subsystems, called NORTH and SOUTH, where the former partly influences the behavior of the latter. Indeed, the north subsystem is a water table (or unconfined) aquifer while the south subsystem is an artesian (or confined) groundwater.\n\n* The levels of the NORTH sector are represented by the values of the SAL, PAG, CoS and DIEC wells, while the levels of the SOUTH sector by the LT2 well.\n\n* Let's take a quick look at the dataset, there are 8154 rows, where Depth_to_Groundwater LT2\/SAL\/CoS are the values we need to predict. There are 4802, 4545, 4315 rows respectively. ","42598263":"# Water_Spring Amiata","122bc38b":"* Since temperature has an obvious seasonal trend, we can use the **mean value of the temperature** on the same date in different years to fill the missing value, and we replace the feature names with **Temperature_name_x**","398326a5":"* Here Extra Trees Regressor is the best performer with an RMSE of 4.0868. Next, we will conduct the following model tuning. The explanation of the Extra Tree Regressor model was explained in the first half of the notebook.\n\n* The below is the hyperparameter we would like to use for Final Extra Tree Regressor.","de658bf0":"## Aquifer_Auser Prediction\n\n* There are three Target Variable:\n    *  Depth_to_Groundwater_SAL\n    *  Depth_to_Groundwater_LT2\n    *  Depth_to_Groundwater_CoS","96c11388":"## Water_Spring Lupa Prediction\n\n* The Target variable in Lupa is **Flow_Rate Lupa**","1c538e0d":"## Helper Functions we create","1de1a26b":"* A spring is formed when the water reaches the surface through a fracture or porous layer. These types of springs usually occur along faults (a fracture in the earth), or in areas of great topographic relief such as cliffs or valleys.","ecea3698":"### Flow_Rate_Arbure","2eb65f73":"## Aquifer_Auser Exploratory Data Analysis","6a8ac3b2":"* **PyCaret** is an open-source, low-code machine learning library in Python that aims to reduce the cycle time from hypothesis to insights. It is well suited for seasoned data scientists who want to increase the productivity of their ML experiments by using PyCaret in their workflows or for citizen data scientists and those new to data science with little or no background in coding. PyCaret allows you to go from preparing your data to deploying your model within seconds using your choice of notebook environment. [(PyCaret)](https:\/\/pycaret.org)","37a04f69":"* In addition, we also take seasonal factors into consideration. It can be seen from the lake level that the change of the target value has a certain seasonal trend, so we created a set of ***seasonal features***, which are ***dummy variables***. For example, when it is in winter, the value of feature ***winter*** is 1 and the value of other features are 0.","fef8985b":"* The wells field Doganella is fed by two underground aquifers not fed by rivers or lakes but fed by meteoric infiltration. The upper aquifer is a water table with a thickness of about 30m. \n\n\n* The lower aquifer is a semi-confined artesian aquifer with a thickness of 50m and is located inside lavas and tufa products. These aquifers are accessed through wells called Well 1, ..., Well 9. \n\n\n* Approximately 80% of the drainage volumes come from the artesian aquifer. The aquifer levels are influenced by the following parameters: rainfall, humidity, subsoil, temperatures and drainage volumes.\n\n\n\n\n\n* Let's take a quick look at the data set, there are 6026 rows in total, where the variables to be predicted are Depth_to_Groundwater_Pozzo 1-9 and 2500 rows of data respectively.","22135b17":"## Lake Exploratory Data Analysis","8d07fa69":"# Aquifer","a476edeb":"### Depth_to_Groundwater_Pozzo_8\n","aa5cab72":"* We get this Parameter as the best performance hyperparameter for ***Cat Boost Regressor***:","e6d09d78":"## Lake Prediction","ed15be0d":"* Here ***Catboost Regressor*** is the best performer with an RMSE of ***0.4435***. Next, we will conduct the following model tuning. The explanation of the Extra Tree Regressor model was explained in the first half of the notebook.","5b3afdbf":"## Data Overview\n\n* Since Acea Groups is an Italian multiutility operator, we are looking at datasets containing information about **waterbodies in Italy**. The Acea Group deals with four different type of waterbodies: \n    1. water springs\n    2. lakes\n    3. rivers \n    4. aquifers.\n* Each waterbody has such unique characteristics that their attributes are not linked to each other. This analytics competition uses datasets that are completely independent from each other. However, it is critical to understand total availability in order to preserve water across the country.","1bbc9652":"## River Data Preprocessing\n\n* We fill the missing value of ***Temperature*** by using the mean value, which is the mean of all temperature in the same day with different year.For example, in 2009 March 1st,there is a missing value of temperature, we fill the value by averaging the temerature in 2001,2002\u2026\u20262007,2010\u2026\u2026 March 1st.","cc98d1c2":"## Exploratory Data Analysis","f1c7b0cc":"* In the data of the feature ***temperature_Bastia_Umbra***, we found that from 2015 to 2016, the values of temperature which are ***equal to 0***, are very unusual during a period of time. So we see them as outliers and replaced these outliers with ***NAN***.","e434f34b":"### Flow_Rate_Galleria_Alta","2c7ad4d3":"### Depth_to_Groundwater_Pozzo_3\n","05f9d114":" * From the first batch of training, catboost pefrom the best pefromance with RMSE = 2.6978, therefore we would like to use Extra tree Regressor to do the parameter training for 100 iterations.\n   \n * ***CatBoost*** is an open-source software library developed by Yandex. It provides a gradient boosting framework which attempts to solve for Categorical features using a permutation driven alternative compared to the classical algorithm.","2e1974f8":"## Aquifer_Luco Prediction","8baf485c":"* Only keep the range where the predicted value has a value.","404cecfc":"Bilancino lake is an artificial lake located in the municipality of Barberino di Mugello (about 50 km from Florence). It is used to refill the Arno river during the summer months. Indeed, during the winter months, the lake is filled up and then, during the summer months, the water of the lake is poured into the Arno river.","55e50b31":"* Only the part of the prediction Flow_Rate_Madonna_di_Canneto that is not missing is left.","54b14b48":"* Here ***Extra Trees Regressor*** is the best performer with an RMSE of **0.0358**. Next, we will conduct the following model tuning. The explanation of the Extra Tree Regressor model was explained in the first half of the notebook.\n\n* The below is the hyperparameter we would like to use for Final Extra Tree Regressor.","d93e3948":"* The Luco wells field is fed by an underground aquifer.\n* This aquifer not fed by rivers or lakes but by meteoric infiltration at the extremes of the ***impermeable sedimentary layers***,which means rainfall may have limited impact on this aquifer","df114b00":"# River\n\n","8b544eb2":"* Simillar to the Rainfall, some Temperature variable and Hydrometry variable are high corrleated to each other, this is also due to that the location of those vairable are relatively close. Therefore,we would like to do dimension reduction\n\n* High correlated Temperature: ***['Temperature_Monte_Serra', 'Temperature_Ponte_a_Moriano_x', 'Temperature_Lucca_Orto_Botanico']***\n\n* High correlated Hydrometry: ***['Hydrometry_Monte_S_Quirico', 'Hydrometry_Piaggione']***","bc7618e6":"* **corr_plot(data,figsize = (10,6))**: It is used to show the correlation among different features.\n* **vis(data)**: It is used to visualize the data of different features by lineplot.\n* **time(data)**: It is used to transform the data type of 'Date' to datetime. In addition, it add two features of time: month and day.\n* **takecolumn(data)**: It is used to extract the names of features with the same type, returned in the form of a list, such as rainfall, temperature, etc.\n* **moreday(data,Columns,days,Dimension)**: It is used to create a lag term of a specific feature as a new feature.\n* **season(data)**: It is used to generate seasonal variables as new features, these variables are all dummy variables. And the division of seasons is based on the Italian climate.\n* **SNEnewcolumn(data,col,compnum,define)**: It is used to reduce dimensionality with the method of TSNE.\n* **AVG(data, column, Dimension, define)**: It is used to generate the moving average value as new feature, and it can also reduce the new features' dimensionality","68bdf83d":"## Aquifer_Auser Data preprocessing","584a7d50":"## River Exploratory Data Analysis\nLets go through the River data quickly, It has ***8217*** columns in the datasets with 15 dependent variable in this dataset, the independent vraiable is ***Hydrometry_Nave_di_Rosano*** with 8169 variables.","6d4d3607":"# Aquifer_Auser"}}