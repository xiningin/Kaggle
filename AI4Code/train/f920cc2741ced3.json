{"cell_type":{"669b1ac9":"code","d31bfafa":"code","6c1240c0":"code","b4311ea3":"code","b44a7ded":"code","b3c93698":"code","bff3cf2e":"code","444a3a3c":"code","bd1f996c":"code","e31c3a7b":"code","0f2af9b6":"code","e2ea4b6c":"code","81fbec68":"code","d8ea48fd":"code","54c463b3":"code","110e7f34":"code","c312712c":"code","c8dd1d0a":"code","15b274aa":"code","eecc420a":"code","ad8fcd15":"code","2d4e9de4":"code","8688d1e1":"code","63ec867c":"code","10d06e52":"code","11176e1d":"markdown","d59beee1":"markdown","acee7744":"markdown","f57c34f1":"markdown","4807ae18":"markdown","42bb574e":"markdown","9e0273a9":"markdown","0878742a":"markdown","494235fe":"markdown","c052d863":"markdown","cb027c12":"markdown","9748d6ff":"markdown","138c1032":"markdown","d7bc32e1":"markdown","9929e034":"markdown","02b4d037":"markdown"},"source":{"669b1ac9":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","d31bfafa":"df_hapiness = pd.read_csv(\"..\/input\/world-happiness-report-2021\/world-happiness-report.csv\")\ndf_hapiness.head()","6c1240c0":"df_hapiness_2021 = pd.read_csv(\"..\/input\/world-happiness-report-2021\/world-happiness-report-2021.csv\")\ndf_hapiness_2021.head()","b4311ea3":"df_hapiness.dtypes","b44a7ded":"df_hapiness_2021.dtypes","b3c93698":"print(\"====== Null Percentage on df_hapiness ======\")\ndf_hapiness.isnull().sum()*100\/len(df_hapiness)","bff3cf2e":"df_hapiness.fillna(0,inplace= True)","444a3a3c":"print(\"====== Null Percentage on df_hapiness_2021 ======\")\ndf_hapiness_2021.isnull().sum()*100\/len(df_hapiness_2021)","bd1f996c":"df_hapiness.describe()","e31c3a7b":"df_hapiness_2021.describe()","0f2af9b6":"figure, axes = plt.subplots(7,2,figsize=(15,20))\n\n\nsns.barplot(data=df_hapiness_2021.sort_values(by=\"Ladder score\", ascending=False).head(10), \n            x=\"Ladder score\", y=\"Country name\", palette=\"Greens_r\", ax=axes[0,0]).set_title(\"Top 10 - Ladder score\", fontweight=\"bold\")\nsns.barplot(data=df_hapiness_2021.sort_values(by=\"Ladder score\", ascending=False).tail(10), \n            x=\"Ladder score\", y=\"Country name\", palette=\"Reds\", ax=axes[0,1]).set_title(\"Last 10 - Ladder score\", fontweight=\"bold\")\n\nsns.barplot(data=df_hapiness_2021.sort_values(by=\"Logged GDP per capita\", ascending=False).head(10), \n            x=\"Logged GDP per capita\", y=\"Country name\", palette=\"Greens_r\", ax=axes[1,0]).set_title(\"Top 10 - Logged GDP per capita\", fontweight=\"bold\")\nsns.barplot(data=df_hapiness_2021.sort_values(by=\"Logged GDP per capita\", ascending=False).tail(10), \n            x=\"Logged GDP per capita\", y=\"Country name\", palette=\"Reds\", ax=axes[1,1]).set_title(\"Last 10 - Logged GDP per capita\", fontweight=\"bold\")\n\nsns.barplot(data=df_hapiness_2021.sort_values(by=\"Social support\", ascending=False).head(10), \n            x=\"Social support\", y=\"Country name\", palette=\"Greens_r\", ax=axes[2,0]).set_title(\"Top 10 - Social support\", fontweight=\"bold\")\nsns.barplot(data=df_hapiness_2021.sort_values(by=\"Social support\", ascending=False).tail(10), \n            x=\"Social support\", y=\"Country name\", palette=\"Reds\", ax=axes[2,1]).set_title(\"Last 10 - Social support\", fontweight=\"bold\")\n\nsns.barplot(data=df_hapiness_2021.sort_values(by=\"Healthy life expectancy\", ascending=False).head(10), \n            x=\"Healthy life expectancy\", y=\"Country name\", palette=\"Greens_r\", ax=axes[3,0]).set_title(\"Top 10 - Healthy life expectancy\", fontweight=\"bold\")\nsns.barplot(data=df_hapiness_2021.sort_values(by=\"Healthy life expectancy\", ascending=False).tail(10), \n            x=\"Healthy life expectancy\", y=\"Country name\", palette=\"Reds\", ax=axes[3,1]).set_title(\"Last 10 - Healthy life expectancy\", fontweight=\"bold\")\n\nsns.barplot(data=df_hapiness_2021.sort_values(by=\"Freedom to make life choices\", ascending=False).head(10), \n            x=\"Freedom to make life choices\", y=\"Country name\", palette=\"Greens_r\", ax=axes[4,0]).set_title(\"Top 10 - Freedom to make life choices\", fontweight=\"bold\")\nsns.barplot(data=df_hapiness_2021.sort_values(by=\"Freedom to make life choices\", ascending=False).tail(10), \n            x=\"Freedom to make life choices\", y=\"Country name\", palette=\"Reds\", ax=axes[4,1]).set_title(\"Last 10 - Freedom to make life choices\", fontweight=\"bold\")\n\nsns.barplot(data=df_hapiness_2021.sort_values(by=\"Generosity\", ascending=False).head(10), \n            x=\"Generosity\", y=\"Country name\", palette=\"Greens_r\", ax=axes[5,0]).set_title(\"Top 10 - Generosity\", fontweight=\"bold\")\nsns.barplot(data=df_hapiness_2021.sort_values(by=\"Generosity\", ascending=False).tail(10), \n            x=\"Generosity\", y=\"Country name\", palette=\"Reds\", ax=axes[5,1]).set_title(\"Last 10 - Generosity\", fontweight=\"bold\")\n\nsns.barplot(data=df_hapiness_2021.sort_values(by=\"Perceptions of corruption\", ascending=True).head(10), \n            x=\"Perceptions of corruption\", y=\"Country name\", palette=\"Greens_r\", ax=axes[6,0]).set_title(\"Top 10 - Perceptions of corruption\", fontweight=\"bold\")\nsns.barplot(data=df_hapiness_2021.sort_values(by=\"Perceptions of corruption\", ascending=True).tail(10), \n            x=\"Perceptions of corruption\", y=\"Country name\", palette=\"Reds\", ax=axes[6,1]).set_title(\"Last 10 - Perceptions of corruption\", fontweight=\"bold\")\n        \nplt.tight_layout()\nplt.show()","e2ea4b6c":"corr = df_hapiness_2021[[\"Logged GDP per capita\", \"Social support\", \"Healthy life expectancy\", \"Freedom to make life choices\",\"Generosity\",\"Perceptions of corruption\", \"Ladder score\"]].corr()\nplt.figure(figsize=(10, 5))\nsns.heatmap(corr, annot=True)\nplt.title(\"Heatmap\", fontweight = \"bold\")\nplt.show()","81fbec68":"v_vars = [\"Ladder score\", \"Logged GDP per capita\", \"Social support\", \"Healthy life expectancy\", \n          \"Freedom to make life choices\", \"Generosity\", \"Perceptions of corruption\"]\n\nsns.pairplot(data=df_hapiness_2021[v_vars])\n\nplt.show()","d8ea48fd":"figure, axes = plt.subplots(nrows=3, figsize=(15, 15))\n\nsns.set(style=\"ticks\")\nsns.scatterplot(x=\"Healthy life expectancy\", y=\"Logged GDP per capita\", data=df_hapiness_2021, color=\"black\",ax=axes[0])\nsns.regplot(x=\"Logged GDP per capita\", y=\"Ladder score\", data=df_hapiness_2021,color=\"darkblue\", ax=axes[1])\nsns.regplot(x=\"Healthy life expectancy\", y=\"Ladder score\", data=df_hapiness_2021, color=\"darkred\",ax=axes[2])\n\nplt.show()\nplt.close()","54c463b3":"sns.set(style=\"white\", font_scale=1.5)\nplt.figure(figsize=(20, 6))\n\ng = sns.boxplot(x=\"Regional indicator\", y=\"Ladder score\", data=df_hapiness_2021)\ng.set_xlabel(\"Region\",fontsize=15)\ng.set_ylabel(\"Ladder Score\",fontsize=15)\n\nplt.xticks(rotation=90)\nplt.title(\"Life Ladder Score Box Plot by Region\", fontsize=20)\nplt.show()","110e7f34":"df_hapiness[\"Score_Catg\"] = np.select(\n                            [\n                                df_hapiness[\"Life Ladder\"].between(0,4,inclusive=True),\n                                df_hapiness[\"Life Ladder\"].between(4,7,inclusive=False),\n                                df_hapiness[\"Life Ladder\"].between(7,10,inclusive=True)\n                            ],\n                            [\n                                \"Sad\",\n                                \"Normal\",\n                                \"Happy\"\n                            ]\n                        )","c312712c":"import matplotlib.ticker as mtick\n\nstck = df_hapiness.groupby(\"year\")[\"Score_Catg\"].value_counts(normalize=True).unstack().reset_index().fillna(0)\n\norder = [\"year\",\"Sad\",\"Normal\",\"Happy\"]\n\nstck = stck.reindex(columns=order)\n\nstck.plot(\n            x = \"year\",\n            kind = \"bar\",\n            stacked = True,\n            color = [\"#AD1524\", \"#FFBE16\", \"#00BF45\"],\n            figsize=(15,5)     \n        ).yaxis.set_major_formatter(mtick.PercentFormatter(xmax=1))\n\nplt.xlabel(\"Year\", fontsize=15)\nplt.ylabel(\"Percentage\", fontsize=15)\nplt.title(\"Happiness Distribuiton\", fontweight=\"bold\", fontsize=20)\n\nplt.legend(loc=\"upper left\", bbox_to_anchor=(1,1), ncol=1)\n\nplt.show()\n","c8dd1d0a":"for varname in v_vars:\n    \n    if varname != \"Perceptions of corruption\":            \n        df_sort = df_hapiness_2021.sort_values(by=varname, ascending=False).reset_index(drop=True) \n        print(\"== Brazil is on {}th place of {} in the World {} Ranking ==\".format(\n            df_sort.index[df_sort[\"Country name\"] == \"Brazil\"].tolist()[0]+1, len(df_sort), varname))\n        \n        del df_sort\n        \n    else:\n        df_sort = df_hapiness_2021.sort_values(by=varname, ascending=True).reset_index(drop=True)      \n        print(\"== Brazil is on {}th place of {} in the World {} Ranking ==\".format(\n            df_sort.index[df_sort[\"Country name\"] == \"Brazil\"].tolist()[0]+1, len(df_sort), varname))\n        \n        del df_sort\n","15b274aa":"#Renaming columns\ndf_hapiness_2021.rename(columns={\"Ladder score\": \"Life Ladder\", \"Logged GDP per capita\": \"Log GDP per capita\",\n                                \"Healthy life expectancy\": \"Healthy life expectancy at birth\"\n                                }, inplace=True)\n\n#Adding year\ndf_hapiness_2021[\"year\"] = 2021\n\ncol = [\"Country name\", \"year\", \"Life Ladder\", \"Log GDP per capita\", \"Social support\", \"Healthy life expectancy at birth\",\n      \"Freedom to make life choices\", \"Generosity\", \"Perceptions of corruption\"]\n\ndf_hapiness_2021_v2 = df_hapiness_2021[col]\ndf_hapiness_v2 = df_hapiness[col]\n\n#Appending both datasets \ndf_all = pd.concat([df_hapiness_v2, df_hapiness_2021_v2])\n\n#Separates Brazil from the others\ndf_all[\"View\"] = np.where(df_all[\"Country name\"]==\"Brazil\",\"Brazil\",\"World\")\n","eecc420a":"df_all[df_all[\"View\"]==\"Brazil\"]","ad8fcd15":"newRow = {\"Country name\":\"Brazil\", \"year\":2006, \"Life Ladder\":np.nan, \n          \"Log GDP per capita\":np.nan, \"Social support\": np.nan, \"Healthy life expectancy at birth\": np.nan,\n          \"Freedom to make life choices\": np.nan, \"Generosity\": np.nan, \"Perceptions of corruption\": np.nan,\n          \"View\": \"Brazil\"}\n\ndf_all = df_all.append(newRow, ignore_index=True)\n\nto_fill = [\"Life Ladder\", \"Log GDP per capita\", \"Social support\", \"Healthy life expectancy at birth\",\n          \"Freedom to make life choices\", \"Generosity\", \"Perceptions of corruption\"]\n\nfor i in to_fill:\n        df_all[i] = df_all[i].fillna(\n                     df_all[(df_all[\"Country name\"]==\"Brazil\") & (df_all[\"year\"].isin([2005,2007]))].mean()[i])","2d4e9de4":"#Sorting by year\ndf_all.sort_values(by=\"year\", inplace=True)\ndf_all[df_all[\"View\"]==\"Brazil\"]","8688d1e1":"#In order to plot the features along years, let's get the average of our numerical variables and then group by year and View\ndf_plt = df_all.groupby([\"year\", \"View\"], as_index=False).mean()\ndf_plt.head()","63ec867c":"figure, axes = plt.subplots(nrows=7, figsize=(15,20))\n\nfigure.suptitle(\"Brazil and the World average\",fontweight=\"bold\", fontsize=20)\n\npalette = {c:\"#008A2D\" if c==\"Brazil\" else \"#D6D8DD\" for c in df_plt[\"View\"].unique()}\n\nsns.pointplot(x=\"year\", y=\"Life Ladder\", data=df_plt, hue=\"View\", palette=palette, ax=axes[0])\nsns.pointplot(x=\"year\", y=\"Log GDP per capita\", data=df_plt, hue=\"View\", palette=palette, ax=axes[1])\nsns.pointplot(x=\"year\", y=\"Social support\", data=df_plt, hue=\"View\", palette=palette, ax=axes[2])\nsns.pointplot(x=\"year\", y=\"Healthy life expectancy at birth\", data=df_plt, hue=\"View\", palette=palette, ax=axes[3])\nsns.pointplot(x=\"year\", y=\"Freedom to make life choices\", data=df_plt, hue=\"View\", palette=palette, ax=axes[4])\nsns.pointplot(x=\"year\", y=\"Generosity\", data=df_plt, hue=\"View\", palette=palette, ax=axes[5])\nsns.pointplot(x=\"year\", y=\"Perceptions of corruption\", data=df_plt, hue=\"View\", palette=palette, ax=axes[6])\n\naxes[0].set_ylabel(\"Life Ladder\",fontsize=15)\naxes[1].set_ylabel(\"Log GDP per capita\",fontsize=15)\naxes[2].set_ylabel(\"Social support\",fontsize=15)\naxes[3].set_ylabel(\"Healthy life expectancy\",fontsize=15)\naxes[4].set_ylabel(\"Freedom to make choices\",fontsize=15)\naxes[5].set_ylabel(\"Generosity\",fontsize=15)\naxes[6].set_ylabel(\"Perceptions of corruption\",fontsize=15)\n\n\n\n#Removing each subplot legend except for the first subplot\nfor k in range(7):\n    if k == 0:\n        axes[k].legend(loc=\"upper right\", bbox_to_anchor=(1.15,1.1), ncol=1) #Legend position\n    else:\n        axes[k].get_legend().remove()\n\nplt.tight_layout()\nplt.show()","10d06e52":"south_america = df_hapiness_2021[df_hapiness_2021[\"Country name\"].isin(\n                                                                    [\"Argentina\" ,\"Bolivia\" ,\"Brazil\" ,\"Chile\" ,\n                                                                     \"Colombia\" ,\"Ecuador\" ,\"Paraguay\" ,\"Peru\" ,\n                                                                     \"Uruguay\" ,\"Venezuela\"]\n                                                                  )].sort_values(by=\"Country name\").drop([\"Regional indicator\", \"Life Ladder\",\n                                                                     \"Standard error of ladder score\", \"upperwhisker\", \"lowerwhisker\",\n                                                                     \"Log GDP per capita\", \"Social support\",\n                                                                     \"Healthy life expectancy at birth\", \"Freedom to make life choices\",\n                                                                     \"Generosity\", \"Perceptions of corruption\", \"Ladder score in Dystopia\",\n                                                                    \"Dystopia + residual\", \"year\"], axis=1)\n\n\n\nsouth_america.plot(\n            x = \"Country name\",\n            kind = \"bar\",\n            stacked = True,\n            figsize=(15,5)     \n        )\n\nplt.title(\"South America Explained Life Ladder\", fontweight=\"bold\", fontsize=20)\nplt.ylabel(\"Explained Score\") \nplt.xlabel(\"Country Name\") \nplt.xticks(rotation=45)\n\nplt.legend(loc=\"lower center\", bbox_to_anchor=(0.5,-0.7), ncol=3)\n\nplt.show()","11176e1d":"**How's Ladder Score according to the Regional Indicator?**","d59beee1":"# Comparison between South America's Countries","acee7744":"The worst indicator in Brazil is Generosity, followed by Healthy life expectancy and Freedom to make life choices.\n\nBrazil's Life Ladder (6.330) is above the 75 Percentile, so we can consider this value as a great one!","f57c34f1":"Firstly, we can easily notice that the explained features on Life Ladder are kinda balanced all over South America, with some caveats to consider:\n\n- Our Life Ladder scores are mainly explained by GDP per capita and Social Support.\n\n- Uruguay's Perception of corruption outstands among other countries, this is because they have the lowest rate of corruption in South America. Otherwise, we can't conclude the same for Peru and Paraguay, which have the highest values.\n\n- About Generosity, the most prominent is Paraguay.\n\n- Venezuela is the least free to make life choices.\n\n- Bolivia has the lowest Healty life expectancy and GDP per capita values in South America.\n\n- Argentina, Chile and Uruguay are leadding GDP per capita.\n","4807ae18":"Ok, now let's find out which variables are statistically significant with \"Ladder Score\":","42bb574e":"# Zooming in Brazil","9e0273a9":"Brazil's Life Ladder Score decreases from 2014 on. But, it's still above the World average. Currently, it's showing a little sign of increasing.\n\nOur GDP per capita has remained constant over the past few years. We can observe a little decrease between 2019 and 2020. This was certainly affected by Covid-19.\n\nSocial support suffered a high decrease in 2020, that's also explained by the Covid-19 pandemic.\n\nHealthy life expectancy was slightly increasing but in 2021 it has been a little lower than in 2020.\n\nBrazil's Freedom to make life choices has an unstable behaviour. On Generosity, Brazil is below the World average, what is bad.\n\nSince 2014, Brazil has been on a high level on Perceptions of corruption, overcoming the World average.\n\n","0878742a":"# Global Analysis","494235fe":"- Western Europe and North America & ANZ have the happiest people and this is also visible due to its small variability on ther opinion.\n\n- The saddest people are both in South Asia and Sub-Saharan Africa\n\n- Middle East\/North Africa, Sub-Saharan Africa and South Asia have the widest ranges of Ladder Score values (Not considering Latin America\/Caribbean outliers)","c052d863":"Well, we can see that Brazil's 2006 Life Score is missing, let's atrribute its value by the average of 2005 and 2007:\n","cb027c12":"GDP per capita, Healthy life expectancy and Social support respectively can clearly explain the overall country's happiness score. It's important to notice the high correlation between GDP per capita and Healthy life expectancy. Obviously, the higher the GDP, the greater are the investments on healthcare systems and as a consequence people live longer.\n\nLet'se take a closer look:","9748d6ff":"- In 2005, there was no \"Sad\" Country in the World and around 38% of them were \"Happy\"!\n- Every year, most countries are classified as \"Normal\".\n- The \"Sad\" percentange decreases between 2019 - 2020, even though the struggle against Covid-19 pandemic.","138c1032":"**Ladder Score**:\n- As we can see, the top 10 Happiest countires are mostly in Europe while the 10 Saddest are some in Sub Saharan Africa, some in South Asia, Caribbean and Middle East. Finland, Denamark and Switzerland are the top 3.\n\n**Logged GDP per capita**:\n- Luxembourg has the higher GDP per capita. United Arab Emirates and Hong Kong\/China also stands out at this rank. However, all of the lastest countries are in Sub-Saharan Africa, except for Haiti, which is located in Caribbean.\n\n**Social Support**:\n- Iceland is on the top of Social support. Kazakhstan and Turkmenistan (Commonwealth of Idepentent States) have one of the greatest social support indicator. The thing is that, despite of its high populational density, India have one of the worst social support.\n\n**Healthy life expectancy**:\n- Singapore and Hong Kong\/China are almost tied on Healthy life expectancy (around 77 y.o.). it's seen that the best healthy life expectancy are mixed between Europe and Asia. People in Chad live around only 48 y.o. and Afghaninstan is in this range as well.\n\n**Freedom to make life choices**:\n- Uzbekistan, Norway and Cambodia have the highest freedom values while Afghanistan has the lowest one. Greece, Urkey, Lebanon and Algeria are in bad rates too.\n\n**Generosity**:\n- Indonesia and Myanmar are the two most generous countries in the World, showing a great difference between the others which is in this rank. Haiti shows up in one of the best too. Greece and Japan have the worst generosity values, followed by Botswana and Portugal.\n\n**Perceptions of corruption**\n- Singapore and Rwanda have the lowest values of perception of corruption, which is good. But, Croatia, Romania and Bulgaria have high perception of corruption. These 3 are in Central and Eastern Europe.","d7bc32e1":"Creating a categorical variable for Ladder Score based on its range so that we can analyze the \"behavioral happiness\" along the years:","9929e034":"Let's fill all the missing values to 0","02b4d037":"# Data Understanding\n\nLife Ladder - It's a range from 0 to 10 where 0 represents the worst possible life while 10 stands for the \"perfect life\".\n\nGDP per capita - It indicates a country's economic by its population. In other words, it's known as a country's standard of living based on its economy.\n\nSocial support - Perception of available assistance among people, involving a network of a family and friends. It's also related to psychological health\n\nHealthy life expectancy at birth - It's the average life in good health that a person could expect to live\n\nFreedom to make life choices - Concerns to someone's autonomy according to a will or preference.\n\nGenerosity - Refers to an overall spirit of kindness. It can involve offering time, assets or talents to aid someone in need.\n\nPerceptions of corruption - Perceived levels of public sector corruption, as determined by expert assessments and opinion surveys"}}