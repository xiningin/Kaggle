{"cell_type":{"efe63d46":"code","f89f10e5":"code","e209e568":"code","6c472e63":"code","a062b87b":"code","a03b783c":"code","2e7e755a":"code","a3af840d":"code","f2eb5d22":"code","bc3bf304":"code","fc1ad11a":"code","12bef3f3":"code","1d32f402":"code","9ca7e218":"code","be30720a":"markdown","ad844ab6":"markdown"},"source":{"efe63d46":"!pip install pycaret\n!pip install streamlit","f89f10e5":"#loading liberaries\nfrom sklearn.datasets import load_wine\nimport pandas as pd\nfrom pycaret.classification import *\nfrom pycaret.classification import load_model, predict_model\nimport streamlit as st\nimport numpy as np","e209e568":"#loading the dataset \ndata = load_wine(as_frame=True)","6c472e63":"#seprating the data and labels\ndf = data.data\nlabel = data.target","a062b87b":"#view first 5 rows in the dataset\ndf.head()","a03b783c":"#now combining the data and labels into the dataframe\n\nd = {'quality':label}\nlabel = pd.DataFrame(d)\n\ndataset = pd.concat([df,label],axis=1)\ndataset.head()","2e7e755a":"#droping the unnescessary columns\ndataset.drop(['proline','od280\/od315_of_diluted_wines'],inplace=True,axis=1)\ndataset.shape","a3af840d":"#intilaize your datset\nmodel_classify = setup(dataset,'quality',session_id=45)","f2eb5d22":"%%time\n#compare the different models\nbest = compare_models()","bc3bf304":"#create your own best model\net_model = create_model('et')","fc1ad11a":"#evaluate your model\nevaluate_model(et_model)","12bef3f3":"#predict your model \npredict_model(et_model)","1d32f402":"#save your model \nsave_model(et_model, model_name = 'extra_tree_model')","9ca7e218":"def predict_quality(model, df):\n    \n    predictions_data = predict_model(estimator = model, data = df)\n    return predictions_data['Label'][0]\n    \n\nmodel = load_model('.\/extra_tree_model')\n\n\nst.title('Wine Quality Classifier Web App')\nst.write('This is a web app to classify the quality of your wine based on\\\n         several features that you can see in the sidebar. Please adjust the\\\n         value of each feature. After that, click on the Predict button at the bottom to\\\n         see the prediction of the classifier.')\n\nfixed_acidity = st.sidebar.slider(label = 'Fixed Acidity', min_value = 4.0,\n                          max_value = 16.0 ,\n                          value = 10.0,\n                          step = 0.1)\n\nvolatile_acidity = st.sidebar.slider(label = 'Volatile Acidity', min_value = 0.00,\n                          max_value = 2.00 ,\n                          value = 1.00,\n                          step = 0.01)\n                          \ncitric_acid = st.sidebar.slider(label = 'Citric Acid', min_value = 0.00,\n                          max_value = 1.00 ,\n                          value = 0.50,\n                          step = 0.01)                          \n\nresidual_sugar = st.sidebar.slider(label = 'Residual Sugar', min_value = 0.0,\n                          max_value = 16.0 ,\n                          value = 8.0,\n                          step = 0.1)\n\nchlorides = st.sidebar.slider(label = 'Chlorides', min_value = 0.000,\n                          max_value = 1.000 ,\n                          value = 0.500,\n                          step = 0.001)\n   \nf_sulf_diox = st.sidebar.slider(label = 'Free Sulfur Dioxide', min_value = 1,\n                          max_value = 72,\n                          value = 36,\n                          step = 1)\n\nt_sulf_diox = st.sidebar.slider(label = 'Total Sulfur Dioxide', min_value = 6,\n                          max_value = 289 ,\n                          value = 144,\n                          step = 1)\n\ndensity = st.sidebar.slider(label = 'Density', min_value = 0.0000,\n                          max_value = 2.0000 ,\n                          value = 0.9900,\n                          step = 0.0001)\n\nph = st.sidebar.slider(label = 'pH', min_value = 2.00,\n                          max_value = 5.00 ,\n                          value = 3.00,\n                          step = 0.01)\n                          \nsulphates = st.sidebar.slider(label = 'Sulphates', min_value = 0.00,\n                          max_value = 2.00,\n                          value = 0.50,\n                          step = 0.01)\n\nalcohol = st.sidebar.slider(label = 'Alcohol', min_value = 8.0,\n                          max_value = 15.0,\n                          value = 10.5,\n                          step = 0.1)\n\nfeatures = {'fixed acidity': fixed_acidity, 'volatile acidity': volatile_acidity,\n            'citric acid': citric_acid, 'residual sugar': residual_sugar,\n            'chlorides': chlorides, 'free sulfur dioxide': f_sulf_diox,\n            'total sulfur dioxide': t_sulf_diox, 'density': density,\n            'pH': ph, 'sulphates': sulphates, 'alcohol': alcohol\n            }\n \n\nfeatures_df  = pd.DataFrame([features],index=None)\n\nst.table(features_df)  \n\nif st.button('Predict'):\n    \n    prediction = predict_quality(model, features_df)\n    \n    st.write(' Based on feature values, your wine quality is '+ str(prediction))","be30720a":"\n\nNow you can make this model as webapp. You need to make a **github repository** which should include your :\n* Model \n* app.py - \n    which contains last cell code \n    \n* requirements.txt - which includes \n    pycaret\n    streamlit\n    pandas\n    numpy\n    \nAfter this you need to make a account on [streamlit](https:\/\/share.streamlit.io\/) and connect your github account and thats it .\n\n\nYou can take reference from this [link](https:\/\/towardsdatascience.com\/pycaret-and-streamlit-how-to-create-and-deploy-data-science-web-app-273d205271a3)\n","ad844ab6":"Now lets us use saved model for the **prediction**"}}