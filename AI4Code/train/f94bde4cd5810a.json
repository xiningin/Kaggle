{"cell_type":{"ee3b1008":"code","d4594c9a":"code","395efad8":"code","bdba01ff":"code","b62442e8":"code","b236b1f4":"code","4c19a970":"code","3d40acab":"code","161a5c46":"code","48ed6f00":"code","611778ad":"code","3c0cd346":"markdown","2887c608":"markdown","3c602a0e":"markdown","36e38d32":"markdown","23d3a47e":"markdown","39228d77":"markdown","512b63b9":"markdown","b617d4c3":"markdown","3576b55a":"markdown","efc26803":"markdown","0d9a056e":"markdown","9db35198":"markdown"},"source":{"ee3b1008":"import os, shutil\n\nimport numpy as np \nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom tqdm import tqdm_notebook\n\nimport warnings\nwarnings.filterwarnings(action='ignore')\n\nprint(os.listdir(\"..\/input\"))","d4594c9a":"DATA_PATH =\"..\/input\/2019-3rd-ml-month-with-kakr\"\nDATA_PATH2 =\"..\/input\/car-crop\"","395efad8":"# \uc774\ubbf8\uc9c0 \ud3f4\ub354 \uacbd\ub85c\nTRAIN_IMG_PATH = os.path.join(DATA_PATH, 'train')\nTEST_IMG_PATH = os.path.join(DATA_PATH, 'test')\n\nTRAIN_IMG_PATH2 = os.path.join(DATA_PATH2, 'train_crop')\nTEST_IMG_PATH2 = os.path.join(DATA_PATH2, 'test_crop')\n\n# CSV \ud30c\uc77c \uacbd\ub85c\ndf_train = pd.read_csv(os.path.join(DATA_PATH, 'train.csv'))\ndf_test = pd.read_csv(os.path.join(DATA_PATH, 'test.csv'))\ndf_class = pd.read_csv(os.path.join(DATA_PATH, 'class.csv'))","bdba01ff":"df_class2 = df_class.copy()\ndf_class2.rename(columns={'id':\"class\"},inplace=True)","b62442e8":"comb = pd.merge(df_train, df_class2)\ncomb.head()","b236b1f4":"import PIL\nfrom PIL import ImageDraw\n\n#\ub79c\ub358\uc73c\ub85c 10\uac1c\uc758 file \uc120\ud0dd\ud558\uae30\ntmp_imgs = np.random.choice(comb['img_file'],10)\nplt.figure(figsize=(12,15))\n\nfor num, f_name in enumerate(tmp_imgs):\n    img = PIL.Image.open(os.path.join(TRAIN_IMG_PATH, f_name))\n    plt.subplot(5, 2, num + 1)\n    plt.title(comb[comb['img_file']==f_name].reset_index()['name'][0])\n    plt.imshow(img)\n    plt.axis('off')","4c19a970":"import PIL\nfrom PIL import ImageDraw\n\n# merge\ub97c \ud1b5\ud574 \uac19\uc740 \uc885\ub958\uc758 \ucc28\ub4e4\ub07c\ub9ac \ubb36\uc5ec\uc9d0\ntmp_imgs = comb[comb['name']=='Audi S4 Sedan 2012'].iloc[:10,:]['img_file']\nplt.figure(figsize=(12,15))\n\nfor num, f_name in enumerate(tmp_imgs):\n    img = PIL.Image.open(os.path.join(TRAIN_IMG_PATH, f_name))\n    plt.subplot(5, 2, num + 1)\n    plt.title(comb[comb['img_file']==f_name].reset_index()['name'][0])\n    plt.imshow(img)\n    plt.axis('off')","3d40acab":"import PIL\nfrom PIL import ImageDraw\n\n# merge\ub97c \ud1b5\ud574 \uac19\uc740 \uc885\ub958\uc758 \ucc28\ub4e4\ub07c\ub9ac \ubb36\uc5ec\uc9d0\ntmp_imgs = comb[comb['name']=='Audi S4 Sedan 2012'].iloc[:10,:]['img_file']\nplt.figure(figsize=(12,15))\n\nfor num, f_name in enumerate(tmp_imgs):\n    img = PIL.Image.open(os.path.join(TRAIN_IMG_PATH2, f_name))\n    plt.subplot(5, 2, num + 1)\n    plt.title(comb[comb['img_file']==f_name].reset_index()['name'][0])\n    plt.imshow(img)\n    plt.axis('off')","161a5c46":"# \uc774\ubbf8\uc9c0\ub97c \uadf8\ub300\ub85c \uc77d\uc5b4\uc628\ub2e4, \ube44\uad50\ub97c \uc704\ud574 \uc2dc\ub4dc\uace0\uc815\nnp.random.seed(seed=49)\ntmp_imgs =  np.random.choice(comb['img_file'],3,)\nplt.figure(figsize=(15,10))\n\n# \uc774\ubbf8\uc9c0\ub97c \uc2dc\uac01\ud654\ud55c\ub2e4\nfor i, f_name in enumerate(tmp_imgs):\n    img = PIL.Image.open(os.path.join(TRAIN_IMG_PATH2, f_name))\n    plt.subplot(1, 3, i+1)\n    plt.title(comb[comb['img_file']==f_name].reset_index()['name'][0])\n    plt.imshow(img)\n    plt.axis('off')","48ed6f00":"from scipy.ndimage import rotate\n\n# \uc784\uc758\uc758 \ud68c\uc804 \uac01\ub3c4(rotate_angle)\uc744 \uad6c\ud55c \ud6c4, \uc774\ubbf8\uc9c0\ub97c \ud68c\uc804\ud55c\ub2e4.\nrotate_angle = np.random.randint(40) - 20\nprint('# \uc774\ubbf8\uc9c0 \ud68c\uc804 : {}\ub3c4'.format(rotate_angle))\n\n# \uc774\ubbf8\uc9c0\ub97c \uc2dc\uac01\ud654\ud55c\ub2e4.\nnp.random.seed(seed=49)\ntmp_imgs =  np.random.choice(comb['img_file'],3,)\nplt.figure(figsize=(15,10))\nfor i, f_name in enumerate(tmp_imgs):\n    img = PIL.Image.open(os.path.join(TRAIN_IMG_PATH2, f_name))\n    img = rotate(img, rotate_angle)\n    plt.subplot(1, 3, i+1)\n    plt.title(comb[comb['img_file']==f_name].reset_index()['name'][0])\n    plt.imshow(img)\n    plt.axis('off')","611778ad":"import cv2\n# 10x10 \ud06c\uae30\uc758 \ucee4\ub110\ub85c \uc774\ubbf8\uc9c0\ub97c \ud750\ub9b0\ub2e4\nblur_degree = 10\nprint('{}x{} \ucee4\ub110 \ud06c\uae30\ub85c \uc774\ubbf8\uc9c0 \ud750\ub9ac\uae30'.format(blur_degree, blur_degree))\n\n# \uc774\ubbf8\uc9c0\ub97c \uc2dc\uac01\ud654\ud55c\ub2e4.\nnp.random.seed(seed=49)\ntmp_imgs =  np.random.choice(comb['img_file'],3,)\nplt.figure(figsize=(15,10))\n\nfor i, f_name in enumerate(tmp_imgs):\n    img = PIL.Image.open(os.path.join(TRAIN_IMG_PATH2, f_name))\n    #cv2\uc0ac\uc6a9\uc2dc array\ubcc0\uacbd\n    img = np.asarray(img)\n    img = cv2.blur(img,(blur_degree,blur_degree))\n    plt.subplot(1, 3, i+1)\n    plt.title(comb[comb['img_file']==f_name].reset_index()['name'][0])\n    plt.imshow(img)\n    plt.axis('off')","3c0cd346":"### blur","2887c608":"### rotate","3c602a0e":"### random selection of 10\n- \uc815\uba74 \uce21\ubcc0 \ub300\uac01\ub4f1 \ub2e4\uc591\ud55c \uac01\ub3c4\uc758 \ucc28\ub7c9 \uc0ac\uc9c4\uc774 \uc874\uc7ac\n- \uc77c\ubd80 \uc0ac\uc9c4\uc740 \ucc28\ub7c9\ubcf4\ub2e4 \ub113\uc740 \ubc94\uc704\uc758 \ubc30\uacbd\uc744 \uac00\uc9d0\uc73c\ub85c \ubc14\uc6b4\ub4dc\ubc15\uc2a4\ub97c \uc774\uc6a9\ud55c croping\uac00 \ud544\uc694\ud574\ubcf4\uc784","36e38d32":"## augment\n- crop \ub41c \ub370\uc774\ud130\ub97c \ud1b5\ud574 \ub370\uc774\ud130\uc99d\uc2dd\uc744 \ud574\ubcf4\uc790","23d3a47e":"## Data Merge","39228d77":"### bound croping\n\ud5c8\ud0dc\uba85\ub2d8 \ucee4\ub110 https:\/\/www.kaggle.com\/tmheo74\/3rd-ml-month-car-image-cropping-updated-7-10 upvote \ubd80\ud0c1\ub4dc\ub824\uc694\n- \uc704\uc0ac\uc9c4\uacfc \ube44\uad50\ud558\uba74 crop\uac00 \uc798 \ub41c\uac83\uc744 \ubcfc \uc218 \uc788\ub2e4.\n- \uc624\ub978\ucabd \uc544\ub798 \ub124\ubc88\uca30 \uc544\uc6b0\ub514 \uc0ac\uc9c4\uc744 \ubcf4\uba74 \uc544\uc6b0\ub514 \ub85c\uace0\uac04\ud310 \uc544\ub798 \ucc28\uac00 \uc11c\uc788\ub294\ub370 \uc774\ub7f4\uacbd\uc6b0 crop\ub97c \uc548\ud558\ub294 \uac83\uc774 \ud310\ub2e8\ud558\ub294\ub370 \uc788\uc5b4 \uc88b\uc744\uae4c?","512b63b9":"\uc774\uac83\uc73c\ub85c EDA\ub97c \ub9c8\uce58\uace0, \ubaa8\ub378\ucabd\uc73c\ub85c \ub118\uc5b4\uac11\ub2c8\ub2e4.","b617d4c3":"### orignal data","3576b55a":"## Data Path\nDATA_PATH : orignal data\n\nDATA_PATH2 : crop data","efc26803":"## EDA","0d9a056e":"### EDA of 'Audi S4 Sedan 2012'\n- \ub2e4\uc591\ud55c \uc0c9\uae54 \ubc0f \ubc29\ud5a5\uc744 \uac00\uc9c0\uace0 \uc788\ub2e4.\n- \uce21\uba74\uc758 \uacbd\uc6b0 \uc544\uc6b0\ub514 \ub85c\uace0\uac00 \uc5c6\uc5b4 \ubd84\ub958\uac00 \ud798\ub4e4\uc9c0 \uc54a\uc744\uae4c \uc0dd\uac01\ub41c\ub2e4.\n- \uba4b\uc788\ub2e4.\n","9db35198":"# <center>3rd ML Month - Car Model Classification EDA <\/center>"}}