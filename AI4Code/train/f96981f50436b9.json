{"cell_type":{"cdc33627":"code","e01305b2":"code","44af4040":"code","be59fb00":"code","2ad9ea53":"code","d1bc2678":"code","2c2484b3":"code","fee4d9c0":"code","a9067af8":"code","8fcffdd3":"code","d61fbbe4":"code","8e9e51ce":"code","fc73c8fe":"code","21934671":"code","e3ab43c7":"code","51022913":"code","0dc8fc87":"code","5ccac45e":"markdown","dcd3b421":"markdown","834b111f":"markdown","765b44d9":"markdown","e074e9d5":"markdown","7810e361":"markdown","2a582b24":"markdown","74e5ed66":"markdown","00b88722":"markdown","bd03fb1a":"markdown","fa675ee8":"markdown","9e223544":"markdown","40f590bf":"markdown","9dd20455":"markdown"},"source":{"cdc33627":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport keras\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","e01305b2":"df_train = pd.read_csv('\/kaggle\/input\/digit-recognizer\/train.csv')\ndf_test = pd.read_csv('\/kaggle\/input\/digit-recognizer\/test.csv')","44af4040":"y = df_train['label']\ndf_train.drop(['label'], axis=1, inplace=True)\n","be59fb00":"df_train = df_train.values.reshape(-1,28,28,1)\ndf_test = df_test.values.reshape(-1,28,28,1)","2ad9ea53":"x = df_train\nx_predict = df_test","d1bc2678":"g = plt.imshow(x[0][:,:,0])","2c2484b3":"import keras\nfrom keras.utils.np_utils import to_categorical\nfrom keras.models import Sequential\nfrom keras.layers import Dense, Dropout, Flatten, Conv2D, MaxPool2D\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score\n","fee4d9c0":"y = to_categorical(y, 10)","a9067af8":"model = Sequential()\nmodel.add(Conv2D(input_shape=(28,28,1), padding='same', activation='relu', filters = 64, kernel_size=3))\nmodel.add(Conv2D(padding='same', activation='relu', filters=128, kernel_size=3))\nmodel.add(MaxPool2D(pool_size=2))\nmodel.add(Conv2D(padding='same', activation='relu', filters=64, kernel_size=3))\nmodel.add(MaxPool2D(pool_size=2))\nmodel.add(Flatten())\nmodel.add(Dense(256, activation='relu'))\nmodel.add(Dense(10, activation='softmax'))\n\nmodel.compile(optimizer = 'adam', loss = 'categorical_crossentropy', metrics = ['accuracy'])","8fcffdd3":"model.summary()","d61fbbe4":"from sklearn.model_selection import train_test_split\nx_train, x_valid, y_train, y_valid = train_test_split(x, y, train_size = 0.9)","8e9e51ce":"#x_train, x_valid, y_train, y_valid = train_test_split(x, y, train_size=0.8)\nhistory = model.fit(x, y, epochs=3, validation_data=(x_valid, y_valid), verbose=1, batch_size=100)","fc73c8fe":"plt.plot(history.history['accuracy'])\nplt.plot(history.history['val_accuracy'])\nplt.title('model accuracy')\nplt.ylabel('accuracy')\nplt.xlabel('epoch')\nplt.legend(['train', 'test'], loc='upper left')\nplt.show()","21934671":"predictions = model.predict_classes(x_predict)","e3ab43c7":"submission = pd.read_csv('\/kaggle\/input\/digit-recognizer\/sample_submission.csv')\n","51022913":"submission.head()","0dc8fc87":"submission['Label'] = predictions\nsubmission.to_csv(\"mysub.csv\", index=False)","5ccac45e":"Just to make sure everything is right, let us also plot the first image, and see for ourselves. Given the way that the data is organized, I would expect the first image to clearly be a 1.","dcd3b421":"# Pre-Processing Data\n\n\nIn this dataset, the images are already black and white, mostly centered and have an appropriate resolution. Also, the image has been converted into a 1-dimensional array so that it will be easier to feed the model.","834b111f":"Even though the pixel values are in a 1-d arary, we have to reshape the images so that they are in the appropriate format.","765b44d9":"First, I will create a validation set.","e074e9d5":"# Predictions and Submission\n\nFinally, let us make our predictions and submit it to the competition.","7810e361":"Let us now assign the train images to x, and the test images to x_predict (just to follow convention..), so that you can use this code for other networks.","2a582b24":"Also, we need to convert the y (target) label to a categorical type that keras can understand.","74e5ed66":"# Conclusion\n\n\nSo this was a simple pipeline for the whole project (pre-processing, modelling, training, seeing training curves, predictions). To improve the score, you can increase the number of epochs and make a more complex network.\n\nI hope you liked it and feel free to fork it to make it even better. (Also, please upvote if you liked it).","00b88722":"So we can see that the model's score somewhat stabilizes in the beginning itself. Also, we can see that the model is not overfitting (since the test and train recieve almost the same score). This is good, because we want our model to be able to generalize.","bd03fb1a":"And it clearly looks like a 1 to us (cause we are amazing at such tasks). Let's see how the model handles the tilted lines.\n\n# Modelling - Convolutional Neural Network\n\nI will be using keras convolutional neural network for this, but you can use pytorch or raw tensorflow as well.","fa675ee8":"Now, I will be fitting my data for 2 epochs (meaning that it will iterate through the data 2 times). Also, it will calibrate weights after averaging for 100 samples. This way, the model will train faster, but now loose too much information through averaging.\n\nAlso, do expect the following code block to take a lot of time to execute (9-10 mins). The reason is that I am not using GPU.","9e223544":"# Introduction\n\nRecognizing Hand-written digits is a classical example of an important application of deep learning - namely convolutional neural networks. In this notebooks, I will be setting up a base pipeline for a network (it won't be that big and bad). The model gets a score of ~99%. I have chosen the layers, epochs and some parameters after messing around with it a bit. \n\nJust a friendly reminder to upvote the notebook (if you like it), as it helps me see the impact of my work :).","40f590bf":"\nHere is the structure of our neural network:\n\nInput Layer --> Convolution Layer --> Convolution Layer 2 --> MaxPool2D --> Convolution Layer --> MaxPool2D --> Flatten --> Dense Layer --> Output Layer\n\n3 convolutional layers will be enough to learn the general outline of the digits, and give a good result. I am also adding a dense layer at the end for some non-linear understanding of the different components of an image.\n\nAlso, remember to use the MaxPool2D and Flatten layers as well, because the convolution layers change the dimension of the data. You need to flatten it before you fit it into the standard Dense layer.\n\n","9dd20455":"# Training Curves \n\nLet's see the training curves to understand how the model has improved over time (epochs). We will plot the accuracy for both the train and validation. This will help us see if the model is overfitting."}}