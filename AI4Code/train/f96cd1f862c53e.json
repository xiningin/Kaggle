{"cell_type":{"ba7dc061":"code","6dd7bf67":"code","1784d61c":"code","84f4ca60":"code","790e1356":"code","41bcca71":"code","bd74ef0f":"code","5dbc69e8":"code","493c5691":"code","503cf063":"code","7590e1ff":"code","4ecdad09":"code","cd246751":"code","dc61b497":"code","ad13c155":"code","79a11031":"code","3f6ca83e":"code","58c2bfef":"code","85758fdc":"code","d0e7fa5a":"code","f0a938a1":"code","2a4b2253":"code","53163a8e":"code","f8bd4548":"code","da195166":"code","13b0ff4b":"code","944871e6":"code","356a6dde":"code","6a1d53fe":"markdown","7cd2ddef":"markdown","a61e769c":"markdown","13395977":"markdown"},"source":{"ba7dc061":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","6dd7bf67":"pd.pandas.set_option('display.max_columns',None)","1784d61c":"df=pd.read_csv('\/kaggle\/input\/mushroom-classification\/mushrooms.csv')\ndf.head()","84f4ca60":"df.isnull().sum()","790e1356":"df.dtypes","41bcca71":"catagarical=[feature for feature in df.columns if df[feature].dtypes=='O']\ndf[catagarical].head()","bd74ef0f":"len(catagarical)","5dbc69e8":"for feature in catagarical:\n    print('the feature {} has {} unique values'.format(feature,len(df[feature].unique())))","493c5691":"df.size","503cf063":"df=pd.read_csv('\/kaggle\/input\/mushroom-classification\/mushrooms.csv')\npd.get_dummies(df,drop_first=True).shape","7590e1ff":"df.dtypes","4ecdad09":"df.columns","cd246751":"df1=pd.get_dummies(df,drop_first=True)\ndf1.head()","dc61b497":"df1.columns","ad13c155":"df1.dtypes","79a11031":"X=df1.drop(['class_p'],axis=1)\nX","3f6ca83e":"y=df1['class_p']\ny","58c2bfef":"from sklearn.feature_selection import SelectKBest,chi2\nselect=SelectKBest(score_func=chi2,k='all')\nfit=select.fit(X,y)\ndfscore=pd.DataFrame(fit.scores_)\ndfcolumns=pd.DataFrame(X.columns)\nfeatures=pd.concat([dfscore,dfcolumns],axis=1)\nfeatures","85758fdc":"from sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn import tree\n\nX_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.20,random_state=0)","d0e7fa5a":"parameters = {'criterion':('gini', 'entropy'), \n              'min_samples_split':[2,3,4,5], \n              'max_depth':[9,10,11,12],\n              'class_weight':('balanced', None),\n              \n             }","f0a938a1":"tr = tree.DecisionTreeClassifier()\ngsearch = GridSearchCV(tr, parameters)\ngsearch.fit(X_train, y_train)\nmodel = gsearch.best_estimator_\nmodel","2a4b2253":"model.fit(X_train,y_train)","53163a8e":"print(X_test)","f8bd4548":"print(y_test)","da195166":"y_pred=model.predict(X_test)\ny_pred","13b0ff4b":"score = model.score(X_test, y_test)\nscore","944871e6":"from sklearn import metrics\ncm = metrics.confusion_matrix(y_test, y_pred)\nprint(cm)","356a6dde":"\nplt.figure(figsize=(9,9))\nsns.heatmap(cm, annot=True, fmt=\".3f\", linewidths=.5, square = True, cmap = 'Blues_r');\nplt.ylabel('Actual label');\nplt.xlabel('Predicted label');\nall_sample_title = 'Accuracy Score: {0}'.format(score)\nplt.title(all_sample_title, size = 15);","6a1d53fe":"**one hot encoding**","7cd2ddef":"**Find unique values of all catagarical feature**","a61e769c":"**find relaton between cayagarical feature and dependant feature**","13395977":"**find out all catagarical features**"}}