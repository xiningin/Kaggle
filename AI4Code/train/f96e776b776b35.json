{"cell_type":{"3db6cf33":"code","993eb8ef":"code","9fd570e9":"code","7262ae7e":"code","7cdc605d":"code","4a5d5b5c":"code","e631adbe":"code","d255514e":"code","cb79e7cb":"code","a378d512":"code","527a29bd":"code","35b7eaf0":"code","cdcdc34c":"code","dc2437e3":"code","3824e007":"code","2ee92412":"code","8f08c96c":"code","480b5439":"code","88731174":"code","3d1e36bf":"code","325d6248":"code","39f36040":"code","14e8103e":"code","4c44f57e":"code","da148595":"code","8e975132":"markdown","3d0d3bf0":"markdown","ccfc71dd":"markdown"},"source":{"3db6cf33":"# importing the bigquery library from google.cloud\nfrom google.cloud import bigquery","993eb8ef":"# creating a client object\n# remeber this client object will help us in fetching the data\nclient = bigquery.Client()","9fd570e9":"# now that the client in initialised\n# lets import the data from 'bigquery-public-data' project \n# we will be using openaq dataset to perform some sql operations\n# remeber that 'bigquery-public-data' is the project under which 'openaq' (data regarding air quality) dataset is present\ndataset_ref = client.dataset('openaq', project = 'bigquery-public-data')","7262ae7e":"# taking the table reference in our variable\ndataset = client.get_dataset(dataset_ref)","7cdc605d":"# now we will see the tables in our data\ntables = list(client.list_tables(dataset))\n\nfor i in tables:\n    print(i.table_id)","4a5d5b5c":"# so we have one table present in our 'openaq' database","e631adbe":"# now we want to fetch the information of the table 'global_air_quality'\n# for that we will create the table reference and then we will fetch the information from that reference into our variable\n\ntable_ref = dataset_ref.table('global_air_quality')\n\ntable = client.get_table(table_ref)","d255514e":"table.schema","cb79e7cb":"# printing the result in table 'global_air_quality'\n\nclient.list_rows(table, max_results = 5).to_dataframe()","a378d512":"# lets suppose we want to fecth the value column from 'global_air_quality' table of 'openaq' database which is present in \n# 'bigquery-public-data'\n\nquery = \"\"\" select value from `bigquery-public-data.openaq.global_air_quality` where city = 'Bengaluru' \"\"\"","527a29bd":"# asking our client to take the query\nquery_job = client.query(query)","35b7eaf0":"# storing the result into our variable\nvalues = query_job.to_dataframe()","cdcdc34c":"values.head()","dc2437e3":"# here we can see that how we can use our pandas function along with the sql\nvalues_greater_than_50 = values[values['value'] >= 50]","3824e007":"values_greater_than_50","2ee92412":"query = \"\"\" select city from `bigquery-public-data.openaq.global_air_quality` where country = 'IN' \"\"\"","8f08c96c":"query_job = client.query(query)","480b5439":"cities = query_job.to_dataframe()","88731174":"cities['city'].value_counts().head(10)","3d1e36bf":"query = \"\"\"select * from `bigquery-public-data.openaq.global_air_quality` \"\"\"","325d6248":"# submitting the query to the dataset\nquery_job = client.query(query)","39f36040":"df = query_job.to_dataframe()","14e8103e":"df.shape","4c44f57e":"df.head()","da148595":"df.describe()","8e975132":"## Use of BigQuery with SQL","3d0d3bf0":"### Selecting whole data from writing SQL query and then treating it as fetched from pandas","ccfc71dd":"### Submitting the Query to the dataset"}}