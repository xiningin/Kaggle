{"cell_type":{"8a6f4009":"code","f80640c3":"code","6cf42996":"code","2dfe522e":"code","e5801702":"code","51d96c55":"code","d403795c":"code","132d1a07":"code","33b42dbc":"code","7a878c3a":"code","4e6262e5":"code","81199efd":"code","4950a29c":"code","805ab4bf":"code","72acc5bf":"code","e53d1be0":"code","08f87745":"code","c66caded":"code","def866e0":"code","151e2a04":"code","12942ab8":"code","7561657c":"code","edead2f8":"code","099adda5":"code","f8037395":"code","23c7e74f":"code","fbce4de0":"code","aff4dd26":"code","179657c6":"code","8f9dbf56":"code","aae6c67c":"markdown","b3dbb7e2":"markdown","1a9dd875":"markdown"},"source":{"8a6f4009":"import pandas as pd\nimport matplotlib.pyplot as plt\nfrom sklearn.metrics import classification_report,accuracy_score\nfrom sklearn.ensemble import IsolationForest\nfrom sklearn.model_selection import train_test_split\nimport seaborn as sns","f80640c3":"df = pd.read_csv('..\/input\/creditcardfraud\/creditcard.csv')","6cf42996":"df","2dfe522e":"df['Class'].sum()","e5801702":"num_class = pd.value_counts(df['Class'])\nnum_class.plot(kind = 'bar', rot = 0)\nplt.title('Class type')\nplt.xlabel('Class')\nplt.ylabel('Frequency')","51d96c55":"fraud = df[df['Class']==1]\nnormal = df[df['Class']==0]","d403795c":"fraud.shape, normal.shape","132d1a07":"fraud.Time","33b42dbc":"plt.scatter(fraud.Time, fraud.Amount)\nplt.xlabel('Time')\nplt.ylabel('Amount')\nplt.title('Fraud transactions')","7a878c3a":"plt.scatter(normal.Time, normal.Amount)\nplt.xlabel('Time')\nplt.ylabel('Amount')\nplt.title('Normal transactions')","4e6262e5":"sns.boxplot(x=df['V10'])","81199efd":"corr = df.corr()","4950a29c":"corr.head()","805ab4bf":"sns.heatmap(corr)","72acc5bf":"X = df.drop(['Class'], axis = 1)","e53d1be0":"X","08f87745":"X = X.values\ny = df.iloc[:, -1].values","c66caded":"X","def866e0":"len(X)","151e2a04":"y","12942ab8":"outlier_fraction = len(fraud)\/float(len(normal))\nprint(outlier_fraction)\n#for contamination","7561657c":"classifier = IsolationForest(n_estimators=100, max_samples=227845, random_state=42, verbose=0, contamination=outlier_fraction)","edead2f8":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 42)","099adda5":"classifier.fit(X_train,y_train)","f8037395":"y_pred = classifier.predict(X_test)","23c7e74f":"y_pred[y_pred == 1] = 0\ny_pred[y_pred == -1] = 1","fbce4de0":"y_pred","aff4dd26":"accuracy_score(y_test,y_pred)","179657c6":"print(classification_report(y_test, y_pred))","8f9dbf56":"print('Number of frauds in the test set: {}'.format(y_test.sum()))\nprint('Number of frauds predicted in the test set {}'.format(y_pred.sum()))\nprint('Therefore Accuracy is: {}%'.format(accuracy_score(y_test,y_pred)*100))","aae6c67c":"This is an imbalanced dataset","b3dbb7e2":"There are outliers in this dataset","1a9dd875":"This shows that Fraud Transactions are of less amount"}}