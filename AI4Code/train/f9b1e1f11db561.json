{"cell_type":{"26636f1d":"code","6e6bb65c":"code","a526fcdc":"code","e4a9ade6":"code","fc4f68d7":"code","54371e24":"code","968b6140":"code","e591e1d9":"code","5c357fa3":"code","2a2514d1":"code","0c0d94f0":"code","0f255a45":"code","c88aa0e6":"code","e2b9e72f":"code","0d33d7ba":"code","76ce55ec":"code","45541c13":"code","0b1f0bfe":"code","b9709bc9":"code","39ce1211":"code","2b214d1b":"code","274489a6":"code","9090c0be":"code","6ec9c97a":"code","fce16a50":"markdown","b7d1a04e":"markdown","9f6710b3":"markdown","9d3fb7c2":"markdown","54c8ff19":"markdown","78b0e752":"markdown","26675fc8":"markdown","96338bdd":"markdown","09a8ba5a":"markdown","7af915ca":"markdown","4b7007be":"markdown"},"source":{"26636f1d":"!pip install pathvalidate==2.3.0","6e6bb65c":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nimport requests\nfrom urllib.parse import urlparse\nfrom pathvalidate import sanitize_filename","a526fcdc":"!pwd\n!echo \"=====\"\n!mkdir downloads\n!ls","e4a9ade6":"EXCEL_FILE = \"\/kaggle\/input\/syllabus-corpus\/thruuu.xlsx\"\nOUTPUT_FOLDER = \"\/kaggle\/working\/downloads\"\nCSV_FILENAME = \"downloads.csv\"\nARCHIVE_FILENAME = \"downloads.tar.gz\"\n\n# Set the environment variables within this notebook\n# to allow for referencing via in shell commands\n# e.g. `!echo $EXCEL_FILE`\nos.environ[\"EXCEL_FILE\"] = EXCEL_FILE\nos.environ[\"OUTPUT_FOLDER\"] = OUTPUT_FOLDER\nos.environ[\"CSV_FILENAME\"] = CSV_FILENAME\nos.environ[\"ARCHIVE_FILENAME\"] = ARCHIVE_FILENAME","fc4f68d7":"!echo $EXCEL_FILE \"\\n\"\n!echo $OUTPUT_FOLDER \"\\n\"\n!echo $CSV_FILENAME \"\\n\"\n!echo $ARCHIVE_FILENAME \"\\n\"","54371e24":"df = pd.read_excel(EXCEL_FILE, sheet_name=\"SERP\")","968b6140":"df.head()","e591e1d9":"print(df.shape)","5c357fa3":"print(len(df[\"Title\"].unique()))\ndf[df[\"Title\"].duplicated()]","2a2514d1":"def sanitize(url):\n    # extra sanitize because Kaggle does not like \"~\"\n    return (\n        sanitize_filename(url)\n        .replace(\"~\", \"\")\n        .replace(\"&\", \"\")\n        .replace(\"=\", \"\")\n        .replace(\"#\", \"\")\n        .replace(\"%\", \"\")\n        .replace(\"$\", \"\")\n        .replace(\"@\", \"\")\n    )","0c0d94f0":"sanitize(\"wowowo&=#owowowow\/http:\/\/wow.wow.com\/~wow\/woow\")","0f255a45":"def _extract_last_path_part(url):\n    return sanitize(os.path.split(urlparse(url).path)[1])","c88aa0e6":"_extract_last_path_part(\"https:\/\/www.google.com\/wow\/ok\/wo&$@%w\")","e2b9e72f":"for index, row in df.iterrows():\n    pos = row[\"Position\"]\n    serp_title = row[\"Title\"]\n    url = row[\"URL\"]\n    # fname = sanitize(url)\n    fname = _extract_last_path_part(url)\n    fpath = os.path.join(OUTPUT_FOLDER, f\"{pos}___{fname}\")\n    response = requests.get(url)\n    print(fpath, \" \"*50, \"\\r\" ,end=\"\")\n    with open(fpath, 'wb') as f:\n        f.write(response.content)","0d33d7ba":"!ls downloads | head -5","76ce55ec":"!ls downloads | wc -l","45541c13":"!xxd downloads\/100__* | head -5","0b1f0bfe":"print(ARCHIVE_FILENAME)\n!echo $ARCHIVE_FILENAME","b9709bc9":"!tar -cvzf $ARCHIVE_FILENAME downloads\/*","39ce1211":"# !rm -rf downloads\n!ls -lah","2b214d1b":"df.to_csv(CSV_FILENAME, index=False)","274489a6":"pd.read_csv(CSV_FILENAME).head()","9090c0be":"!ls","6ec9c97a":"# ...........................................\n# ...........................................\n# ...........................................\n# !tar -xvzf $ARCHIVE_FILENAME\n# downloads\/1___LA114-213Lec.pdf\n# downloads\/2___syllabus.pdf\n# downloads\/3___syllabus.pdf\n# downloads\/4___Syllabus-Lean-Sigma-Green-Belt-Cert12.pdf\n# downloads\/5___syllabus.pdf\n# downloads\/6___syllabus.pdf\n# downloads\/7___viewcontent.cgi\n# downloads\/8___syllabus.pdf\n# ...........................................\n# ...........................................\n# ...........................................\n# !ls downloads\n# 1___LA114-213Lec.pdf\t\t\t       5___syllabus.pdf\n# 2___syllabus.pdf\t\t\t       6___syllabus.pdf\n# 3___syllabus.pdf\t\t\t       7___viewcontent.cgi\n# 4___Syllabus-Lean-Sigma-Green-Belt-Cert12.pdf  8___syllabus.pdf\n# ...........................................\n# ...........................................\n# ...........................................","fce16a50":"## Globals \/ Config","b7d1a04e":"### Fun Fact! [Pandas can read Excel](https:\/\/pandas.pydata.org\/pandas-docs\/stable\/reference\/api\/pandas.read_excel.html)\n\n","9f6710b3":"# Verify untar\/unzip","9d3fb7c2":"### Now download","54c8ff19":"# Overview\n\n\nThere is data inside `thruuu.xlsx`.\n\nThis notebook will download all the PDFs.","78b0e752":"### make an extractor for creating useful filenames for each row","26675fc8":"## Imports","96338bdd":"# Save dataframe too","09a8ba5a":"## Installs","7af915ca":"### Create `downloads` directory","4b7007be":"# Save archive of downloads"}}