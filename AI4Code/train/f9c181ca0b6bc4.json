{"cell_type":{"b27243b5":"code","552ed08e":"code","a54d1813":"code","bba0c457":"code","af3b8281":"code","8739982f":"code","ded49124":"code","e8e4e766":"code","3ff05d0d":"code","37b85788":"code","bb00f4c4":"code","fb1015bf":"code","37ca4da7":"code","059ae2f6":"code","ecf5f62e":"code","8f9f5b7e":"code","2d180b02":"code","12f23fdf":"code","d0015851":"code","b6b15772":"code","a91ca8e6":"code","6237b014":"code","4e40e33f":"code","a5fa2e18":"code","27d77b3d":"code","307ae2a4":"code","4dafe95c":"code","55c35977":"code","049cf811":"code","a95f534b":"code","5e6306c9":"code","4c46396c":"code","c154a68a":"code","59d29e6f":"code","d1f2e263":"markdown","75048b55":"markdown","d48ab500":"markdown","5cc078ed":"markdown","de1301bd":"markdown","9905e7e5":"markdown","907ab8dc":"markdown","c6d4a1e0":"markdown","6458a4cc":"markdown","7abab2d4":"markdown","3b9b3ec1":"markdown","bf7da94c":"markdown","14d7d9a6":"markdown","b5fa7303":"markdown"},"source":{"b27243b5":"import numpy as np\nimport pandas as pd\nimport scipy as sp\nimport sklearn as sk\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport os\nfrom sklearn.metrics import r2_score\nfrom sklearn.model_selection import train_test_split","552ed08e":"df = pd.read_csv('..\/input\/insurance\/insurance.csv')","a54d1813":"df.head()","bba0c457":"df.shape","af3b8281":"df.dtypes","8739982f":"df.isnull().sum()","ded49124":"fig, ax = plt.subplots(1, 2, sharex='col', sharey='row', figsize = (20, 8))\nc=0\nfor i in df.sex.unique():\n    ax[c].scatter(df[df[\"sex\"]==i].age,df[df[\"sex\"]==i].charges)\n    ax[c].set_title(i)\n    if not c:\n        ax[c].set_ylabel('Charges')\n    ax[c].set_xlabel('Age')\n    c+=1\nfig.suptitle(\"Scatter Plot of Age vs Charges depending Upon Sex\")\nfig.show()","e8e4e766":"fx=plt.subplots(figsize=(5,5))\nplt.pie([len(df[df[\"sex\"]==\"male\"]),len(df[df[\"sex\"]==\"female\"])],labels=[\"Male\",\"Female\"],autopct=\"%f\",explode=[0,0.1],radius=1,colors=[\"yellow\",\"royalblue\"])\nplt.title(\"Pie plot Describing Sex Percentages\")\nplt.show()","3ff05d0d":"min(df.age.unique())","37b85788":"max(df.age.unique())","bb00f4c4":"l=[]\nfor i in df[\"age\"]:\n    if i>=18 and i<=30:\n        l.append(\"Young Adults\")\n    elif i>=31 and i<=45:\n        l.append(\"Middle-Aged Adults\")\n    else:\n        l.append(\"Old-Aged Adults\")\ndf[\"age_group\"]=l","fb1015bf":"df.head()","37ca4da7":"print(df.age_group.value_counts())","059ae2f6":"l=[]\nfor i in df.age_group.unique():\n    l.append(df[df[\"age_group\"]==i].age_group.value_counts()[0])\nfig=plt.subplots(figsize = (8, 8))\nplt.pie(l,labels=df.age_group.unique(),autopct=\"%f\",explode=[0,0.1,0.1],radius=1,colors=[\"red\",\"royalblue\",\"yellow\"])\nplt.title(\"Pie plot Describing Age Percentages\")\nplt.plot()","ecf5f62e":"fig, ax = plt.subplots(figsize = (15, 7))\nx1=np.array([i-0.75 for i in range(2,2*len(df.age_group.unique())+2,2)])\nx2=np.array([i-0.25 for i in range(2,2*len(df.age_group.unique())+2,2)])\ny1=[]\ny2=[]\nfor i in df.age_group.unique():\n    y1.append(df[(df[\"smoker\"]==\"yes\") & (df[\"age_group\"]==i)].age_group.value_counts()[0])\n    y2.append(df[(df[\"smoker\"]==\"no\") & (df[\"age_group\"]==i)].age_group.value_counts()[0])\nax.bar(x1,y1,width=0.5,label='Smokers',color=\"Blue\")\nax.bar(x2,y2,width=0.5,label='Non Smokers',color=\"Green\")\nax.bar_label(ax.containers[0])\nax.bar_label(ax.containers[1])\nax.legend()\nax.set_xticks(x2-0.25)\nax.set_xticklabels(df.age_group.unique())\nax.set_ylabel('Count of Smokers and Non Smokers')\nax.set_xlabel('AGE GROUP')\nax.set_title('Count of Smokers and Non Smokers depending Upon Age Group')\nplt.plot()","8f9f5b7e":"sns.boxplot(y=df.bmi,x=df.age_group)","2d180b02":"sns.boxplot(y=df.charges,x=df.age_group)","12f23fdf":"l=[]\nfor i in df[\"bmi\"]:\n    if i<18.5:\n        l.append(\"Underweight\")\n    elif i>=18.5 and i<=24.9:\n        l.append(\"Normal weight\")\n    elif i>=55 and i<=29.9:\n        l.append(\"Overweight\")\n    else:\n        l.append(\"Obese\")\ndf[\"bmi_group\"]=l","d0015851":"df.head()","b6b15772":"sns.scatterplot(x=df.age,y=df.charges,hue=df.bmi_group)","a91ca8e6":"fig, ax = plt.subplots(figsize = (15, 7))\nx1=np.array([i-0.75 for i in range(2,2*len(df.bmi_group.unique())+2,2)])\nx2=np.array([i-0.25 for i in range(2,2*len(df.bmi_group.unique())+2,2)])\ny1=[]\ny2=[]\nfor i in df.bmi_group.unique():\n    y1.append(df[(df[\"smoker\"]==\"yes\") & (df[\"bmi_group\"]==i)].bmi_group.value_counts()[0])\n    y2.append(df[(df[\"smoker\"]==\"no\") & (df[\"bmi_group\"]==i)].bmi_group.value_counts()[0])\nax.bar(x1,y1,width=0.5,label='Smokers',color=\"Blue\")\nax.bar(x2,y2,width=0.5,label='Non Smokers',color=\"Green\")\nax.bar_label(ax.containers[0])\nax.bar_label(ax.containers[1])\nax.legend()\nax.set_xticks(x2-0.25)\nax.set_xticklabels(df.bmi_group.unique())\nax.set_ylabel('Count of Smokers and Non Smokers')\nax.set_xlabel('BMI GROUPS')\nax.set_title('Count of Smokers and Non Smokers depending Upon BMI Group')\nplt.plot()","6237b014":"df.region.value_counts()","4e40e33f":"fig, ax = plt.subplots(figsize = (10, 6))\nx1=np.array([i-0.75 for i in range(2,2*len(df.region.unique())+2,2)])\nx2=np.array([i-0.25 for i in range(2,2*len(df.region.unique())+2,2)])\ny1=[]\ny2=[]\nfor i in df.region.unique():\n    y1.append(df[(df[\"sex\"]==\"male\") & (df[\"region\"]==i)].region.value_counts()[0])\n    y2.append(df[(df[\"sex\"]==\"female\") & (df[\"region\"]==i)].region.value_counts()[0])\nax.bar(x1,y1,width=0.5,label='Male',color=\"Blue\")\nax.bar(x2,y2,width=0.5,label='Female',color=\"Green\")\nax.bar_label(ax.containers[0])\nax.bar_label(ax.containers[1])\nax.legend()\nax.set_xticks(x2-0.25)\nax.set_xticklabels(df.region.unique())\nax.set_ylabel('Count of Males and Females')\nax.set_xlabel('Regions')\nax.set_title('Count of Males and Females depending Upon Regions')\nplt.plot()","a5fa2e18":"fig, ax = plt.subplots(1, 4, sharex='col', sharey='row', figsize = (20, 5))\nc=0\nfor i in df.region.unique():\n    ax[c].scatter(df[df[\"region\"]==i].age,df[df[\"region\"]==i].charges)\n    ax[c].set_title(i)\n    if not c:\n        ax[c].set_ylabel('Charges')\n    ax[c].set_xlabel('Age')\n    c+=1\nfig.suptitle(\"Scatter Plot of Age vs Charges depending Upon Regions\")\nfig.show()","27d77b3d":"fig, ax = plt.subplots(figsize = (15, 7))\nx1=np.array([i-0.75 for i in range(2,2*len(df.region.unique())+2,2)])\nx2=np.array([i-0.25 for i in range(2,2*len(df.region.unique())+2,2)])\ny1=[]\ny2=[]\nfor i in df.region.unique():\n    y1.append(df[(df[\"smoker\"]==\"yes\") & (df[\"region\"]==i)].region.value_counts()[0])\n    y2.append(df[(df[\"smoker\"]==\"no\") & (df[\"region\"]==i)].region.value_counts()[0])\nax.bar(x1,y1,width=0.5,label='Smokers',color=\"Blue\")\nax.bar(x2,y2,width=0.5,label='Non Smokers',color=\"Green\")\nax.bar_label(ax.containers[0])\nax.bar_label(ax.containers[1])\nax.legend()\nax.set_xticks(x2-0.25)\nax.set_xticklabels(df.region.unique())\nax.set_ylabel('Count of Smokers and Non Smokers')\nax.set_xlabel('Regions')\nax.set_title('Count of Smokers and Non Smokers depending Upon Regions')\nplt.plot()","307ae2a4":"sns.displot(x=df['charges'], kind='hist',kde=True, height=6, aspect=1)","4dafe95c":"sns.pairplot(df)","55c35977":"sex = ('male','female')\nx = pd.get_dummies(df.iloc[:,:-3], columns=[\"sex\",\"region\",\"smoker\"])\nx.head()","049cf811":"y=df[\"charges\"] \/ df[\"charges\"].abs().max()\ny","a95f534b":"x_train,x_test,y_train,y_test = train_test_split( x, y, test_size=0.33)","5e6306c9":"from sklearn.preprocessing import StandardScaler\nscaler = StandardScaler()\nx_train = scaler.fit_transform(x_train)\nx_test = scaler.fit_transform(x_test)","4c46396c":"from sklearn.linear_model import LinearRegression\nreg=LinearRegression().fit(x_train,y_train)\ny_pred=reg.predict(x_test)","c154a68a":"score=r2_score(y_test,y_pred)\nprint(score)","59d29e6f":"plt.scatter(y_test , y_pred)","d1f2e263":"## Inporing Libraries\n","75048b55":"## Analysis on the basis on Region","d48ab500":"# Visualizing Dataset","5cc078ed":"## Analysis on the basis of Age","de1301bd":"## Analysis on basis of sex","9905e7e5":"# Regression Models","907ab8dc":"### Adding a new age group Column\n\n**Young Adults:** AGE in range 18 and 30\n\n**Middle-Aged Adults:** AGE in range 31 and 45\n\n**Old-Aged Adults:** AGE greater than 45\n","c6d4a1e0":"## Analisis on basis of BMI","6458a4cc":"#  Medical Cost Personal Dataset","7abab2d4":"## Multiple Linear Regression","3b9b3ec1":"### Adding a new bmi group Column\n\n**Underweight:** BMI is less than 18.5\n\n**Normal weight:** BMI is 18.5 to 24.9\n\n**Overweight:** BMI is 25 to 29.9\n\n**Obese:** BMI is 30 or more","bf7da94c":"## Preparing Dataset","14d7d9a6":"## Importing and Preprocessing Dataset","b5fa7303":"## Other Charts"}}