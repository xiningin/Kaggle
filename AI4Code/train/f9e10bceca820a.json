{"cell_type":{"1de3b423":"code","52efaed0":"code","9976e67a":"code","7fd942c4":"code","85f51670":"code","7997d9a4":"code","d399dad3":"code","321e126f":"code","1d9b38c6":"code","cebc96c1":"code","bf4d01c0":"code","ebb6df72":"code","4ba931bc":"code","69ce848b":"code","e58b3170":"code","41ba3d66":"code","dc5be275":"markdown","4956b175":"markdown","994e3429":"markdown","c0e7cba2":"markdown","ac49e933":"markdown","bee2153c":"markdown","744fe3c2":"markdown"},"source":{"1de3b423":"## define configuration\nPATH_TRAIN = '..\/input\/tabular-playground-series-jan-2021\/train.csv'\nPATH_TEST = '..\/input\/tabular-playground-series-jan-2021\/test.csv'\n\nPATH_AUTOSKLEARN_SUBMISSION = 'submission_autosklearn.csv'\nPATH_H2OAML_SUBMISSION = 'submission_h2oaml.csv'","52efaed0":"## install package\n!curl https:\/\/raw.githubusercontent.com\/automl\/auto-sklearn\/master\/requirements.txt | xargs -n 1 -L 1 pip3 install\n!pip3 install auto-sklearn","9976e67a":"## import packages\nimport pandas as pd\n\nfrom autosklearn.regression import AutoSklearnRegressor\nfrom autosklearn.metrics import mean_squared_error","7fd942c4":"## prepare data\ntrain = pd.read_csv(PATH_TRAIN)\ntest = pd.read_csv(PATH_TEST)\n\ntarget = train.target.values\ntrain.drop(['id', 'target'], axis=1, inplace=True)","85f51670":"## run model\nautosklearnml = AutoSklearnRegressor(\n    time_left_for_this_task=600,\n    metric=mean_squared_error,\n    scoring_functions=[mean_squared_error]\n)\n\nautosklearnml.fit(X=train, y=target, dataset_name='tps_jan_2021')","7997d9a4":"## check statistics\nprint(autosklearnml.sprint_statistics())","d399dad3":"## generate predictions\npreds_autosklearnml = autosklearnml.predict(test[train.columns])","321e126f":"## create submission\nsubmission = pd.DataFrame({\n    'id': test.id,\n    'target': preds_autosklearnml\n})\n\nsubmission.head()","1d9b38c6":"## save submission\nsubmission.to_csv(PATH_AUTOSKLEARN_SUBMISSION, index=False)","cebc96c1":"## import packages\nimport pandas as pd\n\nimport h2o\nfrom h2o.automl import H2OAutoML","bf4d01c0":"## prepare data\nh2o.init()\n\nh2o_train = h2o.import_file(PATH_TRAIN)\nh2o_test = h2o.import_file(PATH_TEST)","ebb6df72":"## run model\nfeatures = [x for x in h2o_train.columns if x not in ['id', 'target']]\n\nh2oaml = H2OAutoML(\n    max_runtime_secs=600,\n    stopping_metric='RMSE',\n    sort_metric='RMSE'\n)\n\nh2oaml.train(x=features, y='target', training_frame=h2o_train)","4ba931bc":"## check leaderboard\nh2oaml.leaderboard","69ce848b":"## generate predictions\npreds_h2oaml = h2oaml.leader.predict(h2o_test)","e58b3170":"## create submission\nsubmission = pd.DataFrame({\n    'id': h2o_test['id'].as_data_frame().id,\n    'target': preds_h2oaml.as_data_frame().predict\n})\n\nsubmission.head()","41ba3d66":"## save submission\nsubmission.to_csv(PATH_H2OAML_SUBMISSION, index=False)","dc5be275":"## H2O AutoML\n<img src='https:\/\/docs.h2o.ai\/h2o\/latest-stable\/h2o-docs\/_images\/h2o-automl-logo.jpg' width='150px'>\n\n[H2O AutoML](https:\/\/www.h2o.ai\/products\/h2o-automl) is an automated machine learning library open sourced by [H2O.ai](https:\/\/h2o.ai)","4956b175":"This is just a baseline submission over which a lot of improvements can be made. You can read more about Auto-Sklearn's workflow, settings, hyperparameters, optimizations and more here:\n\n* [Documentation of auto-sklearn](https:\/\/automl.github.io\/auto-sklearn)\n* [Deep dive of auto-sklearn](https:\/\/github.com\/vopani\/fortyone#automl-series-)","994e3429":"<div align='center'>\n    <h1>AutoML Tutorial<\/h1>\n    <img src='https:\/\/github.com\/vopani\/fortyone\/blob\/main\/images\/automl_banner_530_x_455.png?raw=true'>\n<\/div>","c0e7cba2":"This is just a baseline submission over which a lot of improvements can be made. You can read more about H2O AutoML's workflow, settings, hyperparameters, interpretability and more here:\n\n* [Documentation of H2O AutoML](https:\/\/docs.h2o.ai\/h2o\/latest-stable\/h2o-docs\/automl.html)\n* [Deep dive of H2O AutoML](https:\/\/github.com\/vopani\/fortyone#automl-series-)","ac49e933":"## Auto-Sklearn\n[auto-sklearn](https:\/\/automl.github.io\/auto-sklearn) is an automated machine learning toolkit and a drop-in replacement for a scikit-learn estimator","bee2153c":"## Similar Tutorials\nSimilar tutorials on other Kaggle TPS competitions are published here:\n\n* [AutoML Tutorial: TPS (February 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-february-2021)\n* [AutoML Tutorial: TPS (March 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-march-2021)\n* [AutoML Tutorial: TPS (April 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-april-2021)\n* [AutoML Tutorial: TPS (May 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-may-2021)\n* [AutoML Tutorial: TPS (June 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-june-2021)","744fe3c2":"**Auto**mated **M**achine **L**earning (**AutoML**) has become widely adopted for building, experimenting and productionizing various types of machine learning models across business use-cases.\n\nThere are different open source solutions available and this notebook explores a simple baseline solution for some of them on the [Kaggle TPS (January-2021) competition](https:\/\/www.kaggle.com\/c\/tabular-playground-series-jan-2021).\n\n* [Auto-Sklearn](#Auto-Sklearn)\n* [H2O AutoML](#H2O-AutoML)"}}