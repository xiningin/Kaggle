{"cell_type":{"e31393ca":"code","554232a4":"code","f9e8d5df":"code","3cedfe49":"code","b2f1c26d":"code","e4667cb8":"code","e4d851a1":"code","b990308a":"code","1da69438":"code","5e01fea5":"code","c94cd76b":"code","ef8eb9a2":"code","31f5b09e":"code","2b24b937":"code","42526545":"code","9ec1119f":"code","d1e7e9b1":"code","c1d93c03":"markdown","442ffb7d":"markdown","c98be6e8":"markdown","165316bb":"markdown","2c28a64e":"markdown","4bbb4e7b":"markdown","68e592a9":"markdown","cee8ec01":"markdown","29e2617a":"markdown"},"source":{"e31393ca":"import os , glob \nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nimport skimage\nfrom skimage.io import imread , imread_collection \n\nfrom sklearn.metrics import accuracy_score , classification_report\nfrom sklearn.preprocessing import LabelEncoder,StandardScaler\n\nimport keras\nfrom keras.applications import mobilenet\nfrom keras.layers import Dense ,Dropout\nfrom keras.models import Sequential\n","554232a4":"image_pathes ='..\/input\/breast-histopathology-images\/*\/'\n\npatient_list = list(glob.glob(image_pathes))\nprint('Number of the patient :'+' '+str(len(patient_list)))\n\n","f9e8d5df":"sum = 0\nfor i in range(0 , len(patient_list)):\n    sum+=len(glob.glob(patient_list[i]+'\/*\/*'))\nprint(sum)","3cedfe49":"test=[glob.glob(patient_list[i]+'\/*\/*') for i in range(0,len(patient_list))]","b2f1c26d":"img_sample = imread(test[0][0])\nplt.title('patienID:'\n          +str(test[0][0].split('\/')[3])+'\\n'\n         'class:'+str(test[0][0].split('\/')[4]))\nplt.imshow(img_sample)","e4667cb8":"\npatient_ID = [test[i][x].split('\/')[3]for i in range(0,len(test))for x in range(0,len(test[i]))]\nclass_test = [test[i][x].split('\/')[4]for i in range(0,len(test))for x in range(0 ,len(test[i]))]\npatient_pathes = [test[i][x]for i in range(0,len(test))for x in range(0,len(test[i]))]","e4d851a1":"d = {'patient_ID':patient_ID,'pathes':patient_pathes,'diagnosis':class_test}\nBC_df = pd.DataFrame(data=d)\n","b990308a":"print('The shape of our datset:'+\" \"+str(BC_df.shape))\nBC_df.head()","1da69438":"BC_df = BC_df[(BC_df['diagnosis']=='0')|(BC_df['diagnosis']=='1')]  \n# BC_df.to_csv('Breat_cancer_data.csv')","5e01fea5":"print('The shape of new edited BC_df csv :'+' '+str(BC_df.shape))","c94cd76b":"BC_df['diagnosis'].value_counts()","ef8eb9a2":"BC_copy_1 = BC_df.iloc[:20000,:]\nfrom PIL.Image import open\nBC_copy_1['pixels'] =  BC_copy_1['pathes'].map(lambda x:np.asarray(open(x).resize((224,224))).astype(np.float32))\n\n","31f5b09e":"BC_copy_1['pixels'] = BC_copy_1['pixels'].tolist()","2b24b937":"# BC_copy_1.to_csv('sample_BC_dataset.csv')\n","42526545":"BC_copy_1.head()","9ec1119f":"from random import choice\nfig,axes = plt.subplots(figsize=(20,25))\n  \nran_sample = [choice(BC_copy_1['pathes'])for x in range(0,10) ]\nfor i in range(0,len(ran_sample)):\n    img = imread(ran_sample[i])\n    plt.imshow(img)\n    axes =plt.subplot(5,5,i+1)\n    axes.set_title('patientID:'+str(ran_sample[i].split('\/')[3])+'\\n'\n                   +'diagnosis:'+str(ran_sample[i].split('\/')[4]),fontsize=20)\n\n# There was a blank plot \n# so remove it via 'delaxes'\nfig.delaxes(axes)\nfig.suptitle('Random Samples ',fontsize=40)\nplt.show() ","d1e7e9b1":"BC_count = BC_copy_1['diagnosis'].value_counts()\nprint(BC_count)\nsns.countplot(BC_copy_1['diagnosis'])\nplt.title('Benign vs Malignant ')\nplt.show()\nprint('The difference between benign and malignant :'+\" \"\n      +str(BC_count[0]-BC_count[1]))\n","c1d93c03":"## Importing the libraries","442ffb7d":"Applying the SMOTE and predict the classes \nhttps:\/\/www.kaggle.com\/angieashraf\/84-8-prediction-for-breast-cancer-using-mobilenet","c98be6e8":"## Show a random sample from the sampled Breast Cancer\n\n\n","165316bb":"## Dealing the imbalance dataset via SMOTE \n##### There is a huge difference between our two classification classes as:\n* Benign(0)->13351\n* Malignant-> 6649","2c28a64e":"## Check the imbalance ","4bbb4e7b":"## Visualizing sample from our dataset","68e592a9":"# Prediction of the Invasive Ductal Carcinoma (IDC)\n#### IDC also known as infiltrating ductal carcinoma, is cancer that began growing in a milk duct and has invaded the fibrous or fatty tissue of the breast outside of the duct. IDC is the most common form of breast cancer, representing 80 percent of all breast cancer diagnoses \n#### for more information ; [https:\/\/www.hopkinsmedicine.org\/breast_center\/breast_cancers_other_conditions\/invasive_ductal_carcinoma.html](http:\/\/)","cee8ec01":"## Create Dataframe for our data ","29e2617a":"##### Note:There is a huge difference between the two classes , *so we will deal with that by using one of the resampling techniques*"}}