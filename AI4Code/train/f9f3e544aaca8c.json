{"cell_type":{"cf282152":"code","31398025":"code","4d8891f0":"code","106d2efb":"code","9ab64a71":"code","61a0a946":"code","3217f794":"code","34079cbb":"code","8d7082ba":"code","1c3af1f9":"code","55917007":"code","46d019c8":"code","8765b79a":"code","24f568dc":"code","c7480c31":"code","5a8850b2":"code","cee08305":"code","1b0f7a4c":"code","076c2456":"code","fe21fd33":"code","e67ce2c7":"code","368f29ab":"code","24da4fb0":"code","035c3cd3":"code","484f845c":"code","7ecf0e39":"code","8de3d15c":"code","c2f87001":"markdown","fa973333":"markdown","0b5c82b9":"markdown","9e55e9c1":"markdown","47b74b9f":"markdown","1a89a739":"markdown","61d4e5fa":"markdown","cf0f1aa6":"markdown","191e89bf":"markdown","c200d6f8":"markdown","51f3969f":"markdown","19d4152c":"markdown","42aa60bb":"markdown","fa0463c1":"markdown","71e86e20":"markdown","227b833b":"markdown","16300aa5":"markdown"},"source":{"cf282152":"import numpy as np\nimport pandas as pd \nimport time\n\nfrom lightfm import LightFM\nfrom lightfm.evaluation import auc_score\n\nfrom scipy import sparse\nfrom scipy.sparse import coo_matrix","31398025":"df = pd.read_csv('..\/input\/sbermarket-internship-competition\/train.csv')\nsubmit_df = pd.read_csv('..\/input\/sbermarket-internship-competition\/sample_submission.csv')","4d8891f0":"df.head()","106d2efb":"submit_df.head()","9ab64a71":"# \u0432 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u043e\u043c \u0434\u0430\u0442\u0430\u0444\u0440\u0435\u0439\u043c\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u044e\u0437\u0435\u0440\u043e\u0432 \u0441\u043b\u0435\u0434\u0443\u0449\u0435\u0435:\nprint('K\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u044e\u0437\u0435\u0440\u043e\u0432 \u0432 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u043e\u043c \u0434\u0430\u0442\u0430\u0444\u0440\u0435\u0439\u043c\u0435', df.user_id.nunique())\n# \u0432 \u0441\u0430\u0431\u043c\u0438\u0442\u0435:\nusers = []\nfor row in submit_df.to_numpy():\n    user, item = map(int, row[0].split(';'))\n    users.append(user)\n\nusers_count = len(list(set(users)))\n\nprint('K\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u044e\u0437\u0435\u0440\u043e\u0432 \u0432 \u0441\u0430\u0431\u043c\u0438\u0442 \u0434\u0430\u0442\u0430\u0444\u0440\u0435\u0439\u043c\u0435', users_count)","61a0a946":"print('\u0423\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0432 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u043e\u0439 \u0442\u0430\u0431\u043b\u0438\u0446\u0435', df.cart.nunique())\n# \u041d\u0430\u0445\u043e\u0434\u044f\u0442\u0441\u044f \u043e\u043d\u0438 \u0432 \u0434\u0438\u0430\u043f\u0430\u0437\u043e\u043d\u0435\nprint('\u0414\u0438\u0430\u043f\u0430\u0437\u043e\u043d \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u0432 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u043e\u0439 \u0442\u0430\u0431\u043b\u0438\u0446\u0435', df.cart.min(), ';', df.cart.max())\n\n# \u0421\u0434\u0435\u043b\u0430\u0435\u043c \u0442\u043e \u0436\u0435 \u0438 \u0434\u043b\u044f \u0441\u0430\u0431\u043c\u0438\u0442 \u0444\u0430\u0439\u043b\u0430\nitems = []\n\nfor row in submit_df.to_numpy():\n    user, item = map(int, row[0].split(';'))\n    items.append(item)\n\nitems = pd.Series(list(set(items)))\nprint('\u0423\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0432 \u0441\u0430\u0431\u043c\u0438\u0442\u0435', items.nunique())\n# \u041d\u0430\u0445\u043e\u0434\u044f\u0442\u0441\u044f \u043e\u043d\u0438 \u0432 \u0434\u0438\u0430\u043f\u0430\u0437\u043e\u043d\u0435\nprint('\u0414\u0438\u0430\u043f\u0430\u0437\u043e\u043d \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u0432 \u0441\u0430\u0431\u043c\u0438\u0442\u0435', items.min(), ';', items.max())\n# \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u0434\u043b\u044f \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u0438\u044f \u043c\u0435\u043d\u044c\u0448\u0435 \u0432 \u0441\u0430\u0431\u043c\u0438\u0442 \u0444\u0430\u0439\u043b\u0435","3217f794":"# \u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u043c \u043d\u0430 \u0433\u0438\u0441\u0442\u043e\u0433\u0440\u0430\u043c\u043c\u0443 \u043e\u0431\u0449\u0435\u0433\u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u0437\u0430\u043a\u0430\u0437\u043e\u0432 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439\nuser_order_counts = df.groupby('user_id').order_completed_at.nunique()\nprint('\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0437\u0430\u043a\u0430\u0437\u043e\u0432 \u043a\u043b\u0438\u0435\u043d\u0442\u0430', user_order_counts.min()) \nprint('\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0437\u0430\u043a\u0430\u0437\u043e\u0432 \u043a\u043b\u0438\u0435\u043d\u0442\u0430', user_order_counts.max())\nuser_order_counts.hist(bins=user_order_counts.nunique(),  figsize=(5, 5))","34079cbb":"item_order_counts = df.groupby('cart').order_completed_at.nunique()\nprint('\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043e\u043a\u0443\u043f\u043e\u043a \u0438\u0437 \u043e\u0434\u043d\u043e\u0439 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438', item_order_counts.min()) \nprint('\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043e\u043a\u0443\u043f\u043e\u043a \u0438\u0437 \u043e\u0434\u043d\u043e\u0439 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438', item_order_counts.max())\nprint('\u0412\u0441\u0435\u0433\u043e \u0437\u0430\u043a\u0430\u0437\u043e\u0432 \u0432 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u043e\u0439 \u0442\u0430\u0431\u043b\u0438\u0446\u0435', df.groupby(['user_id']).order_completed_at.nunique().sum())\nprint('\u0412 \u0441\u0440\u0435\u0434\u043d\u0435\u043c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043e\u043a\u0443\u043f\u043e\u043a \u0438\u0437 \u043e\u0434\u043d\u043e\u0439 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438', item_order_counts.median())","8d7082ba":"# \u041e\u0441\u0442\u0430\u0432\u0438\u043c \u0432 \u0434\u0430\u0430\u0442\u0444\u0440\u0435\u0439\u043c\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u0442\u0435 \u0437\u0430\u043f\u0438\u0441\u0438, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u0441\u044f \u0446\u0435\u043b\u0435\u0432\u044b\u0435 \u044e\u0437\u0435\u0440\u044b \u0438 \u0442\u043e\u0432\u0430\u0440\u044b\ndf_actual = df.loc[df['cart'].isin(items)]\ndf_actual = df.loc[df['user_id'].isin(users)]\nprint(\"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0437\u0430\u043f\u0438\u0441\u0435\u0439 \u0432 \u043f\u043e\u043b\u0443\u0447\u0438\u0432\u0448\u0435\u043c\u0441\u044f \u0434\u0430\u0442\u0430\u0444\u0440\u0435\u0439\u043c\u0435:\", df_actual.shape[0])\ndf_actual.head()","1c3af1f9":"# \u0421\u043e\u0437\u0434\u0430\u0434\u0438\u043c \u0434\u0430\u0442\u0430\u0444\u0440\u0435\u0439\u043c, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u0431\u0443\u0434\u0443\u0442 \u0445\u0440\u0430\u043d\u0438\u0442\u044c\u0441\u044f \u0434\u0430\u0442\u044b \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0445 \u0437\u0430\u043a\u0430\u0437\u043e\u0432 \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u044e\u0437\u0435\u0440\u043e\u0432\ndf_actual['order_completed_at'] = pd.to_datetime(df_actual['order_completed_at'])\ndate_for_test_data = df_actual.groupby('user_id', as_index=False).order_completed_at.max()\ndate_for_test_data.head()","55917007":"# \u0421\u043e\u0437\u0434\u0430\u0434\u0438\u043c \u0442\u0435\u0441\u0442 \u0432\u044b\u0431\u043e\u0440\u043a\u0443, \u0432 \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u0432\u043e\u0439\u0434\u0443\u0442 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435 \u0437\u0430\u043a\u0430\u0437\u044b \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439\ntest_data = date_for_test_data.merge(df_actual, how='left', left_on=['user_id', 'order_completed_at'], right_on=['user_id', 'order_completed_at'])\ntest_data = test_data.groupby(['user_id', 'cart'], as_index=False).order_completed_at.count()\ntest_data = test_data.rename({'order_completed_at':'count_in_order'}, axis='columns')\ntest_data.head()","46d019c8":"# \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0438\u043d\u0434\u0435\u043a\u0441\u043e\u0432 \u0441\u0442\u0440\u043e\u043a \u0434\u043b\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0445 \u0437\u0430\u043a\u0430\u0437\u043e\u0432 \u044e\u0437\u0435\u0440\u043e\u0432\ndrop_index_list = []\nstart = time.time()\nfor user in df_actual.user_id.unique():\n    masc = df_actual.loc[df_actual['user_id'].isin([user])].order_completed_at ==\\\n    df_actual.loc[df_actual['user_id'].isin([user])].order_completed_at.max()\n    index_to_drop = np.compress(masc, df_actual.loc[df_actual['user_id'].isin([user])].order_completed_at.index, axis=None, out=None)\n    drop_index_list.extend(index_to_drop)\n    end = time.time()\nprint(\"time taken = {0:.{1}f} seconds\".format(end - start, 2))","8765b79a":"# \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0438\ntrain_data = df_actual.drop(drop_index_list, axis=0)\nprint(\"\u0420\u0430\u0437\u043c\u0435\u0440 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0438:\", train_data.shape[0],  round(((train_data.shape[0] \/ df_actual.shape[0]) * 100), 2), '%')\nprint(\"\u0420\u0430\u0437\u043c\u0435\u0440 \u0442\u0435\u0441\u0442\u043e\u0432\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0438:\", test_data.shape[0],  round((test_data.shape[0] \/ df_actual.shape[0]) * 100, 2), '%')\nprint(\"\u041e\u0431\u0449\u0438\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u0432\u044b\u0431\u043e\u0440\u043a\u0438:\", df_actual.shape[0])\nprint('\u0420\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u043e\u0441\u044c \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u043c? ', df_actual.shape[0] == (test_data.shape[0] + train_data.shape[0]))\ntrain_data = train_data.groupby(['user_id', 'cart'], as_index=False).order_completed_at.count()\ntrain_data = train_data.rename({'order_completed_at':'count_in_order'}, axis='columns')\ntrain_data.head()","24f568dc":"# \u0444\u0443\u043d\u043a\u0446\u0438\u044f \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0441\u043b\u043e\u0432\u0430\u0440\u0435\u0439 \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u0438\ndef id_mappings(user_list, item_list):\n    \"\"\"\n    \n    Create id mappings to convert user_id, item_id, and feature_id\n    \n    \"\"\"\n    user_to_index_mapping = {}\n    index_to_user_mapping = {}\n    for user_index, user_id in enumerate(user_list):\n        user_to_index_mapping[user_id] = user_index\n        index_to_user_mapping[user_index] = user_id\n        \n    item_to_index_mapping = {}\n    index_to_item_mapping = {}\n    for item_index, item_id in enumerate(item_list):\n        item_to_index_mapping[item_id] = item_index\n        index_to_item_mapping[item_index] = item_id\n        \n    return user_to_index_mapping, index_to_user_mapping, \\\n           item_to_index_mapping, index_to_item_mapping","c7480c31":"# \u0441\u043e\u0437\u0434\u0430\u0435\u043c \u0441\u043b\u043e\u0432\u0430\u0440\u0438 \u0434\u043b\u044f \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u0438 \u0434\u043b\u044f \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0438 \u0438 \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u043e\u0432\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0438\nuser_to_index_mapping, index_to_user_mapping, \\\n           item_to_index_mapping, index_to_item_mapping = id_mappings(train_data.user_id.unique(), list(set(train_data.cart.unique()) | set(test_data.cart.unique())))\n\n","5a8850b2":"def get_interaction_matrix(df, df_column_as_row, df_column_as_col, df_column_as_value, row_indexing_map, \n                          col_indexing_map):\n    \n    row = df[df_column_as_row].apply(lambda x: row_indexing_map[x]).values\n    col = df[df_column_as_col].apply(lambda x: col_indexing_map[x]).values\n    value = df[df_column_as_value].values\n    \n    return coo_matrix((value, (row, col)), shape = (len(row_indexing_map), len(col_indexing_map)))","cee08305":"# \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0440\u0430\u0437\u0440\u0435\u0436\u0435\u043d\u043d\u044b\u0445 \u043c\u0430\u0442\u0440\u0438\u0446 \u0442\u0440\u0435\u0439\u043d \u0438 \u0442\u0435\u0441\u0442 \u0432\u044b\u0431\u043e\u0440\u043e\u043a\nsparse_train_data = get_interaction_matrix(train_data, 'user_id', 'cart', 'count_in_order', user_to_index_mapping, item_to_index_mapping)\nsparse_test_data = get_interaction_matrix(test_data, 'user_id', 'cart', 'count_in_order', user_to_index_mapping, item_to_index_mapping)","1b0f7a4c":"model = LightFM(loss = \"warp\")","076c2456":"start = time.time()\n#===================\n\nmodel.fit(sparse_train_data,\n          user_features=None, \n          item_features=None, \n          sample_weight=None, \n          epochs=20, \n          num_threads=4,\n          verbose=False)\n\n#===================\nend = time.time()\nprint(\"time taken = {0:.{1}f} seconds\".format(end - start, 2))","fe21fd33":"# auc metric score (ranging from 0 to 1)\n\nstart = time.time()\n#===================\n\nauc_without_features = auc_score(model = model, \n                        test_interactions = sparse_test_data,\n                        num_threads = 4, check_intersections = False)\n#===================\nend = time.time()\n\nprint(\"time taken = {0:.{1}f} seconds\".format(end - start, 2))\nprint(\"average AUC without adding item-feature interaction = {0:.{1}f}\".format(auc_without_features.mean(), 2))","e67ce2c7":"users_to_predict = []\nitems_to_predict = []\nfor row in submit_df.to_numpy():\n    user, item = map(int, row[0].split(';'))\n    users_to_predict.append(user)\n    items_to_predict.append(item)\n\nusers_to_predict = np.array(users_to_predict)\nitems_to_predict = np.array(items_to_predict)\n\n\nfor i in range(len(users_to_predict)):\n    users_to_predict[i] = user_to_index_mapping[users_to_predict[i]]\nfor i in range(len(items_to_predict)):\n    items_to_predict[i] = item_to_index_mapping[items_to_predict[i]]","368f29ab":"predictions = model.predict(user_ids= users_to_predict, item_ids= items_to_predict)","24da4fb0":"for pred in range(len(predictions)):\n    if predictions[pred] < 0.5:\n        predictions[pred] = 0\n    else:\n        predictions[pred] = 1","035c3cd3":"target = pd.Series(predictions).astype('int')","484f845c":"submit_df = submit_df.drop('target', axis=1)\nsubmit_df.head()","7ecf0e39":"submit_df['target'] = target\nsubmit_df","8de3d15c":"submit_df.to_csv('submit.csv', sep=',', index=False)","c2f87001":"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u043c, \u043a\u0430\u043a\u0438\u0435 \u0435\u0441\u0442\u044c \u044e\u0437\u0435\u0440\u044b \u0438 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u0442\u043e\u0432\u0430\u0440\u043e\u0432:","fa973333":"\u0418\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u0443\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0435:","0b5c82b9":"\u041f\u0435\u0440\u0435\u0434\u0430\u0435\u043c \u0432 \u043c\u043e\u0434\u0435\u043b\u044c \u0438\u043d\u0434\u0435\u043a\u0441\u044b \u044e\u0437\u0435\u0440\u043e\u0432 \u0438 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0434\u043b\u044f \u043f\u0440\u0435\u0434\u0438\u043a\u0442\u0430:","9e55e9c1":"\u041e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u044c \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u0430 \u0432 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u0440\u0430\u0437\u0440\u0435\u0436\u0435\u043d\u043d\u044b\u0445 \u043c\u0430\u0442\u0440\u0438\u0446. \u0412 \u0444\u0443\u043d\u043a\u0446\u0438\u044e coo_matrix \u043f\u043e\u0434\u0430\u044e\u0442\u0441\u044f \u043d\u0430 \u0432\u0445\u043e\u0434 3 \u043c\u0430\u0441\u0441\u0438\u0432\u0430: \u043c\u0430\u0441\u0441\u0438\u0432 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439 \u0434\u043b\u044f \u043f\u043e\u0434\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438, \u043c\u0430\u0441\u0441\u0438\u0432 \u0441\u0442\u0440\u043e\u043a \u0438 \u0441\u0442\u043e\u043b\u0431\u0446\u043e\u0432. \u041f\u043e\u044d\u0442\u043e\u043c\u0443 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u043b\u043e\u0432\u0430\u0440\u0438 \u0434\u043b\u044f id \u044e\u0437\u0435\u0440\u043e\u0432 \u0438 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u0438 \u0438\u0445 \u0438\u043d\u0434\u0435\u043a\u0441\u043e\u0432 \u0432 \u0440\u0430\u0437\u0440\u0435\u0436\u0435\u043d\u043d\u043e\u0439 \u043c\u0430\u0442\u0440\u0438\u0446\u0435.","47b74b9f":"\u041f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u043e\u0441\u0442\u044c \u0443 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u043e\u0447\u0435\u043d\u044c \u0440\u0430\u0437\u043d\u0430\u044f:","1a89a739":"\u0414\u043b\u044f \u043e\u0446\u0435\u043d\u043a\u0438 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0430 \u043c\u043e\u0434\u0435\u043b\u0438 \u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043b \u043c\u0435\u0442\u0440\u0438\u043a\u0443 AUC, \u0435\u0435 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0435\u0441\u0442\u044c \u0432\u043d\u0443\u0442\u0440\u0438 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438 \u0441 \u043c\u043e\u0434\u0435\u043b\u044c\u044e.","61d4e5fa":"\u0422\u0435\u043f\u0435\u0440\u044c \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0441\u0430\u0431\u043c\u0438\u0442\u0430 \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0438\u0445 \u0432 \u043c\u043e\u0434\u0435\u043b\u044c \u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u0438\u0439. \u0414\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u0441\u043d\u0430\u0447\u0430\u043b\u0430 \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0435\u043c \u0438\u0437 \u0441\u0430\u0431\u043c\u0438\u0442 \u0444\u0430\u0439\u043b\u0430 \u043a\u0430\u043a\u0438\u0435 \u043f\u0430\u0440\u044b \u044e\u0437\u0435\u0440-\u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u0440\u0435\u0434\u0438\u043a\u0442\u0438\u0442\u044c.\n\u0414\u0430\u043b\u0435\u0435 \u0437\u0430\u043c\u0435\u043d\u044f\u0435\u043c \u0438\u0434 \u044e\u0437\u0435\u0440\u043e\u0432 \u0438 \u0438\u0434 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u043d\u0430 \u0438\u043d\u0434\u0435\u043a\u0441\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u043e\u043d\u0438\u043c\u0430\u0435\u0442 \u0438 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442 \u043c\u043e\u0434\u0435\u043b\u044c.","cf0f1aa6":"# **\u041c\u043e\u0434\u0435\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435**","191e89bf":"\u0421\u0435\u0440\u0432\u0438\u0441\u044b \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438 \u0435\u0434\u044b \u0443\u0436\u0435 \u0434\u0430\u0432\u043d\u043e \u043f\u0435\u0440\u0435\u0441\u0442\u0430\u043b\u0438 \u0431\u044b\u0442\u044c \u043f\u0440\u043e\u0441\u0442\u043e \u043a\u0443\u0440\u044c\u0435\u0440\u0430\u043c\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u0440\u0438\u0432\u043e\u0437\u044f\u0442 \u0437\u0430\u043a\u0430\u0437. \u0418\u043d\u0434\u0443\u0441\u0442\u0440\u0438\u044f e-grocery \u0441\u0442\u0440\u0435\u043c\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0438\u0434\u0435\u0442 \u043a \u0430\u043a\u043a\u0443\u043c\u0443\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044e \u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044e \u0431\u043e\u043b\u044c\u0448\u0438\u0445 \u0434\u0430\u043d\u043d\u044b\u0445, \u0447\u0442\u043e\u0431\u044b \u0437\u043d\u0430\u0442\u044c \u043e \u0441\u0432\u043e\u0438\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u0445 \u0431\u043e\u043b\u044c\u0448\u0435 \u0438 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0442\u044c \u0431\u043e\u043b\u0435\u0435 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0435 \u0438 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0443\u0441\u043b\u0443\u0433\u0438. \u041e\u0434\u043d\u0438\u043c \u0438\u0437 \u0448\u0430\u0433\u043e\u0432 \u043a \u0442\u0430\u043a\u043e\u0439 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u043c\u043e\u0434\u0435\u043b\u0438, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043f\u043e\u043d\u0438\u043c\u0430\u0435\u0442 \u043f\u0440\u0438\u0432\u044b\u0447\u043a\u0438 \u0438 \u043d\u0443\u0436\u0434\u044b \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u0438, \u043a \u043f\u0440\u0438\u043c\u0435\u0440\u0443, \u043c\u043e\u0436\u0435\u0442 \u0443\u0433\u0430\u0434\u0430\u0442\u044c, \u0447\u0442\u043e \u0438 \u043a\u043e\u0433\u0434\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0437\u0430\u0445\u043e\u0447\u0435\u0442 \u0437\u0430\u043a\u0430\u0437\u0430\u0442\u044c \u0432 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0440\u0430\u0437.\n\n\u0422\u0430\u043a\u0430\u044f \u043c\u043e\u0434\u0435\u043b\u044c, \u0431\u0443\u0434\u0443\u0447\u0438 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0430\u043d\u043d\u043e\u0439, \u043c\u043e\u0436\u0435\u0442 \u043f\u0440\u0438\u043d\u0435\u0441\u0442\u0438 \u0437\u043d\u0430\u0447\u0438\u0442\u0435\u043b\u044c\u043d\u0443\u044e \u0446\u0435\u043d\u043d\u043e\u0441\u0442\u044c \u0434\u043b\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u0430 - \u0441\u044d\u043a\u043e\u043d\u043e\u043c\u0438\u0442\u044c \u0432\u0440\u0435\u043c\u044f \u043f\u0440\u0438 \u0441\u0431\u043e\u0440\u043a\u0435 \u043a\u043e\u0440\u0437\u0438\u043d\u044b, \u043f\u043e\u043c\u043e\u0447\u044c \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u0437\u0430\u0431\u044b\u0442\u044c \u0432 \u0437\u0430\u043a\u0430\u0437\u0435, \u0443\u0431\u0440\u0430\u0442\u044c \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u044c \u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0437\u0430\u043a\u0443\u043f\u043a\u0438 \u0438 \u0441\u043b\u0435\u0434\u0438\u0442\u044c \u0437\u0430 \u0437\u0430\u043a\u0430\u043d\u0447\u0438\u0432\u0430\u044e\u0449\u0438\u043c\u0438\u0441\u044f \u0437\u0430\u043f\u0430\u0441\u0430\u043c\u0438 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432.\n\n\u0412 \u0434\u0430\u043d\u043d\u043e\u043c \u0441\u043e\u0440\u0435\u0432\u043d\u043e\u0432\u0430\u043d\u0438\u0438 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430\u043c \u043f\u0440\u0435\u0434\u043b\u0430\u0433\u0430\u0435\u0442\u0441\u044f \u0440\u0435\u0448\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443 \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u0438\u044f \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0433\u043e \u0437\u0430\u043a\u0430\u0437\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (\u0431\u0435\u0437\u043e\u0442\u043d\u043e\u0441\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u043c\u043e\u043c\u0435\u043d\u0442\u0430 \u0432\u0440\u0435\u043c\u0435\u043d\u0438, \u043a\u043e\u0433\u0434\u0430 \u044d\u0442\u043e\u0442 \u0437\u0430\u043a\u0430\u0437 \u043f\u0440\u043e\u0438\u0437\u043e\u0439\u0434\u0435\u0442). \u0417\u0430\u043a\u0430\u0437 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0441\u043e\u0441\u0442\u043e\u0438\u0442 \u0438\u0437 \u0441\u043f\u0438\u0441\u043a\u0430 \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u0442\u043e\u0432\u0430\u0440\u043e\u0432, \u0432\u043d\u0435 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u0442\u043e\u0433\u043e, \u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432 \u043a\u0430\u0436\u0434\u043e\u0439 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u043e\u043d \u0432\u0437\u044f\u043b.\n","c200d6f8":"# **SberMarket Competition**\n*Predict the user's next order*","51f3969f":"\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c \u043c\u043e\u0434\u0435\u043b\u044c. \u042f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043b \u0444\u0443\u043d\u043a\u0446\u0438\u044e \u043f\u043e\u0442\u0435\u0440\u0438 \u00abWARP\u00bb, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0447\u0430\u0441\u0442\u043e \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u043b\u0443\u0447\u0448\u0438\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u0432 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0435 LightFM.","19d4152c":"\u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0434\u0430\u0442\u0430\u0441\u0435\u0442 \u0441 \u0438\u0441\u0442\u043e\u0440\u0438\u0435\u0439 \u0437\u0430\u043a\u0430\u0437\u043e\u0432 20000 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0432\u043f\u043b\u043e\u0442\u044c \u0434\u043e \u0434\u0430\u0442\u044b \u043e\u0442\u0441\u0435\u0447\u043a\u0438, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0440\u0430\u0437\u0434\u0435\u043b\u044f\u0435\u0442 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u044b\u0435 \u0438 \u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438.\n\ntrain.csv:\nuser_id - \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0439 id \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\norder_completed_at - \u0434\u0430\u0442\u0430 \u0437\u0430\u043a\u0430\u0437\u0430\ncart - \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 (category_id), \u0438\u0437 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0441\u043e\u0441\u0442\u043e\u044f\u043b \u0437\u0430\u043a\u0430\u0437\n\u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u043f\u0440\u043e\u0433\u043d\u043e\u0437\u0430 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0439 \u043f\u0430\u0440\u044b \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c-\u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f \u0438\u0437 \u043f\u0440\u0438\u043c\u0435\u0440\u0430 \u0441\u0430\u0431\u043c\u0438\u0442\u0430 \u0432\u0435\u0440\u043d\u0443\u0442\u044c 1, \u0435\u0441\u043b\u0438 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c \u0432 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u043c \u0437\u0430\u043a\u0430\u0437\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u0438\u043b\u0438 0 \u0432 \u0438\u043d\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435. \u0421\u043f\u0438\u0441\u043e\u043a \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043f\u0440\u0438\u043c\u0435\u0440\u0435 \u0441\u0430\u0431\u043c\u0438\u0442\u0430 - \u044d\u0442\u043e \u0432\u0441\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043e\u043d \u043a\u043e\u0433\u0434\u0430-\u043b\u0438\u0431\u043e \u0437\u0430\u043a\u0430\u0437\u044b\u0432\u0430\u043b.","42aa60bb":"\u041c\u043e\u0434\u0435\u043b\u044c \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043e\u0446\u0435\u043d\u043a\u0438 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0438\u0437 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u044e\u0437\u0435\u0440 \u043c\u043e\u0436\u0435\u0442 \u043a\u0443\u043f\u0438\u0442\u044c. \u041f\u043e\u044d\u0442\u043e\u043c\u0443 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0435 \u0441\u043e\u0433\u043b\u0430\u0441\u043d\u043e \u0443\u0441\u043b\u043e\u0432\u0438\u044e \u0437\u0430\u0434\u0430\u0447\u0438 \u0438 \u0441\u0444\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u043c \u0441\u0430\u0431\u043c\u0438\u0442 \u0444\u0430\u0439\u043b: ","fa0463c1":"\u041d\u0430\u0447\u043d\u0435\u043c \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0443 \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0438 \u043c\u043e\u0434\u0435\u043b\u0438. \u0412 \u043f\u0435\u0440\u0432\u0443\u044e \u043e\u0447\u0435\u0440\u0435\u0434\u044c \u0441\u043b\u0435\u0434\u0443\u0435\u0442 \u043e\u0442\u043e\u0431\u0440\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0442\u0435\u0445 \u044e\u0437\u0435\u0440\u043e\u0432 \u0438 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u0442\u043e\u0432\u0430\u0440\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043e\u043a\u0430\u0437\u0430\u043b\u0438\u0441\u044c \u0432 \u0441\u0430\u0431\u043c\u0438\u0442\u0435.","71e86e20":"\u0418\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u0443\u0435\u043c \u0432\u0441\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0435 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438.\n\u0414\u043b\u044f \u0430\u043d\u0430\u043b\u0438\u0437\u0430 \u0438 \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043d\u0430\u0434\u043e\u0431\u044f\u0442\u0441\u044f Numpy \u0438 Pandas. \n\u0414\u043b\u044f \u043f\u0440\u0435\u0434\u0438\u043a\u0442\u0430 \u0431\u0443\u0434\u0435\u043c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043c\u043e\u0434\u0435\u043b\u044c LightFM. \u041f\u0440\u0438 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0438 \u043d\u0430 \u0432\u0445\u043e\u0434 \u044d\u0442\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 \u043f\u043e\u0434\u0430\u0435\u0442\u0441\u044f \u0440\u0430\u0437\u0440\u0435\u0436\u0435\u043d\u043d\u0430\u044f \u043c\u0430\u0442\u0440\u0438\u0446\u0430, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u0430 \u0444\u0443\u043d\u043a\u0446\u0438\u044f coo_matrix \u0438\u0437 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438 scipy.","227b833b":"\u0412 \u0441\u0430\u0431\u043c\u0438\u0442\u0435 2 \u043a\u043e\u043b\u043e\u043d\u043a\u0438: \u0432 \u043f\u0435\u0440\u0432\u043e\u0439 \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u0441\u044f \u043a\u043e\u043c\u0431\u0438\u043d\u0430\u0446\u0438\u044f \u0438\u0434 \u044e\u0437\u0435\u0440\u0430 \u0438 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u0442\u043e\u0432\u0430\u0440\u0430, \u0432\u043e \u0432\u0442\u043e\u0440\u043e\u0439 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0447\u0438\u0441\u043b\u043e 1 \u0438\u043b\u0438 0, \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u0442\u043e\u0433\u043e \u0431\u0443\u0434\u0435\u0442 \u044d\u0442\u043e\u0442 \u0442\u043e\u0432\u0430\u0440 \u043a\u0443\u043f\u043b\u0435\u043d \u0438\u043b\u0438 \u043d\u0435\u0442.sample_submission.csv:\n\u041f\u0440\u0438\u043c\u0435\u0440 \u0441\u0430\u0431\u043c\u0438\u0442\u0430. \u0412 \u0442\u0435\u0441\u0442 \u0432\u0445\u043e\u0434\u044f\u0442 \u043d\u0435 \u0432\u0441\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438 \u0438\u0437 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445, \u0442\u0430\u043a \u043a\u0430\u043a \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0438\u0437 \u043d\u0438\u0445 \u0442\u0430\u043a \u043d\u0438\u0447\u0435\u0433\u043e \u0438 \u043d\u0435 \u0437\u0430\u043a\u0430\u0437\u0430\u043b\u0438 \u043f\u043e\u0441\u043b\u0435 \u0434\u0430\u0442\u044b \u043e\u0442\u0441\u0435\u0447\u043a\u0438.\n\nid - \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u0441\u0442\u0440\u043e\u043a\u0438 - \u0441\u043e\u0441\u0442\u043e\u0438\u0442 \u0438\u0437 user_id \u0438 category_id, \u0440\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0445 \u0442\u043e\u0447\u043a\u043e\u0439 \u0441 \u0437\u0430\u043f\u044f\u0442\u043e\u0439: f'{user_id};{category_id}'. \u0418\u0437-\u0437\u0430 \u043e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0435\u0439 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u044e\u0449\u0435\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b Kaggle InClass, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u043e\u043b\u043e\u043d\u043a\u0438 user_id, category_id \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0438\u043d\u0434\u0435\u043a\u0441\u0430 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\ntarget - 1 \u0438\u043b\u0438 0 - \u0431\u0443\u0434\u0435\u0442 \u043b\u0438 \u0434\u0430\u043d\u043d\u0430\u044f \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c \u0432 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u043c \u0437\u0430\u043a\u0430\u0437\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f","16300aa5":"# **\u0424\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u043e\u0439 \u0438 \u0442\u0435\u0441\u0442\u043e\u0432\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0438.**\n\u0414\u043b\u044f \u0442\u043e\u0433\u043e \u0447\u0442\u043e\u0431\u044b \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u0443\u044e \u0438 \u0442\u0435\u0441\u0442\u043e\u0432\u0443\u044e \u0432\u044b\u0431\u043e\u0440\u043a\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0437\u043d\u0430\u0442\u044c \u0434\u0430\u0442\u0443 \u0437\u0430\u043a\u0430\u0437\u043e\u0432. \u041f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435 \u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0435 \u0437\u0430\u043a\u0430\u0437\u044b \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0431\u044b\u043b\u043e \u0431\u044b \u043b\u043e\u0433\u0438\u0447\u043d\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0432 \u0442\u0435\u0441\u0442\u043e\u0432\u0443\u044e \u0432\u044b\u0431\u043e\u0440\u043a\u0443\n"}}