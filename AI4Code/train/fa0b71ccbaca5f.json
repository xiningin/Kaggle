{"cell_type":{"4de182bf":"code","ef71cf5b":"code","e0f68509":"code","fed37dde":"code","41df9a23":"code","4703752a":"code","835117e9":"code","0fd17c48":"code","eb448d83":"code","9fa8f860":"code","8d337ed3":"code","bf822573":"code","be3d62b4":"code","b15dd855":"code","44c39efd":"code","7cfbb313":"code","b54ef99f":"code","9d1b2749":"code","60a25b1a":"code","5ae8bfd0":"code","72f15ff7":"code","c9be44f7":"code","5b10420a":"code","9e838f26":"markdown","5468d7f0":"markdown","c2a853af":"markdown","b36f7db7":"markdown","4dcc4a5a":"markdown","34847819":"markdown","d9d5e5f2":"markdown","9575b8c5":"markdown","7ff9d9c0":"markdown","0db65b57":"markdown","3bddb978":"markdown","2489562f":"markdown","140da45f":"markdown","533f1afe":"markdown","05669df0":"markdown","fdc2b495":"markdown","198e42c2":"markdown","3ec65502":"markdown","e25f7ef3":"markdown","44ed1235":"markdown"},"source":{"4de182bf":"# Import the necessary modules\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom scipy import stats\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import LabelEncoder","ef71cf5b":"# Load the dataset containing the various expenses of 50 startups and their profits\ndf = pd.read_csv(\"..\/input\/various-expenses-and-the-profits-of-50-startups\/50_Startups.csv\")\n# Preview\ndf.head()","e0f68509":"# Check for missing values\ndf.info()","fed37dde":"# LabelEncoder from sklearn.preprocessing can be used to convert multiple categories in a categorical variable into numerical values\ncatToNum = LabelEncoder()\ndf[\"State\"] = catToNum.fit_transform(df[\"State\"])\n# Preview\ndf.head()","41df9a23":"# Change the name of the R&D Spend column to RD and Marketing Spend to Marketing\ndf.rename(columns = {\"R&D Spend\" : \"RD\", \"Marketing Spend\" : \"Marketing\"}, inplace = True)\n# Preview\ndf.head()","4703752a":"df.describe()","835117e9":"df.info()","0fd17c48":"plt.figure(figsize = (14, 8))\nsns.boxplot(x = df.columns, y = [df[col] for col in df.columns])","eb448d83":"df.corr()","9fa8f860":"# Check the differences in the means\n# California: 0, Florida: 1, New York: 2\ndf.groupby(\"State\", as_index = True).mean()[\"Profit\"].to_frame()","8d337ed3":"# Check the differences in minimums and maximums\nmaximums = df.groupby(\"State\").max()[\"Profit\"].to_frame()\nminimums = df.groupby(\"State\").min()[\"Profit\"].to_frame()\nminimums.merge(maximums, on = \"State\").rename(columns = {\"Profit_x\" : \"min\", \"Profit_y\" : \"max\"})","bf822573":"sns.boxplot(data = df, x = \"State\", y = \"Profit\")","be3d62b4":"stateGroups = df.groupby(\"State\", as_index = True)\ngCal, gFlor, gNY = stateGroups.get_group(0)[\"Profit\"], stateGroups.get_group(1)[\"Profit\"], stateGroups.get_group(2)[\"Profit\"]\n# So I got the groups above and now I'll create a list for making the pairing easy during the F-tests\nprofitGroups = [gCal, gFlor, gNY, gCal]\nfor i in range(3):\n    f_score, p_value = stats.f_oneway(profitGroups[i], profitGroups[i + 1])\n    print('''\\\n    Category pair: (%d, %d)\n    F-Score = %f\n    P-Value (Confidence Score) = %f\n    '''%(i, (i + 1) % 3, f_score, p_value))","b15dd855":"fig, axes = plt.subplots(2, 2, figsize = (14, 12))\nfig.suptitle(\"Regression plots: Profit vs expenses and State\", fontsize = 20)\naxesList = list(axes[0])\naxesList.extend(list(axes[1]))\n\nfor i, axis in enumerate(axesList):\n    col = df.columns[i]\n    sns.regplot(data = df, x = col, y = \"Profit\", ax = axis)\n    axis.set_title(\"Profit vs %s %s\"%(col, \"costs\" if col != \"State\" else \"categories\"), fontsize = 15)\n\n# plt.savefig(\"Profit_vs_Expenses.jpg\")\nplt.show()","44c39efd":"trainX, testX, trainy, testy = train_test_split(df[df.columns[:-1]], df[[\"Profit\"]], test_size = 1\/5, random_state = 0)","7cfbb313":"# Instantiate the linear regression object\nregr = LinearRegression()","b54ef99f":"# Train using the training set\nregr.fit(trainX, trainy)","9d1b2749":"# Print out the coefficients matrix (m * n) and the intercept vector (m,)\nprint('''\\\nCoefficients: %s\nIntercepts: %s\n'''%(regr.coef_, regr.intercept_))","60a25b1a":"# Firstly, let's create the trainyCap and testyCap arrays by predicting values based on trainX and testX, respectively\ntrainyCap = regr.predict(trainX)\ntestyCap = regr.predict(testX)","5ae8bfd0":"# Training set's evaluation\nmse = mean_squared_error(trainy, trainyCap)\nrmse = np.sqrt(mse) # or mean_squared_error(trainy, trainyCap, squared = False)\nr2 = r2_score(trainy, trainyCap)","72f15ff7":"# Test set's evaluation\nmse2 = mean_squared_error(testy, testyCap)\nrmse2 = np.sqrt(mse2) # or mean_squared_error(trainy, trainyCap, squared = False)\nr22 = r2_score(testy, testyCap)","c9be44f7":"# Convert the above results into a dataframe\ndfEvaluation = pd.DataFrame({\"Train\" : [mse, rmse, r2], \"Test\" : [mse2, rmse2, r22]}, index = [\"MSE\", \"RMSE\", \"R2 Score\"])","5b10420a":"# View\ndfEvaluation","9e838f26":"This informs us that Administration costs and State are poorly related to Profit linearly and that RD is very strongly related (quite obvious).\nBut the State categorical variable MIGHT be a good factor in determining Profit, if combined with other factors. Let's check how different are the profits in case of different States.","5468d7f0":"From the above analysis, we see that Marketing costs have the widest range and Administration costs have the narrowest one. The expenses are almost equally distributed among the two sides of the medians and no type of expenses has any outlier.\nHowever the range of the profits is quite small and has a lower outlier.","c2a853af":"Now I'll check the statistical scores in both the cases","b36f7db7":"Let's plot the regression plots between Profit and each of the expenses, and also the State!","4dcc4a5a":"Let's look at the correlation table to check how good are the expenses at predicting the profit, in terms of linear relationship.","34847819":"<h1>Profit Prediction from Expenses<\/h1>\n\nby <b>Santanu Sikder<\/b>","d9d5e5f2":"<h3>Model Training<\/h3>","9575b8c5":"<h3>Data Loading and Cleaning<\/h3>","7ff9d9c0":"<h3>Data Analysis and Visualisation<\/h3>","0db65b57":"<h3>Model Evaluation and Testing our Model<\/h3>","3bddb978":"Fortunately, there's no need of standard scaling. So I'll directly perform the Train-Test split.","2489562f":"The maximum Profits yielded by the States are almost equal while the minimum values have visible differences.\nTime for the boxplots!","140da45f":"For deeper understanding, I'll do a F-test and examine the F-values for the various pairs of groups","533f1afe":"<h3>Processing Data for Model Training<\/h3>","05669df0":"To understand the above data better, I'm going to plot a boxplot.","fdc2b495":"Neither there is any missing value, nor any unstandardised one.\nThe only thing left is to convert the categorical variable State into a numerical one.","198e42c2":"The above data confirms our correlation table that State is not a good linear predictor for Profit alone.","3ec65502":"Also, the Research & Development expenses (RD) and the Administration costs have a similar range as that of the Profits, but that of the Marketing costs is very different (large and varied).","e25f7ef3":"Let's study the dataframe a bit more using describe and info.","44ed1235":"I'll use MSE, RMSE and R2-Score to evaluate this model."}}