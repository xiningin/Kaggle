{"cell_type":{"19ddbb45":"code","32ac9f62":"code","3f2e586a":"code","e43778c3":"code","904a7b96":"code","2a35d973":"code","bf16de0a":"code","5f7e15ff":"code","9554a3c1":"code","2e534c4e":"code","3bc6e706":"markdown","a2587b11":"markdown","c7c6d32a":"markdown","c3d1d51c":"markdown","19aefe67":"markdown","faab914f":"markdown","02fe1375":"markdown","b0db6c6c":"markdown","d35b707c":"markdown","b91fae14":"markdown","d802e3cc":"markdown","73191523":"markdown"},"source":{"19ddbb45":"import numpy as np \nimport pandas as pd\nimport seaborn as sns\n\nimport matplotlib.pyplot as plt\n%matplotlib inline","32ac9f62":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","3f2e586a":"df1 = pd.read_csv('..\/input\/tabular-playground-series-jun-2021\/train.csv')\ndf2 = pd.read_csv('..\/input\/tabular-playground-series-jun-2021\/test.csv')\nsam = pd.read_csv('..\/input\/tabular-playground-series-jun-2021\/sample_submission.csv')","e43778c3":"sub1 = pd.read_csv('..\/input\/tps06-nns-gbts-optimization\/submission.csv')\n# Public Score: 1.74400\n# display(sub1)","904a7b96":"sub2 = pd.read_csv('..\/input\/2-tps-jun-21-comparative-method-for-classifier\/submission_imp.csv')\n# Public Score: 1.74408\n# display(sub2)","2a35d973":"def generate(main, support, coeff):\n    \n    g = main.copy()    \n    for i in main.columns[1:]:\n        \n        res = []\n        lm, Is = [], []        \n        lm = main[i].tolist()\n        ls = support[i].tolist()  \n        \n        for j in range(len(main)):\n            res.append((lm[j] * coeff) + (ls[j] * (1.- coeff)))            \n        g[i] = res\n        \n    return g","bf16de0a":"def generation(main, support, coeff): \n    sub1  = support.copy()\n    sub1v = sub1.values    \n    \n    sub2  = main.copy() \n    sub2v = sub2.values\n       \n    imp  = main.copy()    \n    impv = imp.values  \n    NCLASS = 9\n    number = 0\n    \n    for i in range (len(main)):               \n        \n        row1 = sub1v[i,1:]\n        row2 = sub2v[i,1:]\n        row1_sort = np.sort(row1)\n        row2_sort = np.sort(row2) \n        \n        row = (row2 * coeff) + (row1 * (1.0 - coeff))\n        row_sort = np.sort(row)        \n        \n        for j in range (NCLASS):             \n            if ((row2[j] == row2_sort[8]) and (row1[j] != row1_sort[8])):                                \n                row = row2 \n                number = number + 1            \n#               print(number, i)\n        \n        impv[i, 1:] = row\n    \n    imp.iloc[:, 1:] = impv[:, 1:]\n    print(f'Number of rows unchanged: {number}')\n    print(30 * '=')                                        \n    return imp\n","5f7e15ff":"sub = generation(sub2, sub1, 0.40)\n\nsub_ens = sub","9554a3c1":"display(sub_ens, sub_ens.describe().transpose())","2e534c4e":"sub_ens.to_csv(\"submission_ens.csv\",index=False)\n# Public Score: 1.74378\n!ls","3bc6e706":"## Smart Ensembling:","a2587b11":"<div class=\"alert alert-success\">\n    <h1 align=\"center\">If you find this work useful, please don't forget upvoting :)<\/h1>\n<\/div>","c7c6d32a":"## Description:\n\nWe use the \"Smart Ensembling\" method in this notebook. In this method, the values of all rows are not combined. That is, a number of rows are selected and \"Ensembling\" is not done for these rows. In other words, the values of these rows will be unchanged, and we will equate the values of these rows to a better set. This method is our own initiative and you can refer to the following address for more information:\n\n## [Smart Ensembling for Classification](https:\/\/www.kaggle.com\/c\/tabular-playground-series-jun-2021\/discussion\/248454)\nhttps:\/\/www.kaggle.com\/c\/tabular-playground-series-jun-2021\/discussion\/248454\n","c3d1d51c":"#### Thanks to: @hiro5299834\n\n#### [New Version] Notebook Name: [TPS06 NNs+GBTs w\/ optimization](https:\/\/www.kaggle.com\/hiro5299834\/tps06-nns-gbts-optimization)\n\n#### https:\/\/www.kaggle.com\/hiro5299834\/tps06-nns-gbts-optimization","19aefe67":"<div class=\"alert alert-success\">  \n<\/div>","faab914f":"#### Notebook Name: [[2] TPS Jun 21 - Comparative Method for Classifier](https:\/\/www.kaggle.com\/mehrankazeminia\/2-tps-jun-21-comparative-method-for-classifier)\n\n#### https:\/\/www.kaggle.com\/mehrankazeminia\/2-tps-jun-21-comparative-method-for-classifier","02fe1375":"## Import & Data Set","b0db6c6c":"## Ensembling:","d35b707c":"<div>\n    <h1 align=\"center\">Smart Ensembling for Classifier<\/h1>\n    <h1 align=\"center\">Tabular Playground Series - Jun 2021<\/h1>      \n    <h4 align=\"center\">By: Somayyeh Gholami & Mehran Kazeminia<\/h4>\n<\/div>","b91fae14":"<div class=\"alert alert-success\">  \n<\/div>","d802e3cc":"<div class=\"alert alert-success\">  \n<\/div>","73191523":"<div class=\"alert alert-success\">  \n<\/div>"}}