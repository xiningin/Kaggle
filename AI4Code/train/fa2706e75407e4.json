{"cell_type":{"470f2784":"code","d18a78bd":"code","8c022def":"code","e696bb51":"code","402cd3e6":"code","27847606":"markdown"},"source":{"470f2784":"import pandas as pd\nfrom google.colab import drive\nimport warnings\nwarnings.filterwarnings(\"ignore\")","d18a78bd":"drive.mount('\/content\/drive')","8c022def":"xls = pd.ExcelFile('pastanogoogledrive!!!!')\n\nxls=xls.sheet_names","e696bb51":"xls.remove(\"ocorrencia (3)\")\nprint(xls)","402cd3e6":"df2=pd.read_excel('pastanogoogledrive!!!!', sheet_name=\"ocorrencia (3)\")\nsearch2=pd.DataFrame()\n\ndf5=pd.DataFrame()\ndfgg=pd.read_excel('pastanogoogledrive!!!!', sheet_name=\"ocorrencia (3)\")\nfor x in xls:\n  df1=pd.read_excel('pastanogoogledrive!!!!', sheet_name=x)\n  \n  print(len(df5))\n  print(len(dfgg))\n  for x1 in range(len(df1)):\n    ll=x1\n    df3=df1.loc[x1:x1]\n    dfalt=df3\n    df3=df3[\"codigo_ocorrencia\"].values[0]\n    search=df2[df2[\"codigo_ocorrencia1\"]==df3]\n    search2=df2[df2[\"codigo_ocorrencia1\"]!=df3]\n    if search.empty==False:\n      search=search.reset_index(drop=True)\n      dfalt=dfalt.reset_index(drop=True)\n      df4=pd.concat([search,dfalt], axis=1)\n      df4=df4.drop(columns=\"codigo_ocorrencia\")\n      df5=pd.concat([df5,df4])\n      df5=df5.reset_index(drop=True)\n      df2=search2\n      df2=df2.reset_index(drop=True)\n\n  print(len(df5))\n  print(len(dfgg))\n  if len(df5)<len(dfgg):\n     df5=pd.concat([df5,search2])\n     df5.reset_index(drop=True)\n  df2=df5\n  df6=df5\n  df5=pd.DataFrame()\n\nprint(\"Finish\")\ndf6.to_csv(\"pastanogoogledrive!!!!\",sep=\";\",index=False, encoding='utf-8', mode=\"w\", decimal=',')\n\n\n\n\n    ","27847606":"### Fala Fellas!\nBem, basicamente esse c\u00f3digo une as informa\u00e7\u00f5es que eu baixei dos dados abertos do cenipa em uma s\u00f3 planilha, atr\u00e1ves do c\u00f3digo de ocorrencia. Ou seja eu fa\u00e7o join com a planilha principal. Passo a passo:\n\n-Baixar as planilhas no Dados Abertos do Cenipa;\n\n-Abrir todas as planilhas e depois colocar todas as abas em uma s\u00f3 planilha (n\u00e3o precisar mudar o nome das abas);\n\n-Na Planilha principal (ocorrencia), eu mudei o nome para \"codigo_ocorrencia1\" e apaguei as outras colunas da mesma aba com o nome \"codigo_ocorrencia\";\n\n-Salvei tudo no google drive, e botei o programa para rodar.\n\nBem eu tinha feito esse notebook no google colab e usei meu google drive para rodar o programa. Ent\u00e3o onde estiver escrito \"pastanogoogledrive!!!!\" \u00e9 o endere\u00e7o da minha pasta no google drive com os arquivo baixado.\n\nQualquer d\u00favida \u00e9 s\u00f3 me chamar!\n\n(11) 94937-0306 |whatsapp|\nmarcus.rodrigues4003@gmail.com |email|\n\nSorry, pela bagun\u00e7a no c\u00f3digo!\n\nAtenciosamente Marcus Vinicius!\n\n"}}