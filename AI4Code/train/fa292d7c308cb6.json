{"cell_type":{"9e770335":"code","ec159889":"code","bd444083":"code","147250e3":"code","f43ec328":"code","f8429d70":"code","a14d2cae":"code","87233492":"code","72d2a2e5":"code","a9ae9801":"code","bbd12c95":"code","87178d8d":"code","0e38ec53":"code","44e637d1":"code","877ca929":"code","ead9ea32":"code","292dbb0c":"code","cd08ee2b":"code","68ccef5a":"code","1d3ee3b8":"code","dd373a47":"code","139248ba":"code","92bd8344":"code","735deb0e":"code","ff09b562":"code","18432d3e":"code","1027e4da":"code","7acf3df4":"code","1cf71272":"markdown","dfe0f928":"markdown","c3031e9e":"markdown","4402d657":"markdown","df5cb242":"markdown","12846241":"markdown","65255f2e":"markdown","38958214":"markdown","456f896a":"markdown","f23ace86":"markdown","eed02361":"markdown","96c0430c":"markdown"},"source":{"9e770335":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/working'):\n    print(dirname)\n#     for filename in filenames:\n#         print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","ec159889":"!pwd","bd444083":"path= '..\/input\/donald-trumps-rallies'","147250e3":"from fastai.text.all import *","f43ec328":"!cp {path}\/* '\/kaggle\/working'","f8429d70":"path =Path('\/kaggle\/working')","a14d2cae":"path.ls()","87233492":"# help needed how to get this working\n\ndls_lm = DataBlock(\n    blocks=TextBlock.from_folder(path, is_lm=True),\n    get_items=get_text_files, splitter=RandomSplitter(0.1),\n).dataloaders(path,path=path, bs=128, seq_len=80)","72d2a2e5":"dls_lm.show_batch(max_n=2)","a9ae9801":"learn_lm = language_model_learner(dls_lm, AWD_LSTM, pretrained=True, metrics=[accuracy, Perplexity()]).to_fp16()","bbd12c95":"learn_lm.fine_tune(10, 4e-3)","87178d8d":"learn_lm.save_encoder('fine_tuned')","0e38ec53":"TEXT = 'My aim at this office is to '\nN_WORDS = 40\nN_SENTENCES = 2\npreds = [learn.predict(TEXT, N_WORDS, temperature=0.75) for _ in range(N_SENTENCES)]","44e637d1":"print('\\n'.join(preds))","877ca929":"def trumpsays(model, N_WORDS=40,N_SENTENCES=2, TEXT='My aim at this office is to '):\n    preds = [model.predict(TEXT, N_WORDS, temperature=0.75) for _ in range(N_SENTENCES)]\n    print('\\n'.join(preds))","ead9ea32":"learn_lm.unfreeze()\nlearn.fit_one_cycle(10,2e-3)\n","292dbb0c":"trumpsays(learn_lm)","cd08ee2b":"learn_lm.lr_find()\n\n","68ccef5a":"# learn_lm.unfreeze()\n# learn.fit_one_cycle(10,2e-3)\n\n\n# trying more of this is actually bringing accuracy down","1d3ee3b8":"trumpsays(learn_lm, TEXT='I like Ashwin because')","dd373a47":"learn_lm.lr_find()","139248ba":"learn_lm.save('finetuned10')","92bd8344":"learn.load('finetuned10')","735deb0e":"learn.to_fp16()\n\nlr = 1e-5\nmoms = (0.8,0.7, 0.8)\nlr *= learn_lm.dls.bs\/128\nlearn.fit_one_cycle(1, lr, moms=moms, wd=0.1)","ff09b562":"learn.freeze_to(-2)\nlr\/=2\nlearn.fit_one_cycle(1, slice(lr\/(2.6**4), lr), moms=moms, wd=0.1)","18432d3e":"learn.freeze_to(-3)\nlr \/=2\nlearn.fit_one_cycle(1, slice(lr\/(2.6**4), lr), moms=moms, wd=0.1)","1027e4da":"learn.unfreeze()\nlr \/= 5\nlearn.fit_one_cycle(2, slice(lr\/(2.6**4),lr), moms=(0.8,0.7,0.8), wd=0.1)","7acf3df4":"trumpsays(learn, N_WORDS=100,N_SENTENCES=2, TEXT='We need to build a wall')","1cf71272":"to have clarity over what path to use","dfe0f928":"its actually amazing how nice fastai library is.","c3031e9e":"### trying ulmfit method \n\nagain from muellerzr : https:\/\/www.kaggle.com\/muellerzr\/end-to-end-fastai2\/comments","4402d657":"### Language model","df5cb242":"### Spewing like trump","12846241":"I don't actually know how to get exponential learning rate from this\nany help would be good from comments\n\na resource to understand: https:\/\/sgugger.github.io\/how-do-you-find-a-good-learning-rate.html\n\nI feel like i should take 1e-5 here","65255f2e":"from incredibly helpful notebook : https:\/\/www.kaggle.com\/muellerzr\/end-to-end-fastai2","38958214":"Ill take my chances with 1e-5","456f896a":"### Further improvements\n\nTrying the ulm-fit method","f23ace86":"### There is scope for further improvement here","eed02361":"# Can the model speak like trump ?\n\nfrom chapter 10 fastbook.\nand this very helpful kernel: from incredibly helpful notebook : https:\/\/www.kaggle.com\/muellerzr\/end-to-end-fastai2`","96c0430c":"* Side note problem I had faced regarding the path:\n\nchecked here : https:\/\/docs.fast.ai\/text.data\n\nand here:\nhttps:\/\/forums.fast.ai\/t\/oserror-errno-30-read-only-file-system\/33216\/4\n\nfinally put all the input files into \/kaggle\/working to avoid the read only error"}}