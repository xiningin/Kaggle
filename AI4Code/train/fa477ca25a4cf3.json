{"cell_type":{"a951fc81":"code","f367a3eb":"code","a7d05e85":"code","525d60d7":"code","929908d1":"code","e7ed1d62":"code","e7d69ec4":"code","45163f74":"code","6f591729":"code","80d5f5b9":"code","e5ccb86b":"markdown","189da253":"markdown","be1cd9e0":"markdown","cddd8556":"markdown"},"source":{"a951fc81":"from IPython.display import clear_output\n!pip install autogluon --user \nclear_output()","f367a3eb":"import numpy as np \nimport pandas as pd\nimport os\n\nimport fastai\nfrom fastai.vision.all import *\nfrom fastai.vision.widgets import *\n\nimport autogluon.core as ag\nfrom autogluon.vision import ImagePredictor, ImageDataset\nimport joblib ","a7d05e85":"IMAGE_PATH = \"..\/input\/chinese-mnist\/data\/data\"\nINFO_PATH = \"..\/input\/chinese-mnist\/chinese_mnist.csv\"\nimage_folder_path = \"..\/input\/chinese-mnist\/data\/data\/\"\nSEED = 42","525d60d7":"path = Path(IMAGE_PATH)\nPath.BASE_PATH = path\n\ndf = pd.read_csv(INFO_PATH)\ndf['filename'] = (\"input_\" + df['suite_id'].astype(str) \n               + \"_\" \n               + df['sample_id'].astype(str) \n               + \"_\" \n               + df['code'].astype(str) \n               + \".jpg\")\ndf.head()","929908d1":"df[\"label\"] = df[\"value\"]\ndf[\"image\"] = image_folder_path + df[\"filename\"]\ndf = df[[\"image\",\"label\"]]\ndf.head()","e7ed1d62":"test = df.sample(frac=0.1, replace=True, random_state=2021)\ntest_dataset = test[[\"image\"]]","e7d69ec4":"file_name = \"..\/input\/autogluon-chinese-minist-model\/autogluon_chinese_mnist.pkl\"\nmodel_loaded = joblib.load(file_name) \nmodel_loaded","45163f74":"model_loaded.fit_summary()","6f591729":"bulk_result = model_loaded.predict(test_dataset)\nprint(bulk_result[:5])","80d5f5b9":"test[[\"label\"]][:5]","e5ccb86b":"# predict test data ","189da253":"# answer data ","be1cd9e0":"# make sample","cddd8556":"# load model"}}