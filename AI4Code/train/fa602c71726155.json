{"cell_type":{"160daaa2":"code","c943c5bf":"code","1ae3882c":"markdown"},"source":{"160daaa2":"import pandas as pd\n\n# the spreadsheets is imported but it contains multiple sheets and these sheets have unused rows at the top\ndata_file = '..\/input\/Edexcel-data-set-Issue-1.xls'\n\n# this creates a list (or array) of the worksheet names from the spreadsheet\nspreadsheet = ['Camborne May-Oct 1987',\n              'Camborne May-Oct 2015',\n              'Heathrow May-Oct 1987',\n              'Heathrow May-Oct 2015',\n              'Hurn May-Oct 1987',\n              'Hurn May-Oct 2015',\n              'Leeming May-Oct 1987',\n              'Leeming May-Oct 2015',\n              'Leuchars May-Oct 1987',\n              'Leuchars May-Oct 2015',\n              'Beijing May-Oct 1987',\n              'Beijing May-Oct 2015',\n              'Jacksonville May-Oct 1987',\n              'Jacksonville May-Oct 2015',\n              'Perth May-Oct 1987',\n              'Perth May-Oct 2015']\n\n","c943c5bf":"# this \"for\" loop goes through each named worksheet in the spreadsheet one at a time \nfor sheet in spreadsheet:\n    # importing the data from the worksheet to \"dataset\", the headers are not in the top row so they aren't imported\n    dataset = pd.read_excel (data_file, sheet_name=sheet, header=None) \n    # Removes the first five rows with blurb at the top\n    dataset = dataset.drop([0,1,2,3,4,5], axis=0) \n    \n    # Rename the first three columns\n    dataset.rename(columns={0: 'Date',\n                            1: 'Daily Mean Temperature',\n                            2: 'Daily Total Rainfall',}, inplace=True)\n    \n    # replace 'tr' with '0.025' in rainfall\n    dataset['Daily Total Rainfall'] = dataset['Daily Total Rainfall'].replace({'tr': 0.025})\n    dataset['Daily Total Rainfall'] = dataset['Daily Total Rainfall'].astype('float')\n    \n    # finds the means of the temperature and rain\n    mean_temperature=round(dataset['Daily Mean Temperature'].mean(),1)\n    mean_rain=round(dataset['Daily Total Rainfall'].mean(),1)\n    \n    #print the sheet name and the mean of the temperature and rain\n    print(sheet) \n    print(\"Mean daily temperature = \"+str(mean_temperature)+\"\u00b0C\")\n    print(\"Mean daily total rainfall = \"+str(mean_rain)+\"mm\")\n    #print a blank line\n    print(\"\\n\")\n   \n    ","1ae3882c":"# MEI Introduction to Data Science\n# Lesson 2: Example of automating the cleaning of data from multiple sheets\n\nThis notebook gives an example of how the cleaning of the rainfall field can be automated by looping through all the sheets and using the same code.\n\nYou do not need to understand how this code works but running it should demonstrate to you the efficiency of using code to automate data processes.\n\nIf you do have some experience of coding in Python you could explore making some changes to this code."}}