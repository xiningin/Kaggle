{"cell_type":{"040e4b1d":"code","be20ad56":"code","a614f030":"code","6be4fd3a":"code","50f2dc85":"code","b80c2b4c":"code","7da32917":"code","5cbf57af":"code","e77e0ae9":"code","4405a78f":"code","634229bf":"code","5c9caab9":"markdown","e6fb03c4":"markdown","ed05e456":"markdown","0e9f6e90":"markdown","8abeb657":"markdown"},"source":{"040e4b1d":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","be20ad56":"df= pd.read_csv(\"..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv\")","a614f030":"df.drop([\"CustomerID\"],axis=1,inplace=True)\n","6be4fd3a":"df.head()","50f2dc85":"display(df.describe())","b80c2b4c":"plt.figure(figsize=(20,20))\n\nplt.subplot(2,2,1)\nplt.title(\"Annual Income\")\nplt.violinplot(df[\"Annual Income (k$)\"])\n\nplt.subplot(2,2,2)\nplt.title(\"Annual Income\")\nplt.boxplot(df[\"Annual Income (k$)\"])\n\nplt.subplot(2,2,3)\nplt.title(\"Spending Score\")\nplt.violinplot(df[\"Spending Score (1-100)\"])\n\nplt.subplot(2,2,4)\nplt.title(\"Spending Score\")\nplt.boxplot(df[\"Spending Score (1-100)\"])\n\nplt.show()","7da32917":"genders= df[\"Gender\"].value_counts()\nsns.barplot(x= genders.index,y=genders.values)\nplt.show()","5cbf57af":"correlation= df.corr()\ndisplay(correlation)\nsns.heatmap(correlation)","e77e0ae9":" a = df[\"Annual Income (k$)\"][(df[\"Annual Income (k$)\"] >= 15) & (df[\"Annual Income (k$)\"] <= 39)]\n b = df[\"Annual Income (k$)\"][(df[\"Annual Income (k$)\"] >= 40) & (df[\"Annual Income (k$)\"] <= 64)]\n c = df[\"Annual Income (k$)\"][(df[\"Annual Income (k$)\"] >= 65) & (df[\"Annual Income (k$)\"] <= 89)]\n d = df[\"Annual Income (k$)\"][(df[\"Annual Income (k$)\"] >= 90) & (df[\"Annual Income (k$)\"] <= 114)]\n e = df[\"Annual Income (k$)\"][(df[\"Annual Income (k$)\"] >= 115) & (df[\"Annual Income (k$)\"] <= 140)]\n\n aix = ['15-40','40-64','65-89','90-114','115-140']\n aiy = [len(a.values), len(b.values), len(c.values), len(d.values), len(e.values)]\n\nplt.figure(figsize=(15,6))\nsns.barplot(x=aix, y=aiy, palette=\"Set2\")\nplt.title(\"Annual Incomes\")\nplt.xlabel(\"Income(In Thousands)\")\nplt.ylabel(\"Number of Customer\")\nplt.show()","4405a78f":"from sklearn.cluster import KMeans\nwcss = []\nfor k in range(1,11):\n    kmeans = KMeans(n_clusters=k, init=\"k-means++\")\n    kmeans.fit(df.iloc[:,1:])\n    wcss.append(kmeans.inertia_)\nplt.figure(figsize=(12,6))    \nplt.grid()\nplt.plot(range(1,11),wcss, linewidth=2, color=\"green\", marker =\"8\")\nplt.xlabel(\"K Value\")\nplt.xticks(np.arange(1,11,1))\nplt.ylabel(\"WCSS\")\nplt.show()","634229bf":"km = KMeans(n_clusters=4)\nclusters = km.fit_predict(df.iloc[:,1:])\ndf[\"label\"] = clusters\n\nfrom mpl_toolkits.mplot3d import Axes3D\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\n \nfig = plt.figure(figsize=(20,10))\nax = fig.add_subplot(111, projection='3d')\nax.scatter(df.Age[df.label == 0], df[\"Annual Income (k$)\"][df.label == 0], df[\"Spending Score (1-100)\"][df.label == 0], c='blue', s=60)\nax.scatter(df.Age[df.label == 1], df[\"Annual Income (k$)\"][df.label == 1], df[\"Spending Score (1-100)\"][df.label == 1], c='red', s=60)\nax.scatter(df.Age[df.label == 2], df[\"Annual Income (k$)\"][df.label == 2], df[\"Spending Score (1-100)\"][df.label == 2], c='green', s=60)\nax.scatter(df.Age[df.label == 3], df[\"Annual Income (k$)\"][df.label == 3], df[\"Spending Score (1-100)\"][df.label == 3], c='orange', s=60)\nax.scatter(df.Age[df.label == 4], df[\"Annual Income (k$)\"][df.label == 4], df[\"Spending Score (1-100)\"][df.label == 4], c='purple', s=60)\nax.view_init(30, 185)\nplt.xlabel(\"Age\")\nplt.ylabel(\"Annual Income (k$)\")\nax.set_zlabel('Spending Score (1-100)')\nplt.show()","5c9caab9":"# Elbow Method","e6fb03c4":"#  ****Violin and Box Plots of Annual Income and Score Range**** ","ed05e456":"Nothing Useful.... :(","0e9f6e90":"****Notice the difference between Violin and Box plots.<br>\nViolin plots try to capture all the data and hence cannot be considered as a good estimate for finding outliers.<br>\nIn the following figures:<br>\nSpending Score is evenly distributed and the Median is around 50 whereas,<br>\nin case of Annual Income,its around 60.****","8abeb657":"**Annual Income is stated as :<br>\nMin=15,<br>\nMax=137,<br>\n25%Q= 41.5,<br>\n50%Q= 61.5,<br>\n75%Q= 75**<br>\n\n**From this information, we could have 5 columns starting from <br>\n(15-39),(40-64),(65-90),(90-115),(115-140)**<br>"}}