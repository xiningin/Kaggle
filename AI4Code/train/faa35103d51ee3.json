{"cell_type":{"d264498e":"code","36ae8c2f":"code","4fe1c963":"code","732be8a3":"code","51e9a10b":"code","42452bd4":"code","cfd82add":"code","916be37e":"code","ad80ed49":"code","02e177b5":"code","c1434fc5":"code","3867b8f0":"code","906f674c":"code","8c587299":"code","a42638a2":"code","e7870941":"code","acc34183":"code","b379ccbe":"code","b060a03d":"code","85daad32":"code","94d8b7a2":"code","157b4807":"code","7ddd809b":"code","a266db35":"code","a55968a8":"code","2463dc3e":"code","a516707d":"code","6104d240":"code","9327c23c":"code","0f4c3555":"code","aa9e892f":"code","bc8ed42b":"code","8c1c0ca6":"code","ff7cd435":"code","1343be18":"code","e9a2bd85":"code","16d27458":"code","9d4c79ef":"code","e3ceb248":"code","2c32dadb":"code","f383bccf":"code","bd23213d":"code","fa78e90b":"code","efc54988":"code","0f197ddd":"code","7cba5130":"code","bbe6c219":"code","ff0d9dfb":"code","10497164":"code","b53b2076":"code","b6109ac2":"code","35705cb1":"code","aeff716f":"code","9e642197":"code","ba0d8dd2":"code","7d17735e":"code","5c0a6ee8":"code","757b0475":"code","a7872f25":"code","7e4f5ed3":"code","19e32b06":"code","72ebdfc9":"code","dc946b97":"code","9d3850f5":"code","5a76b55b":"markdown","af11f6c2":"markdown","4cededd9":"markdown","08223db1":"markdown","7229e1f9":"markdown","15be6d1a":"markdown","53b90832":"markdown","6e6e4565":"markdown","667c0a4d":"markdown","608067ad":"markdown","4a53919b":"markdown","620ddcb7":"markdown","4bb11179":"markdown","373cac59":"markdown","271bb8e7":"markdown","969d7d5b":"markdown","528aa25f":"markdown","b581027b":"markdown","53cc2278":"markdown","0ae8c627":"markdown","4ec8ecae":"markdown","63e55e31":"markdown","491d372a":"markdown","51352ea6":"markdown","748ec935":"markdown","7caf017e":"markdown","2ed69cf6":"markdown","3d71644c":"markdown","f4495872":"markdown","1f5bc6d1":"markdown","1a60b72f":"markdown","5ce37ced":"markdown","f0893f41":"markdown","ebf2984f":"markdown"},"source":{"d264498e":"import pandas as pd\nimport plotly.express as px\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom imblearn.over_sampling import SMOTE\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier,GradientBoostingClassifier,AdaBoostClassifier\nfrom xgboost import XGBClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.metrics import classification_report,confusion_matrix,r2_score\nfrom sklearn.naive_bayes import CategoricalNB\nfrom sklearn.svm import LinearSVC\nimport warnings\nwarnings.filterwarnings('ignore')","36ae8c2f":"data=pd.read_csv('..\/input\/health-insurance-cross-sell-prediction\/train.csv')\ndata.head()","4fe1c963":"data.info()","732be8a3":"data.drop(['id'],inplace=True,axis=1)\ndata.describe()","51e9a10b":"data.describe(include='O')","42452bd4":"data.Response.value_counts()","cfd82add":"plt.figure(figsize=(10,8))\nplt.pie(data.Gender.value_counts(),explode=[.1,.2],startangle=90,autopct='%.2f%%',colors=['#00FFFF','#7FE817'],radius=4,labels=['Male','Female'])\nplt.title('Gender',fontdict={'fontsize':22,'fontweight':'bold'})\nplt.axis('equal')\nplt.show()","916be37e":"plt.figure(figsize=(10,8))\nsns.countplot(data.Gender,hue=data.Response,palette='PuRd_r')\nplt.show()","ad80ed49":"data.Gender=pd.Categorical(data.Gender,categories=['Male','Female'],ordered=True).codes\ncorrelation1=data.corr()","02e177b5":"correlation1[['Gender']].sort_values(by='Gender',ascending=False).style.background_gradient(cmap='cool_r')","c1434fc5":"plt.figure(figsize=(10,8))\nplt.pie(data.Vehicle_Age.value_counts(),explode=[.1,.2,.1],startangle=90,autopct='%.2f%%',radius=4,colors=['#3ACCA7','#DD7FEB','#EB8F7F'],labels=['1-2 years','< 1 year','> 2 years'])\nplt.title('Vehical Age',fontdict={'fontsize':22,'fontweight':'bold'})\nplt.axis('equal')\nplt.show()","3867b8f0":"plt.figure(figsize=(10,8))\nsns.countplot(data.Vehicle_Age,hue=data.Response,palette='BuPu_r')\nplt.show()","906f674c":"data.Vehicle_Age=pd.Categorical(data.Vehicle_Age,categories=['1-2 Year','< 1 Year','> 2 Years'],ordered=True).codes\ncorrelation2=data.corr()","8c587299":"correlation2[['Vehicle_Age']].sort_values(['Vehicle_Age'],ascending=False).style.background_gradient(cmap='PiYG')","a42638a2":"data.Vehicle_Damage.value_counts()","e7870941":"plt.figure(figsize=(10,8))\nplt.pie(data.Vehicle_Damage.value_counts(),explode=[.1,.2],startangle=90,autopct='%.2f%%',colors=['#F4F93B','#3BF9F5'],radius=4,labels=['Yes','No'])\nplt.title('Vehicle Damage',fontdict={'fontsize':22,'fontweight':'bold'})\nplt.axis('equal')\nplt.show()","acc34183":"plt.figure(figsize=(10,8))\nsns.countplot(data.Vehicle_Damage,hue=data.Response,palette='PuRd')\nplt.show()","b379ccbe":"data.Vehicle_Damage=pd.Categorical(data.Vehicle_Damage,categories=['Yes','No'],ordered=True).codes\ncorrelation3=data.corr()","b060a03d":"correlation3[['Vehicle_Damage']].sort_values(by='Vehicle_Damage',ascending=False).style.background_gradient(cmap='viridis')","85daad32":"plt.figure(figsize=(10,8))\nsns.distplot(data.Age,color='red',label='Age')\nsns.distplot(data.Age[data.Response==1],color='blue')\nplt.title('Person bought health insurance Vs Age',fontdict={'fontsize':20,'fontweight':'bold'})\nplt.show()","94d8b7a2":"plt.figure(figsize=(10,8))\nsns.distplot(data.Age,color='red',label='Age')\nsns.distplot(data.Age[data.Response==0])\nplt.title('Person doesnot bought health insurance Vs Age',fontdict={'fontsize':20,'fontweight':'bold'})\nplt.show()","157b4807":"max_age=max(data.Age)\nmin_age=min(data.Age)\ndata.Age=data.Age.apply(lambda x: (x-min_age)\/(max_age-min_age))","7ddd809b":"correlation=data.corr()\ncorrelation[['Age']].sort_values(by='Age',ascending=False).style.background_gradient(cmap='Blues_r')","a266db35":"plt.figure(figsize=(10,8))\nsns.distplot(data.Annual_Premium,color='red',label='Annual Premium')\nsns.distplot(data.Annual_Premium[data.Response==1],color='blue')\nplt.title('Person bought health insurance Vs Annual premium',fontdict={'fontsize':20,'fontweight':'bold'})\nplt.show()","a55968a8":"plt.figure(figsize=(10,8))\nsns.distplot(data.Annual_Premium,color='red',label='Annual Premium')\nsns.distplot(data.Annual_Premium[data.Response==0],color='green')\nplt.title('Person doesnot bought health insurance Vs Annual premium',fontdict={'fontsize':20,'fontweight':'bold'})\nplt.show()","2463dc3e":"max_premium=max(data.Annual_Premium)\nmin_premium=min(data.Annual_Premium)\ndata.Annual_Premium=data.Annual_Premium.apply(lambda x: (x-min_premium)\/(max_premium-min_premium))","a516707d":"\ncorrelation[['Annual_Premium']].sort_values(by='Annual_Premium',ascending=False).style.background_gradient(cmap='Blues')","6104d240":"plt.figure(figsize=(12,8))\nsns.heatmap(correlation,cmap='cool_r')\nplt.show()","9327c23c":"oversample=SMOTE()\nX,y=oversample.fit_resample(data.iloc[:,:10],data.iloc[:,10])","0f4c3555":"train_x,test_x,train_y,test_y=train_test_split(X,y,test_size=.1,random_state=42)","aa9e892f":"from sklearn.tree import DecisionTreeClassifier\nmodel1=DecisionTreeClassifier(random_state=42,max_depth=8)\ngrid1=GridSearchCV(model1,param_grid={'max_depth':range(5,8)})\ngrid1.fit(train_x,train_y)","bc8ed42b":"grid1.best_params_","8c1c0ca6":"classifier1=DecisionTreeClassifier(random_state=42,max_depth=7)\nclassifier1.fit(train_x,train_y)","ff7cd435":"pred_test_y=classifier1.predict(test_x)\npred_train_y=classifier1.predict(train_x)\ncm1=confusion_matrix(test_y,pred_test_y)\nplt.figure(figsize=(10,6))\nsns.heatmap(cm1,annot=True,cmap='gnuplot_r')\nplt.title('Confusion metrices of test data',fontdict={'fontsize':18,'fontweight':'bold'})\nplt.show()","1343be18":"print('Classification report of train data \\n',classification_report(train_y,pred_train_y))","e9a2bd85":"print('Classification report of test data \\n',classification_report(test_y,pred_test_y))","16d27458":"classifier2=RandomForestClassifier(random_state=42,max_depth=6)\nclassifier2.fit(train_x,train_y)","9d4c79ef":"pred_test_y=classifier2.predict(test_x)\npred_train_y=classifier2.predict(train_x)\ncm2=confusion_matrix(test_y,pred_test_y)\nplt.figure(figsize=(10,6))\nsns.heatmap(cm2,annot=True,cmap='gnuplot')\nplt.title('Confusion metrices of test data',fontdict={'fontsize':18,'fontweight':'bold'})\nplt.show()","e3ceb248":"print('Classification report of train data \\n',classification_report(train_y,pred_train_y))","2c32dadb":"print('Classification report of train data \\n',classification_report(test_y,pred_test_y))","f383bccf":"classifier3=LogisticRegression(tol=0.01,max_iter=1000)\nclassifier3.fit(train_x,train_y)","bd23213d":"pred_test_y=classifier3.predict(test_x)\npred_train_y=classifier3.predict(train_x)\ncm2=confusion_matrix(test_y,pred_test_y)\nplt.figure(figsize=(10,6))\nsns.heatmap(cm2,annot=True,cmap='gnuplot')\nplt.title('Confusion metrices of test data',fontdict={'fontsize':18,'fontweight':'bold'})\nplt.show()","fa78e90b":"print('Classification report of train data \\n',classification_report(train_y,pred_train_y))","efc54988":"print('Classification report of test data \\n',classification_report(test_y,pred_test_y))","0f197ddd":"classifier4=KNeighborsClassifier(n_neighbors=100)\nclassifier4.fit(train_x,train_y)","7cba5130":"pred_test_y=classifier4.predict(test_x)\npred_train_y=classifier4.predict(train_x)\ncm2=confusion_matrix(test_y,pred_test_y)\nplt.figure(figsize=(10,6))\nsns.heatmap(cm2,annot=True,cmap='RdYlGn')\nplt.title('Confusion metrices of test data',fontdict={'fontsize':18,'fontweight':'bold'})\nplt.show()","bbe6c219":"print('Classification report of train data \\n',classification_report(train_y,pred_train_y))","ff0d9dfb":"print('Classification report of test data \\n',classification_report(test_y,pred_test_y))","10497164":"classifier5=XGBClassifier()\nclassifier5.fit(train_x,train_y)","b53b2076":"pred_test_y=classifier5.predict(test_x)\npred_train_y=classifier5.predict(train_x)\ncm2=confusion_matrix(test_y,pred_test_y)\nplt.figure(figsize=(10,6))\nsns.heatmap(cm2,annot=True,cmap='RdYlGn')\nplt.title('Confusion metrices of test data',fontdict={'fontsize':18,'fontweight':'bold'})\nplt.show()","b6109ac2":"print('Classification report of train data \\n',classification_report(train_y,pred_train_y))","35705cb1":"print('Classification report of test data \\n',classification_report(test_y,pred_test_y))","aeff716f":"classifier6=GradientBoostingClassifier(random_state=42)\nclassifier6.fit(train_x,train_y)","9e642197":"pred_test_y=classifier6.predict(test_x)\npred_train_y=classifier6.predict(train_x)\ncm2=confusion_matrix(test_y,pred_test_y)\nplt.figure(figsize=(10,6))\nsns.heatmap(cm2,annot=True,cmap='RdYlGn')\nplt.title('Confusion metrices of test data',fontdict={'fontsize':18,'fontweight':'bold'})\nplt.show()","ba0d8dd2":"print('Classification report of train data \\n',classification_report(train_y,pred_train_y))","7d17735e":"print('Classification report of test data \\n',classification_report(test_y,pred_test_y))","5c0a6ee8":"classifier7=CategoricalNB()\nclassifier7.fit(train_x,train_y)","757b0475":"pred_test_y=classifier7.predict(test_x)\npred_train_y=classifier7.predict(train_x)\ncm2=confusion_matrix(test_y,pred_test_y)\nplt.figure(figsize=(10,6))\nsns.heatmap(cm2,annot=True,cmap='gist_heat')\nplt.title('Confusion metrices of test data',fontdict={'fontsize':18,'fontweight':'bold'})\nplt.show()","a7872f25":"print('Classification report of train data \\n',classification_report(train_y,pred_train_y))","7e4f5ed3":"print('Classification report of test data \\n',classification_report(test_y,pred_test_y))","19e32b06":"classifier8=LinearSVC()\nclassifier8.fit(train_x,train_y)","72ebdfc9":"pred_test_y=classifier8.predict(test_x)\npred_train_y=classifier8.predict(train_x)\ncm2=confusion_matrix(test_y,pred_test_y)\nplt.figure(figsize=(10,6))\nsns.heatmap(cm2,annot=True,cmap='gist_heat')\nplt.title('Confusion metrices of test data',fontdict={'fontsize':18,'fontweight':'bold'})\nplt.show()","dc946b97":"print('Classification report of train data \\n',classification_report(train_y,pred_train_y))","9d3850f5":"print('Classification report of test data \\n',classification_report(test_y,pred_test_y))","5a76b55b":"<h1 style=\"background-color:blue;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;\">Spliting train-test Data<\/h1>\n<a id=13><\/a>","af11f6c2":"<h1 style=\"background-color:yellow;font-family:newtimeroman;font-size:300%;text-align:center;border-radius: 15px 50px;\">CategoricalNB<\/h1>\n<a id=21><\/a>","4cededd9":"\n<h1 style=\"background-color:lightgreen;font-family:newtimeroman;font-size:200%;text-align:center;border-radius: 15px 50px;\">Scaling Down Age<\/h1>\n<a id=7><\/a>","08223db1":"<h1 style=\"background-color:yellow;font-family:newtimeroman;font-size:300%;text-align:center;border-radius: 15px 50px;\">RandomForestClassifier<\/h1>\n<a id=16><\/a>","7229e1f9":"<h1 style=\"background-color:yellow;font-family:newtimeroman;font-size:300%;text-align:center;border-radius: 15px 50px;\">Gender<\/h1>\n<a id=3><\/a>","15be6d1a":"Age group of 40-50 have higher chance of buying the health insurance","53b90832":"<center><img src=\"https:\/\/cdn.policyx.com\/images\/benefits-12-9-19.jpg\",height='500',width='600'><\/center>\n","6e6e4565":"<h1 style=\"background-color:blue;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;\">Importing modules and Loading datasets<\/h1>\n<a id=1><\/a>","667c0a4d":"<h1 style=\"background-color:blue;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;\">Multivariate Analysis<\/h1>\n<a id=24><\/a>","608067ad":"<h1 style=\"background-color:yellow;font-family:newtimeroman;font-size:300%;text-align:center;border-radius: 15px 50px;\">DecisionTreeClassifier<\/h1>\n<a id=15><\/a>","4a53919b":"<h1 style=\"background-color:yellow;font-family:newtimeroman;font-size:300%;text-align:center;border-radius: 15px 50px;\">Vehical Age<\/h1>\n<a id=4><\/a>","620ddcb7":"<h1 style=\"background-color:blue;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;\">Using SMOTE to solve the problem of imbalanced data<\/h1>\n<a id=12><\/a>","4bb11179":"\n<h1 style=\"background-color:lightgreen;font-family:newtimeroman;font-size:200%;text-align:center;border-radius: 15px 50px;\">Scaling Down Annual premium<\/h1>\n<a id=10><\/a>","373cac59":"<h1 style=\"background-color:yellow;font-family:newtimeroman;font-size:300%;text-align:center;border-radius: 15px 50px;\">Logistic Regression<\/h1>\n<a id=17><\/a>","271bb8e7":"<h1 style=\"background-color:blue;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;\">Univariate Analysis<\/h1>\n<a id=2><\/a>","969d7d5b":"<h1 style=\"background-color:blue;font-family:newtimeroman;font-size:450%;text-align:center;border-radius: 15px 50px;\">Content<\/h1>","528aa25f":"\n<h1 style=\"background-color:yellow;font-family:newtimeroman;font-size:300%;text-align:center;border-radius: 15px 50px;\">XGBoostClassifier<\/h1>\n<a id=19><\/a>","b581027b":"1. [OverView of Data](#0)\n1. [Importing modules and Loading datasets](#1)\n1. [Univariate Analysis](#2)\n   1. [Gender](#3)\n   1. [Vehicle Age](#4)\n   1. [Vehicle Damage](#5)\n   1. [Age](#6)\n       1. [Scaling down Age](#7)\n       1. [correlation](#8)\n   1. [Annual Premium](#9)\n       1. [Scaling down Annual premium](#10)\n       1. [correlation](#11)\n1. [Multivariate Analysis](#24)\n1. [Using SMOTE to solve the problem of imbalanced data](#12)\n1. [Spliting data](#13)\n1. [Model selection and evaluation](#14)\n    1. [DecisionTreeClassifier](#15)\n    1. [ RandomForestRegressor](#16)\n    1. [LogisticRegression](#17)\n    1. [KNN Classifier](#18)\n    1. [XGBClassifier](#19)\n    1. [GradientBoostingClassifier](#20)\n    1. [ CategoricalNB](#21)\n    1. [LinearSVC](#22)\n1. [Conclusion](#23)   ","53cc2278":"\nAn insurance policy is an arrangement by which a company undertakes to provide a guarantee of compensation for specified loss, damage, illness, or death in return for the payment of a specified premium. A premium is a sum of money that the customer needs to pay regularly to an insurance company for this guarantee.\n\nFor example, you may pay a premium of Rs. 5000 each year for a health insurance cover of Rs. 200,000\/- so that if, God forbid, you fall ill and need to be hospitalised in that year, the insurance provider company will bear the cost of hospitalisation etc. for upto Rs. 200,000. Now if you are wondering how can company bear such high hospitalisation cost when it charges a premium of only Rs. 5000\/-, that is where the concept of probabilities comes in picture. For example, like you, there may be 100 customers who would be paying a premium of Rs. 5000 every year, but only a few of them (say 2-3) would get hospitalised that year and not everyone. This way everyone shares the risk of everyone else.\n\nJust like medical insurance, there is vehicle insurance where every year customer needs to pay a premium of certain amount to insurance provider company so that in case of unfortunate accident by the vehicle, the insurance provider company will provide a compensation (called \u2018sum assured\u2019) to the customer.\n\nBuilding a model to predict whether a customer would be interested in Vehicle Insurance is extremely helpful for the company because it can then accordingly plan its communication strategy to reach out to those customers and optimise its business model and revenue.","0ae8c627":"<h1 style=\"background-color:yellow;font-family:newtimeroman;font-size:300%;text-align:center;border-radius: 15px 50px;\">GradientBoosting Classifier<\/h1>\n<a id=20><\/a>","4ec8ecae":"<h1 style=\"background-color:blue;font-family:newtimeroman;font-size:550%;text-align:center;border-radius: 15px 50px;\">Vehicle Insurance<\/h1>\n","63e55e31":"\n<h1 style=\"background-color:lightgreen;font-family:newtimeroman;font-size:200%;text-align:center;border-radius: 15px 50px;\">correlation<\/h1>\n<a id=11><\/a>","491d372a":"Here it is quite evident that vehicle damage is highly correlated with, the feature that is that was previously insured?","51352ea6":"<h1 style=\"background-color:blue;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;\">Conclusion<\/h1>\n<a id=23><\/a>","748ec935":"<h1 style=\"background-color:blue;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;\">OverView of Data<\/h1>\n<a id=0><\/a>","7caf017e":"<font color='red' ><center>\n    If you liked the notebook or in any way it help you. Please upvote it!!<br>\n    And if have any query or suggestion ask in comment section.<br>\n    <\/center>\n    <\/font>","2ed69cf6":"\n<h1 style=\"background-color:lightgreen;font-family:newtimeroman;font-size:200%;text-align:center;border-radius: 15px 50px;\">correlation<\/h1>\n<a id=8><\/a>","3d71644c":"\n<h1 style=\"background-color:yellow;font-family:newtimeroman;font-size:300%;text-align:center;border-radius: 15px 50px;\">Annual premium<\/h1>\n<a id=9><\/a>","f4495872":"<font size='5' color='#1f45fc'>\n    From the above analysis it is quite evidient that XGBoostClassifier works better than other algoriths. With test accuracy of about 91%.\n    <\/font>","1f5bc6d1":"\n<h1 style=\"background-color:yellow;font-family:newtimeroman;font-size:300%;text-align:center;border-radius: 15px 50px;\">Age<\/h1>\n<a id=6><\/a>","1a60b72f":"<h1 style=\"background-color:yellow;font-family:newtimeroman;font-size:300%;text-align:center;border-radius: 15px 50px;\">LinearSVC<\/h1>\n<a id=22><\/a>","5ce37ced":"<h1 style=\"background-color:yellow;font-family:newtimeroman;font-size:300%;text-align:center;border-radius: 15px 50px;\">KNN Classifier<\/h1>\n<a id=18><\/a>","f0893f41":"<h1 style=\"background-color:blue;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 50px;\">Model training And Evaluation<\/h1>\n<a id=14><\/a>","ebf2984f":"<h1 style=\"background-color:yellow;font-family:newtimeroman;font-size:300%;text-align:center;border-radius: 15px 50px;\">Vehicle Damage<\/h1>\n<a id=5><\/a>"}}