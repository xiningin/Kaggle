{"cell_type":{"36620b22":"code","5bc9a0af":"code","e6ce9b57":"code","d02633df":"code","0975e133":"code","03f15f8f":"code","b2f8515f":"code","437e30d2":"code","e683d331":"code","0fa2d3d1":"code","6a470f9d":"code","2c72dd94":"markdown","fc61e019":"markdown","634dbeef":"markdown","26c59870":"markdown"},"source":{"36620b22":"! pip install fastai2","5bc9a0af":"from fastai2.basics import *\nfrom fastai2.vision.all import *\nfrom fastai2.callback.all import *","e6ce9b57":"path = '\/kaggle\/input\/face-mask-12k-images-dataset\/Face Mask Dataset\/'\nTRAIN_DIR  = path + 'Train\/'\nVAL_DIR  = path + 'Validation\/'\nTEST_DIR  = path + 'Test'","d02633df":"item_tfms = Resize(256)\nbatch_tfms = [RandomResizedCrop(224), *aug_transforms(mult=1.0, do_flip=True, max_rotate=30.0, max_zoom=1.5,\n                            max_lighting=.8, max_warp=0.3, p_lighting=.9)]\nbs=128\ndata = ImageDataLoaders.from_folder(path, train='Train', valid='Validation',batch_tfms=batch_tfms, \n                                   item_tfms=item_tfms, bs=bs)","0975e133":"data.vocab","03f15f8f":"data.show_batch()","b2f8515f":"%%time\nlearn = cnn_learner(data, resnet34, metrics=accuracy)\nlearn.fine_tune(1, cbs=[EarlyStoppingCallback(monitor='accuracy')])","437e30d2":"\n\ninterep = ClassificationInterpretation.from_learner(learn)\nlosses, idxs = interep.top_losses()\n\nlen(data.valid_ds)==len(losses)==len(idxs)\n\ninterep.plot_top_losses(9, figsize=(15,10))","e683d331":"interep.plot_confusion_matrix( dpi=60)","0fa2d3d1":"from IPython.display import Image, display\n\ndisplay(Image('..\/input\/meramask\/photo_2020-05-07_19-51-41.jpg'))","6a470f9d":"img = plt.imread('..\/input\/meramask\/photo_2020-05-07_19-51-41.jpg')\nprint(learn.predict(img)[0])","2c72dd94":"## Predicting if my image has a mask\/not","fc61e019":"## modelling","634dbeef":"> Our model classifies with accuracy of more than 99%","26c59870":"## Fastai 2 model"}}