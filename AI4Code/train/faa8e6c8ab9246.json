{"cell_type":{"be0a9bf4":"code","f3ea14bd":"code","682658d3":"code","19287a2e":"code","cab09dc6":"code","0423b65f":"code","a27ec626":"code","f8de83cd":"code","c140debc":"code","621a1034":"code","1a53f309":"code","7d28cec8":"code","343b7dc3":"code","ffa5c0e3":"code","cd549c2c":"code","61b196d4":"code","a838fcc0":"code","0c356ae2":"code","4952a217":"code","b5851539":"code","c8c19fe8":"code","e1095b88":"code","232fb03f":"code","82269bad":"code","9ebec918":"code","6f1d811a":"code","4a1ecc5e":"code","4df33f6f":"code","0ee0bae2":"code","71b4dba5":"code","8ce8f7b7":"code","e08a37d0":"code","f1de88ea":"code","6ac9be94":"code","6139a4a4":"code","7f0e5523":"code","8b895a43":"code","04aec697":"code","0f957dbc":"code","5976ea21":"code","7e5d088c":"code","121a46ec":"code","db12f4e1":"code","54fa0d1b":"code","db0f6493":"code","3aac5871":"code","118346d8":"code","9acb87dc":"code","cbfd375f":"code","09311287":"code","d6811512":"code","078af35d":"code","0bc19c89":"code","f953173c":"code","fd4f3281":"code","e830c038":"code","d8f5ac23":"code","90dbb7dd":"markdown","ec4acd25":"markdown","7f4a2b2f":"markdown","4759b1e9":"markdown","e44eab20":"markdown","34a14708":"markdown","ee3c58c3":"markdown","37147256":"markdown","61d43e79":"markdown","2cba526f":"markdown","028fd766":"markdown","7caf3f2f":"markdown","c5b9431b":"markdown","40c8b7f2":"markdown","20b8c288":"markdown","a0780ee6":"markdown","1cee64e3":"markdown","87cefa87":"markdown","a234d4ac":"markdown","6cf87d86":"markdown","56a8be96":"markdown","2298f290":"markdown","92c821e9":"markdown","ae693b44":"markdown"},"source":{"be0a9bf4":"import numpy as np \nimport pandas as pd\nimport matplotlib.pyplot as plt # data visualization\nimport seaborn as sns # data visualization\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\nplt.style.use('ggplot')","f3ea14bd":"train_df = pd.read_csv('..\/input\/titanic-machine-learning-from-disaster\/train.csv')\ntest_df = pd.read_csv('..\/input\/titanic-machine-learning-from-disaster\/test.csv')","682658d3":"train = train_df.copy()\ntest= test_df.copy()","19287a2e":"print(train.info())","cab09dc6":"\nprint(test.info())\n","0423b65f":"print(train.describe())","a27ec626":"\nprint(test.describe())\n","f8de83cd":"print(train.isnull().sum())\n","c140debc":"print(test.isnull().sum())","621a1034":"print(train.columns)\n","1a53f309":"print(test.columns)","7d28cec8":"train.drop(columns=['PassengerId', 'Name', 'Ticket', 'Cabin'], axis=1, inplace=True)\ntest.drop(columns= ['PassengerId', 'Name', 'Ticket', 'Cabin'], axis=1, inplace= True)\n","343b7dc3":"train['Age'].median()\n","ffa5c0e3":"train['Embarked'].mode()[0]","cd549c2c":"train['Age'].fillna(train['Age'].median(), inplace=True)\ntrain['Embarked'].fillna(train['Embarked'].mode()[0], inplace=True)\n","61b196d4":"print(train.isnull().sum())\n","a838fcc0":"test['Age'].median()\n","0c356ae2":"test['Fare'].median()","4952a217":"test['Age'].fillna(test['Age'].median(), inplace=True)\ntest['Fare'].fillna(test['Fare'].median(), inplace=True)","b5851539":"print(test.isnull().sum())\n","c8c19fe8":"train['Survived'].value_counts()\n","e1095b88":"train['Pclass'].value_counts()\n","232fb03f":"train['Sex'].value_counts()\n","82269bad":"train['SibSp'].value_counts()\n","9ebec918":"train['Parch'].value_counts()\n","6f1d811a":"train['Embarked'].value_counts()","4a1ecc5e":"test['Pclass'].value_counts()\n","4df33f6f":"test['Sex'].value_counts()\n\n","0ee0bae2":"test['SibSp'].value_counts()\n","71b4dba5":"test['Parch'].value_counts()\n","8ce8f7b7":"test['Embarked'].value_counts()","e08a37d0":"plt.figure(figsize=(8,6))\nsns.countplot(x='Survived', data= train)","f1de88ea":"plt.figure(figsize=(8,6))\nsns.countplot(x='Sex', data= train)","6ac9be94":"plt.figure(figsize=(8,6))\nsns.countplot(x='Survived', hue='Sex', data= train)","6139a4a4":"plt.figure(figsize=(8,6))\nsns.countplot(x='Survived', hue='Pclass', data= train)","7f0e5523":"plt.figure(figsize=(8,6))\nsns.boxplot(x='Survived', y= 'Age', hue='Sex', data= train)","8b895a43":"plt.figure(figsize=(8,6))\nsns.boxplot(x='Pclass', y= 'Fare', data= train)","04aec697":"plt.figure(figsize=(8,6))\nsns.countplot(x='Sex', data= test)","0f957dbc":"plt.figure(figsize=(8,6))\nsns.boxplot(x='Pclass', y= 'Fare', data= test)","5976ea21":"\ntrain.plot(kind='box', figsize= (10,8))\n","7e5d088c":"cols= ['Age', 'SibSp', 'Parch', 'Fare']\n\ntrain[cols]= train[cols].clip(lower= train[cols].quantile(0.15), upper= train[cols].quantile(0.85), axis=1)\n\ntrain.drop(columns=['Parch'], axis=1, inplace=True)","121a46ec":"train.plot(kind='box', figsize= (10,8)) \n","db12f4e1":"test.plot(kind='box', figsize= (10,8))\n","54fa0d1b":"test[cols]= test[cols].clip(lower= test[cols].quantile(0.15), upper= test[cols].quantile(0.85), axis=1)\n\ntest.drop(columns=['Parch'], axis=1, inplace=True)","db0f6493":"test.plot(kind='box', figsize= (10,8))  \n","3aac5871":"\ntrain= pd.get_dummies(train, columns=['Pclass', 'Sex', 'Embarked' ], drop_first= True)\n\ntest= pd.get_dummies(test, columns=['Pclass', 'Sex', 'Embarked' ], drop_first= True)","118346d8":"train.head()","9acb87dc":"test.head()","cbfd375f":"X_train= train.iloc[:, 1:]\ny_train= train['Survived'].values.reshape(-1,1)\n\nX_test= test","09311287":"from sklearn.preprocessing import StandardScaler\nss= StandardScaler()","d6811512":"features= ['Age', 'SibSp', 'Fare']\n\nX_train[features]= ss.fit_transform(X_train[features])\nX_test[features]= ss.fit_transform(X_test[features])","078af35d":"X_train.head()","0bc19c89":"X_test.head()","f953173c":"from sklearn.linear_model import LogisticRegression\n\nclf= LogisticRegression()\n\nclf.fit(X_train, y_train.ravel())\n\npredictions= clf.predict(X_test)","fd4f3281":"print(clf.score(X_train, y_train))\n","e830c038":"submission= pd.DataFrame({'PassengerId' : test_df['PassengerId'], 'Survived': predictions })\n\nprint(submission.head())","d8f5ac23":"filename= 'titanic predictions.csv'\nsubmission.to_csv(filename, index=False)","90dbb7dd":"There are no null values in train dataset\n","ec4acd25":"There are null values in train dataset and test dataset.\n","7f4a2b2f":"Now import train data and test data.","4759b1e9":"males are more compared to females","e44eab20":"Fill the null values with mean, median or mode according to the requirements.","34a14708":"There are no outliers in the train dataset","ee3c58c3":"From the above figure, we can observe that survived people are less compared to not-survived people.","37147256":"There are no outliers in the test dataset","61d43e79":"Lets remove the variables which are not significant in this data.","2cba526f":"describe() function gives statistical details of the dataset.","028fd766":"One Hot Encoding is used to convert categorical data into numerical data.\n","7caf3f2f":"Lets make copies of train_df and test_df.","c5b9431b":"There are outliers in Age, SibSp, Parch and Fare variables. clip() funtion is used to remove the outliers. Parch variable is removed because more than 75% of the values are 0.","40c8b7f2":"Now, lets split the data.","20b8c288":" **If you enjoy this notebook, please share and give an upvote. Any suggestions or comments are appreciated. Happy Learning :)**","a0780ee6":"Lets do Data Visualization for train dataset and test dataset","1cee64e3":"To know the information of the dataset, we use info() function. It gives information about variables, number of non-null count, datatype of each columns and memory usage.","87cefa87":"There are outliers in Age, SibSp, Parch and Fare variables. I am using clip() funtion to remove the outliers. Parch variable is removed because more than 75% of the values are 0.","a234d4ac":"Lets check the null values in the dataset.","6cf87d86":"Feature Scaling is used to standardize the independent variables present in the data in a fixed range.","56a8be96":"Check outliers in the data","2298f290":" There are no null values in test dataset","92c821e9":"Fare is high in Pclass 1 compared to Pclass 2 and Pclass 3","ae693b44":"value_counts() gives count of unique values."}}