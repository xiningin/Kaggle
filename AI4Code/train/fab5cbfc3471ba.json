{"cell_type":{"550334cb":"code","d24c3365":"code","ad1a026a":"code","9a959c0b":"code","74fdbfc9":"code","d776a892":"code","2fc21c5d":"code","b2b3f9b4":"code","e7d97698":"code","bf7c432f":"code","96a670b7":"code","1dd06dc5":"code","b282faab":"code","3fd9f5c1":"code","cfde0fdd":"code","a44555eb":"code","7211ffda":"code","132c8a4f":"code","478988d4":"code","3534efe2":"code","359d414d":"code","008c0cda":"code","74e179f9":"code","d18f95a9":"code","e3a6a00d":"code","4fcc0d9e":"code","70b92958":"markdown","318d2594":"markdown","4a821e5c":"markdown","7886ad62":"markdown","19e0568c":"markdown","9818df98":"markdown","80a4a5fe":"markdown","894f842a":"markdown","68f3964c":"markdown","ad5b4838":"markdown","6d48d366":"markdown","df57c7e5":"markdown","ff47aced":"markdown","0ebea42e":"markdown","e080e9c7":"markdown","9b94f0cd":"markdown","a957292f":"markdown","840ad229":"markdown","ae108d32":"markdown","501bf648":"markdown","e10cc0be":"markdown","e339e7c2":"markdown","ff77149a":"markdown","f7e6854f":"markdown"},"source":{"550334cb":"!pip install upsetplot","d24c3365":"import numpy as np\nimport pandas as pd\npd.set_option('expand_frame_repr', False)\npd.set_option('max_colwidth', 140)\npd.options.mode.chained_assignment = None\nimport matplotlib.pyplot as plt\nimport upsetplot\nfrom plotnine import *\nfrom geopy.geocoders import Nominatim\ngeolocator = Nominatim(user_agent=\"specify_your_app_name_here\")\nfrom geopy.extra.rate_limiter import RateLimiter\ngeocode = RateLimiter(geolocator.geocode, min_delay_seconds=2)\nimport scipy as sp\n\n# ignore MatplotLibDeprecation warning: Passing one of 'on', 'true', 'off', 'false' as a boolean is deprecated.\nimport warnings\nimport matplotlib.cbook\nwarnings.filterwarnings(\"ignore\", category = matplotlib.cbook.mplDeprecation)","ad1a026a":"olympic_data = pd.read_csv(\"..\/input\/athlete_events.csv\")\nprint(olympic_data.shape)\nprint(olympic_data.describe())\nolympic_data.head()","9a959c0b":"event_and_year = olympic_data[['Year', 'Season']].drop_duplicates().sort_values('Year')\n(ggplot(event_and_year, aes(x = 'Year', y = 'Season', colour = 'Season')) +\n    geom_line() +\n    geom_point() +\n    scale_x_continuous(breaks = range(event_and_year['Year'].min(), event_and_year['Year'].max()+1, 4)) +\n    labs(title = \"Timeline of Summer and Winter Olympic Games\") +\n    theme(plot_title = element_text(size = 10, face = \"bold\"),\n          axis_text_x = element_text(angle = 45),\n          axis_text = element_text(size = 7),\n          legend_position = \"none\"))","74fdbfc9":"# Keep distinct pairs of athlete IDs and Season they participated in\nathlete_and_season = olympic_data[['ID', 'Season']].drop_duplicates()\n# Convert data frame to wide format\nathlete_and_season['Participated'] = True\nathlete_and_season_wide = athlete_and_season.pivot(index='ID', columns='Season', values='Participated').fillna(False)\n# Construct the series for UpSet plotting\ncolumns = list(athlete_and_season_wide.columns)\nathlete_and_season_upset = athlete_and_season_wide.groupby(columns).size()\n\n# UpSet plot\nupsetplot.plot(athlete_and_season_upset, sort_by = \"cardinality\") \nplt.suptitle('Athlete participation in seasonal events')\nplt.show() \n\n# Get the summary data behind the UpSet plot\nathlete_and_season_summary = athlete_and_season_wide.groupby(columns).size().reset_index(name='Num athletes').sort_values('Num athletes',  ascending=False)\nnum_athletes = athlete_and_season.ID.nunique()\nathlete_and_season_summary['All athletes'] = num_athletes\nathlete_and_season_summary['% of all athletes'] = athlete_and_season_summary['Num athletes'] * 100 \/ athlete_and_season_summary['All athletes']\nprint(athlete_and_season_summary.to_string(index=False))","d776a892":"# Get the raw data on athletes who participated in both seasons only\nathlete_and_season_wide = athlete_and_season_wide.reset_index()\ndouble_season_athletes = athlete_and_season_wide[(athlete_and_season_wide['Summer']==True) & (athlete_and_season_wide['Winter']==True)][['ID']]\ndouble_season_data = pd.merge(double_season_athletes, olympic_data, on = 'ID')\n# Keep distinct pairs of athlete IDs and the sports they competed in\ndouble_season_sport = double_season_data[['ID', 'Sport']].drop_duplicates()\n# Convert data frame to wide format\ndouble_season_sport['Participated'] = True\ndouble_season_sport_wide = double_season_sport.pivot(index='ID', columns='Sport', values='Participated').fillna(False)\n# Construct the series for UpSet plotting\ncolumns = list(double_season_sport_wide.columns)\ndouble_season_sport_upset = double_season_sport_wide.groupby(columns).size()\n\n# UpSet plot\nupsetplot.plot(double_season_sport_upset, sort_by = \"cardinality\", show_counts='%d') \nplt.suptitle('Sports of multi-season athletes')\nplt.show() ","2fc21c5d":"sports_both_seasons = olympic_data.groupby('Sport').filter(lambda x: x['Season'].nunique() == 2)\nsports_both_seasons['Sport'].unique()","b2b3f9b4":"# Get a data set where a medal was won\nmedal_data = olympic_data[olympic_data.Medal.notnull()]\n# Get a list of athlete IDs who won medals in multiple sports\nmulti_medal_data = medal_data.groupby('ID').filter(lambda x: x['Sport'].nunique() > 1)\nmulti_medal_athletes = multi_medal_data['ID'].unique()\nmulti_medal_athletes_df = pd.DataFrame({'ID':multi_medal_athletes})\n# Get raw data only on athletes who won medals in multiple sports\nmulti_medal_sports_data = pd.merge(medal_data, multi_medal_athletes_df, on = 'ID')\nprint(str(multi_medal_sports_data.ID.nunique()) + ' athletes won medals in multiple sports.')\n# Keep distinct pairs of athlete IDs and the sports they won medals in\nmulti_medal_sports = multi_medal_sports_data[['ID', 'Sport']].drop_duplicates()\n# Convert data frame to wide format\nmulti_medal_sports['Won'] = True\nmulti_medal_sports_wide = multi_medal_sports.pivot(index='ID', columns='Sport', values='Won').fillna(False)\n# Construct the series for UpSet plotting\ncolumns = list(multi_medal_sports_wide.columns)\nmulti_medal_sports_upset = multi_medal_sports_wide.groupby(columns).size()\n\n# UpSet plot\nupsetplot.plot(multi_medal_sports_upset, sort_by = \"cardinality\", show_counts='%d')\nplt.suptitle('Sports of multi-sport medallists')\nplt.show() ","e7d97698":"# Function that returns the data on athletes who won specific combinations of sports\ndef get_multi_medal_athlete_data(sports):\n  sports_data = medal_data[medal_data.Sport.isin(sports)]\n  sports_data_athletes = sports_data.groupby('ID').filter(lambda x: x['Sport'].nunique() == 2)\n  sports_data_athlete = sports_data_athletes['ID'].unique()\n  return(medal_data[medal_data.ID.isin(sports_data_athlete)])","bf7c432f":"get_multi_medal_athlete_data(['Shooting', 'Gymnastics'])","96a670b7":"get_multi_medal_athlete_data(['Bobsleigh', 'Boxing'])","1dd06dc5":"get_multi_medal_athlete_data(['Handball', 'Swimming'])","b282faab":"# Fix known bugs in the noc_regions dataset\nregions = pd.read_csv(\"..\/input\/noc_regions.csv\")\nregions.loc[regions['NOC'] == 'BOL', 'region'] = 'Bolivia'\nregions.loc[regions['region'] == 'Singapore', 'NOC'] = 'SGP'\n# Add the region name into the athlete_events dataset\nolympic_data_with_region = pd.merge(olympic_data, regions, on = 'NOC')\nprint(olympic_data_with_region.shape)\n# Are there any NOCs that do not have a corresponding region?\nprint(olympic_data_with_region.isnull().sum())\n# There are 21 events that do not have a region - let's see which NOCs those are.\nprint(olympic_data_with_region[olympic_data_with_region.region.isnull()]['NOC'].unique())\n# 3 NOCs don't have a corresponding region.\n# ROT = Refugee Olympic Team\n# UNK = Unknown\n# TUV = Tuvalu\n# All these 3 \"regions\" are mentioned in the \"notes\" columns. So we can coalesce the \"region\" and \"notes\" columns.\nolympic_data_with_region['region'] = olympic_data_with_region.region.combine_first(olympic_data_with_region.notes)","3fd9f5c1":"# For every Olympic Games edition, get the number of athletes brought by each country\nnum_athletes = olympic_data_with_region.groupby(['Games', 'region'])['ID'].nunique().reset_index(name='num_athletes')\nprint(num_athletes.shape)\n\n# For every Olympic Games edition, get the number of medals won by each country\n# Create a unique_medal field which is a concatenation of the year+season+event+medal\nmedal_data_with_region = olympic_data_with_region[olympic_data_with_region.Medal.notnull()]\nmedal_data_with_region['unique_medal'] = medal_data_with_region.Games.astype(str) + medal_data_with_region.Event.astype(str) + medal_data_with_region.Medal.astype(str)\nnum_medals = medal_data_with_region.groupby(['Games', 'region'])['unique_medal'].nunique().reset_index(name='num_medals')\nprint(num_medals.shape)\n\n# Merge into a single data frame\n# If a country didn't win any medals, list 0.\nevent_summary = pd.merge(num_athletes, num_medals, on = ['Games', 'region'], how = 'left').fillna(0)\n\n# Let's visualise the relationship between number of participating athletes and number of medals won\n(ggplot(event_summary, aes(x = 'num_athletes', y = 'num_medals')) +\n    geom_point() +\n    geom_smooth(method='lm')+\n    labs(x = \"Number of participating athletes\", y = \"Number of medals won\",\n         title = \"Relationship between number of athletes a country brings to a game and number of medals won\"))","cfde0fdd":"sp.stats.levene(event_summary['num_athletes'], event_summary['num_medals'])","a44555eb":"# What do the distributions of the 2 variables look like?\nplt.subplot(1, 2, 1)\nplt.hist(event_summary['num_athletes'], bins=30)\nplt.xlabel('num_athletes')\nplt.subplot(1, 2, 2)\nplt.hist(event_summary['num_medals'], bins=30)\nplt.xlabel('num_medals')\nplt.tight_layout()\nplt.show()","7211ffda":"# Spearman's rank-order correlation\ncoef, p = sp.stats.spearmanr(event_summary['num_athletes'], event_summary['num_medals'])\nprint('Spearmans correlation coefficient: %.3f' % coef)\n# interpret the significance\nalpha = 0.05\nif p > alpha:\n    print('Number of athletes and medals are uncorrelated (fail to reject H0) p=%.3f' % p)\nelse:\n    print('Number of athletes and medals are correlated (reject H0) p=%.3f' % p)","132c8a4f":"# Get a list of cities that hosted the Olympic Games and the countries they are in.\ncities_df = pd.DataFrame({'City': olympic_data['City'].unique()})\ncities_df['location'] = cities_df['City'].apply(geocode, language='en')\ncities_df['point'] = cities_df['location'].apply(lambda loc: tuple(loc.point) if loc else None)\ncities_df['Country'] = cities_df['point'].apply(lambda point: geolocator.reverse(point, language = 'en').raw['address']['country'])\nhost_loc = cities_df[['City', 'Country']]\nhost_loc.head()","478988d4":"# Get the NOC of the host country (to make sure the country names are spelled the same as the \"region\")\nhost_loc_with_noc = pd.merge(host_loc, regions, left_on = 'Country', right_on = 'region', how = 'left')\nprint(host_loc_with_noc[host_loc_with_noc.region.isnull()])\n# Turns out that United Kingdom, PRC, and B&H are spelled differently in the noc_regions dataset. We must correct these to continue with the analysis.\n# United Kingdom is spelled UK\n# PRC is spelled China\n# B&H is spelled Bosnia and Herzegovina\nhost_loc.loc[host_loc['Country'] == 'United Kingdom', 'Country'] = 'UK'\nhost_loc.loc[host_loc['Country'] == 'PRC', 'Country'] = 'China'\nhost_loc.loc[host_loc['Country'] == 'B&H', 'Country'] = 'Bosnia and Herzegovina'\n# Re-run merge after data was fixed\nhost_loc_with_noc = pd.merge(host_loc, regions, left_on = 'Country', right_on = 'region', how = 'left')\nprint(host_loc_with_noc[host_loc_with_noc.region.isnull()])","3534efe2":"olympic_data_with_host = pd.merge(olympic_data_with_region, host_loc, on = 'City')\nprint(olympic_data_with_host.shape)\nolympic_data_with_host.head()","359d414d":"olympic_data_with_host['unique_medal'] = olympic_data_with_host.Games.astype(str) + olympic_data_with_host.Event.astype(str) + olympic_data_with_host.Medal.astype(str)\n\n\n# For every country, find out the year when they hosted\nhost_year = olympic_data_with_host[['Country', 'Year', 'Season']].drop_duplicates().sort_values(['Season', 'Year'])\n\n# For every host country, find out how many medals they won per athlete when they hosted\nhost_medals = olympic_data_with_host[(olympic_data_with_host.region == olympic_data_with_host.Country) & olympic_data_with_host.Medal.notnull()].groupby(['region', 'Year', 'Season'])['unique_medal'].nunique().reset_index(name='num_medals')\nhost_athletes = olympic_data_with_host[(olympic_data_with_host.region == olympic_data_with_host.Country)].groupby(['region', 'Year', 'Season'])['ID'].nunique().reset_index(name='num_athletes')\nhost_summary = pd.merge(host_athletes, host_medals, on = ['region', 'Year', 'Season'])\nhost_summary['mpa'] = host_summary['num_medals'] \/ host_summary['num_athletes']\nhost_summary = host_summary[['region', 'Year', 'Season', 'mpa']]\nhost_summary.columns = ['Country', 'Year', 'Season', 'host_mpa']\n\n# Merge the two datasets\nhost_data = pd.merge(host_year, host_summary, on = (['Country', 'Year', 'Season']))\nprint(host_data.head())\n\n# For every host country, find out how many medals they won per athlete when they did not host\nnon_host_medals = olympic_data_with_host[(olympic_data_with_host.region != olympic_data_with_host.Country) & olympic_data_with_host.Medal.notnull()].groupby(['region', 'Year', 'Season'])['unique_medal'].nunique().reset_index(name='num_medals')\nnon_host_athletes = olympic_data_with_host[(olympic_data_with_host.region != olympic_data_with_host.Country)].groupby(['region', 'Year', 'Season'])['ID'].nunique().reset_index(name='num_athletes')\nnon_host_summary = pd.merge(non_host_athletes, non_host_medals, on = ['region', 'Year', 'Season'])\nnon_host_summary['mpa'] = non_host_summary['num_medals'] \/ non_host_summary['num_athletes']\nnon_host_summary = non_host_summary[['region', 'Year', 'Season', 'mpa']]\nnon_host_summary.columns = ['Country', 'Year', 'Season', 'nonhost_mpa']\n# Only keep data for countries that were hosts at some point\nhost_countries = host_summary['Country'].drop_duplicates()\nhost_countries_df = pd.DataFrame({'Country':host_countries})\nnon_host_summary = non_host_summary[non_host_summary.Country.isin(host_countries_df['Country'])]\nnon_host_summary.head()","008c0cda":"# ECDF for a single country - Finland\nfin = non_host_summary[non_host_summary.Country == 'Finland']\nx = np.sort(fin['nonhost_mpa'])\ny = np.arange(1, len(x)+1) \/ len(x)\nplt.plot(x, y, marker = '.', linestyle = 'none')\nplt.xlabel('Number of medals per athlete')\nplt.ylabel('% of olympic games')\nplt.margins(0.02) # keep data off plot edges\nplt.show()","74e179f9":"# For every country, sort the number of medals ascending\nnon_host_medals_raw_sorted = non_host_summary[['Country', 'nonhost_mpa']].sort_values(['Country', 'nonhost_mpa'])\n# For every country, get the number of entries (i.e. number of olympic games in which they participated and won)\nlenx = non_host_medals_raw_sorted.groupby('Country').size().reset_index(name = \"lenx\")\n# For every country, compute the ECDF\necdf_for_all = pd.merge(non_host_medals_raw_sorted, lenx, on = 'Country')\necdf_for_all['row_number'] = ecdf_for_all.groupby(['Country', 'lenx']).cumcount()+1\necdf_for_all['ecdf'] = ecdf_for_all['row_number'] \/ ecdf_for_all['lenx']\n\n(ggplot(ecdf_for_all, aes(x = 'nonhost_mpa', y = 'ecdf', colour = 'Country')) +\n    geom_point(stat = 'identity') +\n    labs(title = 'ECDF plot of number of medals per athlete won by countries in years when they did not host',\n         x = 'Number of medals per athlete',\n         y = '% of olympic games') +\n    scale_colour_discrete(name = 'Country'))","d18f95a9":"# Function to get the 90th percentile \n# If the country's ecdf doesn't contain 0.9 we use interpolation to get the mpa value at 0.9 ecdf\ndef my_interp(x, a=0.9):\n    X = np.sort(x)\n    e_cdf = np.arange(1, len(X)+1) \/ len(X)\n    if a in e_cdf:\n        s = pd.Series(X, index=e_cdf)\n        res = s[a]\n    else:\n        X = np.append(X, np.nan)\n        e_cdf = np.append(e_cdf, a)\n        s = pd.Series(X, index=e_cdf)\n        inter = s.interpolate(method='index')\n        res = inter[a]\n    return(res)\n\ndf = pd.DataFrame(columns = ['Country', 'mpa_percentile90'])\nfor country in host_countries:\n    c = ecdf_for_all[ecdf_for_all.Country == country]\n    d = {'Country': [country], 'mpa_percentile90': [my_interp(c['nonhost_mpa'])]}\n    res = pd.DataFrame(data=d)\n    df = df.append(res)\n\n# Final\nfinal = pd.merge(host_summary, df, on = 'Country')\nfinal['change'] = final['host_mpa'] - final['mpa_percentile90']\nfinal.sort_values('change', ascending=False)","e3a6a00d":"# For every country, get a list of the sports in which they won medals, and the number of medals won\nmedal_data_with_region = olympic_data_with_region[olympic_data_with_region.Medal.notnull()]\n# Create a unique_medal field which is a concatenation of the year+season+event+medal\nmedal_data_with_region['unique_medal'] = medal_data_with_region.Games.astype(str) + medal_data_with_region.Event.astype(str) + medal_data_with_region.Medal.astype(str)\nmedal_data_with_region.head()\ncountry_medals = medal_data_with_region.groupby(['region', 'Sport'])['unique_medal'].nunique().reset_index(name='Number of medals').sort_values(['region', 'Number of medals'], ascending=[True, False])\n# For every country, get the sport at which they won the most medals\ncountry_top_sport = country_medals.groupby('region').first().reset_index()\ncountry_top_sport.head()","4fcc0d9e":"# Get the number and list of countries that won most medals in each sport\nsport_top_countries = country_top_sport.groupby('Sport').size().reset_index(name = 'Num countries').sort_values('Num countries')\nlist_of_countries_per_sport = country_top_sport.groupby('Sport')['region'].apply(np.unique).to_frame()\nsport_top_countries_with_list = pd.merge(sport_top_countries, list_of_countries_per_sport, on = 'Sport')\nsport_top_countries_with_list.columns = ['Sport', 'Num countries best at it', 'Countries who won most medals in this sport']\nsport_top_countries_with_list","70b92958":"For our analysis, we would like to have the same country spelling between the country of the host and the country of the athlete. The output above shows that the spellings were different for 3 countries, and so we went and fixed that by changing the names in the new host country dataset we created to match the names in the noc_regions dataset.  \n\nNow that we made sure that the host country names match the noc_regions dataset, we can append the country name in our original athlete dataset.","318d2594":"From Finland's ecdf we can tell that, for example:\n* in 50% of the olympic games they participated in, they won up to 0.13 medals per athlete\n* in 90% of the olympic games they participated in, they won up to 0.40 medals per athlete (in other words, 9 times out of 10, Finland won up to 0.4 medals per athlete).\n\nWe can try to visualise the ecdf plots for every host country. There are 22 host countries in total, so the plot will be busy, but it's just meant to give us an idea of how countries compare to each other.","4a821e5c":"A positive value in the \"change\"column above indicates that the performance in the host year was better than the cutoff performance for each country in their non-host years.\n\n**Conclusions**\n1. Out of 51 Olympic Games, only in 6 of them did the host country perform unusually well relative to their typical performance.\n2. In the vast majority of cases (88%), host countries don't perform unusually well.\n3. It might be the case that the home-field advantage comes down to the larger than usual number of athletes a country can bring to the games, but not to its better performance. This remains an open question that would require further investigation.","7886ad62":"## 5. Country differences  \n\n### 5a. What sports are different countries best at?\nSince we have data on the country each athlete represented, we can find out whether different countries are better (i.e. win more medals) at different sports.  \n\nWe start by counting the number of medals each country won in each sport, and select the top sport for each country. From there, for every sport, we get the list of countries that have historically been best at that sport.","19e0568c":"So although we meet the assumptions of linearity and homoscedasticity, the distribution of the two variables indicates a heavy skew and the presence of outliers. In this case, it might be preferable to go with the non-parametric Spearman's rank-order correlation. The test indicates that there is indeed a significant positive correlation between our variables, meaning that as the number of athletes increases, so does the number of medals won.","9818df98":"Quick introduction to UpSet plots (https:\/\/www.ncbi.nlm.nih.gov\/pmc\/articles\/PMC4720993\/)  \n * UpSet visualises set intersections in a matrix layout. The combination matrix identifies the intersections, while the bars above it encode the size of each intersection (cardinality).  \n * In our case, the sets are Winter and Summer events. The vertical bars show number of athletes (y axis) who participated in Summer events only (first bar), Winter events only (second bar), or both events (third bar). The filled circles underneath each vertical bar show which sets contribute to that bar.\n\n**Conclusions**\n1. 86% of all athletes participated in Summer events only.\n2. 13.9% of all athletes participated in Winter events only.\n3. 0.1% of all athletes participated in both Summer and Winter events.  \n\n### 3b. What sports did athletes who participated in both Summer and Winter events compete in?\nWe now know that indeed the majority of athletes participate in only one season of the Olympic Games. However, 163 athletes participated in both, which makes them interesting to us for further analysis. Which sports do these athletes compete in?","80a4a5fe":"## 4. The home-field advantage\nIn sports, the home-field advantage is the advantage a team enjoys from being on its usual playing field. In the Olympic Games specifically, athletes from the host country have a slightly esier time qualifying for the games, as for example host countries are guaranteed a spot in each team sport. So overall, host countries have more athletes participating in the games compared to when they are not hosting.\n\nThen the question arises as to whether the so-called home-field advantage is simply due to the larger numbers of athletes participating, or is it that the host country actually performs better, perhaps due to a moral advantage of being home and having a larger crowd cheering them on?\n\nWe will start this analysis by looking at the relationship between number of athletes and number of medals, and then proceed to determine whether host countries not just win more medals overall, but actually perform better.\n\n### 4a. What is the relationship between number of athletes and number of medals won?\nHere we explore the relationship between the number of athletes that a country brings to the Olympic Games and the number of medals that country wins.","894f842a":"# Exploratory Data Analysis of the Olympic Games Dataset","68f3964c":"### 4b. Are countries performing better when they are hosting?\nNow that we know that as the number of athletes increases, so does the number of medals, we can assume that since host countries can participate with more athletes, they will have more medals overall, just because of the number of athletes - testing this hypothesis could be another analysis. But the more interesting question for now is whether they actually perform better when they are hosting. Is there some kind of moral advantage that translates to better performance?\n\nIn order to measure a country's performance, we compute the number of medals they won per participating athlete (mpa = medals-per-athlete). The dataset contains the host city for each event but not the country, therefore the first step is to find out which country each city is in.","ad5b4838":"### 3d. Are there athletes that won medals in multiple sports?\nNow that we've seen that there are some athletes who compete in multiple sports, one final follow-up question would be whether any of those also win medals in multiple sports.","6d48d366":"## 1. Read in the data and get a basic idea of the structure of the dataset","df57c7e5":"Visually, it looks like number of athletes and number of medals correlate positively, but we want to test this statistically.\n\nPearson's correlation test assumes (1) the presence of a linear relationship between the variables, as well as the (2) absence of outliers, and (3) homogeneity of variance. From the scatterplot above, we can tell that there is a linear relationship between our variables. As for the presence of outliers, that is a bit more difficult to tell. From the scatterplot above, there seem to be some data points that fall far from the regression line. However, since those data points are not physically impossible to occur and we do not have a clear basis on which to remove them, it might be preferable to keep all data points in and opt for a non-parameteric test such as Spearman's rank-order correlation which is not sensitive to outliers.\n\nIn order to test homogeneity of variances, we can use Levene's test.","ff47aced":"From the output above we can see that for 21 data points, the \"region\" column is NaN, meaning that the NOC in the athlete_events table did not have a corresponding value in the noc_regions table. We can further see that these 3 NOC regions are ROT, UNK, and TUV, and upon looking them up in the noc_regions table we can see that their long names are recorded in the \"notes\" column instead. We coalesce the \"notes\" and \"regions\" columns to make sure we don't introduce missing values in the \"regions\" column, as it will be needed for further analysis.\n\nOne thing to be careful about is the presence of team sports in our dataset. When a coutry wins a medal in a team sport, there is an entry for every team member. However, for the purpose of this analysis, we want to know how many medals a country (not each athlete) won, therefore we only want to count team medals once.  \n\nIn order to accomplish this, we cannot simply group by country and count the rows. Instead, we could count the unique combinations of Games + Event + Medal, since those are unique per country's medal.  \n\nFor example, Romania won a gold medal in fencing in the 2016 Summer Olympics at Rio de Janeiro. The fencing team was made up of 4 team members, each with an entry in the athlete dataset. The way we know these 4 entries belong to the same medal for Romania, is because they all have the same Game listed (Summer 2016) + Event (Fencing Women's epee, Team) + Medal (Gold).","0ebea42e":"**Conclusions**  \nIt is interesting to inspect the table above and see which countries win the most medals in which sport. This can potentially give us some insight into which sports are most popular in each country, or which sports countries invest most in.\nFor example,\n1. Romania and Japan both won most of their olympic medals in Gymnastics.\n2. India and Pakistan both won most of their olympic medals in Hockey.\n3. Egypt, Iraq, and North Korea all won most of their olympic medals in Weightlifing.","e080e9c7":"Levene's test is not significant meaning that we failed to reject the null hypothesis that there is no difference in variances between the two variables. In other words, we do not violate the assumption of homoscedasticity.","9b94f0cd":"**Conclusions**\n1. The most popular combination of sports that athletes participate in is <span style=\"color:blue\">Bobsleigh<\/span> in Winter and <span style=\"color:red\">Athletics<\/span> in Summer.\n2. The second most popular combination of sports is <span style=\"color:blue\">Speed Skating<\/span> in Winter and <span style=\"color:red\">Cycling<\/span> in Summer.\n3. Some athletes participate in both Summer and Winter events but compete in only one sport - Ice Hockey or Figure Skating - meaning that these two sports are played in both Summer and Winter Games.  \n\n### 3c. Are Ice Hockey and Figure Skating the only two sports that are played in both Summer and Winter Games?","a957292f":"**Conclusions**  \n1. Summer Olympic Games started in 1896.  \n2. Winter Olympic Games started 28 years later, in 1924.  \n3. Summer events happened every 4 years, with 3 exceptions: \n    * between 1904 and 1908 summer events took place every 2 years (1906 was an Intercalated Game event)\n    * there were no events between 1912 and 1920 (8 year hiatus, caused by WW1)\n    * there were no events between 1936 and 1948 (12 year hiatus, caused by WW2)  \n4. Winter events happened every 4 years, with 2 exceptions:\n    * between 1992 and 1994 winter events took place every 2 years\n    * there were no events between 1936 and 1948 (12 year hiatus, caused by WW2)   \n5. 1992 was the last year when both Summer and Winter events happened in the same year.","840ad229":"Now that we have the ecdf for the medals-per-athlete each country won when they did not host, we can choose a threshold that we would like to compare the medals-per-athlete each country won when they did host. For this analysis we will pick the 90th percentile. We will consider the performance of the host year anomalous if it falls above the 90th percentile of that country's general performance.\n\nFor example, if we return to Finland, we know from the ecdf that 9 times out of 10 Finland won up to 0.4 medals per athlete. So if Finland wins more than 0.4 medals per athlete when they host the olympic Games, we know that there is only a 1 in 10 chance of this happening, and that this is anomalous.\nIn the year when they hosted, Finland won 0.08 medals per athlete, which is a much poorer performance than their 0.4 cutoff.\n\nWe can now go ahead and get the medals-per-athlete value for each country for ecdf = 0.9 and compare it with their medals-per-athlete in the year when they hosted.","ae108d32":"**Further conclusion**  \nAlpinism is also present during both Summer and Winter Games, but no athlete competed in this sport during both seasons.","501bf648":"**Conclusions**\n1. Interestingly enough, 86 athletes won medals in multiple sports.  \n2. Most of them won medals in similar sports (e.g. Water Polo and Swimming, Diving and Swimming), but some won medals in what appear to be very dissimilar sports.  \n3. Using the get_multi_medal_athlete_data() function, we can see who these athletes were, by providing an array of sports in which they won medals.\n    * This way we find out that for example Edward Patrick Francis \"Eddie\" Eagan won gold medals in both Boxing and Bobsleigh, which is quite impressive.","e10cc0be":"## 3. Multi-sport athletes  \n### 3a. Are there athletes that participate in both Summer and Winter Olympic Games?\nIntuitively, one might assume that athletes train in a single sport, and therefore participate in a single season of the games. Is this true?  \n\nFor every athlete, we find out if they participated in Summer events only, Winter events only, or both. UpSet plots make it easy to visualise set intersections.  ","e339e7c2":"Our second step is to build the dataset we need for analysis. For every country, we want to compute the medals-per-athlete for the years when they hosted, and for the years when they did not host.","ff77149a":"## 2. Timeline of Summer and Winter Olympic Games\nWe know that the modern Olympic Games are held every four years, with the Summer and Winter Games alternating by occurring every four years but two years apart from each other. Has this always been the case?","f7e6854f":"Our goal is to find out whether host countries perform better when they host compared to when they don't host. There are many ways in which this problem could be approached (e.g. compare medals-per-athlete in host year with the average in all other years, or compare medals-per-athlete in host year with medals-per-athlete in the previous year they participated) but for this analysis we will choose to treat this problem more like an anomaly detection problem. So we want to know whether the year when they hosted, the performance was anomalous as compared to their typical behaviour over the other years. \n\nWe will use the empirical cumulative distribution function (ecdf) to visualise how the performance of each country is distributed - and what proportion of olympic games participations resulted in up to a specified number of medals per athlete."}}