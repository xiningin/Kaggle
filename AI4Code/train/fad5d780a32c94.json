{"cell_type":{"ff4c50ae":"code","52b59fa4":"code","ec1247f6":"code","8cb3354a":"code","8cc23197":"code","f219123a":"code","4614e21c":"code","41378858":"code","468cb1a5":"code","00755076":"code","61f6e248":"code","cab873bd":"code","68a844ab":"code","defe1af4":"code","9aa9ec0c":"code","87cbfaf3":"code","87ffc3c3":"code","9df29e21":"code","11b53bc8":"code","191e64ee":"code","bbcfaade":"code","bcee8010":"code","8dbaaa0d":"code","593deb73":"markdown","a2dae9eb":"markdown","ac777eff":"markdown","ba3bc352":"markdown","8199d447":"markdown","099b900d":"markdown","d581407c":"markdown","87b72545":"markdown","445d470d":"markdown","83574eb0":"markdown","38442297":"markdown","4f89655d":"markdown","9872f1f0":"markdown","7c5c252c":"markdown","25283ded":"markdown","50808892":"markdown","8bc76713":"markdown"},"source":{"ff4c50ae":"!pip install ktrain","52b59fa4":"import pandas as pd\nimport numpy as np\nimport ktrain\nimport tensorflow as tf\nfrom ktrain import text","ec1247f6":"tf.version.VERSION","8cb3354a":"df_train = pd.read_csv('..\/input\/emotions-dataset-for-nlp\/train.txt', header =None, sep =';', names = ['Input','Sentiment'], encoding='utf-8')\ndf_test = pd.read_csv('..\/input\/emotions-dataset-for-nlp\/test.txt', header = None, sep =';', names = ['Input','Sentiment'],encoding='utf-8')","8cc23197":"df_train.head()","f219123a":"df_train.Sentiment.value_counts()","4614e21c":"X_train = df_train.Input.tolist()\nX_test = df_test.Input.tolist()\ny_train = df_train.Sentiment.tolist()\ny_test = df_test.Sentiment.tolist()","41378858":"print(len(X_train),len(X_test),len(y_train),len(y_test))","468cb1a5":"factors = ['anger', 'fear', 'joy', 'love', 'sadness','surprise']","00755076":"encoding = { 'anger': 0,\n    'fear': 1,\n    'joy': 2,\n    'love': 3,\n    'sadness': 4,\n    'surprise': 5\n}","61f6e248":"y_train = [encoding[key] for key in y_train]\ny_test = [encoding[key] for key in y_test]","cab873bd":"model_arch ='bert-base-uncased'\nMAXLEN = 512\ntrans = text.Transformer(model_arch, maxlen=MAXLEN, class_names= factors)\n","68a844ab":"train_data = trans.preprocess_train(X_train,y_train)\ntest_data = trans.preprocess_test(X_test,y_test)","defe1af4":"model = trans.get_classifier()","9aa9ec0c":"learner = ktrain.get_learner(model, train_data=train_data, val_data=test_data, batch_size=10)","87cbfaf3":"learner.lr_find(show_plot=True, max_epochs=10)","87ffc3c3":"learner.fit_onecycle(3e-5, 5)","9df29e21":"learner.validate(val_data=test_data, class_names=factors)","11b53bc8":"learner.view_top_losses(n=5, preproc=trans)","191e64ee":"X_test[1928]","bbcfaade":"predictor = ktrain.get_predictor(learner.model, preproc=trans)","bcee8010":"inp = 'I am very disappointed with this kind of front camera. Need refund.'","8dbaaa0d":"predictor.predict(inp)","593deb73":"Checking version of TF, so that when later we will reload the model, we can use same version of TF:","a2dae9eb":"**Importing required libraries:**","ac777eff":"Checking first few rows of our train dataset.","ba3bc352":"Get data loaded from train.txt to df_train dataframe and teast.txt to df_test dataframe.","8199d447":"Encoding our sentiment categories into numeric values:","099b900d":"Checking size of our train and test datasets:","d581407c":"**top 5 data points not performing good:**","87b72545":"We are using bert-base-uncased model. You can choose any other model. I am selecting maxlen of tokenization as 512 (it's max for BERT).","445d470d":"Checking category wise distribution of our test data.","83574eb0":"# Building Model using Transformer","38442297":"Let's preprocess out test and train data set.","4f89655d":"# Preparing our train and test dataset:","9872f1f0":"**Confusion Matrix:**","7c5c252c":"Above data our model is predicting as sadness but label is mentioned as fear.","25283ded":"Finding the best learning rate:","50808892":"# Predict Data:","8bc76713":"Our dataset has below categories\/factors:"}}