{"cell_type":{"ac2bec52":"code","97d974ed":"code","a833fb3e":"code","a6f73f05":"code","dbc5ffa3":"code","54b398ea":"code","6cbf8eb8":"code","32c78490":"code","df2c5afa":"code","f2586c84":"code","8129e856":"code","d55d10fa":"code","7397a585":"code","83061238":"code","2c9d908e":"code","0b21f10c":"code","84bfa15e":"code","d28fd2be":"code","afd1bffe":"code","cbbc67d7":"code","0cded120":"code","819619d8":"code","d068df25":"code","d8fb5875":"code","cd6a8771":"code","3ca78630":"code","66071fce":"code","2ffdb584":"code","65bc03a4":"code","758509eb":"code","9a9a86ce":"code","5da17707":"code","aa6d2b82":"code","a6071983":"code","7d53fdb2":"code","99feff71":"code","d69cbcda":"code","e92cb8b1":"code","7e2495bc":"code","79e82af5":"code","10a253b7":"code","81076fe9":"code","eea139d1":"code","189b7d10":"code","c553ce16":"code","fad490f8":"code","32450068":"code","65a68f40":"code","9349cbe2":"code","122d5cf1":"markdown","c8cb466a":"markdown","7c6021b5":"markdown","b6b1c664":"markdown","ac75cf96":"markdown","e8eeea44":"markdown","ef22e803":"markdown","ad71116a":"markdown","389b4329":"markdown","e0532aa5":"markdown","7f39d4e1":"markdown","68dc898a":"markdown","0e5d53d1":"markdown","4d9717e6":"markdown","0d866343":"markdown","7bf03f58":"markdown","9e4cca06":"markdown","c8100145":"markdown","13f5237f":"markdown","466f002c":"markdown"},"source":{"ac2bec52":"# Import libraries\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.compose import ColumnTransformer\n\n# Set aesthetic style of seaborn plots\nsns.set_style('whitegrid')","97d974ed":"# Load data\ndata_less = pd.read_csv('..\/input\/melbourne-housing-market\/MELBOURNE_HOUSE_PRICES_LESS.csv')\ndata_full = pd.read_csv('..\/input\/melbourne-housing-market\/Melbourne_housing_FULL.csv')","a833fb3e":"# Take a quick look at the structure of the data\ndata_less.head()","a6f73f05":"data_less.columns","dbc5ffa3":"data_less.shape","54b398ea":"data_full.head()","6cbf8eb8":"data_full.columns","32c78490":"data_full.shape","df2c5afa":"data_less.info()","f2586c84":"price_not_missing = data_less['Price'].dropna()\nlen(price_not_missing) \/ len(data_less) * 100","8129e856":"data_less.describe().transpose()","d55d10fa":"sns.countplot(x='Rooms', data=data_less);","7397a585":"data_less['Rooms'].value_counts()","83061238":"sns.histplot(data=data_less, x='Price', binwidth=400000, kde=True);","2c9d908e":"sns.boxplot(x=data_less['Price']);","0b21f10c":"price_outliers = data_less[data_less['Price'] > 5000000]\nprice_outliers.head()","84bfa15e":"g = sns.countplot(data=price_outliers, y='Suburb')\ng.set_title(\"Total property sales by suburb for properties over $5m\", y=1.03);","d28fd2be":"# Distance from CBD in kilometers\nsns.histplot(data=data_less, x='Distance', binwidth=3);","afd1bffe":"data_less['Suburb'].value_counts()","cbbc67d7":"data_less['Address'].head()","0cded120":"data_less['Type'].head()","819619d8":"labels = ['house', 'townhouse', 'unit']\ng = sns.countplot(data=data_less, x='Type')\ng.set_xticklabels(labels)\ng;","d068df25":"data_less['Method'].head()","d8fb5875":"data_less['Method'].value_counts()","cd6a8771":"len(data_less['SellerG'].value_counts())","3ca78630":"data_less['SellerG'].value_counts().head(10)","66071fce":"len(data_less['Postcode'].value_counts())","2ffdb584":"sns.countplot(data=data_less, y='Regionname');","65bc03a4":"corr_matrix = data_less.corr()\ncorr_matrix","758509eb":"corr_matrix['Price'].sort_values(ascending=False)","9a9a86ce":"sns.scatterplot(data=data_less, x='Price', y='Distance', hue='Regionname');","5da17707":"sns.scatterplot(data=data_less, x='Price', y='Distance', hue='Type');","aa6d2b82":"data_less.info()","a6071983":"price_missing = data_less[data_less.isnull().any(1)]\nlen(price_missing)","7d53fdb2":"price_nonmissing = data_less.dropna()\nlen(price_nonmissing)","99feff71":"price_nonmissing.head()","d69cbcda":"price_missing['Method'].value_counts()","e92cb8b1":"sns.countplot(data=price_missing, x='Method');","7e2495bc":"sns.countplot(data=price_nonmissing, x='Method');","79e82af5":"# Drop instances which have a missing price\ndata = data_less.dropna()\nlen(data)","10a253b7":"features = ['Suburb', 'Rooms', 'Type', 'Method', 'SellerG', 'Postcode', 'Regionname', 'Distance', 'CouncilArea']\nX = data[features]\n\ntarget = ['Price']\ny = data[target]\n\n# Split data into train and test\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=324)","81076fe9":"X_train.info()","eea139d1":"X_test.info()","189b7d10":"cat_attribs = ['Suburb', 'Type', 'Method', 'SellerG', 'Regionname', 'CouncilArea']\n\nfull_pipeline = ColumnTransformer([\n    (\"cat\", OneHotEncoder(), cat_attribs),\n])\n\nX_train_prepared = full_pipeline.fit_transform(X_train)\nX_test_prepared = full_pipeline.fit_transform(X_test)","c553ce16":"regressor = DecisionTreeRegressor(max_depth=20)\nregressor.fit(X_train_prepared, y_train)","fad490f8":"y_predictions = regressor.predict(X_train_prepared)\ny_predictions","32450068":"y_predictions.mean()","65a68f40":"np.median(y_predictions)","9349cbe2":"lin_mse = mean_squared_error(y_train, y_predictions)\nlin_rmse = np.sqrt(lin_mse)\nlin_rmse","122d5cf1":"# Basic regression\n\nI will now train a linear regression model to predict property sale price.","c8cb466a":"## Explore the data","7c6021b5":"> How many real estate agents made sales during this period?","b6b1c664":"### Correlations","ac75cf96":"Most properties with corresponding `Price` values were sold. However, most properties with a missing `Price` value were `PI` (property passed in), followed by `S` (sold), `SN` (sold not disclosed), and `SP` (property sold prior). It makes sense then that some of these instances would be missing for `Price`.\n\nInstances which have missing target values are not helpful for training our model, so they will be dropped.","e8eeea44":"# Exploratory data analysis","ef22e803":"A house with more than six rooms is unusual unless you're Drake.","ad71116a":"### Categorical attributes","389b4329":"### Summary\n\n* `MELBOURNE_HOUSE_PRICES_LESS.csv` is almost twice as large as `Melbourne_housing_FULL.csv` in terms of number of instances (about 63,000 compared to 35,000).\n* `MELBOURNE_HOUSE_PRICES_LESS.csv` has 13 columns, compared to the 21 columns on `Melbourne_housing_FULL.csv`.\n* The description indicates a change in the web scraping procedure:\n> Update 22\/05\/2018 - Will continue with a smaller subset of the data (not as many columns). The web scraping was taking some time and also may potentially cause problems. Will continue to post the data.\n* I will explore `MELBOURNE_HOUSE_PRICES_LESS.csv` for now as it is the most up-to-date file, despite having fewer columns. Some of the attributes on the \"full\" dataset, like geographical coordinates, might be interesting to explore in the future.","e0532aa5":"### For further exploration\n\n* Decompose date into day, month, year attributes. Plot with `Price` and `Regionname` or something else.\n* Are sale prices increasing or decreasing over time? How does this differ between houses, units, and townhouses?","7f39d4e1":"#### Summary\n\n* As expected, `Price` is heavily skewed to the right. The median is \\\\$830,000. The cheapest property sold is only \\\\$85,000, while the most expensive is \\\\$11,200,000.\n* Most properties sold have three bedrooms. 14 properties have more than 10 bedrooms, including one with 31 bedrooms!\n* Some of the most affluent suburbs include Brighton, Toorak, and Armadale.\n* `Distance` (distance from CBD) is also skewed to the right. Most properties sold are within 30-40 km from the CBD. The median is 11.4 km.","68dc898a":"### Summary\n\n* The median of the target predictions is 867,618, which is close to the median property price of 830,000 dollars.\n* The root mean squared error is 317,026, which isn't very satisfying given the median property price (830,000) and range (85,000 to 11,200,000). Perhaps the outliers are having too much of an impact on the model.","0e5d53d1":"To summarise the above:\n* There are 63,023 instances in the dataset.\n* There are 13 attributes in total: two of these are `float`, three are `int`, and the remaining eight are `object`.\n* There appear to be no missing values for all attributes except `Price` (the target attribute), which is missing on 24% of the dataset.","4d9717e6":"#### Summary\n\n* As expected, most property sales were houses, followed by units, then townhouses.\n* 476 real estate agents made sales during this period (2017-2018).\n* There are eight different regions, with most sales in Southern Metropolitan followed by Northern Metropolitan. There were very few sales in Western, Northern, and Eastern Victoria, which I'm guessing is regional.\n* I will most likely drop `Address` for now. However, some of the information stored in this attribute may be helpful. For example, do long roads or streets (indicated by high house numbers) have lower sale prices on average? Conversely, do small roads, streets, or cul-de-sacs, have higher property prices?","0d866343":"#### Summary\n\n* There is a moderate positive relationship between `Price` and `Rooms` (*r* = 0.41). So the more rooms a property has, the higher the sold price is generally.\n* There is moderate negative relationship between `Price` and `Distance` (*r* = -0.25). So property prices generally increase as distance from the CBD decreases.","7bf03f58":"### Numerical attributes","9e4cca06":"## Introduction\n\nThis is an exploration of the Melbourne housing market dataset. The goal of this notebook is to get an in depth understanding of the data before creating a model to predict house prices.","c8100145":"> What is the difference between `MELBOURNE_HOUSE_PRICES_LESS.csv` and `Melbourne_housing_FULL.csv`?","13f5237f":"But before we split the dataset into training and test sets...\n\n> Why are there so many missing `Price` values?","466f002c":"## Decision tree regression\n\nI decided to try a decision tree regressor as I wouldn't expect the relationship between `Price` and predictors to be well approximated by a linear model. For example, as seen earlier, the relationship between `Price` and `Distance` appears to follow a Pareto distribution."}}