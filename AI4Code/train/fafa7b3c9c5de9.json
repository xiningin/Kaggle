{"cell_type":{"158c991c":"code","89cebce7":"code","b230582e":"code","fb901cc6":"code","4e3fb58d":"code","03c1915b":"code","a3ec8d5e":"code","a82a3443":"code","d15464fe":"code","07afae4b":"code","8b6a5a2f":"code","eaf3338b":"code","4e715d83":"code","45dd054a":"code","54de02e8":"code","57240d84":"code","6439f0e8":"code","6cfbafd3":"code","4c9c5e58":"code","32224739":"code","d5d2f8ce":"code","9a06516b":"code","bf1a7121":"code","5a2a0be6":"code","5c10f641":"code","bcbd79ea":"markdown","fd9fad1d":"markdown","70ec63ca":"markdown","3c866022":"markdown","1bf4d35f":"markdown","20718b3b":"markdown","fd45a91c":"markdown","8e41877f":"markdown","e5e98935":"markdown","ccdb5058":"markdown","5325ab0f":"markdown","4fb73f0c":"markdown","a1138686":"markdown","98897e83":"markdown","5f62f813":"markdown","1253d683":"markdown","227ebd00":"markdown","d096e3c4":"markdown"},"source":{"158c991c":"import warnings\nwarnings.filterwarnings('ignore')","89cebce7":"import pandas as pd\nimport numpy  as np\nimport math\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom scipy import stats\nfrom sklearn import preprocessing\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.feature_extraction.text import CountVectorizer\nfrom sklearn.model_selection import train_test_split,KFold,cross_val_score,StratifiedShuffleSplit\nfrom sklearn.metrics import classification_report,confusion_matrix\nfrom pandas_profiling import ProfileReport\nfrom sklearn.cluster import KMeans\nfrom datetime import datetime, timedelta,date","b230582e":"!pip install chart_studio","fb901cc6":"import chart_studio.plotly as py\nimport plotly.offline as pyoff\nimport plotly.graph_objs as go","4e3fb58d":"df_data = pd.read_csv('..\/input\/telco-customer-churn\/WA_Fn-UseC_-Telco-Customer-Churn.csv')\ndf_data.head()","03c1915b":"profile = ProfileReport(df_data,title='Profile Report')\nprofile.to_widgets()","a3ec8d5e":"def label_encoder(data):\n    le = preprocessing.LabelEncoder()\n    data = le.fit_transform(data)\n    return data","a82a3443":"pyoff.init_notebook_mode()\ndef ploting(data,col):\n    df_plot = data.groupby(col).Churn.mean().reset_index()\n    plot_data = [\n        go.Bar(\n            x=df_plot[col],\n            y=df_plot['Churn'],\n            width = [0.2, 0.2, 0.2, 0.2],\n            marker=dict(\n            color=['green','blue','red','yellow'])\n        )\n    ]\n\n    plot_layout = go.Layout(\n            xaxis={\"type\": \"category\"},\n            yaxis={\"title\": \"Churn Rate\"},\n            title=col,\n            plot_bgcolor  = 'rgb(243,243,243)',\n            paper_bgcolor  = 'rgb(243,243,243)',\n        )\n    fig = go.Figure(data=plot_data, layout=plot_layout)\n    pyoff.iplot(fig)\n    pass","d15464fe":"category_cols = ['gender', 'Partner', 'Dependents',\n        'PhoneService', 'MultipleLines', 'InternetService',\n       'OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport',\n       'StreamingTV', 'StreamingMovies', 'Contract', 'PaperlessBilling',\n       'PaymentMethod']\ndf_data['Churn'] = label_encoder(df_data['Churn'])\ndf_data.head()","07afae4b":"for col in category_cols:\n    ploting(df_data,col)","8b6a5a2f":"quantile_list = [0, .25, .5, .75, 1.]\nquantiles = df_data['tenure'].quantile(quantile_list)\nquantiles","eaf3338b":"quantile_labels = ['0-25Q', '25-50Q', '50-75Q', '75-100Q']\ndf_data['tenure_quantiles'] = pd.qcut(df_data['tenure'],q=quantile_list, labels=quantile_labels)\ndf_data.head()","4e715d83":"ploting(df_data,'tenure_quantiles')","45dd054a":"df_plot = df_data.groupby('tenure').Churn.mean().reset_index()\n\n\nplot_data = [\n    go.Scatter(\n        x=df_plot['tenure'],\n        y=df_plot['Churn'],\n        mode='markers',\n        name='Low',\n        marker= dict(size= 8,\n            line= dict(width=2),\n            color= 'green',\n            opacity= 0.9\n           ),\n    )\n]\n\nplot_layout = go.Layout(\n        yaxis= {'title': \"Churn Rate\"},\n        xaxis= {'title': \"Tenure\"},\n        title='Tenure based Churn rate',\n        plot_bgcolor  = \"rgb(243,243,243)\",\n        paper_bgcolor  = \"rgb(243,243,243)\",\n    )\nfig = go.Figure(data=plot_data, layout=plot_layout)\npyoff.iplot(fig)","54de02e8":"quantile_list = [0, .25, .5, .75, 1.]\nquantiles = df_data['MonthlyCharges'].quantile(quantile_list)\nquantiles","57240d84":"quantile_labels = ['0-25Q', '25-50Q', '50-75Q', '75-100Q']\ndf_data['MonthlyCharges_quantiles'] = pd.qcut(df_data['MonthlyCharges'],q=quantile_list, labels=quantile_labels)\ndf_data.head()","6439f0e8":"ploting(df_data,'MonthlyCharges_quantiles')","6cfbafd3":"df_plot = df_data.copy()\ndf_plot['MonthlyCharges'] = df_plot['MonthlyCharges'].astype(int)\ndf_plot = df_plot.groupby('MonthlyCharges').Churn.mean().reset_index()\n\n\nplot_data = [\n    go.Scatter(\n        x=df_plot['MonthlyCharges'],\n        y=df_plot['Churn'],\n        mode='markers',\n        name='Low',\n        marker= dict(size= 8,\n            line= dict(width=2),\n            color= 'red',\n            opacity= 0.8\n           ),\n    )\n]\n\nplot_layout = go.Layout(\n        yaxis= {'title': \"Churn Rate\"},\n        xaxis= {'title': \"Monthly Charges\"},\n        title='Monthly Charge vs Churn rate',\n        plot_bgcolor  = \"rgb(243,243,243)\",\n        paper_bgcolor  = \"rgb(243,243,243)\",\n    )\nfig = go.Figure(data=plot_data, layout=plot_layout)\npyoff.iplot(fig)","4c9c5e58":"df_data = df_data.replace(r'^\\s*$', np.nan, regex=True)","32224739":"df_data.isna().sum()","d5d2f8ce":"df_data = df_data.dropna()","9a06516b":"df_data['TotalCharges'] = df_data['TotalCharges'].astype('float64')","bf1a7121":"quantile_list = [0, .25, .5, .75, 1.]\nquantiles = df_data['TotalCharges'].quantile(quantile_list)\nquantiles","5a2a0be6":"quantile_labels = ['0-25Q', '25-50Q', '50-75Q', '75-100Q']\ndf_data['TotalCharges_quantiles'] = pd.qcut(df_data['TotalCharges'],q=quantile_list, labels=quantile_labels)\ndf_data.head()","5c10f641":"ploting(df_data,'TotalCharges_quantiles')","bcbd79ea":"# TELCO CHURN PREDICTION EDA","fd9fad1d":"### Quantile Based Binning","70ec63ca":"### Data Observation:\n\n####  1) Dataset contains 7043 rows and 21 columns and data with no missing values.\n####  2) Data contans 13 categorical , 6 Boolean and 2 numerical features.\n####  3) Target variable Churn depicts with retention rate of 73.4% and 26.6% churn rate.\n####  4) Total Charges column contain whitespaces which need to be dropped and need to convert data type to float.","3c866022":"### EDA","1bf4d35f":"## TotalCharges v\/s Churn Rate\n#### Total Charges column contain whitespaces which need to be dropped and convert data type to float.\n#### After Quantile based Binning on Total Charges and plot below, 43% of customers whose total charges is between Rs.18 - Rs.401 Churn rate is high.","20718b3b":"## EDA Conclusion:","fd45a91c":"### Quantile Based Binning","8e41877f":"## Monthly Charges v\/s Churn Rate\n#### After Quantile based Binning on Monthly Charges and plot below, 37% of customers whose Monthly charges is between Rs.70 - Rs.90 Churn rate is high.","e5e98935":"### Categorical variables against Churn Rate Plot Observation :\n\n| Category | Churn |\n| :- | :- | \n| Gender | Female Customers Churn Rate is more than the male customers | \n| partners | Customers without partners Churn Rate is 13% more than the customers with partners | \n| Dependents | Customers without Dependents Churn Rate is 15% more than the customers with Dependents | \n| PhoneService | Customers with PhoneService Churn Rate is more |\n| MultipleLines | Customers with MultipleLines Churn Rate is more | \n| Internet Service | 42% of Customers with Internet Service fibre optic churn | \n| Online Security | 42% of Customers without Online Security churn | \n| Online Backup | 40% Customers without Online Backup churn  | \n| Device Protection | 40% of Customers without Device Protection churn  | \n| Tech Support | 42% of Customers without Tech Support churn | \n| Streaming TV, Streaming Movies| Customers without these services Churn Rate is more| \n| Contract | Customers with month-to-month contract Churn Rate is more as its obvious with a year\/2 years contract Churn Rate is less | \n| Paperless Billing | 34% of Customers with Paperless Billing churn | \n| Payment Method | 45% Customers with Payment Method Electronic check churn | ","ccdb5058":"### RGB Bar Plots","5325ab0f":"### Label Encoding","4fb73f0c":"####  1) Dataset contains 7043 rows and 21 columns and data with no missing values.\n####  2) Data contans 13 categorical , 6 Boolean and 2 numerical features.\n####  3) Target variable Churn depicts with retention rate of 73.4% and 26.6% churn rate.\n####  4) Total Charges column contain whitespaces which need to be dropped and need to convert data type to float.\n####  5) 43% of customers whose total charges is between Rs.18 - Rs.401 Churn rate is high\n####  6) 37% of customers whose Monthly charges is between Rs.70 - Rs.90 Churn rate is high.\n####  7) 50% of customers whose Tenure is between 1 to 9 Churn rate is high.\n####  8) Category features v\/s churn rate :\n| Category | Churn |\n| :- | :- | \n| Gender | Female Customers Churn Rate is more than the male customers | \n| partners | Customers without partners Churn Rate is 13% more than the customers with partners | \n| Dependents | Customers without Dependents Churn Rate is 15% more than the customers with Dependents | \n| PhoneService | Customers with PhoneService Churn Rate is more |\n| MultipleLines | Customers with MultipleLines Churn Rate is more | \n| Internet Service | 42% of Customers with Internet Service fibre optic churn | \n| Online Security | 42% of Customers without Online Security churn | \n| Online Backup | 40% Customers without Online Backup churn  | \n| Device Protection | 40% of Customers without Device Protection churn  | \n| Tech Support | 42% of Customers without Tech Support churn | \n| Streaming TV, Streaming Movies| Customers without these services Churn Rate is more| \n| Contract | Customers with month-to-month contract Churn Rate is more as its obvious with a year\/2 years contract Churn Rate is less | \n| Paperless Billing | 34% of Customers with Paperless Billing churn | \n| Payment Method | 45% Customers with Payment Method Electronic check churn | ","a1138686":"#### Dataset credits : https:\/\/www.kaggle.com\/blastchar\/telco-customer-churn","98897e83":"## Categorical features v\/s Churn Rate","5f62f813":"Each row represents a customer, each column contains customer\u2019s attributes described on the column Metadata.\n\nThe data set includes information about:\n\nCustomers who left within the last month \u2013 the column is called Churn\nServices that each customer has signed up for \u2013 phone, multiple lines, internet, online security, online backup, device protection, tech support, and streaming TV and movies\nCustomer account information \u2013 how long they\u2019ve been a customer, contract, payment method, paperless billing, monthly charges, and total charges\nDemographic info about customers \u2013 gender, age range, and if they have partners and dependents","1253d683":"### Problem Statement:\n\nChurn quantifies the number of customers who have left your brand by cancelling their subscription or stopping paying for your services. This is bad news for any business as it costs five times as much to attract a new customer as it does to keep an existing one. A high customer churn rate will hit your company\u2019s finances hard. By leveraging advanced artificial intelligence techniques like machine learning (ML), you will be able to anticipate potential churners who are about to abandon your services.","227ebd00":"### Tenure v\/s Churn Rate Plot\n##### Larger the Tenure lesser the churn rate as observed in the below plot. As Tenure period increases churn rate is decreased.\n##### After Quantile based Binning on Tenure and plot below, 50% of customers whose Tenure is between 1 to 9 Churn rate is high.","d096e3c4":"### Loading data"}}