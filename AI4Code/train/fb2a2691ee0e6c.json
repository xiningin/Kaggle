{"cell_type":{"38d62131":"code","7f5687f5":"code","8bfdca70":"code","55c80b22":"code","0cc2b356":"code","6d147909":"code","ab880056":"code","c8cb9de7":"code","a6c64d1e":"code","9b36f2fd":"code","0eae84a3":"code","d0dc7803":"code","fb4b19a5":"code","95db3411":"code","aaac47a3":"code","b1d337c8":"code","904bc83f":"code","1d6d9a21":"code","62aff7db":"markdown","3b8ab43c":"markdown","be4e45f7":"markdown","af7960b4":"markdown","b6619375":"markdown","e7229a6b":"markdown","d4d59d6a":"markdown","bc051a45":"markdown","8af03919":"markdown","4e1c69ea":"markdown","f7134b2a":"markdown","447c0a8a":"markdown","8575ea84":"markdown","63f3e5e0":"markdown","d7432c54":"markdown","b141bcef":"markdown","0f7ab828":"markdown","f4c93c3b":"markdown","59d73cc6":"markdown","7e14f6f9":"markdown","4647f458":"markdown","7a779031":"markdown"},"source":{"38d62131":"import pandas as pd\ndf = pd.read_csv(\"..\/input\/persona\/persona.csv\")\n","7f5687f5":"def check_df(dataframe, head=5): \n# This function is for find general information about the dataset.\n    print(\"##################### Shape #####################\")\n    print(dataframe.shape)\n\n    print(\"##################### Types #####################\")\n    print(dataframe.dtypes)\n\n    print(\"##################### Head #####################\")\n    print(dataframe.head(head))\n\n    print(\"##################### Tail #####################\")\n    print(dataframe.tail(head))\n\n    print(\"##################### NA #####################\")\n    print(dataframe.isnull().sum())\n\n    print(\"##################### Quantiles #####################\")\n    print(dataframe.quantile([0, 0.05, 0.50, 0.95, 0.99, 1]).T)\n\n\ncheck_df(df)","8bfdca70":"num_source_unique = print(df[\"SOURCE\"].nunique())\nfrequency_source = print(df['SOURCE'].value_counts())","55c80b22":"num_price_unique = print(df[\"PRICE\"].nunique())","0cc2b356":"frequency_by_price = print(df[\"PRICE\"].value_counts())","6d147909":"frequency_by_counts = print(df[\"COUNTRY\"].value_counts())","ab880056":"sum_price_by_country = print(df.groupby(\"COUNTRY\")[\"PRICE\"].sum())","c8cb9de7":"num_of_price_by_source = print(df.groupby(\"SOURCE\")[\"PRICE\"].count())","a6c64d1e":"mean_of_price_by_country = print(df.groupby(\"COUNTRY\")[\"PRICE\"].mean())","9b36f2fd":"mean_of_price_by_source = print(df.groupby(\"SOURCE\")[\"PRICE\"].mean())","0eae84a3":"mean_of_price_by_source_country = print(df.groupby([\"SOURCE\", \"COUNTRY\"])[\"PRICE\"].mean())","d0dc7803":"group_list = [\"COUNTRY\", \"SOURCE\", \"SEX\", \"AGE\"]\n\nmean_of_price_by_the_list = print(df.groupby(group_list).agg(\"mean\"))","fb4b19a5":"agg_df = df.groupby(group_list)[\"PRICE\"].agg(\"mean\").sort_values(ascending=False)\nprint(agg_df)","95db3411":"agg_df = agg_df.reset_index()\nagg_df.head()","aaac47a3":"pd.set_option('display.max_columns', None)\nagg_df[\"AGE_CAT\"] = pd.cut(agg_df[\"AGE\"], bins=[0, 18, 23, 30, 40, 66],\n                           labels=['0_18', '19_23', '24_30', '31_40', '41_66'])\nagg_df.head()\n","b1d337c8":"agg_df[\"customers_level_based\"] = [str(row[0]).upper() + \"_\" +\n                                   str(row[1]).upper() + \"_\" +\n                                   str(row[2]).upper() + \"_\" +\n                                   str(row[5]).upper() for row in agg_df.values]\nagg_df.head()\n\ndf_categorical = agg_df[[\"customers_level_based\", \"PRICE\"]]\ndf_categorical.head()\n\ndf_categorical = df_categorical.groupby(\"customers_level_based\").agg({\"PRICE\": \"mean\"})\ndf_categorical = df_categorical.reset_index()\ndf_categorical.head()","904bc83f":"df_categorical[\"SEGMENT\"] = pd.qcut(df_categorical[\"PRICE\"], 4, labels=[\"D\", \"C\", \"B\", \"A\"])\n\ndf_categorical.groupby(\"SEGMENT\").agg({\"PRICE\": [\"mean\", \"max\", \"sum\"]})\ndf_categorical.loc[df_categorical['SEGMENT'] == 'C']","1d6d9a21":"new_user1 = \"TUR_ANDROID_FEMALE_31_40\"\nnew_user2 = \"FRA_IOS_FEMALE_31_40\"\n\nprint(df_categorical[df_categorical[\"customers_level_based\"] == new_user1])\nprint(df_categorical[df_categorical[\"customers_level_based\"] == new_user2])","62aff7db":"# **MISSION 6**\n\u25aa Define new level-based customers (personas) and add them as variables to the dataset.\n\u25aa Name of the new variable to be added: customers_level_based\n\u25aa You need to create the customers_level_based variable by combining the observations from the output from the previous question.\n\n![image.png](attachment:4849ce37-d3b8-4f36-bd43-5e2dd7a6f286.png)","3b8ab43c":"**VARIABLES**\n* PRICE\n* SOURCE\n* SEX\n* COUNTRY\n* AGE","be4e45f7":"9. What are the PRICE mean by SOURCE?","af7960b4":"7. What are the sales numbers by SOURCE types?","b6619375":"# **MISSION 5**\nConvert AGE variable to categorical variable and add it to DATAFRAME.","e7229a6b":"# **Mission 1**","d4d59d6a":"**Dataset Story**\nThe Persona.csv dataset contains the prices of the products sold by an international game company and some demographic information of the users who buy these products.\nThe data set consists of records created in each sales transaction.\nThis means that the table is not deduplicated. In other words, a user with certain demographic characteristics\nmay have shopped.\n![image.png](attachment:73dcb37a-87b0-4390-b736-b6e28f0e82f1.png)","bc051a45":"5. How many sales from which country?","8af03919":"10.What are the PRICE mean in the COUNTRY-SOURCE breakdown?","4e1c69ea":"6. How much was earned in total from sales by country?","f7134b2a":"# **MISSION 2**\nWhat are the mean PRICE in breakdown of COUNTRY, SOURCE, SEX, AGE?","447c0a8a":"# **MISSION 4**\nConvert the names in the index to variable names.","8575ea84":"2. How many unique SOURCE are there? What are their frequencies?","63f3e5e0":"3. How many unique PRICEs are there?","d7432c54":"# **MISSION 3**\nSort the output by PRICE.\n(To better see the output in the previous question, apply the sort_values method in descending order of PRICE.)","b141bcef":"#                   **PROJECT TASKS**\n   **Pre-Implementation Data Set**\n   \n![image.png](attachment:e189e336-6215-4c01-a0c4-3c2b9b4bcd54.png)\n\n   **Target Output**\n   \n![image.png](attachment:47f4cdb3-ca45-4752-90fa-fa7ea977da94.png)","0f7ab828":"# **MISSION 7**\nSegment new customers (personas).\n\u25aa Divide new customers (Example: USA_ANDROID_MALE_0_18) into 4 segments according to PRICE.\n\u25aa Add the segments to the DATAFRAME as variables with the SEGMENT naming.\n\u25aa Describe segments (group by segments and get price mean, max, sum).\n\u25aa Analyze C segment (Extract only C segment from the dataset and analyze)","f4c93c3b":"1. Read the persona.csv file and show the general information about the dataset.","59d73cc6":"4. How many sales were made from which PRICE?","7e14f6f9":"# **Level Based Customer Segmentation**\n**Business Problem**\nA game company wants to create level-based new customer definitions (personas) by using some features of its customers, and to create segments according to these new customer definitions and to estimate how much the new customers can earn on average according to these segments.\nE.g:\nIt is desired to determine how much a 25-year-old male user from Turkey, who is an IOS user, can earn on average.","4647f458":"# **MISSION 8**\nClassify new customers by segment and estimate how much revenue they can generate.\n\u25aa Which segment does a 33-year-old Turkish woman using ANDROID belong to and how much income is expected on mean?\n\u25aa In which segment and on mean how much income would a 35-year-old French woman using iOS expect to earn?","7a779031":"8. What are the PRICE mean by country?"}}