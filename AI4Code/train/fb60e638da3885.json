{"cell_type":{"5ae94bca":"code","a3d5439f":"code","eadfdd5a":"code","2d12a539":"code","49b6c245":"code","e126462d":"code","d9d9451d":"code","5ab5a7fc":"code","64b9be5c":"code","3740607d":"code","02fe58e5":"code","e883f05a":"code","ac91b7f2":"code","1880ac44":"code","ca355c50":"code","c07f216f":"code","6b2d28ff":"code","eb6c85df":"code","059a6b42":"code","52fec539":"code","96f1702a":"code","9327d043":"code","fdae0e44":"code","d7193745":"code","69f5673d":"code","5e16c9de":"code","adaca511":"code","18bf0f9b":"code","12b93887":"code","c17ae71d":"code","ffdc1739":"code","4e91a620":"code","11b68767":"code","4c58811a":"code","935f3707":"code","2beb93e8":"code","ceb6a122":"code","2c969fe9":"code","2e2dc49f":"code","dcfd4b1d":"code","69b6f127":"code","d0baadb9":"code","d63b6f96":"code","ceca9f8f":"code","a6ab05bd":"code","99713f8b":"code","fdcd9bd7":"code","d82399b5":"code","7b82b308":"code","05a430ba":"code","7657f6ba":"code","890b75bd":"code","3c7d0ddf":"code","35a42817":"code","cbfc1782":"code","cb3f8aca":"code","89ea08a6":"code","c1ed109c":"code","2aa43ef7":"code","33d7e6af":"code","f63bf9ff":"code","5a09b763":"code","386d861f":"code","bc2d7fce":"code","660052a3":"code","115d6d51":"code","f8b879cb":"code","7fa90b9e":"code","ee182d15":"code","79d581f4":"markdown","61c4fb48":"markdown","00008b49":"markdown","5c917bac":"markdown","cccd4da2":"markdown","6316c3d8":"markdown"},"source":{"5ae94bca":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","a3d5439f":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","eadfdd5a":"df=pd.read_csv('..\/input\/housesalesprediction\/kc_house_data.csv')","2d12a539":"df.head()","49b6c245":"df.isnull().sum()","e126462d":"plt.figure(figsize=(12,8))\nsns.distplot(df['price'])","d9d9451d":"plt.figure(figsize=(12,8))\nsns.countplot(df['bedrooms'])","5ab5a7fc":"plt.figure(figsize=(12,8))\nsns.scatterplot(x='price',y='sqft_living',data=df)","64b9be5c":"plt.figure(figsize=(12,8))\nsns.boxplot(x='bedrooms',y='price',data=df)","3740607d":"!pip install folium","02fe58e5":"import folium","e883f05a":"world_map=folium.Map()","ac91b7f2":"ofg=folium.map.FeatureGroup()\nfor lat,long in zip(df['lat'],df['long']):\n  ofg.add_child(folium.CircleMarker([lat,long],\n                                             radius=5,\n                                             colour='red',\n                                             fill_color='red'))\nworld_map.add_child(ofg) ","1880ac44":"plt.figure(figsize=(12,8))\nsns.scatterplot(x='long',y='price',data=df)","ca355c50":"plt.figure(figsize=(12,8))\nsns.scatterplot(x='lat',y='price',data=df)","c07f216f":"plt.figure(figsize=(20,20))\nsns.scatterplot(x='long',y='lat',data=df,hue='price',palette='coolwarm')","6b2d28ff":"df.sort_values('price',ascending=False).head(30)","eb6c85df":"len(df)","059a6b42":"len(df)*0.01","52fec539":"non_top1_percent=df.sort_values('price',ascending=False).iloc[216:]","96f1702a":"non_top1_percent","9327d043":"plt.figure(figsize=(20,20))\nsns.scatterplot(x='long',y='lat',data=non_top1_percent,edgecolor=None,alpha=0.2,hue='price',palette='RdYlGn')","fdae0e44":"plt.figure(figsize=(12,8))\nsns.boxplot(x='waterfront',y='price',data=non_top1_percent)","d7193745":"non_top1_percent.drop('id',axis=1,inplace=True)","69f5673d":"non_top1_percent['date']=pd.to_datetime(non_top1_percent['date'])","5e16c9de":"non_top1_percent","adaca511":"non_top1_percent['year']=non_top1_percent['date'].apply(lambda x:x.year)\nnon_top1_percent['month']=non_top1_percent['date'].apply(lambda x:x.month)","18bf0f9b":"non_top1_percent.head()","12b93887":"non_top1_percent.corr()['price'].sort_values(ascending=False)","c17ae71d":"non_top1_percent['current_year']=2020\nnon_top1_percent.head()","ffdc1739":"non_top1_percent['years_old']=non_top1_percent['current_year']-non_top1_percent['year']\nnon_top1_percent.head()","4e91a620":"non_top1_percent.corr()['price'].sort_values(ascending=False)","11b68767":"plt.figure(figsize=(12,8))\nsns.boxplot(x='month',y='price',data=non_top1_percent)","4c58811a":"plt.figure(figsize=(12,8))\nsns.boxplot(x='year',y='price',data=non_top1_percent)","935f3707":"non_top1_percent.groupby('month').mean()['price']","2beb93e8":"non_top1_percent.groupby('year').mean()['price']","ceb6a122":"plt.figure(figsize=(12,8))\nnon_top1_percent.groupby('month').mean()['price'].plot(color='red')","2c969fe9":"plt.figure(figsize=(12,8))\nnon_top1_percent.groupby('year').mean()['price'].plot(color='red')","2e2dc49f":"plt.figure(figsize=(12,8))\nnon_top1_percent.groupby('years_old').mean()['price'].plot(color='red')","dcfd4b1d":"non_top1_percent.drop(['date','current_year'],axis=1,inplace=True)","69b6f127":"non_top1_percent.head()","d0baadb9":"non_top1_percent['zipcode'].value_counts()","d63b6f96":"non_top1_percent['yr_renovated'].value_counts()","ceca9f8f":" non_top1_percent.drop('zipcode',axis=1,inplace=True)","a6ab05bd":"def yr_renovated_func(x):\n  if (x==0):\n    non_top1_percent['not_renovated']=0\n  else:\n    non_top1_percent['renovated']=1\nnon_top1_percent['yr_renovated'].apply(yr_renovated_func)","99713f8b":"non_top1_percent['yr_renovated'].value_counts()","fdcd9bd7":"non_top1_percent.head()","d82399b5":"non_top1_percent.columns","7b82b308":"non_top1_percent.drop('yr_renovated',axis=1,inplace=True)","05a430ba":"non_top1_percent.head()","7657f6ba":"# ","890b75bd":"from sklearn.model_selection import train_test_split\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense","3c7d0ddf":"X=non_top1_percent.drop('price',axis=1).values\ny=non_top1_percent['price'].values","35a42817":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.30, random_state=101)\nprint('training size',X_train.shape,y_train.shape)\nprint('test size',X_test.shape,y_test.shape)","cbfc1782":"from sklearn.preprocessing import MinMaxScaler\nscaler=MinMaxScaler()","cb3f8aca":"X_train=scaler.fit_transform(X_train)\nX_test=scaler.transform(X_test)","89ea08a6":"model=Sequential()\n\nmodel.add(Dense(21,activation='relu'))\nmodel.add(Dense(21,activation='relu'))\nmodel.add(Dense(21,activation='relu'))\nmodel.add(Dense(21,activation='relu'))\n\nmodel.add(Dense(1))\n\nmodel.compile(optimizer='adam',loss='mse')","c1ed109c":"model.fit(x=X_train,y=y_train,epochs=500,validation_data=(X_test,y_test),batch_size=128)","2aa43ef7":"losses=pd.DataFrame(model.history.history)","33d7e6af":"losses.head()","f63bf9ff":"plt.figure(figsize=(20,8))\nlosses.plot()","5a09b763":"print(X_test.shape)\npredict=model.predict(X_test)","386d861f":"predict","bc2d7fce":"model.evaluate(X_test,y_test)","660052a3":"from sklearn.metrics import mean_absolute_error,mean_squared_error,explained_variance_score","115d6d51":"print(' mean absolute error',mean_absolute_error(y_test,predict))\nprint(' mean squared error',mean_squared_error(y_test,predict))\nprint('explained_variance_score',explained_variance_score(y_test,predict))","f8b879cb":"plt.figure(figsize=(12,8))\nplt.scatter(y_test,predict)\nplt.plot(y_test,y_test,'-r')","7fa90b9e":"from tensorflow.keras.models import load_model","ee182d15":"model.save('kingcountry_houseprice.h5')","79d581f4":"**Removing outliers**","61c4fb48":"# **Evaluation And Prediction**","00008b49":"# **Model Training**","5c917bac":"# Feature Engineering","cccd4da2":"# We will remove top 1%","6316c3d8":"# **we see that our price range mostly from 1 to 3 lacs.So we can remove the outliers from our data**"}}