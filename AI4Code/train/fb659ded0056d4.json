{"cell_type":{"05d6226a":"code","ae6a3af3":"code","c58fab37":"code","7a10962c":"code","62cfc536":"code","8c71f29a":"code","0ea47c06":"code","02dd68ce":"code","4294538f":"code","d3131ef7":"code","b1fc6425":"code","d56be494":"code","e7d75843":"code","3f7ab56b":"code","7de4a283":"code","17feb6a1":"code","a03c000c":"code","978a5393":"code","a4d5fb70":"code","c2880683":"code","5a36ffb6":"code","3a16aec0":"code","759045e8":"code","c836ad38":"code","8998f633":"code","5263b210":"code","0f0aa687":"code","01fd8fab":"code","15619d56":"code","2a50a951":"code","e095fe2e":"code","090bfc7b":"markdown","f75eedb3":"markdown","e3226685":"markdown","5166105d":"markdown","2acc0a77":"markdown","2cda3945":"markdown","2483e355":"markdown","694f4da8":"markdown","23a04609":"markdown","e7305d64":"markdown","1db36fc7":"markdown","d8d34b40":"markdown","75dc5bca":"markdown","58bd1520":"markdown","2d5b151f":"markdown","8de5867c":"markdown","8598fe72":"markdown","517906e2":"markdown","3aea6384":"markdown","1d660d67":"markdown","69c0576a":"markdown","b787e706":"markdown","d527ff44":"markdown","b1bc2ccd":"markdown","dea5cfe4":"markdown","11777e5d":"markdown","e2d23e20":"markdown","6d83b0fc":"markdown"},"source":{"05d6226a":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot\nimport plotly.express as px\nimport plotly.graph_objects as go\nfrom plotly.subplots import make_subplots","ae6a3af3":"import os;\nos.listdir('\/kaggle\/input\/')","c58fab37":"df = pd.read_csv('..\/input\/nba-players-data\/all_seasons.csv')\ndf = df.drop(\"Unnamed: 0\", axis=1)","7a10962c":"print(\"El dataset cuenta con\", df.shape[1], \"columnas\")","62cfc536":"df[\"NAC_USA\"] = df[\"country\"]","8c71f29a":"localizacion = df[df[\"NAC_USA\"]!=\"USA\"].index\ndf.loc[localizacion,\"NAC_USA\"] = \"Extranjeros\"","0ea47c06":"df_2017 = df[df[\"season\"]==\"2016-17\"]\ndf_2018 = df[df[\"season\"]==\"2017-18\"]\ndf_2019 = df[df[\"season\"]==\"2018-19\"]\ndf_2020 = df[df[\"season\"]==\"2019-20\"]","02dd68ce":"seasons = [\"2016-17\",\"2017-18\", \"2018-19\",\"2019-20\"]","4294538f":"fig1 = make_subplots(rows = 2, cols = 2,\n                    subplot_titles = seasons) \n\n\n\nfig1.add_trace(\n     go.Histogram(x=df_2017.pts, name='2016\/17', marker_color='#17becf'),\n        row = 1, col = 1)\n\nfig1.add_trace(\n     go.Histogram(x=df_2018.pts, name='2017\/18', marker_color='#1f77b4'),\n        row = 1, col = 2)\n\nfig1.add_trace(\n     go.Histogram(x=df_2019.pts, name='2018\/19', marker_color='#636EFA'),\n        row = 2, col = 1)\n\nfig1.add_trace(\n     go.Histogram(x=df_2020.pts, name='2019\/20', marker_color='#00B5F7'),\n        row = 2, col = 2)\n\nfig1.update_layout(\n    title=\"Histograma de las medias de puntos de cada jugador por temporada\"\n)\n\nfig1.show()","d3131ef7":"df_evol = df.groupby(\"season\")[\"pts\", \"reb\",\"ast\"].mean()","b1fc6425":"fig = go.Figure()\nfig.add_trace(go.Scatter(\n                    x = df_evol.index,\n                    y = df_evol.pts,\n                    mode = \"lines\",\n                    name = \"puntos\",\n                    text= \"Puntos\"))\nfig.add_trace(go.Scatter(\n                    x = df_evol.index,\n                    y = df_evol.reb,\n                    mode = \"lines\",\n                    name = \"rebotes\",\n                    text= \"Rebotes\"))\nfig.add_trace(go.Scatter(\n                    x = df_evol.index,\n                    y = df_evol.ast,\n                    mode = \"lines\",\n                    name = \"asistencias\",\n                    text= \"Asistencias\"))\n\nfig.add_annotation(x=\"2009\", y=7.8,\n            text=\"Aqu\u00ed se experimenta una peque\u00f1a subida\",\n                  showarrow = False)\n\nfig.update_layout(\n    title=\"Evoluci\u00f3n de la media puntos, rebotes y asistencias\")\n\nfig.show()","d56be494":"df_filt = df[df[\"season\"].isin(seasons)]","e7d75843":"fig = go.Figure()\n\nfig.add_trace(go.Box(\n    y=df_filt.pts,\n    x=df_filt.season,\n    name='Puntos',\n    marker_color='#3D9970'\n))\nfig.add_trace(go.Box(\n    y=df_filt.ast,\n    x=df_filt.season,\n    name='Asistencias',\n    marker_color='#FF4136'\n))\nfig.add_trace(go.Box(\n    y=df_filt.reb,\n    x=df_filt.season,\n    name='Rebotes',\n    marker_color='#FF851B'\n))\n\nfig.update_layout(\n    title = \"Boxplots comparativos entre las variables para las 4 \u00faltimas temporadas\",\n    yaxis_title='Medias',\n    boxmode='group' \n)\nfig.show()","3f7ab56b":"fig = px.scatter(df_filt, x=\"ast\", y=\"pts\", color=\"season\",\n                 size='reb',hover_name=\"player_name\",trendline='ols')\n\nfig.add_annotation(x=10, y=34,\n            text=\"Los jugadores m\u00e1s destacados\",\n                  showarrow = False)\n\nfig.update_layout(\n    title=\"Comparaci\u00f3n estad\u00edstica por jugadores en las \u00faltimas 4 temporadas\",\n    xaxis=dict(\n        title='Asistencias',\n        titlefont_size=16,\n        tickfont_size=14,\n    ),\n    yaxis=dict(\n        title='Puntos',\n        titlefont_size=16,\n        tickfont_size=14,\n    ),\n    legend=dict(\n        x=0.02,\n        y=1.0,\n        bgcolor='rgba(255, 255, 255, 0)',\n        bordercolor='rgba(255, 255, 255, 0)'\n    )\n)\n\nfig.show()","7de4a283":"df[\"NAC_USA\"] = df[\"country\"]","17feb6a1":"localizacion = df[df[\"NAC_USA\"]!=\"USA\"].index\ndf.loc[localizacion,\"NAC_USA\"] = \"Extranjeros\"","a03c000c":"df_equipos = df_filt.groupby([\"team_abbreviation\",\"NAC_USA\"])[\"player_name\"].count().to_frame()\ndf_equipos.reset_index(inplace=True)  \ndf_equipos = df_equipos.pivot_table(values='player_name', index='team_abbreviation', columns='NAC_USA')\ndf_equipos = df_equipos.reset_index()\ndf_equipos[\"Total\"] = df_equipos[\"Extranjeros\"]+df_equipos[\"USA\"]\ndf_equipos = df_equipos.sort_values(\"Total\", ascending = False)","978a5393":"fig = go.Figure()\n\nfig.add_trace(go.Bar(x=df_equipos.team_abbreviation,\n                y=df_equipos.Total,\n                name='Total'\n                ))\nfig.add_trace(go.Bar(x=df_equipos.team_abbreviation,\n                y=df_equipos.USA,\n                name='Estadounidenses'\n                ))\nfig.add_trace(go.Bar(x=df_equipos.team_abbreviation,\n                y=df_equipos.Extranjeros,\n                name='Extranjeros'\n                ))\n\nfig.update_layout(\n    title=\"N\u00famero de jugadores estadounidenses y extranjeros de cada equipo las 4 \u00faltimas temporadas\",\n    xaxis_tickfont_size=14,\n    yaxis=dict(\n        title='Cantidad de jugadores',\n        titlefont_size=16,\n        tickfont_size=14,\n    ),\n    legend=dict(\n        x=0.8,\n        y=1.0,\n        bgcolor='rgba(255, 255, 255, 0)',\n        bordercolor='rgba(255, 255, 255, 0)'\n    ),\n    barmode='group'\n)\nfig.show()","a4d5fb70":"df_topjugadorespts = pd.DataFrame()\n\nfor i in seasons:\n    df_filtseason = df_filt[df_filt[\"season\"] == i]\n    df_topjugadorespts = df_topjugadorespts.append(df_filtseason.sort_values(\"pts\", ascending=False).iloc[:4]) #los 4 que m\u00e1s punt\u00faan de cada temporada","c2880683":"jugadores_top_pts = df_topjugadorespts.player_name.value_counts().iloc[:5].index.values #los que m\u00e1s aparecen\ndf_jugadores_pts = df_filt[df_filt[\"player_name\"].isin(jugadores_top_pts)]","5a36ffb6":"df_jugadores_pts = df_jugadores_pts.groupby([\"season\", \"player_name\"])[\"pts\"].mean().reset_index()\nfig = px.density_heatmap(df_jugadores_pts, \n                        y='player_name',\n                        x='season', \n                        z='pts', color_continuous_scale = 'Blues')\nfig.update_xaxes(side=\"bottom\")\nfig.update_layout(title=\"Jugadores m\u00e1s anotadores a lo largo de las \u00faltimas 4 temporadas\")\nfig.show()","3a16aec0":"df_topjugadoresast = pd.DataFrame()\n\nfor i in seasons:\n    df_filtseason = df_filt[df_filt[\"season\"] == i]\n    df_topjugadoresast = df_topjugadoresast.append(df_filtseason.sort_values(\"ast\", ascending=False).iloc[:4])","759045e8":"jugadores_top_ast = df_topjugadoresast.player_name.value_counts().iloc[:5].index.values #los que m\u00e1s aparecen\ndf_jugadores_ast = df_filt[df_filt[\"player_name\"].isin(jugadores_top_ast)]","c836ad38":"df_jugadores_ast = df_jugadores_ast.groupby([\"season\", \"player_name\"])[\"ast\"].mean().reset_index()\nfig = px.density_heatmap(df_jugadores_ast, \n                        y='player_name',\n                        x='season', \n                        z='ast', color_continuous_scale = 'Blues')\nfig.update_xaxes(side=\"bottom\")\nfig.update_layout(title=\"Jugadores m\u00e1s asistentes a lo largo de las \u00faltimas 4 temporadas\")\nfig.show()","8998f633":"import pycountry\n\ninput_countries = df[df[\"country\"]!='USA'].country.unique()\n\ncountries = {}\nfor country in pycountry.countries:\n    countries[country.name] = country.alpha_3\n\ncodes = [countries.get(country, 'Unknown code') for country in input_countries]","5263b210":"paises = pd.DataFrame(codes, df[df[\"country\"]!='USA'].country.unique()).reset_index()\npaises.columns = [\"country\", \"country_map\"]","0f0aa687":"df_mapa = df.groupby(\"country\")[\"pts\"].mean().to_frame().reset_index()\ndf_mapa.columns = [\"country\", \"media_pts\"]\ndf_mapa = df_mapa.merge(paises, on = \"country\", how=\"left\")","01fd8fab":"loc = df_mapa[df_mapa[\"country\"] == \"USA\"].index\ndf_mapa.loc[loc, \"country_map\"] = \"USA\"\ndf_mapa = df_mapa[df_mapa[\"country_map\"]!= \"Unknown code\"]","15619d56":"fig = px.choropleth(df_mapa, locations=\"country_map\",\n                    color=\"media_pts\", # lifeExp is a column of gapminder\n                    hover_name=\"country\", # column to add to hover information\n                    color_continuous_scale='GnBu')\n\nfig.update_layout(title=\"Mapa de los pa\u00edses de procedencia seg\u00fan la media de puntos\")\n\nfig.show()","2a50a951":"df_topjugadorespts = pd.DataFrame()\n\nfor i in seasons:\n    df_filtseason = df_filt[df_filt[\"season\"] == i]\n    df_topjugadorespts = df_topjugadorespts.append(df_filtseason.sort_values(\"pts\", ascending=False).iloc[:4]) #los 4 que m\u00e1s punt\u00faan de cada temporada\n\njugadores_top_pts = df_topjugadorespts.player_name.value_counts().iloc[:3].index.values #los que m\u00e1s aparecen\ndf_jugadores_pts = df_filt[df_filt[\"player_name\"].isin(jugadores_top_pts)]\n\ndf_jugadores_pts = df_jugadores_pts.groupby(\"player_name\")[\"pts\", \"reb\",\"ast\", \"net_rating\"].mean().reset_index()","e095fe2e":"fig = go.Figure()\n\nfig.add_trace(go.Scatterpolar(\n      r=df_jugadores_pts[df_jugadores_pts[\"player_name\"]==\"Anthony Davis\"].values[0][1:5],\n      theta=df_jugadores_pts.columns[1:5],\n      fill='toself',\n      name='Davis'\n))\nfig.add_trace(go.Scatterpolar(\n      r=df_jugadores_pts[df_jugadores_pts[\"player_name\"]==\"Giannis Antetokounmpo\"].values[0][1:5],\n      theta=df_jugadores_pts.columns[1:5],\n      fill='toself',\n      name='Giannis'\n)),\nfig.add_trace(go.Scatterpolar(\n      r=df_jugadores_pts[df_jugadores_pts[\"player_name\"]==\"James Harden\"].values[0][1:5],\n      theta=df_jugadores_pts.columns[1:5],\n      fill='toself',\n      name='Harden'\n))\n\nfig.update_layout(\n    title = \"Comparativa estad\u00edstica de los 3 mayores anotadores de la NBA\",\n  polar=dict(\n    radialaxis=dict(\n      visible=True,\n      range=[0, 35]\n    )),\n  showlegend=True\n)\n\nfig.show()","090bfc7b":"# Carga de los datos","f75eedb3":"**Conclusiones:**\nSe puede observar que la mayor parte de los jugadores tienen valores bastante bajos en cuanto a medias de puntos y asistencias. Esto a su vez no implica que tengan malos n\u00fameros reboteadores, ya que hay varios puntos con n\u00fameros altos en rebotes y bajos en las otras dos m\u00e9tricas. Este tipo de jugadores suelen ser pivots altos que destacan por el trabajo defensivo y no tanto por el ofensivo, en el cual destacan las otras dos variables. Las l\u00edneas de regresi\u00f3n de las 4 temporadas indican claramente que hay una relaci\u00f3n lineal positiva entre el n\u00famero de asistencias y el n\u00famero de puntos.","e3226685":"Dataset desde la temporada 96\/97 hasta la 2019\/2020 con todos los jugadores de la NBA","5166105d":"# Comparar los jugadores m\u00e1s anotadores y asistentes de las 4 \u00faltimas temporadas","2acc0a77":"# Gr\u00e1fico de ara\u00f1a para ver las estad\u00edsticas de los 3 mayores anotadores de los \u00faltimos 4 a\u00f1os","2cda3945":"Se cogen de cada una de las \u00faltimas 4 temporadas los 4 jugadores m\u00e1s anotadores","2483e355":"**Conclusiones:**\nSe puede observar que las medias de rebotes y asistencias se mantienen bastante estables a lo largo del tiempo. Sin embargo, se puede ver una ligera tendencia alcista en la media de puntos desde el 2004 hasta el 2009, aunque desde este a\u00f1o la media se ha ido reduciendo.","694f4da8":"#### Scatterplot","23a04609":"Se filtra el dataset por las \u00faltimas 4 temporadas para algunos de los gr\u00e1ficos","e7305d64":"## Librer\u00edas","1db36fc7":"**Conclusiones:**\nLa mayor parte de los jugadores se sit\u00faa en valores bajos de anotaci\u00f3n, donde las medias m\u00e1s concurridas suelen rondar entre los 5 y 8 puntos por partido. En la temporada 2018-19 destaca la escasez de jugadores con medias por encima de los 20 puntos, dado que en otras temporadas s\u00ed ocurre esto. En general las distribuciones son bastante similares.","d8d34b40":"## Gr\u00e1fico de barras del n\u00famero de jugadores por equipo en los \u00faltimos 4 a\u00f1os","75dc5bca":"https:\/\/www.kaggle.com\/justinas\/nba-players-data","58bd1520":"**Conclusiones:**\nEl n\u00famero total de jugadores por equipo es bastante parejo, aunque destaca portland por tener plantillas cortas y Memphis al contrario. En cuanto al n\u00famero de extranjeros en los equipos, Dallas, Utah, Phoenix y San Antonio han sido los equipos que mayor n\u00famero han tenido los \u00faltimos 4 a\u00f1os.","2d5b151f":"Link de Kaggle:","8de5867c":"#### Boxplots","8598fe72":"Se crea una nueva columna que describe si el jugador es extranjero o estadounidense:","517906e2":"**Conclusiones:**\nLas medianas y los cuartiles se mantienen bastante estables a lo largo de las \u00faltimas 4 temporadas. Destacan algunos outliers como el de un jugador en la 18\/19 que se ver\u00e1 m\u00e1s adelante.","3aea6384":"Se cogen de cada una de las \u00faltimas 4 temporadas los 4 jugadores m\u00e1s anotadores","1d660d67":"**Conclusiones:**\nEn este gr\u00e1fico est\u00e1n algo m\u00e1s repartidos los valores al no existir un outlier muy claro.","69c0576a":"## Comparaci\u00f3n entre las variables de puntos, asistencias y rebotes","b787e706":"**Conclusiones:**\nEs muy curioso como los jugadores de pa\u00edses europeos tienen medias bastante altas en comparaci\u00f3n con los jugadores estadounidenses. Esto significa que cuando se fichan jugadores europeos se trata de estrellas que luego tienen un gran impacto en la liga.","d527ff44":"**Conclusiones:**\nLos 5 jugadores tienen medias muy altas. Destaca James Harden, el jugador del outlier que se ha identificado al comienzo en los boxplots.","b1bc2ccd":"# Mapa de los pa\u00edses de procedencia seg\u00fan la media de puntos","dea5cfe4":"## Line plot con la evoluci\u00f3n de medias de varias variables","11777e5d":"Esta vez s\u00ed que vamos a ver la evoluci\u00f3n en todo el dataframe","e2d23e20":"## Histograma con las medias de puntos de cada jugador en cada temporada","6d83b0fc":"**Conclusiones:**\nLos 3 jugadores tienen medias muy elevadas en cualquiera de las estad\u00edsticas, pero Harden se diferencia de los dos anteriores por su alta media de puntuaci\u00f3n. Davis y Giannis son quiz\u00e1s m\u00e1s commpletos, ya que capturan muchos rebotes, pero Harden tambi\u00e9n destaca por encima de ambos en cuanto a asistencias, por lo que se trata de un perfil muy distinto. Cabe destacar que Giannis es el que mayor impacto positivo tiene en su equipo, dado que tiene el mayor valor en la variable net_rating, que describe la diferencia de puntos a favor o en contra en 100 posesiones con el jugador sobre el campo."}}