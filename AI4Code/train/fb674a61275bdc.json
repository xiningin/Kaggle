{"cell_type":{"700b7579":"code","d0600683":"code","a7ea189e":"code","cdd8c83c":"code","04c45f8d":"code","14fe70d6":"code","f1c2928e":"code","84b10a16":"code","8cda9a8b":"code","1c180b2f":"code","469426b7":"markdown","3123f7d6":"markdown"},"source":{"700b7579":"import os\nimport datetime as dt\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt","d0600683":"input_dir = \"..\/input\"\nexamples_dir = os.path.join(input_dir,'cv-data-augmentation-network-predictors-1')\nexamples = pd.read_parquet(os.path.join(examples_dir,'positive_negative_examples.parquet.gzip'))","a7ea189e":"examples.shape","cdd8c83c":"examples.sample(10)","04c45f8d":"network_predictors_2_dir = os.path.join(input_dir,'cv-feature-engineering-network-predictors-2')\nprint(os.listdir(network_predictors_2_dir))","14fe70d6":"network_statistics_names = ['questioners_answerers_paths', 'commenters_questioners_paths', 'commenters_answerers_paths']\n\nfor network_statistics_name in network_statistics_names:     \n    print('Considering: {}'.format(network_statistics_name))\n\n    network_statistics = pd.read_parquet(os.path.join(network_predictors_2_dir,'{}.parquet.gzip'.format(network_statistics_name)))\n\n    print(network_statistics.shape)\n    print(network_statistics.sample(3))\n\n    examples = examples.merge(network_statistics, \n                              left_on=['emails_date', 'questions_author_id', 'answer_user_id'],\n                              right_on=network_statistics.columns[[0,2,3]].values.tolist(),\n                              how='left')\n    examples = examples.drop(network_statistics.columns[[0,2,3]].values.tolist(), axis=1)\n\n    examples = examples.merge(network_statistics, \n                              left_on=['emails_date', 'questions_author_id', 'answer_user_id'],\n                              right_on=network_statistics.columns[[0,3,2]].values.tolist(),\n                              how='left')\n    examples = examples.drop(network_statistics.columns[[0,3,2]].values.tolist(), axis=1)\n    examples[network_statistics.columns[1]] = examples['{}_x'.format(network_statistics.columns[1])].add(\n        examples['{}_y'.format(network_statistics.columns[1])], fill_value=0) \n    examples = examples.drop(['{}_x'.format(network_statistics.columns[1]),\n                              '{}_y'.format(network_statistics.columns[1])], axis=1)\n    \n    print('Non empty rows: {}'.format(examples[~pd.isnull(examples[network_statistics.columns[1]])].shape))\n    print(examples.sample(10))\n    examples[network_statistics.columns[1]] =examples[network_statistics.columns[1]].fillna(0)","f1c2928e":"examples.shape","84b10a16":"examples.sample(10)","8cda9a8b":"examples.to_parquet('positive_negative_examples.parquet.gzip', compression='gzip')","1c180b2f":"os.listdir()","469426b7":"# I. Loading Supevised Machine Learning Data Set ##","3123f7d6":"# II. Loading Network Predictors 2 and Merging Them to the Data Set ##"}}