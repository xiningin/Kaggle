{"cell_type":{"0d693d10":"code","77ffa4cf":"code","2fe2b4c9":"code","0af8bc7f":"code","53c83678":"code","2bfbe5a8":"code","c62aa4e5":"code","4f810d4d":"code","5e4a48df":"code","c62a5ba1":"code","874ce057":"code","7fb88f4e":"code","c37bcd2d":"code","dab945d0":"code","74b1da16":"code","62603e7b":"code","dd08ed98":"code","cfa431f1":"code","213d4148":"code","143a78fc":"markdown","c4509594":"markdown","051a80ef":"markdown","28e03844":"markdown","a8c0e6df":"markdown","1ed8a517":"markdown","688df51f":"markdown","227a28d2":"markdown","3b7c1b37":"markdown","53d8cb7e":"markdown","9c8eca04":"markdown","bbf8e001":"markdown","b97f4b08":"markdown","8ebe04fb":"markdown","b3beb8c4":"markdown","508140c0":"markdown","9faafb62":"markdown","fe4a486e":"markdown","dd2ff982":"markdown","7751074c":"markdown","b3f9043f":"markdown","c462c664":"markdown","37464a0c":"markdown"},"source":{"0d693d10":"import numpy as np\nimport pandas as pd \nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        if 'User' in filename or 'Data' in filename:\n            print(os.path.join(dirname, filename))","77ffa4cf":"achievements = pd.read_csv('\/kaggle\/input\/meta-kaggle\/UserAchievements.csv')\nachievements.head()","2fe2b4c9":"np.unique(achievements.AchievementType), sorted(np.unique(achievements.Tier))","0af8bc7f":"from copy import deepcopy as dc\ndef get_users_all_level(tier=0):\n    ach = dc(achievements)\n    if tier < 5: #in this case we remove kaggle team\n        ach = ach.loc[ach.Tier < 5]\n    d = ach.loc[(ach.Tier>=tier) & (ach.AchievementType=='Discussion'), 'UserId'].values.tolist()\n    c = ach.loc[(ach.Tier>=tier) & (ach.AchievementType=='Competitions'), 'UserId'].values.tolist()\n    s = ach.loc[(ach.Tier>=tier) & (ach.AchievementType=='Scripts'), 'UserId'].values.tolist()\n    return [user for user in c if user in d and user in s]","53c83678":"print(f'We have {len(get_users_all_level(tier=2))} experts in 3, {len(get_users_all_level(tier=3))} masters in 3 and only {len(get_users_all_level(tier=4))} grandmasters in 3 !')\ninterest_users = get_users_all_level(tier=2)","2bfbe5a8":"users = pd.read_csv('\/kaggle\/input\/meta-kaggle\/Users.csv')\nusers.columns = ['UserId', 'UserName', 'DisplayName', 'RegisterDate', 'PerformanceTier']\nusers = users.loc[users.PerformanceTier>0]\nusers.sample(5)","c62aa4e5":"users.loc[users.UserId.isin(interest_users)].sample(10)","4f810d4d":"users.loc[users.UserName=='louise2001']","5e4a48df":"my_userid = users.loc[users.UserName=='louise2001', 'UserId'].values[0]\nmy_userid in interest_users","c62a5ba1":"total = pd.read_csv('\/kaggle\/input\/meta-kaggle\/Users.csv').shape[0]\nnovices = total - users.shape[0]\ncontributors = users.loc[users.PerformanceTier==1].shape[0]\nexperts = users.loc[users.PerformanceTier==2].shape[0]\nmasters = users.loc[users.PerformanceTier==3].shape[0]\ngrandmasters  = users.loc[users.PerformanceTier==4].shape[0]\nkaggle_team = users.loc[users.PerformanceTier==5].shape[0]\nprint(f'Out of a total of {total} registered Kaggle users, we have :')\nprint(f'{novices} novices ({round(novices\/total*100,3)}%)')\nprint(f'{contributors} contributors ({round(contributors\/total*100,3)}%)')\nprint(f'{experts} experts ({round(experts\/total*100,3)}%)')\nprint(f'{masters} masters ({round(masters\/total*100,3)}%)')\nprint(f'{grandmasters} grandmasters ({round(grandmasters\/total*100,3)}%)')\nprint(f'{kaggle_team} Kaggle Team ({round(kaggle_team\/total*100,3)}%)')","874ce057":"data_votes = pd.read_csv('\/kaggle\/input\/meta-kaggle\/DatasetVotes.csv')\ndata_votes = data_votes.loc[data_votes.UserId.isin(users.UserId.values)]\ndata_votes.sample(5)","7fb88f4e":"datasets = pd.read_csv('\/kaggle\/input\/meta-kaggle\/Datasets.csv')\ndatasets.columns = ['DatasetId', 'CreatorUserId', 'OwnerUserId', 'OwnerOrganizationId',\n       'CurrentDatasetVersionId', 'CurrentDatasourceVersionId', 'ForumId',\n       'Type', 'CreationDate', 'ReviewDate', 'FeatureDate', 'LastActivityDate',\n       'TotalViews', 'TotalDownloads', 'TotalVotes', 'TotalKernels']\ndatasets = datasets.loc[(datasets['TotalVotes']>=5) & (datasets['CreatorUserId'].isin(interest_users)), ['DatasetId', 'CreatorUserId',\n       'CurrentDatasetVersionId', 'CurrentDatasourceVersionId', 'CreationDate', 'TotalVotes']]\ndatasets.sample(5)","c37bcd2d":"interest_users[:] = [user for user in interest_users if datasets.loc[datasets.CreatorUserId==user].shape[0]>=3]\nlen(interest_users)","dab945d0":"datasets = datasets.loc[datasets.CreatorUserId.isin(interest_users)]\ndatasets","74b1da16":"datasets = datasets.merge(data_votes, left_on='CurrentDatasetVersionId', right_on = 'DatasetVersionId')\ndatasets","62603e7b":"datasets = datasets.loc[datasets.CreatorUserId != datasets.UserId]\ndatasets","dd08ed98":"size = datasets.groupby(['DatasetId']).size()\nsize = size[size>=5]\ndatasets = datasets.loc[datasets['DatasetId'].isin(size.index)]\ndataset_experts = np.unique(datasets.CreatorUserId.values)","cfa431f1":"interest_users[:] = [user for user in interest_users if user in dataset_experts]\nlen(interest_users)","213d4148":"my_userid in interest_users","143a78fc":"We can now use this to count only votes cast by non-novices :","c4509594":"Let's now take a look at the datasets. We are only interested in datasets with at least 5 votes, and created by our interest_users :","051a80ef":"Sadly, we don't have, for each `DatasetId`, the list of all its `DatasetVersionId`. Therefore we can only match votes that have been made on the latest version of a dataset... We might miss a lot of people, unfortunately.","28e03844":"For **Discussion, Kernels, and Competitions** it's actually quite easy, but we will see that it gets a lot trickier with **Datasets**, since we are missing some information (we don't have, for each dataset id, the list of all its version ids, what prevents us from matching a dataset with all its upvotes, only with the upvotes on the latest version). So please, Kaggle Team, add this information !","a8c0e6df":"So in the end, we get only 51 of them... note that it could be very underestimated since we cannot have, for each `DatasetId`, the list of all its `DatasetVersionId`, therefore we can only match votes cast on the latest version of a dataset.","1ed8a517":"Here, you can notice the core of the problem : we have the `DatasetVersionId` of each vote, not the `DatasetId`, which will make it impossible to match exactly.","688df51f":"Here I am !","227a28d2":"Here I am !","3b7c1b37":"We just have to substract datasets that have at least 5 votes :","53d8cb7e":"Now, let's take only `UserId` that are at least expert (`Tier>=2`) in all 3 categories present in `achievements` : ","9c8eca04":"To filter these `interest_users`, we first need to get the legitimate upvoters on their datasets : non-novice users.","bbf8e001":"There are 254 users who are expert or more in all 3 categories Competitions, Discussion and Script !","b97f4b08":"Looking for me...","8ebe04fb":"Look at how many users achieved a given level in all 3 categories Discussion, Competition and Kernels. We are interested in people who are at least 3x expert.","b3beb8c4":"Now let's look for those among them who are also Dataset experts. That's more tricky. In order to do this, we will look at the datasets published by those users. To get Dataset expert you need at least 3 bronze medals in datasets, that means at least 3 datasets with at least 5 non-novice and non-self votes.","508140c0":"## Hi everyone from Kaggle !","9faafb62":"Wow, we only have 53 candidates left ! Let's refilter `datasets` on those users, so that it's easier to process in the following steps.","fe4a486e":"Let's take a look at who these `interest_users` are :","dd2ff982":"Remove self votes : ","7751074c":"# Thanks for reading, hope you found it interesting !","b3f9043f":"What we can already do is filter out all `interest_users` that don't have at least 3 datasets with at least 5 votes each, since they can't be Datasets expert. Note : that doesn't guarantee that those who remain actually are dataset experts, since there could be votes cast by themselves or by novices, but that's a first step.","c462c664":"In this notebook, I will try to find out how many people have achieved the expert level (`tier=2`) in all 4 categories, that is to say, **Discussion, Kernels, Datasets and Competitions**.","37464a0c":"Let's first take a look at the users achievements :"}}