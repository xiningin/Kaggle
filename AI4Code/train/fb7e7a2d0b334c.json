{"cell_type":{"20d00f1b":"code","5eadf174":"code","f691392d":"code","f7384817":"code","ed0344d1":"code","7d4ef0f7":"code","b80e3dce":"code","1eb3848c":"code","16e05260":"code","67920662":"code","c8151479":"code","7d6c0501":"code","1dcceaab":"code","de4fd127":"code","83d5b1c8":"code","83374588":"code","c95048f4":"markdown","dfa692d9":"markdown","e9803f97":"markdown","67410466":"markdown","8e00601f":"markdown","6defb7f4":"markdown","41e9f132":"markdown"},"source":{"20d00f1b":"## define configuration\nPATH_TRAIN = '..\/input\/tabular-playground-series-jun-2021\/train.csv'\nPATH_TEST = '..\/input\/tabular-playground-series-jun-2021\/test.csv'\n\nPATH_AUTOSKLEARN_SUBMISSION = 'submission_autosklearn.csv'\nPATH_H2OAML_SUBMISSION = 'submission_h2oaml.csv'","5eadf174":"## install package\n!curl https:\/\/raw.githubusercontent.com\/automl\/auto-sklearn\/master\/requirements.txt | xargs -n 1 -L 1 pip3 install\n!pip3 install auto-sklearn","f691392d":"## import packages\nimport pandas as pd\n\nfrom autosklearn.classification import AutoSklearnClassifier\nfrom autosklearn.metrics import log_loss","f7384817":"## prepare data\ntrain = pd.read_csv(PATH_TRAIN)\ntest = pd.read_csv(PATH_TEST)\n\ntarget = train.target.values\ntrain.drop(['id', 'target'], axis=1, inplace=True)","ed0344d1":"## run model\nautosklearnml = AutoSklearnClassifier(\n    time_left_for_this_task=2000,\n    metric=log_loss,\n    scoring_functions=[log_loss]\n)\n\nautosklearnml.fit(X=train, y=target, dataset_name='tps_jun_2021')","7d4ef0f7":"## check statistics\nprint(autosklearnml.sprint_statistics())","b80e3dce":"## generate predictions\npreds_autosklearnml = autosklearnml.predict_proba(test[train.columns])","1eb3848c":"## create submission\nsubmission = pd.concat([\n    pd.DataFrame({'id': test.id}),\n    pd.DataFrame(preds_autosklearnml, columns=autosklearnml.classes_)\n], axis=1)\n\nsubmission.head()","16e05260":"## save submission\nsubmission.to_csv(PATH_AUTOSKLEARN_SUBMISSION, index=False)","67920662":"## import packages\nimport pandas as pd\n\nimport h2o\nfrom h2o.automl import H2OAutoML","c8151479":"## prepare data\nh2o.init()\n\nh2o_train = h2o.import_file(PATH_TRAIN)\nh2o_test = h2o.import_file(PATH_TEST)\n\nh2o_train['target'] = h2o_train['target'].asfactor()","7d6c0501":"## run model\nfeatures = [x for x in h2o_train.columns if x not in ['id', 'target']]\n\nh2oaml = H2OAutoML(\n    max_runtime_secs=2000,\n    stopping_metric='logloss',\n    sort_metric='logloss'\n)\n\nh2oaml.train(x=features, y='target', training_frame=h2o_train)","1dcceaab":"## check leaderboard\nh2oaml.leaderboard","de4fd127":"## generate predictions\npreds_h2oaml = h2oaml.leader.predict(h2o_test)","83d5b1c8":"## create submission\nsubmission = pd.concat([\n    pd.DataFrame({'id': h2o_test['id'].as_data_frame().id}),\n    preds_h2oaml.as_data_frame().drop('predict', axis=1)\n], axis=1)\n\nsubmission.head()","83374588":"## save submission\nsubmission.to_csv(PATH_H2OAML_SUBMISSION, index=False)","c95048f4":"This is just a baseline submission over which a lot of improvements can be made. You can read more about Auto-Sklearn's workflow, settings, hyperparameters, optimizations and more here:\n\n* [Documentation of auto-sklearn](https:\/\/automl.github.io\/auto-sklearn)\n* [Deep dive of auto-sklearn](https:\/\/github.com\/vopani\/fortyone#automl-series-)","dfa692d9":"<div align='center'>\n    <h1>AutoML Tutorial<\/h1>\n    <img src='https:\/\/github.com\/vopani\/fortyone\/blob\/main\/images\/automl_banner_530_x_455.png?raw=true'>\n<\/div>","e9803f97":"## Similar Tutorials\nSimilar tutorials on other Kaggle TPS competitions are published here:\n\n* [AutoML Tutorial: TPS (January 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-january-2021)\n* [AutoML Tutorial: TPS (February 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-february-2021)\n* [AutoML Tutorial: TPS (March 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-march-2021)\n* [AutoML Tutorial: TPS (April 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-april-2021)\n* [AutoML Tutorial: TPS (May 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-may-2021)","67410466":"This is just a baseline submission over which a lot of improvement can be made. You can read more about H2O AutoML's workflow, settings, hyperparameters, interpretability and more here:\n\n* [Documentation of H2O AutoML](https:\/\/docs.h2o.ai\/h2o\/latest-stable\/h2o-docs\/automl.html)\n* [Deep dive of H2O AutoML](https:\/\/github.com\/vopani\/fortyone#automl-series-)","8e00601f":"## Auto-Sklearn\n[auto-sklearn](https:\/\/automl.github.io\/auto-sklearn) is an automated machine learning toolkit and a drop-in replacement for a scikit-learn estimator","6defb7f4":"**Auto**mated **M**achine **L**earning (**AutoML**) has become widely adopted for building, experimenting and productionizing various types of machine learning models across business use-cases.\n\nThere are different open source solutions available and this notebook explores a simple baseline solution for some of them on the [Kaggle TPS (June 2021) competition](https:\/\/www.kaggle.com\/c\/tabular-playground-series-jun-2021).\n\n* [Auto-Sklearn](#Auto-Sklearn)\n* [H2O AutoML](#H2O-AutoML)","41e9f132":"## H2O AutoML\n<img src='https:\/\/docs.h2o.ai\/h2o\/latest-stable\/h2o-docs\/_images\/h2o-automl-logo.jpg' width='150px'>\n\n[H2O AutoML](https:\/\/www.h2o.ai\/products\/h2o-automl) is an automated machine learning library open sourced by [H2O.ai](https:\/\/h2o.ai)"}}