{"cell_type":{"825389e0":"code","401a14df":"code","68765c85":"code","81cc94cb":"code","c2395d52":"code","d8bea501":"code","4bb0498c":"code","72bdc877":"code","af654e1b":"code","da5fe1fd":"code","37d947f8":"code","c44ca50e":"code","14605498":"code","106075c4":"code","c9fb8da4":"code","074fc1b0":"code","eaa37276":"code","a4845f75":"code","11948ea8":"code","edd03c1d":"code","6129abcc":"code","7316222d":"code","d0d246dc":"code","5d853333":"code","e333632d":"code","a46476f6":"code","6c254da7":"code","9eea281e":"code","832deb3c":"code","38c6993d":"code","9720c0eb":"code","49a51807":"code","c114af75":"code","f87cc396":"code","b00f99bc":"code","b656afbb":"code","aaeff78c":"code","8dec57ae":"code","13b25805":"code","1710bbc3":"code","907f3b88":"code","ca436075":"code","a8f41971":"code","8f24e061":"code","1ae52a54":"code","9b0b9880":"code","f7d2946a":"code","459156cd":"code","27f34f9b":"code","f99cd8ea":"code","434e895b":"code","63579a69":"code","14b14a6f":"code","89889220":"code","c12e937b":"code","79dcdc36":"code","cdb84572":"code","6ae5174f":"code","21706935":"code","5bee1435":"code","fc63b1df":"code","199d4315":"markdown","9770c1b8":"markdown","296908c9":"markdown","0c64d728":"markdown","45b0ea00":"markdown","ed5ae2af":"markdown","1ae137aa":"markdown","3a99cdcd":"markdown","6de8e7e2":"markdown","0868a1e1":"markdown","3b9870b9":"markdown","5a9dba96":"markdown","b934e10e":"markdown","8c9cb945":"markdown","f6e413dc":"markdown","29be570c":"markdown","a7b9cdc8":"markdown","9ca94c3a":"markdown","0795e500":"markdown","5bbdc0cc":"markdown","82dd5a21":"markdown","e3efb10d":"markdown","c8473c76":"markdown","81fbb8ec":"markdown","5b9230a7":"markdown","6fb50bd5":"markdown","18747b9f":"markdown","546367ce":"markdown","87c04763":"markdown","e164b89c":"markdown","7a94f1e9":"markdown","47bc3976":"markdown","38cd530a":"markdown","db83fc35":"markdown","9eea03e5":"markdown","1635a7cc":"markdown","a6c73d7c":"markdown","a6cd71b0":"markdown","9c04ead2":"markdown","6eb31b6e":"markdown","3054724a":"markdown","92b4a751":"markdown","29897edd":"markdown","9d01412c":"markdown","f3d7b644":"markdown","1a3bab42":"markdown","5286f407":"markdown","deabeb6f":"markdown","df6e79e3":"markdown","f3810b26":"markdown","cd1a5e0f":"markdown","f35438e5":"markdown","9c0557df":"markdown","aede8147":"markdown","0c69b357":"markdown","ddc41cca":"markdown","aee7d814":"markdown","9936384b":"markdown","62e23b59":"markdown","a2fa55d3":"markdown","df72621f":"markdown","986c9a0b":"markdown","892b85a2":"markdown","b83c61b2":"markdown"},"source":{"825389e0":"import warnings\nwarnings.filterwarnings(\"ignore\") \nimport time\nfrom datetime import datetime\nimport math\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom matplotlib import ticker \nimport pycountry_convert as pc\nimport folium\nimport missingno as msno\nfrom datetime import datetime,date\nfrom scipy.interpolate import make_interp_spline, BSpline\n%matplotlib inline\nfrom sklearn.model_selection import KFold\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.metrics import mean_absolute_error","401a14df":"data_confirmed_cases= pd.read_csv('\/kaggle\/input\/india-covid19-cases-till-date\/India_covid19_deaths_data.csv')","68765c85":"data_confirmed_cases","81cc94cb":"data_confirmed_cases.columns","c2395d52":"data_confirmed_cases.info()","d8bea501":"data_confirmed_cases.dtypes","4bb0498c":"data_confirmed_cases.describe()","72bdc877":"data_deaths=pd.read_csv('\/kaggle\/input\/india-covid19-cases-till-date\/India_covid19_confirmed_cases_data.csv')","af654e1b":"data_deaths.head()","da5fe1fd":"data_deaths.columns","37d947f8":"data_deaths.info()","c44ca50e":"data_deaths.dtypes","14605498":"data_deaths.describe()","106075c4":"df_confirmed = data_confirmed_cases.rename(columns={\"Province\/State\":\"state\",\"Country\/Region\": \"country\"})\ndf_deaths = data_deaths.rename(columns={\"Province\/State\":\"state\",\"Country\/Region\": \"country\"})","c9fb8da4":"countries = np.asarray(df_confirmed[\"country\"])\ncountries","074fc1b0":"continents = {\n    'NA': 'North America',\n    'SA': 'South America', \n    'AS': 'Asia',\n    'OC': 'Australia',\n    'AF': 'Africa',\n    'EU' : 'Europe',\n    'na' : 'Others'\n}","eaa37276":"def country_to_continent_code(country):\n    try:\n        return pc.country_alpha2_to_continent_code(pc.country_name_to_country_alpha2(country))\n    except :\n        return 'na'","a4845f75":"df_confirmed = df_confirmed.replace(np.nan, '', regex=True)\ndf_deaths = df_deaths.replace(np.nan, '', regex=True)","11948ea8":"def plot_params(ax,axis_label= None, plt_title = None,label_size=15, axis_fsize = 15, title_fsize = 20, scale = 'linear' ):\n    # Tick-Parameters\n    ax.xaxis.set_minor_locator(ticker.AutoMinorLocator())\n    ax.yaxis.set_minor_locator(ticker.AutoMinorLocator())\n    ax.tick_params(which='both', width=1,labelsize=label_size)\n    ax.tick_params(which='major', length=6)\n    ax.tick_params(which='minor', length=3, color='0.8')\n\n    # Grid\n    plt.grid(lw = 1, ls = '-', c = \"0.7\", which = 'major')\n    plt.grid(lw = 1, ls = '-', c = \"0.9\", which = 'minor')\n\n    # Plot Title\n    plt.title( plt_title,{'fontsize':title_fsize})\n    \n    # Yaxis sacle\n    plt.yscale(scale)\n    \n    # Plot Axes Labels\n    xl = plt.xlabel(axis_label[0],fontsize = axis_fsize)\n    yl = plt.ylabel(axis_label[1],fontsize = axis_fsize)\n    \ndef visualize_covid_cases(confirmed, deaths, continent=None , country = None , state = None, period = None, figure = None, scale = \"linear\"):\n    x = 0\n    if figure == None:\n        f = plt.figure(figsize=(10,10))\n        # Sub plot\n        ax = f.add_subplot(111)\n    else :\n        f = figure[0]\n        # Sub plot\n        ax = f.add_subplot(figure[1],figure[2],figure[3])\n    \n    plt.tight_layout(pad=10, w_pad=5, h_pad=5)\n    \n    stats = [confirmed, deaths]\n    label = [\"Confirmed\", \"Deaths\"]\n    \n    if continent != None:\n        params = [\"continent\",continent]\n    elif country != None:\n        params = [\"country\",country]\n    else: \n        params = [\"All\", \"All\"]\n\n    for i,stat in enumerate(stats):\n        if params[1] == \"All\" :\n            cases = np.sum(np.asarray(stat.iloc[:,5:]),axis = 0)[x:]\n        else :\n            cases = np.sum(np.asarray(stat[stat[params[0]] == params[1]].iloc[:,5:]),axis = 0)[x:]\n        date = np.arange(1,cases.shape[0]+1)[x:]\n        plt.plot(date,cases,label = label[i]+\" (Total : \"+str(cases[-1])+\")\")\n\n    if params[1] == \"All\" :\n        Total_confirmed = np.sum(np.asarray(stats[0].iloc[:,5:]),axis = 0)[x:]\n        Total_deaths = np.sum(np.asarray(stats[1].iloc[:,5:]),axis = 0)[x:]\n        \n    else :\n        Total_confirmed =  np.sum(np.asarray(stats[0][stat[params[0]] == params[1]].iloc[:,5:]),axis = 0)[x:]\n        Total_deaths = np.sum(np.asarray(stats[1][stat[params[0]] == params[1]].iloc[:,5:]),axis = 0)[x:]\n      \n        \n    text = \"From \"+stats[0].columns[4]+\" to \"+stats[0].columns[-2]+\"\\n\"\n    text += \"Mortality rate : \"+ str(int(Total_deaths[-1]\/(Total_confirmed[-1])*10000)\/100)+\"\\n\"\n    text += \"Last 5 Days:\\n\"\n    text += \"Confirmed : \" + str(Total_confirmed[-1] - Total_confirmed[-6])+\"\\n\"\n    text += \"Deaths : \" + str(Total_deaths[-1] - Total_deaths[-6])+\"\\n\"\n    text += \"Last 24 Hours:\\n\"\n    text += \"Confirmed : \" + str(Total_confirmed[-1] - Total_confirmed[-2])+\"\\n\"\n    text += \"Deaths : \" + str(Total_deaths[-1] - Total_deaths[-2])+\"\\n\"\n    \n    plt.text(0.02, 0.78, text, fontsize=14, horizontalalignment='left', verticalalignment='top', transform=ax.transAxes,bbox=dict(facecolor='white', alpha=0.4))\n    \n    # Plot Axes Labels\n    axis_label = [\"Days (\"+df_confirmed.columns[5]+\" - \"+df_confirmed.columns[-1]+\")\",\"No of Cases\"]\n    \n    # Plot Parameters\n    plot_params(ax,axis_label,scale = scale)\n    \n    # Plot Title\n    if params[1] == \"All\" :\n        plt.title(\"COVID-19 Cases World\",{'fontsize':25})\n    else:   \n        plt.title(\"COVID-19 Cases for \"+params[0]+\" \"+params[1] ,{'fontsize':25})\n        \n    # Legend Location\n    l = plt.legend(loc= \"best\",fontsize = 13)\n    \n    if figure == None:\n        plt.show()\n        \ndef get_total_cases(cases, country = \"All\"):\n    if(country == \"All\") :\n        return np.sum(np.asarray(cases.iloc[:,5:]),axis = 0)[-1]\n    else :\n        return np.sum(np.asarray(cases[cases[\"country\"] == country].iloc[:,5:]),axis = 0)[-1]\n    \ndef get_mortality_rate(confirmed,deaths, continent = None, country = None):\n    if continent != None:\n        params = [\"continent\",continent]\n    elif country != None:\n        params = [\"country\",country]\n    else :\n        params = [\"All\", \"All\"]\n    \n    if params[1] == \"All\" :\n        Total_confirmed = np.sum(np.asarray(confirmed.iloc[:,5:]),axis = 0)\n        Total_deaths = np.sum(np.asarray(deaths.iloc[:,5:]),axis = 0)\n        mortality_rate = np.round((Total_deaths\/Total_confirmed)*100,2)\n    else :\n        Total_confirmed =  np.sum(np.asarray(confirmed[confirmed[params[0]] == params[1]].iloc[:,5:]),axis = 0)\n        Total_deaths = np.sum(np.asarray(deaths[deaths[params[0]] == params[1]].iloc[:,5:]),axis = 0)\n        mortality_rate = np.round((Total_deaths\/Total_confirmed)*100,2)\n    \n    return np.nan_to_num(mortality_rate)\ndef dd(date1,date2):\n    return (datetime.strptime(date1,'%m\/%d\/%y') - datetime.strptime(date2,'%m\/%d\/%y')).days","edd03c1d":"confirmed_cases =  df_confirmed.groupby([\"country\"]).sum().drop(['Lat','Long'],axis =1).iloc[:,-1]\ndeaths = df_deaths.groupby([\"country\"]).sum().drop(['Lat','Long'],axis =1).iloc[:,-1]\n\nconfirmed_cases.name = \"Confirmed Cases\"\ndeaths.name = \"Deaths Reported\"\ndf_countries_cases = pd.DataFrame([confirmed_cases,deaths]).transpose()","6129abcc":"rows = 4\nf = plt.figure(figsize=(15,10*rows))\n\nstats = [df_confirmed,df_deaths]\nlabel = [\"Confirmed\",\"Deaths\"]\nthreshold = [1500,100]\nfor i, stat in enumerate(stats):\n    plt.tight_layout()\n    df_countries = stat.groupby([\"country\"]).sum()\n    df_countries = df_countries.sort_values(df_countries.columns[-1],ascending= False)\n    others = df_countries[df_countries[df_countries.columns[-1]] < threshold[i] ].sum()[-1]\n    df_countries = df_countries[df_countries[df_countries.columns[-1]] > threshold[i]]\n    df_countries = df_countries[df_countries.columns[-1]]\n    labels = [df_countries.index[i] +\" (\" + str(int(df_countries[i])) +\") \"for i in range(df_countries.shape[0])]\n\n    ax = f.add_subplot(rows,1,i+1)\n    plt.pie(df_countries, labels=labels,autopct='%1.1f%%',pctdistance=0.85, labeldistance=1.1,textprops = {'fontsize':10.5})\n    my_circle=plt.Circle( (0,0), 0.7, color='white')\n    p=plt.gcf()\n    p.gca().add_artist(my_circle)\n    plt.text(0.5,0.5,\"Total India \"+label[i]+ \" Cases\\n\"+str(get_total_cases(stat)), horizontalalignment='center',verticalalignment='center',transform=ax.transAxes, size=18, alpha = 0.6)\n\n\nplt.show()\n","7316222d":"pd.DataFrame(df_countries_cases.sum()).transpose().style.background_gradient(cmap='Wistia',axis=1)","d0d246dc":"world_map = folium.Map(location=[10,0], tiles=\"cartodbpositron\", zoom_start=2,max_zoom=6,min_zoom=2)\nfor i in range(0,len(df_confirmed)):\n    folium.Circle(\n        location=[df_confirmed.iloc[i]['Lat'], df_confirmed.iloc[i]['Long']],\n        tooltip = \"<h5 style='text-align:center;font-weight: bold'>\"+df_confirmed.iloc[i]['country']+\"<\/h5>\"+\n                    \"<div style='text-align:center;'>\"+str(np.nan_to_num(df_confirmed.iloc[i]['state']))+\"<\/div>\"+\n                    \"<hr style='margin:10px;'>\"+\n                    \"<ul style='color: #555;list-style-type:circle;align-item:left;padding-left:20px;padding-right:20px'>\"+\n        \"<li>Confirmed \"+str(df_confirmed.iloc[i,-1])+\"<\/li>\"+\n\n        \"<li>Deaths   \"+str(df_deaths.iloc[i,-1])+\"<\/li>\"+\n        \"<\/ul>\"\n        ,\n        radius=(int((np.log(df_confirmed.iloc[i,-1]+1)))+0.2)*50000,\n        color='#ff6600',\n        fill_color='#ff8533',\n        fill=True).add_to(world_map)\n\nworld_map","5d853333":"df_countries = df_confirmed.groupby([\"country\"]).sum()\ndf_countries = df_countries.sort_values(df_countries.columns[-1],ascending = False)\ncountries = df_countries[df_countries[df_countries.columns[-1]] >= 1500].index\n\ncols =2\nrows = int(np.ceil(countries.shape[0]\/cols))\nf = plt.figure(figsize=(20,10*rows))\nfor i,country in enumerate(countries):\n    visualize_covid_cases(df_confirmed, df_deaths,country = country,figure = [f,rows,cols, i+1])\nplt.show()","e333632d":"temp = df_confirmed.groupby('country').sum().drop([\"Lat\",\"Long\"],axis =1).sort_values(df_confirmed.columns[-1], ascending= False)\n\nthreshold = 50\nf = plt.figure(figsize=(10,12))\nax = f.add_subplot(111)\nfor i,country in enumerate(temp.index):\n    if i >= 10:\n        if country != \"India\":\n            continue\n    x = 30\n    t = temp.loc[temp.index== country].values[0]\n    t = t[t>threshold][:x]\n     \n    date = np.arange(0,len(t[:x]))\n    xnew = np.linspace(date.min(), date.max(), 10)\n    spl = make_interp_spline(date, t, k=1)  \n    power_smooth = spl(xnew)\n    if country != \"India\":\n        plt.plot(xnew,power_smooth,label = country,linewidth =2)\n    else:\n        marker_style = dict(linewidth=4, linestyle='-', marker='o',markersize=10, markerfacecolor='#ffffff')\n        plt.plot(date,t,\"-.\",label = country,**marker_style)\n\nplt.tick_params(labelsize = 14)        \nplt.xticks(np.arange(0,30,7),[ \"Day \"+str(i) for i in range(30)][::7])     \n\n\nx = np.arange(0,18)\ny = 2**(x+np.log2(threshold))\nplt.plot(x,y,\"--\",linewidth =2,color = \"gray\")\nplt.annotate(\"No. of cases doubles every day\",(x[-2],y[-1]),xycoords=\"data\",fontsize=14,alpha = 0.5)\n\nx = np.arange(0,26)\ny = 2**(x\/2+np.log2(threshold))\nplt.plot(x,y,\"--\",linewidth =2,color = \"gray\")\nplt.annotate(\".. every socend day\",(x[-3],y[-1]),xycoords=\"data\",fontsize=14,alpha = 0.5)\n\nx = np.arange(0,26)\ny = 2**(x\/7+np.log2(threshold))\nplt.plot(x,y,\"--\",linewidth =2,color = \"gray\")\nplt.annotate(\".. every week\",(x[-3],y[-1]),xycoords=\"data\",fontsize=14,alpha = 0.5)\n\nx = np.arange(0,26)\ny = 2**(x\/30+np.log2(threshold))\nplt.plot(x,y,\"--\",linewidth =2,color = \"gray\")\nplt.annotate(\".. every month\",(x[-3],y[-1]),xycoords=\"data\",fontsize=14,alpha = 0.5)\n\n\n\nx = np.arange(0,26)\ny = 2**(x\/4+np.log2(threshold))\nplt.plot(x,y,\"--\",linewidth =2,color = \"Red\")\nplt.annotate(\".. every 4 days\",(x[-3],y[-1]),color=\"Red\",xycoords=\"data\",fontsize=14,alpha = 0.8)\n\n\nplt.xlabel(\"Days\",fontsize=17)\nplt.ylabel(\"Number of Confirmed Cases\",fontsize=17)\nplt.title(\"Trend of India Confirm cases\",fontsize=22)\nplt.legend(loc = \"upper left\")\nplt.yscale(\"log\")\nplt.grid(which=\"both\")\nplt.show()","a46476f6":"df_continents= df_confirmed.groupby([\"continent\"]).sum()\ncontinents = df_continents.sort_values(df_continents.columns[-1],ascending = False).index\ncontinents = [\"All\"]+list(continents)\n\ncols =1\nrows = 2\naxis_label = [\"Days (\"+df_confirmed.columns[5]+\" - \"+df_confirmed.columns[-1]+\")\",\"Mortality Rate (of 100)\"]\n\nf = plt.figure(figsize=(15,10*rows))\n\n\nax = f.add_subplot(211)\nmortality_rate = get_mortality_rate(df_confirmed,df_deaths,continent=continents[0])\nplt.plot(np.arange(1,mortality_rate.shape[0]+1),mortality_rate,label = \"Current Mortality Rate \"+str(mortality_rate[-1]))\n\nplt_title = \"Mortality Rate Curve of India\"\nplot_params(ax,axis_label,plt_title)\nl = plt.legend(loc= \"best\")\nplt.show()\n","6c254da7":"df_confirmed_report = df_confirmed.copy()\ndf_confirmed_report = df_confirmed_report.groupby(\"country\").sum().drop([\"Lat\",\"Long\"],axis =1)\ndf_confirmed_report.loc[\"Total\"] = df_confirmed_report.sum()\ndf_confirmed_newcases = df_confirmed_report.groupby(level =0).diff(axis =1)\ndf_confirmed_newcases=df_confirmed_newcases.drop(columns=['1\/22\/20'])\n\ndf_deaths_report = df_deaths.copy()\ndf_deaths_report = df_deaths_report.groupby(\"country\").sum().drop([\"Lat\",\"Long\"],axis =1)\ndf_deaths_report.loc[\"Total\"] = df_deaths_report.sum()\ndf_deaths_newcases = df_deaths_report.groupby(level =0).diff(axis =1)\ndf_deaths_newcases=df_deaths_newcases.drop(columns=['1\/22\/20'])","9eea281e":"confirm=df_confirmed_newcases\nconfirm=confirm.T\n\nconfirm['Date']=confirm.index\n\nconfirm=confirm[['Date', 'India']]\n\nconfirm_cases=pd.DataFrame()\n\nconfirm_cases['Date']=confirm['Date']\nconfirm_cases['India cases']=confirm['India']\n\nconfirm_cases=confirm_cases.reset_index()\nconfirm_cases=confirm_cases.drop(columns=['index'])","832deb3c":"confirm_cases.head(60)","38c6993d":"confirm_cases=confirm_cases[49:]\nconfirm_cases","9720c0eb":"confirm_cases['India cases']=confirm_cases['India cases'].replace(0,0.1)","49a51807":"confirm_cases['times'] = pd.to_datetime(confirm_cases['Date'])  \nconfirm_cases.set_index('times', inplace=True)                   \nconfirm_cases.sort_index(ascending=True, inplace=True)\ntar='India Confirm Cases Predictions'\nconfirm_cases.rename(columns={'India cases':tar}, inplace=True)\nconfirm_cases=confirm_cases[[tar]]","c114af75":"def create_features(data, label=None):\n    data['date'] = data.index\n    data['month'] = data['date'].dt.month\n    data['year'] = data['date'].dt.year\n    data['dayofmonth'] = data['date'].dt.day\n    X = data[['month','year','dayofmonth']]\n    if label:\n        y = data[label]\n        return X, y\n    return X","f87cc396":"test=confirm_cases.copy()\nX= create_features(test)\ny=confirm_cases","b00f99bc":"from sklearn.cross_decomposition import PLSRegression\npls = PLSRegression()","b656afbb":"x=np.array(X)\ny=np.array(y)\ny=y.ravel()\nkf = KFold(n_splits=5)\noutcomes2 = []\nClassR=0\nConM=0\nfold = 0\ni=0\nconf_matrix_list_of_arrays = []\nfor train_index, test_index in kf.split(x,y):\n    i=i+1\n    print('\\n')\n    print(\"Cross validation\",i)\n    fold += 1\n    Xtrain, Xtest = x[train_index], x[test_index]\n    ytrain, y_test = y[train_index], y[test_index]\n    pls.fit(Xtrain, ytrain)\n    y_pred = pls.predict(Xtest)\n    MAE=mean_absolute_error(y_test,y_pred)\n    print('Mean Absolute error: ', MAE)\n    mse=mean_squared_error(y_test,y_pred)\n    rmse = math.sqrt(mse)\n    print('Root mean squared error: ', rmse)","aaeff78c":"from sklearn.svm import LinearSVR\nsvr = LinearSVR()","8dec57ae":"x=np.array(X)\ny=np.array(y)\ny=y.ravel()\nkf = KFold(n_splits=5)\noutcomes2 = []\nClassR=0\nConM=0\nfold = 0\ni=0\nconf_matrix_list_of_arrays = []\nfor train_index, test_index in kf.split(x,y):\n    i=i+1\n    print('\\n')\n    print(\"Cross validation\",i)\n    fold += 1\n    Xtrain, Xtest = x[train_index], x[test_index]\n    ytrain, y_test = y[train_index], y[test_index]\n    svr.fit(Xtrain, ytrain)\n    y_pred = svr.predict(Xtest)\n    MAE=mean_absolute_error(y_test,y_pred)\n    print('Mean Absolute error: ', MAE)\n    mse=mean_squared_error(y_test,y_pred)\n    rmse = math.sqrt(mse)\n    print('Root mean squared error: ', rmse)","13b25805":"from sklearn.ensemble import RandomForestRegressor\nrf = RandomForestRegressor()","1710bbc3":"x=np.array(X)\ny=np.array(y)\ny=y.ravel()\nkf = KFold(n_splits=5)\noutcomes2 = []\nClassR=0\nConM=0\nfold = 0\ni=0\nconf_matrix_list_of_arrays = []\nfor train_index, test_index in kf.split(x,y):\n    i=i+1\n    print('\\n')\n    print(\"Cross validation\",i)\n    fold += 1\n    Xtrain, Xtest = x[train_index], x[test_index]\n    ytrain, y_test = y[train_index], y[test_index]\n    rf.fit(Xtrain, ytrain)\n    y_pred = pls.predict(Xtest)\n    MAE=mean_absolute_error(y_test,y_pred)\n    print('Mean Absolute error: ', MAE)\n    mse=mean_squared_error(y_test,y_pred)\n    rmse = math.sqrt(mse)\n    print('Root mean squared error: ', rmse)","907f3b88":"rf=RandomForestRegressor()\nx=np.array(X)\ny=np.array(y)\ny=y.ravel()\nRF=rf.fit(Xtrain, ytrain)","ca436075":"frequency='D'\nt=datetime.now()\ndef forecast(number):\n  datelist = pd.date_range(t, periods=number,freq=frequency)\n  datelist= pd.DataFrame(datelist,columns=['TIMESTAMP'])\n  datelist.index = datelist['TIMESTAMP']\n  datelist_featured=create_features(datelist)\n  prediction=RF.predict(datelist_featured)\n  pred=pd.DataFrame(prediction,columns=confirm_cases.columns)\n  pred.index = datelist['TIMESTAMP']\n  return pred","a8f41971":"forecast=forecast(7)\nforecast","8f24e061":"forecast.plot(figsize=(20, 5), color='r')","1ae52a54":"deaths=df_deaths_newcases\ndeaths=deaths.T\n\ndeaths['Date']=deaths.index\n\ndeaths=deaths[['Date', 'India']]\n\ndeaths_cases=pd.DataFrame()\n\ndeaths_cases['Date']=deaths['Date']\ndeaths_cases['India cases']=deaths['India']\n\ndeaths_cases=deaths_cases.reset_index()\ndeaths_cases=deaths_cases.drop(columns=['index'])","9b0b9880":"deaths_cases.head(60)","f7d2946a":"deaths_cases=deaths_cases[65:]\ndeaths_cases","459156cd":"deaths_cases['India cases']=deaths_cases['India cases'].replace(0,0.1)","27f34f9b":"deaths_cases['times'] = pd.to_datetime(deaths_cases['Date'])  \ndeaths_cases.set_index('times', inplace=True)                   \ndeaths_cases.sort_index(ascending=True, inplace=True)\ntar='India Deaths Predictions'\ndeaths_cases.rename(columns={'India cases':tar}, inplace=True)\ndeaths_cases=deaths_cases[[tar]]","f99cd8ea":"def create_features(data, label=None):\n    data['date'] = data.index\n    data['month'] = data['date'].dt.month\n    data['year'] = data['date'].dt.year\n    data['dayofmonth'] = data['date'].dt.day\n    X = data[['month','year','dayofmonth']]\n    if label:\n        y = data[label]\n        return X, y\n    return X","434e895b":"test=deaths_cases.copy()\nX= create_features(test)\ny=deaths_cases","63579a69":"from sklearn.cross_decomposition import PLSRegression\npls = PLSRegression()","14b14a6f":"x=np.array(X)\ny=np.array(y)\ny=y.ravel()\nkf = KFold(n_splits=5)\noutcomes2 = []\nClassR=0\nConM=0\nfold = 0\ni=0\nconf_matrix_list_of_arrays = []\nfor train_index, test_index in kf.split(x,y):\n    i=i+1\n    print('\\n')\n    print(\"Cross validation\",i)\n    fold += 1\n    Xtrain, Xtest = x[train_index], x[test_index]\n    ytrain, y_test = y[train_index], y[test_index]\n    pls.fit(Xtrain, ytrain)\n    y_pred = pls.predict(Xtest)\n    MAE=mean_absolute_error(y_test,y_pred)\n    print('Mean Absolute error: ', MAE)\n    mse=mean_squared_error(y_test,y_pred)\n    rmse = math.sqrt(mse)\n    print('Root mean squared error: ', rmse)","89889220":"from sklearn.svm import LinearSVR\nsvr = LinearSVR()","c12e937b":"x=np.array(X)\ny=np.array(y)\ny=y.ravel()\nkf = KFold(n_splits=5)\noutcomes2 = []\nClassR=0\nConM=0\nfold = 0\ni=0\nconf_matrix_list_of_arrays = []\nfor train_index, test_index in kf.split(x,y):\n    i=i+1\n    print('\\n')\n    print(\"Cross validation\",i)\n    fold += 1\n    Xtrain, Xtest = x[train_index], x[test_index]\n    ytrain, y_test = y[train_index], y[test_index]\n    svr.fit(Xtrain, ytrain)\n    y_pred = svr.predict(Xtest)\n    MAE=mean_absolute_error(y_test,y_pred)\n    print('Mean Absolute error: ', MAE)\n    mse=mean_squared_error(y_test,y_pred)\n    rmse = math.sqrt(mse)\n    print('Root mean squared error: ', rmse)","79dcdc36":"from sklearn.ensemble import RandomForestRegressor\nrf = RandomForestRegressor()","cdb84572":"x=np.array(X)\ny=np.array(y)\ny=y.ravel()\nkf = KFold(n_splits=5)\noutcomes2 = []\nClassR=0\nConM=0\nfold = 0\ni=0\nconf_matrix_list_of_arrays = []\nfor train_index, test_index in kf.split(x,y):\n    i=i+1\n    print('\\n')\n    print(\"Cross validation\",i)\n    fold += 1\n    Xtrain, Xtest = x[train_index], x[test_index]\n    ytrain, y_test = y[train_index], y[test_index]\n    rf.fit(Xtrain, ytrain)\n    y_pred = pls.predict(Xtest)\n    MAE=mean_absolute_error(y_test,y_pred)\n    print('Mean Absolute error: ', MAE)\n    mse=mean_squared_error(y_test,y_pred)\n    rmse = math.sqrt(mse)\n    print('Root mean squared error: ', rmse)","6ae5174f":"rf=RandomForestRegressor()\nx=np.array(X)\ny=np.array(y)\ny=y.ravel()\nRF=rf.fit(Xtrain, ytrain)","21706935":"frequency='D'\nt=datetime.now()\ndef forecast(number):\n  datelist = pd.date_range(t, periods=number,freq=frequency)\n  datelist= pd.DataFrame(datelist,columns=['TIMESTAMP'])\n  datelist.index = datelist['TIMESTAMP']\n  datelist_featured=create_features(datelist)\n  prediction=RF.predict(datelist_featured)\n  pred=pd.DataFrame(prediction,columns=deaths_cases.columns)\n  pred.index = datelist['TIMESTAMP']\n  return pred","5bee1435":"forecast=forecast(7)\nforecast","fc63b1df":"forecast.plot(figsize=(20, 5), color='r')","199d4315":"### Data information","9770c1b8":"### Data types of all coloumns","296908c9":"### Cross validation","0c64d728":"### Preparing deaths cases data for Training and predictions","45b0ea00":"### Importing Libraries","ed5ae2af":"### Support vector  Regressor Algorithm","1ae137aa":"### If we look at the first 65 days so there are no deaths in India but few in some day between but from index 48 to 65 increasing slowly ","3a99cdcd":"### PLS Algorithm","6de8e7e2":"## Pre-processing of dataset","0868a1e1":"# <img src=\"https:\/\/media.npr.org\/assets\/img\/2021\/02\/01\/gettyimages-1230235182_custom-24d5a0fe9793115c4ae460170eb26d6f01f289c5.jpg\">","3b9870b9":"### Renaming the Province\/State into state and Country\/Region into country","5a9dba96":"### Spliting dates into  month, year and Day of month","b934e10e":"### Support vector  Regressor Algorithm","8c9cb945":"### Forecasting function by using the trained model for predictions","f6e413dc":"### Spliting dates into  month, year and Day of month","29be570c":"### Coloumns\/features in data","a7b9cdc8":"## Predictions confirm cases of next 7 days","9ca94c3a":"### Visualization of India on Map","0795e500":"### If we look at the first 49 days so there are no cases in India but few in some day between but from index 46 to 49 increasing slowly ","5bbdc0cc":"### Data Description, here we can see the values of columns as minimum value, maximum value, counts etc","82dd5a21":"### Data types of all coloumns","e3efb10d":"### Changing Continent code to Continent names as we will create a map and show the India ","c8473c76":"### Random Forest  Regressor Algorithm","81fbb8ec":"### Cross validation","5b9230a7":"## Importing COVID-19 Confirmed cases of India","6fb50bd5":"### Mortality Rate Variation Over Period of Time. It is increasing very fast. ","18747b9f":"### Coloumns\/features in data","546367ce":"### So going to Ignore fisrt above days data and goin to use the next ","87c04763":"# ----------------Machine Learning Algorithm and Evaluation-----------------","e164b89c":"### Getting country data as count of confirm cases and deaths ","7a94f1e9":" ### Functions for the plots and graphs\n - plot_params()\n - visualize_covid_cases()\n - get_mortality_rate()","47bc3976":"### Random Forest  Regressor Algorithm","38cd530a":"### Data information","db83fc35":"### Cross validation","9eea03e5":"## India Confirm Cases Predictions of COVID-19","1635a7cc":"### Total India confirm and deaths cases in graph","a6c73d7c":"## Exploratory data analysis","a6cd71b0":"### Preparing Confirm cases data for Training and predictions","9c04ead2":"## COVID-19 Spread Analysis","6eb31b6e":"### Repacing NaN values that we were getting in province so replacing with empty space","3054724a":"### Date settings and India deaths_cases preparation accroding to dates","92b4a751":"### As we can see the results of three algorithms above but random forest regression algorithm performed well and we got minimum mean absolute error and root mean squared error. So now going to train all data on random forest algorithm and then we will get predictions of DEATHS CASES","29897edd":"### Date settings and India cases preparation accroding to dates","9d01412c":"### Data Description, here we can see the values of columns as minimum value, maximum value, counts etc","f3d7b644":"### Spread of COVID-19 in  India, we can see mortality rate of all deaths with confirm cases and  deaths. In last 24 hours, confirm cases and deaths in India. ","1a3bab42":"### Predictions death cases of next 7 days","5286f407":"<div class=\"alert alert-block alert-info\">  \n<h1>If you like my work, please upvote ^ \ud83d\udc4d my kernel so that i will be motivated to share more content to Kaggle community. Thanks \ud83d\ude0d<\/h1>\n        <\/p>\n<\/div>","deabeb6f":"### Cross validation","df6e79e3":"### Preparing India confirm cases and Deaths for training the machine learning models","f3810b26":"### So going to Ignore fisrt above days data and goin to use the next ","cd1a5e0f":"### Getting country name","f35438e5":"### Importing Deaths cases of COVID-19 directly from githubusercontent as updated dataset","9c0557df":"### Cross validation","aede8147":"## -------------Machine Learning Algorithm and Evaluation---------------","0c69b357":"## India Deaths Predictions of COVID-19","ddc41cca":"### Data for training input and prediction output","aee7d814":"### Data for training input and prediction output","9936384b":"### Cross validation","62e23b59":"## As we can see the results of three algorithms above but random forest regression algorithm performed well and we got minimum mean absolute error and root mean squared error. So now going to train all data on random forest algorithm and then we will get predictions of CONFIRM CASES","a2fa55d3":"### Forecasting function by using the trained model for predictions","df72621f":"### PLS Algorithm","986c9a0b":"## General Analysis of Data","892b85a2":"### Defininng Function for getting continent code for country","b83c61b2":"### Trend of India Confirm cases. As we can see that the cases are increasing in blue line with every 4 days 10 power of 4 means around 10000 cases now. "}}