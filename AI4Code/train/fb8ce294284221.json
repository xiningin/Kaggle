{"cell_type":{"4e4a5248":"code","bfe29976":"code","025a8bad":"code","0252e63d":"code","d17acb70":"code","6d4c455e":"code","74178bd3":"code","95b1fc80":"code","398a3dc2":"code","5753a8b9":"code","33f73ab6":"code","a1d2e978":"code","949c4778":"code","8c02ebe2":"code","c8099486":"code","926a7d81":"code","ddaf1bdc":"code","7ea850d8":"code","91e16be4":"code","d71d8e1d":"code","3b133504":"code","197fb4ba":"code","aef50a15":"code","71de3dba":"code","0ca2fe89":"code","c227f9d5":"code","9d81e2b4":"code","0b1d0e92":"code","24154cea":"code","c428d720":"code","d8eb6eb4":"code","921ca0a8":"code","093e0079":"code","18a49828":"code","0fb781f7":"code","d8ec6dc2":"code","de700bc9":"code","20083289":"code","d2f5b83c":"code","03aba043":"code","c7fca4e1":"markdown","84e85104":"markdown","8697ce7e":"markdown","67865699":"markdown","61b5aeeb":"markdown","5cb57bc5":"markdown","824e57d9":"markdown","84462ceb":"markdown","3c4af1ea":"markdown"},"source":{"4e4a5248":"#from google.colab import drive\n#drive.mount('\/content\/drive',)","bfe29976":"#from pandas import read_csv\n#df = read_csv('drive\/My Drive\/ia\/datasets\/tcu-assunto-sumario.csv')","025a8bad":"#df2 = read_csv('drive\/My Drive\/ia\/datasets\/tcu-assunto-sumario.csv')","0252e63d":"# Pegando o dataset do output do kaggle\nimport pandas as pd\ndf = pd.read_csv('\/kaggle\/input\/eda-acordaos-para-csv\/tcu-assunto-sumario.csv')\ndf2 = pd.read_csv('\/kaggle\/input\/eda-acordaos-para-csv\/tcu-assunto-sumario.csv')","d17acb70":"df2[['assunto','sumario']].groupby(['assunto'])['sumario'].count().nlargest(30)","6d4c455e":"df.head(5)","74178bd3":"df.sample().values[0]","95b1fc80":"#quantidade de registros\ndf.shape","398a3dc2":"#dropa as linhas em que o sum\u00e1rio est\u00e3o em branco\ndf.dropna(inplace=True)","5753a8b9":"df.shape","33f73ab6":"!pip install unidecode\n\nfrom unidecode import unidecode\nimport re","a1d2e978":"def normaliza_assunto(x):\n    return re.sub(\"[^a-zA-Z]\",\" \",unidecode(x).lower()).strip()","949c4778":"df['assunto'] = df.assunto.apply(normaliza_assunto)","8c02ebe2":"#quantidades de labels\ndf['assunto'].unique().size","c8099486":"#listando os top 30 assuntos com mais ocorr\u00eancia\ndf[['assunto','sumario']].groupby(['assunto'])['sumario'].count().nlargest(30)","926a7d81":"df.head(5)","ddaf1bdc":"from fastai.text import *","7ea850d8":"#tokenizador\ntokenizer = Tokenizer(lang='pt', n_cpus=8)\n#vocabulario\nwith open('drive\/My Drive\/ia\/models\/itos.pkl', 'rb') as f:\n    itos = pickle.load(f)\nvocab = Vocab(itos)","91e16be4":"from pathlib import Path\npath = Path('drive\/My Drive\/ia\/models')","d71d8e1d":"path","3b133504":"bs = 24","197fb4ba":"train_bool = np.random.rand(len(df)) < 0.8","aef50a15":"data_lm = TextLMDataBunch.from_df(path,\n                                  train_df= df[train_bool],\n                                  valid_df= df[~train_bool],\n                                  tokenizer=tokenizer,\n                                  vocab=vocab,\n                                  text_cols=0,\n                                  bs=bs,\n                                  max_vocab=35000)","71de3dba":"data_lm.save('data_lm')","0ca2fe89":"data_lm = load_data(path, 'data_lm', bs=bs)","c227f9d5":"#learn_lm = language_model_learner(data_lm, AWD_LSTM, drop_mult=0.3)\n\nconfig = awd_lstm_lm_config.copy()\nconfig['n_hid'] = 1150\nlearn = language_model_learner(data_lm, AWD_LSTM, config=config,\n                               pretrained_fnames=['model30k', 'itos'], \n                               drop_mult=0.3)\n\n#learn_lm = language_model_learner(data_lm, arch=AWD_LSTM, pretrained_fnames=('model30k','itos'))","9d81e2b4":"learn.lr_find()","0b1d0e92":"learn.recorder.plot()","24154cea":"learn.fit_one_cycle(1, max_lr=4e-2)","c428d720":"learn.save_encoder('pretrained_encoder')","d8eb6eb4":"data_clas = TextClasDataBunch.from_df(path,\n                                      train_df= df[train_bool],\n                                      valid_df= df[~train_bool],\n                                      tokenizer=tokenizer,\n                                      text_cols=1,\n                                      bs=24,\n                                      vocab=vocab,\n                                      max_vocab=35000,\n                                      label_cols=0)","921ca0a8":"data_clas = (TextList.from_df(df, path, vocab=data_lm.vocab, cols='sumario')\n    .split_by_rand_pct(0.1, seed=42)\n    .label_from_df(cols='assunto')\n    .databunch(bs=bs, num_workers=1, backwards=True))\n\n#data_clas.save(f'{lang}_textlist_class_bwd')","093e0079":"print(type(data_clas.valid_ds.x))","18a49828":"len(data_clas.valid_ds.x)","0fb781f7":"clf = text_classifier_learner(data_clas, AWD_LSTM, drop_mult=0.5, pretrained=False)","d8ec6dc2":"clf.fit_one_cycle(5, 1e-2)","de700bc9":"clf.data.classes","20083289":"pred = clf.predict('PEDIDO DE REEXAME. APOSENTADORIA. TEMPO DE SERVI\u00c7O EXERCIDO EM ATIVIDADE RURAL E TEMPO DE EST\u00c1GIO PRESTADO JUNTO AO PROJETO RONDON, AMBOS COMPUTADOS PARA APOSENTADORIA, EM DESCONFORMIDADE COM A LEGISLA\u00c7\u00c3O PERTINENTE E COM O ENTENDIMENTO JURISPRUDENCIAL DO TCU. N\u00c3O PROVIMENTO DO RECURSO. REVIS\u00c3O DE OF\u00cdCIO DE OUTRO ATO. ABERTURA DE CONTRADIT\u00d3RIO.    1. O tempo de atividade rural somente pode ser computado para efeito de aposentadoria no servi\u00e7o p\u00fablico se comprovados os recolhimentos \u00bf em \u00e9poca pr\u00f3pria, ou em momento posterior, de forma indenizada \u00bf das respectivas contribui\u00e7\u00f5es previdenci\u00e1rias.    2. \u00c9 indevida a contagem, para efeitos de aposentadoria, de tempo referente a est\u00e1gio prestado no Projeto Rondon, uma vez que n\u00e3o h\u00e1 v\u00ednculo empregat\u00edcio de qualquer natureza nem contribui\u00e7\u00e3o para qualquer regime previdenci\u00e1rio.    3. Cabe revis\u00e3o de of\u00edcio pelo Tribunal, mediante a oitiva do Minist\u00e9rio P\u00fablico junto ao TCU, de ato de concess\u00e3o julgado legal, no prazo de cinco anos do julgamento, se verificada viola\u00e7\u00e3o da ordem jur\u00eddica'); pred","d2f5b83c":"valid_df2= df[~train_bool]","03aba043":"valid_df2.sample().values[0]","c7fca4e1":"### Carregando os dados","84e85104":"## Mount the Google Drive to Google Colab\n\n* Autor: Ami Aran\n* Dataset de Acordaos do TCU disponibilizado por Neto Ferraz\n* Adapta\u00e7\u00e3o para Kaggle por D\u00e9bora Reis","8697ce7e":"Vamos usar o tokenizador do fast.ai. \u00c9 necess\u00e1rio fazer o import.","67865699":"## Normaliza\u00e7\u00e3o dos dados\n\nTentando realizar o match da maior quantidade pos\u00edvel de assuntos, normalizei os assuntos, removendo acentos, letras ma\u00edusculas, pontua\u00e7\u00e3o e espa\u00e7os em brancos no in\u00edcio e no final.\n\n","61b5aeeb":"## Classificador","5cb57bc5":"Criando o learn","824e57d9":"## Pegando o dataset","84462ceb":"## Tokeniza\u00e7\u00e3o","3c4af1ea":"## Language model"}}