{"cell_type":{"c5a862d3":"code","9ffefa74":"code","b2422b0f":"code","c2bdf28c":"code","7832f743":"markdown","be6f4f20":"markdown","9cbc61fa":"markdown"},"source":{"c5a862d3":"!pip install PyTesseract","9ffefa74":"import os\nDATA_PATH = '\/kaggle\/input\/fifty-states-car-license-plates-dataset\/Fifty States License Plates\/'\nFILE_LIST= os.listdir(DATA_PATH)\nFILE_LIST.sort()\nprint(FILE_LIST)","b2422b0f":"import matplotlib.pyplot as plt\nimport cv2\n\ndef CV2_dilation(filename):\n    img = cv2.imread(filename)\n    gray= cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)\n    gray= cv2.resize(gray, None, fx=3, fy=3, interpolation= cv2.INTER_CUBIC)\n    blur = cv2.GaussianBlur(gray, (5,5), 0)\n    #gray = cv2.medianBlur(gray, 3)\n    ret, thresh = cv2.threshold(blur, 0, 255, cv2.THRESH_OTSU | cv2.THRESH_BINARY_INV)\n    #plt.imshow(cv2.cvtColor(thresh,cv2.COLOR_RGB2BGR))\n    rect_kern = cv2.getStructuringElement(cv2.MORPH_RECT, (3,3))\n    dilation = cv2.dilate(thresh, rect_kern, iterations = 1)    \n    #plt.imshow(cv2.cvtColor(dilation,cv2.COLOR_RGB2BGR))\n    return dilation, gray, thresh","c2bdf28c":"import pytesseract\n\nfor FILE in FILE_LIST:\n    STATE_NAME = FILE.replace('.jpg','')\n    print(STATE_NAME)\n    \n    # OpenCV dilation\n    dilation, im2, thresh = CV2_dilation(DATA_PATH+FILE)\n    # find contours\n    contours, hierarchy = cv2.findContours(dilation, cv2.RETR_TREE, cv2.CHAIN_APPROX_SIMPLE)\n    sorted_contours = sorted(contours, key=lambda ctr: cv2.boundingRect(ctr)[0])\n    \n    plate_num = \"\"\n    #no=0\n    \n    # loop through contours and find letters in license plate\n    for cnt in sorted_contours:\n        x,y,w,h = cv2.boundingRect(cnt)\n        height, width = im2.shape\n    \n        # if height of box is not a quarter of total height then skip\n        if height \/ float(h) > 6: continue\n        ratio = h \/ float(w)\n        # if height to width ratio is less than 1.5 skip\n        if ratio < 1.5: continue\n        area = h * w\n        # if width is not more than 25 pixels skip\n        if width \/ float(w) > 15: continue\n        # if area is less than 100 pixels skip\n        if area < 100: continue\n        # draw the rectangle\n        rect = cv2.rectangle(im2, (x,y), (x+w, y+h), (0,255,0),2)\n        roi = thresh[y-5:y+h+5, x-5:x+w+5]\n        roi = cv2.bitwise_not(roi)\n        #roi = cv2.medianBlur(roi, 5)\n        text = pytesseract.image_to_string(roi, config='-c tessedit_char_whitelist=0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ --psm 8 --oem 3')\n        text = text[0]\n        #cv2.imwrite('test_'+str(no)+'.jpg',roi)\n        #no+=1\n        plate_num += text\n    print(plate_num)\n    print('----------')","7832f743":"## Install PyTesseract","be6f4f20":"# OpenCV + Tesseract ALPR","9cbc61fa":"## Test OCR with 50 states car license plates"}}