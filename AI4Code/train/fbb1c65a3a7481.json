{"cell_type":{"27921230":"code","2781ed41":"code","32df9b73":"code","74bf7ea0":"code","6303dff2":"code","2bef906f":"code","5c3c6eca":"code","6e199c66":"code","4375f583":"code","5f286934":"code","81dad0f6":"code","dcdd938f":"markdown","3e5efd05":"markdown","3c722952":"markdown","64bf6963":"markdown","faf99e67":"markdown","0b43b333":"markdown"},"source":{"27921230":"import pandas as pd \nimport numpy as np\nimport seaborn as sns\n%matplotlib inline\nfrom matplotlib import pyplot as plt\nfrom matplotlib import style\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.model_selection import GridSearchCV","2781ed41":"train = pd.read_csv('..\/input\/titanic\/train.csv')\ntest = pd.read_csv('..\/input\/titanic\/test.csv')","32df9b73":"sns.countplot('Sex', hue='Survived', data=train)","74bf7ea0":"train.isnull().sum()","6303dff2":"test.isnull().sum()","2bef906f":"def preprocess(data):\n    # \u6b20\u640d\u5024\u306e\u88dc\u5b8c\n    data['Fare'] = data['Fare'].fillna(data['Fare'].mean())\n    data['Age'] = data['Age'].fillna(data['Age'].mean())\n    data['Embarked'] = data['Embarked'].fillna('S')\n\n    # \u30ab\u30c6\u30b4\u30ea\u3092\u524a\u9664\n    data = data.drop(['PassengerId', 'Name', 'Ticket', 'Cabin'], axis=1)\n    \n    data['Sex'] = data['Sex'].map({'female': 0, 'male': 1}).astype(int)\n    data['Embarked'] = data['Embarked'].map({'S': 0, 'C': 1, 'Q': 2}).astype(int)\n    data[\"FamilySize\"] = data[\"SibSp\"] + data[\"Parch\"] + 1\n    data['Alone'] = 0\n    data.loc[data['FamilySize'] == 1, 'Alone'] = 1\n    \n    return data\n\ntrain = preprocess(train)","5c3c6eca":"grid = sns.FacetGrid(train, col='Survived', row='Pclass', size=2.2, aspect=1.6)\ngrid.map(plt.hist, 'Age', alpha=.5, bins=20)\ngrid.add_legend()","6e199c66":"from sklearn.model_selection import train_test_split\nX = train.drop('Survived', axis=1)\ny = train['Survived'].values\ntrain_X, test_X ,train_y, test_y = train_test_split(X, y, random_state = 0)","4375f583":"model = RandomForestClassifier(criterion='gini',\n            max_depth=10, max_features='auto', min_samples_leaf=10, min_samples_split=15,\n            min_weight_fraction_leaf=0.0, n_estimators=100, n_jobs=5, random_state=0, verbose=0)\nmodel = model.fit(train_X, train_y)\npred = model.predict(test_X)\n\n# parameters = {\n#     'n_estimators':[i for i in range(10, 100, 20)],\n#     'criterion':[\"gini\", \"entropy\"],\n#     'max_depth':[i for i in range(10, 30, 10)],\n#     'min_samples_leaf':[i for i in range(10, 30, 10)],\n#     'min_samples_split': [i for i in range(5, 20, 5)],\n#     'random_state': [0],\n#     'verbose': [0],\n#     'max_features': ['auto'],\n#     'min_weight_fraction_leaf': [0],\n#     'n_jobs': [i for i in range(1, 8, 1)]\n# }\n\n# model = GridSearchCV(RandomForestClassifier(), parameters, cv=5, n_jobs=-1)\n# model.fit(train_X, train_y)\n\n# result = pd.DataFrame.from_dict(model.cv_results_)\n# result.to_csv('gs_result.csv')\n\n# best_model = model.best_estimator_\n# pred = best_model.predict(test_X)\n\nprint(accuracy_score(test_y, pred))","5f286934":"features = train_X.columns\nimportances = model.feature_importances_\nindexes = np.argsort(importances)\n\nplt.figure(figsize=(6,6))\nplt.barh(range(len(indexes)), importances[indexes], color='lightblue', align='center')\nplt.yticks(range(len(indexes)), features[indexes])\nplt.show()","81dad0f6":"test_formatted = preprocess(test)\npred = model.predict(test_formatted)\n\nsub = pd.DataFrame(test['PassengerId'])\nsub['Survived'] = list(map(int, pred))\nsub.to_csv('submission.csv', index=False)","dcdd938f":"## Count missing value\n\u5404\u9805\u76ee\u306b\u304a\u3044\u3066\u6b20\u640d\u5024\u304c\u3069\u308c\u304f\u3089\u3044\u5b58\u5728\u3059\u308b\u304b\u8abf\u3079\u308b\u3002`isnull()`\u3092\u7528\u3044\u308b\u3068\u3001\u6b20\u640d\u5024\u304c\u5b58\u5728\u3059\u308b\u5834\u5408\u306b`True`\u306b\u306a\u308b\u3002\u3055\u3089\u306b\u305d\u306e\u7d50\u679c\u306b`sum()`\u3092\u7528\u3044\u308b\u3053\u3068\u3067\u3001\u6b20\u640d\u5024\u304c`True`\u306b\u306a\u3063\u3066\u3044\u308b\u30c7\u30fc\u30bf\u306e\u500b\u6570\u3092\u3001\u5404\u9805\u76ee\u3054\u3068\u306b\u5408\u8a08\u3067\u304d\u308b\u3002\n\n\u306a\u304a\u3001\u3053\u3053\u3067`test.csv`\u307e\u3067\u4e00\u7dd2\u306b\u898b\u3066\u3044\u308b\u306e\u306f\u3001\u300c\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u7528\u306e\u30c7\u30fc\u30bf\u3067\u306f\u6b20\u640d\u304c\u306a\u304f\u3066\u3082\u3001\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u5074\u306b\u6b20\u640d\u5024\u304c\u5b58\u5728\u3059\u308b\u9805\u76ee\u304c\u3042\u308b\u53ef\u80fd\u6027\u300d\u3092\u8003\u616e\u3057\u3066\u3044\u308b\u3002\u5b9f\u969b\u3001Titanic\u306e\u30c7\u30fc\u30bf\u306f\u5b9f\u884c\u7d50\u679c\u306e\u3068\u304a\u308a\u3067\u3001\u6b20\u640d\u5024\u306e\u6709\u7121\u304c\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u7528\u30c7\u30fc\u30bf\u3068\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u3067\u9805\u76ee\u306b\u3088\u308a\u7570\u306a\u3063\u3066\u3044\u308b\u3002","3e5efd05":"## Format data\n\u30c7\u30fc\u30bf\u306e\u6574\u5f62\u3092\u884c\u3063\u3066\u3001\u8a13\u7df4\u30c7\u30fc\u30bf\u3068\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u306b\u5206\u5272\u3059\u308b\u3002\u3053\u306e\u969b\u3001`random_state`\u3067Seed\u3092\u56fa\u5b9a\u3057\u3066\u304a\u304f\u3002\u56fa\u5b9a\u3057\u306a\u3044\u3068\u3001\u5b9f\u884c\u6bce\u306b\u6bce\u56de\u5b66\u7fd2\u30c7\u30fc\u30bf\u3068\u691c\u8a3c\u30c7\u30fc\u30bf\u306e\u5185\u5bb9\u304c\u5909\u5316\u3057\u3066\u3057\u307e\u3046\u3002","3c722952":"## Fill missing value\n\u6b20\u640d\u5024\u3092\u88dc\u5b8c\u3059\u308b\u3002\u4eca\u56de\u306f`mean()`\u3092\u7528\u3044\u3066\u3001\u5e73\u5747\u5024\u3067\u88dc\u5b8c\u3059\u308b\u3002\u6587\u5b57\u5217\u306e\u6b20\u640d\u5024\uff08\u300cEmbarked\u300d\u306e\u3053\u3068\uff09\u306f\u3068\u308a\u3042\u3048\u305a\u3053\u3053\u3067\u306f\u300cS\u300d\u3067\u57cb\u3081\u3066\u3044\u308b\u3002\n\u3064\u3044\u3067\u306b\u3053\u3053\u3067\u4e0d\u8981\u306a\u5217\u3092\u524a\u9664\u3059\u308b\u3002\n\n\u540c\u6642\u306b\u3001\u6587\u5b57\u5217\u306e\u30c7\u30fc\u30bf\u3092\u5bfe\u5fdc\u3059\u308b\u6570\u5b57\u306b\u5909\u63db\u3059\u308b\u3002","64bf6963":"\u30e9\u30f3\u30c0\u30e0\u30d5\u30a9\u30ec\u30b9\u30c8\u3067\u7528\u3044\u3089\u308c\u305f\u5404\u9805\u76ee\u306e\u91cd\u8981\u5ea6\u3092\u3001\u30b0\u30e9\u30d5\u3067\u51fa\u529b\u3059\u308b\u3002","faf99e67":"## Generate model\n\u4e88\u6e2c\u30e2\u30c7\u30eb\u306e\u4f5c\u6210\u3068\u8a55\u4fa1\u3092\u884c\u3046\u3002","0b43b333":"# Titanic Tutorial"}}