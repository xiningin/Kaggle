{"cell_type":{"293bc518":"code","2f3dd79c":"code","7e9a6679":"code","4e26fc99":"code","2f180691":"code","7238f0f2":"code","98428d29":"markdown"},"source":{"293bc518":"import numpy as np\nimport pandas as pd","2f3dd79c":"sample = pd.read_csv('\/kaggle\/input\/digit-recognizer\/sample_submission.csv')\ntrain = pd.read_csv('\/kaggle\/input\/digit-recognizer\/train.csv')\ntest = pd.read_csv('\/kaggle\/input\/digit-recognizer\/test.csv')","7e9a6679":"from sklearn.model_selection import train_test_split\n\nX_train = train.iloc[:,1:].values.reshape(-1,28,28,1)\/255.\ny_train = pd.get_dummies(train.iloc[:,0]).values\nX_train, X_valid, y_train, y_valid = train_test_split(X_train,y_train,test_size=.1)\n\nX_test = test.values.reshape(-1,28,28,1)\/255.","4e26fc99":"import tensorflow as tf\nfrom tensorflow.keras.layers import Dense, Conv2D, Dropout, Flatten, MaxPooling2D\nfrom tensorflow.keras.callbacks import ReduceLROnPlateau\n\nlearning_rate_reduction = ReduceLROnPlateau(monitor='val_accuracy',\n                                              patience=3,\n                                              verbose=1,\n                                              factor=.5,\n                                              min_lr=.00001)\n\nmodel = tf.keras.Sequential([\n    Conv2D(128,3,activation='relu',input_shape=(28,28,1)),\n    MaxPooling2D(2),\n    Dropout(.2),\n    Conv2D(128,3,activation='relu'),\n    MaxPooling2D(2),\n    Dropout(.2),\n    Conv2D(128,3,activation='relu'),\n    MaxPooling2D(2),\n    Dropout(.2),\n    Flatten(),\n    Dense(128,activation='relu'),\n    Dense(10,activation='softmax')\n])\nmodel.compile(loss='categorical_crossentropy',\n             optimizer='adam',\n             metrics=['accuracy'])\nmodel.fit(X_train,y_train,\n         batch_size=32,\n         epochs=30,\n         validation_data=(X_valid,y_valid),\n         callbacks=[learning_rate_reduction])","2f180691":"predictions = tf.argmax(model.predict(X_test),axis=1)\nsample['Label'] = predictions\nsample.head()","7238f0f2":"sample.to_csv('submission.csv',index=False)","98428d29":"# Model"}}