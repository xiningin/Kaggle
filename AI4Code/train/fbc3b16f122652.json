{"cell_type":{"f89ffe5f":"code","0feac244":"code","a614b1c3":"code","72358afb":"code","c64a1dc6":"code","447b9d77":"code","2eb06838":"code","a5a9ac7a":"code","e6dab723":"code","a1949a2e":"code","6f40764c":"code","1e411566":"code","fe07f554":"code","389a5895":"code","d536cb2e":"code","75a4b4f9":"code","1da39ff4":"code","189330f7":"code","c5197d92":"code","ced77b0f":"code","af1070e2":"code","befb4d94":"code","7244939e":"code","cf73d86d":"code","e4695224":"code","dd02226f":"code","9978754e":"code","554ee844":"code","b02d437b":"code","da6cd2a1":"code","ffd22a0f":"code","07706598":"code","0a743bf6":"code","81d2b9ea":"code","3ef0edbc":"code","c0828f33":"code","14108c75":"code","3079f7f8":"code","1310c87d":"code","1d91450a":"code","2c9df55d":"code","1c4a5da9":"code","85e5834c":"code","85518dc3":"code","b9c9296c":"code","a7741621":"code","db200e41":"code","6f16a4ac":"code","6fbb8eb2":"code","2bcd11a8":"code","3ed290f7":"code","bc9e1372":"code","5493e733":"markdown","326dd331":"markdown","3e4af3c7":"markdown","b4c88d28":"markdown","46625f6f":"markdown","60aee7fc":"markdown","66cb0dbd":"markdown"},"source":{"f89ffe5f":"import pandas as pd \nimport pytz \nfrom datetime import datetime \nfrom matplotlib import pyplot as plt","0feac244":"data = pd.read_csv('..\/input\/time-zone-sales\/Sales-products-tz-mod.csv', index_col = 'SaleID')\nsale_data = data.copy()\nsale_data.head()","a614b1c3":"sale_data[['DateOfSale', 'TimeOfSale', 'TimeZone']].head()","72358afb":"date_and_time = sale_data['DateOfSale'] + ' ' + sale_data['TimeOfSale']\ndate_and_time","c64a1dc6":"sale_data['MOS'] = pd.to_datetime(date_and_time)\nsale_data.head()","447b9d77":"sale_data  = sale_data.drop(['DateOfSale', 'TimeOfSale'], axis =1)\nsale_data.head()","2eb06838":"pytz.all_timezones","a5a9ac7a":"sale_data['TimeZone'].unique()","e6dab723":"for i in sale_data['TimeZone'].unique():\n    if i in (pytz.all_timezones):\n        print(True)\n    else: \n        print(False)","a1949a2e":"sale_data['TimeZone'].unique()","6f40764c":"sale_data.loc[:,'TimeZone'] = sale_data.loc[:,'TimeZone'].replace({'SGT':'Singapore'})","1e411566":"sale_data['TimeZone'].unique()","fe07f554":"for i in sale_data['TimeZone'].unique():\n    if i in (pytz.all_timezones):\n        print(True)\n    else: \n        print(False)","389a5895":"sale_data[sale_data['TimeZone'] == \"Singapore\"]","d536cb2e":"pd.options.display.max_rows = None\npd.options.display.max_columns = None\nsale_data","75a4b4f9":"sale_data['MOS'].iloc[0]","1da39ff4":"sale_data['MOS'].iloc[0].tz_localize(sale_data['TimeZone'].iloc[0])","189330f7":"list_mos_timestamps = []\nlist_mos_timestamps","c5197d92":"for i in range(len(sale_data)):\n    lo = pd.to_datetime(sale_data['MOS'].iloc[i].tz_localize(\n        sale_data['TimeZone'].iloc[i], ambiguous='raise', nonexistent='raise'))\n    \n    list_mos_timestamps.append(lo)","ced77b0f":"list_mos_timestamps[:10]","af1070e2":"list_mos_timestamps","befb4d94":" list_mos_timestamps[0].strftime('%Y-%m-%d %H:%M:%S')","7244939e":"list_mos_timestamps[0].strftime('%z')","cf73d86d":"float(list_mos_timestamps[0].strftime('%z'))\/100","e4695224":"list_mos_timestamps[0].date()","dd02226f":"list_mos_timestamps[0].time()","9978754e":"list_mos_timestamps[0].utcoffset()","554ee844":"list_mos_timestamps[0].utcoffset().total_seconds()\/3600","b02d437b":"sale_data['OffsetUTC'] = [list_mos_timestamps[i].utcoffset().total_seconds()\/3600 for i in range(len(sale_data))]","da6cd2a1":"sale_data.head()","ffd22a0f":"sale_data.columns ","07706598":"Column_name_reordered = ['RetailerCountry','MOS','TimeZone','OffsetUTC','RetailerType','Product','Sales Revenue ($)']\nsale_date = sale_data[Column_name_reordered]\nsale_date.head()","0a743bf6":"sale_date.groupby(['TimeZone', 'OffsetUTC']).count()","81d2b9ea":"sale_data[sale_data['TimeZone'] == 'CET'].sort_values('OffsetUTC')","3ef0edbc":"sale_data.sort_values(['MOS'])","c0828f33":"sale_data['MOS-UTC'] = [pd.to_datetime(sale_data[\"MOS\"].iloc[i]).tz_localize(sale_data[\"TimeZone\"].iloc[i]).tz_convert('UTC')\n                       for i in range(len(sale_data))]","14108c75":"sale_data.head()","3079f7f8":"Column_name_reordered = ['RetailerCountry','MOS-UTC','MOS','TimeZone','OffsetUTC','RetailerType','Product','Sales Revenue ($)']\nsale_data = sale_data[Column_name_reordered]\nsale_data.head()","1310c87d":"sale_data.sort_values(\"MOS-UTC\")","1d91450a":"sale_data.groupby('TimeZone').mean()","2c9df55d":"sale_data.groupby('TimeZone').count()","1c4a5da9":"sale_data.groupby(['TimeZone', 'OffsetUTC']).count()","85e5834c":"sale_data.groupby('TimeZone').count().sort_values('Product', ascending=False)","85518dc3":"sale_data.head()","b9c9296c":"sales_data_viz = sale_data.reset_index()\nsales_data_viz.head()","a7741621":"sales_data_viz = sales_data_viz.set_index('MOS-UTC').sort_index()\nsales_data_viz.head()","db200e41":"plt.scatter(sales_data_viz['OffsetUTC'], sales_data_viz['RetailerType'])","6f16a4ac":"total_sales_revenue_by_timezones = sales_data_viz.groupby('TimeZone').sum()\ntotal_sales_revenue_by_timezones","6fbb8eb2":"plt.bar(total_sales_revenue_by_timezones.index,\n       height = total_sales_revenue_by_timezones['Sales Revenue ($)'])","2bcd11a8":"plt.figure(figsize=(7,6))\n\nplt.bar(total_sales_revenue_by_timezones.index,\n       height = total_sales_revenue_by_timezones['Sales Revenue ($)'], color = '#108A99')\n\nplt.xticks(rotation = 45, fontsize=13)\nplt.yticks(fontsize= 13)\nplt.title(\"Total Sales Revenue by TimeZones\", fontsize=18, fontweight='bold')\nplt.ylabel(\"Sales Revenue ($)\", fontsize = 13)\n\nplt.show()","3ed290f7":"averages_by_timezones = sales_data_viz.groupby(['TimeZone']).mean().sort_values(\"Sales Revenue ($)\", ascending=False)\naverages_by_timezones","bc9e1372":"plt.bar(averages_by_timezones.index,\n       height= averages_by_timezones['Sales Revenue ($)'],\n       color = ['green', 'blue','red','darkblue','yellow','purple'])\n\nplt.xticks(rotation = 45, fontsize=13)\nplt.yticks(fontsize= 13)\nplt.title(\"Total Sales Revenue by TimeZones\", fontsize=18, fontweight='bold')\nplt.ylabel(\"Sales Revenue ($)\", fontsize = 13)\n\nplt.show()","5493e733":"## Part - 4 Data Visualization \n- **Subtask 4:**","326dd331":"# Main Task:\n### Obtain information about the product sales of the various retailer types in UTC offset. Display the average amount of sales that occurred in each time zone.","3e4af3c7":"## Introduction","b4c88d28":"### Solution map:\n   - <b>Subtask 1:<\/b> Store the date and time values in a single column called \"MOS\", denoting \"Moment of Sale\". Verify that the time zone values stored in \"sales_data\" are valid and can be manipulated with the pytz module. (Data Preparation)\n   \n   - <b>Subtask 2:<\/b> Estimate the offset of the values of \"MOS\" to UTC. Store them in a column called \"OffsetUTC\". (Data Manipulation)\n   \n   - <b>Subtask 3:<\/b> Order all sales according to a reconciled UTC-equivalent of the moment of sale and analyze the data. (Data Analysis)\n   \n   - <b>Subtask 4:<\/b> Obtain statistics and visualizations that will respond to the Main Task and further improve the analysis of your data. (Data Visualization)","46625f6f":"## Part - 3 Data Analysis\n- **Subtask 3:**","60aee7fc":"## Part - 2 Data Manipulation \n\n- **Subtask 2:**","66cb0dbd":"## Part - 1 Data preparation \n\n- **Subtask 1:**"}}