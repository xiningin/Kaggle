{"cell_type":{"5754f87d":"code","9f7c426a":"code","4e3c38d4":"code","ee9e0cea":"code","29f5e1b7":"code","a757464e":"code","9778df90":"code","cd8741aa":"code","48ad5dba":"code","f7d50a40":"code","4c7898dd":"markdown","f083acb8":"markdown"},"source":{"5754f87d":"import numpy as np\nimport pandas as pd\nimport os\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom tqdm import tqdm","9f7c426a":"train=pd.read_csv('..\/input\/tabular-playground-series-oct-2021\/train.csv')\ntest=pd.read_csv('..\/input\/tabular-playground-series-oct-2021\/test.csv')","4e3c38d4":"print(train.columns.tolist())\nprint(test.columns.tolist())","ee9e0cea":"train","29f5e1b7":"test","a757464e":"train.target.value_counts()","9778df90":"train.iloc[:,:].hist(figsize=(18,18))\nplt.show()","cd8741aa":"test.iloc[:,:].hist(figsize=(18,18))\nplt.show()","48ad5dba":"cols=train.columns.tolist()\nprint(cols)","f7d50a40":"fig, ax = plt.subplots(72,4,figsize=(16,160))\nfor i in tqdm(range(288)):\n    if i<287:\n        r=i\/\/4\n        c=i%4\n        sns.histplot(train[train.target==0][cols[i]], label=cols[i]+' target=0', ax=ax[r,c], color='black',bins=20)\n        sns.histplot(train[train.target==1][cols[i]], label=cols[i]+' target=1', ax=ax[r,c], color='C1',bins=20)\n        ax[r,c].legend()\n        ax[r,c].grid()\n    else:\n        r=i\/\/4\n        c=i%4\n        ax[r,c].axis(\"off\")       \nplt.show()","4c7898dd":"fig, ax = plt.subplots(figsize=(4,2))\nsns.histplot(train[train.target==0]['f1'], label='f1 target=0', ax=ax, color='black',bins=20)\nsns.histplot(train[train.target==1]['f1'], label='f1 target=1', ax=ax, color='C1',bins=20)\nax.legend()\nax.grid()","f083acb8":"import tensorflow as tf\ntry:\n    tpu = tf.distribute.cluster_resolver.TPUClusterResolver()\n    print('Device:', tpu.master())\n    tf.config.experimental_connect_to_cluster(tpu)\n    tf.tpu.experimental.initialize_tpu_system(tpu)\n    strategy = tf.distribute.experimental.TPUStrategy(tpu)\nexcept:\n    strategy = tf.distribute.get_strategy()\nprint('Number of replicas:', strategy.num_replicas_in_sync)"}}