{"cell_type":{"211ee448":"code","f66c1a70":"code","a3069b32":"code","bb95f1f8":"code","8b0792bb":"code","e3361ff6":"code","e0f90fad":"code","c4e2ad0e":"code","7551d769":"code","626af455":"code","2c704579":"code","5ea4f6c7":"code","82f8ab7b":"code","af58e04d":"code","f68aeddd":"code","bfa5de4b":"code","dc875a9d":"code","52dd443d":"code","bb8b86a7":"code","42e51957":"code","bab025fc":"code","a9ff7a0d":"markdown","9b6b2c2d":"markdown","03694e78":"markdown","56004172":"markdown","153e0202":"markdown","b403cead":"markdown","14bd84b8":"markdown","370211b6":"markdown","7bf718ec":"markdown","acd1b713":"markdown"},"source":{"211ee448":"import numpy as np\nimport pandas as pd ","f66c1a70":"myData=pd.read_csv('..\/input\/autompg-dataset\/auto-mpg.csv')\nmyData.head(10)","a3069b32":"## clone the datasets\ncmyData=myData.copy()","bb95f1f8":"## Remove car name feature\ncmyData=cmyData.drop(columns='car name',axis=1)\ncmyData.head()","8b0792bb":"## Replace 1 as American,2 as Europian,3 as Japanese\ncmyData['origin']=cmyData['origin'].replace({1:'American',2:'Europian',3:'Japanese'})\ncmyData.head()","e3361ff6":"## create 3 simple true or false columns for origin feature\ncmyData=pd.get_dummies(cmyData,columns=['origin'])\ncmyData","e0f90fad":"## Verify the presence of Null value\ncmyData[cmyData.isna().any(axis=1)]","c4e2ad0e":"cmyData.dtypes","7551d769":"## Verify the presence of any value other than numeric\nhpIsdigit=pd.DataFrame(cmyData['horsepower'].str.isdigit())\ncmyData[hpIsdigit['horsepower']==False]","626af455":"## Replace these ? mark to NaN value\ncmyData=cmyData.replace('?',np.nan)","2c704579":"## Replace NaN value with its median value and convert the dtypes\ncmyData=cmyData.fillna(cmyData.median())\ncmyData['horsepower']=cmyData['horsepower'].astype('float64')","5ea4f6c7":"import matplotlib.pyplot as plt\nimport seaborn as sns\nsns.pairplot(cmyData)","82f8ab7b":"ax=cmyData.boxplot(figsize=(20,15))\nax.set_xticklabels(ax.get_xticklabels(),rotation=45 )\nax.tick_params(axis='both', which='major', labelsize=13)\nplt.show()","af58e04d":"cmyData=cmyData.drop(columns='origin_Japanese')\nX=cmyData.drop(['mpg'],axis=1)\ny=cmyData['mpg']","f68aeddd":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.3,random_state=1)","bfa5de4b":"from sklearn.linear_model import LinearRegression\nregression_model=LinearRegression()\nregression_model.fit(X_train,y_train)","dc875a9d":"## Get score on training data\nregression_model.score(X_train,y_train)","52dd443d":"#out of sample score (R^2)\nregression_model.score(X_test,y_test)","bb8b86a7":"from sklearn.preprocessing import PolynomialFeatures\npoly=PolynomialFeatures(degree=2,interaction_only=True)\nX_train2=poly.fit_transform(X_train)\nX_test2=poly.fit_transform(X_test)","42e51957":"#Out off sample (testing) R^2 is our measure of sucess and does improve\n\n## Fit polynomial\nregression_model.fit(X_train2,y_train)\n\n#In sample (training) R^2 will always improve with the number of variables!\nprint(regression_model.score(X_train2,y_train))\n\n#Out off sample (testing) R^2 is our measure of sucess and does improve\nprint(regression_model.score(X_test2,y_test))","bab025fc":"# but this improves as the cost of 29 extra variables!\nprint(X_train.shape)\nprint(X_train2.shape)","a9ff7a0d":"Polynomial Features (with only interaction terms) have improved the Out of sample R^2. However at the cost of increaing the number of variables significantly.","9b6b2c2d":"## Read CSV File ","03694e78":"## Fit Linear model","56004172":"## **Split Data**","153e0202":"## Adding Interaction Term ","b403cead":"**1**.Here we observed car name feature is not required so can be deleted\n\n\n**2**.Values like 'america' cannot be read into an equation. Using substitutes like 1 for america, 2 for europe and 3 for asia would end up implying that european cars fall exactly half way between american and asian cars! we dont want to impose such an baseless assumption!\n\nSo we create 3 simple true or false columns with titles equivalent to \"Is this car America?\", \"Is this care European?\" and \"Is this car Asian?\". These will be used as independent variables without imposing any kind of ordering between the three regions.","14bd84b8":"Here we got to know there are no NaN value present","370211b6":"Here we observe horsepower contains object value instead of float.","7bf718ec":"Observation between 'mpg' and other attributes indicate the relationship is not really linear. However, the plots also indicate that linearity would still capture quite a bit of useful information\/pattern. Several assumptions of classical linear regression seem to be violated, including the assumption of no Heteroscedasticity","acd1b713":"Not much outliers are present."}}