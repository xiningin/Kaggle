{"cell_type":{"3bb5a621":"code","4e627405":"code","e41faecb":"code","6c2b9897":"code","6a4205b0":"code","c22efe41":"code","547aad48":"code","858bd21d":"code","2ab7142a":"code","69d19f14":"code","9057bd5e":"code","5b73cce8":"code","096d7ee4":"code","d9560638":"code","023ecc3c":"code","0a19e797":"code","216991a2":"code","4747c459":"code","358f694f":"code","26795332":"code","5326c3cb":"code","921a8f9a":"code","cbea0546":"code","64b3f36b":"code","82353abd":"code","03f68632":"code","72e3932a":"code","ada6d3a3":"code","a0ab4fd2":"code","f2d2d3bf":"code","f528e6af":"code","a409feb3":"code","41a8b2db":"code","ba0edb88":"code","2cd73c66":"code","ced23ad0":"code","a28a0403":"code","cdf6915f":"code","e122893a":"code","385202b5":"code","106f5410":"code","0fe554b4":"code","72d4ea01":"code","87c96ef0":"code","71810080":"code","56e0ce4f":"code","70cc1aea":"code","fb52d048":"code","1866435a":"code","f52ee323":"code","5b9de1c8":"code","42cd4749":"code","e54a1eb6":"code","6eca762f":"markdown","22aa289d":"markdown","2c6bf248":"markdown","cfae3e9b":"markdown","d04f447e":"markdown","36fca9ab":"markdown","0bd5734a":"markdown","dcdcf008":"markdown","74807326":"markdown","49b09a57":"markdown","6d60fc28":"markdown","2ea86cae":"markdown","08a8ea76":"markdown","1b2ae0fe":"markdown","e098efa3":"markdown","3ae472f8":"markdown"},"source":{"3bb5a621":"import numpy as np #Import all necessary libraries\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","4e627405":"df=pd.read_csv('..\/input\/real-estate-price-prediction\/Real estate.csv')\n","e41faecb":"df.head()","6c2b9897":"df.info()","6a4205b0":"df.columns","c22efe41":"df.shape","547aad48":"df.describe","858bd21d":"g= sns.pairplot(df)\ng.map_upper(plt.scatter)","2ab7142a":"plt.figure(figsize=(10,4))\nsns.displot(df['Y house price of unit area'],kde=True,bins=20, aspect=2)\nplt.xlabel('house price of unit area')","69d19f14":"plt.figure(figsize=(5, 5), dpi=100)\n\nsns.scatterplot(data=df, y=df['Y house price of unit area'], x=df['X1 transaction date'] , hue= 'X2 house age', palette=\"rocket\")\n","9057bd5e":"X= df.drop('Y house price of unit area', axis=1)\ny=df['Y house price of unit area']","5b73cce8":"def missing_percent(train_set):\n    nan_percent = 100*(train_set.isnull().sum()\/len(train_set))\n    nan_percent = nan_percent[nan_percent>0].sort_values(ascending=False).round(1)\n    DataFrame = pd.DataFrame(nan_percent)\n    # Rename the columns\n    mis_percent_table = DataFrame.rename(columns = {0 : '% of Misiing Values'}) \n    # Sort the table by percentage of missing descending\n    mis_percent = mis_percent_table\n    return mis_percent","096d7ee4":"from sklearn.preprocessing import PolynomialFeatures\n","d9560638":"polynomial_converter= PolynomialFeatures(degree=3, include_bias=False)","023ecc3c":"poly_features= polynomial_converter.fit_transform(X)\n","0a19e797":"poly_features.shape","216991a2":"from sklearn.model_selection import train_test_split\n","4747c459":"X_train, X_test, y_train, y_test = train_test_split(poly_features, y, test_size=0.3, random_state=101)\n","358f694f":"from sklearn.preprocessing import StandardScaler\n","26795332":"scaler= StandardScaler()","5326c3cb":"scaler.fit(X_train)","921a8f9a":"X_train= scaler.transform(X_train)\nX_test= scaler.transform(X_test)","cbea0546":"#Train the Model\nfrom sklearn.linear_model import Ridge","64b3f36b":"ridge_model= Ridge(alpha=10)","82353abd":"ridge_model.fit(X_train, y_train)","03f68632":"#predict Test Data\ny_pred= ridge_model.predict(X_test)","72e3932a":"#Evaluating the Model\nfrom sklearn.metrics import mean_absolute_error, mean_squared_error\n\nMAE= mean_absolute_error(y_test, y_pred)\nMSE= mean_squared_error(y_test, y_pred)\nRMSE= np.sqrt(MSE)","ada6d3a3":"pd.DataFrame([MAE, MSE, RMSE], index=['MAE', 'MSE', 'RMSE'], columns=['metrics'])","a0ab4fd2":"#Train the Model\nfrom sklearn.linear_model import RidgeCV","f2d2d3bf":"ridge_cv_model=RidgeCV(alphas=(0.1, 1.0, 10.0), scoring='neg_mean_absolute_error')","f528e6af":"ridge_cv_model=RidgeCV(alphas=(0.1, 1.0, 10.0), scoring='neg_mean_absolute_error')","a409feb3":"ridge_cv_model.fit(X_train, y_train)","41a8b2db":"ridge_cv_model.alpha_","ba0edb88":"#Predicting Test Data\ny_pred_ridge= ridge_cv_model.predict(X_test)","2cd73c66":"MAE_ridge= mean_absolute_error(y_test, y_pred_ridge)\nMSE_ridge= mean_squared_error(y_test, y_pred_ridge)\nRMSE_ridge= np.sqrt(MSE_ridge)","ced23ad0":"pd.DataFrame([MAE_ridge, MSE_ridge, RMSE_ridge], index=['MAE', 'MSE', 'RMSE'], columns=['Ridge Metrics'])","a28a0403":"ridge_cv_model.coef_","cdf6915f":"from sklearn.linear_model import LassoCV","e122893a":"lasso_cv_model= LassoCV(eps=0.1, n_alphas=100, cv=5)","385202b5":"lasso_cv_model.fit(X_train, y_train)","106f5410":"lasso_cv_model.alpha_","0fe554b4":"y_pred_lasso= lasso_cv_model.predict(X_test)","72d4ea01":"MAE_Lasso= mean_absolute_error(y_test, y_pred_lasso)\nMSE_Lasso= mean_squared_error(y_test, y_pred_lasso)\nRMSE_Lasso= np.sqrt(MSE_Lasso)","87c96ef0":"pd.DataFrame([MAE_Lasso, MSE_Lasso, RMSE_Lasso], index=['MAE', 'MSE', 'RMSE'], columns=['Lasso Metrics'])","71810080":"lasso_cv_model.coef_","56e0ce4f":"from sklearn.linear_model import ElasticNetCV","70cc1aea":"elastic_model= ElasticNetCV(l1_ratio=[0.1, 0.5, 0.7, 0.9, 0.95, 0.99, 1],cv=5, max_iter=100000)","fb52d048":"elastic_model.fit(X_train, y_train)","1866435a":"elastic_model.l1_ratio_","f52ee323":"y_pred_elastic=elastic_model.predict(X_test)","5b9de1c8":"MAE_Elastic= mean_absolute_error(y_test, y_pred_elastic)\nMSE_Elastic= mean_squared_error(y_test, y_pred_elastic)\nRMSE_Elastic= np.sqrt(MSE_Elastic)\n","42cd4749":"pd.DataFrame([MAE_Elastic, MSE_Elastic, RMSE_Elastic], index=['MAE', 'MSE', 'RMSE'], columns=['Elastic Metrics'])","e54a1eb6":"elastic_model.coef_","6eca762f":"<h3> Ridge Regression (Coosing an alpha value with Cross-Validation)<\/h3>","22aa289d":"<h3>2-Import the dataset:<\/h3>","2c6bf248":"<h3>9-Regularization<\/h3>","cfae3e9b":"<h1 style=\"font-family:verdana;\">Introduction<\/h1>\n\n<p>One of the most common problems data science professionals face is to avoid overfitting. Have you come across a situation where your model performed exceptionally well on train data but was not able to predict test data. Or you were on the top of the competition on the public leaderboard, only to fall hundreds of places in the final rankings? Well \u2013 this notebook write for solve this problem using regularization<\/p>\n\n<b>what is Regularization:<\/b><br>\nThis is a form of regression, that constrains\/ regularizes or shrinks the coefficient estimates towards zero. In other words, this technique discourages learning a more complex or flexible model, so as to avoid the risk of overfitting.\n\n\n\nSome of the regularization techniques are  given below:\n<ul>\n<li>L1 Regularization  -><a href=\"#Lasso\">Lasso Regression<\/a><\/li>\n\n\n<li>L2 Regularization  -><a href=\"#Ridge\">Ridge Regression<\/a><\/li>\n<li>Combining L1 & L2  -><a href=\"#Elastic\">Elastic Net<\/a><\/li><\/ul>\n\n","d04f447e":"Lasso, or Least Absolute Shrinkage and Selection Operator, is quite similar conceptually to ridge regression. It also adds a penalty for non-zero coefficients, but unlike ridge regression which penalizes sum of squared coefficients (the so-called L2 penalty), lasso penalizes the sum of their absolute values (L1 penalty). As a result, for high values of \u03bb, many coefficients are exactly zeroed under lasso, which is never the case in ridge regression.\n\n","36fca9ab":"<h3>\n<p id=\"Lasso\">B-Lasso Regression<\/p>\n    <\/h3>","0bd5734a":"<h3>4-EDA<\/h3>","dcdcf008":"<h5><p id=\"Ridge\">A-Ridge Regression<\/p><\/h5>","74807326":"<h3>1-Import all Necessary Libraries<h3>   \n","49b09a57":"<h3>3- Data Overview<\/h3>","6d60fc28":"<h3>6-Preprocessing (Polynomial Conversion)<\/h3>","2ea86cae":"<h3><p id =\"Elastic\">C-Elastic Net<\/p><\/h3>","08a8ea76":"<h1 style=\"font-family:verdana;\">Dataset<\/h1>\nThe data set is Real estate price prediction that is used for regression analysis, mutiple regression,linear regression, prediction. Since house price is a continues variable, this is a regression problem. The data contains 8columns that include sixFeatures(X) and one Label(y): house price of unit area.\n\n","1b2ae0fe":"<h3>7-Split the Data to Train & Test<\/h3>","e098efa3":"<h3>5-Determine the Features & Target Variable (Lable)<\/h3>","3ae472f8":"<h3>8-Scaling the Data<\/h3>"}}