{"cell_type":{"c359fb60":"code","80a25361":"code","4105a14e":"code","d3ad771f":"code","d3f7f00c":"code","c541082c":"code","96c32da8":"code","203b9dae":"code","824251ff":"code","70463d7c":"code","0b63127b":"code","319f923a":"code","37fe9a7f":"code","c97d0851":"code","1c6e8383":"code","bc2326dd":"code","6d294a2f":"code","ce84f327":"code","a88a4d89":"code","d466fa91":"code","31f1d25a":"code","1d4b27da":"code","bbd5555f":"code","67c2ec7b":"code","1509f529":"code","e0d8b1e8":"code","23dedb8f":"code","4218e710":"code","5ac9d594":"code","17560322":"code","cc02e7f6":"code","b2e3e2f1":"code","6c8c6ee2":"code","e4c02e38":"code","271e4805":"code","c9a400b0":"code","077a7f03":"code","26ea0581":"code","c2f475f3":"code","25804fed":"code","4b9df50e":"code","87ab49f6":"markdown","502c6d5c":"markdown","0b648f78":"markdown","7f2b4dcd":"markdown","77a7f0ed":"markdown","7c5934bd":"markdown"},"source":{"c359fb60":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport warnings\nwarnings.filterwarnings('ignore')","80a25361":"true=pd.read_csv('\/kaggle\/input\/fake-and-real-news-dataset\/True.csv')\ntrue.head()","4105a14e":"true['subject'].unique()","d3ad771f":"true.info()","d3f7f00c":"true.isnull().sum()","c541082c":"true['Prediction']=np.ones(true.shape[0])","96c32da8":"fake=pd.read_csv('\/kaggle\/input\/fake-and-real-news-dataset\/Fake.csv')\nfake.head()","203b9dae":"fake['subject'].unique()","824251ff":"fake.info()","70463d7c":"fake.isnull().sum()","0b63127b":"fake['Prediction']=np.zeros(fake.shape[0])","319f923a":"data=pd.concat([true,fake])","37fe9a7f":"data.head()","c97d0851":"data.shape","1c6e8383":"sns.countplot(data['Prediction'])","bc2326dd":"data['Details']=data['title']+' '+data['text']+' '+data['subject']","6d294a2f":"data.drop(['title','text','subject'],axis=1,inplace=True)","ce84f327":"data.head()","a88a4d89":"from sklearn.feature_extraction.text import CountVectorizer, TfidfTransformer","d466fa91":"cv=CountVectorizer(stop_words='english')","31f1d25a":"words=cv.fit_transform(data['Details'])","1d4b27da":"cv.vocabulary_","bbd5555f":"X=words","67c2ec7b":"y=data['Prediction'].values","1509f529":"from sklearn.model_selection import train_test_split","e0d8b1e8":"X_train, X_, y_train, y_ = train_test_split(X, y, test_size=0.30, random_state=101)","23dedb8f":"X_val, X_test, y_val, y_test = train_test_split(X_, y_, test_size=0.15, random_state=101)","4218e710":"tfidf=TfidfTransformer()","5ac9d594":"tfidf_X_train=tfidf.fit_transform(X_train)","17560322":"tfidf_X_val=tfidf.fit_transform(X_val)","cc02e7f6":"tfidf_X_test=tfidf.transform(X_test)","b2e3e2f1":"from sklearn.naive_bayes import MultinomialNB\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier","6c8c6ee2":"lr_model=LogisticRegression()\nlr_model.fit(tfidf_X_train,y_train)","e4c02e38":"mnb_model=MultinomialNB()\nmnb_model.fit(tfidf_X_train,y_train)","271e4805":"rfc_model=RandomForestClassifier()\nrfc_model.fit(tfidf_X_train,y_train)","c9a400b0":"from sklearn.metrics import plot_confusion_matrix,classification_report,plot_precision_recall_curve,plot_roc_curve","077a7f03":"def report(model):\n    preds = model.predict(tfidf_X_val)\n    print(classification_report(preds,y_val))\n    plot_confusion_matrix(model,tfidf_X_val,y_val)\n    plot_precision_recall_curve(model,tfidf_X_val,y_val)\n    plot_roc_curve(model,tfidf_X_val,y_val)","26ea0581":"print('LOGISTIC REGRESSION')\nreport(lr_model)","c2f475f3":"print('NAIVE BAYES MODEL')\nreport(mnb_model)","25804fed":"print('RANDOM FOREST CLASSIFIER')\nreport(rfc_model)","4b9df50e":"preds = rfc_model.predict(tfidf_X_test)\nprint(classification_report(preds,y_test))\nplot_confusion_matrix(rfc_model,tfidf_X_test,y_test)\nplot_precision_recall_curve(rfc_model,tfidf_X_test,y_test)\nplot_roc_curve(rfc_model,tfidf_X_test,y_test)","87ab49f6":"###### Modelling","502c6d5c":"###### Note: Created a dataframe with 'Predicion' as a new column with 1 or 0 as its value for Real or Fake news respectively.","0b648f78":"We will create a Validation set alongwith the Train, Test set, which we can use for finding the best model and then after hyperparameter tuning finally we can apply the best suited model on the test set which will be completely unknown to the model.","7f2b4dcd":"######  Feature Extraction","77a7f0ed":"###### Feature Selection","7c5934bd":"###### Note: Since the model performed well with the default parameters so I will proceed with the model as it is without hyperparameter tuning, for the final predictions."}}