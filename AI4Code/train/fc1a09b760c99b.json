{"cell_type":{"837c5f34":"code","a04e7c88":"code","285d39fb":"code","974cf9c7":"code","458abe57":"code","0b9f71a6":"markdown"},"source":{"837c5f34":"# Import package\nimport pandas as pd\nimport numpy as np\n\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import r2_score, mean_squared_error\n\n# Import data\nX_train = pd.read_csv('\/kaggle\/input\/used-car-price-dataset-competition-format\/X_train.csv')\nX_test = pd.read_csv('\/kaggle\/input\/used-car-price-dataset-competition-format\/X_test.csv')\ny_train = pd.read_csv('\/kaggle\/input\/used-car-price-dataset-competition-format\/y_train.csv')\ny_test = pd.read_csv('\/kaggle\/input\/used-car-price-dataset-competition-format\/test_label\/y_test.csv')","a04e7c88":"# Data Check\n\nprint(X_train.isnull().sum()) # \uacb0\uce21\uce58 \uc5c6\uc74c\nprint(X_train.head(5))        # Data \ud655\uc778: \uba85\ubaa9\ud615 \ubcc0\uc218 \ud655\uc778","285d39fb":"# \uba85\ubaa9\ud615 \ubcc0\uc218 \uc218\uce58\ud654\n\nle_brand = LabelEncoder()\nle_model = LabelEncoder()\nle_transmission = LabelEncoder()\nle_fueltype = LabelEncoder()\n\nX_train['brand'] = le_brand.fit_transform(X_train['brand'])\nX_train['model'] = le_model.fit_transform(X_train['model'])\nX_train['transmission'] = le_transmission.fit_transform(X_train['transmission'])\nX_train['fuelType'] = le_fueltype.fit_transform(X_train['fuelType'])","974cf9c7":"# Random Forest fitting\nrf_reg = RandomForestRegressor(random_state=1)\nrf_reg.fit(X_train.drop(['carID'], axis=1), y_train['price'])\n\n# Test data preprocessing\nX_test['brand'] = le_brand.transform(X_test['brand'])\nX_test['model'] = le_model.transform(X_test['model'])\nX_test['transmission'] = le_transmission.transform(X_test['transmission'])\nX_test['fuelType'] = le_fueltype.transform(X_test['fuelType'])","458abe57":"# Prediction\npred = rf_reg.predict(X_test.drop(['carID'], axis=1))\n\n# Metrics\nr2_score = r2_score(y_test['price'], pred)\nrmse = mean_squared_error(y_test['price'],pred, squared=False)\n\nprint(\"r2_score: \", r2_score)\nprint(\"RMSE: \", rmse)\n\n# Submission\npd.DataFrame({'carID': y_test['carID'], 'pred': pred}).to_csv('submission.csv', index = False)\n\ndf = pd.read_csv('submission.csv')\ndf.head()","0b9f71a6":"(\ucc38\uace0) Random Forest\ub294 One-hot-encoding(\ub354\ubbf8\ubcc0\uc218\ud654) \ubd88\ud544\uc694 \/ Scaling \uc758\ubbf8\uc5c6\uc74c"}}