{"cell_type":{"1cebd6cc":"code","a48d2d15":"code","2c73414d":"code","a01d12e0":"code","3593ce35":"code","775ddd35":"code","d417f6ea":"code","5725913e":"code","6a94c081":"code","b18a0bb3":"code","a4659149":"code","e39c9d74":"code","401aa08e":"code","aa8b7a2b":"code","768600ec":"code","694193c8":"code","0dea4988":"code","7d6a5f44":"code","a7d98ca2":"code","1db3b866":"code","b497b9e5":"code","8c7d276b":"code","6ba25db1":"code","a37c6c08":"code","4de1bfcf":"code","557876c0":"code","565d11a1":"code","44d4e6e0":"code","9c9378a2":"code","b3c58d0f":"code","4fc5a642":"code","b108409c":"markdown","bfeb5046":"markdown","50623d3a":"markdown","712103bd":"markdown","98f8142b":"markdown","6eb9fbf3":"markdown","c7e08147":"markdown"},"source":{"1cebd6cc":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","a48d2d15":"%reload_ext autoreload\n%autoreload 2\n%matplotlib inline","2c73414d":"from fastai.vision import *","a01d12e0":"path = Path('\/kaggle\/input\/blood-cells\/dataset2-master\/dataset2-master\/images')\npath.ls()","3593ce35":"(path\/'TRAIN').ls()","775ddd35":"data = ImageDataBunch.from_folder(path, train='TRAIN', test='TEST', valid_pct=0.20,\n        ds_tfms=get_transforms(), size=224, num_workers=4).normalize(imagenet_stats)","d417f6ea":"data","5725913e":"data.show_batch(rows=3, figsize=(10,10))","6a94c081":"data.c, len(data.train_ds), len(data.valid_ds), len(data.classes), len(data.test_ds)","b18a0bb3":"learn = cnn_learner(data, models.resnet34, metrics=error_rate)","a4659149":"learn.fit_one_cycle(4)","e39c9d74":"learn.model_dir=Path('\/kaggle\/working')\nlearn.save('stage-1')","401aa08e":"interp = ClassificationInterpretation.from_learner(learn)","aa8b7a2b":"interp.plot_top_losses(9,figsize=(20,11))","768600ec":"doc(interp.plot_top_losses)","694193c8":"interp.plot_confusion_matrix(figsize=(12,12), dpi=100)","0dea4988":"interp.most_confused(min_val = 2)","7d6a5f44":"help(interp.confusion_matrix)","a7d98ca2":"learn.unfreeze()","1db3b866":"learn.fit_one_cycle(1)","b497b9e5":"learn.load('stage-1')","8c7d276b":"learn.lr_find()","6ba25db1":"learn.recorder.plot()","a37c6c08":"learn.unfreeze()\nlearn.fit_one_cycle(2, max_lr=slice(1e-6,1e-4))","4de1bfcf":"learn.save('model_resnet34')","557876c0":"interp = ClassificationInterpretation.from_learner(learn)","565d11a1":"interp.plot_confusion_matrix(figsize=(12,12), dpi=100)","44d4e6e0":"interp.most_confused()","9c9378a2":"learn","b3c58d0f":"doc(learn.predict)","4fc5a642":"doc(ImageDataBunch.from_folder)","b108409c":"the above result looks very good? it seems to cut the error by half of what we get from the previous learning cycle without any learning rate optimization ... or is this always true. There are scenarios that i haven't even tried, for example what if I just kept on iterating or increase the epoch cycle from 4 to say 10, would the error get decreased? Until the next kernel ...","bfeb5046":"why is the result is better than previous fit cycle, this should not be the case. Or probably Fast.ai course by Jeremy has some concept problem. Probably it turns out the certain images has a different effect on this whole learning cycle ???","50623d3a":"Looking at the error rate above around 2% it seems the model is getting better than the previous fir cycle.","712103bd":"Notice how the 'label' of the Y (the answer) is named after the folder. So all that belongs to 'MONOCYTE' is placed on that particular folder. In this case we want to use ImageDataBunch.from_folder to create the data object","98f8142b":"Loading the previous trained model again, we want to find the optimum learning rate.","6eb9fbf3":"let's see what the structure of the data look like:","c7e08147":"Unfreezeing, fine tuning and learning rates"}}