{"cell_type":{"8e1e2868":"code","ce08a6d8":"code","301cea60":"code","0a41355b":"code","be128241":"code","b7587fe0":"code","bb56c99b":"code","385348e3":"code","98f122dc":"code","a201bff4":"code","072080d0":"code","ed5ced3d":"code","01828a4f":"code","b8bd2eda":"code","13dfcfb9":"code","6564e217":"code","d3471c30":"code","6ffb9fb3":"code","0a3deb76":"code","743b0a3b":"code","bf5d4ba8":"code","0f246fce":"code","d693100c":"code","a7720b52":"code","96215afc":"code","a6617c75":"code","24fcb78e":"code","118be6a8":"code","114347e2":"code","36856d82":"code","f51b6fee":"code","06e99357":"code","67dc68e0":"markdown","195985b5":"markdown","8e1ffdd6":"markdown","5d49b83c":"markdown","b85d5e0f":"markdown","f62415e6":"markdown","81a381fd":"markdown","40b410bb":"markdown","effba8eb":"markdown","347ca055":"markdown","0e973b39":"markdown","94bdca89":"markdown","a8ba842a":"markdown","8a6971c1":"markdown","6048142c":"markdown","e9337959":"markdown"},"source":{"8e1e2868":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","ce08a6d8":"# Import the pandas library to load the data into a datframe\nimport pandas as pd","301cea60":"# Load csv file to create dataframe\ndata = pd.read_csv('\/kaggle\/input\/co2-emission-by-vehicles\/CO2 Emissions_Canada.csv')","0a41355b":"# Review few dataframe observations to get an understanding of the dataset\ndata.head()","be128241":"# Check dataset dimensions. Our dataset consists of 7,385 observationsa and 12 features.\nprint(data.shape)\nprint()\n# We further check the features in the dataset along with thier data types.\nprint(data.dtypes)\n# The dataset has 12 feautres which includes both continuous as well as categorical variables.","b7587fe0":"# Review summary statistics\ndata.describe().T","bb56c99b":"# Examining correlation among the continuous variables\ndata.corr()","385348e3":"## Visualizing correlations\ncorr = data.corr()\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfig, ax = plt.subplots(figsize=(10, 8))\nax = sns.heatmap(corr, cmap=\"coolwarm\",center=0, annot = True, vmin= -1, vmax = 1)\nax.set_title(\"Correlations Between Various Vehicle Feautures\", size=18)","98f122dc":"# Exploring Relationships Among the Continuous Features\nsns.pairplot(data, kind = 'scatter')\nplt.show()","a201bff4":"# Exploring outliers\ndata.boxplot(figsize=(24,20),rot=90, fontsize = 15)","072080d0":"# Analyzing categorical variables by creating a separate data frame of just categorical variables\ncategorical = data.select_dtypes('object')\ncategorical.shape","ed5ced3d":"categorical.nunique(axis=0)","01828a4f":"# Analyzing the unique values for the Fuel Type feature.\ndata['Fuel Type'].value_counts()","b8bd2eda":"# Removing high cardinarly variables and create a new dataframe\nmod_data = data.copy()\nmod_data = mod_data.drop(labels =['Make', 'Model','Transmission','Vehicle Class'],axis=1)\nmod_data.head()","13dfcfb9":"# Performing one hot encoding for Fuel Type\ncategory = ['Fuel Type']\nfor column in category:\n    tempdf = pd.get_dummies(mod_data[column], prefix=column)\n    mod_data = pd.merge(\n        left=mod_data,\n        right=tempdf,\n        left_index=True,\n        right_index=True,\n    )\n    mod_data = mod_data.drop(columns=column)","6564e217":"# Analyze shape of new data frame\nprint(mod_data.shape)","d3471c30":"# Analyze columns of new data frame\nprint(mod_data.columns)","6ffb9fb3":"# Analyze few observations of new data frame\nmod_data.head()","0a3deb76":"# Checking dataset for missing values\nmod_data.isna().sum()\n","743b0a3b":"# All features in the dataframe\nmod_data.columns","bf5d4ba8":"# Create dataframe for dependent\/target variable\ntarget=mod_data[['CO2 Emissions(g\/km)']]\nprint(target.shape)\nprint()\ntarget.head()","0f246fce":"# Create dataframe for independent\/predictor variables\npredictors = mod_data.drop(['CO2 Emissions(g\/km)'],axis=1)\nprint(predictors.shape)\nprint()\npredictors.head()","d693100c":"# Express target and predictors in terms of X and Y for modeling\nY=target\nX=predictors","a7720b52":"# Split the dataset into training and testing datasets. We will train the model on 80% of the dataset and perform\n# predictions on the remaining 20%\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=0.2)","96215afc":"# Review training data shape\nX_train.shape, Y_train.shape","a6617c75":"# Review test data shape\nX_test.shape, Y_test.shape","24fcb78e":"# Define the regression model\nfrom sklearn.linear_model import LinearRegression\nmodel = LinearRegression()","118be6a8":"# Fit the model on the training datset\nmodel.fit(X_train, Y_train)","114347e2":"#Make predictions on the test dataset\nY_pred = model.predict(X_test)","36856d82":"# Extracting model coefficients\nmodel.coef_","f51b6fee":"# Reviewing features for above coefficients\nX_test.columns","06e99357":"import numpy as np\nfrom sklearn import metrics\nprint('Mean Absolute Error:', metrics.mean_absolute_error(Y_test, Y_pred))\nprint('Mean Squared Error:', metrics.mean_squared_error(Y_test, Y_pred))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(Y_test, Y_pred)))\nprint('Coefficient of Determination\/ R Squared:', metrics.r2_score(Y_test, Y_pred))","67dc68e0":"The table above provides summary statistics for 7 of the continuous variables from the dataset.Below are some observations:\n\n- All the continuous variables have no missing values\n- We see that the CO2 Emissions variable has a high standard deviation indicating that the feature may have some outliers.","195985b5":"We analyze the pairplots above to check if any linear relationships exist within our dataset as the end goal is to create a regression model. We see that our dependent or target variable CO2 Emission does show a linear relationship with Engine Size and Fuel Consumption. We also observe that the variable cyclinder does not display a strong relationship with any of the other numerical features.\nLastly apart from Cylinders, most features have a somewhat normal distribution.","8e1ffdd6":"The boxplot confirms our prior assumption that the feature CO2 Emissions does indeed have many outliers as displayed by the number of outliers outside of the min-max range.","5d49b83c":"## STEP 2 - Perform Exploratory Data Analysis (EDA) on the dataset","b85d5e0f":"The above code deliniates all the categorical features along with their unique values. We see that the most of of these features have a high cardinaliy (greater than 15 unique values) and doing one hot encoding will increase the dimensionality\nof the data set. Therefore, we shall remove all categorical variables except Fuel Type for simplicity.","f62415e6":"### Model Results\n\nFeature Name | Coefficient\n---:|:---\n**Engine Size(L)** | 0.23488204 \n**Cylinders** |1.23679163 \n**Fuel Consumption City (L\/100 km)** | 6.34605784\n**Fuel Consumption Hwy (L\/100 km)** |5.49571414\n**Fuel Consumption Comb (L\/100 km)**|8.07612395\n**Fuel Consumption Comb (mpg)**|-0.87600113\n**Fuel Type_D**|62.21520224\n**Fuel Type_E**|-76.42824714\n**Fuel Type_N**|-49.16173931\n**Fuel Type_X**|31.99724682\n**Fuel Type_Z**|31.37753739\n\n\nPer the model results, the CO2 Emissions increase on average by one unit increase in engine size (precisely 0.23 g\/km based on the coefficient value), number of cylinders and fuel consumption. From a fuel type perspective, CO2 Emissions tend to increase on average when fuel type is Diesel (D) or Gasoline (X or Z). On the other hand, CO2 emissions tend to decrease on average when fuel type is Ethanol or Natural Gas.","81a381fd":"From the model performance metrics, it appears that 99% of the variance in the CO2 Emissions can be determined by the features within our model. While this model has good performance, we simplified the model by omitting several key categorical variables. It would be interesting to see if there is way to retain them within the model, and gain further insights.","40b410bb":"Here is a description of all Fuel Type codes:\n\n- X = regular gasoline\n- Z = premium gasoline\n- D = diesel\n- E = ethanol (E85)\n- N = natural gas\n\nWe observe that the majority of vehicles in our dataset operate on gasoline.","effba8eb":"## STEP 4 - Building the model","347ca055":"# Prediction CO2 Emissions Using Regression","0e973b39":"We see from the correlation matrix above that most of the continuous features within the dataset have a positive correlation which means that an above average value of 1 feature is associated with an above average value of another feature. For example, CO2 emission has a positive correlation of 0.92 with Fuel Consumption city which implies that an above average fuel consumption is associated to above average CO2 emissions. \nThe other feature that stands out is Fuel Consumption Comb (mpg) which has a negative correlations with almost all variables. This could be because of the unit of measurement here is different from the other 'Fuel' variables which are in L\/100km.","94bdca89":"## STEP 1 - Load the dataset and do a preliminary review","a8ba842a":"The dataset is robust and does not have any missing values.","8a6971c1":"Below is the data dictionary for our 12 features:\n\n- Make = Company of the vehicle\n- Model = Model of the car\n- Vehicle Class = Class of vehicle depending on their utility, capacity and weight\n- Engine Size(L) = Size of engine used in Litre\n- Cylinders = Number of cylinders\n- Transmission = Transmission type with number of gears\n- Fuel Type = Type of Fuel used\n- Fuel Consumption City (L\/100 km) = Fuel consumption in city roads (L\/100 km)\n- Fuel Consumption Hwy (L\/100 km) = Fuel consumption in highways (L\/100 km)\n- Fuel Consumption Comb (L\/100 km) = The combined fuel consumption (55% city, 45% highway) is shown in L\/100 km\n- Fuel Consumption Comb (mpg) = The combined fuel consumption in both city and highway is shown in mile per gallon(mpg)\n- CO2 Emissions(g\/km) = The tailpipe emissions of carbon dioxide (in grams per kilometre) for combined city and highway driving","6048142c":"## STEP 3 - Preprocess the dataset for modeling","e9337959":"The goal of this notebook is to predict CO2 emissions in g\/km produced by any vehicle based on certain features. The dataset has been taken from Kaggle - https:\/\/www.kaggle.com\/debajyotipodder\/co2-emission-by-vehicles and contains 11 features which will leveraged to determine the CO2 emissions. The dataset originally comes from the Canada Government official open data website and was compiled over 7 years. We will be analyzing the dataset, preprocessing it and ultimately creating a Multiple Regression model to achieve our goal here."}}