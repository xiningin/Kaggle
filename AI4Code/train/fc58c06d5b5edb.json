{"cell_type":{"412f70fb":"code","aca19aed":"code","ac040e64":"code","a79c92eb":"code","468db677":"code","43b9d801":"code","62c4d659":"code","5ba243f2":"code","3f58ba05":"code","203c3c1f":"code","773c6de2":"code","ef40bfe3":"code","877364e9":"code","e590eb65":"code","7453aa0e":"code","115b3450":"code","8bf784d7":"code","54b268e1":"code","0a570c0f":"code","e5e54fc8":"code","7b128d35":"code","2c176947":"code","a09ce393":"code","72a777db":"code","ec0a2298":"code","5596e0f7":"code","804c8a7b":"code","8e2fd5e2":"code","8c035796":"code","52d35c17":"code","63e3d395":"code","4178bef2":"code","ae6ef5cb":"code","dabe8213":"code","11c5f733":"code","74f63704":"code","5e28cae7":"code","5d464ad5":"code","9dfdf536":"code","d816ac32":"code","ebc0fde6":"code","d73430e4":"code","e3d918ba":"code","f5be330e":"code","1adb71fa":"code","613c910d":"code","2c0a7710":"code","da8bb7f1":"code","68d86483":"code","d467cc97":"code","c001ba1a":"code","e29af4fe":"code","7f9c24a5":"markdown","8f7a07e4":"markdown","64ec8448":"markdown","cd322c10":"markdown","cb89f0cf":"markdown","f86b7902":"markdown"},"source":{"412f70fb":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split,cross_val_score\nfrom sklearn.metrics import accuracy_score,confusion_matrix,classification_report\nfrom sklearn.feature_selection import SelectKBest,chi2\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.linear_model import LogisticRegression\nimport scipy.stats as stats\nimport pylab\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","aca19aed":"df=pd.read_csv('\/kaggle\/input\/titanic\/train.csv')\ndf.head()","ac040e64":"df.dtypes","a79c92eb":"df.shape","468db677":"df.isna().sum()","43b9d801":"df['Age_random']=df['Age']\nrandom_sample=df['Age'].dropna().sample(df['Age'].isnull().sum(),random_state=0)\nrandom_sample.index=df[df['Age'].isnull()].index\ndf.loc[df['Age'].isnull(),'Age_random']=random_sample","62c4d659":"sns.kdeplot(df['Age'])\nsns.kdeplot(df['Age_random'])","5ba243f2":"df.Cabin.fillna(\"Missing\",inplace=True)","3f58ba05":"df.Cabin.unique()","203c3c1f":"df['Cabin']=df['Cabin'].astype(str).str[0]","773c6de2":"df.groupby(['Cabin'])['Survived'].mean()","ef40bfe3":"df.groupby(['Cabin'])['Survived'].mean().plot(kind='bar',figsize=(8,5),rot=0)\nplt.ylabel('Survived')","877364e9":"dic=df.groupby(['Cabin'])['Survived'].mean().sort_values().index\ndic","e590eb65":"labels={j:i for i,j in enumerate(dic,0)}\nlabels","7453aa0e":"df['Cabin']=df['Cabin'].map(labels)","115b3450":"df.head()","8bf784d7":"plt.figure(figsize=(15,6))\nplt.subplot(1,2,1)\ndf['Fare'].hist()\nplt.subplot(1,2,2)\nstats.probplot(df['Fare'],dist=\"norm\",plot=pylab)\nplt.show()","54b268e1":"df['Fare_log']=np.log(df['Fare']+1)","0a570c0f":"plt.figure(figsize=(15,6))\nplt.subplot(1,2,1)\ndf['Fare_log'].hist()\nplt.subplot(1,2,2)\nstats.probplot(df['Fare_log'],dist=\"norm\",plot=pylab)\nplt.show()","e5e54fc8":"df['Sex']=np.where(df['Sex']=='male',1,0)","7b128d35":"em_mode=df['Embarked'].mode()\nem_mode","2c176947":"df['Embarked'].fillna(\"S\",inplace=True)","a09ce393":"dic=df.Embarked.value_counts().to_dict()\ndic","72a777db":"df['Embarked']=df['Embarked'].map(dic)","ec0a2298":"df.head()","5596e0f7":"df.Survived.value_counts().plot(kind='bar',rot=0)\nplt.xlabel('Survived')\nplt.ylabel('Count')","804c8a7b":"X=df.drop(['Name','PassengerId','Ticket','Age','Survived'],axis=1)\ny=df['Survived']","8e2fd5e2":"df.Pclass.unique()","8c035796":"sns.pairplot(df.drop(['Name','Age','PassengerId','Ticket','Fare'],axis=1),hue=\"Survived\",diag_kind=\"hist\")","52d35c17":"smt=SelectKBest(score_func=chi2,k=8)","63e3d395":"selectbest=smt.fit(X,y)","4178bef2":"dfscores=pd.DataFrame(selectbest.scores_)\ndfcolumns=pd.DataFrame(X.columns)","ae6ef5cb":"best_F=pd.concat([dfscores,dfcolumns],axis=1)\nbest_F.columns=['Score','Features']\nbest_F","dabe8213":"print(best_F.nlargest(7,\"Score\"))","11c5f733":"X=X.drop(['SibSp'],axis=1)","74f63704":"X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.20,random_state=0)","5e28cae7":" model1=LogisticRegression(max_iter=10000)","5d464ad5":"model1.fit(X_train,y_train)","9dfdf536":"y_pred1=model1.predict(X_test)","d816ac32":"cf=confusion_matrix(y_test,y_pred1)\ncf","ebc0fde6":"plt.figure(figsize=(7,7))\nsns.heatmap(cf,annot=True)\nplt.ylabel('Actual Label')\nplt.ylabel('Predicted Label')","d73430e4":"accuracy_score(y_test,y_pred1)","e3d918ba":"cvs=cross_val_score(model1,X_train,y_train,cv=10)\ncvs","f5be330e":"cvs.mean()","1adb71fa":"model2=RandomForestClassifier(n_estimators=9)","613c910d":"model2.fit(X_train,y_train)","2c0a7710":"y_pred2=model2.predict(X_test)","da8bb7f1":"cf2=confusion_matrix(y_test,y_pred2)\ncf2","68d86483":"plt.figure(figsize=(7,7))\nsns.heatmap(cf2,annot=True)\nplt.ylabel('Actual Label')\nplt.ylabel('Predicted Label')","d467cc97":"accuracy_score(y_test,y_pred2)","c001ba1a":"cvs=cross_val_score(model2,X_train,y_train,cv=10)\ncvs","e29af4fe":"cvs.mean()","7f9c24a5":"# Frequency Encoding","8f7a07e4":"# Target Guided Encoding","64ec8448":"# Random Sample Imputation","cd322c10":"# Gaussian Transformation","cb89f0cf":"# Feature Selection","f86b7902":"# Feature Engineering"}}