{"cell_type":{"1518c2f9":"code","0d7e6889":"code","edb9855a":"code","adba9be5":"code","f23eaaa2":"code","0545eb43":"code","ce7afbf5":"code","9c3daa83":"code","916e6efc":"code","722823a3":"code","5750efa8":"code","39bbec3a":"code","5d36d9dd":"code","ca7b1650":"code","e51d1afe":"code","14f18668":"code","d7a04a90":"code","d26e520c":"code","7b51ca79":"code","e0ef9ab1":"code","12943066":"code","20ba535e":"code","be023493":"code","237d2fc1":"code","17bd9c16":"code","5cc3ae62":"markdown","338efbc0":"markdown","a4b875bf":"markdown","0b702466":"markdown","c57376cb":"markdown","5010d650":"markdown","96ac20a5":"markdown","4e57e70e":"markdown","6d18dbae":"markdown","73d02e0b":"markdown","2b5a2726":"markdown","4105f3c7":"markdown","a5be963f":"markdown","71ce9887":"markdown","a4cef5d9":"markdown","f9cd60b2":"markdown","b659d2a1":"markdown","55ea8560":"markdown","4d419a35":"markdown","9433cace":"markdown","a20b6aca":"markdown","5d2d62c4":"markdown","0b38e2f6":"markdown","e5b39ba0":"markdown","648f37b9":"markdown","7cc800f5":"markdown","139d79e5":"markdown","4b19de8b":"markdown","b13f81e2":"markdown","f9d67eb8":"markdown","a4fe04fb":"markdown","7a51d827":"markdown"},"source":{"1518c2f9":"import numpy as np\nimport pandas as pd\nimport plotly.graph_objects as go\nimport plotly.express as px\nimport plotly.io as pio\nimport matplotlib.pyplot as plt\nimport seaborn as sns","0d7e6889":"pio.templates.default = \"simple_white\"\npd.options.display.float_format = '{:,.2f}'.format","edb9855a":"df_share_race_city = pd.read_csv(\"\/kaggle\/input\/sharing-race-by-city\/ShareRaceByCity.csv\")\ndf_fatalities = pd.read_csv(\"\/kaggle\/input\/police-deaths-and-race-distribution\/Deaths_by_Police_US.csv\")","adba9be5":"column_list = [\"share_white\", \"share_black\", \"share_native_american\", \"share_asian\", \"share_hispanic\"] \nfor column in column_list:\n    df_share_race_city[column] = pd.to_numeric( df_share_race_city[column], errors=\"coerce\")\ndf_share_race_city.duplicated().any()\ndf_share_race_city","f23eaaa2":"df_fatalities[\"date\"] = pd.to_datetime(df_fatalities[\"date\"])\nrace_dict = {\"W\": \"White\",\n             \"B\": \"Black\",\n             \"H\": \"Hispanic\",\n             \"A\": \"Asian\",\n             \"N\": \"Native American\",\n             \"O\": \"Other\",\n            }\ndf_fatalities.race = df_fatalities.race.map(race_dict)\ndf_fatalities.duplicated().any()\ndf_fatalities","0545eb43":"df_race = df_fatalities.race.value_counts().to_frame()\ndf_race.index.name = \"race\"\ndf_race.rename(columns={\"race\":\"killed\"}, inplace=True)\ndf_race[\"pct_in_population\"] = pd.Series({\"White\": 54.6,\n                                \"Black\": 14.9,\n                                \"Hispanic\": 17.1,\n                                \"Asian\": 8.2,\n                                \"Native American\": 2.8,\n                                \"Other\": 2.4})\ntotal_population = 331449281\ndf_race[\"population\"] = total_population\/100*df_race.pct_in_population\ndf_race[\"relative_killed_per_mil\"] = df_race.killed.values\/df_race.population.values*1000000\ndf_race","ce7afbf5":"gender = df_fatalities.gender.value_counts()\ngender.index=[\"MEN \",\"WOMEN \"]","9c3daa83":"gender_bar = px.bar(y=gender.index,\n                    x=gender.values,\n                    orientation=\"h\",\n                    labels={\"y\":\"\", \"x\":\"count\"},\n                    title=\"Killing by gender.\",\n                    color=gender.index,\n                    color_discrete_sequence=[\"#424642\",\"#C06014\"],\n                    width=1000,\n                    height=250)\n\ngender_bar.update_layout(title_font_size=17)\n\ngender_bar.update_traces(showlegend=False)\n\ngender_bar.update_yaxes(title_font_size=17,\n                        showline=False, \n                        tickfont_size=13,\n                        ticks=\"\")\n\ngender_bar.update_xaxes(title_font_size=17, \n                        showline=False,\n                        ticks=\"\")\n\ngender_bar.show()","916e6efc":"age = px.histogram(x=df_fatalities.age,\n                   labels={\"x\":\"age\"},\n                   title=\"Age distribution.\",\n                   color_discrete_sequence=[\"#C06014\"],\n                   width=900,\n                   height=500,\n                   nbins=100,\n                   marginal=\"box\")\n\nage.update_layout(title_font_size=17)\n\nage.update_yaxes(title_font_size=17,\n                 tickfont_size=13)\n\nage.update_xaxes(title_font_size=17) \n\nage.show()","722823a3":"df_fatalities[df_fatalities.age < 30].id.count()\/df_fatalities.id.count()*100","5750efa8":"df_armed = df_fatalities.groupby(\"armed\").armed.count()\ndf_armed_without = df_armed[df_armed.index != \"unarmed\"].sort_values(ascending=False)\narmed_no = df_armed[df_armed.index==\"unarmed\"].values.sum()\narmed_yes = df_armed[df_armed.index!=\"unarmed\"].values.sum()","39bbec3a":"armed = px.pie(names=[\"armed\", \"unarmed\"],\n               labels=[\"armed\", \"unarmed\"],\n               values=[armed_yes, armed_no],\n               color_discrete_sequence=[\"#424642\",\"#899292\"],\n               title=\"Were people armed?\",\n               width=700,\n               height=500,\n               )\n\narmed.update_layout(title_font_size=17)\n\narmed.update_traces(pull = [0.1, 0],\n                    textposition='auto',\n                    textinfo='percent+label',\n                    textfont_size=14,\n                    insidetextorientation='auto',\n                    showlegend=False,\n                    rotation=-30)\n\narmed.show()","5d36d9dd":"weapon = px.pie(names=df_armed_without[df_armed_without.values>20].index,\n               labels=df_armed_without[df_armed_without.values>20].index,\n               values=df_armed_without[df_armed_without.values>20].values,\n               color_discrete_sequence=[\"#424642\",\"#656765\",\"#848684\",\"#848684\",\"#848684\",\"#848684\",\"#899292\",\"#899292\",\"#899292\",\"#899292\",\"#899292\"],\n               title=\"Weapons.\",\n               width=700,\n               height=500,\n               hole=0.5)\n\nweapon.update_layout(title_font_size=17)\n\nweapon.update_traces(pull=[0,0.065,0.15,0.15,0.15,0.15,0.17,0.17,0.17,0.17,0.17],\n                     textposition='auto',\n                     textfont_size=14,\n                     insidetextorientation='auto',\n                     rotation=-30,\n                     textinfo=\"value\")\n\nweapon.show()","ca7b1650":"df_race = df_race.sort_values(by=\"relative_killed_per_mil\", ascending=False)","e51d1afe":"widths = np.array(df_race.population\/10000000)\nrace = px.bar(x=np.cumsum(widths)-widths,\n              y=df_race.relative_killed_per_mil,\n              text=df_race.index,\n              title=\"Deaths by race with respective to the race distribution in US population.\",\n              labels={\"x\":\"population in millions\", \"y\":\"killings per million\"})\n\nrace.update_layout(width=800,\n                   height=500,\n                   title_font_size=17)\n\nrace.update_traces(width=widths,\n                   offset=0,\n                   textposition=\"outside\",\n                   textangle=0,\n                   textfont_color=\"black\",\n                   textfont_size=13,\n                   constraintext=\"none\",\n                   marker_color=[\"#C06014\",\"#E6E8DE\",\"#E6E8DE\",\"#E6E8DE\",\"#E6E8DE\",\"#E6E8DE\"])\n\nrace.update_xaxes(tickmode=\"array\",\n                  tickvals=np.cumsum(widths)-widths\/2,\n                  ticktext=round(df_race.population\/1000000),\n                  showline=False,\n                  ticks=\"\",\n                  title_font_size=17)   \n\nrace.update_yaxes(tickfont_size=12,\n                  title_font_size=17,\n                  showline=False,\n                  ticks=\"\")\n\nrace.show()","14f18668":"from scipy.stats import chisquare, chi2","d7a04a90":"chi_table = df_race.loc[:,[\"killed\", \"pct_in_population\"]]\nchi_table[\"expected\"] = (chi_table.killed.sum())\/100*chi_table.pct_in_population\nchi_table","d26e520c":"chisquare(f_obs=chi_table.killed,\n          f_exp=chi_table.expected,\n          ddof=5)","7b51ca79":"chi_square_stat = (((chi_table.killed-chi_table.expected)**2)\/chi_table.expected).sum()\np_value = 1 - chi2.cdf(x=chi_square_stat, df=5)\nprint(f\"Chi-square statistic: {chi_square_stat}, p-value: {p_value}\")","e0ef9ab1":"grouped_share = df_share_race_city.groupby(\"Geographic area\").mean()\ngrouped_share = pd.DataFrame(grouped_share.stack()).reset_index(level=1, drop=False)\ngrouped_share.columns = [\"Race\", \"Rate\"]\ntop_black_index = grouped_share[grouped_share.Race == \"share_black\"].sort_values(by=\"Rate\", ascending=False).head(10)[::-1].index","12943066":"country_bar = px.bar(x=grouped_share.loc[top_black_index,:].Rate,\n                     y=grouped_share.loc[top_black_index,:].index,\n                     color=grouped_share.loc[top_black_index,:].Race,\n                     orientation=\"h\",\n                     title=\"Racial Makeup of the US States with most % of black people.\",\n                     labels={\"color\":\"\", \"y\":\"states\",\"x\":\"percentage\"},\n                     color_discrete_sequence=[\"#BDBFB6\", \"#424642\", \"#536162\", \"#D7894A\", \"#C06014\"])\n                \ncountry_bar.update_layout(width=1000,\n                          height=600,\n                          barnorm=\"percent\",\n                          title_font_size=17,\n                          legend=dict(\n                                orientation=\"h\",\n                                yanchor=\"middle\",\n                                y=1.04,\n                                xanchor=\"center\",\n                                x=0.5))\n\ncountry_bar.update_yaxes(tickfont_size=14,\n                         title_font_size=17,\n                         showline=False)\n                        \ncountry_bar.update_xaxes(tickfont_size=12,\n                         title_font_size=17,\n                         showline=False,\n                         ticks=\"\")  \n\ncountry_bar.show()","20ba535e":"states = df_fatalities.state.value_counts().to_frame().rename(columns={\"state\":\"killings\"})\npopulations={\n    \"CA\":39538223,\n    \"TX\":29145505,\n    \"FL\":21538187,\n    \"NY\":20201249,\n    \"PA\":13002700,\n    \"IL\":12801989,\n    \"OH\":11799448,\n    \"GA\":10711908,\n    \"NC\":10439388,\n    \"MI\":10077331,\n    \"NJ\":9288994,\n    \"VA\":8631393,\n    \"WA\":7705281,\n    \"AZ\":7151502,\n    \"MA\":7029917,\n    \"TN\":6910840,\n    \"IN\":6785528,\n    \"MD\":6177224,\n    \"MO\":6154913,\n    \"WI\":5893718,\n    \"CO\":5773714,\n    \"MN\":5706494,\n    \"SC\":5118425,\n    \"AL\":5024279,\n    \"LA\":4657757,\n    \"KY\":4505836,\n    \"OR\":4237256,\n    \"OK\":3959353,\n    \"CT\":3605944,\n    \"UT\":3205958,\n    \"IA\":3271616,\n    \"NV\":3104614,\n    \"AR\":3011524,\n    \"MS\":2961279,\n    \"KS\":2937880,\n    \"NM\":2117522,\n    \"NE\":1961504,\n    \"ID\":1839106,\n    \"WV\":1793716,\n    \"HI\":1455271,\n    \"NH\":1377529,\n    \"ME\":1362359,\n    \"RI\":1097379,\n    \"MT\":1084225,\n    \"DE\":989948,\n    \"SD\":886667,\n    \"ND\":779094,\n    \"AK\":733391,\n    \"DC\":689545,\n    \"VT\":643077,\n    \"WY\":576851,\n}\nstates[\"population\"]=states.index.map(populations)\nstates[\"relative_kill_per_mil\"]=states.killings\/states.population*1000000","be023493":"choro = px.choropleth(data_frame=states,\n                      locationmode=\"USA-states\",\n                      scope=\"usa\",\n                      locations=states.index,\n                      color=states.relative_kill_per_mil, \n                      color_continuous_scale=px.colors.sequential.Oranges,\n                      range_color=[0,40],\n                      title=\"Number of Police killings by US states.\",\n                      hover_name=states.index,\n                     )\n\nchoro.update_layout(title_font_size=17,\n                    width=900,\n                    height=600,\n                    margin={\"r\":150, \"l\":0})\n\nchoro.update_traces(showscale=True,\n                    marker_line_color='white',\n                    colorbar_bordercolor=\"white\")\n\nchoro.show()","237d2fc1":"df_fatalities_date = df_fatalities.set_index(\"date\")\ndf_fatalities_by_month = df_fatalities_date.resample(\"M\").name.count()[:-2]","17bd9c16":"fig = go.Figure()\n\nfig.add_trace(go.Scatter(x=df_fatalities_by_month.index,\n                         y=df_fatalities_by_month.values,\n                         line={\"color\":\"#C06014\"}))\n\nfig.update_layout(title=\"Number of killings over time. (2015-2021)\",\n                  xaxis_title=\"year\",\n                  yaxis_title=\"count\",\n                  width=900,\n                  height=500,\n                  title_font_size=17)\n\nfig.update_yaxes(tickfont_size=12,\n                 title_font_size=17) \n\nfig.update_xaxes(tickfont_size=14,\n                 title_font_size=17) \n\nfig.add_annotation(x=\"2018-09-30\",\n                   y=55,\n                   text=\"Amber Guyger case\",\n                   font={\"size\":13},\n                   showarrow=True)                   \n\nfig.show()","5cc3ae62":"### Bar Chart Showing the Racial Makeup of US States with most % of black people\n\n","338efbc0":"**Insights:**\n- september 2018 has recorded the lowest number of deaths. Digging into news articles we encounter the Amber Guyger case, where she was convicted of murder in wrong-apartment killing of innocent man Botham Jean\n- the spike of fatal police shootings even during the pandemic","a4b875bf":"### Fatalities Dataset","0b702466":"We have some missing values for the name, armed, age, race, flee, long and lat columns. We just keep it in mind doing particular data exploration. We also convert the capital letter symbols for race to a particular full name of the race.","c57376cb":"# Data Cleaning \n","5010d650":"### Comparing the Total Number of Deaths of Men and Women","96ac20a5":"People have been shot and killed in encounters with officers even if they were unarmed or carrying a toy weapon. Such killings seem very unnecessary, but further understanding and investigation is required. Every time an officer shoots a person belonging to the minority, it does not necessarily mean racial bias. But, as our analysis showed, bias is not absent. In recent years, the fact that police officers could be racially biased was the primary motivation for the creation of the socially relevant and internationally discussed #BlackLivesMatter movement. We see it as a starting point to understand the truth behind possible racial bias in the population in general.","4e57e70e":"# EDA","6d18dbae":"We have 20 cities with missing values for race shares. We could find missing information, but for now we just keep it in mind during analysis.","73d02e0b":"Let's do some initial analysis.","2b5a2726":"### Were People Armed? ","4105f3c7":"# Importing and Loading Data","a5be963f":"### Share of Race by City","71ce9887":"**Insights:**\n- the states with the highest numbers of killings per 1 mil. inhabitants: Alaska, Arizona, New Mexico, Colorado, Montana and Oklahoma\n- these are states with lower proportions of black people, that means that a chance that a randomly picked \"criminal\" is black is low\n- so what is happening here? Why these states seems so dangerous in therms of police shootings than?\n- and more importantly, this shows that a higher proportion of black people doesn't imply higher police killings","a4cef5d9":"### Creating separate dataframe for racial profile of USA","f9cd60b2":"**Insights:**\n- the states with the most proportion of black people: District of Columbia, Mississippi, South Carolina, Louisiana\n- are these states the one where the numbers of police killings are highest?\n- does higher proportion of black people imply that these states are more dangerous, therefore have higher number of police fatal shootings? ","b659d2a1":"Chi-square test provides a way to investigate differences in the distributions of categorical variables with the same categories and dependence between categorical variables. Let's examine if there is a difference between distribution of race in fatal police shootings and the distribution of race in the US population.","55ea8560":"### How Old Were the People Killed?","4d419a35":"### CHI-SQUARE TEST","9433cace":"For possible missing data we excluded last 2 months from the dataset.","a20b6aca":"<center>\u00a9 2021 Miroslava Je\u017e\u00edkov\u00e1<\/center>","5d2d62c4":"# Epilogue\n","0b38e2f6":"**Insights:**\n- 50% of all deceased are between 27 and 45 years old\n- almost 1\/3 of all deaths are young people under 30 years old\n- the majority of killed people are young man","e5b39ba0":"Percentage of people killed under 30 years old.","648f37b9":"Since Jan. 1, 2015, [The Washington Post](https:\/\/www.washingtonpost.com\/) has been compiling a database of every fatal shooting in the US by a police officer in the line of duty. \n<center><img src=https:\/\/i.imgur.com\/sX3K62b.png><\/center>\n\nWhile there are many challenges regarding data collection and reporting, The Washington Post has been tracking more than a dozen details about each killing. This includes the race, age and gender of the deceased, whether the person was armed, and whether the victim was experiencing a mental-health crisis. The Washington Post has gathered this supplemental information from law enforcement websites, local new reports, social media, and by monitoring independent databases such as \"Killed by police\" and \"Fatal Encounters\". The Post has also conducted additional reporting in many cases.\n\nThere is additional dataset of US census data on racial demographics. [Source of census data](https:\/\/factfinder.census.gov\/faces\/nav\/jsf\/pages\/community_facts.xhtml).\n\nThe objective of this analysis is to support the arguments that police officers are racialy biased and I hope it will provide thoughtful, fact-based analysis of this important issue.\n\nThe orginal [The Washington Post's analysis here](https:\/\/www.washingtonpost.com\/graphics\/investigations\/police-shootings-database\/).","7cc800f5":"Source : [Historical racial and ethnic demographics of the USA](https:\/\/en.wikipedia.org\/wiki\/Historical_racial_and_ethnic_demographics_of_the_United_States#Vital_statistics_of_racial_and_ethnic_Groups_(since_1990))","139d79e5":"**Insights:**\n- there is 31 black people killed per million compared to only 16 white people per million\n- p-value of chi-square test is almost zero, therefore we reject the null hypothesis that the two distrutions are the same\n- distribution of race profile in police shootings is different than distribution of races in population, which might imply that there truly is racial bias in police shootings\n\nOne might argue, that the higher proportion of black pleople killed is simply because there are more black people in the particular area in general. Let' s examine this statement.","4b19de8b":"### Race of killed people","b13f81e2":"# Introduction","f9d67eb8":"### Number of Police Killings Over Time","a4fe04fb":"**Insights:**\n- 93.5% of all fatal shootings by a police officer in the line of duty include the deceased being armed \n- in that scenario, it is very difficult for an officer to make a decision whether to shoot or not when the suspect is possesing gun or knife (as the most used weapons)\n- but what about the rest 6.5% of deceased not being armed, or where weapon was reported as unknown or undetermined? Were they a real threat?","7a51d827":"### Choropleth map of police killings"}}