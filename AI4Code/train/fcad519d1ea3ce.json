{"cell_type":{"84c4e0cf":"code","1f2e15f2":"code","c032ee35":"code","dd0f83c3":"code","6b870541":"code","9055c224":"code","124c644b":"code","fb406582":"code","0ffd32db":"code","346875e4":"code","2025a2dd":"code","36eebcaf":"code","abe62a41":"code","e9417eb4":"code","ace2e326":"code","c394473d":"code","703cd007":"code","14d45ebd":"code","08e20a25":"code","26cd9256":"code","80de8ffc":"code","7485492e":"code","2ac1a07e":"code","5fdf8673":"code","6b076c9e":"code","e80b4118":"code","37f37858":"code","150cc80e":"code","2dc1bec9":"code","c225b762":"code","2dd4f77b":"code","a630290b":"code","3a0fb177":"code","8d81b6ba":"code","a9d699b7":"code","cc0c090b":"code","53ea576b":"code","c24a674b":"code","ad9e0171":"code","6c811c12":"code","082548c1":"code","e6e9631c":"code","072e99dd":"code","6e026b5f":"code","029e4800":"code","18a94db8":"code","487d5353":"code","2f03ab13":"code","ec4dbaf2":"code","d9d2e290":"code","d92727ba":"code","1b30573e":"code","ebc3b7ff":"code","f5bd22d2":"code","42d6a4d8":"code","3038dd46":"code","b3bf9859":"code","2b4f0a88":"code","13b172cc":"code","b626a87e":"code","3164fd73":"code","50c66f7b":"code","7c0ceb56":"code","183ec4b7":"code","bf2f1296":"code","2e65ff28":"markdown","00416c6a":"markdown","4732df72":"markdown","8083ce98":"markdown","552c7519":"markdown","4cf2a823":"markdown","6bfce69d":"markdown","705539a9":"markdown","ccdf0751":"markdown","545789bc":"markdown","03df50e6":"markdown","335eb431":"markdown","b05ae12b":"markdown","1a291acc":"markdown","7f0bc02d":"markdown","4ed9d61d":"markdown","f75a4219":"markdown","bb0eb3f1":"markdown","8231bcfc":"markdown","9a59767b":"markdown","d2ff3ffe":"markdown","b021e17f":"markdown","5fbe22d5":"markdown","042f54b1":"markdown","25f5c2f1":"markdown","2c3a737b":"markdown","05275085":"markdown","306923e5":"markdown","51d28d7e":"markdown","eabeadd4":"markdown","b9397773":"markdown","2b35c17d":"markdown"},"source":{"84c4e0cf":"import numpy as np \nimport matplotlib.pyplot as plt \nimport pandas as pd\nimport seaborn as sns","1f2e15f2":"covid = pd.read_csv('..\/input\/novel-corona-virus-2019-dataset\/covid_19_data.csv')\ncovid","c032ee35":"df_BR = covid[covid['Country\/Region'] == 'Brazil']\ndf_BR","dd0f83c3":"sns.lineplot(df_BR['ObservationDate'], df_BR['Confirmed']);","6b870541":"df_sum = covid.groupby('ObservationDate').agg({'Confirmed': 'sum', 'Deaths': 'sum', 'Recovered': 'sum'}).reset_index()\ndf_sum","9055c224":"plt.stackplot(df_sum['ObservationDate'], [df_sum['Confirmed'], df_sum['Deaths'], df_sum['Recovered']],\n              labels = ['Confirmed', 'Deaths', 'Recovered'])\nplt.legend(loc = 'upper left')","124c644b":"sns.pairplot(covid)","fb406582":"covid_line_list = pd.read_csv('..\/input\/novel-corona-virus-2019-dataset\/COVID19_line_list_data.csv')\ncovid_line_list","0ffd32db":"sns.distplot(covid_line_list['age'])","346875e4":"deaths = pd.read_csv('..\/input\/novel-corona-virus-2019-dataset\/time_series_covid_19_deaths.csv')\ndeaths","2025a2dd":"deaths[deaths['Country\/Region'] == 'Brazil']","36eebcaf":"columns = deaths.keys()\ncolumns","abe62a41":"deaths = deaths.loc[:, columns[4]:columns[-1]]\ndeaths","e9417eb4":"len(deaths.keys())","ace2e326":"deaths['1\/22\/20'].sum()","c394473d":"deaths['8\/12\/20'].sum()","703cd007":"#creating the variable:\ndates = deaths.keys()\ny = []\nfor i in dates:\n    y.append(deaths[i].sum())","14d45ebd":"print(y)","08e20a25":"y = np.array(y).reshape(-1,1) #will be transformed into matrix format\ny","26cd9256":"x = np.arange(len(dates)).reshape(-1,1) #will generate the number of dates according to the size of the \"dates\"\nx","80de8ffc":"forecast = np.arange(len(dates) + 15).reshape(-1,1)\nforecast","7485492e":"x.shape, y.shape, forecast.shape ","2ac1a07e":"from sklearn.model_selection import train_test_split\nX_train, X_test, Y_train, Y_test = train_test_split(x, y, test_size = 0.10, shuffle = False)","5fdf8673":"from sklearn.preprocessing import PolynomialFeatures\npoly = PolynomialFeatures(degree = 2)\nX_train_poly = poly.fit_transform(X_train)\nX_test_poly = poly.transform(X_test)","6b076c9e":"X_train.shape, X_test.shape, X_train_poly.shape, X_test_poly.shape","e80b4118":"from sklearn.linear_model import LinearRegression\nlr = LinearRegression()\nlr.fit(X_train_poly, Y_train)","37f37858":"poly_pred = lr.predict(X_test_poly)\nplt.plot(poly_pred, linestyle = 'dashed')\nplt.plot(Y_test)","150cc80e":"from sklearn.metrics import mean_absolute_error, mean_squared_error\nprint('MAE:', mean_absolute_error(poly_pred, Y_test))\nprint('MSE:', mean_squared_error(poly_pred, Y_test))\nprint('RMSE:', np.sqrt(mean_absolute_error(poly_pred, Y_test)))","2dc1bec9":"X_train_all = poly.transform(forecast)\npred_all = lr.predict(X_train_all)\n\nplt.plot(forecast[:-15], y, color='red')\nplt.plot(forecast, pred_all, linestyle='dashed')\nplt.title('DEATHS of COVID-19')\nplt.xlabel('Days since 1\/22\/2020')\nplt.ylabel('Number of deaths')\nplt.legend(['Death cases', 'Predictions']);","c225b762":"confirmed = pd.read_csv('..\/input\/novel-corona-virus-2019-dataset\/time_series_covid_19_confirmed.csv')\nconfirmed","2dd4f77b":"confirmed[confirmed['Country\/Region'] == 'Brazil']","a630290b":"columns1 = confirmed.keys()\ncolumns1","3a0fb177":"confirmed = confirmed.loc[:, columns1[4]:columns1[-1]]\nconfirmed","8d81b6ba":"confirmed['1\/22\/20'].sum(), confirmed['8\/12\/20'].sum()","a9d699b7":"dates1 = confirmed.keys()\ny_c = []\nfor i in dates1:\n    y_c.append(confirmed[i].sum())","cc0c090b":"print(y_c)","53ea576b":"y_c = np.array(y_c).reshape(-1,1)\ny_c","c24a674b":"x_c = np.arange(len(dates1)).reshape(-1,1)\nx_c","ad9e0171":"forecast_c = np.arange(len(dates1) + 15).reshape(-1,1)\nforecast_c","6c811c12":"x_c.shape, y_c.shape, forecast_c.shape ","082548c1":"X_train_c, X_test_c, Y_train_c, Y_test_c = train_test_split(x_c, y_c, test_size = 0.10, shuffle = False)","e6e9631c":"poly_c = PolynomialFeatures(degree = 4)\nX_train_poly_c = poly_c.fit_transform(X_train_c)\nX_test_poly_c = poly_c.transform(X_test_c)","072e99dd":"X_train_c.shape, X_test_c.shape, X_train_poly_c.shape, X_test_poly_c.shape","6e026b5f":"lr_c = LinearRegression()\nlr_c.fit(X_train_poly_c, Y_train_c)","029e4800":"poly_pred_c = lr_c.predict(X_test_poly_c)\nplt.plot(poly_pred_c, linestyle = 'dashed')\nplt.plot(Y_test_c)","18a94db8":"print('MAE:', mean_absolute_error(poly_pred_c, Y_test_c))\nprint('MSE:', mean_squared_error(poly_pred_c, Y_test_c))\nprint('RMSE:', np.sqrt(mean_absolute_error(poly_pred_c, Y_test_c)))","487d5353":"X_train_all_c = poly_c.transform(forecast_c)\npred_all_c = lr_c.predict(X_train_all_c)\n\nplt.plot(forecast_c[:-15], y_c, color='red')\nplt.plot(forecast_c, pred_all_c, linestyle='dashed')\nplt.title('CONFIRMED of COVID-19')\nplt.xlabel('Days since 1\/22\/2020')\nplt.ylabel('Number of confirmed')\nplt.legend(['Confirmed cases', 'Predictions']);","2f03ab13":"recovered = pd.read_csv('..\/input\/novel-corona-virus-2019-dataset\/time_series_covid_19_recovered.csv')\nrecovered","ec4dbaf2":"recovered[recovered['Country\/Region'] == 'Brazil']","d9d2e290":"columns2 = recovered.keys()\ncolumns2","d92727ba":"recovered = recovered.loc[:, columns2[4]:columns2[-1]]\nrecovered","1b30573e":"recovered['1\/22\/20'].sum(), recovered['8\/12\/20'].sum()","ebc3b7ff":"dates2 = recovered.keys()\ny_r = []\nfor i in dates2:\n    y_r.append(recovered[i].sum())","f5bd22d2":"print(y_r)","42d6a4d8":"y_r = np.array(y_r).reshape(-1,1)\ny_r","3038dd46":"x_r = np.arange(len(dates2)).reshape(-1,1)\nx_r","b3bf9859":"forecast_r = np.arange(len(dates2) + 15).reshape(-1,1)\nforecast_r","2b4f0a88":"x_r.shape, y_r.shape, forecast_r.shape","13b172cc":"X_train_r, X_test_r, Y_train_r, Y_test_r = train_test_split(x_r, y_r, test_size = 0.30, shuffle = False)","b626a87e":"poly_r = PolynomialFeatures(degree = 3)\nX_train_poly_r = poly_r.fit_transform(X_train_r)\nX_test_poly_r = poly_r.transform(X_test_r)","3164fd73":"X_train_r.shape, X_test_r.shape, X_train_poly_r.shape, X_test_poly_r.shape","50c66f7b":"lr_r = LinearRegression()\nlr_r.fit(X_train_poly_r, Y_train_r)","7c0ceb56":"poly_pred_r = lr_r.predict(X_test_poly_r)\nplt.plot(poly_pred_r, linestyle = 'dashed')\nplt.plot(Y_test_r)","183ec4b7":"print('MAE:', mean_absolute_error(poly_pred_r, Y_test_r))\nprint('MSE:', mean_squared_error(poly_pred_r, Y_test_r))\nprint('RMSE:', np.sqrt(mean_absolute_error(poly_pred_r, Y_test_r)))","bf2f1296":"X_train_all_r = poly_r.transform(forecast_r)\npred_all_r = lr_r.predict(X_train_all_r)\n\nplt.plot(forecast_r[:-15], y_r, color='red')\nplt.plot(forecast_r, pred_all_r, linestyle='dashed')\nplt.title('RECOVERED of COVID-19')\nplt.xlabel('Days since 1\/22\/2020')\nplt.ylabel('Number of recovered')\nplt.legend(['Recovered', 'Predictions']);","2e65ff28":"We can see from the graph above that the highest levels of virus infection are between 25 and 70 years old. It is very clear that we have a very high peak in those people aged approximately 60 to 70 years, people including part of the risk group for being elderly.","00416c6a":"Our x variable to get the predict of the deaths","4732df72":"I will create a new dataframe with only datas baout Brazil (it's my country) to make some EDA","8083ce98":"# CONCLUSIONS: \nCOVID-19 is a new virus and there are still many things to research and deepen, with these results we realized that luckily there are more cured than dead but there are no predictions for a drop in the number of dead and confirmed. Although there are people in the risk group who are contaminated, the results showed that a large part of those currently being contaminated are young. Even though the peak is among the elderly aged 60 to 70 years. It is worth mentioning that many of these young people may be infected but asymptomatic, which aggravates the situation of those who have agreed with these asymptomatic young people and may have been infected. Many countries do not have the best healthcare network and treatment conditions:\n\n* lack of professionals\n* lack of suitable materials\n* problems with testing\n\nThe poor conditions of the health system lead to the prediction of the increase in deaths, as well as many countries that did not adhere to the quarantine, some are in the process of resuming and have already made the quarantine more flexible, which may corroborate to keep the increasing number of contaminated.","552c7519":"Now let's use the ``forecast`` variable to make the forecast","4cf2a823":"As the goal is to predict the number of deaths, we will create a variable called the ``columns`` where we will keep only the date.","6bfce69d":"I will create a new dataframe but now the data `` ObservationDate``, `` Confirmed``, `Deaths` and `Recovered` grouped together","705539a9":"**Training the model**","ccdf0751":"**Traning the model**","545789bc":"# Loading another database\nThis database brings information from patients","03df50e6":"We have data of just over 6.5 months. Now let's add the number of deaths that occurred on each day:","335eb431":"Let's see the ``ObservationDate`` and the ``Confirmed`` cases in a graph:","b05ae12b":"Let's create a new `` forecast`` variable so that we can make the future forecast for the next few days:","1a291acc":"# Predicting the deaths by COVID-19:","7f0bc02d":"variable ``y`` is in `` list`` format and to use Machine Learning algorithms it is necessary to transform them into `` array``","4ed9d61d":"As we are using the `` degree = 2`` we have to modify our training data to place these new 2 characteristics","f75a4219":"Now we can see the number of deaths on their date of occurrence. Let's see how many months we have in this database:","bb0eb3f1":"Analyzing patients by `` age``:","8231bcfc":"# The prediction of the confirmed cases:","9a59767b":"We had a total of 17 deaths in this day in the world","d2ff3ffe":"**The prediction**","b021e17f":"We can see in these graphs that the number of deaths is insignificant when compared to the number of confirmed cases and those recovered. Despite the delicate periods that the world has been going through, the number of recovered people exceeds the number of deaths, which is very good even the number of confirmed cases continuing to grow and being very high.","5fbe22d5":"Look how interesting, as the days go by the cases increase but when it exceeds the 250000 mark, there is a significant drop.\n* Is this drop the result of a quarantine or more stringent measures?\n* Was it during the period when the [president of the country decided that he would stop reporting the total number of cases](https:\/\/oglobo.globo.com\/sociedade\/governo-esconde-totais-de-mortes-casos-da-covid-19-tira-site-do-ar-1-24466314) and did this have an impact on the results?\n\nBut right after the sharp drop, there is a resumption of the growth of cases, even in a more controlled way than before the declination of the line.","042f54b1":"**Training the model**","25f5c2f1":"# Loading the database:","2c3a737b":"Let's create a comparative chart between `` Confirmed``, `` Deaths`` and `` Recovered``","05275085":"**The prediction**","306923e5":"# The prediction of the recovered","51d28d7e":"The columns that start the dates is number 4, so let's recreate the dataframe `` deaths`` from the fourth column. It will take from the fourth to the last column and the number of deaths on the dates will be shown","eabeadd4":"In Brazil, cases grow in a short period of time","b9397773":"Let's see about the Brazil deaths","2b35c17d":"**The prediction**"}}