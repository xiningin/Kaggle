{"cell_type":{"fc94cfa0":"code","901b95d7":"code","0c69adc2":"code","a6f43334":"code","9aee25f1":"code","8ee906cb":"code","8fd1399e":"code","35f2c988":"code","2ebd5115":"code","3f04d7e7":"code","33adbb3e":"code","08742eb4":"code","bff44a47":"code","85028ebd":"code","ebb58aec":"code","132095e4":"markdown","0e7288b2":"markdown"},"source":{"fc94cfa0":"%matplotlib inline\nimport warnings\nwarnings.filterwarnings(\"ignore\", message=\"axes.color_cycle is deprecated\")\nimport numpy as np\nimport pandas as pd\nimport scipy as sp\nimport seaborn as sns\nimport sqlite3","901b95d7":"#%%sh\n!pwd\n!ls -ls \/kaggle\/input\/*\/","0c69adc2":"!ls ..\/input\/\ncon = sqlite3.connect('..\/input\/us-baby-names\/database.sqlite')\ncursor = con.cursor()\ncursor.execute(\"SELECT name FROM sqlite_master WHERE type='table';\")\nprint(cursor.fetchall())","a6f43334":"# helper method to load the data\ndef load(what='NationalNames'):\n    assert what in ('NationalNames', 'StateNames')\n    cols = ['Name', 'Year', 'Gender', 'Count']\n    if what == 'StateNames':\n        cols.append('State')\n    df = pd.read_sql_query(\"SELECT {} from {}\".format(','.join(cols), what), con)\n    return df","9aee25f1":"#National data\nnational = load(what='NationalNames')\nnational.head(5)","8ee906cb":"top_names = national.groupby(['Name','Gender'])['Count'].sum().reset_index().sort_values(by='Count',ascending=False)\ntop_names.head()","8fd1399e":"top_names_male = top_names[top_names['Gender']=='M'].head(50)\ntop_names_female = top_names[top_names['Gender']=='F'].head(50)\n#print(top_names_male.head())\n#print(top_names_female.head())","35f2c988":"import matplotlib.pyplot as plt\nfig,ax=plt.subplots(1,2,figsize=(20,12))\nsns.barplot(data=top_names_female,y='Name',x='Count',ax=ax[0], color='Red')\nsns.barplot(data=top_names_male,y='Name',x='Count',ax=ax[1], color='Blue')","2ebd5115":"national['Decade'] = national['Year'].apply(lambda x: 10*(x\/\/10))","3f04d7e7":"import plotly.express as px\n\ngender='M'\n\ntop_names_by_year = national[national['Gender']==gender].groupby(['Name','Decade'])['Count'].sum().reset_index().sort_values(by=['Decade','Count'],ascending=[True,False])\ntop_names_by_year.head()\n\nfig = px.bar(top_names_by_year, x=\"Name\", y=\"Count\",\n  animation_frame=\"Decade\", color='Count') #range_y=[0,4000000000]\nfig.show()","33adbb3e":"# Is number of males increased over the year, compared to same of female?\ntmp = national.groupby(['Year','Gender']).sum()\n\nmale = tmp.query(\"Gender=='M'\").reset_index('Year').sort_index()\nfemale = tmp.query(\"Gender=='F'\").reset_index('Year').sort_index()\n#print(male.head())\n#print(female.head())\nfinal = pd.merge(male, female, on = ['Year'], how = 'outer', suffixes = ['_m', '_f'])\nfinal['male_extra'] = final['Count_m'] - final['Count_f'] \nfinal = final.set_index('Year').sort_index()","08742eb4":"print(final.head())\nfinal.plot()","bff44a47":"name_year = national.groupby(['Name','Year']).sum().reset_index(['Name','Year'])","85028ebd":"dr = name_year[name_year['Name']=='Michel']\ndr['lag'] = (dr['Count'] - dr['Count'].shift(5))#\/dr['Count']\nprint(dr['lag'].sum())\ndr[['Year', 'Count', 'lag']].plot('Year')","ebb58aec":"name_year[name_year['Name']=='George'].plot('Year')","132095e4":"#US Baby Names Data Analysis","0e7288b2":"## Top Male and Female Names"}}