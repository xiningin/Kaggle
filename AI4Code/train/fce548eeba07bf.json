{"cell_type":{"4d47198d":"code","b5323fb8":"code","98b8ad3c":"code","73dddb43":"code","9b2c954e":"code","c7651391":"code","e907de0f":"code","8013a7dc":"code","0971b425":"code","283ce21a":"code","74758ae3":"code","63a8f279":"code","67d1557a":"code","0afd9ac8":"code","df6aa59b":"code","d1781de3":"code","3572f45c":"code","2cd43b43":"code","5fc7ac5b":"code","bb0a3796":"code","954b3b8b":"code","8155e725":"code","f61648c9":"code","a5743100":"code","c1a39742":"code","ce7b8d27":"code","6b1a4140":"code","e13a52bc":"code","870a1245":"code","f8ac93ce":"code","452bd481":"code","6c83b10a":"code","e665012e":"markdown","3f139a96":"markdown","5b2dd2a4":"markdown","c0134285":"markdown","62b3e28c":"markdown","3a3833d9":"markdown"},"source":{"4d47198d":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt","b5323fb8":"df=pd.read_csv('..\/input\/heart-disease-uci\/heart.csv')","98b8ad3c":"df.head()","73dddb43":"df.info()","9b2c954e":"df.describe().T","c7651391":"sns.pairplot(df,hue='target')","e907de0f":"sns.countplot(x='target',data=df,hue='sex')","8013a7dc":"df.columns","0971b425":"X=df.drop('target',axis=1)","283ce21a":"y=df['target']","74758ae3":"from sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.decomposition import PCA","63a8f279":"sc=StandardScaler()","67d1557a":"scaled_df=pd.DataFrame(sc.fit_transform(X),columns=['age', 'sex', 'cp', 'trestbps', 'chol', 'fbs', 'restecg', 'thalach',\n       'exang', 'oldpeak', 'slope', 'ca', 'thal',])","0afd9ac8":"scaled_df.head()","df6aa59b":"X_train, X_test, y_train, y_test = train_test_split(scaled_df, y, test_size=0.33, random_state=42)","d1781de3":"pc=PCA(n_components=2)\npc_df=pd.DataFrame(pc.fit_transform(X),columns=['feature1','feature2'])\npc_df=pd.concat([pc_df,y],axis=1)","3572f45c":"sns.scatterplot(x='feature1',y='feature2',data=pc_df,hue='target')","2cd43b43":"from sklearn.metrics import accuracy_score,confusion_matrix,classification_report\nfrom sklearn.neighbors import KNeighborsClassifier\n","5fc7ac5b":"acc=np.array([])\nfor i in range(1,190):\n    model=KNeighborsClassifier(n_neighbors=i)\n    model.fit(X_train,y_train)\n    pred=model.predict(X_test)\n    acc=np.append(acc,accuracy_score(pred,y_test))\n\n","bb0a3796":"np.argmax(acc)","954b3b8b":"fig, ax = plt.subplots(figsize=(11.7, 8.27))\nsns.lineplot(ax=ax,y=acc,x=range(1,190))","8155e725":"model=KNeighborsClassifier(n_neighbors=148)\nmodel.fit(X_train,y_train)\npred=model.predict(X_test)\nprint(classification_report(pred,y_test))\n","f61648c9":"from sklearn.svm import SVC\nfrom sklearn.model_selection import GridSearchCV","a5743100":"model=SVC()","c1a39742":"model.fit(X_train,y_train)\n\npred=model.predict(X_test)\n\nprint(classification_report(pred,y_test))","ce7b8d27":"grid=GridSearchCV(estimator=SVC(),param_grid={'C': [0.1,1, 10, 100], 'gamma': [1,0.1,0.01,0.001], 'kernel': ('linear', 'rbf')},verbose=3,refit=True)","6b1a4140":"grid.fit(X_train,y_train)","e13a52bc":"grid.best_estimator_","870a1245":"grid_pred=grid.predict(X_test)","f8ac93ce":"print(classification_report(grid_pred,y_test))","452bd481":"from sklearn.naive_bayes import GaussianNB\nfrom sklearn.linear_model import LogisticRegression","6c83b10a":"model=GaussianNB()\nmodel.fit(X_train,y_train)\n\npred=model.predict(X_test)\n\nprint(classification_report(pred,y_test))","e665012e":"![alt](http:\/\/www.simpleimageresizer.com\/_uploads\/photos\/ed8a77c2\/Untitled-1_2_40.png)","3f139a96":"# KNeighbors","5b2dd2a4":"1. KNeighbors              0.86\n2. Naive Bayes(GaussianNB) 0.83\n3. SVC                     0.83","c0134285":"# Logistic Regression","62b3e28c":"# SVM ","3a3833d9":"# SUM"}}