{"cell_type":{"15d013f1":"code","a188b949":"code","93c40af1":"code","246ae920":"code","b9a02445":"code","8121aa9e":"code","47a8cc22":"code","685050fb":"code","81866c7c":"code","4cc5ed1b":"code","7ff8ccc2":"code","12f18969":"code","7e908d20":"code","eccee038":"code","96910da8":"code","3aad7f16":"code","5effb6ed":"code","3b4a1c10":"code","5dee5541":"code","991cd87a":"code","9013cbc4":"markdown"},"source":{"15d013f1":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","a188b949":"sample=pd.read_csv(\"\/kaggle\/input\/allstate-claims-severity\/sample_submission.csv\")\nsample.head()","93c40af1":"train=pd.read_csv(\"\/kaggle\/input\/allstate-claims-severity\/train.csv\")\ntrain.head()","246ae920":"from sklearn.preprocessing import LabelEncoder\nla=LabelEncoder()\nfor i in train:\n    if 'cat' in i:\n        train[i]=la.fit_transform(train[i])","b9a02445":"train.head()","8121aa9e":"train.info()","47a8cc22":"import matplotlib.pyplot as plt\nplt.figure(figsize=(15,15))\nimport seaborn as sns\nsns.heatmap(train.corr(),annot=True,cmap=\"Blues\")","685050fb":"x=train.drop([\"id\",\"loss\"],axis=1)\ny=train[\"loss\"]","81866c7c":"from sklearn.model_selection import train_test_split,KFold,cross_val_score\nxr,xt,yr,yt=train_test_split(x,y)","4cc5ed1b":"from sklearn.ensemble import GradientBoostingClassifier,RandomForestClassifier,RandomForestRegressor,GradientBoostingRegressor\nfrom xgboost import XGBClassifier,XGBRFRegressor,XGBRegressor\nfrom sklearn.tree import DecisionTreeClassifier,DecisionTreeRegressor\nfrom sklearn.linear_model import LogisticRegression,LinearRegression,SGDRegressor\nfrom sklearn.svm import SVC,SVR\nfrom sklearn.neighbors import KNeighborsClassifier,KNeighborsRegressor\nfrom sklearn.naive_bayes import GaussianNB\nfrom lightgbm import LGBMRegressor","7ff8ccc2":"model=XGBRegressor(n_estimators=1000)\nmodel.fit(x,y)\nprint(model)","12f18969":"yp=model.predict(xt)","7e908d20":"from sklearn.metrics import mean_squared_error,mean_absolute_error,r2_score\nprint(r2_score(yt,yp))\nprint(mean_absolute_error(yt,yp))\nprint(mean_squared_error(yt,yp))","eccee038":"test=pd.read_csv(\"\/kaggle\/input\/allstate-claims-severity\/test.csv\")\ntest.head()","96910da8":"for i in test:\n    if 'cat' in i:\n        test[i]=la.fit_transform(test[i])","3aad7f16":"pred=test.drop('id',axis=1)\nyp=model.predict(x)\ny1=pd.DataFrame(yp)","5effb6ed":"test=pd.concat([test,y1],axis=1)","3b4a1c10":"test.head()","5dee5541":"test.columns","991cd87a":"test.to_csv(\"sub.csv\",index=False,columns=['id',0])","9013cbc4":"# TEST"}}