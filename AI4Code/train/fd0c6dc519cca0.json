{"cell_type":{"604deeb6":"code","301a0b67":"code","640e0cac":"code","3a0c2496":"code","b234669b":"code","5a93c86c":"code","3048acaa":"code","c9250c2a":"code","acb40a4a":"code","2ade3d8e":"code","5a2f198d":"code","23c1b4b3":"code","fef0fa7e":"code","a2aab289":"code","10d8f535":"code","0bb86420":"code","616472b3":"code","a9e7d6dc":"code","fc1461b2":"code","fbfcc38b":"code","f841341c":"markdown","bb8f9571":"markdown","e70d21d7":"markdown","1e84f0c0":"markdown","aa2d97a7":"markdown","28143d56":"markdown","a737ca20":"markdown","2f7245c4":"markdown","20896f67":"markdown","4d30939b":"markdown","ba055815":"markdown","bda1769d":"markdown"},"source":{"604deeb6":"# import useful libraries\nimport numpy as np\nimport pandas as pd \n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.metrics import accuracy_score, classification_report\nfrom xgboost import XGBClassifier","301a0b67":"# Load the data and look at first 5 examples\ndf = pd.read_csv('\/kaggle\/input\/loan-prediction-based-on-customer-behavior\/Training Data.csv', index_col='Id')\ndf.head()","640e0cac":"# Look for nulls\ndf.info()","3a0c2496":"df = df.apply(LabelEncoder().fit_transform);","b234669b":"y = df.Risk_Flag\nX = df.drop('Risk_Flag', axis=1)","5a93c86c":"# Brief description of the data\ndf.describe()","3048acaa":"# Look at the percentage of Defaulter in the data\nr = df.groupby('Risk_Flag')['Risk_Flag'].count()\n\nplt.pie(r, explode=[0.05, 0.1], labels=['Non-Defaulter', 'Defaulter'], radius=1.5, autopct='%1.1f%%', shadow=True)\n;","c9250c2a":"# Let's look at correlations between variables\nplt.figure(figsize=(15,10))\nsns.heatmap(df.corr(), annot=True, cmap=\"YlGnBu\")","acb40a4a":"plt.figure(figsize=(25,8))\nsns.lineplot(df['Age'], df['Experience'], hue=df['Risk_Flag'],ci=0)","2ade3d8e":"plt.figure(figsize=(25,8))\nsns.lineplot(df['Experience'], df['Income'], hue=df['Risk_Flag'],ci=0)","5a2f198d":"f = plt.figure(figsize=(25,5))\nax = f.subplots(1, 5)\nsns.boxplot(x='Risk_Flag', y='Income', data=df, ax=ax[0])\nsns.boxplot(x='Risk_Flag', y='Experience', data=df, ax=ax[1])\nsns.boxplot(x='Risk_Flag', y='Age', data=df, ax=ax[2])\nsns.boxplot(x='Risk_Flag', y='CURRENT_JOB_YRS', data=df, ax=ax[3])\nsns.boxplot(x='Risk_Flag', y='CURRENT_HOUSE_YRS', data=df, ax=ax[4])\n;","23c1b4b3":"# Split the Data\nX_train, X_test, y_train, y_test = train_test_split(X, y)","fef0fa7e":"forest = RandomForestClassifier()\nforest.fit(X_train, y_train)","a2aab289":"preds = forest.predict(X_test)","10d8f535":"print(classification_report(y_test, preds))","0bb86420":"accuracy_score(preds, y_test)","616472b3":"xgb = XGBClassifier()\nxgb.fit(X_train, y_train)","a9e7d6dc":"preds2 = xgb.predict(X_test)","fc1461b2":"print(classification_report(preds2, y_test))","fbfcc38b":"accuracy_score(preds2, y_test)","f841341c":"We can't see any signeficant difference between defaulters and non-defaulters from `Income`, `Experience`, `Age`, `CURRENT_JOB_YRS`, `CURRENT_HOUSE_YRS`","bb8f9571":"## Data Loading and Preparation","e70d21d7":"No null values found :D","1e84f0c0":"### XGBoost Model","aa2d97a7":"## Training the Model","28143d56":"### Random Forest Model","a737ca20":"## Potential Loan Defaulters\n- In this notebook, we will conduct some data analysis on the data in order to find any relations, then we will use some machine learning algorithms to classify potential loans defaulters.","2f7245c4":"Only 12.3% of the data are Defaulters","20896f67":"It looks only `Experience` and `CURRENT_JOB_YRS` are slightly correlated","4d30939b":"## And Done\nfor now :D","ba055815":"## Data Visualization","bda1769d":"# if \ud83d\udc4d please \u2b06\ufe0f "}}