{"cell_type":{"0cd02456":"code","4e5d6eb0":"code","badbc52e":"code","00e111c5":"code","d231e50b":"code","7561510c":"code","c0dccdec":"code","b937840d":"code","b3b60746":"code","1cca6d66":"code","3e1bdda9":"code","31372407":"code","e14f2b81":"code","5a02c81a":"code","c3ac6926":"code","4583f238":"code","32a6d6e1":"code","a24608d1":"code","91f11832":"code","f381ac2f":"code","704bd3cf":"code","963e96d7":"code","d35af973":"code","f55357c4":"markdown","ea581ca0":"markdown","e9f35cf6":"markdown","a0135e3b":"markdown","9c808561":"markdown","e0e9064c":"markdown","46ce6bdb":"markdown","5e9e5a75":"markdown","38c930c8":"markdown","c56e415d":"markdown","eeee10f5":"markdown","cf3292fe":"markdown","fbdfc85c":"markdown","86238743":"markdown","56b8f1de":"markdown","ce624de9":"markdown"},"source":{"0cd02456":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","4e5d6eb0":"df = pd.read_csv('..\/input\/athlete_events.csv')\ndf.info()","badbc52e":"import matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import classification_report,confusion_matrix\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.tree import DecisionTreeClassifier\nimport tensorflow as tf","00e111c5":"df.head()","d231e50b":"df[(df['Season']=='Summer')&(df['Year']==2016)]['Sport'].value_counts()","7561510c":"a = df[(df['Season']=='Summer')]['Sport'].value_counts()\nallSports = list(a.keys())\nlen(allSports)","c0dccdec":"a = df[(df['Season']=='Summer')&(df['Year']>=2000)]['Sport'].value_counts()\nmodernSports = list(a.keys())\nlen(modernSports)","b937840d":"# To find a count of the number of times a sport has been included in the summer games\na = df[df['Season']=='Summer'].groupby(['Year'])['Sport'].value_counts()\nyearIndex = 0\nc = np.zeros(((int)((2020-1896) \/ 4),len(allSports)))\nfor year in range(1896,2020,4):\n    if year in a:\n        sportIndex = 0\n        for sport in allSports:\n            if (sport in a[year]):\n                c[yearIndex][sportIndex] = a[year][sport]\n            sportIndex = sportIndex + 1\n    yearIndex = yearIndex + 1","b3b60746":"aa = df[(df['Season']=='Summer')]['Sport'].value_counts()\nplt.figure(figsize=(16,8))\nplt.subplot(121)\nplt.barh(allSports,aa.values)\nplt.subplot(122)\nplt.barh(allSports,sum(c>0))","1cca6d66":"df1 = df.dropna(subset=['Age', 'Height', 'Weight'])\ndf1 = df1[df1['Season'] == 'Summer']\ndf1 = df1.drop(columns=['ID', 'Team', 'Games', 'Season', 'City', 'NOC', 'Event', 'Medal'])\ndf1 = df1.drop_duplicates()\ndf1 = df1.drop(columns=['Name'])\nle1 = LabelEncoder()\ndf1['Sex'] = le1.fit_transform(df1['Sex'])\naa = df1['Sport'].value_counts()\nallSports1 = list(aa.keys())\na = df1.groupby(['Year'])['Sport'].value_counts()\nyearIndex = 0\nc = np.zeros(((int)((2020-1896) \/ 4),len(allSports1)))\nfor year in range(1896,2020,4):\n    if year in a:\n        sportIndex = 0\n        for sport in allSports1:\n            if (sport in a[year]):\n                c[yearIndex][sportIndex] = a[year][sport]\n            sportIndex = sportIndex + 1\n    yearIndex = yearIndex + 1\naa = df1['Sport'].value_counts()\nplt.figure(figsize=(16,8))\nplt.subplot(121)\nplt.barh(allSports1,aa.values)\nplt.subplot(122)\nplt.barh(allSports1,sum(c>0))","3e1bdda9":"chosenSports = modernSports\nsportIndex = 0\nfor sport in allSports1:\n    if sum(c>0)[sportIndex] < 5:\n        if sport in chosenSports:\n            chosenSports.remove(sport)\n    sportIndex = sportIndex + 1\nlen(chosenSports)","31372407":"df1 = df1[df1['Sport'].isin(chosenSports)]\ndf1 = df1.drop(columns=['Year'])\nsports = df1['Sport'].unique()\nle2 = LabelEncoder()\ndf1['Sport'] = le2.fit_transform(df1['Sport'])\ndf1.info()","e14f2b81":"sns.pairplot(df1)","5a02c81a":"X = df1.drop(columns=['Sport'])\ny = df1['Sport']\nscaler = StandardScaler()\nscaler.fit(X.values)\nscaled_features = scaler.fit_transform(X.values)\ndf_feat = pd.DataFrame(scaled_features, columns=X.columns)\nX1 = df_feat\ny1 = pd.DataFrame(y)\nX_train, X_test, y_train, y_test = train_test_split(X1.values, y1.values, test_size=0.3)","c3ac6926":"#Decision tree:\ndtree = DecisionTreeClassifier()\ndtree.fit(X_train,y_train)\npredictions_dt = dtree.predict(X_train)\nprint(classification_report(y_train,predictions_dt))\npredictions_dt = dtree.predict(X_test)\nprint(classification_report(y_test,predictions_dt))","4583f238":"# Neural network, several relu layers, finish with a softmax layer\nmodel = tf.keras.models.Sequential([\n    tf.keras.layers.Dense(4),\n    tf.keras.layers.Dense(10, activation=tf.nn.relu),\n    tf.keras.layers.Dense(20, activation=tf.nn.relu),\n    tf.keras.layers.Dense(40, activation=tf.nn.relu),\n    tf.keras.layers.Dense(len(chosenSports), activation=tf.nn.softmax)\n])\nmodel.compile(optimizer='adam',\n              loss='sparse_categorical_crossentropy',\n              metrics=['accuracy'])","32a6d6e1":"model.fit(X_train, y_train, epochs=10)","a24608d1":"train_loss, train_acc = model.evaluate(X_train, y_train)\nprint('Train accuracy: {:5.2f}'.format(100*train_acc))\ntest_loss, test_acc = model.evaluate(X_test, y_test)\nprint('Test accuracy: {:5.2f}'.format(100*test_acc))","91f11832":"predictions_nn = model.predict(X_train)\npredictions_nn1 = np.argmax(predictions_nn, axis=1)\nprint(classification_report(y_train,predictions_nn1))\npredictions_nn = model.predict(X_test)\npredictions_nn1 = np.argmax(predictions_nn, axis=1)\nprint(classification_report(y_test,predictions_nn1))","f381ac2f":"counts = np.zeros((len(chosenSports),), dtype=int)\ni = 0\nfor prediction in predictions_nn:\n    a = np.argsort(prediction)\n    for j in range((len(chosenSports))):\n        if y_test[i] == a[-(j+1)]:\n            for c in range((len(chosenSports)-j)):\n                counts[j+c] = counts[j+c]+1\n    i = i+1\ncounts = counts \/ i\n# accuracy for if target is included in top X suggested sports\nprint(counts)","704bd3cf":"plt.plot(counts)","963e96d7":"def sport_for_person(sex, age, height, weight, model_type):\n    test = np.array([sex, age, height, weight], np.float64)\n    test = test.reshape(1, -1)\n    test1 = scaler.transform(test)\n    toprint = \"\"\n    if model_type == 'svc':\n        prediction = svc_model.predict(test1)\n        toprint = \"[SVC] Suggested sport is: \"\n        toprint = toprint + sports[prediction]\n        print(toprint[0])\n    elif model_type == 'dt':\n        prediction = dtree.predict(test1)\n        toprint = \"[DT] Suggested sport is: \"\n        toprint = toprint + sports[prediction]\n        print(toprint[0])\n    elif model_type == 'nn':\n        prediction = model.predict(test1)\n        a = np.argsort(prediction)\n        toprint = \"[NN] Suggested sports are: \"\n        for j in range(10):\n            toprint = toprint + sports[a[0][-(j+1)]] + ' (' + (str)((int)(100*prediction[0][a[0][-(j+1)]])) + '%)'\n            if (j!=9):\n                toprint = toprint + ', '\n        print(toprint)","d35af973":"#sex: for male enter 1, for female enter 0\n#age: in years\n#height: in cm\n#weight: in kg\n\nsexes = [0, 1]\nages = [18, 24, 32]\nheights = [150, 175, 200]\nweights = [50, 80, 110]\nfor sex in sexes:\n    for age in ages:\n        for height in heights:\n            for weight in weights:\n                \n                print('For a', age, 'year old', 'male' if sex else 'female', height, 'cm and', weight, 'kg:')\n                sport_for_person(sex, age, height, weight,'dt')\n                sport_for_person(sex, age, height, weight,'nn')","f55357c4":"The neural network performs worse than the decision tree on the training data, but generalises better to the test set. However, there are about one third of the classes that are not being predicted correctly at all.","ea581ca0":"This pairplot shows that there are some trends between different sports, but there is also a very large overlap, particularly in the average age, height, and weight of competitors overall.\n\nSo, although it is unlikely that a classifier will do very well on this task (predict sport from sex, age, height, weight), here I will compare some standard techniques for predicting:\n- decision tree\n- neural networks","e9f35cf6":"Things to note from the head:\n- Can see some missing height and weight is likely because this was not recorded for competitors from early modern olympics (1900, 1920).\n- Some sports and events from early modern olympics are no longer included in the current olympics (Tug-Of-War in 1900).\n- Sport is general, there may be many events to a sport.\n- Team and NOC may not directly match e.g. Denmark\/Sweden -> DEN","a0135e3b":"For the neural network, it is also straightforward to convert a single prediction to choosing the top X sports. With 5 sports, the correct sport is included 67% of the time, with 10 sports, the sport is included 85% of the time.","9c808561":"After taking out competitors with no age, weight, or height entered, there are now 43 sports.","e0e9064c":"Import packages for visualizations and modeling.","46ce6bdb":"### Model of the data\n\nI propose to predict what event a competitor is in, given their height, weight, and age data.\n\nIt is unlikely that this will be able to be predicted with high accuracy, because there will be large overlap between the types of competitor in different sports. However, the top X sports for a given height, weight, age, may be fairly good indicator.\n\nAnd this could be interesting information for someone: what sport would someone who is their height, weight, sex, age, likely to participate in at the olympics?\n\nI propose to restrict data in the following ways:\n- remove competitors for which there is no height, weight, age data (all other data is complete)\n- restrict season to summer\n- remove duplicate competitors that competed in multiple events in the same sport in the same year\n- restrict the set of sports (see below)\n\nI initially thought to restrict the year to after 1996, however, this reduces the number of data points significantly. Restricting the sports somehow, but including the earlier data should result in a better classifier.\n\nTo select a good set of sports to select over:\n- Has been held in the last X games\n- Has been held in at least Y games\n\nGood values for X and Y are probably X=5 (since 2000), Y=5\n\nIt would also be possible to select for number of competitors, but the restriction to have been held in at least 5 years should already remove sports with too few competitors.\n\nAlso process data so that it can be used in a Decision Tree and a Neural Network","5e9e5a75":"Predictions are made, but they are not necessarily sensible ones. There is probably some interesting dividing up of sex-age-height-weight space for the different sports that could be looked into.","38c930c8":"### Conclusions\nThe models constructed do ok, considering the overlapping nature of the categories. More could be done to tune these, but doing so would not guarantee a model that can accurately predict a sport or event given a competitors details, in part because for a given set of characteristics, there may be a wide range of appropriate sports.","c56e415d":"After choosing sports that have been included in the games since 2000, and are in at least 5 games, there are now 33 different sports.","eeee10f5":"Note that there are null entries in age, height, weight, and medal, but all other columns are complete. This is expected for medal, since only a small proportion of those entered in each event will win a medal. For age, height, and weight, this is simply missing data.","cf3292fe":"In this notebook, I practice a few different techniques, creating a decision tree and neural network model to predict sport given physical features (Sex, Age, Weight, Height) -> what sport should you do, given your physical features?","fbdfc85c":"For the two models, here is a query for what sport is predicted for a given set of features.","86238743":"The figure on the left shows the number of competitors for each sport over the whole dataset. The figure on the right shows the number of years in which a sport has been held.\n\nThings to note:\n- Modern Pentathlon, which has been held at 24 of the games, but has a small number of competitors each year.\n- Several events in the modern list of events (Taekwondo, Baseball, Beach Volleyball) have only been held in a small number of games, and have small number of total competitors in the dataset\n- Not every sport is held at every games, for example Baseball and Softball were not held in 2016, but are back on the program for 2020.\n- There are 52 sports that have been held in the Summer games, of which 36 have been at games since 2000","56b8f1de":"Decision Tree has overfit the training set, reaching 60% precision, 56% recall, f1-score of 0.55, but on the test set reaching average 21% precision, 23% recall, with a f1-score of 0.21. It was very quick to train.","ce624de9":"These are the 34 sports that were in the most recent summer games (2016), noting that athletics and Swimming are very large (>1000 competitors), and Trampolining, Modern Pentathlon, Beach Volleyball, and Rythmic Gymnastics are small (<100)\n\nAlso, regarding number of competitors, note that there are duplicate rows with respect to weight, height, sex, and age information for competitors in sports like Athletics, Swimming, Gymnastics, as individuals compete in multiple events in these sports"}}