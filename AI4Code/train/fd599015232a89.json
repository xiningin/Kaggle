{"cell_type":{"7a912b4e":"code","8b5a411c":"code","d91c8e91":"code","ee4bf7f7":"code","7d2780ba":"code","86781f33":"code","89f594a5":"code","5eb05d19":"code","e0d86a75":"code","a0eb8bb5":"code","49dee3ea":"code","782e0b1a":"code","80ed3a26":"markdown","cdccd266":"markdown","a2eb1706":"markdown","6dea3903":"markdown"},"source":{"7a912b4e":"import os\n\nos.listdir(\"..\/input\/movielens-100k-dataset\/ml-100k\")","8b5a411c":"!pip install -Uqq fastbook\nimport fastbook\n\n\nfrom fastbook import *","d91c8e91":"from fastai.collab import *\nfrom fastai.tabular.all import *\n\npath = '..\/input\/movielens-100k-dataset\/ml-100k'","ee4bf7f7":"path = Path(path)","7d2780ba":"movies = pd.read_csv(path\/'u.item', delimiter='|', encoding='latin-1',\n                     usecols=(0,1), names=('movie', 'title'),header=None)","86781f33":"movies.head()","89f594a5":"ratings = pd.read_csv(path\/'u.data', delimiter='\\t', header=None,\n                      names=['user','movie','rating','timestamp'])\nratings.head()","5eb05d19":"ratings = ratings.merge(movies)\nratings.head()","e0d86a75":"dls = CollabDataLoaders.from_df(ratings, item_name='title', bs=64)\ndls.show_batch()","a0eb8bb5":"# fastai has a function get_emb_sz that returns recommended sizes for embedding matrices for your data\nembs = get_emb_sz(dls)\nembs","49dee3ea":"learn = collab_learner(dls, use_nn=True, y_range=(0, 5.5), layers=[100,50])\nlearn.fit_one_cycle(5, 5e-3, wd=0.1)","782e0b1a":"learn.show_results()","80ed3a26":"### getting the dataloaders","cdccd266":"### Creating model and learner\n\nIn fastbook chapter 8, Authors have created a class from scratch but well use collab_learner for this data.\n","a2eb1706":"### further improvements\n\n1. Create a collab modle class from scratch.\n\n2. use cross entropy loss as loos function.","6dea3903":"###  The most barebone baseline \n\non this dataset"}}