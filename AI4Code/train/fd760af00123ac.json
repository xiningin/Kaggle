{"cell_type":{"0992e1c5":"code","2cb92aeb":"code","f84579cf":"code","2c1efbce":"code","6cb97449":"code","877446a5":"code","2691d86a":"code","74171894":"code","2ef4efa5":"code","ece3be50":"code","228f6bdb":"code","0f67bd2f":"code","d5412d66":"code","239a30b1":"code","9d7b5068":"code","aef8f7c7":"code","d3f1ca07":"code","5e58bb5d":"code","1148b08f":"code","a7a2480b":"code","b1187223":"code","cf7146e8":"code","c05a6c09":"code","0ab3e8c3":"code","d86d0f49":"code","a8bc61db":"code","9de6f5ab":"code","d3536e09":"code","1624e8f6":"code","3fed8606":"code","a6c1531d":"code","870981c4":"code","6f0eab73":"markdown","d02aec9e":"markdown","9cb98d2e":"markdown","8dc1f3b7":"markdown","edd62569":"markdown","4bb214ac":"markdown","a3c5c477":"markdown","86c9e780":"markdown","e2cf4e36":"markdown","da2d3187":"markdown","a44f9a65":"markdown","4afdab42":"markdown","bc912721":"markdown","5d08c890":"markdown","633b0e3d":"markdown","1aafb1fd":"markdown","4a88d5dc":"markdown","b3c2f878":"markdown","4fd5c1c7":"markdown","0dab8381":"markdown","2c89399d":"markdown","a4b3fa62":"markdown","70c2e4e2":"markdown","1315b8e3":"markdown","03129869":"markdown","14022ba7":"markdown","074344eb":"markdown","ab0aea52":"markdown","6cd10255":"markdown","e111d447":"markdown","9f20ea99":"markdown","6ee16871":"markdown","b7f59364":"markdown","2813b953":"markdown","ed833272":"markdown","96cdc9b0":"markdown","fc47a133":"markdown","fe4a2bf9":"markdown","de502212":"markdown","e52a4ef2":"markdown","fa5b7e08":"markdown","3ef914ae":"markdown","1e2325a8":"markdown","86f9fd45":"markdown","b63d4f8e":"markdown","de4f5ba7":"markdown","49730e54":"markdown","4a7fa610":"markdown","c20df942":"markdown"},"source":{"0992e1c5":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport folium\nfrom folium.plugins import HeatMap\n\nplt.style.use(\"seaborn-muted\")\nsns.set_style('darkgrid')\npd.set_option('display.max_columns', 50)\npd.set_option('display.max_rows', 200)\npd.set_option('display.float_format', lambda x: '%.5f' % x)\n\n%matplotlib inline","2cb92aeb":"raw_data = pd.read_csv('..\/input\/housesalesprediction\/kc_house_data.csv', parse_dates=['date', 'yr_built'])","f84579cf":"raw_data.head(10)","2c1efbce":"print('Dimens\u00e3o dos dados')\nprint('Linhas:',raw_data.shape[0])\nprint('Colunas:',raw_data.shape[1])","6cb97449":"raw_data.info()","877446a5":"raw_data = raw_data.assign(year_built=raw_data.yr_built.dt.year)\nraw_data.drop('yr_built', 1, inplace=True)","2691d86a":"raw_data.head()","74171894":"pd.DataFrame(raw_data['price'].describe())","2ef4efa5":"med_price = raw_data['price'].median()\n\nplt.figure(figsize=[20, 8])\nsns.distplot(raw_data['price'], color = 'r', label = 'Distribui\u00e7\u00e3o')\nplt.axvline(med_price, color='b', linestyle='dashed', label='Mediana')\nplt.ticklabel_format(style='plain', axis='x')\nplt.title('Distribui\u00e7\u00e3o do pre\u00e7o de vendas das casas')\nplt.xlabel('Pre\u00e7o (em d\u00f3lar)')\nplt.ylabel('Densidade')\nplt.xticks(np.arange(raw_data['price'].min(), raw_data['price'].max(), step=500000))\n\nplt.legend()\nplt.show()","ece3be50":"raw_data.isnull().sum().sort_values(ascending=False)","228f6bdb":"plt.figure(figsize=[12, 6])\n\nplt.subplot(121)\nsns.boxplot(x='condition', y='price', data=raw_data);\n\nplt.subplot(122)\nsns.boxplot(x='grade', y='price', data=raw_data)\n\nplt.show()","0f67bd2f":"pd.DataFrame(raw_data['condition'].value_counts().sort_index())","d5412d66":"pd.DataFrame(raw_data['grade'].value_counts().sort_index())","239a30b1":"var_num = raw_data._get_numeric_data()\nvar_num.drop('id', 1, inplace=True)\nvar_num.head()","9d7b5068":"var_num.corr()","aef8f7c7":"var_num_corr = var_num.corr()\n\nplt.figure(figsize = [12, 8])\nsns.heatmap(var_num_corr, vmin=-1, vmax=1, linewidth=0.01, linecolor='black', cmap='RdBu_r')\nplt.show()","d3f1ca07":"var_num_corr['price'].sort_values(ascending=False).round(3)","5e58bb5d":"cols = raw_data[['bedrooms', 'bathrooms', 'sqft_living', 'grade', 'sqft_above',\n                         'sqft_living15', 'price']]\nmost_corr_var = cols.corr()\n\nplt.figure(figsize=[10, 6])\nsns.heatmap(data=most_corr_var, vmin=-1, vmax=1, linewidth=0.01, linecolor='black', cmap='RdBu_r', annot=True)\n\nplt.show()","1148b08f":"plt.figure(figsize=[15, 15])\n\ni = 1\n\nfor col in cols:\n    if col == 'price':\n        continue\n    plt.subplot(4, 2, i)\n    sns.regplot(raw_data[col], raw_data['price'], line_kws={'color': 'r'})\n    plt.xlabel(col)\n    plt.ylabel('Pre\u00e7o de venda ($)')\n    i+=1\n    \n\nplt.tight_layout()\nplt.show()","a7a2480b":"raw_data['view'].value_counts() \/ len(raw_data)","b1187223":"plt.figure(figsize=(8, 4))\nsns.set_style(\"darkgrid\")\n\nsns.regplot(raw_data['view'], raw_data['price'], line_kws={'color': 'r'})\n\nplt.show()","cf7146e8":"plt.figure(figsize=(12, 6))\n\nsns.scatterplot(raw_data['waterfront'], raw_data['price'], hue=raw_data['waterfront'])\n\nplt.show()","c05a6c09":"plt.figure(figsize=(12, 6))\n\ncmap = sns.cubehelix_palette(dark=.8, light=.3, as_cmap=True)\nsns.scatterplot(raw_data['floors'], raw_data['price'], hue=raw_data['floors'], palette=cmap)\n\nplt.show()","0ab3e8c3":"dates = pd.DataFrame(raw_data['year_built'], columns=['year_built'])\nbins = [1900, 1910, 1920, 1930, 1940, 1950, 1960, 1970, 1980, 1990, 2000, 2010, 2015]\nlabels = ['1900 - 1910', '1911 - 1920', '1921 - 1930', '1931 - 1940', '1941 - 1950', '1951 - 1960', '1961 - 1970', '1971 - 1980',\n         '1981 - 1990', '1991 - 2000', '2001 - 2010', '2011 - 2015']\nraw_data['decade_built'] = pd.cut(dates['year_built'], bins, labels = labels, include_lowest = True)\nraw_data.sample(5)","d86d0f49":"plt.figure(figsize=[12, 8])\n\nsns.barplot(x=raw_data['price'], y=raw_data['decade_built'], palette=\"cubehelix_d\")\n\nplt.show()","a8bc61db":"prices = pd.DataFrame(raw_data['price'], columns=['price'])\nbins = [0, 250000, 500000, 1000000, 8000000]\nlabels = ['Group 1', 'Group 2', 'Group 3', 'Group 4']\nraw_data['price group'] = pd.cut(prices['price'], bins, labels = labels, include_lowest = True)\nraw_data.sample(5)","9de6f5ab":"raw_data.groupby('price group')['price group'].count()","d3536e09":"raw_data = raw_data.assign(renovated=(raw_data['yr_renovated'] > 0).astype(int))","1624e8f6":"raw_data.head(10)","3fed8606":"renovated = raw_data.groupby('renovated')['price'].count()\nrenovated","a6c1531d":"renovated_median = raw_data.groupby('renovated')['price'].median()\nrenovated_median","870981c4":"plt.figure(figsize=(15, 5))\n        \nplt.subplot(1, 2, 1)\nplt.pie(renovated, explode = (0, 0.1), colors=['r', 'lightblue'], labels= ['N\u00e3o', 'Sim'], autopct='%1.1f%%')\nplt.title('A casa foi renovada ou n\u00e3o?')\n\nplt.subplot(1, 2, 2)\nsns.barplot(x=renovated.index, y = renovated_median, palette=['r', 'lightblue'])\nplt.title('Mediana dos pre\u00e7os das casas renovadas ou n\u00e3o')\nplt.ylabel('Mediana de pre\u00e7o')\n\nplt.tight_layout()\nplt.show()","6f0eab73":"\u00c9 um dataset com uma quantidade razo\u00e1vel de amostras","d02aec9e":"Por se tratar de um dataset do Kaggle, j\u00e1 era esperado que os dados tivessem passado por algum tratamento pr\u00e9vio, hip\u00f3tese confirmada com o c\u00f3digo acima, que mostra que n\u00e3o h\u00e1 vari\u00e1veis nulas em cada coluna.","9cb98d2e":"A grande maioria das casas de encontra na condi\u00e7\u00e3o 0, seguido por 2, 3, 1 e 4","8dc1f3b7":"### Uma vez a casa em posse da empresa, qual o melhor momento para vend\u00ea-las e qual seria o pre\u00e7o da venda?","edd62569":"Antes de mais nada, vamos \u00e0 descri\u00e7\u00e3o de cada coluna dos dados\n* **date**: data de venda\n* **price**: pre\u00e7o de venda\n* **bedrooms**: n\u00famero de quartos\n* **bathrooms**: n\u00famero de banheiros\n* **sqft_living**: tamanho da \u00e1rea habitacional em p\u00e9s\u00b2\n* **sqft_lot**: tamanho do lote em p\u00e9s\u00b2\n* **floors**: n\u00famero de andares\n* **waterfront**: \u20181\u2019 se a propriedade for \u00e0 beira-mar, \u20180\u2019 se n\u00e3o.\n* **view**: um \u00edndice de 0 a 4 do qu\u00e3o bom \u00e9 a vis\u00e3o da propriedade (imagine 0 para uma propriedade com vis\u00e3o para um beco sujo e 4 para uma propriedade com vis\u00e3o para um lindo parque)\n* **condition**: condi\u00e7\u00e3o da casa, com valores de 1 at\u00e9 5\n* **grade**: classifica\u00e7\u00e3o pela qualidade do material da casa. Constru\u00e7\u00f5es com melhores materiais normalmente custam mais caro\n* **sqft_above**: p\u00e9s\u00b2 acima do solo\n* **sqft_basement**: p\u00e9s\u00b2 abaixo do solo\n* **yr_built**: ano de constru\u00e7\u00e3o\n* **yr_renovated**: ano de renova\u00e7\u00e3o. \u20180\u2019 se nunca foi renovada\n* **zipcode**: c\u00f3digo zip de 5 d\u00edgitos\n* **lat, long**: latitude e longitude\n* **squft_livng15**: tamanho m\u00e9dio das 15 casas mais pr\u00f3ximas, em p\u00e9s\u00b2\n* **sqft_lot15**: tamanho m\u00e9dio dos lotes das 15 casas mais pr\u00f3ximas, em p\u00e9s\u00b2","4bb214ac":"## Carregamento","a3c5c477":"## Explora\u00e7\u00e3o das demais vari\u00e1veis","86c9e780":"### Colunas importantes","e2cf4e36":"#### Criando uma nova coluna mostrar se a casa foi reformada ou n\u00e3o","da2d3187":"#### View","a44f9a65":"A vari\u00e1vel \"grade\" parece seguir uma distribui\u00e7\u00e3o normal, onde quantidade de casas aumenta de 1 a 7 e ap\u00f3s isso come\u00e7a a diminuir at\u00e9 as casas de \"grade\" 13.","4afdab42":"Irei analisar melhor as colunas que possuem correla\u00e7\u00e3o maior que 0.5 e menor que -0.5, nesse caso **bathrooms, sqft_living, grade, sqft_above e sqft_living15**. Apesar da coluna **bedrooms**  n\u00e3o apresentar uma correla\u00e7\u00e3o muito forte, irei us\u00e1-la nas an\u00e1lises abaixo, j\u00e1 que no conceito de neg\u00f3cio casas com mais quartos costumam custar mais.","bc912721":"Grande parte das casas n\u00e3o passou por nenhuma renova\u00e7\u00e3o, por\u00e9m, as casas renovadas tendem a possuir um pre\u00e7o mais elevado que as casas n\u00e3o renovadas.","5d08c890":"\u00c9 not\u00e1vel que existem diversas colunas sem correla\u00e7\u00e3o com o pre\u00e7o de venda. Abaixo analisarei melhor as colunas que possuem alguma correla\u00e7\u00e3o, seja positiva ou negativa.","633b0e3d":"Como visto no histograma inicial, a grande maioria das casas vendidas se encontra nos grupos 2 e 3, ou seja, a faixa de pre\u00e7o varia entre 250 mil dol\u00e1res e 1 milh\u00e3o.","1aafb1fd":"## Explora\u00e7\u00e3o da vari\u00e1vel alvo (price)","4a88d5dc":"Logo de cara, podemos ver alguns dados estranhos, como os n\u00fameros 4.5, 2.25 e 1.5 na coluna de banheiros.","b3c2f878":"Ap\u00f3s uma varia\u00e7\u00e3o de altos e baixos entre os anos de 1900 e 1960, o pre\u00e7o das casas voltou a subir a partir do ano de 1961.","4fd5c1c7":"Peguei apenas as informa\u00e7\u00f5es dos anos de constru\u00e7\u00e3o e coloquei em uma nova coluna, depois excluir a coluna antiga que tamb\u00e9m continha dia e m\u00eas.","0dab8381":"### Colunas n\u00e3o t\u00e3o importantes","2c89399d":"#### Waterfront","a4b3fa62":"### A *House Rocket* deveria fazer uma reforma para aumentar o pre\u00e7o da venda? Quais seriam as sugest\u00f5es de mudan\u00e7as?","70c2e4e2":"#### Correla\u00e7\u00e3o entre colunas","1315b8e3":"#### Correla\u00e7\u00e3o das colunas com o *price*","03129869":"\u00c9 poss\u00edvel notar que o valor das casas varia entre o m\u00ednimo e o m\u00e1ximo, independente de possuirem \"waterfront\" (indicado pelo n\u00famero 1.0) ou n\u00e3o (indicado pelo n\u00famero 0.0)","14022ba7":"Est\u00e1 longe de ser uma distribui\u00e7\u00e3o normal. H\u00e1 uma forte assimetria \u00e0 direita. Grande parte das resid\u00eancias se encontra com pre\u00e7o aproximadamente entre **250.000** ~ **575.000** d\u00f3lares. \u00c0 partir de $ 1.075.000 a quantidade de casas tem uma grande diminui\u00e7\u00e3o e essa tend\u00eancia continua at\u00e9 o valor m\u00e1ximo.","074344eb":"H\u00e1 poucas casas em condi\u00e7\u00f5es ruins (1, 2), uma quantidade elevada de casas em condi\u00e7\u00e3o m\u00e9dia (3), uma quantidade consider\u00e1vel em condi\u00e7\u00f5es boas (4) e uma quantidade menor de casas em condi\u00e7\u00f5es \u00f3timas (5).","ab0aea52":"Esse \u00e9 um desafio proposto pelo Meigarom do blog [Seja um data scientist](http:\/\/sejaumdatascientist.com) e consiste da seguinte situa\u00e7\u00e3o:\n\n\" A **House Rocket** \u00e9 uma plataforma digital que tem como modelo de neg\u00f3cio a compra e venda de im\u00f3veis usando tecnologia. Sua principal estrat\u00e9gia \u00e9 comprar boas casas em \u00f3timas localiza\u00e7\u00f5es com pre\u00e7os baixos e depois revend\u00ea-las posteriormente \u00e0 pre\u00e7os mais altos. Quanto maior a diferen\u00e7a entre a compra e a venda, maior o lucro da empresa e portanto maior sua receita. Entretanto, as casas possuem muitos atributos que as tornam mais ou menos atrativas aos compradores e vendedores e a localiza\u00e7\u00e3o e o per\u00edodo do ano tamb\u00e9m podem influenciar os pre\u00e7os. Portanto a meta \u00e9 responder as seguinte perguntas:\n1. Quais casas o CEO da House Rocket deveria comprar e por qual pre\u00e7o de compra?\n1. Uma vez a casa em posse da empresa, qual o melhor momento para vend\u00ea-las e qual seria o pre\u00e7o da venda?\n1. A House Rocket deveria fazer uma reforma para aumentar o pre\u00e7o da venda? Quais seriam as sugest\u00f5es de mudan\u00e7as?\"\n\nMinha meta \u00e9 responder todas essas perguntas atrav\u00e9s de uma an\u00e1lise dos dados. N\u00c3O irei realizar um tratamento dos dados (padronizar, escalonar, imputer) e nem aplicar um modelo de ML nesse notebook, apenas em um pr\u00f3ximo.","6cd10255":"# Explora\u00e7\u00e3o dos dados","e111d447":"#### Separando os pre\u00e7os das casas em grupos","9f20ea99":"# Contexto do problema","6ee16871":"#### Vari\u00e1veis que podem aumentar o pre\u00e7o das casas","b7f59364":"Crei uma nova coluna separando as casas em grupos de acordo com o pre\u00e7o:\n* Group 1: de 0 a 250000 d\u00f3lares\n* Group 2: de 250001 a 500000 d\u00f3lares\n* Group 3: de 500001 a 1000000 d\u00f3lares\n* Group 4: acima de 1000001 d\u00f3lares","2813b953":"Com esses gr\u00e1ficos podemos observar as seguintes informa\u00e7\u00f5es:\n- O valor das resid\u00eancias tende a aumentar de acordo com o n\u00famero de quartos, por\u00e9m a partir de 6 quartos esse valor tende a cair, o que pode significar que o n\u00famero de quartos a partir de 6 n\u00e3o tem tanta influ\u00eancia no pre\u00e7o, o que confirma a informa\u00e7\u00e3o do matriz que correla\u00e7\u00e3o feita anteriormente;\n- O n\u00famero de banheiros tem influ\u00eancia positiva direta no pre\u00e7o das resid\u00eancias, apesar de haver muita dispers\u00e3o dos dados a partir de 5 banheiros. E de novo \u00e9 poss\u00edvel notar que esse n\u00famero de banheiros possui n\u00fameros _float_ , o que \u00e9 algo estranho. Provavelmente um erro na hora da coleta dos dados;\n- **sqft_living** tamb\u00e9m possui influ\u00eancia direta, apesar da grande dispers\u00e3o a partir 7000;\n- Como j\u00e1 visto, \"grade\" tamb\u00e9m tem influ\u00eancia positiva;\n- **sqft_above** e **sqft_living15** possuem influ\u00eancia positiva, apesar da ambos possuirem dispers\u00e3o a partir de 5000;","ed833272":"### Separando os anos de constru\u00e7\u00e3o em d\u00e9cadas","96cdc9b0":"### Valores nulos","fc47a133":"#### Floors","fe4a2bf9":"De in\u00edcio, o dataset n\u00e3o possui uma grande quantidade de vari\u00e1veis, por\u00e9m todas parecem ser \u00fateis, ent\u00e3o n\u00e3o precisarei fazer um PCA ou RFE mais tarde. Verei a influ\u00eancia das mesmas abaixo","de502212":"As resid\u00eancias com a seguinte descri\u00e7\u00e3o tendem a possuir melhores pre\u00e7os de vendas:\n* **Quantidade de quartos**: 4\n* **Quantidade de banheiros**: 3\n* **\u00c1rea habitacional**: at\u00e9 60000 p\u00e9s\u00b2\n* **Qualidade dos materiais**: 7 ou 8\n* **\u00c1rea acima do solo**: at\u00e9 60000 p\u00e9s\u00b2\n* **N\u00famero de andares**: 1 ou 2\n\nEnt\u00e3o, se uma resid\u00eancia adquirida possuir uma descri\u00e7\u00e3o abaixo dessa, uma reforma com essas mudan\u00e7as pode aumentar o pre\u00e7o de venda.","e52a4ef2":"# Respondendo \u00e0s perguntas","fa5b7e08":"Independente da qualidade de \"view\", as casas costumam ter pre\u00e7o de at\u00e9 4.000.000, sem contar com os _outliers_.","3ef914ae":"## Visualiza\u00e7\u00e3o pr\u00e9via","1e2325a8":"Agora irei visualizar melhor as colunas que possuem menos correla\u00e7\u00e3o com a vari\u00e1vel de pre\u00e7o.","86f9fd45":"A mediana das casas n\u00e3o variou muito em rela\u00e7\u00e3o \u00e0 \"condition\", por\u00e9m h\u00e1 muitos outliers, principalmente nos valores 3, 4 e 5. Verificarei melhor abaixo. J\u00e1 a vari\u00e1vel \"grade\" parece influenciar de maneira positiva o pre\u00e7o das casas. H\u00e1 diversos outliers, por\u00e9m a mediana do pre\u00e7o aumenta quanto melhor a qualidade dos materiais.","b63d4f8e":"Como dito, as colunas possuem forte correla\u00e7\u00e3o positiva, e isso nos diz por exemplo que quanto maior a quantidade de banheiro, maior o pre\u00e7o de venda. Irei analisar melhor essa rela\u00e7\u00e3o abaixo:","de4f5ba7":"De acordo com as an\u00e1lises feitas, o CEO deve considerar adquirir as resid\u00eancias pertencentes ao **grupo 2** (250 a 500 mil d\u00f3lares) e\/ou **grupo 3** (501 mil a 1 milh\u00e3o de d\u00f3lares), que tenham sido construidas a partir do **ano de 1991**. Tendo em vista a exist\u00eancia de  alguns fatores, como quantidade de c\u00f4modo e \u00e1rea habitacional (que ser\u00e3o melhor abordados na terceira pergunta), que incrementam os pre\u00e7os das resid\u00eancias, \u00e9 tamb\u00e9m recomend\u00e1vel a compra de **casas n\u00e3o reformadas**, com intuito de realizar uma reforma.","49730e54":"Apesar dos *outliers*, grande parte das resid\u00eancias costumam custar at\u00e9 4.000.000, independente do andar.","4a7fa610":"### Quais casas o CEO da *House Rocket* deveria comprar e por qual pre\u00e7o de compra?","c20df942":"H\u00e1 um desvio-padr\u00e3o muito elevado, algo que pode significar a presen\u00e7a de v\u00e1rios outliers. Al\u00e9m disse, \u00e9 poss\u00edvel notar a grande diferen\u00e7a entre a resid\u00eancia do Q1 (quartil 1) que custa **75.000** e a resid\u00eancia do Q3 (quartil 3) que custa **645.000**, sem falar do valor m\u00e1ximo de **7.700.000**."}}