{"cell_type":{"39a7402e":"code","2478410c":"code","91fa894e":"code","94962b95":"code","78870e7e":"code","938ce1fe":"code","dc6ac5e1":"code","3f0f88e6":"code","e093b911":"code","8b9b72ba":"code","15451f89":"code","0c1f26ed":"code","21dc4e0e":"code","a65d7fb4":"code","4b8c9304":"code","4edff7d4":"code","c0dfb3e5":"code","d558192c":"code","b33244b6":"code","898fd87b":"code","97958259":"code","a58a7065":"code","53e8ad0c":"code","7d9ef71b":"code","8e5edf66":"code","a8572eda":"code","10f1f7d8":"code","aa79ab0e":"code","284cc840":"code","0541e9dc":"code","758591ef":"code","afab5e92":"code","ec00fbba":"code","c44ed759":"code","0fd5a5a4":"code","13c11f8d":"code","25d1d3a5":"code","227cc473":"code","790aa943":"code","7a21a280":"code","39eef9a3":"code","60c1b2b9":"code","e58c696d":"code","9d63939b":"code","a6f3c7db":"code","7235c40c":"code","de71bd2d":"code","1b4ba5ca":"code","70ca55fb":"code","85c469e1":"code","e6e6e5b9":"code","82a0d8e3":"code","ac20340a":"code","57639283":"code","8d28a665":"code","21711271":"code","b71decec":"code","9f27a0df":"code","16ae2efc":"code","bf63323f":"code","2ca63c10":"code","b7c43863":"code","0dc490a3":"code","76e00fdc":"code","85e33499":"code","4d395f43":"markdown","71d294d1":"markdown","1a4c84ee":"markdown","2ac63e9a":"markdown","4e882786":"markdown","480cadb5":"markdown","bc2c5207":"markdown","d9803e2a":"markdown","8914a187":"markdown","15bc7457":"markdown","5a318be0":"markdown","199a258d":"markdown","43577923":"markdown","fc4a08c3":"markdown","5a39becd":"markdown","5934ada9":"markdown","33a75b0b":"markdown","d2a5ef5a":"markdown","e7712451":"markdown","d6cdb7b3":"markdown","5da3c248":"markdown","88da7891":"markdown","9a97a4d7":"markdown","d5ede6c7":"markdown","f46201a3":"markdown","ba7dbad2":"markdown","93d922de":"markdown","ad744f9d":"markdown","4047fa3b":"markdown"},"source":{"39a7402e":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n%matplotlib notebook\n\ndf = pd.read_csv('..\/input\/train.csv')","2478410c":"df[:10]","91fa894e":"\nlen(df)","94962b95":"df.duplicated().value_counts()","78870e7e":"df['PassengerId'].is_unique","938ce1fe":"survival = {0: 'Not Survived', 1: 'Survived'}\n\ndf['Survived'].value_counts()","dc6ac5e1":"prop_survived = df['Survived'].value_counts() \/ len(df)\n","3f0f88e6":"prop_survived = prop_survived.rename(survival)\nprint(prop_survived)\n\nprop_survived.plot(kind='bar', title='Survival rate')","e093b911":"gender_data = df['Sex']\n\ngender_data[:10]","8b9b72ba":"# We want to see whether we have NaN values for our genders\ngender_data.isna().value_counts()","15451f89":"prop_gender = gender_data.value_counts() \/ len(gender_data)","0c1f26ed":"print(prop_gender)","21dc4e0e":"male_female_survived = df.groupby(by=['Sex', 'Survived']).size().reset_index().rename(columns={0: 'Count'})\n\nmale_female_survived","a65d7fb4":"import seaborn as sns\n\nsns.barplot(x='Sex', y='Count', hue='Survived', data=male_female_survived).set_title('Survival rate by Gender')","4b8c9304":"# now we calculate the percentage\nprop_male_female_survived = male_female_survived.copy()\n\nprop_male_female_survived['Count'] = prop_male_female_survived['Count'] \/ prop_male_female_survived['Count'].sum()\nprop_male_female_survived.rename(columns={'Count': 'Percentage'}, inplace=True)\n\nprint(prop_male_female_survived)","4edff7d4":"male_survived = df[df['Sex'] == 'male']\n\nlen(male_survived)","c0dfb3e5":"male_survived['Survived'].value_counts().rename(survival).plot(kind='bar', title='Survival rate of Male Passengers')","d558192c":"prop_male_survive = male_survived['Survived'].value_counts().rename(survival) \/ len(male_survived)\nprop_male_survive","b33244b6":"female_survived = df[df['Sex'] == 'female']\n\nlen(female_survived)","898fd87b":"female_survived['Survived'].value_counts().rename(survival).plot(kind='bar', title='Survival rate of Female Passengers')","97958259":"prop_female_survive = female_survived['Survived'].value_counts().rename(survival) \/ len(female_survived)\nprop_female_survive","a58a7065":"# dividing into age groups\ndf['Age'].isna().value_counts()\n","53e8ad0c":"df['Age'].describe()","7d9ef71b":"from math import modf\n\n# We want the integer part of the mean to take for fillna()\n# We also will not change the df, so we will save it to df_modified\n\n# For now, we will assume they are all in the mean\n# Note: Include deviation part?\ndf_modified = df[['PassengerId', 'Survived', 'Sex', 'Age']].copy()\n\ndf_modified['Age'] = df_modified['Age'].fillna(modf(df['Age'][df['Age'].notna()].mean())[1])","8e5edf66":"df_modified[-10:]","a8572eda":"# 0 - [0 -15)\n# 1 - [15 - 25)\n# 2 - [25 - 40)\n# 3 - [40 - 65)\n# 4 - [65 - 81)\n\n# Age groups here are left_inclusive\n\n# NOTE: Check to do it with pd.Categorical type\n\nage_groups = {0: (0, 15), 1: (15, 25), 2: (25, 40), 3: (40, 65), 4: (65, 81)}\n\ndef which_age_group(x):\n    for key, age_group in age_groups.items():\n        if x >= age_group[0] and x < age_group[1]:\n            return key\n\ndf_modified['AgeGroup'] = df_modified['Age'].apply(which_age_group).astype('int64')","10f1f7d8":"df_modified[:10]","aa79ab0e":"print(df_modified.groupby('AgeGroup').size().rename(age_groups))\n\ndf_modified.groupby('AgeGroup').size().rename(age_groups).plot(kind='bar', title='Number of passengers by Age Group')","284cc840":"# looking at the whole population\n\nage_group_survive = df_modified.groupby(['AgeGroup', 'Survived']).size().reset_index().rename(columns={0: 'Count'})","0541e9dc":"# To get sense of which age group we are talking about, not looking at indices\n\nage_group_survive['AgeGroup'] = age_group_survive['AgeGroup'].apply(lambda x: age_groups[x])","758591ef":"age_group_survive","afab5e92":"age_group_survive['Survived'] = age_group_survive['Survived'].apply(lambda x: survival[x])","ec00fbba":"age_group_survive","c44ed759":"sns.barplot(x='AgeGroup', y='Count', hue='Survived', data=age_group_survive).set_title('Survival rate by Age Group')","0fd5a5a4":"age_group_by_sex = df_modified.groupby(['AgeGroup', 'Sex', 'Survived']).size().reset_index().rename(columns={0: 'Count'})","13c11f8d":"age_group_by_sex['AgeGroup'] = age_group_by_sex['AgeGroup'].apply(lambda x: age_groups[x])","25d1d3a5":"age_group_by_sex","227cc473":"age_group_by_sex['Survived'] = age_group_by_sex['Survived'].apply(lambda x: survival[x])","790aa943":"# NOTE: Check how to plot with combining two columns without the need to create new one\n\nage_group_by_sex['AgeGroupSex'] = age_group_by_sex['AgeGroup'].apply(lambda x: str(x)) + \" - \" + age_group_by_sex['Sex']","7a21a280":"age_group_by_sex","39eef9a3":"# plotting\n\na4_dims = (10, 9)\nfig, ax = plt.subplots(2, figsize=a4_dims)\n\nsurvival_by_age_group_males = sns.barplot(ax=ax[0],\n                                            x='AgeGroupSex',\n                                            y='Count',\n                                            hue='Survived',\n                                            data=age_group_by_sex[age_group_by_sex['Sex'] == 'male'])\n\nsurvival_by_age_group_males.set_title('Survival rate by sex and age group - males')\n\nsurvival_by_age_group_females = sns.barplot(ax=ax[1],\n                                            x='AgeGroupSex',\n                                            y='Count',\n                                            hue='Survived',\n                                            data=age_group_by_sex[age_group_by_sex['Sex'] == 'female'])\n\nsurvival_by_age_group_females.set_title('Survival rate by sex and age group - females')","60c1b2b9":"df.head()","e58c696d":"df['SibSp'].describe()","9d63939b":"df['SibSp'].value_counts()","a6f3c7db":"df_siblings = df[['PassengerId', 'Survived', 'Sex', 'SibSp', 'Age']].copy()","7235c40c":"df_siblings[:6]","de71bd2d":"df_siblings['SibSp'].notna().value_counts()","1b4ba5ca":"df_siblings['Age'] = df_siblings['Age'].fillna(modf(df['Age'][df['Age'].notna()].mean())[1])\ndf_siblings['AgeGroup'] = df_siblings['Age'].apply(which_age_group).astype('int64').apply(lambda x: age_groups[x])\ndf_siblings['HasSibSp'] = df_siblings['SibSp'].apply(lambda x: x > 0)","70ca55fb":"df_siblings[:6]","85c469e1":"df_siblings['HasSibSp'].value_counts()","e6e6e5b9":"# using the whole population\nhassib_survival_rate = df_siblings.groupby(['HasSibSp', 'Survived']).size().reset_index().rename(columns={0: 'Count'})","82a0d8e3":"hassib_survival_rate","ac20340a":"hassib_survival_rate['Survived'] = hassib_survival_rate['Survived'].apply(lambda x: survival[x])","57639283":"sns.barplot(x='HasSibSp', y='Count', hue='Survived', data=hassib_survival_rate).set_title('Survival rate by having siblings or spouse')","8d28a665":"passengers_with_siblings = df_siblings[df_siblings['HasSibSp']]\npassengers_with_no_siblings = df_siblings[df_siblings['HasSibSp'] == False]","21711271":"survival_rate_by_sex_and_sibsp = passengers_with_siblings.groupby(['Sex', 'Survived']).size().reset_index().rename(columns={0: 'Count'})\nsurvival_rate_by_sex_and_nosibsp = passengers_with_no_siblings.groupby(['Sex', 'Survived']).size().reset_index().rename(columns={0: 'Count'})","b71decec":"survival_rate_by_sex_and_sibsp","9f27a0df":"survival_rate_by_sex_and_nosibsp","16ae2efc":"survival_rate_by_sex_and_sibsp['Survived'] = survival_rate_by_sex_and_sibsp['Survived'].apply(lambda x: survival[x])\n\nsurvival_rate_by_sex_and_sibsp\n# siblings_gender_plot = sns.barplot(x='Sex', y='Count', hue='Survived', data=survival_rate_by_sex_and_sibsp)\n\n# siblings_gender_plot.set_title('Survival rate of having siblings by sex ')\n\n# siblings_gender_plot","bf63323f":"survival_rate_by_sex_and_nosibsp['Survived'] = survival_rate_by_sex_and_nosibsp['Survived'].apply(lambda x: survival[x])\n\nsurvival_rate_by_sex_and_nosibsp","2ca63c10":"fig, ax = plt.subplots(2, figsize=a4_dims)\n\nsurvival_has_sib = sns.barplot(ax=ax[0], x='Sex', y='Count', hue='Survived', data=survival_rate_by_sex_and_sibsp)\nsurvival_has_sib.set_title('Survival rate of having siblings by sex')\n\nsurvival_has_nosib = sns.barplot(ax=ax[1], x='Sex', y='Count', hue='Survived', data=survival_rate_by_sex_and_nosibsp)\nsurvival_has_nosib.set_title('Survival rate of not having siblings by sex')","b7c43863":"survival_rate_by_sex_and_sibsp['Count'] = survival_rate_by_sex_and_sibsp['Count'] \/ survival_rate_by_sex_and_sibsp['Count'].sum()","0dc490a3":"survival_rate_by_sex_and_nosibsp['Count'] = survival_rate_by_sex_and_nosibsp['Count'] \/ survival_rate_by_sex_and_nosibsp['Count'].sum()","76e00fdc":"survival_rate_by_sex_and_nosibsp","85e33499":"# NOTE: Research impact of sibling\/spouse on age groups\n\nsurvival_rate_by_sex_and_sibsp","4d395f43":"Further analysis and feature engineering required for sibling-spouses analytics. The goal is to test if there is any correlation to minimizing the chance of surviving if a passenger has a sibling or spouse.\n\nWe will describe the series to see what we're dealing with.","71d294d1":"We can see that the majority of population that have not survived during the Titanic sinking are males, which means that if a person is a male, according to the analysis, the chances of surviving is minimum.\n\nWe will test out how many males have survived, then the females.","1a4c84ee":"# Titanic: Machine Learning from Disaster\n\n**------(NOTE)---------**\n\n*This notebook is not yet finished, as I will update this kernel further*\n\n**---------------------**\n\nIn this notebook, we will explore the Titanic dataset where we want to find out what were the factors of survining and dying during ship sinking.\n\nWe will do the following steps (**step** - done step):\n\n0. **Retrieve the data**\n1. Explore the data\n2. Preprocess the data\n3. Model the data\n4. Train and test the model\n5. Evalutaion and presentation\n\nWe will cover all those steps using Python with its packages numpy, pandas, matplotlib and scikit-learn, maybe even use the PyTorch module later on.","2ac63e9a":"We don't see some drastic changes in comparison, as well, by looking at the siblings\/spouse, and with calculating percentages","4e882786":"We can see that there are a somewhat significant portion of passengers with no provided age, so we will calculate the mean of other ages. We also see that the age is not consistent, so we will try to group them in age groups, as specified before","480cadb5":"### Gender analysis\n\nWe want to see if the passengers are uniformly distributed or if there is some kind of correlation with the likelihood of surviving the accident. We will begin our research by seeking how many survivors do we, actually, have.","bc2c5207":"Now that we have filled the gaps in the missing age data, we will now add a new column that will add to the age group. We will define a function that will assign each passenger to it's age group. We have seen that the oldest passenger was 80 years old at the time, so that will make the last age group 65-81.","d9803e2a":"## TODO: Parents\/Child analytics","8914a187":"Now that we have assigned to each passenger it's AgeGroup, it is time to do some analytics and draw some conclusions. Let see how many have passengers we have for each age group.","15bc7457":"As we can see, we have around 61% who died during the Titanic sinking and around 38% survivors in our dataset.\n\nOur next step in our analytics is to measure the proportion of male and female passangers.","5a318be0":"### Sibling - spouses analysis","199a258d":"As suspected, tipically it will have 1 or 2, with small portion of them having more.\n\nWe can use the feature engineering again to convert the SibSp into a boolean, since a small portion of them would not make a significant change in the model.","43577923":"It is remarkably similar to the normal distribution of age groups in the population of given passengers. Let's see how many have survived for each age group and calculate their percentages.","fc4a08c3":"We can see that there are no drastic changes in comparison. We need to prove that having a sibling will not change the outcome of survival. We will check for sibling\/spouse for male and female from the sample of population who had siblings or spouse.","5a39becd":"## Step 1: Explore the data\n\nWe will do some explorations, analytics and describe some events regarding this dataset. We will go now column by column, describing the data in the proces. First, we want to see how many survivors do we have in the dataset.\n\nWe will do the following analysis of how much impact next columns has on survival rate of passengers:\n\n- Gender\n- Age group\n- Siblings\/Spouse\n- Parents\/Children\n- PClass\n- Fare\n- Cabin\n\nI believe that Name and Ticket are columns that have no impact on survival rate of each passenger. I don't think that certains names don't raise or lowers the chances of surviving a disaster, as well as tickets, since they are, in some ways, another ways of identification. Also, the Port of Embarkation also doesn't have an impact, since I believe that the location where passengers have entered the ship don't have that much significance. Even if we can find the correlation, for example, people who ported in Queenstown have higher chances of surviving, but that doesn't guarantee us for the next ship how will it behave. Instead, we want to analyze the traits of human being and its behaviour and location in the ship: How old is the passenger, does he\/she have siblings, parents, children, where is he\/she located in the ship, what gender is the passenger, cabin location and more.\n\nOf course, every next analytics will combine with previous, if needed, for further proving hypothesis'. I will list all analytics in this section and I will provide explanations why I will include or not include certain columns in modeling the data for predicting survival rate of passengers.\n\nFor now, I have decided on next columns that will go in the preprocessing and modeling part of the project:\n\n- Sex\n- Age (engineered in age group)","5934ada9":"As we can see, there are no duplicate rows nor duplicate PassengerId, which means that each row is unique on its own and we don't need to disregard any data. We will test for each column if we don't have any data regarding to it in the next step.","33a75b0b":"Now that we have the columns HasSibSp, we can see now how many casualties were there regarding the siblings.","d2a5ef5a":"## Step 0: Retrieve the data and load\n\nWe will retrieve Titanic Dataset from the Kaggle website https:\/\/www.kaggle.com\/c\/titanic, where we will use the simple API provided by the Kaggle that we will retrieve and read the data.\n\nAssuming we have downloaded the necessary data, it is time to load the data into the pandas dataframe. We will also include the packages right away that are needed for data exploration step.","e7712451":"We see that, if someone has a sibling or spouse, it will have tipically 1 or 2, let's see if we can count how many of them we have.","d6cdb7b3":"Now that we have loaded the data, we will print the first 10 rows of data to see what we're dealing with. Also, we will test if there are any duplicate rows in the data.","5da3c248":"We have around 64% male and around 35% female passengers. Now we want to find out how many males and how many females survived in the sinking of Titanic.","88da7891":"### Age group analysis\n\nAs we have seen, the gender plays a big role of determining the chance of surviving favouring female passengers.\n\nWe will divide age groups with the following:\n0. minimum_age - 14\n1. 15 - 24\n2. 25 - 40\n3. 41 - 65\n4. 65 - max_age\n\nNot every passenger has an age provided, so we will calculate how many passengers do not have the age provided.","9a97a4d7":"In contrast, looking at the females, we have just under 75% female passengers that have survived the disaster, meaning that the sex plays a significant role whether a passenger will survive or not.","d5ede6c7":"We will also use the feature engineering for the age group we have done before, so that we can provide further analysis on the relation siblings\/spouse with the certain age group and certain gender.\n\nAlso, the column SibSp has no NaN values, so we don't need to do any missing data procedures.","f46201a3":"There are no strong impacts of having a sibling. I believe that because there were no more casualties in the has_siblings dataframe, the proportion of them both would tend to some constant *k*, so in the final model, we won't include the sibling\/spouse part (bias posibility, unlikely I believe).\n\nNext, we will do parent\/child part of analytics. I believe it will have much more impact than sibling\/spouse part.","ba7dbad2":"Now we can see, looking only at the males, that we have over 80% casualties. Let's look at the female passengers.","93d922de":"We can conclude here that age group also plays a role on providing a chance of survival to certain groups of people. That means that age group as category can tell us more about the significance of surviving.\n\nWe can conclude that mostly the children and females were saved, further proving the significant role a gender has on survival rate.","ad744f9d":"We can see that there were a lot of casualties in every age group except the children age group (0, 15), which is not surprising. We will extend these analytics by providing the sex as a key.\n\nFirst, we will see how many passengers of different sex do we have in each age group","4047fa3b":"Let's normalize the input and calculate the proportion of those passengers who died and who survived."}}