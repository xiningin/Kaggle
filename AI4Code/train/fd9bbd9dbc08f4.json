{"cell_type":{"17196063":"code","b788c118":"code","e3fbbfa0":"code","5fd9b5a6":"code","8e9c77d7":"code","8f251d83":"code","903d05f6":"code","c9037d56":"code","51c17ef0":"code","a47539ab":"code","98e2003e":"code","dd936980":"code","b9b26e90":"code","b436847a":"code","cbcec8e9":"code","c2e71aba":"markdown","3b954417":"markdown","087658c6":"markdown","b48b13cc":"markdown","994973a7":"markdown","c3da85bf":"markdown","54f11a1e":"markdown","51e774b7":"markdown","faa25186":"markdown","c9c9cd73":"markdown"},"source":{"17196063":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","b788c118":"data= pd.read_csv('\/kaggle\/input\/creditcardfraud\/creditcard.csv')\ndata.head()","e3fbbfa0":"data.info()","5fd9b5a6":"plt.figure(figsize=(12,8))\n\ntotal = float(len(data[\"Class\"]) )\nax = sns.countplot(x=\"Class\", data=data)\nfor p in ax.patches:\n    height = p.get_height()\n    ax.text(p.get_x()+p.get_width()\/2.,\n            height + 3,\n            '{:1.2f}'.format((height\/total)*100),\n            ha=\"center\") \nplt.title('Creditcard Fraud \\n 0=non-fraud || 1=fraud',color='black',fontsize=15)\nplt.show()","8e9c77d7":"sns.distplot(data['Amount'],color='g')\nplt.title('Distribution of transaction amount',fontsize=10)\nplt.show()","8f251d83":"sns.distplot(data['Time'],color='b')\nplt.title('Distribution of transaction Time',fontsize=10)\nplt.show()","903d05f6":"correlation=data.drop(['Amount','Time','Class'],axis=1)","c9037d56":"sns.heatmap(correlation.corr(),cmap='PuBu')","51c17ef0":"from sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestClassifier","a47539ab":"X=data.drop(['Class'],axis=1)\nY=data['Class']","98e2003e":"Xtrain,Xtest,Ytrain,Ytest=train_test_split(X,Y,test_size=0.3,random_state=30)","dd936980":"classifier = RandomForestClassifier(n_estimators = 100, criterion = 'entropy', random_state = 42,\n                                   max_features = 'auto', max_depth = 10)\nclassifier.fit(Xtrain, Ytrain)","b9b26e90":"tmp = pd.DataFrame({'Feature': X, 'Feature importance': classifier.feature_importances_})\ntmp = tmp.sort_values(by='Feature importance',ascending=False)\nplt.figure(figsize = (7,4))\nplt.title('Features importance',fontsize=14)\ns = sns.barplot(x='Feature',y='Feature importance',data=tmp)\ns.set_xticklabels(s.get_xticklabels(),rotation=90)\nplt.show() ","b436847a":"from sklearn.metrics import confusion_matrix\npredicted = classifier.predict(Xtest)\npredicted_proba = classifier.predict_proba(Xtest)\n\nmatrix = confusion_matrix(Ytest, predicted)\n\nprint(matrix)","cbcec8e9":"from sklearn.metrics import accuracy_score, make_scorer\nclassifier.fit(Xtrain, Ytrain)\npredictions = classifier.predict(Xtest)\naccuracy_score(y_true = Ytest, y_pred = predictions)","c2e71aba":"To predict my model using a random forest method.","3b954417":"# 2.Data Exploration","087658c6":"# 3. Modelling","b48b13cc":"We will use as train criterion Entropy, number of random state is set to 42,number of max depth is set to 10, number of estimators is set to 100, max features is set to auto.then visualize the features importance with the model that we have made.","994973a7":"From above the data there aren\u2019t missing\ndata (non-null).\n\nnow, we want to see if this data\nunbalance or not.","c3da85bf":"The result of confusion matrix above by building the accuracy level in the model is 99,95%. Our advice is to improve credit card control, among others by increasing the level of concern in lending to customers, including having to optimize the most influential variables to overcome credit card fraud.","54f11a1e":"**Note that the data is not balanced! Most transactions are non-fraudulent with a percentage of 99.83%. If we use this data framework as a basis for our prediction and analysis models, we might get a lot of errors and our algorithm might be too many because I want our model to detect patterns that show signs of fraud!**","51e774b7":"# 1. **DATA OVERVIEW**","faa25186":"The most important features are V1,V4,V7,V0,V6,V3 for Creditcard Fraud.","c9c9cd73":"EDA which we will do first is identify the type of each attribute. There are several types of attributes on the data we\nuse are :"}}