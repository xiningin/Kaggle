{"cell_type":{"b06d48ea":"code","dd35df6b":"code","a7c2e84c":"code","a9433a11":"code","da63e2ab":"code","44cc0570":"code","b93abf13":"code","905e3065":"code","f33feca3":"code","c767e3be":"code","05ad930d":"markdown","c4ad6dad":"markdown","58758b91":"markdown","5dc428f7":"markdown","38ad05c6":"markdown","fa0095bb":"markdown","8ea75645":"markdown"},"source":{"b06d48ea":"import numpy as np\nimport pandas as pd \nimport cv2\nimport seaborn as sns\n\nfrom matplotlib import pyplot as plt\n%matplotlib inline\n\n## load two csv files\ndf = pd.read_csv('..\/input\/tuning_labels.csv', header=None, \n                 names=['img_id', 'labels'])\ndescription = pd.read_csv('..\/input\/class-descriptions.csv')\n\n## make a dictionary file\nd={}\nfor i,j in zip(description.label_code.values, description.description.values):\n    d[i]=j","dd35df6b":"count = pd.DataFrame(df['labels'].str.split().apply(lambda x:len(x)))\nsns.countplot(data=count,x='labels')\nplt.title('number of labels')","a7c2e84c":"temp = df[count['labels']>6]\nlist = ['..\/input\/stage_1_test_images\/{}.jpg'.format(img_id) for img_id in temp.img_id.values]\nax=plt.figure(figsize=(12,12))\nfor num,i in enumerate(temp['labels'].apply(lambda x: x.split()).values):\n    plt.subplot(3,2,2*num+1)\n    plt.axis('off')\n    filename = list[num]\n    img = cv2.imread(filename)\n    plt.imshow(img)\n    names = [d[j] for j in i]\n    for n,i in enumerate(names):\n        plt.text(1500,10+n*100,i,fontsize=14,horizontalalignment='right')","a9433a11":"## create a function called \"plot_images\"\ndef plot_images(num_label,max=60):\n    temp = df[count['labels']==num_label]\n    print(len(temp))\n    if len(temp) > 60:\n        temp = temp[:60]\n    list = ['..\/input\/stage_1_test_images\/{}.jpg'.format(img_id) for img_id in temp.img_id.values]\n    ax=plt.figure(figsize=(12,60))\n    for num,i in enumerate(temp['labels'].apply(lambda x: x.split()).values):\n        filename = list[num]\n        img = cv2.imread(filename)\n        img = cv2.resize(img, dsize=(1024, 600), interpolation=cv2.INTER_CUBIC)\n        plt.subplot(30,4,2*num+1)\n        plt.axis('off')\n        plt.imshow(img)\n        names = [d[j] for j in i]\n        for n,i in enumerate(names):\n            plt.text(1500,10+n*100,i,fontsize=10,horizontalalignment='left')","da63e2ab":"plot_images(6)","44cc0570":"plot_images(5)","b93abf13":"plot_images(4)","905e3065":"plot_images(3)","f33feca3":"plot_images(2)","c767e3be":"plot_images(1)","05ad930d":"## Images with only one label!","c4ad6dad":"## Images with 4 labels","58758b91":"> ## Images with more than 6 labels","5dc428f7":"## Images with 5 labels","38ad05c6":"## Images with 2 labels","fa0095bb":"## Images with 6 labels","8ea75645":"## Images with 3 labels"}}