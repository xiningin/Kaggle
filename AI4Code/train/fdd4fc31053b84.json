{"cell_type":{"d03bd8f4":"code","4c5a0f79":"code","6ae58dc6":"code","024e1754":"code","fc571d63":"code","8a521108":"code","b0e7f949":"code","2c3f378c":"code","a65c41fc":"code","094dcc52":"code","0c503e14":"code","5666b0af":"code","7baeb48f":"code","2612f028":"code","84206d0b":"code","16bbc175":"code","3a4bf720":"code","2b0bb2b1":"code","d8c256ac":"code","633e3393":"code","9ef4c5c0":"code","6e0e2dc8":"markdown"},"source":{"d03bd8f4":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","4c5a0f79":"%reload_ext autoreload\n%autoreload 2\n%matplotlib inline","6ae58dc6":"from fastai.vision import *\nfrom fastai.metrics import error_rate","024e1754":"bs = 64","fc571d63":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport os\nprint(os.listdir('..\/input\/fruits-360_dataset\/fruits-360'))","8a521108":"data_dir='..\/input\/fruits-360_dataset\/fruits-360'\n\nlist = os.listdir(data_dir) \nnumber_files = len(list)\nprint(number_files)","b0e7f949":"path=Path(data_dir)\npath","2c3f378c":"data = ImageDataBunch.from_folder(path,  \n                                  valid_pct=0.2,\n                                  ds_tfms=get_transforms(do_flip=True,flip_vert=False, max_rotate=90),\n                                  size=224,bs=64, \n                                  num_workers=0).normalize(imagenet_stats)","a65c41fc":"data.show_batch(rows=3, figsize=(10,10))","094dcc52":"print(data.classes)\nlen(data.classes)","0c503e14":"learn = create_cnn(data, models.resnet34, metrics=accuracy, model_dir=\"\/tmp\/model\/\")","5666b0af":"learn.model","7baeb48f":"learn.fit_one_cycle(3)","2612f028":"learn.save('stage-1')","84206d0b":"interp = ClassificationInterpretation.from_learner(learn)\n\nlosses,idxs = interp.top_losses()\n\nlen(data.valid_ds)==len(losses)==len(idxs)","16bbc175":"interp.plot_top_losses(9, figsize=(30,25))","3a4bf720":"interp.most_confused(min_val=1)","2b0bb2b1":"learn.unfreeze()","d8c256ac":"learn.fit_one_cycle(3)","633e3393":"learn.lr_find()","9ef4c5c0":"learn.recorder.plot()","6e0e2dc8":"#Inspired by fast.ai Practical Deep Learning for Coders(v3) lession 1"}}