{"cell_type":{"87cd2026":"code","6fa68b02":"code","8d77695a":"code","f0aea655":"code","88cc4686":"code","adea1310":"code","5906a986":"code","107572e0":"code","3e448c6a":"code","7993781a":"code","f35018f4":"code","dabe5a63":"code","58bd54f0":"code","b5cd4d85":"code","5fe37cf1":"code","80b86f1e":"code","ba328425":"code","e46f8c8c":"code","c5ff5066":"code","a47fb7c8":"code","8fd82e9a":"code","50bb39f4":"code","e309dbc2":"code","c7e9befd":"code","c2042b37":"code","23080a68":"code","46264877":"code","fbd0ea15":"code","d58b2384":"markdown","73bceb9e":"markdown","18f24d35":"markdown","194dd126":"markdown","e85e19c5":"markdown","18db7024":"markdown","fb272de6":"markdown","cb468179":"markdown","775cdb1d":"markdown","256863ed":"markdown","4fde68d0":"markdown","72ef40de":"markdown","6bd0c30a":"markdown","92689083":"markdown"},"source":{"87cd2026":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","6fa68b02":"## Read the Beneficiary Summary Files\nb1 = pd.read_csv(r'\/kaggle\/input\/cms-synthetic-data\/DE1_0_2008_Beneficiary_Summary_File_Sample_1.csv', low_memory=False)\nb2 = pd.read_csv(r'\/kaggle\/input\/cms-synthetic-data\/DE1_0_2009_Beneficiary_Summary_File_Sample_1.csv', low_memory=False)\nb3 = pd.read_csv(r'\/kaggle\/input\/cms-synthetic-data\/DE1_0_2010_Beneficiary_Summary_File_Sample_1.csv', low_memory=False)\n# collate the three files\nb = b1.append(b2)\nben = b.append(b3)\nben\n## Read the inpatient claims file\ninp_claims = pd.read_csv(r'\/kaggle\/input\/cms-synthetic-data\/DE1_0_2008_to_2010_Inpatient_Claims_Sample_1.csv')\n## Read the outpatient claims file\nout_claims = pd.read_csv(r'\/kaggle\/input\/cms-synthetic-data\/DE1_0_2008_to_2010_Outpatient_Claims_Sample_1.csv', low_memory=False)","8d77695a":"inp_claims['admit_date'] = pd.to_datetime(inp_claims['CLM_ADMSN_DT'],format='%Y%m%d')\ninp_claims['discha_date'] = pd.to_datetime(inp_claims['NCH_BENE_DSCHRG_DT'],format='%Y%m%d')","f0aea655":"ben = ben.astype(\n    {'SP_DEPRESSN': 'category',\n     'SP_DIABETES':'category',\n     'SP_ISCHMCHT':'category'}\n)","88cc4686":"inp_claims['adm_duration'] = (inp_claims['discha_date'] - inp_claims['admit_date']).dt.days","adea1310":"alive = ben[ben['BENE_DEATH_DT'].isnull()]\ndead = ben[ben['BENE_DEATH_DT'].notnull()]","5906a986":"inp_claims['adm_duration'].min()","107572e0":"(inp_claims['adm_duration'] > 5).value_counts()","3e448c6a":"inp_claims[inp_claims['adm_duration'] > 5]","7993781a":"inp_claims['DESYNPUF_ID'].value_counts()","f35018f4":"inp_claims['DESYNPUF_ID'].value_counts() > 3","dabe5a63":"inp_claims['CLM_PMT_AMT'].mean()","58bd54f0":"(inp_claims['CLM_PMT_AMT']<0).value_counts()","b5cd4d85":"inp_claims[inp_claims['CLM_PMT_AMT']<0]","5fe37cf1":"_mean = inp_claims['CLM_PMT_AMT'].mean()\n\ninp_claims[inp_claims['CLM_PMT_AMT'] > _mean]","80b86f1e":"inp_claims.info()","ba328425":"inp_claims[inp_claims['ADMTNG_ICD9_DGNS_CD']=='78650']['CLM_PMT_AMT'].mean()","e46f8c8c":"inp_claims[inp_claims['ADMTNG_ICD9_DGNS_CD']=='78605']['CLM_PMT_AMT'].mean()","c5ff5066":"print(f\"chest pain(count): {inp_claims[inp_claims['ADMTNG_ICD9_DGNS_CD']=='78650']['CLM_PMT_AMT'].count()}\")\nprint(f\"shortness of breath(count): {inp_claims[inp_claims['ADMTNG_ICD9_DGNS_CD']=='78605']['CLM_PMT_AMT'].count()}\")","a47fb7c8":"inp_claims['CLM_DRG_CD'].value_counts()","8fd82e9a":"#number of claims for each DRG code\n\ninp_claims.groupby('CLM_DRG_CD')['CLM_ID'].count()","50bb39f4":"#what is the average claim pmt amt for each DRG code\n\n(inp_claims.groupby('CLM_DRG_CD')['CLM_PMT_AMT'].max()).mean()\n","e309dbc2":"ben.info()","c7e9befd":"# prevalence of chronic conditions across race\n# prevalence of chronic conditions across gender\n# count of people with specific chronic conditions","c2042b37":"ben.agg(\n    {'SP_DEPRESSN':'value_counts',\n     'SP_DIABETES':'value_counts',\n     'SP_ISCHMCHT':'value_counts',\n     'SP_OSTEOPRS':'value_counts',\n     'SP_ALZHDMTA':'value_counts',\n    }\n    \n)","23080a68":"# count of patients with co-morbidities\n\n# all\n\n# diabetes and depression\n\n# which are the most prevalent co-morbidities","46264877":"# what is the count of each chronic disease by state\n\nben.groupby('SP_STATE_CODE').agg(\n    {'SP_DEPRESSN':'value_counts',\n     'SP_DIABETES':'value_counts',\n     'SP_ISCHMCHT':'value_counts',\n     'SP_OSTEOPRS':'value_counts',\n     'SP_ALZHDMTA':'value_counts',\n    }\n    \n)","fbd0ea15":"#ben.groupby('SP_STATE_CODE')[]\n\nben[(ben['SP_DEPRESSN']==1)&(ben['SP_DIABETES']==1)].groupby('SP_STATE_CODE')['MEDREIMB_IP'].mean()","d58b2384":"**Adding useful columns for further analysis**","73bceb9e":"# **Summarizing DataFrames: df.groupby()**\n\n* inp_claims: group by - ADMTNG_ICD9_DGNS_CD, adm_duration, PRVDR_NUM, CLM_DRG_CD?\n* ben: group by - BENE_SEX_IDENT_CD, BENE_RACE_CD, SP_STATE_CODE, ","18f24d35":"# **Explore claim payments**\n\n* mean()\n* min()\n* max()","194dd126":"# **Pre-processing:** \n\n**Change to appropriate Date Datatype**","e85e19c5":"**List of all claims that have payment amount greater than the mean\/average**","18db7024":"# **Explore inpatient visit count**","fb272de6":"# **Explore admission duration**","cb468179":"**Change a few features to categories**","775cdb1d":"**What is the mean admission duration?**","256863ed":"if patients admitted with chest pain (78650) have an average claim payment amount higher\/lower than patients admitted with shortness of breath (78605)","4fde68d0":"**Split beneficiaries DF into dead and alive beneficiaries**","72ef40de":"# **Read the Files**","6bd0c30a":"**Find all beneficiaries with more than 3 visits**","92689083":"**Find all the patients with duration of stay greater than 5**"}}