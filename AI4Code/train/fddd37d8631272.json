{"cell_type":{"89cf6cd7":"code","3a4b2f90":"code","29addca9":"code","956f9f5f":"code","e3f3a2a1":"code","65a5ec1a":"code","52fe66ae":"code","0c1005ef":"code","7d6a3b3f":"code","0bb6eb88":"code","59f768fb":"code","f740848d":"code","d1e40028":"code","01794339":"code","c4c29e8b":"code","3c39cec8":"code","6a175514":"code","30106863":"code","ea4f6c02":"code","a2ae752e":"code","3618672b":"code","9a693f97":"code","2765afcd":"code","47c675b6":"markdown","d45ddca8":"markdown","6f80723c":"markdown","3a2805b8":"markdown","4b3a831a":"markdown","7816e9cd":"markdown","703dcd42":"markdown","0d603170":"markdown","d21c598e":"markdown"},"source":{"89cf6cd7":"# import the libraries\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.tree import DecisionTreeClassifier, export_graphviz\nfrom sklearn import tree\nfrom sklearn.preprocessing import StandardScaler, LabelEncoder\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score, confusion_matrix, plot_confusion_matrix","3a4b2f90":"# import the data\ndf = pd.read_csv('..\/input\/suv-data\/suv_data.csv')\ndf","29addca9":"df.shape","956f9f5f":"df.isnull().sum()","e3f3a2a1":"df.info()","65a5ec1a":"df.drop(['User ID'], axis=1, inplace = True)","52fe66ae":"le = LabelEncoder()","0c1005ef":"df['Gender'] = le.fit_transform(df['Gender'])","7d6a3b3f":"sc = StandardScaler()","0bb6eb88":"df.iloc[:,:3]  = sc.fit_transform(df.iloc[:,:3])\ndf.iloc[:,:3]","59f768fb":"X = df.drop(['Purchased'], axis=1)\nX","f740848d":"Y = df['Purchased']\nY","d1e40028":"train_x, test_x, train_y, test_y = train_test_split(X, Y, test_size = 0.3, random_state=99)","01794339":"train_x.shape, test_x.shape, train_y.shape, test_y.shape","c4c29e8b":"dt = DecisionTreeClassifier()","3c39cec8":"dt.fit(train_x, train_y)","6a175514":"features = pd.DataFrame({'Features' : train_x.columns, 'Importance' : dt.feature_importances_})\nfeatures.sort_values('Importance', ascending=False)","30106863":"y_pred  = dt.predict(test_x)\ny_pred","ea4f6c02":"dt.score(test_x, test_y)","a2ae752e":"results = pd.DataFrame({'Actual' : test_y, 'Predicted' : y_pred})\nresults","3618672b":"accuracy_score(test_y, y_pred)","9a693f97":"plot_confusion_matrix(dt, test_x, test_y)","2765afcd":"plt.figure(figsize=(28,20))\n\ntree.plot_tree(dt, feature_names=train_x.columns, class_names=['0','1'], filled=True, rounded=True, fontsize=12)","47c675b6":"We will also visualize how our decision tree works","d45ddca8":"Now we will train our model.","6f80723c":"Now we will divide the features into dependent and independent features.","3a2805b8":"Now we will divide our data into training and testing data.","4b3a831a":"We will check the importance of the features.","7816e9cd":"we can see that the gender column is categorical in nature,we will convert the same into numerical column, also we do not want the User ID column as we can observe that it is not of much importance. So we will drop the column.","703dcd42":"We can see that the Gender features is not of much importance, we can choose to drop it or keep it, i will keep it as of now.","0d603170":"We have values of varying length in our column, so we will scale the values so that our model performs better.","d21c598e":"We can see that there are no null values in our dataset."}}