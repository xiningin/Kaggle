{"cell_type":{"3957b7e2":"code","20c94e0b":"code","cd237e7f":"code","1245eebb":"code","2ff03360":"code","9c9d88f6":"code","f64b7af3":"code","fd30c76d":"code","f185d6bf":"code","d4e84df3":"code","62023983":"code","abd56999":"code","a58f679d":"code","b0c834ad":"code","ed0e3826":"code","5111bfce":"markdown","4a1a3a3e":"markdown","53590414":"markdown","4be18d9e":"markdown","a1d5322c":"markdown","e6627c25":"markdown","ddb5fee4":"markdown","2e843bda":"markdown","e26db49d":"markdown","308f62ce":"markdown","48cb2b2e":"markdown","61877847":"markdown","3b75131d":"markdown","55759a0d":"markdown","8bf9b867":"markdown","23f53084":"markdown","1b1e48f5":"markdown","8789ea5b":"markdown"},"source":{"3957b7e2":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nplt.style.use('seaborn-whitegrid')\n\n%matplotlib inline","20c94e0b":"df = pd.read_csv('..\/input\/FAO.csv', encoding = \"ISO-8859-1\")\n\ndf.head(5)","cd237e7f":"new_names = {'Venezuela (Bolivarian Republic of)': 'Venezuela',\n             'Bolivia (Plurinational State of)' : 'Bolivia'}\ndf.replace({'Area' : new_names}, inplace=True)\n\ncountries = ['Brazil', 'Colombia', 'Argentina', \n             'Peru', 'Venezuela', 'Chile',\n             'Ecuador', 'Bolivia', 'Paraguay', \n             'Uruguay', 'Guyana', 'Suriname']\ndf = df[df['Area'].isin(countries)]\n\ncols = ['Area', 'Item', 'Element', \n        'Y2000','Y2001','Y2002', \n        'Y2003', 'Y2004', 'Y2005', \n        'Y2006', 'Y2007', 'Y2008', \n        'Y2009', 'Y2010', 'Y2011', \n        'Y2012', 'Y2013']\ndf = df[cols]\n\n\ndf.columns = df.columns.str.replace(r'(Y)(\\d{4})', r'\\2') # Reformat column names for years: Y2001->2001\n\ndf['Sum 2000-2013'] = df.loc[:, '2000':'2013'].sum(axis=1)\n\ndf.head(5)","1245eebb":"prod = df.groupby('Area')['Sum 2000-2013'].sum().astype(int)\nprod.sort_values(ascending=False, inplace=True)\n\nprod","2ff03360":"colors = ['#a6cee3', '#1f78b4', '#b2df8a',\n          '#33a02c', '#fb9a99', '#e31a1c',\n          '#fdbf6f', '#ff7f00', '#cab2d6',\n          '#6a3d9a', '#ffff99', '#b15928']","9c9d88f6":"ax = prod.sort_values().plot.barh(figsize=(10,7), fontsize=14,                  \n                   title='Food production in South American in 2000-2013',\n                   color=colors[::-1])\n\nax.set_xlabel('Food and feed produced (in 1000 tonnes)', fontsize=12)\nax.set_ylabel('Country', fontsize=12)\nax.title.set_size(20)\n\n# write the value next to the bar\nfor x, y in zip(np.arange(len(prod)), prod.sort_values().values):\n    plt.text(y+400000, x, str(y), fontsize=12,\n            horizontalalignment='center')\n\n\nplt.show()","f64b7af3":"years = [str(year) for year in range(2000, 2014)]\n\nannual = df.groupby('Area').sum()\nannual.sort_values(by='Sum 2000-2013', ascending=False, inplace=True)\nannual = annual[years]\nannual","fd30c76d":"from cycler import cycler\n\n# building two sets of colors to keep the coloring of countries consistent between the 2 plots.\ncycle1 = cycler('color', colors)\ncycle2 = cycler('color', colors[1:]) # \n\nfig, ((ax1, ax2)) = plt.subplots(1, 2, figsize=(16,6))\n\nax1.set(xlim = (0, 13),\n        ylabel='Food production in tonnes',\n        prop_cycle= cycle1)\nax2.set(xlim = (0, 13),\n        ylabel='Food production in tonnes',\n        prop_cycle= cycle2)\n\nax1.set_title('Annual food production of South American countries in 2000-2013', fontsize= 14)\nax2.set_title('Annual food production of South American countries (w\/o Brazil) in 2000-2013', fontsize= 14)\n\nax1.plot(annual.T)\nax2.plot(annual.iloc[1:].T)\n\nax1.legend(annual.index, ncol=2, loc=5)\n\n\nplt.show()","f185d6bf":"fig, ax = plt.subplots(figsize=(10, 8))\n\nax = sns.heatmap(annual.T.corr())\n\nax.set_title('Correlation of food production growth', fontsize=18)\n\nax.set_xlabel('')\nax.set_ylabel('')\n\nplt.show()","d4e84df3":"feed = df.groupby(['Area','Element']).agg({'Sum 2000-2013': 'sum'}).unstack(level=1)['Sum 2000-2013']\n\nfeed = feed.div(feed.sum(axis=1), axis=0).multiply(100).round(0).astype(int) # convert values to percentage\n\nfeed.sort_values(by='Feed', inplace=True)\n\nfeed","62023983":"ind = np.arange(len(feed))\n\nfig = plt.figure(figsize=(10,6))\n\np1 = plt.bar(ind,feed['Feed'], color='r')\np2 = plt.bar(ind, feed['Food'], bottom=feed['Feed'], color='b')\n\nplt.ylabel('Feed and food production (%)', fontsize=12)\nplt.xticks(ind, feed.index, rotation=60, fontsize=11)\nplt.title('Food vs feed', fontsize=18)\nplt.legend(['Feed', 'Food'], fontsize=12,\n          bbox_to_anchor=(0., 1.02, 1.2, -.1))\n\nplt.show()","abd56999":"items = df.groupby(['Area','Item']).sum().unstack(level=1)\nitems = items[['2013']]\nitems.fillna(0, inplace=True)\nitems = items.astype(int)\n\nnitems = items[items.columns].gt(0).sum(axis=1)\nnitems.sort_values(ascending=False, inplace=True)\nnitems","a58f679d":"ind = np.arange(len(nitems))\n\nfig = plt.figure(figsize=(10,6))\nplt.bar(ind, nitems, width=0.35, color='r')\n\nplt.xticks(ind, nitems.index, rotation=60, fontsize=12)\nplt.ylabel('# of food items', fontsize=12)\nplt.ylim((40,100))\nplt.title('Food items produced by South American countries', fontsize=18)\n\nfor x, y in zip(ind, nitems.values):\n    plt.text(x, y+1, str(y), fontsize=12,\n            horizontalalignment='center')\n\n\nplt.show()","b0c834ad":"top5 = items.copy().T\ntop5.reset_index(level=0, drop=True, inplace=True)\n\n# convert values to percentage\ntop5 = top5.div(top5.sum(axis=0), axis=1).multiply(100).round(2)\n\n# convert the cells that are not in a country's top 5 to zero\nfor col in top5.columns:\n    top = top5[col].nlargest(5)\n    top5[col][~top5.index.isin(top.index)] = 0\n\n# delete rows with only zeroes\ntop5 = top5.loc[(top5 != 0).any(axis=1), :]\ntop5.sort_values(by='Brazil', ascending=False, inplace=True)\ntop5 = top5.T\n\ntop5","ed0e3826":"\ntop5.plot(kind='bar', stacked=True, \n               color=colors, figsize=(10,6))\nplt.ylabel(\"Food produced (in %)\", fontsize=12)\nplt.xticks(fontsize=12)\nplt.title('Top 5 food items produced by South American countries', fontsize=18)\nplt.ylim(0,60)\n\nplt.legend(bbox_to_anchor=(0., 0.72, 1.4, .1), fontsize=12)\n\n\nplt.show()","5111bfce":"## Countrywise production","4a1a3a3e":"We are only interested in looking at the data for the 12 South American states from 2000 to 2013.","53590414":"Let's now visualize this data on a horizontal bar plot.","4be18d9e":"There seems to be one country, Paraguay, that doesn't follow the general trend. While all the countries experienced a considerable or modest growth between 2004 and 2013, Paraguay experienced a production loss.","a1d5322c":"The next thing to explore is the proportion of feed in the overall food production countrywise.","e6627c25":"## Food vs. feed","ddb5fee4":"A total of 12 food items are found among the top 5 lists of the South American countries.\n\nAll countries have in common the presence of cereals and milk in their top 5 with the exception of Paraguay that doesn't include milk. Another special thing about Paraguay is that cassava, absent from the other countries' top 5, represents about 15% of its food production.","2e843bda":"Let's see how many tonnes of food have been produced by each South American state in the period comprised between 2000 and 2013. The result is expressed in 1000 tonnes.","e26db49d":"Now let's see how each country's food production evolved over the years. ","308f62ce":"## Countrywise production growth","48cb2b2e":"## Loading, cleaning and organizing data","61877847":"Here again Paraguay stands out with almost 50 percent of its food production dedicated to feed.","3b75131d":"## Top 5 food items countrywise in 2013","55759a0d":"Let's find out which 5 items had the biggest production volume in 2013 in each state and draw a plot reflecting their weight in the overall country food production.","8bf9b867":"Let's represent the production growth on a plot. Since Brazil's production is considerably higher than that of other countries, we'll draw a second plot, excluding Brazil.   ","23f53084":"It may also be interesting to see the correlation between the growth rates of different countries.","1b1e48f5":"Looking at the data from 2013, let's find out how many types of food and feed are produced by each country.","8789ea5b":"## Food items produced by each country in 2013"}}