{"cell_type":{"a741c078":"code","fc9ed7fd":"code","54ff6140":"code","781316f9":"code","7efaf751":"code","1e81d37e":"code","c4ab2787":"code","a44631e8":"code","1b757edc":"code","467c0c6d":"code","df01c035":"code","abe0625c":"code","abec3167":"code","b25d6e5a":"code","62ff030c":"code","76347b5c":"code","f9ca96aa":"code","a07d56f3":"code","81055a4a":"code","da3ee456":"code","1e3f257b":"code","101a000f":"code","e7aa542a":"code","802471c5":"code","60753ea9":"code","ff504b3d":"code","bdf12908":"code","bc00cee5":"code","cfaeac7d":"markdown","8d8c0d82":"markdown","9ad2c706":"markdown","3fd9bdd8":"markdown","dcfd6dde":"markdown","24981376":"markdown","66a05fe2":"markdown","81df09ea":"markdown","363e71c8":"markdown","a5910b70":"markdown"},"source":{"a741c078":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom sklearn import preprocessing\nimport seaborn as sns","fc9ed7fd":"df = pd.read_csv(\"..\/input\/heartcsv\/heart.csv\")\ndf.head()","54ff6140":"df[\"output\"].value_counts()","781316f9":"df.hist(column='age', bins=50)","7efaf751":"df.hist(column='sex', bins=50)","1e81d37e":"df.hist(column='chol', bins=50)","c4ab2787":"sns.relplot(x='age',y='chol',hue='output',size='trtbps',col='sex',data=df)","a44631e8":"sns.relplot(x='age',y='trtbps',hue = \"output\",size ='chol',col = 'sex',data = df)","1b757edc":"sns.relplot(x='trtbps',y='chol',hue ='output',data =df)","467c0c6d":"sns.relplot(y='thalachh',x='age',hue='output',data=df)","df01c035":"sns.relplot(x='trtbps',y='chol',hue ='sex',size='age',col ='output',data = df)","abe0625c":"df.head()","abec3167":"ax = sns.catplot(x='restecg',kind= 'count',data=df,orient=\"h\")\nax.fig.autofmt_xdate()","b25d6e5a":"sns.catplot(x=\"age\",y=\"sex\",kind='box',data=df)","62ff030c":"df.head()","76347b5c":"ax = sns.catplot(x='cp',y='age',hue='output',kind='point',data=df)\nax.fig.autofmt_xdate()","f9ca96aa":"ax = sns.catplot(x='exng',y='age',hue='output',kind='point',data=df)\nax.fig.autofmt_xdate()","a07d56f3":"x = df.drop(['output'],axis=1).values\n","81055a4a":"y= df['output'].values","da3ee456":"print(x)","1e3f257b":"x = preprocessing.StandardScaler().fit(x).transform(x.astype(float))\nx[0:5]","101a000f":"from sklearn.model_selection import train_test_split","e7aa542a":"x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=.2,random_state=45)","802471c5":"neighbors = np.arange(1, 9)\ntrain_accuracy = np.empty(len(neighbors))\ntest_accuracy = np.empty(len(neighbors))\n \n# Loop over K values\nfor i, k in enumerate(neighbors):\n    knn = KNeighborsClassifier(n_neighbors=k)\n    knn.fit(x_train, y_train)\n     \n    # Compute training and test data accuracy\n    train_accuracy[i] = knn.score(x_train, y_train)\n    test_accuracy[i] = knn.score(x_test, y_test)\n \n# Generate plot\nplt.plot(neighbors, test_accuracy, label = 'Testing dataset Accuracy')\nplt.plot(neighbors, train_accuracy, label = 'Training dataset Accuracy')\n \nplt.legend()\nplt.xlabel('n_neighbors')\nplt.ylabel('Accuracy')\nplt.show()","60753ea9":"from sklearn.neighbors import KNeighborsClassifier#Import knearest neighbors Classifier model\nknn= KNeighborsClassifier(n_neighbors = 7)\nknn.fit(x_train,y_train)\ny_pred=knn.predict(x_test)","ff504b3d":"from sklearn import metrics\n# Model Accuracy, how often is the classifier correct?\nprint(\"Accuracy:\",metrics.accuracy_score(y_test, y_pred))","bdf12908":"from sklearn.metrics import classification_report, confusion_matrix\nprint(confusion_matrix(y_test, y_pred))\nprint(classification_report(y_test, y_pred))","bc00cee5":"\nprint(\"Train set Accuracy: \", metrics.accuracy_score(y_train, knn.predict(x_train)))\nprint(\"Test set Accuracy: \", metrics.accuracy_score(y_test, y_pred))","cfaeac7d":"# NORMALIZATION","8d8c0d82":"# MODELING","9ad2c706":"# MODELING","3fd9bdd8":"# Importing Libraries","dcfd6dde":"# Spliting the data","24981376":"Now we know that now at k=7 the acuracy is best","66a05fe2":"# DATA VISUALISATION","81df09ea":"# USING KNN","363e71c8":"\n# Prediction","a5910b70":"# Reading data"}}