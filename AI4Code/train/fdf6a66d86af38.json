{"cell_type":{"6139166f":"code","006518d4":"code","b5ff009e":"code","d86e1acf":"code","0bab3606":"code","deed5990":"code","c46f0fad":"code","cd40790d":"code","7c6cd822":"code","d1ba09c2":"code","086a6810":"code","13cc6ae6":"code","333c677d":"code","4b38e478":"code","1f978fb2":"markdown","4a200ded":"markdown","770a8b67":"markdown","88221792":"markdown","b390a63e":"markdown","df41516e":"markdown","b9f8056e":"markdown","63fea8ef":"markdown","3719ecd8":"markdown"},"source":{"6139166f":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","006518d4":"import pandas as pd\nimport numpy as np\nimport plotly.express as px\nimport plotly.graph_objects as go","b5ff009e":"df_test = pd.read_csv(\"\/kaggle\/input\/titanic\/test.csv\")\ndf_train = pd.read_csv(\"\/kaggle\/input\/titanic\/train.csv\")\ndf_general = pd.read_csv(\"\/kaggle\/input\/titanic\/gender_submission.csv\")","d86e1acf":"d = {\"male\":1,\"female\":2}\ndf_train['Sex'] = df_train['Sex'].map(d)\ndf_test['Sex'] = df_test['Sex'].map(d)","0bab3606":"df_train.corr()","deed5990":"from sklearn.tree import DecisionTreeClassifier\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import r2_score","c46f0fad":"feature = ['Pclass','Sex','SibSp','Parch']\nX = df_train[feature]\ny = df_train['Survived']","cd40790d":"arr = np.random.randn(20,2)\nacc = pd.DataFrame(arr,columns = ('r2_score','accuracy_score')).astype(float)\nprint(\"DecisionTreeClassifier for different max_depth:\")\nfor i in range(20):\n    tree = DecisionTreeClassifier(max_depth = i+1, random_state = 1)\n    tree_clf = tree.fit(X,y)\n    X_test = df_test[feature]\n    prediction = tree_clf.predict(X_test)\n    acc['r2_score'][i] = r2_score(df_general['Survived'],prediction)\n    acc['accuracy_score'][i] = accuracy_score(df_general['Survived'],prediction)\nacc= acc.reset_index()\nacc['max_depth']=acc['index']+1\nacc = acc.drop(columns = \"index\")\nacc.head(5)","7c6cd822":"px.line(acc,x = \"max_depth\",y= [\"r2_score\",'accuracy_score'],title = \"DecisionTreeClassifier accuracy with different max_depth:\")","d1ba09c2":"from sklearn.ensemble import RandomForestClassifier","086a6810":"arr = np.random.randn(20,2)\nacc = pd.DataFrame(arr,columns = ('r2_score','accuracy_score')).astype(float)\nprint(\"RandomForestClassifier for different max_depth:\")\nfor i in range(20):\n    tree = RandomForestClassifier(max_depth = i+1, random_state = 1)\n    tree_clf = tree.fit(X,y)\n    X_test = df_test[feature]\n    prediction = tree_clf.predict(X_test)\n    acc['r2_score'][i] = r2_score(df_general['Survived'],prediction)\n    acc['accuracy_score'][i] = accuracy_score(df_general['Survived'],prediction)\nacc= acc.reset_index()\nacc['max_depth']=acc['index']+1\nacc = acc.drop(columns = \"index\")\nacc.head(5)","13cc6ae6":"px.line(acc,x = \"max_depth\",y= [\"r2_score\",'accuracy_score'],title = \"RandomForestClassifier accuracy with different max_depth:\")","333c677d":"from sklearn.linear_model import LinearRegression","4b38e478":"regr = LinearRegression().fit(X,y)\nprediction =regr.predict(X_test)\nr2 = r2_score(df_general['Survived'],prediction)\nprint('r2_score for Mulitple Regression is : ', r2)","1f978fb2":"**As we mentioned befor, linearregression is not a good way to predict!!**","4a200ded":"**With correlation we can understand that linearregression is not a good way to predict!!**","770a8b67":"**Multiple Regression**","88221792":"**The above plot ilustrates that with increae in max_depth the accuracy will not increase too!!**","b390a63e":"**DecisionTreeClassifier**","df41516e":"**Import Data**","b9f8056e":"**We will see that if we increase the number of max_depth the accuracy will not increase**","63fea8ef":"**As we are going to use DecisionTree we have to map the Sex column**","3719ecd8":"**Now we try the same procses with RandomForestClassifier**"}}