{"cell_type":{"59901c45":"code","67da0a1d":"code","df58a4bb":"code","b726179e":"code","a29391e7":"code","8e9797b7":"code","087d14ec":"code","9b9a5fa4":"code","0ed96e7f":"code","be529fd1":"code","32cb9e04":"code","b8de7ded":"code","75411116":"code","a9a54512":"code","4080cf7e":"code","f2632742":"code","f479df9a":"code","87e65801":"code","4bd65598":"code","4210d2af":"code","0a7bff2d":"code","617f6ad5":"markdown","393a0850":"markdown","eeca6af2":"markdown","f55ba340":"markdown","fd87b449":"markdown","1a1e1b79":"markdown","859a6e33":"markdown","f2e62a7b":"markdown","122db78d":"markdown","d4930e29":"markdown","051072e1":"markdown","f6cb0091":"markdown","4adc1be4":"markdown","8ea10ce6":"markdown"},"source":{"59901c45":"\nimport numpy as np \nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn import metrics\nfrom sklearn.metrics import classification_report, confusion_matrix\nfrom sklearn import preprocessing\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.svm import SVC\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\n","67da0a1d":"#Import wine dataset\ndf=pd.read_csv('..\/input\/red-wine-quality-cortez-et-al-2009\/winequality-red.csv')\n#Check data information\ndf.info()","df58a4bb":"#Check data first and last 5 rows\ndf.head()\ndf.tail()","b726179e":"#Check dataset has any missing data\ndf.isnull().any()","a29391e7":"#number of rows and columns\nprint(df.shape)","8e9797b7":"# Data structure\ndf.describe()","087d14ec":"#How data distribute in quality\nsns.countplot(x='quality',data=df)\nplt.title('Quality Data Distrubution')\nplt.xlabel('Quality level')\nplt.ylabel('Counts')\nplt.show()\nprint(pd.DataFrame(df['quality'].value_counts()))\n","9b9a5fa4":"#Data relationship\ndf.corr()\nsns.heatmap(df.corr(),annot=False,square=True,vmin=-1,vmax=1,linewidths=.6)","0ed96e7f":"sample_data=df.iloc[750:900]\nsns.pairplot(sample_data,plot_kws={'alpha':0.3})","be529fd1":"sns.regplot('alcohol','density',data=sample_data,color='darkblue',line_kws={'linewidth':0.9,'color':'black'})","32cb9e04":"sns.regplot('pH','fixed acidity',data=sample_data,color='darkgreen',line_kws={'linewidth':0.9,'color':'black'})","b8de7ded":"#Divide quaality into 3 groups\ngroup_bin=[0,4,6,10]\ngroup_labels=['Poor','Acceptable','Good']\ndf['group']=pd.cut(df.quality,group_bin,3, labels=group_labels)","75411116":"sns.set(palette=\"colorblind\")\nsns.countplot(x='group',data=df)\nplt.title('Taste Distrubution')\nplt.xlabel('Taste Quality')\nplt.ylabel('Counts')\nplt.show()\nprint(pd.DataFrame(df['group'].value_counts()))","a9a54512":"#Modelling\n#Split data\nX=df.iloc[:,:-2]\ny=df['group']\nprint(y.iloc[:10])\nlecod=preprocessing.LabelEncoder()  #Encoding Group\ny=lecod.fit_transform(y)\nprint(y[:10])\nX_train, X_test, y_train, y_test = train_test_split (X, y, test_size = 0.2, random_state=5)","4080cf7e":"# Standardize data\nsc = StandardScaler()\nsc.fit(X_train)\nX_train_std = sc.transform(X_train)\nX_test_std = sc.transform(X_test)","f2632742":"#SVM\nmodel_SVC=SVC()\nmodel_SVC.fit(X_train_std, y_train)\npredictions=model_SVC.predict(X_test_std)\n#Classification_report & Confusion_matrix to test the model is good or not\nprint(confusion_matrix(y_test, predictions))\nprint(classification_report(y_test,predictions,digits=4))\nprint(metrics.accuracy_score(y_test,predictions))","f479df9a":"#Random forest\nrf=RandomForestClassifier(n_estimators=250)\nrf.fit(X_train_std,y_train)\nRfpred=rf.predict(X_test_std)\nprint(classification_report(y_test,Rfpred,digits=4))\nprint(confusion_matrix(y_test, Rfpred))\nprint(metrics.accuracy_score(y_test,Rfpred))\nprint('feature importances',rf.feature_importances_)","87e65801":"#KNN\nknn = KNeighborsClassifier(n_neighbors=1)\nknn.fit(X_train_std,y_train)\nknnpred = knn.predict(X_test_std)\nprint(confusion_matrix(y_test,knnpred))\nprint(classification_report(y_test,knnpred))\nprint(metrics.accuracy_score(y_test,knnpred))","4bd65598":"##GridSearchcv to find a good estimator\n#Increase SVC accuracy to choose proper C and gamma\nC_range=[0.01,0.1,1,10,100,1000]\ngamma_range=[1,0.1,0.01,0.001,0.0001]\nparam_grid=dict(gamma=gamma_range, C=C_range)  #set up a dictionary to find suitable gamma & C\nmodel_SVC1=SVC(probability=True)\ngrid = GridSearchCV(model_SVC1, param_grid=param_grid,cv=4)\ngrid.fit(X_train_std, y_train)\nprint('grid.best_params=',grid.best_params_) \nprint('grid.best_score =',grid.best_score_)#show the best combination and the best estimator\ngrid_predictions = grid.predict(X_test_std)#using the best estimator to predict again\nprint(classification_report(y_test,grid_predictions,digits=4))\nprint(confusion_matrix(y_test, grid_predictions))\nprint(metrics.accuracy_score(y_test,grid_predictions))","4210d2af":"#Increase Random Forest Accuracy\nparam_dict={'n_estimators':[10,100,200,250,500],'criterion':['entropy','gini']}\ngrid=GridSearchCV(estimator=RandomForestClassifier(),param_grid=param_dict,cv=4)\ngrid.fit(X_train_std, y_train)\nprint('grid.best_params=',grid.best_params_) \nprint('grid.best_score =',grid.best_score_)\ngrid_predictions = grid.predict(X_test_std)\nprint(classification_report(y_test,grid_predictions,digits=4))\nprint(confusion_matrix(y_test, grid_predictions))\nprint(metrics.accuracy_score(y_test,grid_predictions))","0a7bff2d":"#Increase KNN Accuracy\nn=[i+1 for i in range(50)]\nparam_dict={'n_neighbors':n,'n_jobs':[-1]}\ngrid=GridSearchCV(estimator=KNeighborsClassifier(),param_grid=param_dict,cv=4)\ngrid.fit(X_train_std, y_train)\nprint('grid.best_params=',grid.best_params_) \nprint('grid.best_score =',grid.best_score_)\ngrid_predictions = grid.predict(X_test_std)\nprint(classification_report(y_test,grid_predictions,digits=4))\nprint(confusion_matrix(y_test, grid_predictions))\nprint(metrics.accuracy_score(y_test, grid_predictions))","617f6ad5":"## <span id=\"7\"><\/span> ** 7. Support Vector Machine **","393a0850":"<hr\/>\n[**Wine Quality Data Analysis & Prediction**](https:\/\/www.kaggle.com\/wine-quality-data-analysis-prediction\/)\n<hr\/>\n<font color=green>\n1. [Overview](#1)\n1. [Importing Libraries](#2)\n1. [Importing Dataset](#3)\n1. [Check Dataset Information](#4)\n1. [Data distribute in quality](#5)\n1. [Feature Modelling](#6)\n1. [Support Vector Machine](#7)\n1. [Random Forest](#8)\n1. [K Nearest Neighbor](#9)\n1. [GridSearchcv to find a good estimator](#10)\n<hr\/>","eeca6af2":"## <span id=\"2\"><\/span> ** 2. Importing Libraries **","f55ba340":"**\nHello kagglers! ** \n\n** Please leave me a comment and upvote the kernel if you liked at the end. **","fd87b449":"## <span id=\"3\"><\/span> ** 3. Importing Dataset **","1a1e1b79":"### Author : Sanjoy Biswas\n### Project : Wine Quality Data Analysis & Prediction\n### Email : sanjoy.eee32@gmail.com","859a6e33":"## <span id=\"5\"><\/span> ** 5. Data distribute in quality **","f2e62a7b":"## <span id=\"4\"><\/span> ** 4. Check Dataset Information**","122db78d":"## <span id=\"8\"><\/span> ** 8. Random Forest **","d4930e29":"Input Variables:\n- **fixed acidity: ** most acids involved with wine or fixed or nonvolatile\n- **volatile acidity: ** the amount of acetic acid in wine\n- **citric acid: ** found in small quantities, citric acid can add 'freshness' and flavor to wines \n- **residual sugar: ** the amount of sugar remaining after fermentation stops\n- **chlorides: ** the amount of salt in the wine\n- **free sulfur dioxide: ** the free form of SO2 exists in equilibrium between molecular SO2 (as a dissolved gas) and bisulfite ion\n- **total sulfur dioxide: ** amount of free and bound forms of S02\n- **density: ** the density of water is close to that of water depending on the percent alcohol and sugar content\n- **pH: ** describes how acidic or basic a wine is on a scale from 0 (very acidic) to 14 (very basic)\n- **sulphates: ** a wine additive which can contribute to sulfur dioxide gas (S02) levels \n- **alcohol: ** the percent alcohol content of the wine<br>\n\nOutput Variable:\n- **quality: ** output variable (based on sensory data, score between 0 and 10)","051072e1":"## <span id=\"6\"><\/span> ** 6. Feature Modelling **","f6cb0091":"## <span id=\"1\"><\/span> ** 1. Overview **","4adc1be4":"## <span id=\"10\"><\/span> ** 10. GridSearchcv to find a good estimator **","8ea10ce6":"## <span id=\"9\"><\/span> ** 9. K Nearest Neighbor **"}}