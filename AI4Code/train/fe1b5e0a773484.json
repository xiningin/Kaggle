{"cell_type":{"b6b70244":"code","3505e2a7":"code","1f319d52":"code","c0e3a0cf":"code","d9efcebb":"code","3ddf4de2":"code","da8dfc0f":"code","a5c0a52d":"code","6445997d":"code","d69438f6":"code","2d016cfe":"code","e8b65170":"code","24c8afb8":"code","fa101b10":"code","68dfe049":"code","58ca04cb":"code","fd809a85":"code","1977323a":"markdown","25441910":"markdown","bcb9f4f4":"markdown","b1392bcb":"markdown","af294687":"markdown","90fae7b5":"markdown","8924b051":"markdown","2ec22deb":"markdown","f3c734e3":"markdown","d52da9dc":"markdown","4066e4a5":"markdown","25a3c6e3":"markdown","91790ce3":"markdown","1625eeee":"markdown"},"source":{"b6b70244":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom fastai.vision import *\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","3505e2a7":"proj_path = '\/kaggle\/input\/sports-ball-images\/'\n\nfolders = ['airhockeypucks', 'baseballs', 'basketballs', 'bowlingballs', 'cricketballs', 'footballs', 'golfballs', 'hockeypucks', 'lacrosseballs', 'poolballs', 'rugbyballs', 'soccerballs', 'softballs', 'tennisballs', 'volleyballs']\nfor i in folders:\n    path = Path(proj_path)\n    (path\/i).mkdir(parents=True, exist_ok=True)\n    \np_path = Path(proj_path)","1f319d52":"np.random.seed(42)\ndata = ImageDataBunch.from_folder(path, train='.', valid_pct=.2, ds_tfms=get_transforms(), \n                                  size=224, num_workers=4).normalize(imagenet_stats)","c0e3a0cf":"data.classes","d9efcebb":"data.show_batch(rows=3, figsize=(7,8))","3ddf4de2":"data.classes, data.c, len(data.train_ds), len(data.valid_ds)","da8dfc0f":"learn = cnn_learner(data, models.resnet34, metrics=error_rate)","a5c0a52d":"# 8 epochs\nlearn.fit_one_cycle(8)","6445997d":"learn.model_dir = \"\/kaggle\/working\"\nlearn.save('model1_34', return_path=True)","d69438f6":"learn.unfreeze()","2d016cfe":"learn.lr_find()\nlearn.recorder.plot()","e8b65170":"learn.fit_one_cycle(2, max_lr=slice(1e-6, 1e-4), wd=.001)","24c8afb8":"learn.freeze()\nlearn.lr_find()\nlearn.recorder.plot()","fa101b10":"learn.save('model2_34')","68dfe049":"learn.load('model1_34')\ninterp = ClassificationInterpretation.from_learner(learn)\ninterp.plot_confusion_matrix()","58ca04cb":"interp.plot_top_losses(9, figsize=(10,10))","fd809a85":"img_baseball = open_image(Path(p_path)\/'baseball_validation.jpg')\ndisplay(img_baseball)\n\npred_class, pred_idx, outputs = learn.predict(img_baseball)\npred_class","1977323a":"Within the first epoch, our error rate decreased.","25441910":"Saving the newly built model.","bcb9f4f4":"> The issue is that the root folder 'sports-ball-images' is included as a class and therefore plays a strong roll in categorizing. I am working on fixing this.","b1392bcb":"## Sports Ball Image Recognition","af294687":"Testing to see if changing the learning rate gets better accuracies. We want a steep learning rate: about 1e-6 and 1e-4.","90fae7b5":"To find an optimal learning rate.","8924b051":"Saving the new model.","2ec22deb":"Finding the most incorrect predictions.","f3c734e3":"I will be using a convolutional neural net learner and transfer learning on the ResNet34 pre-trained model. Transfer learning allows me to fix the end of the pre-trained model for my own use. The metric used is error rate, which is 1 - accuracy.","d52da9dc":"Confusion matrix to interpret the model's predictions.","4066e4a5":"Classifying an image.","25a3c6e3":"Unfreezing to retrain the model.","91790ce3":"With deep learning, this model observes images and identifies which sport a ball is from. Transfer learning was used on a convoluted neural network trained on ResNet-34. Code was referenced from a tutorial by Francisco Ingham and Jeremy Howard: https:\/\/github.com\/fastai\/course-v3\/blob\/master\/nbs\/dl1\/lesson2-download.ipynb.","1625eeee":"### With very minimal fine-tuning, this image recognition model received an error rate of .18. To further improve my model, I would first need to add more images to my dataset because I believe the amount I have collected would not be enough to train classifiers sufficiently to distinguish such similar objects, and see how big of an effect that causes first."}}