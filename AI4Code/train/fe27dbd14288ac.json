{"cell_type":{"6825d7f7":"code","973ed438":"code","d57022d1":"code","65c2ed3b":"code","075bdc34":"code","75a2badd":"code","a0f2da94":"code","40767a95":"code","39c8aeea":"code","fe45e77c":"code","12d2b7ba":"code","28febcd4":"code","5f24b05a":"code","aeae53d0":"code","67bd31b1":"code","9e185124":"code","f9903f33":"code","dd221b3f":"code","402ca059":"code","5efcadee":"code","c1c401c0":"code","6d6a43f8":"code","dfa28a23":"code","1723d45f":"markdown","0c343b4a":"markdown","ad294cab":"markdown","530f7bfd":"markdown","dec5ffae":"markdown","9a1c9af3":"markdown","d81068b5":"markdown","96f527da":"markdown","5540bc82":"markdown","fc2cc9f4":"markdown","0dea280e":"markdown","fab09e6c":"markdown","c6432202":"markdown","22ca2f8f":"markdown","8c8bc847":"markdown","ce556b66":"markdown","a117fe12":"markdown","bc142a5d":"markdown","84d3553b":"markdown","4c679c7b":"markdown","a4971c30":"markdown","68f8572b":"markdown","d0570040":"markdown","0d4b14c4":"markdown","045a2fef":"markdown","2a35f518":"markdown","f4defca0":"markdown","036058c4":"markdown","5d1f5b14":"markdown","da3267d3":"markdown","dfdcc8f6":"markdown"},"source":{"6825d7f7":"import warnings\nimport numpy as np \nimport pandas as pd\nimport plotly as py\nimport seaborn as sns\nimport statistics as stat\nfrom datetime import date\nimport plotly.express as px\nimport plotly.graph_objs as go\nwarnings.filterwarnings(\"ignore\")\npd.set_option('display.max_columns', None)\nfrom plotly.offline import init_notebook_mode\ninit_notebook_mode(connected = True)\nimport matplotlib.lines as lines\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\ncustomers = pd.read_csv('..\/input\/customer-personality-analysis\/marketing_campaign.csv', delimiter='\\t')","973ed438":"customers.head()","d57022d1":"customers.tail()","65c2ed3b":"customers.info()","075bdc34":"customers['Kids'] = customers['Kidhome'] + customers['Teenhome']","75a2badd":"customers.Marital_Status.unique()","a0f2da94":"map_status = {\n    'Single' : 'not in relationship', \n    'Together': 'in relationship', \n    'Married' : 'in relationship', \n    'Divorced' : 'not in relationship', \n    'Widow' : 'not in relationship', \n    'Alone' : 'not in relationship',\n    'Absurd' : 'not in relationship',\n    'YOLO' : 'not in relationship'\n}\n\n\ncustomers.Marital_Status = customers.Marital_Status.map(map_status)","40767a95":"customers['FamilySize'] = 0\nfor i in range(len(customers)):\n    if customers['Marital_Status'][i] == 'in relationship':\n        customers['FamilySize'][i] = customers['Kids'][i]  + 2\n    else:\n        customers['FamilySize'][i] = customers['Kids'][i] + 1","39c8aeea":"pd.to_datetime(customers['Dt_Customer']).unique().max()","fe45e77c":"customers['Age'] = 2014 - customers['Year_Birth']\ncustomers['Collected'] = '2014-12-07'\ncustomers['Dt_Customer'] = pd.to_datetime(customers['Dt_Customer'])\ncustomers['Collected'] = pd.to_datetime(customers['Collected'])\ncustomers['Total_days'] = (customers['Collected'] - customers['Dt_Customer']).dt.days","12d2b7ba":"customers['Total_purchases_sum'] = customers['MntWines'] + customers['MntFruits'] \n+ customers['MntMeatProducts'] + customers['MntFishProducts'] \n+ customers['MntSweetProducts']+ customers['MntGoldProds']\n\ncustomers['Total_purchases_amount'] = customers['NumCatalogPurchases']\n+customers['NumStorePurchases'] + customers['NumWebPurchases']\n\ncustomers['TotalCmp'] = customers['AcceptedCmp1'] + customers['AcceptedCmp2']\ncustomers['AcceptedCmp3'] + customers['AcceptedCmp4'] +customers['AcceptedCmp5'] + customers['Response']","28febcd4":"customers.drop(columns=['ID', 'MntWines', 'MntFruits', \n                        'MntMeatProducts', 'MntFishProducts', \n                        'MntSweetProducts', 'MntGoldProds', \n                        'NumCatalogPurchases', 'NumStorePurchases', 'NumWebPurchases', \n                        'Kidhome', 'Teenhome', 'Marital_Status',\n                        'AcceptedCmp3', 'AcceptedCmp4', 'AcceptedCmp5', \n                        'AcceptedCmp1','AcceptedCmp2'], inplace=True)","5f24b05a":"customers.query('Total_purchases_amount != 0', inplace=True)","aeae53d0":"customers.isnull().sum()","67bd31b1":"customers['Income'].fillna(customers['Income'].mean(), inplace=True)","9e185124":"customers['Income'].max()","f9903f33":"customers.query('Income != 666666.0', inplace=True)","dd221b3f":"customers.head()","402ca059":"fig = px.scatter(customers, x='Income', y='Total_purchases_sum',\n                color = 'Education')\n\nfig.update_layout(height=600, width=1000, title_text='Scatter plot',\n                 yaxis_title=\"Sum of total purchases\",font=dict(\n        family=\"Courier New, monospace\",\n        size=18,\n        color=\"black\"\n    ))\n\nfig.show()","5efcadee":"groupby_family_size = customers.groupby(['FamilySize', 'Education']).count()['Total_purchases_sum']\n\nfig = px.bar(x = groupby_family_size.index.get_level_values(0) ,y = groupby_family_size.values ,\n             color = groupby_family_size.index.get_level_values(1),width = 1000, height = 700,\n             labels=dict(x=\"Family Size\", y=\"Sum of total purchases\", color=\"Education\")\n)\n\nfig.update_layout(title_text='Clients family size and purchases sum', \n                    xaxis_title='Family size',\n                    yaxis_title='Total purchases sum',\n                    legend_title = 'Education',\n                 font=dict(\n        family=\"Courier New, monospace\",\n        size=18,\n        color=\"black\")\n)\n\nfig.show()","c1c401c0":"customers[customers['Age'] > 100]","6d6a43f8":"customers = customers[customers[\"Age\"] < 110]","dfa28a23":"fig = px.histogram(data_frame=customers, x='Age', y='Total_purchases_sum',height=600, width=1000,nbins =10,\n                  color_discrete_sequence=['#330C73'])\n\nfig.update_layout(title_text='Clients ages and purchases sum', \n                    xaxis_title='Age',\n                    yaxis_title='Total purchases sum',\n                 font=dict(\n        family=\"Courier New, monospace\",\n        size=18,\n        color=\"black\")\n)\n\nfig.show()","1723d45f":"There's a lot of columns, we need to exemine them to understand data better, first thing I'm going to do is to concatenate the Kidhome and Teenhome columns in one columns - Kids.","0c343b4a":"This icnome looks for me quite... devillishly","ad294cab":"Now it's time to look at the purchases","530f7bfd":"# Customers analysis","dec5ffae":"Thers's 14 null values in the Income column, I think that we could easily replace them with incomes mean","9a1c9af3":"As the market gets bigger and bigger good cutsomer is as precious as gold. But first... who actually is a **good customer?** In my opinion definition of good customer is customer which attached to the firm for so long long time and periodically spend quite a lot of money on shopping. But how many years she or he have? How man children he or she have etc? Let's see","d81068b5":"Outliners?","96f527da":"I think that it will be much more simpler if we categorize this data into two categories:\n\n- **in relationship**\n- **not in relationship**","5540bc82":"Let's look at the family size, maybe this factor have impact on the total money spent in the shop...","fc2cc9f4":"From three visualizations above we can assume potential good clients are the couples between 30 and 60 years old which have higher education and no kids or at most one kid.","0dea280e":"Now we can go further...","fab09e6c":"In this case we can see that clients between 30 and 60 years old are potential good clients","c6432202":"It's not like I don't like older people but this guys with age higher than 110 years old looks suspicious to me... It may be better to remove them","22ca2f8f":"Let's look for customers which never make any order","8c8bc847":"And last five rows...","ce556b66":"Now it's time to drop all of the redundant columns","a117fe12":"## 1. Examining data","bc142a5d":"First five rows","84d3553b":"I'm going to drop it","4c679c7b":"Let's see when last order has been placed","a4971c30":"Last data is 6 December of 2014. We will assume that the customer information was collected untill 7 of December 2014","68f8572b":"But anyway, we still have some missing values","d0570040":"Let's see what we have","0d4b14c4":"There's clear pattern between income and sum of total purchases because when income increases total purchases sum increases too. \nFrom the other hand there's no clear pattern between education and total purchases sum. We can see that people with basic education don't spend too much money, but rest - of course.","045a2fef":"## 2. Data visualizations","2a35f518":"Next think i m going to do is to iterate over every row in the data and if marital status is 'in relationship' I m going to add 2 to the kids amount (there's 2 parrents) else (if theres not in relationship) I'm going to add 1 to the kids amount","f4defca0":"Scatter plot between income and total amount of money spended","036058c4":"## 3. Conclusions","5d1f5b14":"Next let's examine the unique values in the Marital_Status column","da3267d3":"Finally we get this","dfdcc8f6":"We can see that potencial good clients are the couples without children or with one children at most. They have mostly graduation degree."}}