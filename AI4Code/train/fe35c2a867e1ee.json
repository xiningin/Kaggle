{"cell_type":{"5ca27f5c":"code","2a2d05d8":"code","331d1359":"code","a8cabba2":"code","8f9da0f7":"code","9e41b60e":"code","d37f5bbe":"code","60c35b7d":"code","002d94d8":"code","d6e2ab75":"code","578d3710":"code","cbda1eaf":"code","f5dcb33e":"code","f7d00d4c":"code","7ba30f0e":"code","d9d7d549":"code","7e773fef":"code","e4702b22":"code","a7e08056":"code","126db18d":"code","28e735a1":"code","302a7082":"markdown","0c191184":"markdown","cd61cebf":"markdown","65600862":"markdown","250d9469":"markdown","1c2664e3":"markdown","19120cea":"markdown","4585dbe8":"markdown","bd442f3e":"markdown","722d1753":"markdown","9470af99":"markdown","79575465":"markdown","69285131":"markdown","5e91a1c9":"markdown","3e071aae":"markdown","6d2d7cca":"markdown","eed7c964":"markdown","25c2c085":"markdown"},"source":{"5ca27f5c":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn import preprocessing\nfrom sklearn .metrics import accuracy_score, f1_score\nfrom sklearn.model_selection import train_test_split\nfrom catboost import CatBoostClassifier\n\nseed = 143\nnp.random.seed(seed)\n\n%matplotlib inline","2a2d05d8":"df = pd.read_csv('..\/input\/autism-screening-on-adults\/autism_screening.csv')","331d1359":"len(df)","a8cabba2":"df.head()","8f9da0f7":"df.columns","9e41b60e":"df.nunique()","d37f5bbe":"df.drop(columns=['age_desc'], inplace=True)","60c35b7d":"df.isnull().sum()","002d94d8":"df['age'].fillna(0, inplace=True)","d6e2ab75":"df['Class\/ASD'] = df['Class\/ASD'].apply(lambda x: int(x == 'YES'))","578d3710":"sns.swarmplot(x='Class\/ASD', y='result', data=df)","cbda1eaf":"sns.distplot(df['age'])","f5dcb33e":"cols = ['gender','jundice','austim','used_app_before']\nfor i in cols:\n    sns.swarmplot(x='Class\/ASD', y=i, data=df)\n    plt.show()","f7d00d4c":"fig = sns.barplot(y=df['contry_of_res'].value_counts().index[:15], x=df['contry_of_res'].value_counts().values[:15], data=df)\nfig.set(xlabel='Count', ylabel='Country')\nplt.show()","7ba30f0e":"df['Class\/ASD'].value_counts()","d9d7d549":"df = df.sample(frac=1, random_state=seed)\ntrain_x,test_x,train_y,test_y = train_test_split(df.drop(columns=['Class\/ASD']), df['Class\/ASD'], test_size=0.2, random_state=seed)","7e773fef":"cat_features = [i for i in df.columns if i not in ['Class\/ASD', 'age', 'result']]\n\nclf = CatBoostClassifier(\n    iterations=10,\n    verbose=5,\n    class_weights = [1,2]\n)\n\nclf.fit(\n    train_x, train_y ,\n    cat_features=cat_features,\n)","e4702b22":"pred_y = clf.predict(test_x)","a7e08056":"accuracy_score(pred_y, test_y)","126db18d":"f1_score(pred_y, test_y)","28e735a1":"clf.get_feature_importance()","302a7082":"In this notebook I am going to perform EDA and binary classification using catboost classifier.\n\n**EDA:**\n\n* Finding correlation between categorical features and target using swarmplots.\n* Distribution plot for age.\n* Plot of top countries participated in survey.\n\n**Classification:**\n\nClassification using catboost classifier.\n\nWhy catboost?\n* Because we don't need to preprocess categorical features for using catboost.\n* Handle class imbalance using class weights.","0c191184":"Let's build the classifier.","cd61cebf":"**Let's import all required packages**","65600862":"## EDA","250d9469":"Age column has 2 nan values, let's replace them with 0.","1c2664e3":"Let's encode target class labels YES and NO with 0 and 1 respectively.","19120cea":"Let's plot individual categorical columns agaist target to see how they are related.","4585dbe8":"From above plot we can say that, average age of candidates is somewhere around 25-30.","bd442f3e":"## Prediction","722d1753":"There is a class imbalance problem. We will handle this by specifying class_weights in classifier later.\n\nBefore jumping into building a classifier, let's shuffle the data and split it into train and test sets.","9470af99":"Load the data","79575465":"By looking at unique values for columns we can say that, all are categorical columns.\n\nSince column 'age_desc' has just one value throughout the data, we can drop it.","69285131":"Glimpse the data","5e91a1c9":"From above plots we can say that, no columns from above list shows correlation with target class. There is no clear separation of classes.","3e071aae":"Perfect f1 score of 1!!\n\nLet's find the feature importance.","6d2d7cca":"We can clearly see from above plot that, result is highly correlated with Class\/ASD. There is clear separation between class 0 and 1.\n\nObservations:\n\nif \n* result > 6 , Class\/ASD = 1\n* otherwise, Class\/ASD = 0\n","eed7c964":"Let's check for null values in data","25c2c085":"Let's plot top 15 countries participated in survey based on their count."}}