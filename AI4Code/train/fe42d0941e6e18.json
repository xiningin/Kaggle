{"cell_type":{"ac1a37b1":"code","5db9247c":"code","dff11020":"code","cf044179":"code","d3e147bb":"code","9ad48ca1":"code","78ad0d98":"code","4c69627d":"code","c5c599dd":"code","5565776f":"code","a12e7c37":"code","bd3074a9":"code","7235589a":"code","503bf275":"code","93ee7033":"code","735ac668":"code","c92b13ef":"code","d2b649ee":"code","e29b8153":"code","6c71eae9":"code","2251fa77":"code","bc7d701c":"code","715d146f":"code","aa67cbbc":"code","7da2f31c":"code","9945e038":"code","752a8f82":"code","3b1428e5":"code","4f21c961":"code","7697e975":"code","67617332":"code","ed56073e":"code","e21d7179":"code","24b9779b":"code","cb6e4e0f":"code","1b0448bb":"code","cff262dc":"code","60208e96":"code","343bbda6":"code","d26b1576":"code","3fe844e5":"code","3ea66fd9":"code","72473028":"code","a815d8c5":"code","25aa1f4b":"code","6292c7da":"code","0d5cf2c3":"code","e02f4b07":"code","7727ffd2":"code","eb30dec0":"code","49fb0a34":"code","ddcbc778":"code","e6445e41":"code","3a8bb707":"code","90db3056":"code","1a760314":"code","6b87454c":"code","bba0bf7f":"code","4d49bf3d":"code","ad74fbab":"code","99d7daf1":"code","b1399f37":"code","29fd1b84":"code","f473b108":"markdown","af9e87cf":"markdown","a99a06df":"markdown","764b17c6":"markdown","e871a218":"markdown","eb427987":"markdown","611c5e60":"markdown","feae4e95":"markdown","903c8a19":"markdown","403d5f9f":"markdown","b55885d3":"markdown","5e47952c":"markdown","4c4945d8":"markdown","7651fbce":"markdown","2b604f5c":"markdown","8ac988d7":"markdown","d1181a23":"markdown","e22b2e03":"markdown","7a79ce66":"markdown","372e9b0c":"markdown","9ddb0676":"markdown","b9553871":"markdown","18a0d749":"markdown"},"source":{"ac1a37b1":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport scipy as sp\nfrom sklearn.metrics import make_scorer\nfrom sklearn.metrics import mean_squared_error as mse\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import KFold\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.model_selection import cross_val_score","5db9247c":"train = pd.read_csv('..\/input\/2019-2nd-ml-month-with-kakr\/train.csv')\ntest = pd.read_csv('..\/input\/2019-2nd-ml-month-with-kakr\/test.csv')","dff11020":"print('train shape : ',train.shape)\nprint('test shape : ',test.shape)","cf044179":"train.head()","d3e147bb":"for df in [train, test]:\n    df['year'] = df['date'].apply(lambda x : x[0:4], range(len(df)))\n    df['month'] = df['date'].apply(lambda x : x[4:6], range(len(df)))\n    df['day'] = df['date'].apply(lambda x : x[6:8], range(len(df)))","9ad48ca1":"train.isnull().sum()","78ad0d98":"test.isnull().sum()","4c69627d":"train.columns","c5c599dd":"train['year'].value_counts()","5565776f":"test['year'].value_counts()","a12e7c37":"sns.distplot(train['price'])","bd3074a9":"train['price'] = sp.special.log1p(train['price'])","7235589a":"sns.distplot(train['price'])","503bf275":"sns.boxplot(train['bedrooms'], train['price'])","93ee7033":"sns.boxplot(train['bathrooms'], train['price'])","735ac668":"sns.regplot(train['sqft_living'], train['price'])","c92b13ef":"sns.regplot(train['sqft_living15'], train['price'])","d2b649ee":"sns.regplot(train['sqft_living']-train['sqft_living15'], train['price'])","e29b8153":"sns.regplot(train['sqft_lot'], train['price'])","6c71eae9":"sns.regplot(train['sqft_lot15'], train['price'])","2251fa77":"sns.regplot(train['sqft_lot'] - train['sqft_lot15'], train['price'])","bc7d701c":"sns.boxplot(train['floors'], train['price'])","715d146f":"sns.boxplot(train['waterfront'], train['price'])","aa67cbbc":"sns.boxplot(train['view'], train['price'])","7da2f31c":"sns.boxplot(train['condition'], train['price'])","9945e038":"sns.boxplot(train['grade'], train['price'])","752a8f82":"sns.regplot(train['sqft_above'], train['price'])","3b1428e5":"sns.regplot(train['sqft_basement'], train['price'])","4f21c961":"sns.regplot(train['yr_built'], train['price'])","7697e975":"train.columns","67617332":"sns.regplot(train['sqft_living'] + train['sqft_lot'], train['price'])","ed56073e":"sns.regplot(train['sqft_living'] + train['sqft_lot'] + train['sqft_living15'], train['price'])","e21d7179":"corr = train.corr(method = 'spearman')\ncorr = corr.nlargest(n = 10, columns = 'price')\nplt.figure(figsize = (14, 10))\nsns.heatmap(corr, fmt = '.2f', annot = True)\nsns.set(font_scale = 1.25)","24b9779b":"sns.boxplot(train['grade'], train['price'])","cb6e4e0f":"train[train['grade'] >= 13]","1b0448bb":"test[test['grade'] >= 13]","cff262dc":"sns.regplot(train['sqft_living'], train['price'])","60208e96":"train[train['sqft_living'] >= 8000]","343bbda6":"test[test['sqft_living'] >= 8000]","d26b1576":"sns.regplot(train['sqft_living15'], train['price'])","3fe844e5":"train[train['sqft_living15'] >= 6000]","3ea66fd9":"test[test['sqft_living15'] >= 6000]","72473028":"sns.regplot(train['sqft_above'], train['price'])","a815d8c5":"train[train['sqft_above'] >= 7000]","25aa1f4b":"test[test['sqft_above'] >= 7000]","6292c7da":"sns.boxplot(train['bathrooms'], train['price'])","0d5cf2c3":"sns.distplot(train['bathrooms'])","e02f4b07":"sns.distplot(test['bathrooms'])","7727ffd2":"train[train['bathrooms'] > 6]","eb30dec0":"test[test['bathrooms'] > 6]","49fb0a34":"test_id = test.id","ddcbc778":"for df in [train, test]:\n    df.drop(columns = ['id', 'date', 'lat', 'long'], inplace = True)","e6445e41":"K_fold = KFold(n_splits = 10, shuffle = True, random_state = 42)","3a8bb707":"X_train = train.drop(columns = 'price')\ny_train = train.price","90db3056":"clf = RandomForestRegressor(n_estimators = 15, n_jobs = -1)","1a760314":"scoring = make_scorer(mse)\nscore = cross_val_score(clf, X_train, y_train, cv = K_fold, n_jobs = 1, scoring = scoring)","6b87454c":"print(sp.special.expm1(score) ** 0.5)","bba0bf7f":"clf.fit(X_train, y_train)","4d49bf3d":"prediction = clf.predict(test)","ad74fbab":"prediction = sp.special.expm1(prediction)","99d7daf1":"prediction","b1399f37":"submission = pd.DataFrame({'id' : test_id, 'price' : prediction})","29fd1b84":"submission","f473b108":"# 3. Modeling","af9e87cf":"* bathrooms\uc774 6\uac1c \uc774\uc0c1\uc911\uc5d0\uc11c\ub294 train data\uc640 \ub3d9\uc77c\ud55c \ubd80\ubd84\uc774 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc74c.\n* train\ub370\uc774\ud130\ub294 8\uae4c\uc9c0 \uc874\uc7ac\ud558\ub294 \ubc18\uba74, test \ub370\uc774\ud130\ub294 6.5\uac00 \ub05d\uc784","a99a06df":"* grade, sqft_living, sqft_living15, sqft_above, bathrooms\uc640 \uc0c1\uad00\uad00\uacc4\uac00 \ub192\uc74c","764b17c6":"* right-skewed\ub41c y\uac12\uc5d0 \ub300\ud574 normalization\uc744 \ud574\uc8fc\uace0\uc790 \ud568\n* 0\uc778 \uac12\uc774 \uc874\uc7ac\ud558\uae30\uc5d0, log1p transformation\uc744 \uc9c4\ud589","e871a218":"# 2. Exploratory Data Analysis","eb427987":"* sqft_living - sqft_living15\ub97c \ud30c\uc0dd\ubcc0\uc218\ub85c \uc0dd\uac01\ud574\ubcf4\uc558\uc73c\ub098, \ub354\uc6b1 \ub370\uc774\ud130\uac00 \ud37c\uc9c0\uae30\uc5d0 \ud30c\uc0dd\ubcc0\uc218\ub85c \uc0ac\uc6a9\ud558\uc9c0 \uc54a\ub3c4\ub85d \ud568","611c5e60":"# 1. Data Fields\n\n* ID : \uc9d1\uc744 \uad6c\ubd84\ud558\ub294 \ubc88\ud638\n* date : \uc9d1\uc744 \uad6c\ub9e4\ud55c \ub0a0\uc9dc\n* price : \uc9d1\uc758 \uac00\uaca9(Target variable)\n* bedrooms : \uce68\uc2e4\uc758 \uc218\n* bathrooms : \ud654\uc7a5\uc2e4\uc758 \uc218\n* sqft_living : \uc8fc\uac70 \uacf5\uac04\uc758 \ud3c9\ubc29 \ud53c\ud2b8(\uba74\uc801)\n* sqft_lot : \ubd80\uc9c0\uc758 \ud3c9\ubc29 \ud53c\ud2b8(\uba74\uc801)\n* floors : \uc9d1\uc758 \uce35 \uc218\n* waterfront : \uc9d1\uc758 \uc804\ubc29\uc5d0 \uac15\uc774 \ud750\ub974\ub294\uc9c0 \uc720\ubb34 (a.k.a. \ub9ac\ubc84\ubdf0)\n* view : \uc9d1\uc774 \uc5bc\ub9c8\ub098 \uc88b\uc544 \ubcf4\uc774\ub294\uc9c0\uc758 \uc815\ub3c4\n* condition : \uc9d1\uc758 \uc804\ubc18\uc801\uc778 \uc0c1\ud0dc\n* grade : King County grading \uc2dc\uc2a4\ud15c \uae30\uc900\uc73c\ub85c \ub9e4\uae34 \uc9d1\uc758 \ub4f1\uae09\n* sqft_above : \uc9c0\ud558\uc2e4\uc744 \uc81c\uc678\ud55c \ud3c9\ubc29 \ud53c\ud2b8(\uba74\uc801)\n* sqft_basement : \uc9c0\ud558\uc2e4\uc758 \ud3c9\ubc29 \ud53c\ud2b8(\uba74\uc801)\n* yr_built : \uc9c0\uc5b4\uc9c4 \ub144\ub3c4\n* yr_renovated : \uc9d1\uc744 \uc7ac\uac74\ucd95\ud55c \ub144\ub3c4\n* zipcode : \uc6b0\ud3b8\ubc88\ud638\n* lat : \uc704\ub3c4\n* long : \uacbd\ub3c4\n* sqft_living15 : 2015\ub144 \uae30\uc900 \uc8fc\uac70 \uacf5\uac04\uc758 \ud3c9\ubc29 \ud53c\ud2b8(\uba74\uc801, \uc9d1\uc744 \uc7ac\uac74\ucd95\ud588\ub2e4\uba74, \ubcc0\ud654\uac00 \uc788\uc744 \uc218 \uc788\uc74c)\n* sqft_lot15 : 2015\ub144 \uae30\uc900 \ubd80\uc9c0\uc758 \ud3c9\ubc29 \ud53c\ud2b8(\uba74\uc801, \uc9d1\uc744 \uc7ac\uac74\ucd95\ud588\ub2e4\uba74, \ubcc0\ud654\uac00 \uc788\uc744 \uc218 \uc788\uc74c)","feae4e95":"* waterfront \uc5ec\ubd80\uac00 \uc5c6\ub294\uac83\ubcf4\ub2e8 \uc788\ub294\uac8c \uac00\uaca9\uc774 \ub192\uc74c","903c8a19":"* \uc5b4\ub290\uc815\ub3c4 \uc601\ud5a5\uc774 \uc788\ub294\uac83\uc73c\ub85c \ud310\ub2e8","403d5f9f":"* \ubd80\uc9c0\uc758 \ud3c9\ubc29\ud53c\ud2b8\ub294 \ub108\ubb34 \ud37c\uc838\uc788\uc5b4 \ubb38\uc81c\uac00 \uc788\uc5b4 \ubcf4\uc784","b55885d3":"* train, test \ub370\uc774\ud130\uc758 \ub144\ub3c4 \ube44\uc728\uc774 \ube44\uc2b7\ud558\uac8c \uc774\ub8e8\uc5b4\uc838 \uc788\uc74c","5e47952c":"* train, test \ub370\uc774\ud130 \ubaa8\ub450 \uacb0\uce21\uac12 \uc5c6\uc774 \uae68\ub057\ud568","4c4945d8":"* \uc8fc\uac70\uacf5\uac04\uc758 \ud06c\uae30 \ub610\ud55c \uac00\uaca9\uc5d0 \uc601\ud5a5\uc774 \uc788\ub294\uac83\uc73c\ub85c \ubcf4\uc784","7651fbce":"* log1p\ub97c \ud1b5\ud574, \uc815\uaddc\ubd84\ud3ec\uc5d0 \uadfc\uc0ac\ud568\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc74c","2b604f5c":"* sqft_lot\uc5d0 \ub300\ud55c \ucc28\uc774 \ub610\ud55c \ub108\ubb34 \ud37c\uc838\uc788\uc5b4 sqft_lot\uacfc \uad00\ub828\ud55c \ub370\uc774\ud130 \uc790\uccb4\ub97c \uc0ac\uc6a9\ud558\ub294\uac8c \ud798\ub4e4\uc5b4\ubcf4\uc784","8ac988d7":"* sqft_lot15 \ub610\ud55c \ub108\ubb34 \ud37c\uc838\uc788\uc74c","d1181a23":"* yr_built\ub3c4 \uacbd\ud5a5\uc131\uc774 \ubcf4\uc774\uc9c4 \uc54a\uc74c","e22b2e03":"### Modeling \uc774\uc804 \ucc98\ub9ac\ud574\uc8fc\uc5b4\uc57c \ud560 \uc810\n* id \ubcc0\uc218\ub294 \ubb34\uc758\ubbf8\ud558\uae30\uc5d0 \uc0ad\uc81c\n* date\ub294 year, month, day \ucc98\ub9ac\ud574\uc8fc\uc5c8\uae30\uc5d0 date \ubcc0\uc218 \uc0ad\uc81c\n* lat, long\uc5d0 \ub300\ud55c \uc815\ubcf4 \ub610\ud55c zipcode\uc5d0 \ub2f4\uaca8\uc788\ub2e4\uace0 \ud310\ub2e8\ud558\uae30\uc5d0 \uc0ad\uc81c\n* bedrooms, bathrooms, floors, view, condition, grade \ubcc0\uc218\ub4e4\uc740 \ub370\uc774\ud130 \uac12\uc758 \ud06c\uae30\uc5d0 \ub530\ub978 \uc601\ud5a5\uc774 \uc788\ub2e4\uace0 \ud310\ub2e8\ud558\uc5ec label encoder\ub97c \uc801\uc6a9\ud574\uc8fc\ub3c4\ub85d \ud558\uaca0\uc2b5\ub2c8\ub2e4.\n* year, month, day, waterfront, zipcode, yr_built, yr_renovated \ubcc0\uc218\ub4e4\uc5d0 \ub300\ud558\uc5ec pandas \ub77c\uc774\ube0c\ub7ec\ub9ac \ub0b4 get_dummies \ud568\uc218\ub97c \uc774\uc6a9\ud558\uc5ec \ub354\ubbf8\ubcc0\uc218\ud654 \ud558\ub3c4\ub85d \ud558\uaca0\uc2b5\ub2c8\ub2e4.","7a79ce66":"* bedrooms\uc758 \uacbd\uc6b0, price\uc640 \uc5b4\ub290\uc815\ub3c4 \uc601\ud5a5\uc774 \uc788\ub294 \uac83\uc73c\ub85c \ubcf4\uc784. ","372e9b0c":"* date \ubcc0\uc218\ub294 \uc55e\uc758 8\uc790\ub9ac \uc678 T\ubd80\ud130\ub294 \ucc98\ub9ac\uac00 \ud544\uc694\ud574 \ubcf4\uc784.\n* zipcode\ub098 lat, long\uc744 \uae30\uc900\uc73c\ub85c \uc9c0\uc5ed\uba85\uc73c\ub85c \ub300\uccb4\ud574\ubcf4\uace0 \uc2f6\uae30\ub3c4 \ud558\uc9c0\ub9cc \uc2dc\ud5d8\ub54c \uc2dc\uac04\uad00\uacc4\uc0c1 \ubabb\ud560\uac70\uac19\uc73c\ub2c8 \uc5ec\uae30\uc11c\ub3c4 \uc81c\uc678","9ddb0676":"* sqft_basement\uac19\uc740\uacbd\uc6b0\ub3c4 \ub108\ubb34 \ud37c\uc838\uc788\uc74c.","b9553871":"* \uc804\ubc18\uc801\uc73c\ub85c sqft\ub07c\ub9ac \ud30c\uc0dd\ubcc0\uc218 \uc601\ud5a5\uc744 \ubcf4\uae34 \ud798\ub4e4\ub2e4","18a0d749":"* sqft_living15\uc758 \uacbd\uc6b0, \uc5b4\ub290\uc815\ub3c4 \uc601\ud5a5\uc131\uc774 \ubcf4\uc774\ub098 sqft_living\uc774 \ub354\uc6b1 \ub69c\ub837\ud574\ubcf4\uc784"}}