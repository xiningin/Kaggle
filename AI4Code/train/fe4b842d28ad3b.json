{"cell_type":{"3ded2b0b":"code","1136072f":"code","823665d3":"code","3a5c46c9":"code","da8f2b5c":"code","8d834a47":"code","90fc026f":"code","c4888c66":"code","431b573a":"code","96243538":"code","9ec41961":"code","cbb870e2":"markdown"},"source":{"3ded2b0b":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","1136072f":"import pandas as pd\nimport numpy as np","823665d3":"train_org    = pd.read_csv('..\/input\/new-york-taxi-fare-prediction\/train_data_org.csv')\ntest_org     = pd.read_csv('..\/input\/new-york-taxi-fare-prediction\/test.csv')\ny =            pd.read_csv('..\/input\/new-york-taxi-fare-prediction\/train_labels.csv') \ntrain_scaled = pd.read_csv('..\/input\/new-york-taxi-fare-prediction\/trained_scaled.csv')\ntest_scaled  = pd.read_csv('..\/input\/new-york-taxi-fare-prediction\/testdata_scaled.csv')","3a5c46c9":"train_org.head()","da8f2b5c":"import lightgbm as lgbm\n\nparams = {\n        'boosting_type':'gbdt',\n        'objective': 'regression',\n        'nthread': -1,\n        'verbose': 0,\n        'num_leaves': 31,\n        'learning_rate': 0.05,\n        'max_depth': -1,\n        'subsample': 0.8,\n        'subsample_freq': 1,\n        'colsample_bytree': 0.6,\n        'reg_aplha': 1,\n        'reg_lambda': 0.001,\n        'metric': 'rmse',\n        'min_split_gain': 0.5,\n        'min_child_weight': 1,\n        'min_child_samples': 10,\n        'scale_pos_weight':1     \n    }\n\nfrom sklearn.model_selection import train_test_split\nx_train,x_test,y_train,y_test = train_test_split(train_scaled,y,random_state=123,test_size=0.10)","8d834a47":"train_set = lgbm.Dataset(x_train, y_train, silent=False)\nvalid_set = lgbm.Dataset(x_test, y_test, silent=False)\nmodel = lgbm.train(params, train_set = train_set, num_boost_round=10000,early_stopping_rounds=500,verbose_eval=500, valid_sets=valid_set)","90fc026f":"predict = model.predict(test_scaled,num_iteration=model.best_iteration)\n#prediction = model.predict(df_test, num_iteration = model.best_iteration) ","c4888c66":"submission = pd.read_csv('..\/input\/new-york-city-taxi-fare-prediction\/sample_submission.csv')\ntest = pd.read_csv('..\/input\/new-york-city-taxi-fare-prediction\/test.csv')","431b573a":"submission = pd.DataFrame({\n        \"key\": test[\"key\"],\n        \"fare_amount\": predict\n      \n})\n\nsubmission.to_csv('taxi_fare_submission911.csv',index=False)","96243538":"submission.head()","9ec41961":"test.head()","cbb870e2":"# Prediction"}}