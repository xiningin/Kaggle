{"cell_type":{"f06c5666":"code","2433e66b":"code","d4be9e4a":"code","62bc3126":"code","e3969e75":"code","fe25feb8":"code","08ef69e2":"code","bfc9f44e":"code","def36956":"code","324c532e":"code","1b65cf29":"code","2720b335":"code","1d6ad9ce":"code","4abac49e":"code","e4f32963":"code","2c0e2125":"code","fa199ac5":"code","38c8c893":"code","d19d5210":"code","d440fc5d":"code","1af704bc":"code","92e97d83":"code","5b407ee0":"code","7f1fc387":"code","d8d641ac":"code","b0bfc03d":"code","59444371":"code","a49abc8b":"code","3c6de1e7":"code","231a972e":"code","8640e5f5":"code","2a571b96":"code","be5a6fe1":"code","65360d0c":"code","365f95ea":"code","aa72903a":"code","af4f19cd":"code","550f5917":"markdown","3a2872f3":"markdown","7085f18f":"markdown","90e9113b":"markdown","15b81335":"markdown","b47d5452":"markdown","f4a96c35":"markdown","0c39d1c0":"markdown","374c8d5d":"markdown","9fc56d58":"markdown","7ebe32a1":"markdown","db289ec1":"markdown","2d6bdf53":"markdown"},"source":{"f06c5666":"import pandas as pd\nimport numpy as np\nfrom plotnine import *","2433e66b":"artists = pd.read_csv('..\/input\/museum-collection\/artists.csv')\nartworks = pd.read_csv('..\/input\/museum-collection\/artworks.csv')","d4be9e4a":"artists['Gender'] = artists['Gender'].apply(lambda x:'Male' if x== 'male' else x)","62bc3126":"print('Artists lost data:')\nfor i in artists.columns:\n    print(i,f'{100*artists[i].isnull().sum()\/artists.shape[0]:.2f}%')\nprint('| | | | | | |')\nprint('| | | | | | |')\nprint('| | | | | | |')\nprint('Artworks lost data:')\nfor i in artworks.columns:\n    print(i,f'{100*artworks[i].isnull().sum()\/artworks.shape[0]:.2f}%')\n","e3969e75":"artists.head()","fe25feb8":"artists['Age'] = artists['Death Year'] - artists['Birth Year']","08ef69e2":"#We plot Age column vs Birth Year\nartists_no_missing = artists.dropna()\n(\n    ggplot(artists_no_missing)\n    +aes('Birth Year','Age')\n    +geom_point()\n    +ggtitle('The dependence of age on birth year')\n)","bfc9f44e":"artists.loc[artists['Age']>=100].sort_values(by=\"Age\",ascending=False).head(5)","def36956":"top_nationalities = list(artists_no_missing['Nationality'].value_counts()[0:5].index)","324c532e":"artists_nationalities = artists_no_missing[artists_no_missing['Nationality'].\\\n                                           isin(top_nationalities)]\n(\n    ggplot(artists_nationalities)\n    +aes(color='Nationality')\n    +aes('Birth Year','Age')\n    +geom_point()\n    #+stat_smooth()\n    +ggtitle('Dependence of age on nationality')\n)","1b65cf29":"#By plotnine we can easily divide the plot's part into the rows. Each row creating its own \n#layer.Here we plot Age vs Birth year based on Nationality factor.\n\n(\n    ggplot(artists_nationalities)\n    +aes(color='Nationality')\n    +aes('Birth Year','Age')\n    +geom_point()\n    #+stat_smooth()\n    + facet_wrap('~Nationality')\n    +ggtitle('Age and Birth year depdnence on nationality')\n)","2720b335":"(\n    ggplot(artists_nationalities)\n    +aes(color='Gender')\n    +aes('Birth Year','Age')\n    +geom_point()\n    #+stat_smooth()\n    + facet_wrap('~Gender')\n    +ggtitle('Age gender dependence')\n)","1d6ad9ce":"artists_nationalities_new = artists_no_missing[artists_no_missing['Nationality'].\\\n                                           isin(top_nationalities)]","4abac49e":"(\n    ggplot(artists_nationalities_new)\n    #+aes(color='Gender')\n    +aes('Gender',fill='Nationality')\n    #+aes('Birth Year','Age')\n    +geom_bar()\n    #+stat_smooth()\n    #+ facet_wrap('~Gender')\n    +ggtitle('Proportion of male and female artists based on nationality')\n)","e4f32963":"(\n    ggplot(artists_nationalities_new)\n    #+aes(color='Gender')\n    +aes('Gender','Age',fill='Gender')\n    #+aes('Birth Year','Age')\n    +geom_violin()\n    #+stat_smooth()\n    #+ facet_wrap('~Gender')\n    #+geom_point()\n    +ggtitle('Most found age of artists')\n)","2c0e2125":"(\n    ggplot(artists_no_missing)\n    +aes('Age',fill='Gender')\n    +facet_wrap('~Gender')\n    +geom_bar()\n    +ggtitle('Male and Female Counts')\n)","fa199ac5":"print(artists_no_missing['Age'].loc[artists_no_missing['Gender']=='Female'].mean())\nprint(artists_no_missing['Age'].loc[artists_no_missing['Gender']=='Male'].mean())","38c8c893":"artwork_columns = list(artworks.columns)\nartworks.shape","d19d5210":"for i in artworks.columns:\n    print(i,f'{100*artworks[i].isnull().sum()\/artworks.shape[0]:.2f}%')","d440fc5d":"artworks.drop(['Diameter (cm)','Circumference (cm)','Length (cm)',\\\n                             'Depth (cm)','Weight (kg)','Duration (s)'],axis =1,inplace = True)","1af704bc":"artworks['Classification'].value_counts()","92e97d83":"#Here I used the method of  Lj Miranda\n#https:\/\/www.kaggle.com\/ljvmiranda\/dimensions-of-2d-artworks-in-moma\n#We choose Photograph, Painting and Drawing class of artworks Classification feature and\n#will plot their characteristics\n\nartworks_photo = artworks[artworks['Classification']=='Photograph']\nartworks_painting = artworks[artworks['Classification']=='Painting']\nartworks_drawing = artworks[artworks['Classification']=='Drawing']\n\nall_2D = [artworks_photo,artworks_painting,artworks_drawing]\nartworks_2D = pd.concat(all_2D,axis = 0,ignore_index = True)","5b407ee0":"artworks_2D = artworks_2D[['Title','Classification','Height (cm)','Width (cm)']]\nartworks_2D = artworks_2D.rename(columns = {'Height (cm)':'Height','Width (cm)':'Width'})\nartworks_2D = artworks_2D.dropna()","7f1fc387":"artworks_2D[artworks_2D['Height']==0].shape\nartworks_2D['Height'].min()\nartworks_2D.isnull().sum()\nartworks_2D.head()","d8d641ac":"artworks_2D = artworks_2D[(artworks_2D.Width != 0) & (artworks_2D.Height != 0)]","b0bfc03d":"#Height and Width features have broad range. We will scale them by the decimal logarithm.\n# Plot \nratio =  np.log10(artworks_2D['Height'])\/np.log10(artworks_2D['Width'])\n#print(min(ratio))\nwidth = np.log10(artworks_2D['Width'])\n#print(min(width))\nartworks_2D['log_ratio'] = ratio\nartworks_2D['log_width'] = width\n# 4\/3\nfour_thirds = np.log10(4)\/np.log10(3)\nthree_fourths = np.log10(3)\/np.log10(4)","59444371":"(\n    ggplot(artworks_2D)\n    +aes('log_width','log_ratio',color='Classification')\n    +facet_wrap('~Classification')\n    +geom_point(show_legend = True)#color ='c')\n    #+scale_color_cmap(cmap_name='viridis')\n    +geom_hline(yintercept = 1, color='black')\n    +geom_hline(yintercept = three_fourths, color='purple')\n    +geom_hline(yintercept = four_thirds, color='purple')\n    +labs()\n    +xlim(0.5,3.5)  #Warning is because of axis limits we give\n    +ylim(0,5)\n    +ggtitle('Dimension of 2D artworks')\n)","a49abc8b":"# Code is taken from here \n#https:\/\/medium.com\/analytics-vidhya\/how-to-determine-the-optimal-k-for-k-means-708505d204eb","3c6de1e7":"from sklearn.cluster import KMeans\n\n# function returns WSS score for k values from 1 to kmax\ndef calculate_WSS(points, kmax):\n  sse = []\n  for k in range(1, kmax+1):\n    kmeans = KMeans(n_clusters = k).fit(points)\n    centroids = kmeans.cluster_centers_\n    pred_clusters = kmeans.predict(points)\n    curr_sse = 0\n    #print('k')\n    # calculate square of Euclidean distance of each point from its cluster center and add to current WSS\n    for i in range(len(points)):\n        curr_center = centroids[pred_clusters[i]]\n        #print(points[i, 1])\n        #print('k')\n        curr_sse += (points[i, 0] - curr_center[0]) ** 2 + (points[i, 1] - curr_center[1]) ** 2\n        #print('k')\n    sse.append(curr_sse)\n  return sse","231a972e":"print(calculate_WSS(np.array(artworks_2D[['log_width','log_ratio']]),15))","8640e5f5":"wss = [[5771.555393946746, 3768.0482355463746, 1853.333445240101, \\\n        1255.4784780958505, 929.4386468336834, 726.9918020824192, 601.4803151716745,\\\n        526.726248942173, 452.2677930553403, 401.4337739897589, 368.03253374178723, \\\n        336.26386585668473, 309.026796026544, 285.7220886081334, 264.3795627457794]]\nk = list(range(1,16))","2a571b96":"(\n    ggplot()\n    +aes(k,wss)\n    +geom_line()\n    #+scale_x_continuous(breaks = (k, n = 10))\n    +ggtitle('Elbow method')\n)","be5a6fe1":"from sklearn.metrics import silhouette_score\n\nsil = []\nkmax = 10\nx = np.array(artworks_2D[['log_width','log_ratio']])\n# dissimilarity would not be defined for a single cluster, thus, minimum number of clusters should be 2\nfor k in range(2, kmax+1):\n  kmeans = KMeans(n_clusters = k).fit(x)\n  labels = kmeans.labels_\n  sil.append(silhouette_score(x, labels, metric = 'euclidean'))","65360d0c":"(\n    ggplot()\n    +aes(list(range(2,11)),sil)\n    +geom_line()\n    #+scale_x_continuous(breaks = (k, n = 10))\n    +ggtitle('Silhouette method')\n)","365f95ea":"#Initialize the class object\nkmeans = KMeans(n_clusters= 3)\n \n#predict the labels of clusters.\nlabel = kmeans.fit_predict(x)\n \nartworks_2D['label'] = label","aa72903a":"#Here need to finish the plot of kmeans","af4f19cd":"#Getting unique labels\n \nu_labels = np.unique(label)\n \n#plotting the results:\n \nfor i in u_labels:\n    plt.scatter(artworks_2D[label == i , 0] , artworks_2D[label == i , 1] , label = i)\nplt.legend()\nplt.show()","550f5917":"## Clustering","3a2872f3":"Some people lived more than 100 years. Who are they?","7085f18f":"6 features don't have more than 91% of data. Let's drop them.","90e9113b":"In this work I'll train some plotnine techniques. May be you will learn something from here too.","15b81335":"### We can define what sex at what age dies more. We will need to define top countries again after that.","b47d5452":"### Prediction","f4a96c35":"We can see that Union Paper Bag Machine Company existed for 130 years. Then we have artists, who also lived a long life.","0c39d1c0":"## Artworks set","374c8d5d":"## Let's work with artists table","9fc56d58":"What if we want to see the plot with hue of top nationalities?","7ebe32a1":"#### Elbow method","db289ec1":"#### As it's not completely seen, we'll also use Silhouette method","2d6bdf53":"#### As we see the average age of female artists is 3.03 years longer than of male ones."}}