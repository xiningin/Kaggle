{"cell_type":{"d7aa8d58":"code","fd3cb3d9":"code","80cd2e04":"code","b97f24a2":"code","3723b1bc":"code","fbcb3cd1":"code","9f65df9f":"code","977cb8ca":"code","86931596":"code","1bbdf4ba":"code","3011258b":"code","bc600f7f":"code","08395e77":"code","75ed04c0":"code","de5ba789":"code","63cd0644":"code","e1cba0c3":"code","9389800a":"code","df74a9b3":"code","f472a7eb":"code","8e89ca88":"code","9b60ebec":"markdown","46455764":"markdown","a32f9405":"markdown","75f6c37e":"markdown"},"source":{"d7aa8d58":"import pandas as pd\nimport numpy as np\nimport holoviews as hv\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nhv.extension('bokeh')\n","fd3cb3d9":"!pip install hvplot\n#!pip install pyzmq\n#!pip install --upgrade pip\n#!pip install -- pyzmq==17.0.0\n#!conda install -c conda-forge pyzmq--y","80cd2e04":"import hvplot.pandas\nimport os\nimport glob\nimport panel as pn\nimport xarray as xr\nimport hvplot.xarray  \nfrom hvplot import hvPlot\n\n\n\n%matplotlib inline","b97f24a2":"for dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","3723b1bc":"data=pd.read_csv('\/kaggle\/input\/data-analyst-jobs\/DataAnalyst.csv', na_values=\"-1\")\n#data = pd.read_csv(\"DataAnalyst.csv\", na_values=\"-1\")\ndata = data.drop(columns=\"Unnamed: 0\", axis=1)\n\n##---------Salary-----------##\n\ndata[[\"Salary\", \"Source\"]]=data[\"Salary Estimate\"].str.split(\" \",n=1, expand=True)\ndata[[\"Min Salary\", \"Max Salary\"]]=data[\"Salary\"].str.split(\"-\", n=2, expand=True)\n\ndata = data.drop([\"Salary\", \"Salary Estimate\"], axis=1)\n\ndata[\"Min Salary\"]= data[\"Min Salary\"].str.replace(\"K\", \"000\").str.replace('$', '').astype(float)\ndata[\"Max Salary\"]= data[\"Max Salary\"].str.replace(\"K\", \"000\").str.replace('$', '').astype(float)\n\ndata[\"Source\"] = data[\"Source\"].str.replace(\"(Glassdoor est.)\", \"Glassdoor\")\n\n##---------Company Name-----------##\n\ndata[\"Company Name\"]=data[\"Company Name\"].str.split(\"\\n\", n=2).str[0]\n\n##---------Location & Headquarters-----------##\n\ndata[[\"Location City\", \"Location Abb\"]]=data[\"Location\"].str.split(\",\", n=1, expand=True)\ndata=data.drop([\"Location\"], axis=1)\n\ndata[[\"Headquarter City\", \"Headquarter Abb\"]]=data[\"Headquarters\"].str.split(\",\", n=1, expand=True)\ndata=data.drop([\"Headquarters\"], axis=1)\n\n##---------Company Size-----------##\n\ncompany_size=data[\"Size\"].str.split(n=3, expand=True)\ndata[\"Min Company Size, employees\"]=(company_size[0]\n    .replace(\"10000+\",\"10000\")\n    .replace(\"Unknown\",np.nan)\n    .astype(float)\n)\ndata[\"Max Company Size, employees\"]=company_size[2].replace({None:np.nan}).astype(float)\ndata=data.drop(\"Size\", axis=1)\n\n##---------Founded & Ownership-----------##\n\ndata[\"Founded\"]=data[\"Founded\"].astype('Int64')\ndata[\"Type of ownership\"]=data[\"Type of ownership\"].replace(\"Unknown\",np.nan)\n\n##---------Revenue---------------##\ndata[\"Revenue\"] = data[\"Revenue\"].replace('Unknown \/ Non-Applicable', np.nan)\nrevenues=pd.CategoricalDtype(categories=[\n'Less than $1 million (USD)', '$1 to $5 million (USD)','$5 to $10 million (USD)','$10 to $25 million (USD)','$25 to $50 million (USD)','$50 to $100 million (USD)','$100 to $500 million (USD)',\n'$500 million to $1 billion (USD)','$1 to $2 billion (USD)','$2 to $5 billion (USD)','$5 to $10 billion (USD)','$10+ billion (USD)'\n],ordered=True\n)\ndata[\"Revenue\"]=data[\"Revenue\"].astype(revenues)\n\n##---------Easy Apply---------------##\n\ndata[\"Easy Apply\"]=data[\"Easy Apply\"].replace({\"True\":True, pd.NA:False})\ndata = data[['Job Title', 'Job Description', 'Min Salary', 'Max Salary', 'Rating', \"Company Name\", \"Location City\", \"Location Abb\", \"Headquarter City\",\"Headquarter Abb\", \"Founded\", \"Type of ownership\",\"Industry\",\"Sector\", \"Revenue\", \"Competitors\",\"Easy Apply\",\"Source\"]]\n\ndata.head()","fbcb3cd1":"#data[\"Max Salary\"].hist()\n\nsns.distplot(data[\"Max Salary\"])","9f65df9f":"#Which top 10 Job Titles has the most salary?\ndata[\"Max Salary\"].describe()\n#Maximum Salary is 190000","977cb8ca":"## What is the median max salary for each industry\nmedian_salary_high=(data\n.groupby(\"Industry\")\n [[\"Min Salary\", \"Max Salary\", \"Rating\"]]\n.median()\n.sort_values(by=\"Max Salary\", ascending=False)\n.head(10)\n)\nmedian_salary_high","86931596":"## Q2: What is the median min salary for each industry\nmedian_salary_low=(data\n.groupby(\"Industry\")\n [[\"Min Salary\", \"Max Salary\", \"Rating\"]]\n.median()\n.sort_values(by=\"Max Salary\", ascending=True)\n.head(10)\n)\nmedian_salary_low","1bbdf4ba":"plot_max_salary=median_salary_high.hvplot.bar(x=\"Industry\", y=\"Max Salary\", stacked=True, rot=90, width=800, height=400)\nplot_min_salary=median_salary_low.hvplot.bar(x=\"Industry\", y=\"Max Salary\", stacked=True, rot=90, width=800, height=400)\nplot_max_salary*plot_min_salary","3011258b":"median_job_title_high=(data\n.groupby(\"Job Title\")\n [[\"Min Salary\", \"Max Salary\"]]\n.median()\n.sort_values(by=\"Max Salary\", ascending=False)\n.head(10)\n)\nmedian_job_title_high\n\n","bc600f7f":" ## Min Salary of the Maximum salary is 38 000\nmedian_job_title_low=(data\n.groupby(\"Job Title\")\n[[\"Min Salary\", \"Max Salary\"]]\n.median()\n.sort_values(by=\"Max Salary\", ascending= True)\n.head(10)\n)\nmedian_job_title_low\n","08395e77":"plot1=median_job_title_high.hvplot.bar(x=\"Job Title\", y=\"Max Salary\", stacked=True, rot=45, width=800, height=500, title=\"Job Titles with the highest salary\")\nplot2=median_job_title_low.hvplot.bar(x=\"Job Title\", y=\"Max Salary\", rot=45, stacked=True, width=1000, height=500, title = \"Job titles with the lowest salary\")\nplot1*plot2","75ed04c0":"# Q3: Which US States have more Data Analyst jobs\n","de5ba789":"salary_high=data[\"Max Salary\"]>=190000\n(data[salary_high]\n.groupby(\"Location City\")\n[[\"Min Salary\", \"Max Salary\"]]\n.median()\n.sort_values(by=\"Max Salary\", ascending=True)\n.head(10)\n)\n","63cd0644":"# Q4: Which Company Names have the highest salary for Data Analyst jobs\n","e1cba0c3":"(data[salary_high]\n.groupby(\"Company Name\")\n[[\"Min Salary\", \"Max Salary\"]]\n.median()\n.sort_values(by=\"Max Salary\", ascending=True)\n.head(10)\n)\n\n","9389800a":"#Q5: Which Type of organization have the maximum salara\ntype_high=(data[salary_high]\n.groupby(\"Type of ownership\")\n[[\"Min Salary\", \"Max Salary\"]]\n.median()\n.sort_values(by=\"Max Salary\", ascending=True)\n.head(10)\n)","df74a9b3":"#Q6: Which Type of organization have the minimum salara\ntype_low=(data\n.groupby(\"Type of ownership\")\n[[\"Min Salary\", \"Max Salary\"]]\n.median()\n.sort_values(by=\"Max Salary\", ascending=True)\n.head(10)\n)","f472a7eb":"high_plot=type_high.hvplot.bar(x=\"Type of ownership\", y=\"Max Salary\", stacked=True, rot=45, width=800, height=500, title=\"Type of ownership: low or high salary\")\nlow_plot=type_low.hvplot.bar(x=\"Type of ownership\", y=\"Max Salary\", stacked=True, rot=45, width=800, height=500, title=\"Type of ownership: low or high salary\")\nhigh_plot*low_plot","8e89ca88":"## Q7: Rating\n(data[salary_high]\n.groupby(\"Job Title\")\n[[\"Rating\",\"Max Salary\"]]\n.median()\n.sort_values(by=\"Rating\", ascending=False)\n.head(10)\n)\n\n","9b60ebec":"### Industries that pay a lot to data analysts are Gambling, Educational Trianing Services, Health Care, BioTech & Pharmaceuticals\n### Industries that pay the least are Trucking, Memberschip Organizations, Audiovisuals and Grocery Stores","46455764":"\n\n## Show 10 TOP INDUSTRIES with the highest maximum salary and TOP 10 Industries with the lowest maximum salary?","a32f9405":"## Summary\n\n- Type of ownership that pay a lot are Prive and Public companies, the lowest are Self-Employed and government\n- Alteryx, Ursus, Tesla Motors, Talent Burst, Risk Management Solutions, Randstad, OSI engineering, Nuro, Netflix, NVIDIA Pay the most\n- Those cities like Cupertino, Fremont, Los Gatos, Menio Park, Mountain View, Newark, Palo Alto, Redwood City, San Jose, Santa Clara have the highest salary\n- Job titles such as Compensation & HR Data Analyst,  Data Expert Analyst\/Modeler, XYZ Data Analyst, Data Analyst & Healthcare Analytics, Business Analyst Data Governance\thave the least salary\n- Job titles as AI Insights Data Analyst, Tableau Data Analyst Intern, Sr. Data Analyst - Growth & Adoption\t, Data Analyst, Product Insights, Senior Data Analyst Studio Finance Engineering\t have the highest salary\n- The highest job rankings are for AI Insights Data Analyst, Senior HR Data Analyst, Data Analyst (SQL, Hive)\n","75f6c37e":"# Question 2: Which Job Titles have the highest Salary"}}