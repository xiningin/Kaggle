{"cell_type":{"8ca3c4ae":"code","45f70d3b":"code","3f786b90":"code","6e62802d":"code","2b61164a":"code","641c0c89":"code","7ab54e7a":"code","aff77e23":"code","c8eaae3c":"code","79ae8ca7":"code","3583bc47":"code","f7125660":"code","732fa08e":"markdown","e202fe1f":"markdown","cc6c40af":"markdown","9eaca219":"markdown","23466643":"markdown","f1476a8b":"markdown","f8e0df87":"markdown"},"source":{"8ca3c4ae":"# Setup\nimport os\nimport numpy as np\nimport pandas as pd\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom plotly.offline import download_plotlyjs, init_notebook_mode, plot, iplot\nimport cufflinks as cf\ninit_notebook_mode(connected=True)\ncf.go_offline()\n%matplotlib inline","45f70d3b":"# Data file\npath = '..\/input\/market-price-of-onion-2020\/Onion Prices 2020.csv'\n\n# Reading data\nData = pd.read_csv(path)\nData.head()","3f786b90":"# Extracting Date & Month from arrival_date\nData['Month'] = Data['arrival_date'].apply(lambda x :x.split('\/')[1])\nData['Date'] = Data['arrival_date'].apply(lambda x :x.split('\/')[0])","6e62802d":"Data.head()","2b61164a":"# So let's determine the shape of our data.\n# Will also check for null values\n\nprint('Data Info :\\n\\tRow Count - {r:}\\n\\tColumn Count - {c:}\\n\\tNull Values - {n:}'.format(r=Data.shape[0],\n                                            c=Data.shape[1], n=Data.isna().sum().sum()))\n\n# Lets check for number of unique values for all categorical columns.\nprint('\\nValue Count :')\nfor category in ['state', 'district', 'market', 'commodity', 'variety']:\n    print(\"\\t'{c:}s' mentioned : {n:}\".format(c=category.title(), n=Data[category].nunique()))","641c0c89":"# Min, Max & Modal Price Distribution\nplt.figure(figsize=(12, 5))\nsns.set_style('darkgrid')\nsns.distplot(a=Data['min_price'], bins=80, color='green', hist=False, label='Minimum Price')\nsns.distplot(a=Data['max_price'], bins=80, color='red', hist=False, label='Maximum Price')\nsns.distplot(a=Data['modal_price'], bins=80, color='orange', hist=False, label='Modal Price')\nplt.title('Various Price Distributions')\nplt.xlabel('Price')\nsns.despine()","7ab54e7a":"# As we saw that onion prices were zero. let's explore more into it\nprint('Zero \u20b9 Onion Prices :\\n\\tState Count : {c:}\\n\\tState List : {s:}\\n\\tVariety List : {v:}\\n'.format(c=Data[Data['min_price']==0]['state'].nunique(),\n                                                                            s=list(Data[Data['min_price']==0]['state'].unique()),\n                                                                            v=list(Data[Data['min_price']==0]['variety'].unique())))\n\n\n# Also consider onion price to be 18000\u20b9\/Quintal. \nprint('18000\u20b9\/Q Onion Price :\\n\\tState Count : {c:}\\n\\tState List : {s:}\\n\\tVariety List : {v:}'.format(c=Data[Data['min_price']==18000]['state'].nunique(),\n                                                                            s=list(Data[Data['min_price']==18000]['state'].unique()),\n                                                                            v=list(Data[Data['min_price']==18000]['variety'].unique())))","aff77e23":"# Bar Plot\n# X-axis : Months\n# Y-axis : Price\n\nfig, axes = plt.subplots(nrows=11, ncols=2, figsize=(20, 60), sharey=True)\nfig.suptitle(\"Average Onion Price in States for each month of Year 2020\", fontsize=24)\nsns.set_style(\"darkgrid\")\n\nstates_list = Data['state'].unique()     # List of all States\nrows = [x for x in range(0, 11)]\ncols = [0]\ncount = 1\n\nfor state in states_list:\n    # bar plot\n    state_fig = Data.groupby(['state', 'Month']).mean().xs(state).plot(kind='bar',ax=axes[rows[0], cols[0]])\n    state_fig.set_title(state, fontdict={'fontsize': 20, 'color' : 'red'})\n    state_fig.set_xticklabels(labels=state_fig.get_xticklabels(), rotation=360)\n    \n    # column switch\n    if cols[0] == 0:\n        cols[0] = 1\n    else :\n        cols[0] = 0\n        \n    # rows switch\n    count += 1\n    if count > 2:\n        rows.pop(0)\n        count = 1\n    \n    fig.tight_layout()\n    fig.subplots_adjust(top=0.96)","c8eaae3c":"# Line Plot\n# X-axis : Arrival Dates\n# Y-axis : Price\n\nfig, axes = plt.subplots(nrows=22, ncols=1, figsize=(20, 100))\nfig.suptitle(\"Average Onion Price in States on Arrival in Year 2020\", fontsize=24)\nsns.set_style(\"darkgrid\")\n\nstates_list = Data['state'].unique()     # List of all States\nrows = [x for x in range(0, 22)]\ncount = 1\n                                                \nfor state in states_list:\n    # bar plot\n    state_fig = Data.sort_values(by=['Month', 'Date']).groupby(['state','arrival_date'], sort=False).mean().xs(state).reset_index().plot(kind='line',\n                                                                        ax=axes[rows[0]], x='arrival_date', marker='o', markersize=3, markerfacecolor='black')\n    state_fig.set_title(state, fontdict={'fontsize': 20, 'color' : 'red'})\n    state_fig.set_xticklabels(labels=state_fig.get_xticklabels(), rotation=360)\n    \n    # rows switch\n    rows.pop(0)\n    \n    fig.tight_layout()\n    fig.subplots_adjust(top=0.96)","79ae8ca7":"# States with Minimum Prices less than or equal to 500\u20b9\/Quintal\nstates = Data[Data['min_price'] <= 500]['state'].unique()\nprint('States with min. price <= 500\u20b9')\nfor state in states:\n    print('\\t{s:}.'.format(s=state.title()))\n#Data[(Data['min_price'] <= 500) & (Data['state']=='Andhra Pradesh')]['Month'].unique()","3583bc47":"# Box Plot : Variety of Onions wrt Prices\n# Count Plot : Variety of Onions wrt State\n\n\nfig, axes = plt.subplots(nrows=21, ncols=2, figsize=(20, 100))\nfig.suptitle(\"Variety of Onions & relation wrt Prices & State\", fontsize=24)\nsns.set_style(\"darkgrid\")\n\nvariety_list = Data['variety'].unique()   # List of all onion variety\nrows = [x for x in range(0, 21)]\ncols = [0]\n                                                \nfor variety in variety_list: \n    # box plot\n    box_plot = sns.boxplot(data=Data[Data['variety']==variety][['min_price', 'max_price', 'modal_price']], ax=axes[rows[0], cols[0]])\n    box_plot.set_title(variety, fontdict={'fontsize': 20, 'color' : 'red'})\n    box_plot.set_xticklabels(labels=box_plot.get_xticklabels(), rotation=360)\n    \n    # cols switch for count plot\n    cols[0] = 1\n    \n    # count plot\n    count_plot = sns.countplot(Data[Data['variety']==variety]['state'], ax=axes[rows[0], cols[0]])\n    count_plot.set_title(variety, fontdict={'fontsize': 20, 'color' : 'red'})\n    count_plot.set_xticklabels(labels=count_plot.get_xticklabels(), rotation=25, fontdict={'fontsize': 8})\n    \n    # rows & cols switch for box plot\n    rows.pop(0)\n    cols[0] = 0\n    \n    fig.tight_layout()\n    fig.subplots_adjust(top=0.96)","f7125660":"# Percentage change in prices between arrival days\n\nfig, axes = plt.subplots(nrows=22, ncols=1, figsize=(20, 100))\nfig.suptitle(\"Percentage Change in Average Onion Price in States considering Arrivals in Year 2020\", fontsize=24)\nsns.set_style(\"darkgrid\")\n\nstates_list = Data['state'].unique()     # List of all States\nrows = [x for x in range(0, 22)]\ncount = 1\n                                                \nfor state in states_list:\n    # bar plot\n    state_fig = Data.sort_values(by=['Month', 'Date']).groupby(['state','arrival_date'], sort=False).mean().xs(state).pct_change().reset_index().plot(kind='line',\n                                                                        ax=axes[rows[0]], x='arrival_date', marker='o', markersize=3, markerfacecolor='black')\n    state_fig.set_title(state, fontdict={'fontsize': 20, 'color' : 'red'})\n    state_fig.set_xticklabels(labels=state_fig.get_xticklabels(), rotation=360)\n    \n    # rows switch\n    rows.pop(0)\n    \n    fig.tight_layout()\n    fig.subplots_adjust(top=0.96)\n\n","732fa08e":"# ***States, Arrival Dates & Prices***\n- We will be analysing ***Onion Prices Situation*** on their **Arrival in Market** in **each State Seperately**\n\n\n- **Conclusion :**\n    - a. **14 States out of 22** have seen huge **downfall in Minimum prices** for multiple times. This list includes **'Andhra Pradesh', 'Gujarat', 'Haryana', 'Karnataka', 'Kerala', 'Madhya Pradesh', 'Maharashtra', 'NCT of Delhi', 'Odisha','Punjab', 'Rajasthan', 'Telangana', 'Uttar Pradesh' & 'Uttrakhand'**. Minimum prices were as **low as 500\u20b9\/Quintal to Zero**.\n    - b. **Note** that in case of **Nagaland**, the data has constant values for Jan. & Feb. that's the reason for a straight hoizontal line. ","e202fe1f":"# Variety, Prices & States\n- We will be relation between **variety & prices** using **box plot**\n- Also relation between **variety & states** using **count plot**\n\n\n\n- **Conclusion :**\n    - a. **Small Onions** were highly **expensive variety** of onions. Their Average price is almost **5000\u20b9\/Quintal** & arrived most in **Kerala Markets**.\n    - b. Onion Varities like **'Local, Other, Onion, Nashik, White, 1st Sort, Pusa-Red, Bombay UP'** are most preferred varities in many states.\n    - c. where as, varities like **'Puna, Telagi, Big, 2nd Sort, Pole, Dry FAQ, Medium'** are preferred in just one state or more","cc6c40af":"# ***Min, Max, Model Prices*** \n- We will have some look at **distribution plots** for onion prices.\n- **Conclusion :**\n    - a. There was a situation when ***onion price was Zero. Yes 0.*** And rised ***upto 18000 \u20b9\/Quintal minimum price.*** This would be due to ***'demand supply gap'*** We will explore this section further considering arrival dates into account. \n    - b. The prices are quite ***stable around 2000\u20b9\/Quintal*** i.e most of the time the market price was 2000\u20b9. We will also see this timezone. \n    - c. All three prices category will be highly correlated with each other which is quite obvious. ","9eaca219":"Before we go indepth, \n- lets check for row & column count & also null values.\n- also number of 'States, Districts, Markets, Commodity & Variety' mentioned in data.","23466643":"# Percentage Change in Avg. Onion Prices considering Arrival Dates","f1476a8b":"- If you found this notebook to be helpful, a **like** would be appreciated.\n- **Thank You :)**","f8e0df87":"# ***States, Month & Prices***\n- We will be analysing ***Onion Prices Situation*** for every month in **each State Seperately**\n\n\n- **Conclusion :**\n    - a. The Onion prices were **extremely high in January 2020** for every state. Highest Recorded Prices were in **Kerala & Nagaland** with **+7000 \u20b9\/Quintal**. The **main reason** for rise in price was **damage to the onion crop due to rains.**\n    - b. Then came the saviour **Rabi Season Onion crops (70% of total crops produced in a year) in month of March** in markets all over India and thus prices started to fall back to normal and were **lowest in month of May & June** for almost every State.\n    - c. Finally came ***Monsoon***. *Monsoon Rain damaged* the stored **Rabi crops** that support market demand till August-October & also **Early Kharif crops (20% of total crops produced in a year)** in farms in most of the Indian States causing a **huge Demand-Supply Gap** in every market and thus the prices have again started to rise.\n    - d. ***Most Important Conclusion*** : The **Major onion producing States** like Maharashtra, Madhya Pradesh, Karnataka, Gujarat, Rajasthan & few others will **always suffer less** than other **States where onion is not suitable** to grow for many reasons like Nagaland, Kerala, Tripura, Himachal Pradesh, Odisha & few more **when Onion production decreases.** \n       \n    \n- **Source** :\n    - 01. https:\/\/theprint.in\/india\/onion-prices-surge-to-rs-165-per-kg-govt-promises-imports-by-january-2020\/331628\/#:~:text=The%20main%20reason%20for%20rise,Maharasthra%2C%20the%20key%20growing%20state.&text=To%20boost%20supply%20and%20contain%20price%20rise%2C%20the%20government%20has,expected%20to%20arrive%20mid%2DJanuary.\n    - 02. https:\/\/theprint.in\/opinion\/how-india-can-ensure-onions-are-all-through-year-at-good-price\/334477\/#:~:text=There%20are%20three%20sowing%20seasons,harvested%20in%20March%2DMay).\n    - 03. https:\/\/theprint.in\/india\/onion-prices-could-touch-rs-100-kg-by-oct-as-heavy-rain-damaged-early-kharif-crop-rabi-stock\/499990\/#:~:text=New%20crop%20expected%20in%20November&text=Singh%20said%20retail%20prices%20may,to%20arrive%20only%20in%20November%E2%80%9D.&text=The%20rise%20in%20prices%20is,the%20major%20onion%20producing%20regions."}}