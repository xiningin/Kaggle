{"cell_type":{"a27fb980":"code","cd9d5bb9":"code","ad68c93f":"code","dd52c075":"code","bec3a852":"code","ecf329b4":"code","46cc5923":"code","b0969dc9":"code","9b7fe61b":"code","f355a84a":"code","65002602":"code","fa4a9c95":"code","5566d69d":"code","71d9d273":"code","9d4629d6":"code","39991210":"code","5da6d687":"code","c8bcae4f":"code","9832c94e":"code","e5966bc4":"code","80a42365":"code","602aee53":"code","b304db65":"code","a8d680ff":"code","9417672b":"markdown","f89be5e7":"markdown","76de8f3a":"markdown","9730ed85":"markdown","c5703c14":"markdown","ce249c99":"markdown","e96b556b":"markdown","c4042a0c":"markdown","b5daa668":"markdown","adb12c97":"markdown","aadb31f1":"markdown"},"source":{"a27fb980":"import pandas as pd\nimport os\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nsns.set()\n\nimport warnings\nwarnings.filterwarnings('ignore')","cd9d5bb9":"df_train = pd.read_csv('..\/input\/feedback-prize-2021\/train.csv')\ndf_train.head()","ad68c93f":"# fetching all the labels\nlist(df_train['discourse_type'].unique())","dd52c075":"# checking count of all the labels\ndf_train['discourse_type'].value_counts()","bec3a852":"# The Hated Pie Chart\ncolors = sns.color_palette('pastel')[0:5]\nplt.figure(figsize=(16,9))\n\nplt.pie(x=df_train.discourse_type.value_counts(), labels = df_train.discourse_type.unique(), colors = colors, autopct='%.0f%%')\nplt.show()","ecf329b4":"# the classic bar plot\nplt.figure(figsize=(12,6))\ndf_train['discourse_type'].value_counts().plot(kind='bar')\nplt.show()","46cc5923":"# total discourses (sentences)\nprint(f\"The total number of text segments are {len(df_train)}.\")","b0969dc9":"# number of text files\/ essays available for training\nprint(f\"There are {len(df_train['id'].unique())} essays.\")\n","9b7fe61b":"df_train['len_word'] = df_train['discourse_text'].apply(lambda x: len(x.split()))","f355a84a":"df_train.head()","65002602":"# Category wise Dataframes\ndf_lead = df_train.loc[df_train[\"discourse_type\"]=='Lead']\ndf_claim = df_train.loc[df_train[\"discourse_type\"]=='Claim']\ndf_evidence = df_train.loc[df_train[\"discourse_type\"]=='Evidence']\ndf_position = df_train.loc[df_train[\"discourse_type\"]=='Position']\ndf_concluding = df_train.loc[df_train[\"discourse_type\"]=='Concluding Statement']\ndf_rebuttal = df_train.loc[df_train[\"discourse_type\"]=='Rebuttal']\ndf_counterclaim = df_train.loc[df_train[\"discourse_type\"]=='Counterclaim']\n\n","fa4a9c95":"# Lead\nplt.figure(figsize=(16,9))\nprint(\"mean of word lengths: \",df_lead.len_word.mean())\nsns.distplot(df_lead['len_word'],  color=\"b\")\nplt.show()","5566d69d":"# Claim\nplt.figure(figsize=(16,9))\nprint(\"mean of word lengths: \",df_claim.len_word.mean())\nsns.distplot(df_claim['len_word'],  color=\"b\")\nplt.show()","71d9d273":"# Evidence\nplt.figure(figsize=(16,9))\nprint(\"mean of word lengths: \",df_evidence.len_word.mean())\nsns.distplot(df_evidence['len_word'],  color=\"b\")\nplt.show()","9d4629d6":"# Position\nplt.figure(figsize=(16,9))\nprint(\"mean of word lengths: \",df_position.len_word.mean())\nsns.distplot(df_position['len_word'],  color=\"b\")\nplt.show()","39991210":"# Concluding Statement\nplt.figure(figsize=(16,9))\nprint(\"mean of word lengths: \",df_concluding.len_word.mean())\nsns.distplot(df_concluding['len_word'],  color=\"b\")\nplt.show()","5da6d687":"# Rebuttal\nplt.figure(figsize=(16,9))\nprint(\"mean of word lengths: \",df_rebuttal.len_word.mean())\nsns.distplot(df_rebuttal['len_word'],  color=\"b\")\nplt.show()","c8bcae4f":"# Counterclaim\nprint(\"mean of word lengths: \",df_counterclaim.len_word.mean())\nplt.figure(figsize=(16,9))\nsns.distplot(df_counterclaim['len_word'],  color=\"b\")\nplt.show()","9832c94e":"# loading the text files into a dataframe\ndata = []\nsrc_path = '\/kaggle\/input\/feedback-prize-2021\/train'\nfor elem in os.listdir(src_path):\n    with open(os.path.join(src_path,elem)) as f:\n        text = f.readlines()\n    data.append({'id': elem[:-4], 'text':''.join(text)})\n    \ndf_text = pd.DataFrame(data)\n","e5966bc4":"len_words = []\nfor elem in list(df_text['text']):\n    len_words.append(len(elem.split(' ')))","80a42365":"df_text['len_words'] = len_words","602aee53":"df_text.head()","b304db65":"# distribution of word lengths per essay\nplt.figure(figsize=(16,9))\ndf_text['text'].apply(lambda x: len(x.split())).hist(bins=30)\nplt.show()","a8d680ff":"print(\"Average word length per essay: \", df_text.len_words.mean())","9417672b":"### Word Lengths forr each text file\/essay","f89be5e7":"### Up Next:\n- Advanced EDA\n- Baseline training code\n- Baseline inference code\n- Beating the Baseline\n\n**If you like it so far, consider upvoting \ud83d\ude04** \n\n<img src=\"https:\/\/media.giphy.com\/media\/eunrMjB8lBUKeL1fqD\/giphy-downsized.gif\">","76de8f3a":"## Looking at the text files","9730ed85":"## The Actual First glance \ud83d\udc40\nLoading the training data","c5703c14":"\nIn this notebook, we will take a first glance at the competition and perform preliminary EDA to gain some insights.\n\n**Aim of the competition:**\nThe use case this competition targets is annotating different parts of the essays into 7 different categories to help the students with their writing abilities. The categories are as follows:\n* Lead\n* Position\n* Evidence\n* Claim\n* Concluding Statement\n* Counterclaim\n* Rebuttal\n\n**Evaluation Metric:**\n\n> Submissions are evaluated on the overlap between ground truth and predicted word indices.\n> 1. For each sample, all ground truths and predictions for a given class are compared.\n> 2. If the overlap between the ground truth and prediction is >= 0.5, and the overlap between the prediction and the ground truth >= 0.5, the prediction is a match and considered a true positive. If multiple matches exist, the match with the highest pair of overlaps is taken.\n> 3. Any unmatched ground truths are false negatives and any unmatched predictions are false positives\n\nThe final score is arrived at by calculating a micro F1 score for each class, then taking the mean across all classes.\n\n<img src=\"https:\/\/media.giphy.com\/media\/3oxOCtREZeCtTGExEc\/giphy.gif\">","ce249c99":"### Lable Wise Stats","e96b556b":"### Distribution of essay word lengths ","c4042a0c":"## Time to gear up! : Lets Import","b5daa668":"**To Note:**\n- Class Imbalance \n- Low Support for the classes: Lead, Counterclaim and Rebuttal   ","adb12c97":"### Label Distribution","aadb31f1":"### Training Data Stats"}}