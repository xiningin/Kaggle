{"cell_type":{"4bd95fc5":"code","e64aa0de":"code","3b25dc97":"code","5313f7b1":"code","9b9cc4a2":"code","6a9d7260":"code","9d7d3857":"code","8d31e35a":"code","02800ac6":"code","87c89be6":"code","9e07d025":"code","9e4a210c":"code","730bec24":"code","99d51bc9":"code","ffa60bdf":"code","dcaa5630":"code","319722b5":"code","004ce591":"code","6f042cbe":"code","d844e9ee":"code","ec141989":"code","4e75b299":"code","ab2d349d":"code","e0c8026e":"code","922a6b59":"code","315d020d":"code","d819d541":"code","f762a77b":"code","bcae5d7a":"code","48341009":"code","770a121c":"code","c835d12d":"code","4a1d4bc3":"code","13f2b152":"code","9502d065":"code","5620a7b2":"code","b3bde149":"code","9a499035":"markdown"},"source":{"4bd95fc5":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\n\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","e64aa0de":"dir = '\/kaggle\/input\/mlb-player-digital-engagement-forecasting'","3b25dc97":"train_df = pd.read_csv('\/kaggle\/input\/mlb-player-digital-engagement-forecasting\/train.csv')\ntrain_df.head()","5313f7b1":"train_df.tail()","9b9cc4a2":"# https:\/\/www.kaggle.com\/chumajin\/eda-of-mlb-for-starter-english-ver\n# Helper function to unpack json found in daily data\ndef unpack_json(json_str):\n    return np.nan if pd.isna(json_str) else pd.read_json(json_str)","6a9d7260":"# \uac01 dataFrame(targets_n)\uc758 index\ub97c playerId\ub85c \ubcc0\ud658\ud558\ub294 \ud568\uc218\n\ndef playerId_to_index(dataFrame):\n    dataFrame.index = dataFrame['playerId']\n    dataFrame.drop(['playerId'], axis = 1, inplace = True)\n    return dataFrame","9d7d3857":"# \ub0a0\uc9dc \ubcc4 targets_n \uc744 \ub9cc\ub4e4\uc5b4 \ub0b4\ub294 \ud568\uc218\ndef make_targets_df(train_df, start, end):\n    for i in range(start,end):\n        dataFrame = unpack_json(train_df['nextDayPlayerEngagement'].iloc[i])\n        dataFrame = playerId_to_index(dataFrame)\n        if i == start :\n            targets_df = dataFrame\n        else :\n            targets_df = pd.merge(targets_df, dataFrame, how='outer',on='playerId')\n        if i%5 == 0:\n            print(i)\n    return targets_df","8d31e35a":"targets_df_0_100 = make_targets_df(train_df,0,100)","02800ac6":"targets_df_0_100.to_csv('targets_df_0_100.csv')","87c89be6":"targets_df_100_200 = make_targets_df(train_df,100, 200)","9e07d025":"targets_df_100_200.to_csv('targets_df_100_200.csv')","9e4a210c":"targets_df_200_300 = make_targets_df(train_df, 200, 300)","730bec24":"targets_df_200_300.to_csv('targets_df_200_300.csv')","99d51bc9":"targets_df_300_400 = make_targets_df(train_df, 300, 400)","ffa60bdf":"targets_df_300_400.to_csv('targets_df_300_400.csv')","dcaa5630":"targets_df_400_500 = make_targets_df(train_df, 400, 500)","319722b5":"targets_df_400_500.to_csv('targets_df_400_500.csv')","004ce591":"targets_df_500_600 = make_targets_df(train_df, 500, 600)","6f042cbe":"targets_df_500_600.to_csv('targets_df_500_600.csv')","d844e9ee":"targets_df_600_700 = make_targets_df(train_df, 600, 700)","ec141989":"targets_df_600_700.to_csv('targets_df_600_700.csv')","4e75b299":"targets_df_700_800 = make_targets_df(train_df, 700, 800)","ab2d349d":"targets_df_700_800.to_csv('targets_df_700_800.csv')","e0c8026e":"targets_df_800_900 = make_targets_df(train_df, 800, 900)","922a6b59":"targets_df_800_900.to_csv('targets_df_800_900.csv')","315d020d":"targets_df_900_1000 = make_targets_df(train_df, 900, 1000)","d819d541":"targets_df_900_1000.to_csv('targets_df_900_1000.csv')","f762a77b":"targets_df_1000_1100 = make_targets_df(train_df, 1000, 1100)","bcae5d7a":"targets_df_1000_1100.to_csv('targets_df_1000_1100.csv')","48341009":"targets_df_1100_1200 = make_targets_df(train_df, 1100, 1200)","770a121c":"targets_df_1100_1200.to_csv('targets_df_1100_1200.csv')","c835d12d":"targets_df_1200_1216 = make_targets_df(train_df, 1200, 1216)","4a1d4bc3":"targets_df_1200_1216.to_csv('targets_df_1200_1216.csv')","13f2b152":"d = pd.read_csv('.\/targets_df_1200_1216.csv')","9502d065":"d.head()","5620a7b2":"f = pd.read_csv('.\/targets_df_1100_1200.csv')","b3bde149":"f.head()","9a499035":"**1. targets\uc744 \uc120\uc218\ubcc4\ub85c \ub098\ub220\ubcf4\uae30**\n\n1. 'nextDayPlayerEngagement'\uc758 json \ud615\uc2dd\uc744 \ubd84\ud574\n2.  \ubd84\ud574\ud55c \uac83\ub4e4\uc744 playerId\ub97c \uae30\uc900\uc73c\ub85c \ub2e4\uc2dc \ubd84\ud574\n3.  playerId\uac00 \uac19\uc740 \uac83\ub4e4\uc744 \ucde8\ud569\n4. \n "}}