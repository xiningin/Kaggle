{"cell_type":{"9fb1982a":"code","2ab4df25":"code","4e0707ac":"code","056f5bf7":"code","a7f8ee37":"code","77bdd767":"code","0222aec3":"code","c827d1d1":"code","614b56d1":"code","9f60723a":"code","6200b115":"code","bf1cdb1f":"code","8b81b2f7":"code","a7ea24bf":"code","06cd334c":"code","6ecb5d05":"code","04d06d78":"code","6a29c1ff":"code","d8c9c592":"code","d7e2542a":"code","aa593034":"code","e10feca4":"code","a70ee27b":"code","6bea5ca0":"markdown","f85b8af4":"markdown","a4b32cbb":"markdown","2d569f07":"markdown","8cdbec3b":"markdown","111ab265":"markdown","788e7177":"markdown","e5a02809":"markdown","a2dd1986":"markdown","d3e6b656":"markdown","f05af141":"markdown","1f454dc4":"markdown","84f0fdd5":"markdown"},"source":{"9fb1982a":"!pip install selenium","2ab4df25":"import pandas as pd\n\n#from selenium import webdriver\n#from selenium.webdriver.common.by import By\n#from selenium.webdriver.support.ui import WebDriverWait\n#from selenium.webdriver.support import expected_conditions as EC\n#from selenium.webdriver.firefox.options import Options\nfrom tqdm import tqdm\nimport os\nimport time\nimport json","4e0707ac":"df = pd.read_csv('\/kaggle\/input\/zipcode-populations\/zipcode_populations.csv')","056f5bf7":"os.path.exists('\/kaggle\/working')","a7f8ee37":"df.head(1)","77bdd767":"#df[df['zipcode'] == '77073']","0222aec3":"#df = df[172:]","c827d1d1":"#df = df.reset_index(drop=True)","614b56d1":"zipcodes = df['zipcode']","9f60723a":"#ua = UserAgent()\n#user_agent = ua.random\n#options = Options()\n#options.add_argument(f'user-agent={user_agent}')","6200b115":"client_id = '2cdb7089-a9d7-xybc-bcd8-f0f68f12e8ce'","bf1cdb1f":"'''\nprofile = webdriver.FirefoxProfile(\"PATH TO PROFILE\")\nprofile.set_preference(\"dom.webdriver.enabled\", False)\nprofile.set_preference('useAutomationExtension', False)\nprofile.update_preferences()\ndesired = webdriver.DesiredCapabilities.FIREFOX.copy()\n\n#<div id=\"ModalSubscribe\" class=\"modal fade show b-modal b-modal__subscribe m-colored-modal\"> obscures it\n\n\ntry:\n    driver = webdriver.Firefox(options=options, firefox_profile=profile, desired_capabilities=desired)\n    for zip_code in zipcodes[200:]:\n        if not os.path.exists(f'.\/output\/{zip_code}'):\n            os.mkdir(f'.\/output\/{zip_code}')\n        for offset in range(0,10000,30):\n            driver.get(f'https:\/\/www.cargurus.com\/Cars\/searchResults.action?zip={zip_code}&inventorySearchWidgetType=AUTO&searchId={client_id}&nonShippableBaseline=0&sortDir=ASC&sourceContext=carGurusHomePageModel&distance=75&sortType=DEAL_SCORE&offset={offset}&maxResults=30&filtersModified=true')\n            raw_data_button = WebDriverWait(driver, 15).until(\n                EC.presence_of_element_located((By.XPATH, '\/\/a[@id=\"rawdata-tab\"]'))\n            )\n            raw_data_button.click()\n            main_text = WebDriverWait(driver, 10).until(\n                EC.presence_of_element_located((By.XPATH, '\/\/pre[@class=\"data\"]'))\n            )\n            json_obj = json.loads(main_text.text)\n            #print(json_obj)\n            df = pd.DataFrame(json_obj)\n            df.to_csv(f'.\/output\/{zip_code}\/vehicles_{offset}.csv', index=False, mode='a')\n            if main_text.text == 'null':\n                break\n            #profile_df = pd.DataFrame([json.loads(main_text.text)['profile']['profile']])\nexcept Exception as e:\n    print(e)\nfinally:\n    driver.quit()\n'''","8b81b2f7":"master_df = pd.read_csv('\/kaggle\/input\/stockton-ca-cars-2021\/sample_master.csv')","a7ea24bf":"#Combine csvs into one csv\n'''\nmaster_df = pd.DataFrame()\ndf = None\nfor element in tqdm(os.listdir('.\/output\/95206')):\n    #print(element)\n    try:\n        df = pd.read_csv(f'.\/output\/95206\/{element}')\n        #print(len(df))\n    except Exception as e:\n        pass\n        #print(e)\n    master_df = pd.concat([master_df, df], axis=0)\n    master_df = master_df.drop_duplicates('id')\n'''","06cd334c":"#len(master_df)\n#master_df.to_csv('sample_master.csv', index=False)","6ecb5d05":"master_df['modelName'].value_counts()[:10].plot(kind='bar')","04d06d78":"master_df['listingTitle'].value_counts()[:10].plot(kind='bar')","6a29c1ff":"master_df['carYear'].value_counts().plot(kind='bar')","d8c9c592":"master_df['bodyTypeName'].value_counts()[:10].plot(kind='bar')","d7e2542a":"master_df['normalizedExteriorColor'].value_counts()[:10].plot(kind='bar')","aa593034":"master_df['makeName'].value_counts()[:10].plot(kind='bar')","e10feca4":"master_df['sellerCity'].value_counts()[:10].plot(kind='bar')","a70ee27b":"master_df['serviceProviderName'].value_counts()[:10].plot(kind='bar')","6bea5ca0":"according to cargurus","f85b8af4":"(regardless of year)","a4b32cbb":"(When the location is set to Stockton, California)","2d569f07":"# Most Frequent Year","8cdbec3b":"# Top 10 Car Dealers 2021","111ab265":"# Most Frequent Body Types","788e7177":"# Most Frequent Listings","e5a02809":"(year included)","a2dd1986":"# Top 10 Car Makes 2021","d3e6b656":"# ","f05af141":"# Most Frequent Models ","1f454dc4":"# Top 10 Listing Cities 2021","84f0fdd5":"# Top 10 Vehicle Colors 2021"}}