{"cell_type":{"e4d56af1":"code","2026ed38":"code","9f6e9f8f":"code","c8b82728":"code","21dfa5df":"code","9a1aa7bd":"code","d92d3736":"code","a60c7cbe":"code","eb4cd863":"code","dc905234":"code","dae7eb9c":"code","f57331ca":"code","9bdc1dc3":"code","086a3357":"code","4dd26661":"code","95e73cfb":"code","9c4a504a":"code","678dcadf":"code","ba67b731":"markdown"},"source":{"e4d56af1":"import numpy as np \nimport pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.ensemble import GradientBoostingClassifier\nfrom lightgbm import LGBMClassifier\nfrom sklearn import metrics","2026ed38":"data_dictionary = pd.read_csv(\"\/kaggle\/input\/widsdatathon2021\/DataDictionaryWiDS2021.csv\")\nunlabeled = pd.read_csv(\"\/kaggle\/input\/widsdatathon2021\/UnlabeledWiDS2021.csv\")\ntraining = pd.read_csv(\"\/kaggle\/input\/widsdatathon2021\/TrainingWiDS2021.csv\")","9f6e9f8f":"column_datatype_mapping = dict(zip(data_dictionary['Variable Name'], data_dictionary['Data Type']))","c8b82728":"training.diabetes_mellitus.value_counts()","21dfa5df":"data_dictionary['Data Type'].value_counts()","9a1aa7bd":"print(training.hospital_id.nunique(), training.encounter_id.nunique())","d92d3736":"len(training), len(unlabeled)","a60c7cbe":"del training['Unnamed: 0']\ndel unlabeled['Unnamed: 0']\nall_data = training.drop(['encounter_id', \n                          'hospital_id', \n                          'diabetes_mellitus'], axis=1).append(unlabeled)","eb4cd863":"for col in all_data.columns:\n    if all_data.dtypes[col] == \"object\":\n        all_data[col] = all_data[col].fillna(\"NA\")\n        all_data[col] = LabelEncoder().fit_transform(all_data[col])\n        all_data[col]= all_data[col].astype('category')\n    elif column_datatype_mapping[col] == \"binary\":\n        all_data[col] = all_data[col].fillna(-1)\n    elif column_datatype_mapping[col] == \"numeric\":\n        all_data[col] = all_data[col].fillna(0)\n    else:\n        all_data[col] = all_data[col].fillna(all_data[col].median())","dc905234":"len(all_data), all_data.encounter_id.nunique()","dae7eb9c":"df_train = all_data[:len(training)]\ndf_pred = all_data[len(training):].reset_index(drop=True)\nY = training['diabetes_mellitus']","f57331ca":"X_train, X_val, y_train, y_val = train_test_split(df_train, Y, test_size=0.20, random_state=42,shuffle=True )","9bdc1dc3":"lgbmc = LGBMClassifier(n_estimators=1000, max_depth=40)","086a3357":"lgbmc.fit(X_train, y_train)","4dd26661":"lgbmc.score(X_val, y_val)","95e73cfb":"lgbmc.fit(df_train, Y)","9c4a504a":"AUC_FINAL=metrics.roc_auc_score(Y.values, lgbmc.predict(df_train))\nAUC_FINAL","678dcadf":"pd.DataFrame({'encounter_id':unlabeled['encounter_id'].values,\n    'diabetes_mellitus':lgbmc.predict_proba(df_pred)[:,1]}).to_csv('\/kaggle\/working\/Predictions_new.csv',\n                                                                   index=False)","ba67b731":"****Reading Inputs****"}}