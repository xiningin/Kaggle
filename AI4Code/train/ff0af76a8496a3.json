{"cell_type":{"f7922fa8":"code","aef0838c":"code","51dc5733":"code","efe32dad":"code","6680e30e":"code","ea2aa999":"code","44dbd217":"code","b9c7c2f9":"code","5b552525":"code","26e3bcf1":"code","029aabf9":"code","c072720d":"code","593b1fe4":"code","6cad34e6":"code","8fd15b61":"code","23829758":"code","364e4dfc":"code","3a409ea8":"code","7f503bef":"code","154c7d90":"code","5f12c8ec":"code","2f3732c0":"code","479c2667":"markdown","b1b9494a":"markdown","1f391f38":"markdown","629939ef":"markdown","6a8f2a97":"markdown","31b0087d":"markdown","04dc158a":"markdown","e204eb4c":"markdown","65bb56d4":"markdown","00809a68":"markdown","e4965798":"markdown","2c8ff2c8":"markdown","82483798":"markdown","11110415":"markdown","6064514c":"markdown","c88fc5f3":"markdown","a79728d9":"markdown","aaafd1bf":"markdown","fcc12346":"markdown","e3da55f7":"markdown","5e88d2ac":"markdown"},"source":{"f7922fa8":"import pandas as pd\nimport numpy as np","aef0838c":"data = pd.read_csv(\"\/kaggle\/input\/water-potability\/water_potability.csv\")","51dc5733":"data.head()","efe32dad":"data.describe()","6680e30e":"data = data.fillna(data.mean())","ea2aa999":"data.describe()","44dbd217":"data.dtypes","b9c7c2f9":"X,Y=data.drop([\"Potability\"],axis=1),data[\"Potability\"]","5b552525":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import GridSearchCV,cross_val_score","26e3bcf1":"logistic = LogisticRegression(penalty=\"l2\")\nsolvers = ['liblinear',\"lbfgs\",\"none\"]\nepochs = [50,100,400,500,1000]\nparams = {\"max_iter\":epochs,\"solver\":solvers}\ngrid_model = GridSearchCV(logistic,param_grid=params,cv=5,verbose=0)\ngrid_model.fit(X,Y)","029aabf9":"grid_model.best_params_","c072720d":"grid_model.best_score_","593b1fe4":"from sklearn.neighbors import KNeighborsClassifier","6cad34e6":"knn = KNeighborsClassifier()","8fd15b61":"K = [3,5,10,20,40,75,100,200,300,500]\np = [1,2,3,5,10]\nparams = {\"n_neighbors\":K,\"p\":p}\nknn_grid_model = GridSearchCV(knn,param_grid=params,cv=8)\nknn_grid_model.fit(X,Y)","23829758":"knn_grid_model.best_params_","364e4dfc":"knn_grid_model.best_score_","3a409ea8":"from sklearn.svm import SVC","7f503bef":"svc_estimator = SVC()","154c7d90":"kernel = ['poly']\nC = [1,2,5,10]\ndegrees= [4,5,6,8,10]\ncoef0 = [0, 0.2, 0.5,1,2.5,3]\nclass_weight = ['balanced',None]\nparams = {\"C\":C,\"degree\":degrees,\"coef0\":coef0,\"class_weight\":class_weight}\nsvc_grid_model = GridSearchCV(svc_estimator,param_grid=params,cv=5,n_jobs=5)\nsvc_grid_model.fit(X,Y)","5f12c8ec":"svc_grid_model.best_params_","2f3732c0":"svc_grid_model.best_score_","479c2667":"### imporation des donn\u00e9es et affichage des 5 premiers \u00e9chantillons\npour importer la base de donnees il suffit de sp\u00e9cifier le chemin du fichier water_potability.csv","b1b9494a":"# SVM","1f391f38":"# KNN","629939ef":"### resultats","6a8f2a97":"# Regression Logistique","31b0087d":"### Resultat: le meilleur score obtenu","04dc158a":"la fonction head sert \u00e0 afficher les donn\u00e9es, par d\u00e9faut elle afficher les 5 premiers element (\u00e9chantillon), sinon vous pouvez sp\u00e9cifier le nombre des \u00e9l\u00e9ments \u00e0 afficher: data.head(10) pour afficher 10 par exemple","e204eb4c":"### Resultat: les meilleurs valeurs des parametres","65bb56d4":"### S\u00e9paration des donn\u00e9es\non va garder le champs 'Potability' comme Y c\u00e0d la valeur qu'on va chercher \u00e0 pr\u00e9dire.\ndonc X va contenir tous les champs sauf potavility (c'est ce que la fonction drop fait)","00809a68":"### importation du modele","e4965798":"### Importation des libraries","2c8ff2c8":"#### Remarque\nOn remarque que les caract\u00e9ristiques n'ont pas le meme nombre (count), c\u00e0d pour certains \u00e9chantillons il y a des valuers manquantes.\ndans ce cas il y a pas de soultions :\n1. effacer tous les \u00e9chantillons qui ont des valuers manquantes\n1. remplir ces valeurs par la moyenne de chaque caract\u00e9ristique, \n1. remplir les valeurs manquantes par une valeur comprise entre le min et le max de chaque caract\u00e9ristique.\n\u00e7a peut etre resultat de\n\ndans cet exemple on va essayer la deuxieme,\npar exemple si on trouve un \u00e9lement avec une valeur manquante de PH on va remplir cette valeur par la moyenne des PH des autres \u00e9lement (c'est juste une estimation)","82483798":"### visualisation des informations sur les donn\u00e9es","11110415":"la fonction describe donne des information g\u00e9n\u00e9rales sur les donn\u00e9es (le nombre des \u00e9lements, la moyenne, \u00e9cart type, le minimum, les quantilles, le max) ","6064514c":"### cr\u00e9ation du modele de la regression logistique\n#### GridSearch avec cross-validation\ngrace \u00e0 GridSearchCV on va tester plusieurs combinaisons des parametres (solver,max_iter) afin de trouver la combinaison des parametres qui donne le plus mieux score, on va specifier 5 comme valeur de K qu'on va utiliser pour faire la validation crois\u00e9e (cross-validation) ","c88fc5f3":"### visualisation des donn\u00e9es","a79728d9":"### importation des libraries","aaafd1bf":"### cr\u00e9ation du modele","fcc12346":"maintenant on va trouvez que tous les champs on le meme nombre d'element","e3da55f7":"## Analyse des donn\u00e9es ","5e88d2ac":"### GridSearch avec cross-validation:\n"}}