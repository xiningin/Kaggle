{"cell_type":{"eb76c553":"code","7e658000":"code","42d934f2":"code","7aea1b6f":"code","42ca9697":"code","58d316d6":"code","734d32f2":"code","57379c0b":"code","f63aebba":"code","226e9110":"code","d22d784f":"code","7fc1a6ec":"code","a33263a5":"code","0a582538":"code","8a92cc02":"code","e99ab6e7":"code","a2b24aeb":"code","5244d7c2":"code","0869cf9b":"code","06c6c0ff":"code","045b6241":"code","5de5abcc":"code","a3648534":"code","8bc733d0":"code","57e2b02c":"code","86ec5487":"code","f9c4d80a":"code","a50c7810":"markdown","e9fcae59":"markdown","a7a6761d":"markdown","9f2dbf49":"markdown","35d2c6fb":"markdown","1ac904fe":"markdown","c5ec2723":"markdown","600db217":"markdown","e4df8e91":"markdown","ab34eb49":"markdown","bc01f887":"markdown","64980f37":"markdown","686e1263":"markdown","98ad6319":"markdown","848e18dc":"markdown","86c728cd":"markdown","24cfef7d":"markdown","c1ab43eb":"markdown","003f4616":"markdown","7724c58f":"markdown"},"source":{"eb76c553":"import numpy as np \nimport pandas as pd\n\nimport seaborn as sns \nimport matplotlib.pyplot as plt\n\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")","7e658000":"df= pd.read_csv('..\/input\/co2-emission-by-vehicles\/CO2 Emissions_Canada.csv')\ndf.head()","42d934f2":"df.info()","7aea1b6f":"df.shape","42ca9697":"df.isnull().sum()","58d316d6":"df.duplicated().sum()","734d32f2":"# Drop Duplicated data\ndf= df.drop_duplicates()\ndf.shape","57379c0b":"df.describe().T","f63aebba":"def explore_cat_feature(feature):\n    group= df.groupby(feature).mean()\n    plt.figure(figsize=[15,5])\n    plots = group['CO2 Emissions(g\/km)'].sort_values().plot(kind = 'bar', fontsize=15)\n    plt.xlabel(feature, fontsize=15);\n    plt.ylabel('Mean Co2 Emission', fontsize=15);\n    plt.title(\"Mean Co2 Emission according to {} feature\\n\".format(feature), fontsize=20)\n","226e9110":"for feature in ['Make', 'Vehicle Class', 'Engine Size(L)', 'Cylinders', 'Transmission', 'Fuel Type']:\n    explore_cat_feature(feature)","d22d784f":"df[\"Model\"].value_counts()","7fc1a6ec":"def explore_num_feature(feature):\n    plt.figure(figsize=[15,5])\n    plt.scatter(df[feature], df['CO2 Emissions(g\/km)'])\n    plt.xlabel(feature, fontsize=15);\n    plt.ylabel('Co2 Emission', fontsize=15);\n    plt.title(\" Co2 Emission vs. {} \\n\".format(feature), fontsize=20)","a33263a5":"for feature in ['Fuel Consumption City (L\/100 km)', 'Fuel Consumption Hwy (L\/100 km)', 'Fuel Consumption Comb (L\/100 km)', 'Fuel Consumption Comb (mpg)']:\n    explore_num_feature(feature)","0a582538":"df.corr()","8a92cc02":"df2 = df.drop(['Make','Model','Vehicle Class','Fuel Consumption City (L\/100 km)', 'Transmission', 'Fuel Type', 'Fuel Consumption Hwy (L\/100 km)','Fuel Consumption Comb (mpg)'],axis=1)\ndf2.head()","e99ab6e7":"X = df2.drop(['CO2 Emissions(g\/km)'], axis= 1)\ny = df2[\"CO2 Emissions(g\/km)\"]","a2b24aeb":"from sklearn.model_selection import train_test_split, cross_val_score, cross_val_predict\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=42)","5244d7c2":"from sklearn.linear_model import LinearRegression\nlin_reg = LinearRegression()\nlin_reg.fit(X_train, y_train)","0869cf9b":"print('Training Accuracy: ', lin_reg.score(X_train, y_train))\nprint('Testing Accuracy: ', lin_reg.score(X_test, y_test))","06c6c0ff":"cross_val_score(lin_reg, X, y, cv = 10, scoring = \"r2\").mean()","045b6241":"from sklearn.linear_model import RidgeCV, Ridge\nridge_cv = RidgeCV(alphas = 10**np.linspace(10,-2,100), scoring = \"neg_mean_squared_error\", normalize = True)\nridge_cv.fit(X_train, y_train)\nprint('Alpha= ', ridge_cv.alpha_)\nridge_tuned = Ridge(alpha = ridge_cv.alpha_,  normalize = True).fit(X_train,y_train)\nprint('Training Accuracy: ', ridge_tuned.score(X_train, y_train))\nprint('Testing Accuracy: ', ridge_tuned.score(X_test, y_test))","5de5abcc":"df3= pd.get_dummies(df, drop_first=True)\ndf3.head()","a3648534":"X = df3.drop(['CO2 Emissions(g\/km)'], axis= 1)\ny = df3[\"CO2 Emissions(g\/km)\"]\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=42)\nlin_reg = LinearRegression()\nlin_reg.fit(X_train, y_train)\nprint('Training Accuracy: ', lin_reg.score(X_train, y_train))\nprint('Testing Accuracy: ', lin_reg.score(X_test, y_test))","8bc733d0":"ridge= Ridge(alpha =0.001,  normalize = True).fit(X_train,y_train)\nprint('Training Accuracy: ', ridge.score(X_train, y_train))\nprint('Testing Accuracy: ', ridge.score(X_test, y_test))","57e2b02c":"from sklearn.linear_model import Lasso\nlasso = Lasso(alpha = 0.01).fit(X_train, y_train)\nprint('Training Accuracy: ', lasso.score(X_train, y_train))\nprint('Testing Accuracy: ', lasso.score(X_test, y_test))","86ec5487":"from sklearn.ensemble import RandomForestRegressor\nrf = RandomForestRegressor(random_state = 42)\nrf.fit(X_train, y_train)\nprint('Training Accuracy: ', rf.score(X_train, y_train))\nprint('Testing Accuracy: ', rf.score(X_test, y_test))","f9c4d80a":"from sklearn.model_selection import cross_val_score\nprint('Lasso Cross Validation: ' , cross_val_score(lasso, X, y, cv=5))\nprint('RandomForest Cross Validation: ' , cross_val_score(rf, X, y, cv=5))","a50c7810":"## Random Forest","e9fcae59":"* Dataset comprises of 7385 observations and 12 characteristics.<br>\n","a7a6761d":"> **Consider All Features**\n### Handling Categorical Features","9f2dbf49":"## Linear Regression","35d2c6fb":"## Build A Simple Model","1ac904fe":"## **We got +99% Accuracy in average Using Lasso and Random Forest**","c5ec2723":"## Try Ridge","600db217":" # <a id='2'> 2.Exploratory Data Analysis<\/a>","e4df8e91":"## **If you found it useful, Please Upvote**","ab34eb49":"## Ridge","bc01f887":"## Linear Regression","64980f37":"This dataset captures the details of how CO2 emissions by a vehicle can vary with the different features. The dataset has been taken from Canada Government official open data website. This is a compiled version. This contains data over a period of 7 years.\nThere are total 7385 rows and 12 columns. There are few abbreviations that has been used to describe the features. \n\n\n\n    1. Model \n\n4WD\/4X4 = Four-wheel drive <br>\nAWD = All-wheel drive <br>\nFFV = Flexible-fuel vehicle <br>\nSWB = Short wheelbase <br> \nLWB = Long wheelbase <br>\nEWB = Extended wheelbase  <br>\n\n    2. Transmission\nA = Automatic <br>\nAM = Automated manual <br>\nAS = Automatic with select shift <br>\nAV = Continuously variable <br>\nM = Manual<br>\n3 - 10 = Number of gears <br>\n\n    3. Fuel type\nX = Regular gasoline <br>\nZ = Premium gasoline <br>\nD = Diesel <br>\nE = Ethanol (E85) <br>\nN = Natural gas <br>\n\nMake= Company of the vehicle <br>\nModel= Car model <br>\nVehicle Class= Class of vehicle depending on their utility, capacity and weight <br>\nEngine Size = Size of engine used in Litre <br>\nCylinders= Number of cylinders <br>\nTransmission = Transmission type with number of gears <br>\nFuel type =Type of Fuel used <br>\nFuel Consumption City=Fuel consumption in city roads (L\/100 km) <br>\nFuel Consumption Hwy=Fuel consumption in Hwy roads (L\/100 km) <br>\nFuel Consumption Comb=The combined fuel consumption (55% city, 45% highway) is shown in L\/100 km <br>\nFuel Consumption Comb mpg =The combined fuel consumption in both city and highway is shown in mile per gallon(mpg)<br> \n","686e1263":" # <a id='1'> 1. Data Description:<\/a>","98ad6319":"## Lasso","848e18dc":"* Emission increases with increase in Fuel Consumption (City, Hwy, Comb (L\/100km))\n* Emission decreases with increase in Fuel Consumption Comb (mpg)","86c728cd":"* No column has null\/missing values. <br>","24cfef7d":"# Table of contents\n\n<a href='#1'>1. Data Description <\/a> <br>\n<a href='#2'>2. Exploratory Data Analysis <\/a> <br>\n<a href='#3'>3. Modelling <\/a> <br>\n","c1ab43eb":"* Data has only float,object and integer values.<br>\n","003f4616":"* Engine Size and Cylinders have a clear effect in increasing Co2 Emission\n* Co2 Emission also differs with Make, Vehicle Class and Transmission\n* Fuel Type has a small effect on Co2 Emission","7724c58f":" # <a id='3'> 3.Modelling<\/a>"}}