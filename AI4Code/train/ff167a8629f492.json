{"cell_type":{"76acfa46":"code","694a714b":"code","b6eea52c":"code","639b0736":"code","e736fd28":"code","28569883":"code","e7af10ba":"code","7ca8f725":"code","2c6d42f0":"code","f2f53c56":"code","b05de154":"code","2cdc47f3":"code","75107d1f":"code","b8143efe":"code","d6a7648e":"code","cbb5a4d5":"code","22599782":"markdown","21c12e65":"markdown","6624d588":"markdown"},"source":{"76acfa46":"import numpy as np # matrix tools\nimport matplotlib.pyplot as plt # for basic plots\nimport seaborn as sns # for nicer plots\nimport pandas as pd\nfrom glob import glob\nimport re\nfrom skimage.io import imread\n\nimport keras","694a714b":"%matplotlib inline\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    print(dirname,\"______\")\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","b6eea52c":"IS_LOCAL = False\nif(IS_LOCAL):\n    PATH=\"..\/input\/siim-medical-image\/\"\nelse:\n    PATH=\"..\/input\/\"\nprint(os.listdir(PATH))\noverview = pd.read_csv(os.path.join(PATH,\"overview.csv\"))\noverview.head()","639b0736":"len(overview)","e736fd28":"overview['Contrast'] = overview['Contrast'].map(lambda x: 1 if x else 0)","28569883":"plt.figure(figsize=(10,5))\nsns.distplot(overview['Age'])","e7af10ba":"g = sns.FacetGrid(overview, col=\"Contrast\", size=8)\ng = g.map(sns.distplot, \"Age\")","7ca8f725":"g = sns.FacetGrid(overview, hue=\"Contrast\",size=6, legend_out=True)\ng = g.map(sns.distplot, \"Age\").add_legend()","2c6d42f0":"BASE_IMG_PATH=os.path.join('..','kaggle\/input')\nprint(os.path.join(BASE_IMG_PATH,'tiff_images','*.tif'))\nall_images_list = glob(os.path.join(BASE_IMG_PATH,'tiff_images','*.tif'))\nall_images_list[:5]\nprint(all_images_list)","f2f53c56":"np.array(np.arange(81)).reshape(9,9)","b05de154":"np.array(np.arange(81)).reshape(9,9)[::3,::3]","2cdc47f3":"jimread = lambda x: np.expand_dims(imread(x)[::2,::2],0)","75107d1f":"check_contrast = re.compile(r'data\\\\tiff_images\\\\ID_([\\d]+)_AGE_[\\d]+_CONTRAST_([\\d]+)_CT.tif')\nlabel = []\nid_list = []\nfor image in all_images_list:\n    id_list.append(check_contrast.findall(image)[0][0])\n    label.append(check_contrast.findall(image)[0][1])","b8143efe":"label_list = pd.DataFrame(label,id_list)","d6a7648e":"label_list.head()","cbb5a4d5":"images = np.stack([jimread(i) for i in all_images_list],0)","22599782":" - np.expand_dims -> Expand the shape of an array.\n  - Insert a new axis, corresponding to a given position in the array shape.","21c12e65":"## Read Image Files ","6624d588":"# Constrast Cancer Classification"}}