{"cell_type":{"767321a2":"code","ee197796":"code","0fdc4dc4":"code","b9dd6597":"code","3180c30f":"code","48a9e441":"code","d10ca543":"code","dfa9e251":"code","72d59a25":"code","1cc99cff":"code","cefb5a91":"code","dd144024":"code","c3524fbf":"code","c558306b":"code","ab2e994d":"code","60349849":"code","8e6c3eb8":"code","c2f83a13":"code","23f51a6e":"code","c7823e0e":"code","ac53d183":"code","47b7920a":"code","a89c81e6":"code","5643dcfc":"code","1101ed4e":"code","43afadf4":"code","1f3cb72d":"code","65aa934d":"code","c4025977":"code","9752fb64":"code","52d7ade6":"code","3c8ae98a":"code","5e9a961d":"code","308a9467":"code","3d1a8f36":"code","ee365f7b":"code","10102dd5":"code","b1de2ec9":"code","6209b2a5":"code","fcccb9f5":"code","c5525634":"code","f5f3b198":"code","b2715634":"code","61ba618e":"code","467d98ad":"code","fcaf968a":"code","735b63a2":"code","ef32a09f":"code","021d22ec":"code","68759f8c":"markdown","8692666a":"markdown","65033463":"markdown","80106ec6":"markdown","d064aba6":"markdown","5af1cf15":"markdown","5b27d0e3":"markdown","259bb441":"markdown","2f603b4f":"markdown","8ea43c0b":"markdown","1376e916":"markdown","677821a4":"markdown","4a2e6b0d":"markdown","bb12199f":"markdown","e045abed":"markdown","d673c046":"markdown","b348a698":"markdown","0d4e54f7":"markdown","167a8ef4":"markdown","7250b866":"markdown","b2814899":"markdown","742ea5c7":"markdown","34167ba0":"markdown","38446503":"markdown","4935b618":"markdown","f6e7999b":"markdown"},"source":{"767321a2":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n# for visualisation\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n#for data preprocessing\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.preprocessing import StandardScaler\n#for selecting the best feature effecting the target variable\nfrom sklearn.feature_selection import SelectKBest,chi2\n# for splitting the data into train and test dataset\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.svm import SVR\n# regression metrics\nfrom sklearn.metrics import mean_absolute_error\nfrom sklearn.metrics import mean_squared_error\nfrom math import sqrt\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","ee197796":"dataset=pd.read_csv('..\/input\/singapore-airbnb\/listings.csv')","0fdc4dc4":"dataset.head()","b9dd6597":"dataset.info()","3180c30f":"dataset.drop(['id','name','host_name','host_id','last_review'],axis=1,inplace=True)","48a9e441":"dataset.describe()","d10ca543":"correlation_matrix=dataset.corr()\nsns.heatmap(correlation_matrix)","dfa9e251":"dataset.drop(['reviews_per_month'],axis=1,inplace=True)","72d59a25":"dataset.shape","1cc99cff":"dataset.isnull().sum()","cefb5a91":"names=['latitude','longitude','price','minimum_nights','number_of_reviews','calculated_host_listings_count','availability_365']\nplt.figure(figsize=(10,9))\nfor i in range(1,8):\n    \n    plt.subplot(2,4,i)\n    fig=dataset.boxplot(column=names[i-1])","dd144024":"plt.figure(figsize=(12,10))\nfor j in range(1,8):\n    plt.subplot(2,4,j)\n    sns.distplot(dataset[names[j-1]])","c3524fbf":"#for latitude\nstd=np.std(dataset['latitude'])\nmean=np.mean(dataset['latitude'])\nmedian=np.median(dataset['latitude'])\noutliers=[]\nfor x in dataset['latitude']:\n    zscore=(x-mean)\/std\n    if zscore>abs(3):\n        outliers.append(x)","c558306b":"len(outliers)","ab2e994d":"dataset_new=dataset.replace(outliers,median)","60349849":"plt.figure(figsize=(7,5))\nplt.subplot(1,2,1)\nfig=sns.distplot(dataset['latitude'])\nplt.title('before removing outliers')\nplt.subplot(1,2,2)\nfig2=sns.distplot(dataset_new['latitude'])\nplt.title('after removing outliers')","8e6c3eb8":"#for longitude\nstd=np.std(dataset['longitude'])\nmean=np.mean(dataset['longitude'])\nmedian=np.median(dataset['longitude'])\noutliers=[]\nfor x in dataset['longitude']:\n    zscore=(x-mean)\/std\n    if -3<zscore>3:\n        outliers.append(x)","c2f83a13":"len(outliers)","23f51a6e":"#for minimum_nights\nq1=dataset['minimum_nights'].quantile(0.25)\nq3=dataset['minimum_nights'].quantile(0.75)\noutlier=[]\niqr=q3-q1\nlower_bound=q1-(1.5*iqr)\nupper_bound=q3+(1.5*iqr)\nfor i in dataset['minimum_nights']:\n    if i<lower_bound or i>upper_bound:\n            outlier.append(i)        ","c7823e0e":"len(outlier)","ac53d183":"plt.figure(figsize=(20,8))\nsns.countplot(outlier)","47b7920a":"dataset_new=dataset[dataset['minimum_nights']<=365]","a89c81e6":"plt.figure(figsize=(7,5))\nplt.subplot(1,2,1)\nsns.boxplot(dataset['minimum_nights'])\nplt.title('before removing outliers')\nplt.subplot(1,2,2)\nsns.boxplot(dataset_new['minimum_nights'])\nplt.title('after removing outliers')","5643dcfc":"#for calculated_host_listings_count\nq1=dataset['calculated_host_listings_count'].quantile(0.25)\nq3=dataset['calculated_host_listings_count'].quantile(0.75)\noutlier=[]\niqr=q3-q1\nlower_bound=q1-(1.5*iqr)\nupper_bound=q3+(1.5*iqr)\nfor i in dataset['calculated_host_listings_count']:\n    if i<lower_bound or i>upper_bound:\n            outlier.append(i)        ","1101ed4e":"len(outlier)","43afadf4":"sns.countplot(outlier)","1f3cb72d":"dataset_new['room_type'].unique()","65aa934d":"mappings={'Entire home\/apt':1,'Private room':2,'Shared room':3}\ndataset_new['room_type']=dataset_new['room_type'].map(mappings)","c4025977":"dataset_new.head()","9752fb64":"dataset_new['neighbourhood'].unique()","52d7ade6":"len(dataset_new['neighbourhood'].unique())","3c8ae98a":"import category_encoders as ce\nbinary=ce.BinaryEncoder(cols=['neighbourhood'])\ndataset_new=binary.fit_transform(dataset_new)","5e9a961d":"dataset_new.head()","308a9467":"x=dataset_new.iloc[:,[0,1,2,3,4,5,6,7,8,9,10,11,13,14,15]].values\ny=dataset_new.iloc[:,12:13].values","3d1a8f36":"dataset['neighbourhood_group'].unique()","ee365f7b":"# In the ndarray of independent features 'neighbourhood_group' is at 0th position\nlabel=LabelEncoder()\nx[:,0]=label.fit_transform(x[:,0])","10102dd5":"best_features=SelectKBest(score_func=chi2,k=5)\nfit=best_features.fit(x,y)","b1de2ec9":"dfscores = pd.DataFrame(fit.scores_)\ndfcolumns = pd.DataFrame(['neighbourhood_group', 'neighbourhood_0', 'neighbourhood_1',\n       'neighbourhood_2', 'neighbourhood_3', 'neighbourhood_4',\n       'neighbourhood_5', 'neighbourhood_6', 'latitude', 'longitude',\n       'room_type','minimum_nights', 'number_of_reviews',\n       'calculated_host_listings_count', 'availability_365'])\nfeatureScores = pd.concat([dfcolumns,dfscores],axis=1)\nfeatureScores.columns = ['Specs','Score']\nresult=featureScores.nlargest(5,'Score')\nprint(result)","6209b2a5":"plt.figure(figsize=(12,5))\nsns.barplot(x=result['Specs'],y=result['Score'])","fcccb9f5":"sns.pairplot(dataset)","c5525634":"# scaling the features is necessary to implement svr \nsc_x=StandardScaler()\nsc_y=StandardScaler()\nx=sc_x.fit_transform(x)\ny=sc_y.fit_transform(y)","f5f3b198":"x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.2)","b2715634":"regressor=SVR(kernel='rbf')\nregressor.fit(x_train,y_train)\npredictions=regressor.predict(x_test)","61ba618e":"predict=pd.DataFrame(predictions)\nytest=pd.DataFrame(y_test)\nresultant=pd.concat([predict,ytest],axis=1)","467d98ad":"resultant.columns=['Predicted_values','Actual_values']","fcaf968a":"resultant.head()","735b63a2":"mae=mean_absolute_error(y_test,predictions)\nrmse=sqrt(mean_squared_error(y_test,predictions))","ef32a09f":"mae","021d22ec":"rmse","68759f8c":"***Load the dataset***","8692666a":"***Splitting into train and test data***","65033463":"***Checking the data types of all the features***","80106ec6":"***As there are 5 levels and the values are nominal type we can perform label encoding***","d064aba6":"***Checking for  univariate outliers using boxplot***","5af1cf15":"***Taking a look at the dataset ***","5b27d0e3":"***Here we can see that 'number_of_reviews' and 'reviews_per_month' are correlated with each other and hence one of them must be dropped in order to get better results from our model.***","259bb441":"***These values of detected as outliers according to upper and lower bound rule are not outliers as values like '274','203','157' and '141' can be a count of host listings on air-bnb. So these values are left untouched.***","2f603b4f":"***As there are only three levels of categories in 'room_type' feature we can map them with certain values***","8ea43c0b":"***Now looking for the categorical features in the dataset ***","1376e916":"***Dropping the unnecessary columns***","677821a4":"***As there are total 43 levels in 'neighbourhood' feature we can go for Binary Encoder so as to prevent dimensionality reduction by using one hot encoding***","4a2e6b0d":"***Importing the required libraries***","bb12199f":"***Now the scale of values has been changed and after filtering out the outlier values we get a maximum of 365 number of nights***","e045abed":"***Now splitting the dataset into dependent and independent features ***","d673c046":"***Checking for missing values***","b348a698":"***Here we can see that 'calculated_host_listings_count' and 'minimum_nights' are the features that mostly affect our target variable (feature) i.e. 'price'***","0d4e54f7":"* Here we can see that after '365' there is a sudden increase in number of minimum nights which is not desirable as the hosts at air-bnb provide a maximum of one year stay in the form of rent to the visitors i.e of 365 days.\n* So all the values above 365 are considered as outliers. For eg : 1000 number of minimum nights is next to impossible.\n* Such values are supposed to get filtered out.","167a8ef4":"***Removing the outliers by imputing them with median value***","7250b866":"***For all those who following a normal distribution they can use 'Z-Score' method for detecting outliers***","b2814899":"***After converting all the features into numeric form we can check which indenpendent features are best effecting the target feature i.e. 'price'***","742ea5c7":"* Usually mae ranges from 0 to infinity and lower the value better are the predictions.\n* So a value of 0.33 indicates that the model can give good predictions ","34167ba0":"***Fitting the train data to the model and making out the predictions ***","38446503":"***Checking the distribution of each numerical feature to decide the method of detecting outliers for each of them ***","4935b618":"***As the features are not having linear relationship with each other we cant use linear regression model.Instead we can go for SVR.***","f6e7999b":"***RMSE is always much higher than the mean absolute error(mae) as they are the squared values of error.***"}}