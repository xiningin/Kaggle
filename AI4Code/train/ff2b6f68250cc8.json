{"cell_type":{"3b03fff8":"code","a9281124":"code","43846b0d":"code","993b907a":"code","31e1b053":"code","335cc9cf":"code","96b6d928":"code","c7abdf8e":"code","3f7228a8":"code","308778b9":"code","8e019de1":"code","e83cc3f7":"code","5fb5f4bd":"code","48f62afb":"code","84f425ea":"code","9b49a694":"code","f04c873e":"code","1082cca2":"markdown","e3e9a911":"markdown","26bd6a09":"markdown","66851b2e":"markdown"},"source":{"3b03fff8":"import json, os, sys\nimport pandas as pd","a9281124":"host = \"https:\/\/www.kaggle.com\"","43846b0d":"N_PAGES = 500","993b907a":"page_list = list(range(1, N_PAGES + 1))","31e1b053":"def page_path(page):\n    return f\"topics.json?sortBy=hot&group=all&page={page}&pageSize=20&category=all&kind=all\"","335cc9cf":"with open(\"urls.txt\", \"w\") as f:\n    for page in page_list:\n        print(f\"{host}\/{page_path(page)}\", file=f)","96b6d928":"!wget -w 2 -i urls.txt -o wget.log","c7abdf8e":"def load_page(page):\n    fn = page_path(page)\n    with open(fn) as f:\n        j = json.load(f)\n        s = [pd.Series(e) for e in j[\"topics\"]]\n        df = pd.concat(s, 1).T\n        df.insert(0, \"Page\", page)\n        return df","3f7228a8":"dfs = [load_page(p) for p in page_list]","308778b9":"df = pd.concat(dfs).reset_index(drop=True)\ndf.shape","8e019de1":"users = df.pop(\"userAvatar\").apply(pd.Series)","e83cc3f7":"df = df.join(users.add_prefix(\"author_\"))\ndf.shape","5fb5f4bd":"df.columns","48f62afb":"df.authorType.value_counts()","84f425ea":"date_tag = pd.datetime.now().strftime(\"%Y-%m-%d\")\ndate_tag","9b49a694":"df.to_csv(f\"discussion-hotness-{date_tag}.csv\", index_label=\"Index\")","f04c873e":"!zip -m -9 pages topics.* >>compress.log","1082cca2":"# Scrape Discussion *Hotness*\n\nDiscussion listings are sorted by \"*Hotness*\" by default, but it freezes, see [one bug report here](https:\/\/www.kaggle.com\/product-feedback\/119431). Old posts remain hottest for weeks, new posts do not make it near to the top.\n\nDiscussion *Hotness* is not available in [Meta Kaggle](https:\/\/www.kaggle.com\/kaggle\/meta-kaggle) but seeing as *Hotness* it is not working right now - let's create a snapshot of it for posterity! This isn't an attempt to reverse engineer *Hotness* because - as we will see - it is broken.\n\nIt would be cool to use some ML to detect from the vote\/comment counts available in Meta Kaggle when this *Hotness* freeze has happened. Perhaps the diversity of postings that receive votes on a given day drops when only old posts are listed at the top. And when it freezes it stays like that for 1-2 weeks before being fixed, so it is a slow-moving state transition kind of pattern to detect...","e3e9a911":"fetch all pages","26bd6a09":"pd.concat : Any None objects will be dropped silently unless they are all None in which case a ValueError will be raised.","66851b2e":"zip options:\n\n    -m   move into zipfile (delete OS files)\n    -9   compress better\n    "}}