{"cell_type":{"8d950655":"code","3594429a":"code","b3668bb9":"code","fb614d1c":"code","5d0aef63":"code","783c59b5":"code","71158a3f":"code","d7243535":"code","2a6135ac":"code","9dd3e7b0":"code","caa09c4d":"code","ce664e93":"code","f278da3e":"code","fecd6915":"code","1e7e5ce8":"code","234c1dc2":"code","5704f9b4":"code","6a17c309":"code","b4f39db7":"code","04b68537":"code","2e17c068":"code","fddbef83":"code","3e5bcc29":"code","48845aab":"code","db7da1cf":"code","f378fcb6":"code","ad85f046":"code","7d225971":"code","b45798c5":"code","fe3958c9":"code","9afd20d5":"code","f2140c1e":"code","d327643a":"code","8052102f":"code","9cd59a0d":"code","995f9c60":"code","75d0c95b":"code","d094d60f":"code","67ab9927":"code","3821e4cf":"code","45f3fa05":"code","224c5b64":"code","8fcc12c1":"code","47d3eea9":"code","48e811aa":"code","0aae479d":"code","d61b49e7":"code","5bcd417f":"code","e51c90a9":"code","3dbac84b":"code","f85a879c":"code","a089502f":"code","d4761b58":"code","43198b3b":"code","899dac7d":"code","7a0b43aa":"code","fbfba22b":"code","f4d2d323":"code","825d1944":"code","6207c4a2":"code","3d657b64":"code","4eefee43":"code","8deddcfb":"code","76b828ed":"markdown","c3158127":"markdown","5bb5e4ae":"markdown","c03f517a":"markdown","68e1fefd":"markdown","07b7edd4":"markdown","00e3038f":"markdown","aa56b5f2":"markdown","4b5a8585":"markdown","0f0505e0":"markdown"},"source":{"8d950655":"import numpy as np \nimport pandas as pd\nimport plotly.express as px\nimport plotly.graph_objects as go\nfrom plotly.subplots import make_subplots\nfrom scipy import stats","3594429a":"SCATTER_SIZE = 600\nHIST_WIDTH = 700\nHIST_HEIGHT = 500","b3668bb9":"train = pd.read_csv('\/kaggle\/input\/lish-moa\/train_features.csv')\ntrain_target = pd.read_csv(\"..\/input\/lish-moa\/train_targets_scored.csv\")\ntest = pd.read_csv('\/kaggle\/input\/lish-moa\/test_features.csv')","fb614d1c":"check = train_target.copy()\ncheck['cp_type'] = train['cp_type']\nzeros = check[check['cp_type'] == 'ctl_vehicle']\n\ntotal_sum = 0\nfor col in zeros.columns:\n    if col in ['sig_id', 'cp_type']:\n        continue\n    else:\n        total_sum += zeros[col].sum()\n        \nprint('Total sum over all columns: ', total_sum)","5d0aef63":"check = train_target.copy()\ncheck['cp_dose'] = train['cp_dose']\nzeros = check[check['cp_dose'] == 'D2']\n\ntotal_sum = 0\nfor col in zeros.columns:\n    if col in ['atp-sensitive_potassium_channel_antagonist',  'erbb2_inhibitor']:\n        total_sum += zeros[col].sum()\n        \nprint('Total sum over all columns: ', total_sum)","783c59b5":"check = train_target.copy()\ncheck['cp_time'] = train['cp_time']\nzeros = check[check['cp_time'] != 48]\n\ntotal_sum = 0\nfor col in zeros.columns:\n    if col in ['atp-sensitive_potassium_channel_antagonist',  'erbb2_inhibitor']:\n        total_sum += zeros[col].sum()\n        \nprint('Total sum over all columns: ', total_sum)","71158a3f":"print('Number of samples in atp-sensitive_potassium_channel_antagonist: ', train_target['atp-sensitive_potassium_channel_antagonist'].sum())\nprint('Number of samples in erbb2_inhibitor: ', train_target['erbb2_inhibitor'].sum())","d7243535":"check = train[['c-31', 'c-32', 'c-78']].copy()\ncheck['proteasome_inhibitor'] = train_target['proteasome_inhibitor']\ncheck['size'] = 1\ncheck.loc[check['proteasome_inhibitor']==1, 'size'] = 5","2a6135ac":"fig = px.scatter_3d(\n    check, \n    x='c-78', \n    y='c-32',\n    z='c-31', \n    color=\"proteasome_inhibitor\", \n    size=\"size\",\n    title='Scatter plot for proteasome_inhibitor',\n    width=SCATTER_SIZE,\n    height=SCATTER_SIZE\n)\n\nfig.show()","9dd3e7b0":"fig = px.scatter(\n    check, \n    x='c-32', \n    y='c-31',\n    color=\"proteasome_inhibitor\", \n    title='Scatter plot for proteasome_inhibitor',\n    width=SCATTER_SIZE,\n    height=SCATTER_SIZE\n)\n\nfig.show()","caa09c4d":"fig = px.scatter(\n    check, \n    x='c-78', \n    y='c-31',\n    color=\"proteasome_inhibitor\", \n    title='Scatter plot for proteasome_inhibitor',\n    width=SCATTER_SIZE,\n    height=SCATTER_SIZE\n)\n\nfig.show()","ce664e93":"fig = px.scatter(\n    check, \n    x='c-78', \n    y='c-32',\n    color=\"proteasome_inhibitor\", \n    title='Scatter plot for proteasome_inhibitor',\n    width=SCATTER_SIZE,\n    height=SCATTER_SIZE\n)\n\nfig.show()","f278da3e":"def plot_combined_histograms(plot_list, name):\n    fig = make_subplots(\n        rows=2, \n        cols=3\n    )\n    \n    traces = [\n        go.Histogram(\n            x=train[col], \n            nbinsx=100, \n            name=col + ' train'\n        ) for col in plot_list\n    ]\n    \n    for col in plot_list:\n        traces.append(\n            go.Histogram(\n                x=test[col], \n                nbinsx=100, \n                name=col + ' test'\n            )\n        )\n\n    for i in range(len(traces)):\n        fig.append_trace(\n            traces[i], \n            (i \/\/ 3) + 1, \n            (i % 3) + 1\n        )\n\n    fig.update_layout(\n        title_text='Mostly correlated features with ' + name,\n        height=800,\n        width=1000\n    )\n    fig.show()","fecd6915":"plot_combined_histograms(\n    plot_list=['c-31', 'c-32', 'c-78'], \n    name='proteasome_inhibitor'\n)","1e7e5ce8":"def plot_histograms(column, bins=20):\n    fig = go.Figure()\n    fig.add_trace(\n        go.Histogram(\n            x=train[column], \n            nbinsx=bins, \n            name=column + ' train', \n            histnorm='percent'\n        )\n    )\n    fig.add_trace(\n        go.Histogram(\n            x=test[column], \n            nbinsx=bins,  \n            name=column + ' test', \n            histnorm='percent'\n        )\n    )\n\n    fig.update_layout(\n        barmode='overlay',\n        height=HIST_HEIGHT,\n        width=HIST_WIDTH,\n        title_text='Normalized ' + column + ' train & test sets'\n    )\n    fig.update_traces(opacity=0.6)\n    fig.show()","234c1dc2":"plot_histograms('c-31')","5704f9b4":"stats.ttest_ind(\n    train['c-31'], \n    test['c-31']\n)","6a17c309":"plot_histograms('c-32')","b4f39db7":"stats.ttest_ind(\n    train['c-32'], \n    test['c-32']\n)","04b68537":"plot_histograms('c-78')","2e17c068":"stats.ttest_ind(\n    train['c-78'], \n    test['c-78']\n)","fddbef83":"check = train[['g-202', 'g-431', 'g-769']]\ncheck['raf_inhibitor'] = train_target['raf_inhibitor']\ncheck['size'] = 1\ncheck.loc[check['raf_inhibitor']==1, 'size'] = 5","3e5bcc29":"fig = px.scatter_3d(\n    check, \n    x='g-202', \n    y='g-431',\n    z='g-769', \n    color='raf_inhibitor', \n    size=\"size\",\n    height=SCATTER_SIZE,\n    width=SCATTER_SIZE,\n    title='Scatter plot for raf_inhibitor'\n)\n\nfig.show()","48845aab":"fig = px.scatter(\n    check, \n    x='g-202', \n    y='g-431',\n    color=\"raf_inhibitor\", \n    height=SCATTER_SIZE,\n    width=SCATTER_SIZE,\n    title='Scatter plot for raf_inhibitor'\n)\n\nfig.show()","db7da1cf":"fig = px.scatter(\n    check, \n    x='g-202', \n    y='g-769',\n    color=\"raf_inhibitor\", \n    height=SCATTER_SIZE,\n    width=SCATTER_SIZE,\n    title='Scatter plot for raf_inhibitor'\n)\n\nfig.show()","f378fcb6":"fig = px.scatter(\n    check, \n    x='g-431', \n    y='g-769',\n    color=\"raf_inhibitor\", \n    height=SCATTER_SIZE,\n    width=SCATTER_SIZE,\n    title='Scatter plot for raf_inhibitor'\n)\n\nfig.show()","ad85f046":"plot_combined_histograms(\n    plot_list=['g-202', 'g-431', 'g-769'], \n    name='raf_inhibitor'\n)","7d225971":"plot_histograms('g-202')","b45798c5":"plot_histograms('g-431')","fe3958c9":"plot_histograms('g-769')","9afd20d5":"check = train[['g-235', 'g-635', 'g-745']]\ncheck['egfr_inhibitor'] = train_target['egfr_inhibitor']\ncheck['size'] = 1\ncheck.loc[check['egfr_inhibitor']==1, 'size'] = 5","f2140c1e":"fig = px.scatter_3d(\n    check, \n    x='g-235', \n    y='g-635',\n    z='g-745', \n    color='egfr_inhibitor', \n    size=\"size\",\n    height=SCATTER_SIZE,\n    width=SCATTER_SIZE,\n    title='Scatter plot for egfr_inhibitor'\n)\n\nfig.show()","d327643a":"fig = px.scatter(\n    check, \n    x='g-235', \n    y='g-635',\n    color=\"egfr_inhibitor\", \n    height=SCATTER_SIZE,\n    width=SCATTER_SIZE,\n    title='Scatter plot for egfr_inhibitor'\n)\n\nfig.show()","8052102f":"fig = px.scatter(\n    check, \n    x='g-235', \n    y='g-745',\n    color=\"egfr_inhibitor\", \n    height=SCATTER_SIZE,\n    width=SCATTER_SIZE,\n    title='Scatter plot for egfr_inhibitor'\n)\n\nfig.show()","9cd59a0d":"fig = px.scatter(\n    check, \n    x='g-745', \n    y='g-635',\n    color=\"egfr_inhibitor\", \n    height=SCATTER_SIZE,\n    width=SCATTER_SIZE,\n    title='Scatter plot for egfr_inhibitor'\n)\n\nfig.show()","995f9c60":"plot_combined_histograms(\n    plot_list=['g-235', 'g-635', 'g-745'], \n    name='egfr_inhibitor'\n)","75d0c95b":"plot_histograms('g-235')","d094d60f":"plot_histograms('g-635')","67ab9927":"plot_histograms('g-745')","3821e4cf":"check = train[['g-599', 'g-165', 'g-699']]\ncheck['mtor_inhibitor'] = train_target['mtor_inhibitor']\ncheck['size'] = 1\ncheck.loc[check['mtor_inhibitor']==1, 'size'] = 5","45f3fa05":"fig = px.scatter_3d(\n    check, \n    x='g-599', \n    y='g-165',\n    z='g-699', \n    color='mtor_inhibitor', \n    size=\"size\",\n    height=SCATTER_SIZE,\n    width=SCATTER_SIZE,\n    title='Scatter plot for mtor_inhibitor'\n)\n\nfig.show()","224c5b64":"plot_combined_histograms(\n    plot_list=['g-599', 'g-165', 'g-699'], \n    name='mtor_inhibitor'\n)","8fcc12c1":"plot_histograms('g-599')","47d3eea9":"plot_histograms('g-165')","48e811aa":"plot_histograms('g-699')","0aae479d":"check = train[['g-392', 'g-361', 'c-48']]\ncheck['tubulin_inhibitor'] = train_target['tubulin_inhibitor']\ncheck['size'] = 1\ncheck.loc[check['tubulin_inhibitor']==1, 'size'] = 5","d61b49e7":"fig = px.scatter_3d(\n    check, \n    x='g-392', \n    y='g-361',\n    z='c-48', \n    color='tubulin_inhibitor', \n    size=\"size\",\n    height=SCATTER_SIZE,\n    width=SCATTER_SIZE,\n    title='Scatter plot for tubulin_inhibitor'\n)\n\nfig.show()","5bcd417f":"plot_combined_histograms(\n    plot_list=['g-392', 'g-361', 'c-48'], \n    name='tubulin_inhibitor'\n)","e51c90a9":"plot_histograms('g-392')","3dbac84b":"plot_histograms('g-361')","f85a879c":"plot_histograms('c-48')","a089502f":"check = train[['g-476', 'g-619', 'g-705']]\ncheck['hdac_inhibitor'] = train_target['hdac_inhibitor']\ncheck['size'] = 1\ncheck.loc[check['hdac_inhibitor']==1, 'size'] = 5","d4761b58":"fig = px.scatter_3d(\n    check, \n    x='g-476', \n    y='g-619',\n    z='g-705', \n    color='hdac_inhibitor', \n    size=\"size\",\n    height=SCATTER_SIZE,\n    width=SCATTER_SIZE,\n    title='Scatter plot for hdac_inhibitor'\n)\n\nfig.show()","43198b3b":"plot_combined_histograms(\n    plot_list=['g-476', 'g-619', 'g-705'], \n    name='hdac_inhibitor'\n)","899dac7d":"plot_histograms('g-476')","7a0b43aa":"plot_histograms('g-619')","fbfba22b":"plot_histograms('g-705')","f4d2d323":"plot_combined_histograms(['g-392', 'g-206', 'g-100'], 'cyclooxygenase_inhibitor')","825d1944":"plot_histograms('g-392')","6207c4a2":"plot_histograms('g-206')","3d657b64":"plot_histograms('g-100')","4eefee43":"count = 0\nfor col in train.columns:\n    if col in ['sig_id', 'cp_type', 'cp_time', 'cp_dose']:\n        continue\n    if stats.ttest_ind(train[col], test[col]).pvalue < 0.01:\n        print(col, stats.ttest_ind(train[col], test[col]).pvalue)\n        count += 1","8deddcfb":"print('Number of features with non acepted 0 hypothesis:', count)","76b828ed":"Let's go depeer for every column.","c3158127":"Let's use t-test for all features and check features with p-value < 0.05.","5bb5e4ae":"For target columns 'atp-sensitive_potassium_channel_antagonist' and 'erbb2_inhibitor' all rows are 0 where cp_dose == 'D2'.","c03f517a":"<h1><center>Mechanisms of Action (MoA) Prediction. Interesting findings<\/center><\/h1>\n\n<center><img src=\"https:\/\/pharmacyinnovations.net\/wp-content\/uploads\/pillsdrugs.png\"><\/center>","68e1fefd":"For target columns 'atp-sensitive_potassium_channel_antagonist' and 'erbb2_inhibitor' all rows are 0 also where cp_time != 48.","07b7edd4":"Let's check column 'proteasome_inhibitor' with columns c-31, c-32, c-78.","00e3038f":"I think already all teams use inside that all targets for cp_type == ctl_vehicle equal to 0. Let's quick check it.","aa56b5f2":"g-635 looks like interesting. ","4b5a8585":"To be honest, both columns have only 1 positive sample so these two hypothesis should be checked via Public Leaderboard.","0f0505e0":"As a result we see for all 3 columns (c-31, c-32, c-78) positive samples proteasome_inhibitor don't greather than -1. I still didn't check this finding for another columns, I just took 3 most correlated columns from train with proteasome_inhibitor."}}