{"cell_type":{"97c89248":"code","94213907":"code","5e3cb8b4":"code","6d025e75":"code","a6cea6e0":"code","eafb0403":"code","6d129c70":"code","e2a07748":"code","74280f13":"code","5e910be1":"code","943bedce":"code","7f91cafa":"code","940d1f46":"code","29348dec":"code","bc9e5500":"code","5f1a3705":"code","55bce716":"code","1598294c":"code","a3847a52":"code","c5137be4":"code","02399b0c":"code","13e08c3d":"code","c630747e":"code","9c0909a4":"code","1f3d6386":"code","4e2fe05c":"code","c4b53855":"code","8e01cb57":"code","0842062c":"code","54a70377":"code","a1109206":"code","322fba0e":"code","ad41edd2":"code","154d7213":"code","82483b4b":"code","ed1ba51a":"code","f84d53fe":"code","f23a2c7d":"code","5e046163":"code","b81398ef":"code","0922ac57":"code","11ab5ee5":"code","816f3c0d":"code","abee4e52":"code","f5c01a99":"code","3c7f98f2":"code","2edcde8a":"code","32d39f9b":"code","95b7a65d":"code","d182d69d":"code","a60a889c":"code","1400ccd7":"markdown","16eef930":"markdown","31f71314":"markdown","307d007b":"markdown","473f45ce":"markdown","af787c5e":"markdown","7f15e064":"markdown","8f26eb61":"markdown","2a5ea995":"markdown","afeef537":"markdown","a9702cc5":"markdown","f0f0bbf4":"markdown","6a75242d":"markdown","06fd2aae":"markdown","322efe16":"markdown","e11856bc":"markdown","beeb2f0c":"markdown","56020f82":"markdown","8af3135b":"markdown","c49916bb":"markdown","2a555ea6":"markdown","7b8db6fc":"markdown","1eeb1c34":"markdown","1dbb5113":"markdown","ad3d0343":"markdown","af436082":"markdown","21943d13":"markdown","5be73c94":"markdown","b280b794":"markdown","cee75633":"markdown","19c52897":"markdown","ee05bdea":"markdown","05029ce9":"markdown","7598d57e":"markdown","7137f84b":"markdown","966e6ff2":"markdown","b5a87068":"markdown","452e3faf":"markdown","f164f9e5":"markdown"},"source":{"97c89248":"import pandas as pd\nimport numpy as np\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\nimport matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport seaborn as sns\nsns.set(color_codes=True)","94213907":"df=pd.read_csv('..\/input\/telco-customer-churn\/WA_Fn-UseC_-Telco-Customer-Churn.csv')\ndf.head()","5e3cb8b4":"df.info()","6d025e75":"df.TotalCharges = pd.to_numeric(df.TotalCharges, errors='coerce')\ndf.isnull().sum()","a6cea6e0":"df.dropna(inplace = True)","eafb0403":"df1 = df.iloc[:,1:]\n\n#transform to binary code\ndf1['Churn'].replace(to_replace='Yes', value=1, inplace=True)\ndf1['Churn'].replace(to_replace='No',  value=0, inplace=True)\n\ndf_dummies = pd.get_dummies(df1)\ndf_dummies.head()\n","6d129c70":"# Statictice information and Variables relationshipe\ndf_dummies.describe()","e2a07748":"# correlation in glimps:\ndf_corr= df_dummies.iloc[:,0:]\n\nplt.figure(figsize=(20,5))\ndf_corr.corr()['Churn'].sort_values(ascending = False).plot(kind='bar')","74280f13":"\nfigure, axes = plt.subplots(nrows=1, ncols=4,figsize=(16,4))\n\ntotal = float(len(df)) \nax=sns.countplot(x=\"gender\", data=df, palette=\"Blues_d\",ax=axes[0])\nfor p in ax.patches:\n    height = p.get_height()\n    ax.text(p.get_x()+p.get_width()\/2.,\n            height + 3,\n            '{:1.2f}'.format(height\/total),\n            ha=\"center\")\n    ax.set_box_aspect(3\/len(ax.patches))\n    \ntotal = float(len(df))\nax=sns.countplot(x=\"SeniorCitizen\", data=df, palette=\"Blues_d\",ax=axes[1])\nfor p in ax.patches:\n    height = p.get_height()\n    ax.text(p.get_x()+p.get_width()\/2.,\n            height + 3,\n            '{:1.2f}'.format(height\/total),\n            ha=\"center\")\n    ax.set_box_aspect(3\/len(ax.patches))\n    \ntotal = float(len(df)) \nax=sns.countplot(x=\"Partner\", data=df, palette=\"Blues_d\",ax=axes[2])\nfor p in ax.patches:\n    height = p.get_height()\n    ax.text(p.get_x()+p.get_width()\/2.,\n            height + 3,\n            '{:1.2f}'.format(height\/total),\n            ha=\"center\")\n    ax.set_box_aspect(3\/len(ax.patches))\n\ntotal = float(len(df)) \nax=sns.countplot(x=\"Dependents\", data=df, palette=\"Blues_d\",ax=axes[3])\nfor p in ax.patches:\n    height = p.get_height()\n    ax.text(p.get_x()+p.get_width()\/2.,\n            height + 3,\n            '{:1.2f}'.format(height\/total),\n            ha=\"center\")\n    ax.set_box_aspect(3\/len(ax.patches))\n\nplt.show()\n ","5e910be1":"figure, axes = plt.subplots(nrows=2, ncols=2,figsize=(12,10))\n\ntotal = float(len(df)) \nax = sns.countplot(x=\"Churn\", data=df,hue='gender', palette=\"Greens_d\", ax=axes[0,0])\nfor p in ax.patches:\n    height = p.get_height()\n    ax.text(p.get_x()+p.get_width()\/2.,\n            height + 3,\n            '{:1.2f}'.format(height\/total),\n            ha=\"center\")\n\ntotal = float(len(df)) \nax = sns.countplot(x=\"Churn\", data=df,hue='SeniorCitizen', palette=\"Greens_d\",ax=axes[0,1])\nfor p in ax.patches:\n    height = p.get_height()\n    ax.text(p.get_x()+p.get_width()\/2.,\n            height + 3,\n            '{:1.2f}'.format(height\/total),\n            ha=\"center\")\n\ntotal = float(len(df)) \nax = sns.countplot(x=\"Churn\", data=df,hue='Partner', palette=\"Greens_d\", ax=axes[1,0])\nfor p in ax.patches:\n    height = p.get_height()\n    ax.text(p.get_x()+p.get_width()\/2.,\n            height + 3,\n            '{:1.2f}'.format(height\/total),\n            ha=\"center\")\n    \ntotal = float(len(df)) \nax = sns.countplot(x=\"Churn\", data=df,hue='Dependents', palette=\"Greens_d\", ax=axes[1,1])\nfor p in ax.patches:\n    height = p.get_height()\n    ax.text(p.get_x()+p.get_width()\/2.,\n            height + 3,\n            '{:1.2f}'.format(height\/total),\n            ha=\"center\")\n\nplt.show()","943bedce":"f, ax = plt.subplots(figsize=(5,5))\ntotal = float(len(df)) \nax = sns.countplot(x=\"Churn\", data=df, palette=\"Oranges_d\")\nfor p in ax.patches:\n    height = p.get_height()\n    ax.text(p.get_x()+p.get_width()\/2.,\n            height + 3,\n            '{:1.2f}'.format(height\/total),\n            ha=\"center\")","7f91cafa":"f, ax = plt.subplots(figsize=(10, 5))\nax = sns.distplot(df['tenure'], hist=True, kde=False, \n             bins=36, color = 'blue')\n\n","940d1f46":"figure, axes = plt.subplots(nrows=1, ncols=3,figsize=(15,4))\n\ntotal = float(len(df)) \nax = sns.countplot(x=\"Contract\", data=df, palette=\"Blues_d\", ax=axes[0])\nax.set_xticklabels(ax.get_xticklabels(),rotation=60)\nfor p in ax.patches:\n    height = p.get_height()\n    ax.text(p.get_x()+p.get_width()\/2.,\n            height + 3,\n            '{:1.2f}'.format(height\/total),\n            ha=\"center\")\nax.set_box_aspect(3\/len(ax.patches))\n\ntotal = float(len(df)) \nax = sns.countplot(x=\"PaymentMethod\", data=df, palette=\"Blues_d\", ax=axes[1])\nax.set_xticklabels(ax.get_xticklabels(),rotation=60)\nfor p in ax.patches:\n    height = p.get_height()\n    ax.text(p.get_x()+p.get_width()\/2.,\n            height + 3,\n            '{:1.2f}'.format(height\/total),\n            ha=\"center\")\n\n    \ntotal = float(len(df)) \nax = sns.countplot(x=\"PaperlessBilling\", data=df, palette=\"Blues_d\",  ax=axes[2])\nfor p in ax.patches:\n    height = p.get_height()\n    ax.text(p.get_x()+p.get_width()\/2.,\n            height + 3,\n            '{:1.2f}'.format(height\/total),\n            ha=\"center\")\nax.set_box_aspect(3\/len(ax.patches))\n        \nplt.show()","29348dec":"services = ['PhoneService','MultipleLines','InternetService','OnlineSecurity',\n           'OnlineBackup','DeviceProtection','TechSupport','StreamingTV','StreamingMovies']\ntotal = float(len(df))\nfig, axes = plt.subplots(nrows = 3,ncols = 3,figsize = (20,20))\nfor i, item in enumerate(services):\n    if i < 3:\n        ax = df[item].value_counts().plot(kind = 'bar',ax=axes[i,0],rot = 0)\n        for p in ax.patches:\n            height = p.get_height()\n            ax.text(p.get_x()+p.get_width()\/2.,\n            height + 3,\n            '{:1.2f}'.format(height\/total),\n            ha=\"center\")\n        \n    elif i >=3 and i < 6:\n        ax = df[item].value_counts().plot(kind = 'bar',ax=axes[i-3,1],rot = 0)\n        for p in ax.patches:\n            height = p.get_height()\n            ax.text(p.get_x()+p.get_width()\/2.,\n            height + 3,\n            '{:1.2f}'.format(height\/total),\n            ha=\"center\")\n    \n    elif i < 9:\n        ax = df[item].value_counts().plot(kind = 'bar',ax=axes[i-6,2],rot = 0)\n        for p in ax.patches:\n            height = p.get_height()\n            ax.text(p.get_x()+p.get_width()\/2.,\n            height + 3,\n            '{:1.2f}'.format(height\/total),\n            ha=\"center\")\n    ax.set_title(item)","bc9e5500":"f, ax = plt.subplots(figsize=(10, 5))\nax = sns.distplot(df['MonthlyCharges'], hist=True, kde=False, \n             bins=60, color = 'blue')","5f1a3705":"f, ax = plt.subplots(figsize=(10, 5))\nax = sns.distplot(df['TotalCharges'], hist=True, kde=False, \n             bins=60, color = 'blue')","55bce716":"figure, axes = plt.subplots(nrows=2, ncols=3,figsize=(20,8))\n\nax= sns.boxplot(x=\"Churn\", y=\"tenure\", data=df, dodge=False, ax=axes[0,0]);\n\n\nax= sns.boxplot(x=\"Churn\", y=\"TotalCharges\", data=df, dodge=False,  ax=axes[0,1]);\n\n\nax= sns.boxplot(x=\"Churn\", y=\"MonthlyCharges\", data=df, dodge=False,  ax=axes[0,2]);\n\n\n\ntotal = float(len(df)) \nax = sns.countplot(x=\"Contract\",hue=\"Churn\", data=df, palette=\"Greens_d\",  ax=axes[1,0])\nax.set_xticklabels(ax.get_xticklabels(),rotation=60)\nfor p in ax.patches:\n    height = p.get_height()\n    ax.text(p.get_x()+p.get_width()\/2.,\n            height + 3,\n            '{:1.2f}'.format(height\/total),\n            ha=\"center\")\n\ntotal = float(len(df))\nax = sns.countplot(x=\"PaymentMethod\",hue=\"Churn\", data=df, palette=\"Greens_d\",  ax=axes[1,1])\nax.legend(loc='best',prop={'size':7},title = 'Churn')\nax.set_xticklabels(ax.get_xticklabels(),rotation=60)\nfor p in ax.patches:\n    height = p.get_height()\n    ax.text(p.get_x()+p.get_width()\/2.,\n            height + 3,\n            '{:1.2f}'.format(height\/total),\n            ha=\"center\")\n\n            \ntotal = float(len(df)) \nax = sns.countplot(x=\"PaperlessBilling\",hue=\"Churn\", data=df, palette=\"Greens_d\",  ax=axes[1,2])\nfor p in ax.patches:\n    height = p.get_height()\n    ax.text(p.get_x()+p.get_width()\/2.,\n            height + 3,\n            '{:1.2f}'.format(height\/total),\n            ha=\"center\")\nax.set_box_aspect(3\/len(ax.patches))\n\n\nplt.show()","1598294c":"from scipy import stats, integrate\nfrom sklearn import metrics\nfrom sklearn.model_selection import train_test_split","a3847a52":"y = df_dummies['Churn'].values\nx = df_dummies.drop(columns = ['Churn'])\n\nfrom sklearn.preprocessing import MinMaxScaler\nfeatures = x.columns.values\nscaler = MinMaxScaler(feature_range = (0,1))\nscaler.fit(x)\nx = pd.DataFrame(scaler.transform(x))\nx.columns = features","c5137be4":"from sklearn.model_selection import train_test_split\nx_train, x_test,y_train,y_test=train_test_split(x, y, test_size=0.2, random_state=0)","02399b0c":"from sklearn import tree\ndt_model= tree.DecisionTreeClassifier()\ndt_model.fit(x_train,y_train)","13e08c3d":"dt_scored=dt_model.score(x_test,y_test)\ndt_scored","c630747e":"dt_predicted=dt_model.predict(x_test)\ndt_predicted","9c0909a4":"importances = dt_model.feature_importances_\nweights = pd.Series(importances,\n                 index=x.columns.values)\nweights.sort_values()[-10:].plot(kind ='barh')","1f3d6386":"importances = dt_model.feature_importances_\nweights = pd.Series(importances,\n                 index=x.columns.values)\nweights.sort_values()[:10].plot(kind = 'barh')","4e2fe05c":"from sklearn.ensemble import RandomForestClassifier\nrfc_model = RandomForestClassifier(max_depth=20, random_state=0)\nrfc_model.fit(x_train,y_train)","c4b53855":"rfc_scored=rfc_model.score(x_test,y_test)\nrfc_scored","8e01cb57":"importances = rfc_model.feature_importances_\nweights = pd.Series(importances,\n                 index=x.columns.values)\nweights.sort_values()[-10:].plot(kind = 'barh')","0842062c":"importances = rfc_model.feature_importances_\nweights = pd.Series(importances,\n                 index=x.columns.values)\nweights.sort_values()[:10].plot(kind = 'barh')","54a70377":"from sklearn.model_selection import train_test_split\nx_train, x_test,y_train,y_test=train_test_split(x, y, test_size=0.3, random_state=0)\nfrom sklearn.linear_model import LogisticRegression\nlogr_model= LogisticRegression()\nresult = logr_model.fit(x_train, y_train)","a1109206":"logr_score=logr_model.score(x_test,y_test)\nlogr_score","322fba0e":"weights = pd.Series(logr_model.coef_[0],\n                 index=x.columns.values)\nprint (weights.sort_values(ascending = False)[:10].plot(kind='bar'))","ad41edd2":"weights = pd.Series(logr_model.coef_[0],\n                 index=x.columns.values)\nprint (weights.sort_values(ascending = False)[-10:].plot(kind='bar'))","154d7213":"df_dummies['Frequency']= (df_dummies['tenure']\/\/24)*df_dummies['Contract_Two year']\nprint(df_dummies['Frequency'].max(), df_dummies['Frequency'].min())","82483b4b":"df_dummies['MonetaryValue']=df_dummies['TotalCharges']","ed1ba51a":"df_lc= df_dummies.loc[:,['tenure','MonetaryValue','Frequency']]\ndf_lc.head()","f84d53fe":"df_lc.describe()","f23a2c7d":"df_lc['MonetaryValue']=np.log(df_lc['MonetaryValue'])\ndf_lc['tenure']=np.log(df_lc['tenure'])\nfrom sklearn.preprocessing import StandardScaler\nscaler = StandardScaler()\nscaler.fit(df_lc)\ndf_lc_normalized = scaler.transform(df_lc)\nprint('mean: ', df_lc_normalized.mean(axis=0).round(2))\nprint('std: ', df_lc_normalized.std(axis=0).round(2))","5e046163":"from sklearn.cluster import KMeans\nimport seaborn as sns\nfrom matplotlib import pyplot as plt\n\nsse = {}\nfor k in range(1, 11):\n    kmeans = KMeans(n_clusters=k, random_state=1)\n    kmeans.fit(df_lc_normalized)\n    sse[k] = kmeans.inertia_\n\nplt.title('The Elbow Method')\nplt.xlabel('k'); plt.ylabel('SSE')\nsns.pointplot(x=list(sse.keys()), y=list(sse.values()))\nplt.show()","b81398ef":"from sklearn.cluster import KMeans\nkmeans = KMeans(n_clusters=3, random_state=1)\nkmeans.fit(df_lc_normalized)\ncluster_attribute_labels = kmeans.labels_","0922ac57":"cluster_labels = kmeans.labels_\ndf_lc_k3=df_lc.assign(Cluster = cluster_labels)","11ab5ee5":"df_lc_k3.groupby(['Cluster']).agg({\n'tenure': 'mean'\n,\n'Frequency': 'mean'\n,\n'MonetaryValue': ['mean','count'],\n}).round(0)","816f3c0d":"df_lc_normalized = pd.DataFrame(df_lc_normalized,index= df_lc.index,columns= df_lc.columns)\ndf_lc_normalized['Cluster'] = df_lc_k3['Cluster']","abee4e52":"df_lc_melt = pd.melt(df_lc_normalized.reset_index(),\n                     id_vars=['Cluster'],\n                     value_vars=['tenure','MonetaryValue','Frequency'],\n                     var_name='Attribute',\n                     value_name='Value')","f5c01a99":"plt.title('Snake plot of standardized variables')\nsns.lineplot(x=\"Attribute\", y=\"Value\", hue='Cluster', data=df_lc_melt)","3c7f98f2":"kmeans = KMeans(n_clusters=4, random_state=1)\nkmeans.fit(df_lc_normalized)\ncluster_attribute_labels = kmeans.labels_","2edcde8a":"cluster_labels = kmeans.labels_\ndf_lc_k4=df_lc.assign(Cluster = cluster_labels)","32d39f9b":"df_lc_k4.groupby(['Cluster']).agg({\n'tenure': 'mean'\n,\n'Frequency': 'mean'\n,\n'MonetaryValue': ['mean','count'],\n}).round(0)","95b7a65d":"import scipy.cluster.hierarchy as sch\nplt.figure(figsize=(8,8))\ndendrogram = sch.dendrogram(sch.linkage(df_lc_normalized, method = 'ward'))\nplt.title('Dendrogram')\nplt.xlabel('Customers')\nplt.ylabel('Euclidean distances')\nplt.show()","d182d69d":"x=df_lc_normalized[:]\nfrom sklearn.cluster import AgglomerativeClustering\nhc = AgglomerativeClustering(n_clusters = 3, affinity = 'euclidean', linkage = 'ward')\ny_hc = hc.fit_predict(x)","a60a889c":"x= np.array(x)\nplt.figure(figsize=(6,6))\nplt.scatter(x[y_hc == 0, 0],x[y_hc == 0, 1], s = 100, c = 'red',label='Cluster0')\nplt.scatter(x[y_hc == 1, 0],x[y_hc == 1, 1], s = 100, c = 'blue',label='Cluster1')\nplt.scatter(x[y_hc == 2, 0],x[y_hc == 2, 1], s = 100, c = 'green',label='Cluster2')\nplt.title('Clusters of customers using Hierarchical Clustering')\nplt.legend()\nplt.show()","1400ccd7":"#### Relationship between demographic Characteristics and Churn","16eef930":"#### Tenure Info:\nTenure is between 1 and 72 month;","31f71314":"### B: Customer Account Information ","307d007b":"#### B: Hierarchical clustering:\nClustering done by Hierarchical method too; first at all optimum number of clusters obtained from dendrogram and clustering visualised by scatter plot. ","473f45ce":"#### Churn distribution\n Churn  of customers from Telco is not equally distributed.","af787c5e":"#### Scaling: \nThe df_dummies dataset was then separated into Y output variable and X input variables. X is then transformed  to ensure that each variable is in a given range on the training set, in this case it is 0,1, the same as the y variable.\n","7f15e064":"Results:\n* The Random forest Classifier out performed the decision tree, with an accuracy score of 79.24 percent and a maximum depth of the model was 20. That said there is a noticeable increase in the false negative result.\n* Logistic Regression have an accuracy score of 79.62 percent and outperforming the other two models.\n* The random forest model is outperforming the other two models.\n* Total charges, monthly contracts and tenure are the most important features affect on churn accordingly tenure,total charges and contract-two year(vs. monthly contract) could be considered for recognizing loyal customers.","8f26eb61":"#### Charges:\nThe large number of customers have low charges and some of  the total charges increases as the monthly bill for a customer increases. ","2a5ea995":"##### Choosing a number of clusters:\n In order to ensure that too much modeling of the data is not given,the elbow method is used to determine optimal number of clusters. ","afeef537":"Observations:\n* Persons on monthly contracts, among those who have churned, are most likely to do leave.\n* Tenure ranges from 1 to 72 months, persons with tenures more than 30 months seem most likely to remain with the company.\n* those who churned, persons who opt for Paper Billing have a lower rate of churn.\n* Automatic payments (Credit card, Bank transfer) show lower levels of churn.\n* Higher percent of customers churn when the monthly charges are high while there is higher churn when the total charges are lower.\n","a9702cc5":"#### Contract,PaymentMethod,Billing info:\n* most of the customers are in the month to month contract and the number of customers in the 1 year and 2 year contracts are almost equal.\n* Electronic check method has the highest number of customers for payment and others almost equal\n* 58% of customers have paperless billing and there are just 10% differences with paper billing. ","f0f0bbf4":"#### B: Random Forest","6a75242d":"#### Services info:\nPhone services have a higher number of customers and other services almost in the same range. ","06fd2aae":"cluster 1 is the best cluster in Hierarchical Clustering.","322efe16":"#### Splitting testing and training the data:\nA 20\/80 testing and training split was applied.","e11856bc":"## Modeling\n### Supervised Learning:\nThree classification models were used to predict the likelihood of customer churn and find important factors affect on churn:\n* Decision Tree\n* Random Forest\n* Logistic Regression\n","beeb2f0c":"The combination of 3 lines are not joined on the Y-axis from 50 to 140, for about 90 units. So, the optimal number of clusters will be 3 for hierarchical clustering. ","56020f82":"- Recency: unfortunately we dont have last contract date of customers and this attribute could not be calculated whit Teleco dataset information. \n- Frequency: this attribute could be observed by time of contract and tenure\n- MonetaryValue: we could find this kind of loyal customer by total charges\n","8af3135b":"# <div >Data Exploration<\/div>","c49916bb":"It seems that cluster 2 is desired cluster for loyal customer segmentation\n\n##### Analyzing average of each clusters:\nFor average of clusters analysis the clustering done for  K=4 and result shown in below:","2a555ea6":"#### A: Clustering using K-means method\nKey steps done as flowing:\n* Data pre-processing\n* Choosing a number of clusters\n* Running k-means clustering on pre-processed data \n* Analyzing average of each cluster\n","7b8db6fc":"#### C: Logistic Regression","1eeb1c34":"#### Distribution of Demographic variables ( Gender, Senior citizen, Partner and Dependent):","1dbb5113":"#### Relationship Between Churn and Customer info:","ad3d0343":"##### Data pre-processing done in below steps:\n* Defining Three atributs(Frequency, MonetaryValue and tenure) as loyalty characteristics.\n* Removing skew and Normalizing","af436082":"Based on Elbow graph The optimum point for clustering is K=3","21943d13":"The figure shows:\n* Correlation of gender, SeniorCitizen, Partner and Dependents with Churn are low. \n* Month to month contracts, absence of online security and tech support seem to be positively correlated with churn.While, tenure, two year contracts seem to be negatively correlated with churn.\n* It seems that 'OnlineSecurity','TechSupport','InternetService_DSL','OnlineBackup','DeviceProtection' have lower correlation whith churn.","5be73c94":" For data exploration at first I will look at the distribution of individual variables and then check relation of the with churn.The variables are seen in two groups:Demography and customer account information.","b280b794":"##### Running k-means clustering:","cee75633":"Researches show that the cost of find new customer for each company is 5 time more than Cost of retaining current customers thuse the loyal customer are gold for each company.","19c52897":"Comparing between mean tables with k=3 and k=4 shows that optimal cluster has not changing.","ee05bdea":"#### Data preparation:\nAs following the code  used to, first convert the argument to a numeric data type as well as the process of assessing the dataset for missing values, there were 11 missing values. ","05029ce9":"Demography Results:\n* Half of the customers are male and the other half are female\n* 16% of the customers are senior citizens and most of customers are younger people.\n* About 50% of the customers have a partner\n* 30% of the total customers have dependents.","7598d57e":"Observations:\n* Both Genders seem to churn at a similar rate. \n* Customers considered Senior Citizens have a significantly higher rate of churn.\n* Customers with a partner seem less likely to churn.\n* While customers without dependents are less likely to churn in general, they make up the bulk of customers who have churn.","7137f84b":"-For cluster loyal customer I got help from RFM Model as following:","966e6ff2":"### Unsupervised learning:\n#### <div style= \"color:green\">Loyal customer clustering<\/div>\nIn this section Loyal customers are clustered by 2 methods: K_means and Hierarchical method\n","b5a87068":"#### A: Decsion Trees ","452e3faf":"### A. Check Demography of Dataset","f164f9e5":"***\n# Telecom-loyal Customer\n\n## Data understanding\n***\n\u00b6\nThe reason for selecting Telecom-Customer dataset is to find factors affecting on customer churn and cluster loyal customers.\n\nContent: Each row represents a customer, each column contains customer\u2019s attributes as described in the column Metadata.\n\nThe data set includes information about:\n* Customers who left or stayed with Telco \u2013 the column is called Churn\n* Services each customer has signed up for \u2013 phone, multiple lines, internet, online security, online backup, device protection, tech support, and streaming TV and movies\n* Customer account information \u2013 customer tenure, contract Length, payment methods, paperless billin option, monthly charges, and total charges\n* Demographic info about customers \u2013 gender, age, and if they have partners and dependents"}}