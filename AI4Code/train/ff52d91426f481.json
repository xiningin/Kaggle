{"cell_type":{"f2a8687f":"code","5c650c3d":"code","cb73ea42":"code","b2afe29c":"code","30961f29":"code","4d784879":"code","b79f3f48":"code","f32364e2":"code","6a4803de":"code","a9fb5494":"code","fd757d2e":"code","05ec93af":"code","45953542":"code","6961e31a":"code","9bb6d266":"code","5a21a114":"code","0c151951":"code","a0c225d6":"code","1bbc26f9":"code","9161d772":"code","7346e81c":"code","f5b43966":"code","62f96661":"code","f96334cc":"code","1927ce92":"code","8356c08f":"code","fdd4ce36":"code","4bec5326":"code","23e1fea8":"code","60f0cf9e":"code","daa1f833":"code","ad3a837c":"code","80832991":"code","85c92789":"code","707cd94c":"code","e6c30bbf":"code","00509d4d":"code","ecec97e6":"code","0b808b0f":"code","b5028ec8":"code","88b00e7a":"code","8fb626c4":"code","f226884e":"code","b253fddb":"code","eb1aabc0":"code","dc6e5361":"code","5338753a":"code","1095eaa7":"code","b2b27a02":"code","a50cbb47":"code","c66a793d":"code","abbfe994":"code","3ce7ea61":"code","314b0669":"code","fe68f26d":"code","659293d0":"markdown","1e235b2a":"markdown","417d9f2d":"markdown","2e68081d":"markdown","7652b0f9":"markdown","86d5cd2b":"markdown","fc07a5a2":"markdown","19f4afd8":"markdown","bb2c71cf":"markdown","99297442":"markdown","45022f30":"markdown","38fc95e4":"markdown","74533d11":"markdown","b36ae1db":"markdown","4cf1bbb6":"markdown","77e40e6b":"markdown","530e637d":"markdown"},"source":{"f2a8687f":"# This Python 3 environment comes with many helpful analytics libraries installed\r\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\r\n# For example, here's several helpful packages to load\r\n\r\nimport numpy as np # linear algebra\r\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\r\n\r\n# Input data files are available in the read-only \"..\/input\/\" directory\r\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\r\n\r\n#import os\r\n#for dirname, _, filenames in os.walk('\/kaggle\/input'):\r\n #   for filename in filenames:\r\n  #      print(os.path.join(dirname, filename))\r\n\r\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \r\n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","5c650c3d":"df_fish = pd.read_csv('..\/input\/fish-market\/Fish.csv')","cb73ea42":"df_fish.head()","b2afe29c":"df_fish.info()","30961f29":"np.sum(df_fish.isnull())","4d784879":"df_fish.dtypes","b79f3f48":"print('length 1')\nprint(df_fish['Length1'].min())\nprint(df_fish['Length1'].max())\n\nprint('length 2')\nprint(df_fish['Length2'].min())\nprint(df_fish['Length2'].max())\n\nprint('length 3')\nprint(df_fish['Length3'].min())\nprint(df_fish['Length3'].max())","f32364e2":"import matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set_style('darkgrid')","6a4803de":"sns.heatmap(df_fish.corr(),annot=True,cbar=False);","a9fb5494":"sns.countplot(x=df_fish['Species']);","fd757d2e":"plt.figure(figsize=(12,6))\nsns.lineplot(x=df_fish['Weight'],y=df_fish['Length1'])\nsns.lineplot(x=df_fish['Weight'],y=df_fish['Length2'])\nsns.lineplot(x=df_fish['Weight'],y=df_fish['Length3'])\nplt.ylabel('Lengths')","05ec93af":"sns.scatterplot(x=df_fish['Width'],y=df_fish['Height'])","45953542":"df_fish.groupby(['Species']).agg({'Weight':['mean','std','count','max','min']})","6961e31a":"df_3fish = df_fish[df_fish['Species'].isin(['Bream','Perch','Whitefish'])]","9bb6d266":"d = sns.FacetGrid(data=df_3fish,col='Species')\nd.map(sns.histplot,'Weight',kde=True);","5a21a114":"df_fish[df_fish['Species'].isin(['Whitefish'])]","0c151951":"df_3fish[df_3fish['Weight']> 250]","a0c225d6":"df_fish.groupby(['Species']).mean()","1bbc26f9":"df_fish.groupby(['Species']).agg({'Weight':['count','max','min']})","9161d772":"df_fish[df_fish['Weight'] <=0]","7346e81c":"df_fish[df_fish['Species'] == 'Roach']","f5b43966":"df_fish =  df_fish.drop([40],axis=0);","62f96661":"df_fish.loc[39:41,:]","f96334cc":"df_dummy = pd.get_dummies(df_fish['Species'],drop_first=True);","1927ce92":"df_fish = df_fish.drop('Species',axis=1);","8356c08f":"df_final = pd.concat([df_fish,df_dummy],axis=1)","fdd4ce36":"df_final.head()","4bec5326":"X = df_final.drop('Weight',axis=1)\r\ny = df_final['Weight'];","23e1fea8":"from sklearn.model_selection import train_test_split\r\nfrom sklearn.preprocessing import StandardScaler","60f0cf9e":"X_train,X_test, y_train, y_test = train_test_split(X,y, test_size=0.3 ,random_state= 42)","daa1f833":"scaler = StandardScaler()","ad3a837c":"scaler.fit(X_train)","80832991":"X_train = scaler.transform(X_train)\r\nX_test = scaler.transform(X_test)","85c92789":"from sklearn.linear_model import LinearRegression, ElasticNet","707cd94c":"linear_model = LinearRegression()","e6c30bbf":"linear_model.fit(X_train,y_train)","00509d4d":"y_pred = linear_model.predict(X_test)","ecec97e6":"linear_model.coef_","0b808b0f":"from sklearn.metrics import r2_score,mean_squared_error,mean_absolute_error;","b5028ec8":"Mae = mean_absolute_error(y_test,y_pred)\r\nMSE = mean_squared_error(y_test,y_pred)\r\nRMSE = np.sqrt(MSE)\r\nr2 = r2_score(y_test,y_pred)","88b00e7a":"print(Mae)\r\nprint(MSE)\r\nprint(RMSE)\r\nprint(r2)","8fb626c4":"residuals = y_test - y_pred","f226884e":"sns.scatterplot(x=y_pred,y=y_test)\r\nplt.xlabel('predicted Weight')","b253fddb":"sns.scatterplot(x=y_test,y=residuals)\r\nplt.axhline(y=0, color='r', linestyle='--')","eb1aabc0":"sns.displot(residuals,bins=25,kde=True)","dc6e5361":"from sklearn.linear_model import ElasticNet\r\nfrom sklearn.model_selection import GridSearchCV;","5338753a":"elastic_model = ElasticNet()","1095eaa7":"param_grid = {'alpha':[0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1,1.5],'l1_ratio':[.1,.2,.3,.4,.5, .6,.7, .9, .95, .99, 1]}","b2b27a02":"# verbose number a personal preference\r\ngrid_model = GridSearchCV(estimator=elastic_model,\r\n                          param_grid=param_grid,\r\n                          scoring='neg_mean_squared_error',\r\n                          cv=5)","a50cbb47":"grid_model.fit(X_train,y_train)","c66a793d":"grid_model.best_estimator_","abbfe994":"grid_model.best_params_","3ce7ea61":"y_pred = grid_model.predict(X_test);","314b0669":"Mae = mean_absolute_error(y_test,y_pred)\r\nMSE = mean_squared_error(y_test,y_pred)\r\nRMSE = np.sqrt(MSE)\r\nr2 = r2_score(y_test,y_pred)","fe68f26d":"print(Mae)\r\nprint(MSE)\r\nprint(RMSE)\r\nprint(r2)","659293d0":"**see correlation between the numeric values**","1e235b2a":"**a certain Roach fish has a weight of zero. is this an error ? can a fish have zero weight. let's find out**","417d9f2d":"### Understand the predictions using metrics","2e68081d":"## Build Model","7652b0f9":"## Perfom EDA on Data","86d5cd2b":"## Train Test Split, Formating Data","fc07a5a2":"**from research a roach fish weight can't be zero,this particular fish must have been ommitted or input error,therefore we drop this 0 weight fish**","19f4afd8":"##  Tunning model using elastic net, and hyperparameter using GridSearch","bb2c71cf":"## **DataSet INFO**\n\n**Content**\n\nThis dataset is a record of 7 common different fish species in fish market sales. With this dataset, a predictive model can be performed using machine friendly data and estimate the weight of fish can be predicted.\n\n**Acknowledgements**\n\nThanks to all who make Kernels using this dataset and also people viewed or download this data.\n\n**Inspiration**\n\nMultiple linear regression is a fundamental practice for this dataset. Multivariate analysis can also be performed.","99297442":"**as the height increase so does the width increase. we can also see a close pattern that some fish with possible range difference of 2-4 unit in height can have 1 unit difference in width.**","45022f30":"**the whitefish has a low quantiy compared to the perch fish and Bream. the mean of this whitefish is high. let's find out the density of these fishes to see if\nthese fish are concentrated differently and the model might not mistake this whitefish for another fish due to it's low data set count**","38fc95e4":"## Encode the Categorical variable","74533d11":"### Understand the Data","b36ae1db":"### Using Best Model From GridSearch","4cf1bbb6":"**from observations on the dataset above; this model might not be able to predict the whitefish (for the classification) and may not perform well in predicting the \nweight(regression) of a whitefish due to low dataset count on this whitefish**","77e40e6b":"**from the above we can see that as the fish length goes up so does the weight, also the 3 fish length have close similar values and all follow the close patterns**","530e637d":"**from the above visualization we can see that all the numeric values have a strong correlation with the weight**"}}