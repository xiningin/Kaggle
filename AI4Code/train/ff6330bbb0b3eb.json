{"cell_type":{"7cd8d64e":"code","c435303f":"code","8c397af1":"code","5ff0bc87":"code","78e81d3d":"code","74d048fd":"code","c5ff5061":"code","7ce94729":"markdown","1861bc2c":"markdown","75579a5d":"markdown","19ccb232":"markdown","bffdc8ad":"markdown","7227fbd2":"markdown","08041d83":"markdown","b765f168":"markdown","9819aeb7":"markdown","01214e4f":"markdown","c06b2235":"markdown","77750879":"markdown"},"source":{"7cd8d64e":"import pandas as pd\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_absolute_error\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.tree import DecisionTreeRegressor\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nfrom sklearn import datasets, linear_model","c435303f":"perth_file_path = '..\/input\/perth-temperatures-and-rainfall\/PerthTemperatures.csv'\nptemp_data = pd.read_csv(perth_file_path)\nptemp_data = ptemp_data.dropna(axis=0)\nptemp_data.describe()\n#y1=ptemp_data['Minimum temperature (Degree C)']\n#y1=ptemp_data.Minimum_temperature_(Degree_C)\n#y2=ptemp_data['Maximum temperature (Degree C)']\nyfeatures=['Minimum temperature (Degree C)','Maximum temperature (Degree C)']\nY=ptemp_data[yfeatures]\npfeatures=['Year','Month','Day']\nX=ptemp_data[pfeatures]","8c397af1":"train_X, val_X, train_Y, val_Y = train_test_split(X, Y, random_state = 0)\n#print(train_X+'aa\\n', val_X+'aa\\n', train_y1+'aa\\n', val_y1+'aa\\n', train_y2, val_y2)\n#print(train_X+'aaa\\n\\n\\n\\n\\n\\n')\n#print(val_X+'aaa\\n\\n\\n')\n#print(val_Y+'ddss\\n\\n')\nprint(train_Y)\nprint(val_Y)\n","5ff0bc87":"plt.figure(figsize=(100,30))\nsns.lineplot(data=Y)","78e81d3d":"tmodel= RandomForestRegressor(random_state=1)\ntmodel.fit(train_X,train_Y)\n\n\ntmodel2= DecisionTreeRegressor(random_state=2)\ntmodel2.fit(train_X,train_Y)\n\n\ntmodel3=linear_model.LinearRegression()\ntmodel3.fit(train_X, train_Y)\n","74d048fd":"pred=tmodel.predict(val_X)\n\npred2=tmodel2.predict(val_X)\n\npred3=tmodel3.predict(val_X)\n\n\nprint('prediction of randomforest: \\n',pred)\nprint(\"\\n\\n\")\nprint('prediction of randomforest: \\n',pred2)\nprint(\"\\n\\n\")\nprint('prediction of randomforest: \\n',pred3)\nprint(\"\\n\\n\")\nprint('actual values: \\n',val_Y)","c5ff5061":"print('Mean absolute error of randomforest: \\n',mean_absolute_error(val_Y, pred))\n\nprint('Mean absolute error of decision tree: \\n',mean_absolute_error(val_Y, pred2))\n\nprint('Mean absolute error of linear regression: \\n',mean_absolute_error(val_Y, pred3))\n\nplt.figure(figsize=(100,30))\nsns.lineplot(data=pred-val_Y)\nplt.figure(figsize=(100,30))\nsns.lineplot(data=pred2-val_Y)\nplt.figure(figsize=(100,30))\nsns.lineplot(data=pred3-val_Y)","7ce94729":"### I find that the temperature changes periodicly.","1861bc2c":"# Gathering the data\n### Read file, drop missed values and seperate them into two parts: the date(required data for prediction) and the temperature(values needed to predicted), drop the missing values and waterfall column.","75579a5d":"### Visualize the data using sns","19ccb232":"### After gathering data, dividing them into two parts:features(date) and goals(minimum and maximum temperature)","bffdc8ad":"# Preparing the data\n### Splitting the data into the training group(for building model) and the testing group(for validation)","7227fbd2":"# Setting the code\n### Import the essential functions for reading csv file, models, validation and ploting the graph.","08041d83":"# Choosing Models\n### Using three models: randomforest, decisiontree and linear regression.","b765f168":"### Hypothesis: I believe that randomforest will be the best model because the temperature model should be periodic depending on the days, years and especially months.","9819aeb7":"# Conclusion\n### Randomforest is the best model I choose\n### Month is the feature that affect the result strongest.","01214e4f":"# Making predictions\n\n### Then, calculate the mean absolute errors and comparetofind the best model.","c06b2235":"# Validation\n### Choosing the model with least mean absolute error\n### Plotting the difference between predictions and actual values.","77750879":"# Perth maximum and minimum temperature prediction\n### Purpose: To predict the maximum and minimum temperature in Perth with the date\n### Data description: Data include two parts: dates(years, months, days), maximum temperature, minimum tamperature and waterfall(ignored)\n"}}