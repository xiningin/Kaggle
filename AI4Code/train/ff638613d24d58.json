{"cell_type":{"f5aff9f5":"code","6fcad43e":"code","541381f6":"code","625f944b":"code","657e4923":"code","1a693ffb":"code","d6939a26":"code","aa8e73ec":"code","33a92373":"code","511324d0":"code","3eb31ec3":"code","afa67f6b":"code","96c06649":"code","3733bbe6":"code","5897c799":"code","a61e630d":"code","21cb5d37":"code","506f705e":"code","6359c813":"code","99edad2c":"code","5c5bf725":"code","4daa9544":"code","68561b29":"code","3339a714":"code","74b6185b":"code","700576a4":"code","c6b4ebb8":"markdown"},"source":{"f5aff9f5":"#Inspired by fast.ai Practical Deep Learning for Coders(v3) lession 1","6fcad43e":"%reload_ext autoreload\n%autoreload 2\n%matplotlib inline","541381f6":"from fastai.vision import *\nfrom fastai.metrics import error_rate","625f944b":"bs = 64","657e4923":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport os\nprint(os.listdir('..\/input\/car_data\/car_data'))","1a693ffb":"data_dir='..\/input\/car_data\/car_data'\n\nlist = os.listdir(data_dir) \nnumber_files = len(list)\nprint(number_files)","d6939a26":"path=Path(data_dir)\npath","aa8e73ec":"data = ImageDataBunch.from_folder(path,  \n                                  valid_pct=0.2,\n                                  ds_tfms=get_transforms(do_flip=True,flip_vert=False, max_rotate=90),\n                                  size=224,bs=64, \n                                  num_workers=0).normalize(imagenet_stats)","33a92373":"data.show_batch(rows=3, figsize=(40,40))","511324d0":"print(data.classes)\nlen(data.classes)","3eb31ec3":"learn = create_cnn(data, models.resnet34, metrics=accuracy, model_dir=\"\/tmp\/model\/\")","afa67f6b":"learn.model","96c06649":"learn.fit_one_cycle(10)","3733bbe6":"learn.save('stage-1')","5897c799":"interp = ClassificationInterpretation.from_learner(learn)\n\nlosses,idxs = interp.top_losses()\n\nlen(data.valid_ds)==len(losses)==len(idxs)","a61e630d":"interp.plot_top_losses(9, figsize=(30,25))","21cb5d37":"interp.most_confused(min_val=2)","506f705e":"learn.unfreeze()","6359c813":"learn.fit_one_cycle(10)","99edad2c":"learn.lr_find()","5c5bf725":"\nlearn.recorder.plot()","4daa9544":"learn.unfreeze() \nlearn.fit_one_cycle(4, max_lr=slice(1e-6,1e-4))","68561b29":"learn.save('stage-2')","3339a714":"interp = ClassificationInterpretation.from_learner(learn)","74b6185b":"losses,idxs = interp.top_losses()\n\nlen(data.valid_ds)==len(losses)==len(idxs)","700576a4":"interp.plot_top_losses(9, figsize=(30,25))","c6b4ebb8":"Unfreezing, fine-tuning, and learning rates"}}