{"cell_type":{"8b293d93":"code","1df6c402":"code","dfcc0ac9":"code","ce6f523b":"code","04bdabc4":"code","29adfd81":"code","9cc8f045":"code","9705c606":"code","8b12810e":"code","909476c5":"code","d43beaab":"code","906b8978":"code","ab770416":"code","c06f92f0":"code","3b2d82a3":"code","daaf5669":"code","d757e1de":"code","4a17e941":"code","a377a0a9":"code","7e8ed620":"code","30b32a33":"code","867e7a5e":"code","79e75968":"code","d91ff2af":"code","06a11b18":"markdown","09604bc2":"markdown","de4ee2e7":"markdown","8789d78d":"markdown","a64430d9":"markdown","5435a258":"markdown","59312220":"markdown","eb348983":"markdown","30956d3c":"markdown"},"source":{"8b293d93":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","1df6c402":"import sys\nimport os\nimport PIL\nimport warnings\nimport numpy as np\nimport pandas as pd\nfrom PIL import Image, ImageOps\nimport matplotlib.pyplot as plt\nimport matplotlib.image as mpimg\nfrom sklearn.preprocessing import LabelEncoder\nfrom skimage.io import imread, imshow\nfrom skimage.transform import resize\nfrom skimage.feature import hog\nfrom skimage import exposure\nimport matplotlib.pyplot as plt\nimport lightgbm as lgb\nfrom sklearn.model_selection import train_test_split\n\n%matplotlib inline\n\nwarnings.simplefilter('ignore')","dfcc0ac9":"#Code by Seyedsaman (SAM) Emami https:\/\/www.kaggle.com\/samanemami\/caltech101-feature-extraction-hog\n\npath = '\/kaggle\/input\/mathematical-mathematics-memes\/'\n\n\ninput_path = []\nlabels = []\nfor dirname, _, filenames in os.walk(path):\n    labels.append(_)\n    for file in filenames:\n        input_path.append(os.path.join(dirname, file))\nlabels = labels[0]","ce6f523b":"#Code by Seyedsaman (SAM) Emami https:\/\/www.kaggle.com\/samanemami\/caltech101-feature-extraction-hog\n\nimg = Image.open(input_path[0])\nimg","04bdabc4":"img1 = Image.open(input_path[10])\nimg1","29adfd81":"#Code by Seyedsaman (SAM) Emami https:\/\/www.kaggle.com\/samanemami\/caltech101-feature-extraction-hog\n\nresized_image = img.resize((64, 64))\nresized_image","9cc8f045":"from PIL import Image\n\nimage = Image.open(\"..\/input\/mathematical-mathematics-memes\/math_meme_1022.jpg\")\nimage","9705c606":"#Code by Seyedsaman (SAM) Emami https:\/\/www.kaggle.com\/samanemami\/caltech101-feature-extraction-hog\n\nfd, hog_image = hog(resized_image, orientations=9,\n                    pixels_per_cell=(8, 8),\n                    cells_per_block=(2, 2),\n                    visualize=True,\n                    multichannel=True)","8b12810e":"fd.shape","909476c5":"#Code by Seyedsaman (SAM) Emami https:\/\/www.kaggle.com\/samanemami\/caltech101-feature-extraction-hog\n\nfig, (ax1, ax2) = plt.subplots(1, 2,\n                               figsize=(10, 3),\n                               sharex=True,\n                               sharey=True)\n\nax1.imshow(resized_image, cmap=plt.cm.gray)\nax1.set_title('Input image')\n\nhog_ = exposure.rescale_intensity(hog_image, in_range=(0, 10))\n\nax2.imshow(hog_, cmap=plt.cm.gray)\n\nplt.show()","d43beaab":"#Code by Seyedsaman (SAM) Emami https:\/\/www.kaggle.com\/samanemami\/caltech101-feature-extraction-hog\n\nfeatures = []\nfor i, j in enumerate(input_path[:1000]):\n    pic = ImageOps.grayscale(Image.open(input_path[i]))\n    features.append(feature_extraction(pic))\nfeatures = np.array(features)","906b8978":"#Code by Seyedsaman (SAM) Emami https:\/\/www.kaggle.com\/samanemami\/caltech101-feature-extraction-hog\n\nlb = []\nfor i, j in enumerate(input_path):\n    for k, m in enumerate(labels):\n        if labels[k] in input_path[i]:\n            lb.append(m)\nlb = np.array(lb)","ab770416":"#Code by Seyedsaman (SAM) Emami https:\/\/www.kaggle.com\/samanemami\/caltech101-feature-extraction-hog\n\nX = features\ny = lb[:1000]\nscale = LabelEncoder()\ny = scale.fit_transform(y)","c06f92f0":"#Code by Seyedsaman (SAM) Emami https:\/\/www.kaggle.com\/samanemami\/caltech101-feature-extraction-hog\n\ndf = pd.DataFrame(X)\ndf['label'] = y\ndf.head().T","3b2d82a3":"from PIL import Image\n\nimage1 = Image.open(\"..\/input\/mathematical-mathematics-memes\/math_meme_10001.jpg\")\nimage1","daaf5669":"image2 = Image.open(\"..\/input\/mathematical-mathematics-memes\/math_meme_1004.jpg\")\nimage2","d757e1de":"image3 = Image.open(\"..\/input\/mathematical-mathematics-memes\/math_meme_1008.jpg\")\nimage3","4a17e941":"image4 = Image.open(\"..\/input\/mathematical-mathematics-memes\/math_meme_101.jpg\")\nimage4","a377a0a9":"from PIL import Image\n\nimage5 = Image.open(\"..\/input\/mathematical-mathematics-memes\/math_meme_1013.jpg\")\nimage5","7e8ed620":"image6 = Image.open(\"..\/input\/mathematical-mathematics-memes\/math_meme_1021.jpg\")\nimage6","30b32a33":"image7 = Image.open(\"..\/input\/mathematical-mathematics-memes\/math_meme_1028.jpg\")\nimage7","867e7a5e":"image8 = Image.open(\"..\/input\/mathematical-mathematics-memes\/math_meme_1032.jpg\")\nimage8","79e75968":"image9 = Image.open(\"..\/input\/mathematical-mathematics-memes\/math_meme_1033.jpg\")\nimage9","d91ff2af":"image9 = Image.open(\"..\/input\/mathematical-mathematics-memes\/math_meme_1047.jpg\")\nimage9","06a11b18":"#Extract features for 1000 instances","09604bc2":"<h1><span class=\"label label-default\" style=\"background-color:black;border-radius:100px 100px; font-weight: bold; font-family:Garamond; font-size:20px; color:#03e8fc; padding:10px\">Histogram orientation and gradient or HOG method<\/span><\/h1><br>\n\n\"The Histogram of Oriented Gradients method is mainly utilized for face and image detection to classify images, like the one that you see above. This field has a numerous amount of applications ranging from autonomous vehicles to surveillance techniques to smarter advertising.\"\n\nApplications of HOG\n\n\"The Histogram of Oriented Gradients object detection method can undoubtedly lead to great advancements in the future in the field of image recognition and face detection. From boosting AR tools to improving vision for blind individuals, this field can have a large impact on multiple industries.\"\n\n\"The Histogram of Oriented Gradients method (or HOG for short) is used for object detection and image recognition.\nHOG is based off of feature descriptors, which extract the useful information and discard the unnecessary parts.\nHOG calculates the horizontal and vertical component of the gradient\u2019s magnitude and direction of each individual pixel and then organizes the information into a 9-bin histogram to determine shifts in the data.\"\n\n\"Block normalization can be further utilized to make the model more optimal and less biased.\"\n\n\"HOGs can be used everywhere from the field of autonomous vehicles to the field of AR and VR (mostly anything involving image detection).\"\n\nhttps:\/\/medium.com\/analytics-vidhya\/a-gentle-introduction-into-the-histogram-of-oriented-gradients-fdee9ed8f2aa","de4ee2e7":"#AssertionError: You need to have an Nvidia GPU with CUDA installed.","8789d78d":"#Below the code screwed me. Ok, who I'm kidding here. I screwed the code.\n\nValueError: Length of values (0) does not match length of index (1000).\n\nI tried everything that I can changing label numbers. Searching in StackOverflow. I could Not go further than this snippet \nafter that error. Helps and tips are welcome.","a64430d9":"#Defining the target labels","5435a258":"#This Kaggle Notebook is dedicated to all Kagglers Mathematicians. Hi, Ryan H.\n\n#Whenever I read Nvidia I think about envy, since invidia is envy in italian. Very likely envy of their talented cast:D","59312220":"![](https:\/\/encrypted-tbn0.gstatic.com\/images?q=tbn:ANd9GcQ9nnw52W6HNlHiyLbSktSUQwcHQkoyNa3Vqw&usqp=CAU)imgflip.com","eb348983":"![](https:\/\/ahseeit.com\/\/king-include\/uploads\/2021\/10\/thumb_udhfgcfui9t71-2783550479.jpg)ahseeit.com","30956d3c":"#Prepare the Dataframe"}}