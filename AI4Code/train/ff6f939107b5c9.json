{"cell_type":{"3ae9f2b7":"code","4034c768":"code","c70a1258":"code","3410af03":"code","91960fdf":"code","3a2acae3":"code","33a2a72c":"code","fa803d57":"code","85dd9b43":"code","ca27fcf7":"code","07118771":"code","e8ad82c4":"code","92738f96":"code","00e1c788":"code","3125d0f8":"code","125bd054":"code","62f147f1":"code","351115f8":"code","5a3cdc42":"code","80d35057":"code","bcfb1bc0":"code","c1d59c17":"markdown","7fd8d1ca":"markdown","aab5c0e1":"markdown","85079688":"markdown","b611b77e":"markdown","bda0d48c":"markdown","a1d43f77":"markdown","566393d2":"markdown","02787e2f":"markdown","c25e36bb":"markdown","e9e55856":"markdown","fe899410":"markdown"},"source":{"3ae9f2b7":"import numpy as np\nimport pandas as pd\nimport plotly.express as px\n\nfrom sklearn.preprocessing import LabelEncoder, StandardScaler\nfrom sklearn.model_selection import train_test_split\n\nimport tensorflow as tf","4034c768":"data = pd.read_csv('..\/input\/africa-economic-banking-and-systemic-crisis-data\/african_crises.csv')","c70a1258":"data","3410af03":"((data['banking_crisis'] == 'crisis').astype(int) == data['systemic_crisis']).all()","91960fdf":"data.isna().sum()","3a2acae3":"data = data.drop(['case', 'country'], axis=1)","33a2a72c":"data","fa803d57":"cc3_dummies = pd.get_dummies(data['cc3'])\ndata = pd.concat([data, cc3_dummies], axis=1)\ndata = data.drop('cc3', axis=1)","85dd9b43":"data","ca27fcf7":"y = data['banking_crisis']\nX = data.drop('banking_crisis', axis=1)","07118771":"y","e8ad82c4":"label_encoder = LabelEncoder()\n\ny = label_encoder.fit_transform(y)\n{index: label for index, label in enumerate(label_encoder.classes_)}","92738f96":"y = pd.Series(y).apply(lambda x: 1 - x)","00e1c788":"scaler = StandardScaler()\n\nX = pd.DataFrame(scaler.fit_transform(X), columns=X.columns)","3125d0f8":"X","125bd054":"X_train, X_test, y_train, y_test = train_test_split(X, y, train_size=0.7)","62f147f1":"X.shape","351115f8":"y.sum() \/ len(y)","5a3cdc42":"inputs = tf.keras.Input(shape=(23,))\nx = tf.keras.layers.Dense(64, activation='relu')(inputs)\nx = tf.keras.layers.Dense(64, activation='relu')(x)\noutputs = tf.keras.layers.Dense(1, activation='sigmoid')(x)\n\nmodel = tf.keras.Model(inputs=inputs, outputs=outputs)\n\n\nmodel.compile(\n    optimizer='adam',\n    loss='binary_crossentropy',\n    metrics=[tf.keras.metrics.AUC(name=\"auc\")]\n)\n\n\nbatch_size = 64\nepochs = 60\n\nhistory = model.fit(\n    X_train,\n    y_train,\n    validation_split=0.2,\n    batch_size=batch_size,\n    epochs=epochs,\n    callbacks=[tf.keras.callbacks.ReduceLROnPlateau()],\n    verbose=0\n)","80d35057":"fig = px.line(\n    history.history,\n    y=['loss', 'val_loss'],\n    labels={'index': \"Epoch\", 'value': \"Loss\"},\n    title=\"Training and Validation Loss\"\n)\n\nfig.show()","bcfb1bc0":"model.evaluate(X_test, y_test)","c1d59c17":"# Task for Today  \n\n***\n\n## Crisis Prediction in African Economies  \n\nGiven *data about financial climates in various African countries throughout the years*, let's try to predict whether a **banking crisis** occurred or not in a given year in a given country.\n\nWe will use a TensorFlow ANN to make our predictions.","7fd8d1ca":"Now `y=1` means we have a crisis and `y=0` means we do not.","aab5c0e1":"# Training","85079688":"# Data Every Day  \n\nThis notebook is featured on Data Every Day, a YouTube series where I train models on a new dataset each day.  \n\n***\n\nCheck it out!  \nhttps:\/\/youtu.be\/jHrGpb9w4MM","b611b77e":"## Encoding","bda0d48c":"## Splitting","a1d43f77":"Check for missing values","566393d2":"## Scaling","02787e2f":"# Preprocessing","c25e36bb":"# Getting Started","e9e55856":"# Results","fe899410":"Checking if systemic crisis differs from banking crisis in any way."}}