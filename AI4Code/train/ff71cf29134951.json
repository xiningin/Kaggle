{"cell_type":{"a7e6612d":"code","ed58cfd5":"code","47f2260f":"code","3d972658":"code","a38ed7db":"code","ac2cc10c":"markdown","83a43f24":"markdown","11b8f38f":"markdown","d3defe33":"markdown","002e088c":"markdown"},"source":{"a7e6612d":"from pathlib import Path\nimport numpy as np\nimport pandas as pd\nfrom sklearn import model_selection","ed58cfd5":"data_dir = Path(\"..\/input\/tabular-playground-series-oct-2021\/\")\ndf_train = pd.read_csv(data_dir\/\"train.csv\")","47f2260f":"target = \"target\"\nfeatures = [c for c in df_train.columns if c not in [\"id\", target]]","3d972658":"def create_folds(seed=0, splits=5):\n    print(f\"Creating {splits}-split fold with seed {seed}...\")\n    df_tmp = df_train.copy()\n    df_tmp[\"kfold\"] = -1\n\n    skf = model_selection.StratifiedKFold(n_splits=splits, shuffle=True, random_state=seed)\n    for fold, (train_idx, valid_idx) in enumerate(skf.split(X=df_tmp, y=df_tmp[target])):\n        df_tmp.loc[valid_idx, \"kfold\"] = fold\n\n    print(\"Saving fold...\")\n    df_tmp.to_csv(\"train_folds.csv\", index=False)\n    print(\"Done.\")","a38ed7db":"create_folds(seed=42)","ac2cc10c":"# TPS October 2021 - Stratified KFolds","83a43f24":"## Import libraries","11b8f38f":"## Create folds","d3defe33":"## Features","002e088c":"## Load the data"}}