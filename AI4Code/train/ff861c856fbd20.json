{"cell_type":{"5d5de70d":"code","03423587":"code","31e99245":"code","3fc773ad":"code","a651bbb6":"code","116942fd":"code","37ca77ae":"code","79448d39":"code","460bfa16":"code","0a24a321":"code","4cff9b1e":"code","1fc38fa3":"code","c7594fda":"code","d296873f":"code","f3426293":"code","7f79c647":"code","dd173923":"code","05607ba6":"code","2af37376":"code","1d8317fa":"markdown","b585ff21":"markdown","dab14ec6":"markdown","46709f46":"markdown","f7026db6":"markdown","a1298d22":"markdown","6a79024e":"markdown","4f77a3c3":"markdown"},"source":{"5d5de70d":"import bq_helper\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport wordcloud\nfrom bq_helper import BigQueryHelper\n\nstackOverflow = bq_helper.BigQueryHelper(active_project=\"bigquery-public-data\",\n                                   dataset_name=\"stackoverflow\")","03423587":"bq_assistant = BigQueryHelper(\"bigquery-public-data\", \"stackoverflow\")\nbq_assistant.list_tables()","31e99245":"bq_assistant.head(\"posts_questions\", num_rows=5)","3fc773ad":"bq_assistant.head(\"posts_answers\", num_rows=5)","a651bbb6":"bq_assistant.table_schema(\"posts_questions\")","116942fd":"query1 = \"\"\"SELECT\n  EXTRACT(YEAR FROM creation_date) AS Year,\n  COUNT(*) AS Number_of_Questions,\n  ROUND(100 * SUM(IF(answer_count > 0, 1, 0)) \/ COUNT(*), 1) AS Percent_Questions_with_Answers\nFROM\n  `bigquery-public-data.stackoverflow.posts_questions`\nGROUP BY\n  Year\nHAVING\n  Year > 2008 AND Year <= 2018\nORDER BY\n  Year;\n        \"\"\"","37ca77ae":"bq_assistant.estimate_query_size(query1)","79448d39":"answered_questions = stackOverflow.query_to_pandas_safe(query1)\nanswered_questions.head(5)","460bfa16":"ax = sns.barplot(x=\"Year\",y=\"Percent_Questions_with_Answers\",data=answered_questions,palette=\"coolwarm\").set_title(\"What is the percentage of questions that have been answered over the years?\")","0a24a321":"query1 = \"\"\"SELECT\n  EXTRACT(YEAR FROM creation_date) AS Year,\n  COUNT(*) AS Number_of_Questions,\n  SUM(IF(answer_count > 0, 1, 0)) AS Number_Questions_with_Answers\nFROM\n  `bigquery-public-data.stackoverflow.posts_questions`\nGROUP BY\n  Year\nHAVING\n  Year > 2008 AND Year <= 2018\nORDER BY\n  Year;\n        \"\"\"\n\nanswered_questions = stackOverflow.query_to_pandas_safe(query1)\nanswered_questions.head(5) ","4cff9b1e":"answered_questions.plot(x=\"Year\",y=[\"Number_of_Questions\",\"Number_Questions_with_Answers\"], \n\n                    kind=\"bar\",figsize=(14,6), \n\n                    title='What is the total number of questions and questions that have been answered over the years?')","1fc38fa3":"query2 = \"\"\"SELECT\n  EXTRACT(YEAR FROM creation_date) AS Year,\n  COUNT(*) AS Number_of_Questions,\n  ROUND(100 * SUM(IF(score > 0, 1, 0)) \/ COUNT(*), 1) AS Percent_Questions_Scored_Negatively\nFROM\n  `bigquery-public-data.stackoverflow.posts_questions`\nGROUP BY\n  Year\nHAVING\n  Year > 2008 AND Year <= 2018\nORDER BY\n  Year;\n        \"\"\"\nnegatively_scored_questions = stackOverflow.query_to_pandas_safe(query2)\nnegatively_scored_questions.head(5)","c7594fda":"ax = sns.barplot(x=\"Year\",y=\"Percent_Questions_Scored_Negatively\",data=negatively_scored_questions,palette=\"coolwarm\").set_title(\"What is the percentage of negatively scored questions over years?\")","d296873f":"query3 = \"\"\"SELECT \n    REGEXP_EXTRACT(tags, \"spark\") AS Tag, \n    EXTRACT(YEAR FROM creation_date) AS Year, \n    COUNT(*) AS Number_Spark_Questions\nFROM \n    `bigquery-public-data.stackoverflow.posts_questions`\nGROUP BY\n  Tag, Year\nHAVING\n  Year > 2008 AND Year <= 2018 AND Tag IS NOT NULL\nORDER BY\n  Year;\n\"\"\"\n\nbq_assistant.estimate_query_size(query3)","f3426293":"spark_questions = stackOverflow.query_to_pandas_safe(query3)\nspark_questions.head(5)","7f79c647":"ax = sns.barplot(x=\"Year\",y=\"Number_Spark_Questions\",data=spark_questions,palette=\"coolwarm\").set_title(\"What is the number of questions about Apache Spark over years?\")","dd173923":"query4 = \"\"\"SELECT tags\nFROM \n    `bigquery-public-data.stackoverflow.posts_questions`\nLIMIT 200000;\n\"\"\"\n\nalltags = stackOverflow.query_to_pandas_safe(query4)\n\ntags = ' '.join(alltags.tags).lower()\ncloud = wordcloud.WordCloud(background_color='black',\n                            max_font_size=200,\n                            width=1600,\n                            height=800,\n                            max_words=300,\n                            relative_scaling=.5).generate(tags)\nplt.figure(figsize=(20,10))\nplt.axis('off')\nplt.savefig('stackOverflow.png')\nplt.imshow(cloud);","05607ba6":"query5 = \"\"\"SELECT AVG(comment_count) AS Number_Comments, \n    score AS Score, \n    EXTRACT(YEAR FROM creation_date) AS Year\nFROM \n    `bigquery-public-data.stackoverflow.posts_answers`\nGROUP BY \n    Score, Year\nORDER BY\n    Score;\n\"\"\"\n\nscores_answers = stackOverflow.query_to_pandas_safe(query5)\nscores_answers.head(5)","2af37376":"plt.figure(figsize=(20,10))\nplt.scatter(scores_answers[\"Year\"], scores_answers[\"Score\"], c=scores_answers[\"Number_Comments\"], alpha=0.3, cmap='viridis')\nplt.xlabel(\"Year\")\nplt.ylabel(\"Score\")\nplt.title(\"How average score of answers is evolving over years?\")\nplt.colorbar();  # show color scale","1d8317fa":"The \"query_to_pandas_safe\" function makes the call to execute the query.","b585ff21":"How average score of answers is evolving over years?","dab14ec6":"What is the percentage of negatively scored questions over years?","46709f46":"What is the number of questions about Apache Spark over years?","f7026db6":"Without running the query, the function \"estimate_query_size\" allows knowing that it would \u201ccost\u201d nearly 0.23 GB. ","a1298d22":"Which are the most typical tags used in questions?","6a79024e":"**A Brief Analysis of the Stack Overflow Data loaded as Google's BigQuery Dataset (Volume: 164.4 GB)**","4f77a3c3":"What is the percentage of questions that have been answered over the years?\n"}}