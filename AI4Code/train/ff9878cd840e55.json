{"cell_type":{"587c3c53":"code","cbf624cd":"code","07c01d17":"code","241be038":"code","22cb1b6d":"markdown","8518f8bc":"markdown","987ddcd0":"markdown"},"source":{"587c3c53":"import pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline","cbf624cd":"df = pd.read_csv('..\/input\/new-york-city-taxi-trip-hourly-weather-data\/Weather.csv')\ndf2 = df.set_index('pickup_datetime')[['tempi']]\n\nplt.figure(figsize=(16,4))\ndf2['tempi'].plot()","07c01d17":"# Switch month and day when day is less than 12\ndf['date'] = pd.to_datetime(df['pickup_datetime'])\ndf['month'] = df['date'].dt.month\ndf['year'] = df['date'].dt.year\ndf['day'] = df['date'].dt.day\ndf['hour'] = df['date'].dt.hour\ndf['minute'] = df['date'].dt.minute\n\ndef compute_right_day(row):\n    if row['day'] <= 12:\n        return row['month']\n    else:\n        return row['day']\n\ndef compute_right_month(row):\n    if row['day'] <= 12:\n        return row['day']\n    else:\n        return row['month']\n\ndef compute_right_date(row):\n    return '{:d}-{:d}-{:d} {:d}:{:d}'.format(row['year'], row['new_month'], row['new_day'],\n                                             row['hour'], row['minute'])\n\ndf['new_day'] = df.apply(compute_right_day, axis=1)\ndf['new_month'] = df.apply(compute_right_month, axis=1)\ndf['new_date_str'] = df.apply(compute_right_date, axis=1)\ndf['date'] = pd.to_datetime(df['new_date_str'])\ndf = df[['date', 'tempi']]\ndf.set_index('date', inplace=True)\ndf.sort_index(inplace=True)","241be038":"plt.figure(figsize=(16,4))\ndf['tempi'].plot()","22cb1b6d":"# This looks better now!","8518f8bc":"# Original temperature fluctuations\nNotice that the temperature is plotted to dip down to 30 degrees every month in the summer. Something is obviously wrong.\n\nMy hypothesis, is that the datetime was parsed wrong when the data was curated, and all the dates for which the day was before the 12th had the DAYS and MONTHS switched. This explains discontinuities at the 1st and 12th of the summer months","987ddcd0":"# Fix datetime"}}