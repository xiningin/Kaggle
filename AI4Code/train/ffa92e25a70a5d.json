{"cell_type":{"f98ce624":"code","c4fb68ca":"code","3d3c8400":"code","76ea885c":"code","92a03231":"code","ef36bc23":"code","4c67d671":"code","b2ccf87d":"code","826d0fc4":"code","56d6dd8e":"code","98443e94":"code","96dde3d4":"code","4a2d3df5":"code","8c4d180b":"code","13aaa9f7":"code","125760f5":"code","2770fcae":"code","f61fe73c":"code","ac7b6373":"code","579ec915":"code","c7ec44b1":"code","bd11c8bd":"code","95598501":"code","73ef0820":"code","f56b346a":"code","871017bf":"code","a6644e23":"code","f1e66204":"markdown","30233038":"markdown","a0598831":"markdown","675da96b":"markdown","2d2b2c09":"markdown","5a335e0f":"markdown","f3263f6c":"markdown"},"source":{"f98ce624":"\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nfrom sklearn import metrics\nimport matplotlib.pyplot as plt\nfrom sklearn.ensemble import ExtraTreesRegressor","c4fb68ca":"# Libraries for ANN \nimport keras\nfrom keras.models import Sequential\nfrom keras.layers import Dense\nfrom keras.layers import LeakyReLU,PReLU,ELU\nfrom keras.layers import Dropout","3d3c8400":"df=pd.read_csv('..\/input\/aqi-project\/AQI_13_16_Banglore.csv')\ndf.head(3)","76ea885c":"df.tail(3)","92a03231":"df.shape","ef36bc23":"sns.heatmap(df.isnull(),yticklabels=False,cbar=False,cmap='viridis')","4c67d671":"df=df.dropna()","b2ccf87d":"X=df.iloc[:,:-1] ## independent features\ny=df.iloc[:,-1] ## dependent features","826d0fc4":"## check null values\nX.isnull().sum()","56d6dd8e":"y.isnull().sum()","98443e94":"sns.pairplot(df)","96dde3d4":"df.corr()","4a2d3df5":"corrmat = df.corr()\ntop_corr_features = corrmat.index\nplt.figure(figsize=(20,20))\ng=sns.heatmap(df[top_corr_features].corr(),annot=True,cmap=\"RdYlGn\")","8c4d180b":"corrmat.index","13aaa9f7":"\nmodel = ExtraTreesRegressor()\nmodel.fit(X,y)","125760f5":"X.head()","2770fcae":"print(model.feature_importances_)","f61fe73c":"feat_importances = pd.Series(model.feature_importances_, index=X.columns)\nfeat_importances.nlargest(5).plot(kind='barh')\nplt.show()","ac7b6373":"sns.distplot(y)","579ec915":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=0)","c7ec44b1":"\nimport keras\nfrom keras.models import Sequential\nfrom keras.layers import Dense\nfrom keras.layers import LeakyReLU,PReLU,ELU\nfrom keras.layers import Dropout","bd11c8bd":"NN_model = Sequential()\n\n# The Input Layer :\nNN_model.add(Dense(128, kernel_initializer='normal',input_dim = X_train.shape[1], activation='relu'))\n\n# The Hidden Layers :\nNN_model.add(Dense(256, kernel_initializer='normal',activation='relu'))\nNN_model.add(Dense(256, kernel_initializer='normal',activation='relu'))\nNN_model.add(Dense(256, kernel_initializer='normal',activation='relu'))\n\n# The Output Layer :\nNN_model.add(Dense(1, kernel_initializer='normal',activation='linear'))\n\n# Compile the network :\nNN_model.compile(loss='mean_absolute_error', optimizer='adam', metrics=['mean_absolute_error'])\nNN_model.summary()\n\n# Fitting the ANN to the Training set\nmodel_history=NN_model.fit(X_train, y_train,validation_split=0.33, batch_size = 10, nb_epoch = 100)\n","95598501":"prediction=NN_model.predict(X_test)","73ef0820":"y_test","f56b346a":"sns.distplot(y_test.values.reshape(-1,1)-prediction)","871017bf":"plt.scatter(y_test,prediction)","a6644e23":"print('MAE:', metrics.mean_absolute_error(y_test, prediction))\nprint('MSE:', metrics.mean_squared_error(y_test, prediction))\nprint('RMSE:', np.sqrt(metrics.mean_squared_error(y_test, prediction)))","f1e66204":"## Artificial Neural Network","30233038":"### Correlation Matrix with Heatmap","a0598831":"#### Model Evaluation","675da96b":"### Feature Importance","2d2b2c09":"### ANN","5a335e0f":"### Train Test split","f3263f6c":"## ANN model creation"}}