{"cell_type":{"51ca838a":"code","5cd6b4cc":"code","c356c946":"code","ada181ef":"code","144e6f00":"code","9e2c47f6":"code","b9f06606":"code","4df7006b":"code","940bfc90":"code","ef21f97a":"code","e29827d9":"code","0c220b65":"code","d504f428":"code","6a4d0fb9":"code","91ed3ca8":"code","852936a4":"code","2b596bb1":"code","5a5dad7f":"code","13b0bc44":"code","752796c1":"code","c4817579":"code","da0f7932":"code","7d4a476c":"code","0d64dc9e":"code","bd3a2f97":"code","544ad346":"code","83dd3448":"code","0cf873b7":"code","c587fad5":"code","d363ccf0":"code","2a97dd8a":"code","9d53c234":"code","65edfdec":"code","cebe6294":"code","d5853f8f":"code","3d871e5f":"code","b9f5a147":"code","1c59a330":"code","0a21c110":"code","04cd3326":"code","f721bd54":"code","977c3b15":"code","de6693c8":"markdown","990bb51d":"markdown","69c66db9":"markdown","9ab19305":"markdown","fafab2b7":"markdown","acb78ee4":"markdown"},"source":{"51ca838a":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","5cd6b4cc":"import tensorflow as tf \nimport matplotlib as mpl\nimport matplotlib.pyplot as plt\n\nfrom sklearn.model_selection import train_test_split\nfrom keras.preprocessing.sequence import TimeseriesGenerator\nfrom sklearn.preprocessing import MinMaxScaler,StandardScaler","c356c946":"mpl.rcParams['figure.figsize'] = (10, 8)\nmpl.rcParams['axes.grid'] = False","ada181ef":"df=pd.read_csv(\"https:\/\/archive.ics.uci.edu\/ml\/machine-learning-databases\/00374\/energydata_complete.csv\")","144e6f00":"df.head()","9e2c47f6":"df['date'] = pd.to_datetime(df['date'], infer_datetime_format=True)","b9f06606":"df.set_index('date')[['Appliances', 'lights','T_out', 'RH_1', 'Visibility']].plot(subplots=True)","4df7006b":"df_input=df[['Appliances','T_out', 'RH_1', 'Visibility']]","940bfc90":"scaler = MinMaxScaler()\ndata_scaled=scaler.fit_transform(df_input)","ef21f97a":"data_scaled","e29827d9":"features = data_scaled\ntarget = data_scaled[:,0]","0c220b65":"TimeseriesGenerator(features,target,length=2,sampling_rate=1,batch_size=1)[0]","d504f428":"xtrain,xtest,ytrain,ytest=train_test_split(features,target,test_size=0.20,random_state=123,shuffle=False)","6a4d0fb9":"xtrain.shape","91ed3ca8":"xtest.shape","852936a4":"ytrain.shape","2b596bb1":"win_length=720\nbatch_size=32\nnum_features=4\ntrain_generator = TimeseriesGenerator(xtrain, ytrain, length=win_length, sampling_rate=1, batch_size=batch_size)\ntest_generator = TimeseriesGenerator(xtest, ytest, length=win_length, sampling_rate=1, batch_size=batch_size)","5a5dad7f":"train_generator[0]","13b0bc44":"model = tf.keras.Sequential()\n\nmodel.add(tf.keras.layers.LSTM(128,input_shape=(win_length,num_features),return_sequences=True))\nmodel.add(tf.keras.layers.LeakyReLU(alpha=0.5))\n\nmodel.add(tf.keras.layers.LSTM(128,return_sequences=True))\nmodel.add(tf.keras.layers.LeakyReLU(alpha = 0.5))\nmodel.add(tf.keras.layers.Dropout(0.3))\n\nmodel.add(tf.keras.layers.LSTM(64,return_sequences=False))\nmodel.add(tf.keras.layers.Dropout(0.3))\n\nmodel.add(tf.keras.layers.Dense(1))","752796c1":"model.summary()","c4817579":"early_stopping = tf.keras.callbacks.EarlyStopping(monitor='val_loss',patience=2,mode='min')","da0f7932":"model.compile(\n    loss=tf.losses.MeanSquaredError(),\n    optimizer=tf.optimizers.Adam(),\n    metrics=[tf.metrics.MeanAbsoluteError()]\n)","7d4a476c":"history = model.fit_generator(\n    train_generator,\n    epochs=50,\n    validation_data=test_generator,\n    shuffle=False,\n    callbacks = [early_stopping]\n)","0d64dc9e":"model.evaluate_generator(test_generator,verbose=0)","bd3a2f97":"predictions = model.predict_generator(test_generator)","544ad346":"predictions.shape","83dd3448":"predictions","0cf873b7":"ytest","c587fad5":"xtest","d363ccf0":"xtest.shape","2a97dd8a":"xtest[:,1:][win_length:]","9d53c234":"df_pred=pd.concat([pd.DataFrame(predictions), pd.DataFrame(xtest[:,1:][win_length:])],axis=1)","65edfdec":"df_pred","cebe6294":"rev_trans=scaler.inverse_transform(df_pred)","d5853f8f":"rev_trans","3d871e5f":"df_final=df_input[predictions.shape[0]*-1:]","b9f5a147":"df_final.count()","1c59a330":"df_final=df_input[predictions.shape[0]*-1:]","0a21c110":"df_final.count()","04cd3326":"df_final['App_Pred']=rev_trans[:,0]","f721bd54":"df_final","977c3b15":"df_final[['Appliances','App_Pred']].plot()","de6693c8":"Attribute Information:\n\ndate time year-month-day hour:minute:second\nAppliances, energy use in Wh\nlights, energy use of light fixtures in the house in Wh\nT1, Temperature in kitchen area, in Celsius\nRH_1, Humidity in kitchen area, in %\nT2, Temperature in living room area, in Celsius\nRH_2, Humidity in living room area, in %\nT3, Temperature in laundry room area\nRH_3, Humidity in laundry room area, in %\nT4, Temperature in office room, in Celsius\nRH_4, Humidity in office room, in %\nT5, Temperature in bathroom, in Celsius\nRH_5, Humidity in bathroom, in %\nT6, Temperature outside the building (north side), in Celsius\nRH_6, Humidity outside the building (north side), in %\nT7, Temperature in ironing room , in Celsius\nRH_7, Humidity in ironing room, in %\nT8, Temperature in teenager room 2, in Celsius\nRH_8, Humidity in teenager room 2, in %\nT9, Temperature in parents room, in Celsius\nRH_9, Humidity in parents room, in %\nTo, Temperature outside (from Chievres weather station), in Celsius\nPressure (from Chievres weather station), in mm Hg\nRH_out, Humidity outside (from Chievres weather station), in %\nWind speed (from Chievres weather station), in m\/s\nVisibility (from Chievres weather station), in km\nTdewpoint (from Chievres weather station), \u00c2\u00b0C\nrv1, Random variable 1, nondimensional\nrv2, Random variable 2, nondimensional","990bb51d":"# Multi variate time series modelling using LSTM","69c66db9":"# Model - LSTM neural network","9ab19305":"# Scaling","fafab2b7":"**shuffle=False is an important parameter while doing time series. As the values do not shuffle during the training process for sequence modelling.**","acb78ee4":"# Train test split"}}