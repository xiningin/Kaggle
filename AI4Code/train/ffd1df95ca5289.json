{"cell_type":{"9a2b492c":"code","726c4d5a":"code","8bc5bb1a":"code","672dabd9":"code","e1d91a41":"code","00c17717":"code","c605a12b":"code","16ab9387":"code","6fbda845":"code","14829d41":"code","1e4c8eb4":"code","5d57d05b":"code","834ffa12":"code","8d44bfd6":"code","7e01c4ca":"code","a250d07a":"code","9e48e414":"code","c423d6a3":"code","e5dde43f":"code","eb0ee8fa":"code","55c6ba22":"code","10c558a1":"code","15976b45":"code","441b557e":"code","25f7ceb5":"code","da6da7b7":"code","0d7514ff":"code","d4e0131f":"code","e44c8e9b":"code","ced3ded9":"code","849dc1f7":"code","79b89551":"markdown","10855fa8":"markdown","5ee30db3":"markdown","2221edcf":"markdown","823e682e":"markdown","f1c02683":"markdown","e3eae6d5":"markdown","32821dc0":"markdown","c3267403":"markdown","6ac39d82":"markdown","f321895d":"markdown","1452db8d":"markdown","b9e14e4c":"markdown","5e125859":"markdown","b0d51a99":"markdown","d738d275":"markdown","5b737d87":"markdown","755c144b":"markdown"},"source":{"9a2b492c":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","726c4d5a":"df = pd.read_csv(\"\/kaggle\/input\/bank-marketing-dataset\/bank.csv\")\n\ndf.head()","8bc5bb1a":"df[\"pdays\"].describe()","672dabd9":"df[\"pdays\"].value_counts()","e1d91a41":"df[\"pdays\"][df[\"pdays\"]>0].describe()","00c17717":"sns.barplot(x=\"education\",y=\"balance\", data=df[df[\"education\"]!=\"unknown\"],estimator=np.median);","c605a12b":"plt.figure(figsize=(25,8))\nsns.boxplot(\"pdays\", data= df[df[\"pdays\"]>0]);","16ab9387":"df.drop(df[df[\"pdays\"]>600].index,inplace=True) # remove putliers","6fbda845":"df.head()","14829d41":"df['deposit'].replace('no',0, inplace=True)\ndf['deposit'].replace('yes',1, inplace=True)","1e4c8eb4":"df[df[\"pdays\"]<0]","5d57d05b":"sns.barplot(x=\"deposit\", y=\"age\", data=df);","834ffa12":"sns.barplot(x=\"deposit\", y=\"balance\", data=df);","8d44bfd6":"sns.barplot(x=\"deposit\", y=\"duration\", data=df);","7e01c4ca":"sns.barplot(x=\"deposit\", y=\"pdays\", data=df[df['pdays']>0]);","a250d07a":"sns.barplot(x=\"deposit\", y=\"previous\", data=df[df['previous']>0]);","9e48e414":"df.corr()","c423d6a3":"numeric_features_names = ['age','balance', 'day', 'duration','campaign', 'pdays', 'previous']\ncategorical_features_name = ['job','marital','education','default','housing','loan','contact','month', 'poutcome']","e5dde43f":"from sklearn.preprocessing import StandardScaler\nss= StandardScaler()\nss.fit(df[numeric_features_names])\ndf[numeric_features_names] = ss.transform(df[numeric_features_names])\n#print(df)","eb0ee8fa":"df = pd.get_dummies(df, columns=categorical_features_name,drop_first=True) #drop first = true to take care of dummy\n#variable trap\n\n#print(df)","55c6ba22":"df.columns","10c558a1":"X = df[['age', 'balance', 'duration', 'campaign', 'pdays', 'previous',\n        'job_blue-collar', 'job_housemaid',\n       'job_management', 'job_retired', 'job_services',\n       'job_student', 'job_technician', 'job_unemployed',\n       'marital_married', 'marital_single', 'education_secondary',\n       'education_tertiary', 'education_unknown', 'housing_yes',\n       'loan_yes', 'contact_telephone', 'contact_unknown',\n       'month_dec', 'month_feb', 'month_jan', 'month_jun',\n       'month_mar', 'month_may', 'month_oct', 'month_sep',\n       'poutcome_other', 'poutcome_success', 'poutcome_unknown'] ]\ny = df[\"deposit\"]","15976b45":"import statsmodels.api as sm\nOLS= sm.OLS(y,X).fit()\nOLS.summary()","441b557e":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2,random_state=0)","25f7ceb5":"from sklearn.linear_model import LogisticRegression\n\nlr = LogisticRegression()\nmodel = lr.fit(X_train,np.array(y_train))\n\nprint(model)","da6da7b7":"y_pred = model.predict(X_test)","0d7514ff":"from sklearn.model_selection import cross_val_score\nscores = cross_val_score(model, X_train, y_train, cv=5)\nnp.mean(scores)","d4e0131f":"from sklearn.metrics import classification_report\nprint(\"Classification Report:\\n \", classification_report(y_test, y_pred))","e44c8e9b":"from sklearn.ensemble import RandomForestClassifier\nclassifier = RandomForestClassifier(n_estimators=45,random_state=0,max_depth=30)\nclassifier=classifier.fit(X_train,y_train)\ny_pred = classifier.predict(X_test)","ced3ded9":"from sklearn.model_selection import cross_val_score\nscores = cross_val_score(classifier, X_train, y_train, cv=5)\nnp.mean(scores)","849dc1f7":"from sklearn.metrics import classification_report\nprint(\"Classification Report:\\n \", classification_report(y_test, y_pred))","79b89551":"we can say that tertiary has the highest median compare to others","10855fa8":"-1 is the missing values, so we can consider removing it when describing. As many value are missing we cannot remove it ","5ee30db3":"There is not much difference w.r.t response","2221edcf":"## Logistic Regression","823e682e":"mean of kfold accuracy is 83% let's check f1 score, precission and recall of dependent variable ","f1c02683":"f1 score of 1 has also been increased from 81% to 82% so as the accuracy from 81% to 83%","e3eae6d5":"## Data Preprocessing","32821dc0":"I will keep it as it is because if i change that to median and mean it will create a biasing like -1 as almost 90% data is missing ","c3267403":"Now we can see that the mean, median are acceptable value and also as mean is greater than median we can say that it is right skewed and therefore we should standardardize it","6ac39d82":"All the percentiles are -1 and mean also seems to be less compare to max values ","f321895d":"we can see that response are more if the average balance of a person is more","1452db8d":"we can see that there is high chance of a person to not response if a person is not frequently contacted","b9e14e4c":"There is not much change w.r.t age","5e125859":"if a person talk more to a sales person at an average there is a high chance of him being converted","b0d51a99":"### So we will prefer Random Forest rather than Logistics regression","d738d275":"## Random Forest","5b737d87":"#### 'default_yes' , 'job_unknown', 'month_nov', 'month_aug', , 'job_entrepreneur' , 'job_self-employed',  'month_jul' , 'day' as been removed as the p-value of the variables are greater than 0.05 which means they are not significant","755c144b":"mean of kfold accuracy is 81% let's check f1 score, precission and recall of dependent variable "}}