{"cell_type":{"00e52de0":"code","e0ecb782":"code","6783ebda":"code","55d5d733":"code","12306344":"code","7356de63":"code","1ffb85ec":"code","21090fd9":"code","6e598935":"code","878ed9ec":"code","16b38309":"code","fb7317db":"code","b93ccda5":"code","f4cca381":"code","25254736":"code","83fd2694":"code","83350c05":"code","14dac59e":"code","3c3d1625":"code","5ddad85e":"code","4facf61d":"code","e397f712":"code","5d0cbbaa":"code","601b4d74":"code","1dd1d55d":"code","2e3441a4":"code","90271716":"code","71d31ca6":"code","b74f19ff":"code","854638ef":"code","b981a176":"code","36c19453":"code","863773bb":"code","73408f19":"code","75d6c9d4":"code","15dc3076":"code","9795cd5f":"code","c9fc917c":"code","53c0e93f":"code","7e5ab9c3":"code","0eb01dda":"markdown","617eaa2f":"markdown","856dcf4d":"markdown"},"source":{"00e52de0":"! pip install scikit-learn --upgrade --force-reinstall","e0ecb782":"! pip install --no-deps autoxgb","6783ebda":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)","55d5d733":"df_train = pd.read_csv('..\/input\/song-popularity-prediction\/train.csv')\ndf_train","12306344":"df_train = df_train.set_index('id')\ndf_train.head()","7356de63":"df_train.isnull().sum()","1ffb85ec":"df_train.isnull().sum()\/len(df_train)","21090fd9":"from sklearn.experimental import enable_iterative_imputer\nfrom sklearn.impute import IterativeImputer","6e598935":"X = df_train.drop(['song_popularity'], axis=1)\ny = df_train['song_popularity']","878ed9ec":"X","16b38309":"columns = X.columns\ncolumns","fb7317db":"X.corr()","b93ccda5":"from sklearn.tree import DecisionTreeRegressor\nimp = IterativeImputer(verbose=2, max_iter=30, tol=1e-10, imputation_order='roman')","f4cca381":"X = imp.fit_transform(X)","25254736":"X","83fd2694":"X = pd.DataFrame(X, columns = columns)\nX","83350c05":"y","14dac59e":"train = pd.concat([X, y], axis=1)\ntrain","3c3d1625":"train.to_csv('.\/TRAIN.csv', index = False)","5ddad85e":"df_test = pd.read_csv('..\/input\/song-popularity-prediction\/test.csv')\ndf_test","4facf61d":"df_test = df_test.set_index('id')\ndf_test.head()","e397f712":"columns = df_test.columns\ncolumns","5d0cbbaa":"df_test.isnull().sum()\/len(df_test)","601b4d74":"test = imp.transform(df_test)","1dd1d55d":"test","2e3441a4":"test = pd.DataFrame(test, columns = columns)\ntest","90271716":"test.to_csv('.\/TEST.csv',index = False)","71d31ca6":"df_train = pd.read_csv('.\/TRAIN.csv')\ndf_train","b74f19ff":"df_test = pd.read_csv('.\/TEST.csv')\ndf_test","854638ef":"df_train['song_popularity'].value_counts()","b981a176":"df_train['song_popularity'].value_counts()\/len(df_train)","36c19453":"train_filename = \".\/TRAIN.csv\"\ntest_filename = \".\/TEST.csv\"\noutput = \"autoxgb\"\n\n\nidx = None\ntargets = [\"song_popularity\"]\n\ntask = 'classification'\n\n\nnum_folds = 5\nseed = 42\nnum_trials = 1000\ntime_limit = 6000\nfast = False\nuse_gpu = True","863773bb":"from autoxgb import AutoXGB\n\naxgb = AutoXGB(\n    train_filename=train_filename,\n    output=output,\n    test_filename=test_filename,\n    task=task,\n    idx = idx,\n    targets=targets,\n   #features=features,\n   #categorical_features=categorical_features,\n    use_gpu=use_gpu,\n    num_folds=num_folds,\n    seed=seed,\n    num_trials=num_trials,\n    time_limit=time_limit,\n    fast=fast\n)","73408f19":"axgb.train()","75d6c9d4":"test_preds = pd.read_csv(\"\/kaggle\/working\/autoxgb\/test_predictions.csv\")\nsample_submission = pd.read_csv(\"..\/input\/song-popularity-prediction\/sample_submission.csv\")","15dc3076":"test_preds","9795cd5f":"test_preds.to_csv('pred.csv')","c9fc917c":"sample_submission['song_popularity'] = test_preds['1']\nsample_submission","53c0e93f":"sample_submission.to_csv(\"submission_autoxgb.csv\", index=False)","7e5ab9c3":"pd.read_csv('.\/submission_autoxgb.csv')","0eb01dda":"## Auto XGB","617eaa2f":"## Iterative Imputer | MICE Imputer test data","856dcf4d":"## Iterative Imputer | MICE Imputer train data"}}