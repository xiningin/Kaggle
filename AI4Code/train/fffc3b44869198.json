{"cell_type":{"978a5137":"code","faa48f03":"code","28dfb12a":"code","eea2e812":"code","64fef97c":"code","4e0d1510":"code","58e68f2c":"code","8784e700":"code","4bd5a4cf":"code","dc14bfec":"code","2aff7603":"code","8047ded2":"code","d2ec3efb":"code","d7172db2":"code","0c5441b4":"code","8bb4abd2":"code","aa168c04":"code","b01422ce":"code","6e67b343":"code","40e930ff":"code","b1873cbb":"code","76e0f2a7":"code","233d93b9":"code","ac536a5b":"markdown"},"source":{"978a5137":"import matplotlib.pyplot as plt\nimport numpy as np\nimport scipy.optimize as opt\nimport sklearn.linear_model\nimport sklearn.model_selection\nimport pandas as pd","faa48f03":"train =  pd.read_csv('..\/input\/hse-aml-2020\/books_train.csv')","28dfb12a":"train_x = train.drop('average_rating', axis=1)\ntrain_y = train.average_rating","eea2e812":"train_x","64fef97c":"train_x['publication_date'] = pd.to_datetime(train_x['publication_date'], format='%m\/%d\/%Y', errors='coerce')\ntrain_x['year'] = pd.to_numeric(train_x['publication_date'].dt.year, downcast='integer')\ntrain_x['month'] = pd.to_numeric(train_x['publication_date'].dt.month, downcast='integer')\ntrain_x['day'] = pd.to_numeric(train_x['publication_date'].dt.day, downcast='integer')","4e0d1510":"train_x['language_code'] = train_x['language_code'].replace(to_replace=train_x.language_code.unique(), value=np.arange(0, len(train_x.language_code.unique()), 1))","58e68f2c":"train_x","8784e700":"train_x['authors'] = train_x['authors'].replace(to_replace=train_x.authors.unique(), value=np.arange(0, len(train_x.authors.unique()), 1))\ntrain_x['publisher'] = train_x['publisher'].replace(to_replace=train_x.publisher.unique(), value=np.arange(0, len(train_x.publisher.unique()), 1))","4bd5a4cf":"del train_x['title']\ndel train_x['authors']\ndel train_x['publisher']\ndel train_x['publication_date']","dc14bfec":"del train_x['isbn']","2aff7603":"from lightgbm import LGBMRegressor\nfrom sklearn.metrics import mean_squared_error\n\nlight = LGBMRegressor()\nlight.fit(train_x, train_y)\nvalid_pred_merged = light.predict(train_x)\nprint('MSE: {}'.format(mean_squared_error(train_y, valid_pred_merged)))","8047ded2":"test = pd.read_csv('..\/input\/hse-aml-2020\/books_test.csv')","d2ec3efb":"test['publication_date'] = pd.to_datetime(test['publication_date'], format='%m\/%d\/%Y', errors='coerce')\ntest['year'] = pd.to_numeric(test['publication_date'].dt.year, downcast='integer')\ntest['month'] = pd.to_numeric(test['publication_date'].dt.month, downcast='integer')\ntest['day'] = pd.to_numeric(test['publication_date'].dt.day, downcast='integer')","d7172db2":"test['language_code'] = test['language_code'].replace(to_replace=test.language_code.unique(), value=np.arange(0, len(test.language_code.unique()), 1))","0c5441b4":"test['authors'] = test['authors'].replace(to_replace=test.authors.unique(), value=np.arange(0, len(test.authors.unique()), 1))\ntest['publisher'] = test['publisher'].replace(to_replace=test.publisher.unique(), value=np.arange(0, len(test.publisher.unique()), 1))","8bb4abd2":"del test['title']\ndel test['authors']\ndel test['publisher']\ndel test['publication_date']","aa168c04":"del test['isbn']","b01422ce":"valid_pred_merged = light.predict(test)\n#print('MSE: {}'.format(mean_squared_error(test, valid_pred_merged)))","6e67b343":"pd.Series(valid_pred_merged)","40e930ff":"test['bookID']","b1873cbb":"df = pd.DataFrame(np.nan, index=[0,1,2,3], columns=['A'])\ndf['bookID'] = test['bookID']\ndf['average_rating'] = pd.Series(valid_pred_merged)#bookID,average_rating\n\nd = {'bookID': test['bookID'], 'average_rating': pd.Series(valid_pred_merged)}\ndf = pd.DataFrame(data=d)","76e0f2a7":"df","233d93b9":"df.to_csv('file_name.csv', index=False)","ac536a5b":"# Lets make test dataset looks like train dataset"}}